function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var r=globalThis,i={},a={},s=r.parcelRequire8969;null==s&&((s=function(e){if(e in i)return i[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){a[e]=t},r.parcelRequire8969=s);var n=s.register;n("cvawf",function(r,i){let a;t(r.exports,"default",()=>ec),t(r.exports,"QRCode",()=>e(s("66krt"))),s("jLXCT"),s("kbFhP");var n=s("bo74g"),o=s("2iBkg"),l=s("l956U"),u=s("fnScq"),h=s("gbCDL"),c=s("4QhZh");s("eXEIX");var d=s("8y1NC"),p=s("cC9va"),f=s("3SDrW"),m=s("lyDcb"),g=s("3AtWD"),y=s("aIaid"),v=s("6yoor"),_=s("btuox"),x=s("jZquI"),b=s("1NiL5"),S=s("fkmMz"),w=s("6cpWg"),E=s("93mJv"),A=s("945U7"),T=s("oelnd"),C=s("jEzQ5"),P=s("6od7S"),R=s("3cHIk"),I=s("loIjs"),L=s("d1ltq"),O=s("6e1MB"),M=s("4k2SX"),k=s("iQyfo"),N=s("e9bRc"),D=s("dbRSi"),F=s("bS8Lk"),G=s("lUmQH"),z=s("7qUmJ"),q=s("17jqf"),j=s("6yJ0x"),B=s("lbwk5"),U=s("rnKfx"),H=s("3HxCM"),Z=s("iArnh"),V=s("dxNAB"),Y=s("cWXYt");s("bqoF2");var W=s("gIJof"),$=s("2Fada"),X=s("31ZqB"),K=s("cHblF"),J=s("gzr8q");s("9BdHO");var Q=s("8TdmW"),ee=s("76Eer"),et=s("66krt"),er=s("jSBAJ"),ei=s("kOWwI"),ea=s("jPVWI");s("ofMCX");var es=s("iGyOD"),en=s("hvEnP"),eo=s("29SgV");(0,W.default)(),window.addEventListener("moveTo",e=>{if(a)try{let t=(0,J.fromLonLat)([e.detail[0],e.detail[1]]);a.map.getView().setCenter(t),e.detail[2]&&a.map.getView().setZoom(e.detail[2])}catch(e){}}),window.addEventListener("flyTo",e=>{if(a)try{let t=(0,J.fromLonLat)([e.detail[0],e.detail[1]]);a.map.getView().flyTo({center:t,zoom:e.detail[2]})}catch(e){}});let el=`<label>Login de l'espace collaboratif</label>
<input type="text" class="login" />
<label>Mot de passe</label>
<input type="password" class="pwd" />
<i class="error">Impossible de se connecter...</i>`,eu=new P.default({closeOnSubmit:!1,closeBox:!0,target:document.body});eu.setMap(ei.default);class eh extends u.default{constructor(e){let t;for(let r in super(e=e||{}),a=this,this.map=new h.default({target:e.target,view:new c.default({center:[0,0],zoom:0}),controls:(0,d.defaults)({attribution:!1,zoom:!1}),interactions:(0,p.defaults)({mouseWheelZoom:!1})}),this.set("key",e.key),this.layerId_=0,this.map.getLayers().on("add",e=>{let t=e.element;t.get("id")?this.layerId_=Math.max(this.layerId_,t.get("id")):e.element.set("id",++this.layerId_)}),this.map.getLayers().on("add",e=>{"ECo"!==e.element.get("type")||(0,er.getAuth)()||(t&&clearTimeout(t),t=setTimeout(()=>{this.authenticate()}))}),this.map.addInteraction(new v.default({condition:e=>!this.map.get("noMouseWheel")||"wheel"!==e.type||!!(0,_.platformModifierKeyOnly)(e)||(this.notification((0,M.default)("ctrlZoom")),!1)})),this._styleOptions={type:"zoom",points:!0},this.getMap().on("singleclick",e=>{if(!this.getSelect().getActive())return;let t=[],r=this.getMap().getFeaturesAtPixel(e.pixel,{hitTolerance:3});if(r[0]instanceof eo.default){let t=r[0];if(t.getLayer().selectable()){let r=t.getProperties();r.geometry=new en.default([e.coordinate,e.coordinate]);let i=new es.default(r);i.setLayer(t.getLayer()),this.dispatchEvent({type:"layer:featureInfo",coordinate:e.coordinate,layer:i.getLayer(),feature:i});return}}r.forEach(e=>{e.getLayer()&&t.push(e.getLayer())});let i=this.getMap().getLayers().getArray();for(let r=i.length-1;r>=0;r--){let a=i[r];if((a instanceof ea.default||a instanceof b.default)&&t.indexOf(a)>=0)return;if(a.getData){let t=a.getData(e.pixel);if(a.getSource()&&a.getSource().getFeatureInfo&&t&&t[3]){let t=a.getPopupContent();if(!t||!t.titre&&!t.desc&&!t.img&&!t.coord)return;let r=a.get("wmsparam")||{};a.getSource().getFeatureInfo(e.coordinate,this.getMap().getView().getResolution(),{INFO_FORMAT:(r.layer?r.layer.info_format:null)||"application/json",callback:t=>{if(JSON.parse(t).features.length){let r=JSON.parse(t).features[0].properties;r.geometry=new en.default([e.coordinate,e.coordinate]);let i=new es.default(r);i.setLayer(a),this.dispatchEvent({type:"layer:featureInfo",coordinate:e.coordinate,layer:a,feature:i})}else this.dispatchEvent({type:"layer:featureInfo",coordinate:e.coordinate})}});break}}}}),this._interactions={select:new g.default({layers:e=>!!e.selectable&&e.selectable(),multi:!0,hitTolerance:3,condition:_.click,style:(0,Y.getSelectStyleFn)(this._styleOptions),shownStyle:(0,Y.getShownFeatureStyleFn)(this._styleOptions)}),hover:new j.default({layerFilter:e=>e.selectable&&e.selectable(),hitTolerance:3,cursor:"pointer"}),synchro:new y.default({active:!1})},this.getMap().on("click",()=>{this._interactions.select.clearCurrentSelectionArrays()}),this._interactions)this.map.addInteraction(this._interactions[r]);for(let t in this._styleOptions.features=this.getSelect().getFeatures(),this._controls={toolbar:new w.default({className:"edit"}),ctrlbar:new w.default({className:"ol-ctrlbar ol-left ol-top"}),zoom:new O.default,scaleLine:new A.default({canvas:!0}),attribution:new E.default({canvas:!0}),mousePosition:new I.default({className:"ol-control ol-mouse-position",undefinedHTML:" "}),title:new N.default({visible:!1}),layerSwitcher:(0,G.default)(),profil:new ee.default({map:this.getMap(),select:this.getSelect()}),printDlg:new R.default({lang:"fr",title:(0,M.default)("printLabel"),saveAs:Z.saveAs,jsPDF:V.jsPDF}),legend:new U.default({title:(0,M.default)("legend"),legend:new H.default({title:(0,M.default)("legend"),size:[28,20],margin:6,style:(0,Y.getStyleFn)()})}),searchBar:new T.default({apiKey:e.key,title:(0,M.default)("searchLabel"),zoomOnSelect:14}),permalink:new C.default({urlReplace:!1,visible:!0,geohash:!0,onclick:this.dialogInfo.bind(this)}),locate:new D.default({minZoom:16}),dialog:new P.default({className:"mapInfo",closeBox:!0,target:document.body}),notification:F.default},this.map.removeControl(this._controls.zoom),this._controls)this.map.addControl(this._controls[t]);this._interactions.select.on("change:active",()=>{this._interactions.hover.setActive(this._interactions.select.getActive())}),this._controls.ctrlbar.addControl(this._controls.zoom),this._controls.zoom.set("bar",!0),this._controls.ctrlbar.addControl(this._controls.profil),this._controls.profil.set("bar",!0),this._controls.ctrlbar.addControl(this._controls.printDlg),this._controls.printDlg.set("bar",!0),this._controls.printDlg.on(["show","hide"],(function(e){this.getSelect().getFeatures().clear(),this.popup.hide(),this.getSelect().setActive("hide"===e.type)}).bind(this)),this._controls.ctrlbar.addControl(this._controls.locate),this._controls.locate.set("bar",!0),this.showControl("toolbar",!1),this.popup=new z.default({closeBox:!0,minibar:!0,select:this.getSelect()}),this.map.addOverlay(this.popup),this.popup.on("show",()=>this.popup.content.scrollTop=0),this.popover=new z.default({className:"tooltips popuphover",positioning:"center-left",stopEvent:!1,select:this.getSelect()}),this.map.addOverlay(this.popover),this.tooltip=new q.default,this.map.addOverlay(this.tooltip),this._symbolLib=new X.default,e.url?this.read(e.url):e.id&&this.load(e.id)}}eh.prototype.getMap=function(){return this.map},eh.prototype.getSelect=function(){return this._interactions.select},eh.prototype.getInteraction=function(e){return this._interactions[e]},eh.prototype.setSelectStyle=function(e){for(let t in e)this._styleOptions[t]=e[t]},eh.prototype.setReady=function(){this.getMap().getViewport().classList.add("ol-ready")},eh.prototype.getDialog=function(){return this.getControl("dialog")},eh.prototype.dialogInfo=function(){let t=(0,k.default).create("DIV",{className:"carte-info-dialog"});this._story||(0,k.default).create("H1",{html:this.map.get("title"),parent:t}),(0,k.default).create("DIV",{className:"description",html:this._story?(0,l.default).element(this._story.get("description")):this.map.get("description"),parent:t}),(0,k.default).create("UL",{html:this.getControl("attribution").element.querySelector("ul").innerHTML,parent:t});let r=(0,k.default).create("DIV",{className:"permalink",parent:t});(0,k.default).create("IMG",{className:"qrcode",src:e(et).generatePNG(this.getControl("permalink").getLink(),{ecclevel:"L",margin:0}),parent:r}),(0,k.default).create("P",{html:(0,M.default)("permalink_open"),parent:r});let i=(0,k.default).create("SPAN",{html:(0,M.default)("copy_info"),className:"copy-info",parent:r});(0,k.default).create("DIV",{click:()=>{try{navigator.clipboard.writeText(this.getControl("permalink").getLink()),i.className="copy-info visible",setTimeout(()=>{i.className="copy-info"},800)}catch(e){}},target:"_blank",parent:r}).innerText=this.getControl("permalink").getLink();let a=(0,k.default).create("DIV",{className:"cgu",html:(0,M.default)("macarte_link").replace("{SERVER}",n.default.server).replace("{APPNAME}",(0,n.default).server.replace(/http.?:|\//g,""))+"<br/>"+(0,M.default)("cgu_link").replace("{URL}",o.default.cgu)+"<br/>",parent:t}),s=(0,$.default).getMe()||{};(0,Q.default)({href:o.default.signal,service:"viewer",title:(0,M.default)("report_link"),mapID:this.get("id"),user:s.username,userID:s.id,email:s.email},a),this.getDialog().show({content:t,buttons:{ok:"ok"}})},eh.prototype.getControl=function(e){return this._controls[e]},eh.prototype.getTitle=function(){return this.get("atlas")?this.get("atlas").title||"macarte":this.get("title")||"macarte"},eh.prototype.getToolbar=function(){return this.getControl("toolbar")},eh.prototype.hasControl=function(e){let t="string"==typeof e?this.getControl(e):e;return!!t&&(t.get("bar")?""===t.element.style.display:!!t.getMap())},eh.prototype.showControl=function(e,t){let r="string"==typeof e?this.getControl(e):e;if(r){if(r.setActive&&r.setActive(!1),!1!==t){if(r.get("bar"))r.element.style.display="";else try{this.map.addControl(r)}catch(e){}}else if(r.get("bar"))r.element.style.display="none";else try{this.map.removeControl(r)}catch(e){}"mousePosition"===e&&t&&(!0===t&&(t={proj:"EPSG:4326",unit:"dms"}),t.proj&&r.setProjection(t.proj),t.unit&&r.setCoordinateFormat(e=>/4326/.test(r.getProjection().getCode())?/dms|ds/.test(r.get("unit"))?"&nbsp;"+(0,L.toStringHDMS)(e).replace(/ /g,"").replace("W","O").replace("N","N - ").replace("S","S - ")+"&nbsp;":(0,L.format)(e,"&nbsp;lon: {x}, lat: {y}&nbsp;",6):(0,L.format)(e,"&nbsp;{x}, {y}&nbsp;",2)))}else"rotation"===e&&this.getMap().getInteractions().forEach(e=>{(e instanceof f.default||e instanceof m.default)&&e.setActive(t)});this.changed()},eh.prototype.read=function(e,t){if("string"==typeof e){(0,S.default).get({url:e,success:e=>this.read(e,t),error:e=>{this.dispatchEvent(e)}});return}this.dispatchEvent({type:"read:start"}),this.set("atlas",t||{}),(new B.default).read(this,e),this._controls.title.setTitle(this.map.get("title")),this.setReady(),this.dispatchEvent({type:"read"})},eh.prototype.load=function(e){this.dispatchEvent({type:"loading"});let t="string"==typeof e?e:e.view_id;(0,$.default).getMapFile(t,r=>{r.error?(r.type="error",this.dispatchEvent(r)):(this.set("id",t),this.read(r,"string"==typeof e?null:e))})},eh.prototype.setParent=function(e){this._story=e},eh.prototype.notification=function(e,t){this.getControl("notification").show(e,t)},eh.prototype.popupFeature=function(e,t){if(e){if(t){let e=this.map.getView().getProjection().getExtent();if(t[0]>e[2]){let t=this.map.getView().getCenter();t[0]=t[0]-(e[2]-e[0]),this.map.getView().setCenter(t),this.map.renderSync()}else if(t[0]<e[1]){let t=this.map.getView().getCenter();t[0]=t[0]+(e[2]-e[0]),this.map.getView().setCenter(t),this.map.renderSync()}}e.showPopup(this.popup,t)}else this.popup.hide()},eh.prototype.popupFeatures=function(e,t){if(e&&0!=e.length){if(t){let e=this.map.getView().getProjection().getExtent();if(t[0]>e[2]){let t=this.map.getView().getCenter();t[0]=t[0]-(e[2]-e[0]),this.map.getView().setCenter(t),this.map.renderSync()}else if(t[0]<e[1]){let t=this.map.getView().getCenter();t[0]=t[0]+(e[2]-e[0]),this.map.getView().setCenter(t),this.map.renderSync()}}this.showPopupFeatures(e,this.popup,t)}else this.popup.hide()},eh.prototype.getFeaturesPopupContent=function(e,t=!1){if(!e)return;let r=[];if(e.forEach(e=>{let t=e.get("features");t?r.push(...t):r.push(e)}),0==r.length)return;let i=[],a=[];for(let e=0;e<r.length;e++){let s=r[e];if(s.getLayer().getMode&&"cluster"==s.getLayer().getMode()&&"stat"==s.getLayer().get("clusterType")&&0==s.getLayer().getStyle()(s).length)continue;let n=s.getPopupContent(!0);(t||n.innerText.trim()||n.querySelector("canvas")||n.querySelector("img")||s.getLayer().get("multiSelect"))&&(i.push(n),a.push(s))}return{contents:i,renderedFeatures:a}},eh.prototype.showPopupFeatures=function(e,t,r,i){let a=this.getFeaturesPopupContent(e),s=a.contents,n=a.renderedFeatures;if(s.length){for(let e=0;e<s.length;e++)if(s[e].innerText.trim()||s[e].querySelector("canvas")||s[e].querySelector("img")){t.setOffset([0,0]);break}if(!r){let a=e[0];r=t.getPosition()||(i||a.getGeometry()).getFirstCoordinate()}if("Point"===e[0].getGeometry().getType()){var o=t.offsetBox;if(e[0].getLayer&&e[0].getLayer()&&e[0].getLayer().getIgnStyle){var u=e[0].getLayer().getIgnStyle(e[0]),h=/left|right/.test(t.autoPositioning[0])?u.pointRadius:0;t.offsetBox=[-h,(u.pointOffsetY?-2:-1)*u.pointRadius,h,u.pointOffsetY?0:u.pointRadius]}i?t.show(i.getClosestPoint(r),s,n):t.show(e[0].getGeometry().getFirstCoordinate(),s,n),t.offsetBox=o}else/polygon/i.test(e[0].getGeometry().getType())?t.show(r,s,n):t.show(e[0].getGeometry().getClosestPoint(r),s,n)}else t.hide();return(0,l.default).renderWidget(t.getElement()),s},eh.prototype.setSelection=function(e,t){let r=this.getInteraction(t||"select");r.getFeatures().clear(),e&&r.getFeatures().push(e),r.dispatchEvent({type:"select",selected:e?[e]:[],unselected:[]})},eh.prototype.zoomToClusterExtent=function(e){let t=this.map.getView(),r=t.getZoom(),i=t.getCenter(),a=(0,x.createEmpty)();e.forEach(e=>{(0,x.extend)(a,e.getGeometry().getExtent())}),a=(0,x.buffer)(a,15*t.getResolution()),t.fit(a,{size:this.map.getSize()});let s=Math.min(18,e[0].getLayer().get("maxZoomCluster"));t.getZoom()>s&&(s>18?t.setZoom(18):(t.setZoom(r),t.setCenter(i),t.animate({center:(0,x.getCenter)(a),zoom:s+.1,duration:400})))},eh.prototype.getViewerUrl=function(e){return!!this.get("id")&&((e=Object.assign({},e||{})).view_id=this.get("id"),this.get("atlas")?e.title=this.get("atlas").title||"carte":e.title=this.get("title")||"carte",e.type="macarte",(0,o.getViewerURL)(e))},eh.prototype.getSymbolLib=function(e){if(!e)return this._symbolLib;if("number"==typeof e)return this._symbolLib.item(e);for(let t=0;t<this._symbolLib.getLength();t++)if(this._symbolLib.item(t).name===e)return this._symbolLib.item(t);return null},eh.prototype.addSymbolLib=function(e){let t=new K.default(e);return this._symbolLib.push(t),t},eh.prototype.write=function(e){return(new B.default).write(this,e)},eh.prototype.authenticate=function(e,t){if((0,er.getAuth)())this.getMap().getLayers().forEach(e=>{"ECo"===e.get("type")&&e.getSource().setLoader()}),eu.close(),this.dispatchEvent("authenticate"),e&&e();else{eu.show({title:"Authentification nécessaire",className:"eco-login"+(t?" error-login":""),content:el,buttons:{submit:"ok",cancel:"annuler"},onButton:(t,r)=>{"submit"===t&&(eu.show({className:"wait",closeBox:!1,content:"chargement..."}),(0,er.default).login(r.login.value,r.pwd.value,t=>{this.authenticate(e,t.error)}))}});let r=localStorage["MC@user"];r&&(eu.getContentElement().querySelector(".login").value=r,setTimeout(()=>{eu.getContentElement().querySelector(".pwd").focus()}))}};var ec=eh}),n("jLXCT",function(e,t){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var r=0;r<this.length;r++)e.call(t,this[r],r,this)})}),n("eXEIX",function(e,t){s("agkzb");var r=s("lwtpg"),i=s("5Revz"),a=s("8ln3M"),n=s("gvREW"),o=s("izcbS"),l=s("juLo9"),u=s("dEQmT"),h=s("2zf1Y");function c(e){if(e._mcFilter&&e.removeFilter(e._mcFilter),e.get("grayscale")||e.get("blendMode")){let t={};e.get("grayscale")&&(t.filter="grayscale(1)"),e.get("blendMode")&&(t.blend=e.get("blendMode")),e._mcFilter=new i.default(t),e.addFilter(e._mcFilter)}}let d=r.default.prototype.setProperties;r.default.prototype.setProperties=function(e){"ol-layer"===this.className_&&(this.className_=(0,a.default)()),d.call(this,e)},r.default.prototype.grayscale=function(e){this.set("grayscale",!!e),c(this)},r.default.prototype.setBlendMode=function(e){this.set("blendMode",e||"normal"),c(this)},r.default.prototype.setCrop=function(e){if(Array.isArray(e)){let t=e;for(let r in e={},t)e[r]=t[r]}if(this.getFilters().forEach(e=>{e instanceof n.default&&this.removeFilter(e)}),e&&e.coordinates){let t=new l.default(new u.default(e.coordinates));if(e.color&&e.color[3]){let r=new h.default({color:e.color});this.addFilter(new n.default({feature:t,wrapX:!0,inner:!1,shadowWidth:e.shadow?2:0,fill:r}))}else this.addFilter(new o.default({feature:t,wrapX:!0,inner:!1,shadowWidth:e.shadow?5:0}))}this.set("crop",e)},r.default.prototype.getCrop=function(){return this.get("crop")||{}},r.default.prototype.getPopupContent=function(){return this._popupContent||{}},r.default.prototype.setPopupContent=function(e){!e||e instanceof Array?this._popupContent={}:this._popupContent=e}}),n("agkzb",function(e,r){t(e.exports,"default",()=>u);var i=s("ejLRd"),a=s("lwtpg"),n=s("fnScq"),o=s("gbCDL"),l=class extends n.default{constructor(e){super(e),this._listener=[],e&&!1===e.active?this.set("active",!1):this.set("active",!0)}setActive(e){this.set("active",!0===e)}getActive(){return this.get("active")}};!function(){function e(e){this.get("active")&&e.context&&this.precompose(e)}function t(e){this.get("active")&&e.context&&this.postcompose(e)}function r(){if(this.renderSync)try{this.renderSync()}catch(e){}else this.changed()}function s(i){this.filters_||(this.filters_=[]),this.filters_.push(i),i.addToLayer&&i.addToLayer(this),i.precompose&&i._listener.push({listener:this.on(["precompose","prerender"],e.bind(i)),target:this}),i.postcompose&&i._listener.push({listener:this.on(["postcompose","postrender"],t.bind(i)),target:this}),i._listener.push({listener:i.on("propertychange",r.bind(this)),target:this}),r.call(this)}function n(e){var t;if(this.filters_||(this.filters_=[]),!e){this.filters_.forEach((function(e){this.removeFilter(e)}).bind(this));return}for(t=this.filters_.length-1;t>=0;t--)this.filters_[t]===e&&this.filters_.splice(t,1);for(t=e._listener.length-1;t>=0;t--)e._listener[t].target===this&&(e.removeFromLayer&&e.removeFromLayer(this),(0,i.unByKey)(e._listener[t].listener),e._listener.splice(t,1));r.call(this)}o.default.prototype.addFilter=function(e){console.warn("[OL-EXT] addFilter deprecated on map."),s.call(this,e)},o.default.prototype.removeFilter=function(e){n.call(this,e)},o.default.prototype.getFilters=function(){return this.filters_||[]},a.default.prototype.addFilter=function(e){s.call(this,e)},a.default.prototype.removeFilter=function(e){n.call(this,e)},a.default.prototype.getFilters=function(){return this.filters_||[]}}();var u=l}),n("5Revz",function(e,r){t(e.exports,"default",()=>a);var i=s("agkzb"),a=class extends i.default{constructor(e){super(e),this._layers=[]}setBlend(e){this.set("blend",e),this._layers.forEach(function(t){t.once("postrender",(function(t){t.context.canvas.parentNode.style["mix-blend-mode"]=e||""}).bind(this)),t.changed()})}setFilter(e){this.set("filter",e),this._layers.forEach(function(t){t.once("postrender",(function(t){t.context.canvas.parentNode.style.filter=e||""}).bind(this)),t.changed()})}setDisplay(e){this.set("display",e),this._layers.forEach(function(t){t.once("postrender",(function(t){t.context.canvas.parentNode.style.display=e?"":"none"}).bind(this)),t.changed()})}addToLayer(e){e.once("postrender",(function(e){e.context.canvas.parentNode.style["mix-blend-mode"]=this.get("blend")||"",e.context.canvas.parentNode.style.filter=this.get("filter")||"",e.context.canvas.parentNode.style.display=!1!==this.get("display")?"":"none"}).bind(this)),e.changed(),this._layers.push(e)}removeFromLayer(e){var t=this._layers.indexOf(e);t>=0&&(e.once("postrender",(function(e){e.context.canvas.parentNode.style["mix-blend-mode"]="",e.context.canvas.parentNode.style.filter="",e.context.canvas.parentNode.style.display=""}).bind(this)),e.changed(),this._layers.splice(t,1))}}}),n("8ln3M",function(e,r){t(e.exports,"default",()=>a);let i=0;function a(){return"mc_"+i++}}),n("gvREW",function(e,r){t(e.exports,"default",()=>n);var i=s("agkzb"),a=s("lqNjm"),n=class extends i.default{constructor(e){if(super(e=e||{}),e.feature)switch(e.feature.getGeometry().getType()){case"Polygon":case"MultiPolygon":this.feature_=e.feature}this.set("inner",e.inner),this._fillColor=e.fill&&(0,a.asString)(e.fill.getColor())||"rgba(0,0,0,0.2)",this._shadowColor=e.shadowColor&&(0,a.asString)(e.shadowColor)||"rgba(0,0,0,0.5)",this.set("shadowWidth",e.shadowWidth||0),this.set("shadowMapUnits",!0===e.shadowMapUnits)}setFillColor(e){this._fillColor=e&&(0,a.asString)(e)||"rgba(0,0,0,0.2)"}setShadowColor(e){this._shadowColor=e&&(0,a.asString)(e)||"rgba(0,0,0,0.5)"}drawFeaturePath_(e,t){var r,i=e.context,a=i.canvas,s=e.frameState.pixelRatio;if(e.frameState.coordinateToPixelTransform){var n=e.frameState.coordinateToPixelTransform;if(e.inversePixelTransform){var o=e.inversePixelTransform;r=function(e){return[(e=[e[0]*n[0]+e[1]*n[1]+n[4],e[0]*n[2]+e[1]*n[3]+n[5]])[0]*o[0]-e[1]*o[1]+o[4],-e[0]*o[2]+e[1]*o[3]+o[5]]}}else r=function(e){return[(e[0]*n[0]+e[1]*n[1]+n[4])*s,(e[0]*n[2]+e[1]*n[3]+n[5])*s]}}else n=e.frameState.coordinateToPixelMatrix,r=function(e){return[(e[0]*n[0]+e[1]*n[1]+n[12])*s,(e[0]*n[4]+e[1]*n[5]+n[13])*s]};var l=this.feature_.getGeometry().getCoordinates();function u(e){for(var t=0;t<l.length;t++)for(var a=l[t],s=0;s<a.length;s++){var n=r([a[s][0][0]+e,a[s][0][1]]);i.moveTo(n[0],n[1]);for(var o=1;o<a[s].length;o++)n=r([a[s][o][0]+e,a[s][o][1]]),i.lineTo(n[0],n[1])}}if("Polygon"===this.feature_.getGeometry().getType()&&(l=[l]),i.beginPath(),t&&(i.moveTo(-100,-100),i.lineTo(a.width+100,-100),i.lineTo(a.width+100,a.height+100),i.lineTo(-100,a.height+100),i.lineTo(-100,-100)),this.get("wrapX")){var h=e.frameState.viewState.projection.getExtent(),c=h[2]-h[0],d=e.frameState.extent,p=this.feature_.getGeometry().getExtent(),f=p[2]-p[1],m=Math.floor((d[0]-f-h[0])/c),g=Math.floor((d[2]+f-h[2])/c)+1;m>g&&([m,g]=[g,m]);for(var y=m;y<=g;y++)u(y*c)}else u(0)}postcompose(e){if(this.feature_){var t=e.context;if(t.save(),this.drawFeaturePath_(e,!this.get("inner")),t.fillStyle=this._fillColor,t.fill("evenodd"),this.get("shadowWidth")){var r=this.get("shadowWidth")*e.frameState.pixelRatio;this.get("shadowMapUnits")&&(r/=e.frameState.viewState.resolution),t.clip("evenodd"),t.filter="blur("+r+"px)",t.strokeStyle=this._shadowColor,t.lineCap="round",t.lineJoin="round",t.lineWidth=r,t.stroke()}t.restore()}}}}),n("izcbS",function(e,r){t(e.exports,"default",()=>a);var i=s("gvREW"),a=class extends i.default{constructor(e){super(e=e||{})}precompose(e){if(this.feature_){var t=e.context;t.save(),this.drawFeaturePath_(e,this.get("inner")),t.clip("evenodd")}}postcompose(e){if(this.feature_){var t=e.context;if(t.restore(),this.get("shadowWidth")){t.save();var r=this.get("shadowWidth")*e.frameState.pixelRatio;this.get("shadowMapUnits")&&(r/=e.frameState.viewState.resolution),this.drawFeaturePath_(e,!this.get("inner")),t.clip("evenodd"),t.filter="blur("+r+"px)",t.strokeStyle=this._shadowColor,t.lineCap="round",t.lineJoin="round",t.lineWidth=r,t.stroke(),t.restore()}}}}}),n("juLo9",function(e,r){t(e.exports,"render2Feature",()=>m),t(e.exports,"default",()=>g);var i=s("iGyOD"),a=s("29SgV"),n=s("7qu5m"),o=s("d1ltq"),l=s("jZquI"),u=s("gzr8q"),h=s("23ytq"),c=s("iQyfo"),d=s("l956U"),p=s("86esn");let f=i.default.prototype.clone;function m(e){let t=[],r=e.getFlatCoordinates();for(var a=0;a<r.length;a+=2)t.push([r[a],r[a+1]]);switch(e.getType()){case"Point":t=t.pop();break;case"LineString":break;case"MultiLineString":case"Polygon":t=[t]}let s=(0,h.ol_geom_createFromType)(e.getType(),t),n=new i.default(s);return n.setProperties(e.getProperties()),n.setLayer(e.getLayer()),n}i.default.prototype.clone=function(){let e=f.call(this);return e.setIgnStyle(Object.assign({},this.getIgnStyle())),e.setPopupContent(this.getPopupContent()),e},i.default.prototype.getLayer=function(){return this._layer},i.default.prototype.setLayer=function(e){this._layer=e},i.default.prototype.getIgnStyle=function(e,t){if((!this._ignStyle||Array.isArray(this._ignStyle))&&(this._ignStyle={}),!e)return this._ignStyle;if(!0===e){t=t||{};let e={},i=this.getGeometry().getType();for(var r in p.ignStyleDef)(0,p.ignStyleDef)[r].geom.test(i)&&(e[r]=t[r]||this.getIgnStyle(r));return e}return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:Object.prototype.hasOwnProperty.call(this._ignStyle,e)?this._ignStyle[e]:this.getLayer()&&this.getLayer()._ignStyle&&Object.prototype.hasOwnProperty.call(this.getLayer()._ignStyle,e)?this.getLayer()._ignStyle[e]:p.defaultIgnStyle[e]},i.default.prototype.setIgnStyle=function(e,t){if((!this._ignStyle||Array.isArray(this._ignStyle))&&(this._ignStyle={}),void 0===t){e&&"string"!=typeof e&&(this._ignStyle=e);return}""!==t&&/width|radius|size|offset/i.test(e)&&(t=Number(t)),p.ignStyleDef[e]&&(0,p.ignStyleDef)[e].geom.test(this.getGeometry().getType())&&(this.getLayer()&&this.getLayer()._ignStyle&&Object.prototype.hasOwnProperty.call(this.getLayer()._ignStyle,e)&&t!=this.getLayer()._ignStyle[e]?this._ignStyle[e]=t:""!==t&&t!=p.defaultIgnStyle[e]?this._ignStyle[e]=t:delete this._ignStyle[e])},i.default.prototype.hasPopupContent=function(){return!!(this._popupContent&&!1!==this._popupContent.active||this.getLayer()&&this.getLayer().getPopupContent&&this.getLayer().getPopupContent())},i.default.prototype.getPopupContent=function(e,t){if(!e)return this._popupContent||{};if(this._popupContent&&this._popupContent.active?e=this._popupContent:!0===e&&(e=this.getLayer()&&this.getLayer().getPopupContent?this.getLayer().getPopupContent():""),!e)return"";var r=(e.titre?"####"+e.titre+"\n":"")+(e.desc?e.desc+"\n":"")+(e.img?"!("+e.img+")\n":"")+(e.coord?"**%COORD%**":"");r=r.replace(/\n$/,"");let i=this.getMDProperties();var a=(0,d.default)(r,i);if(t)return a;let s=(0,c.default).create("DIV",{html:a,className:"md"});return(0,d.default).renderWidget(s),s},i.default.prototype.getMDProperties=function(){let e;let t=this.getProperties();delete t[this.getGeometryName()];let r=this.getGeometry();switch(r.getType()){case"LineString":case"MultiLineString":e=r.getClosestPoint((0,l.getCenter)(r.getExtent())),t.LENGTH||(t.LENGTH=function(e){let t=(0,n.getLength)(e);return t>100?Math.round(t/1e3*100)/100+" km":Math.round(100*t)/100+" m"}(r));break;case"Polygon":case"MultiPolygon":e=r.getInteriorPoint?r.getInteriorPoint().getCoordinates():r.getInteriorPoints().getCoordinates()[0],t.AREA||(t.AREA=function(e){let t=Math.abs((0,n.getArea)(e));return t>1e4?Math.round(t/1e6*100)/100+" km²":Math.round(100*t)/100+" m²"}(r));break;default:e=r.getFirstCoordinate()}let i=(0,u.transform)(e,"EPSG:3857","EPSG:4326"),a=i[0].toFixed(6),s=i[1].toFixed(6);return t.COORD||(t.COORD=(s<0?-s:s)+"&deg;"+(s<0?"S":"N")+" "+(a<0?-a:a)+"&deg;"+(a<0?"O":"E")),t.COORDMS||(t.COORDMS=(0,o.toStringHDMS)(i).replace(/ /g,"").replace("N","N ").replace("S","S ")),t.LON||(t.LON=a),t.LAT||(t.LAT=s),this._indicator&&(t.INDICATOR=this._indicator,t["INDICATOR="+this._indicator]=this._indicator),t},i.default.prototype.getInfoContent=function(){let e=this.getPopupContent(!0,!0).replace(/<br ?\/>|<\/h.?>/g," ");return(0,c.default).create("DIV",{html:e}).innerText.substr(0,50)},i.default.prototype.setPopupContent=function(e){!e||e instanceof Array?this._popupContent={}:this._popupContent=e},i.default.prototype.getLabelContent=function(e){if(!e)return"";let t=e.replace(/\n$/,"");return(0,d.default).deSecure((0,d.default).doData(t,this.getProperties())).replace(/<br ?\/>/,"")},i.default.prototype.showPopup=function(e,t,r){let i;i=this.get("features")||[this];let a=this.popupIndex_,s=[],n=[];for(let a=0;a<i.length;a++){let o=i[a];if(o.getLayer().getMode&&"cluster"==o.getLayer().getMode()&&"stat"==o.getLayer().get("clusterType")&&0==o.getLayer().getStyle()(o).length)continue;let l=o.getPopupContent(!0);(l.innerText.trim()||l.querySelector("canvas")||l.querySelector("img"))&&(t||(t=e.getPosition()||(r||o.getGeometry()).getFirstCoordinate()),e.setOffset([0,0]),s.push(l),n.push(o))}if(s.length){if("Point"===this.getGeometry().getType()){var o=e.offsetBox;if(this.getLayer&&this.getLayer()&&this.getLayer().getIgnStyle){var l=this.getLayer().getIgnStyle(this),u=/left|right/.test(e.autoPositioning[0])?l.pointRadius:0;e.offsetBox=[-u,(l.pointOffsetY?-2:-1)*l.pointRadius,u,l.pointOffsetY?0:l.pointRadius]}r?e.show(r.getClosestPoint(t),s,n,a):e.show(this.getGeometry().getFirstCoordinate(),s,n,a),e.offsetBox=o}else/polygon/i.test(this.getGeometry().getType())?e.show(t,s,n,a):e.show(this.getGeometry().getClosestPoint(t),s,n,a)}else e.hide();return(0,d.default).renderWidget(e.getElement()),s},a.default.prototype.getIgnStyle=i.default.prototype.getIgnStyle,a.default.prototype.getLayer=i.default.prototype.getLayer,a.default.prototype.setLayer=i.default.prototype.setLayer,a.default.prototype.showPopup=function(e,t,r){return m(this).showPopup(e,t,r)},a.default.prototype.getPopupContent=i.default.prototype.getPopupContent,a.default.prototype.getInfoContent=i.default.prototype.getInfoContent,a.default.prototype.getMDProperties=function(){return this.getProperties()};var g=i.default}),n("23ytq",function(e,r){t(e.exports,"ol_coordinate_dist2d",()=>f),t(e.exports,"ol_coordinate_equal",()=>m),t(e.exports,"ol_coordinate_offsetCoords",()=>g),t(e.exports,"ol_coordinate_findSegment",()=>y),t(e.exports,"ol_geom_createFromType",()=>v);var i,a=s("hvEnP"),n=s("fYB0A"),o=s("7TB1l"),l=s("ljDIj"),u=s("dEQmT"),h=s("j2K3b"),c=s("cgPpQ"),d=s("iTxNH"),p=s("jZquI"),f=function(e,t){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)},m=function(e,t){return e[0]==t[0]&&e[1]==t[1]},g=function(e,t){var r,i,a,s,n,o,l,u,h,c,d,p,g,y=[],v=e.length-1,_=v,x=m(e[0],e[v]);!x&&(d=e[0],p=e[1],y.push(g=[d[0]+(p[1]-d[1])/f(d,p)*t,d[1]-(p[0]-d[0])/f(d,p)*t]),e.push(e[v]),v++,_--);for(var b=0;b<_;b++)d=e[b],p=e[(b+1)%v],g=e[(b+2)%v],Math.abs((r=(p[1]-d[1])/(p[0]-d[0]))-(i=(g[1]-p[1])/(g[0]-p[0])))>1e-10&&(a=Math.sqrt((p[0]-d[0])*(p[0]-d[0])+(p[1]-d[1])*(p[1]-d[1])),s=Math.sqrt((g[0]-p[0])*(g[0]-p[0])+(g[1]-p[1])*(g[1]-p[1])),n=d[0]+t*(p[1]-d[1])/a,h=(i*(o=p[0]+t*(g[1]-p[1])/s)-r*n+(l=d[1]-t*(p[0]-d[0])/a)-(u=p[1]-t*(g[0]-p[0])/s))/(i-r),c=(r*i*(o-n)+i*l-r*u)/(i-r),p[0]-d[0]==0&&(c=i*(h=p[0]+t*(p[1]-d[1])/Math.abs(p[1]-d[1]))-i*o+u),g[0]-p[0]==0&&(c=r*(h=g[0]+t*(g[1]-p[1])/Math.abs(g[1]-p[1]))-r*n+l),y.push([h,c]));return x?y.push(y[0]):(e.pop(),d=e[e.length-1],p=e[e.length-2],y.push(g=[d[0]-(p[1]-d[1])/f(d,p)*t,d[1]+(p[0]-d[0])/f(d,p)*t])),y},y=function(e,t){for(var r=0;r<t.length-1;r++){var i=t[r],a=t[r+1];if(m(e,i)||m(e,a))return{index:1,segment:[i,a]};var s=f(i,a),n=[(a[0]-i[0])/s,(a[1]-i[1])/s],o=f(i,e),l=[(e[0]-i[0])/o,(e[1]-i[1])/o];if(1e-10>Math.abs(n[0]*l[1]-n[1]*l[0]))return{index:1,segment:[i,a]}}return{index:-1}},v=function(e,t){switch(e){case"LineString":return new a.default(t);case"LinearRing":return new n.default(t);case"MultiLineString":return new o.default(t);case"MultiPoint":return new l.default(t);case"MultiPolygon":return new u.default(t);case"Point":return new h.default(t);case"Polygon":return new c.default(t);default:return console.error("[createFromType] Unsupported type: "+e),null}};!function(){function e(e,t){var r;for(let i=e.length-1;i>0;i--)(e[i][0]>t&&e[i-1][0]<t||e[i][0]<t&&e[i-1][0]>t)&&(r=[t,(t-e[i][0])/(e[i-1][0]-e[i][0])*(e[i-1][1]-e[i][1])+e[i][1]],e.splice(i,0,r))}function t(e,t){var r;for(let i=e.length-1;i>0;i--)(e[i][1]>t&&e[i-1][1]<t||e[i][1]<t&&e[i-1][1]>t)&&(r=[(t-e[i][1])/(e[i-1][1]-e[i][1])*(e[i-1][0]-e[i][0])+e[i][0],t],e.splice(i,0,r))}i=function(r,i){var a="Polygon"===i.getType();if(!a&&"MultiPolygon"!==i.getType())return null;var s=i.getCoordinates();return(a&&(s=[s]),s.forEach(function(i){i.forEach(function(i){e(i,r[0]),e(i,r[2]),t(i,r[1]),t(i,r[3])})}),s.forEach(function(e){e.forEach(function(e){e.forEach(function(e){e[0]<r[0]?e[0]=r[0]:e[0]>r[2]&&(e[0]=r[2]),e[1]<r[1]?e[1]=r[1]:e[1]>r[3]&&(e[1]=r[3])})})}),a)?new c.default(s[0]):new u.default(s)}}();var _=function(e,t,r,i){var a=[];!1!==i&&a.push(e);var s=f(e,t);if(s){var n=Math.round(s/r);if(n>1)for(var o=(t[0]-e[0])/n,l=(t[1]-e[1])/n,u=1;u<n;u++)a.push([e[0]+o*u,e[1]+l*u])}return a.push(t),a};a.default.prototype.sampleAt=function(e){for(var t=this.getCoordinates(),r=[],i=1;i<t.length;i++)r=r.concat(_(t[i-1],t[i],e,1===i));return new a.default(r)},o.default.prototype.sampleAt=function(e){var t=this.getCoordinates(),r=[];return t.forEach(function(t){for(var i=[],a=1;a<t.length;a++)i=i.concat(_(t[a-1],t[a],e,1===a));r.push(i)}),new o.default(r)},c.default.prototype.sampleAt=function(e){var t=this.getCoordinates(),r=[];return t.forEach(function(t){for(var i=[],a=1;a<t.length;a++)i=i.concat(_(t[a-1],t[a],e,1===a));r.push(i)}),new c.default(r)},u.default.prototype.sampleAt=function(e){var t=this.getCoordinates(),r=[];return t.forEach(function(t){var i=[];r.push(i),t.forEach(function(t){for(var r=[],a=1;a<t.length;a++)r=r.concat(_(t[a-1],t[a],e,1===a));i.push(r)})}),new u.default(r)},d.default.prototype.intersection=function(e,t){if(e.sampleAt){var r=(0,p.buffer)(this.getCenter().concat(this.getCenter()),this.getRadius());e=(e=i(r,e)).simplify(t);var a=this.getCenter(),s=this.getRadius(),n=e.sampleAt(t).getCoordinates();switch(e.getType()){case"Polygon":n=[n];case"MultiPolygon":var o=!1,l=[];if(n.forEach(function(e){var t=[];l.push(t),e.forEach(function(e){var r=[];t.push(r),e.forEach(function(e){var t=f(a,e);t>s?(o=!0,r.push([a[0]+s/t*(e[0]-a[0]),a[1]+s/t*(e[1]-a[1])])):r.push(e)})})}),!o)break;if("Polygon"===e.getType())return new c.default(l[0]);return new u.default(l)}}else console.warn("[ol/geom/Circle~intersection] Unsupported geometry type: "+e.getType());return e}}),n("iTxNH",function(e,r){t(e.exports,"default",()=>u);var i=s("jZquI"),a=s("63y7W"),n=s("ee3b9"),o=s("bsQCi");class l extends a.default{constructor(e,t,r){super(),void 0!==r&&void 0===t?this.setFlatCoordinates(r,e):(t=t||0,this.setCenterAndRadius(e,t,r))}clone(){let e=new l(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){let a=this.flatCoordinates,s=e-a[0],n=t-a[1],o=s*s+n*n;if(o<i){if(0===o)for(let e=0;e<this.stride;++e)r[e]=a[e];else{let e=this.getRadius()/Math.sqrt(o);r[0]=a[0]+e*s,r[1]=a[1]+e*n;for(let e=2;e<this.stride;++e)r[e]=a[e]}return r.length=this.stride,o}return i}containsXY(e,t){let r=this.flatCoordinates,i=e-r[0],a=t-r[1];return i*i+a*a<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){let t=this.flatCoordinates,r=t[this.stride]-t[0];return(0,i.createOrUpdate)(t[0]-r,t[1]-r,t[0]+r,t[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){let e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){let t=this.getExtent();if((0,i.intersects)(e,t)){let t=this.getCenter();return e[0]<=t[0]&&e[2]>=t[0]||e[1]<=t[1]&&e[3]>=t[1]||(0,i.forEachCorner)(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){let t=this.stride,r=this.flatCoordinates[t]-this.flatCoordinates[0],i=e.slice();i[t]=i[0]+r;for(let r=1;r<t;++r)i[t+r]=e[r];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,t,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);let i=this.flatCoordinates,a=(0,n.deflateCoordinate)(i,0,e,this.stride);i[a++]=i[0]+t;for(let e=1,t=this.stride;e<t;++e)i[a++]=i[e];i.length=a,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){let r=this.getCenter(),i=this.getStride();this.setCenter((0,o.rotate)(r,0,r.length,i,e,t,r)),this.changed()}}l.prototype.transform;var u=l}),n("86esn",function(e,r){t(e.exports,"textFontList",()=>i),t(e.exports,"ignStyleDef",()=>a),t(e.exports,"defaultIgnStyle",()=>s),t(e.exports,"pointFrameList",()=>n),t(e.exports,"symbolFormList",()=>o);let i={"sans-serif":{title:"Arial",font:"Arial, Helvetica, sans-serif"},serif:{title:"Times",font:"Times, Times New Roman, serif"},courier:{title:"Courier",font:"Courier, Courier New, monospace"},monospace:{title:"Monospace",font:"Monaco, Lucida Console, monospace"},cursive:{title:"Cursive",font:"Brush Script MT, cursive"},comic:{title:"Comic",font:"Comic Sans MS, cursive"}},a={pointRadius:{geom:/Point/,short:"prd",defaultValue:15},pointIcon:{geom:/Point/,short:"pi",defaultValue:""},pointGlyph:{geom:/Point/,short:"pgy",defaultValue:"ign-form-poi"},pointForm:{geom:/Point/,short:"pf",defaultValue:"none"},pointOffsetY:{geom:/Point/,short:"poy",defaultValue:0},pointShadow:{geom:/Point/,short:"ps",defaultValue:!1},symbolColor:{geom:/Point/,short:"pic",defaultValue:"#0000FF"},pointColor:{geom:/Point/,short:"pc",defaultValue:"#FFFFFF"},pointStrokeColor:{geom:/Point/,short:"psc",defaultValue:"#FFFFFF"},pointStrokeWidth:{geom:/Point/,short:"psw",defaultValue:2},pointFrame:{geom:/Point/,short:"pfr",defaultValue:""},pointCrop:{geom:/Point/,short:"pcp",defaultValue:!1},pointRotation:{geom:/Point/,short:"pr",defaultValue:0},pointGradient:{geom:/Point/,short:"pg",defaultValue:0},strokeWidth:{geom:/LineString|Polygon/,short:"sw",defaultValue:2},strokeDash:{geom:/LineString|Polygon/,short:"sd",defaultValue:""},strokeArrow:{geom:/LineString/,short:"sa",defaultValue:""},strokeColor:{geom:/LineString|Polygon/,short:"sc",defaultValue:"#f80"},fillColor:{geom:/Polygon/,short:"fc",defaultValue:"rgba(255,136,0,0.6)"},fillPattern:{geom:/Polygon/,short:"fp",defaultValue:""},sizePattern:{geom:/Polygon/,short:"fpz",defaultValue:5},spacingPattern:{geom:/Polygon/,short:"fps",defaultValue:10},anglePattern:{geom:/Polygon/,short:"fpa",defaultValue:0},offsetPattern:{geom:/Polygon/,short:"fpo",defaultValue:0},scalePattern:{geom:/Polygon/,short:"fpx",defaultValue:1},fillColorPattern:{geom:/Polygon/,short:"fpc",defaultValue:"rgba(0,0,0,0)"},zIndex:{geom:/Point|LineString|Polygon/,short:"zi",defaultValue:0},labelAttribute:{geom:/Point|LineString|Polygon/,short:"tla",defaultValue:""},textColor:{geom:/Point|LineString|Polygon/,short:"tc",defaultValue:"#000"},textStyle:{geom:/Point|LineString|Polygon/,short:"ts",defaultValue:"normal"},textSize:{geom:/Point|LineString|Polygon/,short:"tz",defaultValue:12},textFont:{geom:/Point|LineString|Polygon/,short:"tft",defaultValue:i["sans-serif"].font},textOutlineColor:{geom:/Point|LineString|Polygon/,short:"toc",defaultValue:""},textOutlineWidth:{geom:/Point|LineString|Polygon/,short:"tlw",defaultValue:3},textAlign:{geom:/Point|LineString|Polygon/,short:"tal",defaultValue:"left"},textBaseline:{geom:/Point|LineString|Polygon/,short:"tbl",defaultValue:"middle"},textBgFill:{geom:/Point/,short:"tbf",defaultValue:"rgba(0, 0, 0, 0)"},textBgStroke:{geom:/Point/,short:"tbs",defaultValue:"rgba(0, 0, 0, 0)"},textBgStrokeWidth:{geom:/Point/,short:"tbw",defaultValue:1.5},textOverflow:{geom:/LineString|Polygon/,short:"to",defaultValue:"#000"},textPlacement:{geom:/LineString/,short:"tp",defaultValue:"point"}},s={};for(let e in a)s[e]=a[e].defaultValue;let n={"":{title:"sans"},default:{title:"carré"},circle:{title:"cercle"},anchored:{title:"blason"},folio:{title:"folio"}},o={none:{title:"sans"},circle:{title:"cercle"},square:{title:"carré"},lozenge:{title:"losange"},hexagon:{title:"hexagone"},marker:{title:"marqueur"},poi:{title:"point d'interêt"},bubble:{title:"bulle"},blazon:{title:"blason"},shield:{title:"bouclier"},triangle:{title:"triangle"},coma:{title:"virgule"},bookmark:{title:"signet"},sign:{title:"panneau triangle"},ban:{title:"panneau interdit"}}}),n("3AtWD",function(e,r){t(e.exports,"default",()=>n);var i=s("bkg8x");class a extends i.default{constructor(e){super(e=e||{}),this.filter_=e.filter?e.filter:this.defaultFilter,this.currentSelection_=[],this.currentSelectionIds_=[],this.shownFeature,this.shownCluster_,this.shownStyle_=e.shownStyle?e.shownStyle:this.getStyle(),this.indexShownFeature=1,this.on("select",()=>{this.shownCluster_=null,this.setShownFeature(this.getFeatures().item(0))})}setMap(e){this.getMap()&&this.getMap().getView().removeEventListener("change:resolution",this.removeSelectedClusters_),super.setMap(e),e&&e.getView().on("change:resolution",this.removeSelectedClusters_)}removeSelectedClusters_(){if(this.getFeatures)for(let e=this.getFeatures().getLength()-1;0==e;e--){let t=this.getFeatures().item(e);t&&t.get("features") instanceof Array&&this.getFeatures().removeAt(e)}}getIndex(){return this.indexShownFeature}setIndex(e){e&&parseInt(e)&&(this.indexShownFeature=e)}getShownFeature(){return this.shownFeature}setShownFeature(e){if(this.shownFeature!==e&&(this.dispatchEvent({type:"select:show",shown_feature:e,unshown_feature:this.shownFeature,index:this.getIndex()}),this.shownFeature&&this.removeShownStyle(this.shownFeature),this.shownFeature=e,this.shownFeature)){let e=!0;if(this.shownCluster_&&!this.shownCluster_.get("features").includes(this.shownFeature)&&(this.removeShownStyle(this.shownCluster_),this.shownCluster_=null),this.shownCluster_)e=!1;else for(let t=0;t<this.getFeatures().getLength();t++){let r=this.getFeatures().item(t),i=r.get("features");if(i instanceof Array&&i.includes(this.shownFeature)){this.shownCluster_=r,this.applyShownStyle(this.shownCluster_),e=!1;break}}e&&this.applyShownStyle(this.shownFeature)}}applyShownStyle(e){e.setStyle(this.shownStyle_)}removeShownStyle(e){e.getStyle()&&e.setStyle(this.getStyle())}defaultFilter(e,t){if(t.selectable&&t.selectable()){if(0!=this.currentSelection_.length){let t;let r=this.currentSelection_[0];if((t=r&&r.get("features") instanceof Array?r.get("features")[0].getLayer():r.getLayer()).get("multiSelect")){if((e&&e.get("features") instanceof Array?e.get("features")[0].getLayer().ol_uid:e.getLayer().ol_uid)!=t.ol_uid)return!1}else if(1==this.currentSelection_.length)return r.ol_uid===e.ol_uid;else return!1}return this.currentSelectionIds_.includes(e.ol_uid)||(this.currentSelection_.push(e),this.currentSelectionIds_.push(e.ol_uid)),!0}return!1}clearCurrentSelectionArrays(){this.currentSelection_=[],this.currentSelectionIds_=[]}}var n=a}),n("bkg8x",function(e,r){t(e.exports,"default",()=>l);var i=s("dUROT"),a=s("29SgV"),n=s("juLo9");class o extends i.default{constructor(e){super(e)}}o.prototype.dispatchEvent=function(e){"select"===e.type&&e.selected.forEach((t,r)=>{if(t instanceof a.default){this.getFeatures().remove(t);let i=(0,n.render2Feature)(t);e.selected[r]=i,this.getFeatures().push(i)}}),(0,i.default).prototype.dispatchEvent.call(this,e)},(a.default.prototype.getStyle||a.default.prototype.addEventListener)&&console.warn("[Select] RenderFeature is overwritten!"),a.default.prototype.getStyle=function(){},a.default.prototype.setStyle=function(){},a.default.prototype.addEventListener=function(){},a.default.prototype.removeEventListener=function(){};var l=o}),n("dUROT",function(e,r){t(e.exports,"default",()=>x);var i=s("31ZqB"),a=s("eHnTw"),n=s("iGyOD"),o=s("kBSVF"),l=s("iTTi2"),u=s("btuox"),h=s("eQaCk"),c=s("610XN"),d=s("kKEgb"),p=s("l9IGS"),f=s("lVQul"),m=s("7lBr2");let g={SELECT:"select"};class y extends l.default{constructor(e,t,r,i){super(e),this.selected=t,this.deselected=r,this.mapBrowserEvent=i}}let v={};class _ extends m.default{constructor(e){let t;if(super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:u.singleClick,this.addCondition_=e.addCondition?e.addCondition:u.never,this.removeCondition_=e.removeCondition?e.removeCondition:u.never,this.toggleCondition_=e.toggleCondition?e.toggleCondition:u.shiftKeyOnly,this.multi_=!!e.multi&&e.multi,this.filter_=e.filter?e.filter:h.TRUE,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=void 0!==e.style?e.style:function(){let e=(0,p.createEditingStyle)();return(0,o.extend)(e.Polygon,e.LineString),(0,o.extend)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(),this.features_=e.features||new i.default,e.layers){if("function"==typeof e.layers)t=e.layers;else{let r=e.layers;t=function(e){return r.includes(e)}}}else t=h.TRUE;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[(0,f.getUid)(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[(0,f.getUid)(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(a.default.ADD,this.boundAddFeature_),this.features_.addEventListener(a.default.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(a.default.ADD,this.boundAddFeature_),this.features_.removeEventListener(a.default.REMOVE,this.boundRemoveFeature_))}addFeature_(e){let t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){let e=this.getMap().getAllLayers().find(function(e){if(e instanceof c.default&&e.getSource()&&e.getSource().hasFeature(t))return e});e&&this.addFeatureLayerAssociation_(t,e)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){let t=(0,f.getUid)(e);t in v||(v[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){let t=this.getMap().getInteractions().getArray();for(let r=t.length-1;r>=0;--r){let i=t[r];if(i!==this&&i instanceof _&&i.getStyle()&&-1!==i.getFeatures().getArray().lastIndexOf(e)){e.setStyle(i.getStyle());return}}let r=(0,f.getUid)(e);e.setStyle(v[r]),delete v[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[f.getUid(e)]}handleEvent(e){if(!this.condition_(e))return!0;let t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),a=e.map,s=this.getFeatures(),o=[],l=[];if(t||r||i){a.forEachFeatureAtPixel(e.pixel,(e,a)=>{if(e instanceof n.default&&this.filter_(e,a))return(t||i)&&!s.getArray().includes(e)?(this.addFeatureLayerAssociation_(e,a),l.push(e)):(r||i)&&s.getArray().includes(e)&&(o.push(e),this.removeFeatureLayerAssociation_(e)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=o.length-1;e>=0;--e)s.remove(o[e]);s.extend(l)}else{(0,d.clear)(this.featureLayerAssociation_),a.forEachFeatureAtPixel(e.pixel,(e,t)=>{if(e instanceof n.default&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),l.push(e),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=s.getLength()-1;e>=0;--e){let t=s.item(e),r=l.indexOf(t);r>-1?l.splice(r,1):(s.remove(t),o.push(t))}0!==l.length&&s.extend(l)}return(l.length>0||o.length>0)&&this.dispatchEvent(new y(g.SELECT,l,o,e)),!0}}var x=_}),n("610XN",function(e,r){t(e.exports,"default",()=>o);var i=s("6M65l"),a=s("2YyN3");class n extends a.default{constructor(e){super(e)}createRenderer(){return new i.default(this)}}var o=n}),n("6M65l",function(e,r){t(e.exports,"default",()=>v);var i=s("bCUH1"),a=s("kBSVF"),n=s("d1ltq"),o=s("cgxQK"),l=s("jZquI"),u=s("gzr8q"),h=s("6ej6F"),c=s("8vXOK"),d=s("dVSax"),p=s("3CYjy"),f=s("lVQul"),m=s("713Fw"),g=s("ddIVC");class y extends g.default{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,l.createEmpty)(),this.wrappedRenderedExtent_=(0,l.createEmpty)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){let a=t.extent,s=t.viewState,n=s.center,o=s.resolution,u=s.projection,h=s.rotation,c=u.getExtent(),p=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),m=t.pixelRatio,g=t.viewHints,y=!(g[i.default.ANIMATING]||g[i.default.INTERACTING]),v=this.context,_=Math.round((0,l.getWidth)(a)/o*m),x=Math.round((0,l.getHeight)(a)/o*m),b=p.getWrapX()&&u.canWrapX(),S=b?(0,l.getWidth)(c):null,w=b?Math.ceil((a[2]-c[2])/S)+1:1,E=b?Math.floor((a[0]-c[0])/S):0;do{let i=this.getRenderTransform(n,o,0,m,_,x,E*S);t.declutter&&(i=i.slice(0)),e.execute(v,[v.canvas.width,v.canvas.height],i,h,y,void 0===r?d.ALL:r?d.DECLUTTER:d.NON_DECLUTTER,r?f&&t.declutter[f]:void 0)}while(++E<w)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=(0,o.createCanvasContext2D)(this.context.canvas.width,this.context.canvas.height,g.canvasPool))}resetDrawContext_(){if(1!==this.opacity_){let e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,(0,o.releaseCanvas)(this.context),(0,g.canvasPool).push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){let r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;let i=e.viewState;this.prepareContainer(e,t);let a=this.context,s=this.replayGroup_,n=s&&!s.isEmpty();if(!n&&!(this.getLayer().hasListener(h.default.PRERENDER)||this.getLayer().hasListener(h.default.POSTRENDER)))return null;this.setDrawContext_(),this.preRender(a,e);let o=i.projection;if(this.clipped_=!1,n&&r.extent&&this.clipping){let t=(0,u.fromUserExtent)(r.extent,o);n=(0,l.intersects)(t,e.extent),this.clipped_=n&&!(0,l.containsExtent)(t,e.extent),this.clipped_&&this.clipUnrotated(a,e,t)}return n&&this.renderWorlds(s,e,!this.getLayer().getDeclutter()&&void 0),!e.declutter&&this.clipped_&&a.restore(),this.postRender(a,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){let e=this.frameState.size.slice(),t=this.renderedCenter_,r=this.renderedResolution_,i=this.renderedRotation_,a=this.renderedProjection_,s=this.wrappedRenderedExtent_,n=this.getLayer(),o=[],h=e[0]*p.HIT_DETECT_RESOLUTION,c=e[1]*p.HIT_DETECT_RESOLUTION;o.push(this.getRenderTransform(t,r,i,p.HIT_DETECT_RESOLUTION,h,c,0).slice());let d=n.getSource(),f=a.getExtent();if(d.getWrapX()&&a.canWrapX()&&!(0,l.containsExtent)(f,s)){let e,a=s[0],n=(0,l.getWidth)(f),u=0;for(;a<f[0];)e=n*--u,o.push(this.getRenderTransform(t,r,i,p.HIT_DETECT_RESOLUTION,h,c,e).slice()),a+=n;for(u=0,a=s[2];a>f[2];)e=n*++u,o.push(this.getRenderTransform(t,r,i,p.HIT_DETECT_RESOLUTION,h,c,e).slice()),a-=n}let g=(0,u.getUserProjection)();this.hitDetectionImageData_=(0,p.createHitDetectionImageData)(e,o,this.renderedFeatures_,n.getStyleFunction(),s,r,i,(0,m.getSquaredTolerance)(r,this.renderedPixelRatio_),g?a:null)}t((0,p.hitDetect)(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,a){if(!this.replayGroup_)return;let s=t.viewState.resolution,n=t.viewState.rotation,o=this.getLayer(),l={},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,s,n,r,function(e,t,r){let s=(0,f.getUid)(e),n=l[s];if(n){if(!0!==n&&r<n.distanceSq){if(0===r)return l[s]=!0,a.splice(a.lastIndexOf(n),1),i(e,o,t);n.geometry=t,n.distanceSq=r}}else{if(0===r)return l[s]=!0,i(e,o,t);a.push(l[s]={feature:e,layer:o,geometry:t,distanceSq:r,callback:i})}},u?t.declutter?.[u]?.all().map(e=>e.value):null)}handleFontsChanged(){let e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){let t;let r=this.getLayer(),s=r.getSource();if(!s)return!1;let o=e.viewHints[i.default.ANIMATING],h=e.viewHints[i.default.INTERACTING],p=r.getUpdateWhileAnimating(),f=r.getUpdateWhileInteracting();if(this.ready&&!p&&o||!f&&h)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;let g=e.extent,y=e.viewState,v=y.projection,_=y.resolution,x=e.pixelRatio,b=r.getRevision(),S=r.getRenderBuffer(),w=r.getRenderOrder();void 0===w&&(w=m.defaultOrder);let E=y.center.slice(),A=(0,l.buffer)(g,S*_),T=A.slice(),C=[A.slice()],P=v.getExtent();if(s.getWrapX()&&v.canWrapX()&&!(0,l.containsExtent)(P,e.extent)){let e=(0,l.getWidth)(P),t=Math.max((0,l.getWidth)(A)/2,e);A[0]=P[0]-t,A[2]=P[2]+t,(0,n.wrapX)(E,v);let r=(0,l.wrapX)(C[0],v);r[0]<P[0]&&r[2]<P[2]?C.push([r[0]+e,r[1],r[2]+e,r[3]]):r[0]>P[0]&&r[2]>P[2]&&C.push([r[0]-e,r[1],r[2]-e,r[3]])}if(this.ready&&this.renderedResolution_==_&&this.renderedRevision_==b&&this.renderedRenderOrder_==w&&!!e.declutter===this.renderedFrameDeclutter_&&(0,l.containsExtent)(this.wrappedRenderedExtent_,A))return(0,a.equals)(this.renderedExtent_,T)||(this.hitDetectionImageData_=null,this.renderedExtent_=T),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;let R=new c.default((0,m.getTolerance)(_,x),A,_,x),I=(0,u.getUserProjection)();if(I){for(let e=0,t=C.length;e<t;++e){let t=C[e],r=(0,u.toUserExtent)(t,v);s.loadFeatures(r,(0,u.toUserResolution)(_,v),I)}t=(0,u.getTransformFromProjections)(I,v)}else for(let e=0,t=C.length;e<t;++e)s.loadFeatures(C[e],_,v);let L=(0,m.getSquaredTolerance)(_,x),O=!0,M=(e,i)=>{let a;let s=e.getStyleFunction()||r.getStyleFunction();if(s&&(a=s(e,_)),a){let r=this.renderFeature(e,L,a,R,t,this.getLayer().getDeclutter(),i);O=O&&!r}},k=(0,u.toUserExtent)(A,v),N=s.getFeaturesInExtent(k);w&&N.sort(w);for(let e=0,t=N.length;e<t;++e)M(N[e],e);this.renderedFeatures_=N,this.ready=O;let D=R.finish(),F=new d.default(A,_,x,s.getOverlaps(),D,r.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=_,this.renderedRevision_=b,this.renderedRenderOrder_=w,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=T,this.wrappedRenderedExtent_=A,this.renderedCenter_=E,this.renderedProjection_=v,this.renderedPixelRatio_=x,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,a,s,n){if(!r)return!1;let o=!1;if(Array.isArray(r))for(let l=0,u=r.length;l<u;++l)o=(0,m.renderFeature)(i,e,r[l],t,this.boundHandleStyleImageChange_,a,s,n)||o;else o=(0,m.renderFeature)(i,e,r,t,this.boundHandleStyleImageChange_,a,s,n);return o}}var v=y}),n("8vXOK",function(e,r){t(e.exports,"default",()=>h);var i=s("hycMe"),a=s("6sg4t"),n=s("1aWBL"),o=s("jODk1"),l=s("a0SEX");let u={Circle:o.default,Default:i.default,Image:a.default,LineString:n.default,Polygon:o.default,Text:l.default};var h=class{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){let e={};for(let t in this.buildersByZIndex_){e[t]=e[t]||{};let r=this.buildersByZIndex_[t];for(let i in r){let a=r[i].finish();e[t][i]=a}}return e}getBuilder(e,t){let r=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[r];void 0===i&&(i={},this.buildersByZIndex_[r]=i);let a=i[t];return void 0===a&&(a=new u[t](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=a),a}}}),n("hycMe",function(e,r){t(e.exports,"default",()=>p);var i=s("kBSVF"),a=s("hlW0i"),n=s("iweSO"),o=s("jZquI"),l=s("iTdJV"),u=s("eGc18"),h=s("aHG4Z"),c=s("2CzCP");class d extends u.default{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){let t=this.pixelRatio;return 1==t?e:e.map(function(e){return e*t})}appendFlatPointCoordinates(e,t){let r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,a=this.coordinates,s=a.length;for(let n=0,l=e.length;n<l;n+=t)i[0]=e[n],i[1]=e[n+1],(0,o.containsCoordinate)(r,i)&&(a[s++]=i[0],a[s++]=i[1]);return s}appendFlatLineCoordinates(e,t,r,i,a,s){let l,u,h;let c=this.coordinates,d=c.length,p=this.getBufferedMaxExtent();s&&(t+=i);let f=e[t],m=e[t+1],g=this.tmpCoordinate_,y=!0;for(l=t+i;l<r;l+=i)g[0]=e[l],g[1]=e[l+1],(h=(0,o.coordinateRelationship)(p,g))!==u?(y&&(c[d++]=f,c[d++]=m,y=!1),c[d++]=g[0],c[d++]=g[1]):h===n.default.INTERSECTING?(c[d++]=g[0],c[d++]=g[1],y=!1):y=!0,f=g[0],m=g[1],u=h;return(a&&y||l===t+i)&&(c[d++]=f,c[d++]=m),d}drawCustomCoordinates_(e,t,r,i,a){for(let s=0,n=r.length;s<n;++s){let n=r[s],o=this.appendFlatLineCoordinates(e,t,n,i,!1,!1);a.push(o),t=n}return t}drawCustom(e,t,r,i,a){let s,n,o,u,h;this.beginGeometry(e,t,a);let d=e.getType(),p=e.getStride(),f=this.coordinates.length;switch(d){case"MultiPolygon":s=e.getOrientedFlatCoordinates(),u=[];let m=e.getEndss();h=0;for(let e=0,t=m.length;e<t;++e){let t=[];h=this.drawCustomCoordinates_(s,h,m[e],p,t),u.push(t)}this.instructions.push([c.default.CUSTOM,f,u,e,r,l.inflateMultiCoordinatesArray,a]),this.hitDetectionInstructions.push([c.default.CUSTOM,f,u,e,i||r,l.inflateMultiCoordinatesArray,a]);break;case"Polygon":case"MultiLineString":o=[],s="Polygon"==d?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),h=this.drawCustomCoordinates_(s,0,e.getEnds(),p,o),this.instructions.push([c.default.CUSTOM,f,o,e,r,l.inflateCoordinatesArray,a]),this.hitDetectionInstructions.push([c.default.CUSTOM,f,o,e,i||r,l.inflateCoordinatesArray,a]);break;case"LineString":case"Circle":s=e.getFlatCoordinates(),n=this.appendFlatLineCoordinates(s,0,s.length,p,!1,!1),this.instructions.push([c.default.CUSTOM,f,n,e,r,l.inflateCoordinates,a]),this.hitDetectionInstructions.push([c.default.CUSTOM,f,n,e,i||r,l.inflateCoordinates,a]);break;case"MultiPoint":s=e.getFlatCoordinates(),(n=this.appendFlatPointCoordinates(s,p))>f&&(this.instructions.push([c.default.CUSTOM,f,n,e,r,l.inflateCoordinates,a]),this.hitDetectionInstructions.push([c.default.CUSTOM,f,n,e,i||r,l.inflateCoordinates,a]));break;case"Point":s=e.getFlatCoordinates(),this.coordinates.push(s[0],s[1]),n=this.coordinates.length,this.instructions.push([c.default.CUSTOM,f,n,e,r,void 0,a]),this.hitDetectionInstructions.push([c.default.CUSTOM,f,n,e,i||r,void 0,a])}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[c.default.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[c.default.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let e,t,r;let a=this.hitDetectionInstructions;a.reverse();let s=a.length,n=-1;for(e=0;e<s;++e)(r=(t=a[e])[0])==c.default.END_GEOMETRY?n=e:r==c.default.BEGIN_GEOMETRY&&(t[2]=e,(0,i.reverseSubArray)(this.hitDetectionInstructions,n,e),n=-1)}fillStyleToState(e,t={}){if(e){let r=e.getColor();t.fillPatternScale=r&&"object"==typeof r&&"src"in r?this.pixelRatio:1,t.fillStyle=(0,a.asColorLike)(r||h.defaultFillStyle)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){let r=e.getColor();t.strokeStyle=(0,a.asColorLike)(r||h.defaultStrokeStyle);let i=e.getLineCap();t.lineCap=void 0!==i?i:h.defaultLineCap;let s=e.getLineDash();t.lineDash=s?s.slice():h.defaultLineDash;let n=e.getLineDashOffset();t.lineDashOffset=n||h.defaultLineDashOffset;let o=e.getLineJoin();t.lineJoin=void 0!==o?o:h.defaultLineJoin;let l=e.getWidth();t.lineWidth=void 0!==l?l:h.defaultLineWidth;let u=e.getMiterLimit();t.miterLimit=void 0!==u?u:h.defaultMiterLimit,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){let r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){let t=e.fillStyle,r=[c.default.SET_FILL_STYLE,t];return"string"!=typeof t&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[c.default.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){let r=e.fillStyle;("string"!=typeof r||e.currentFillStyle!=r)&&(void 0!==r&&this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){let r=e.strokeStyle,a=e.lineCap,s=e.lineDash,n=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,u=e.miterLimit;e.currentStrokeStyle==r&&e.currentLineCap==a&&(s==e.currentLineDash||(0,i.equals)(e.currentLineDash,s))&&e.currentLineDashOffset==n&&e.currentLineJoin==o&&e.currentLineWidth==l&&e.currentMiterLimit==u||(void 0!==r&&t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=a,e.currentLineDash=s,e.currentLineDashOffset=n,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let t=[c.default.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,o.clone)(this.maxExtent),this.maxLineWidth>0)){let e=this.resolution*(this.maxLineWidth+1)/2;(0,o.buffer)(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}var p=d}),n("eGc18",function(e,r){t(e.exports,"default",()=>i);var i=class{drawCustom(e,t,r,i,a){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}}),n("2CzCP",function(e,r){t(e.exports,"fillInstruction",()=>a),t(e.exports,"strokeInstruction",()=>s),t(e.exports,"beginPathInstruction",()=>n),t(e.exports,"closePathInstruction",()=>o),t(e.exports,"default",()=>l);let i={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},a=[i.FILL],s=[i.STROKE],n=[i.BEGIN_PATH],o=[i.CLOSE_PATH];var l=i}),n("6sg4t",function(e,r){t(e.exports,"default",()=>l);var i=s("jZquI"),a=s("hycMe"),n=s("2CzCP");class o extends a.default{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!(0,i.containsCoordinate)(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);let a=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(a,s);this.instructions.push([n.default.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.default.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);let a=e.getFlatCoordinates(),s=[];for(let t=0,r=a.length;t<r;t+=e.getStride())(!this.maxExtent||(0,i.containsCoordinate)(this.maxExtent,a.slice(t,t+2)))&&s.push(a[t],a[t+1]);let o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([n.default.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.default.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){let r=e.getAnchor(),i=e.getSize(),a=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}var l=o}),n("1aWBL",function(e,r){t(e.exports,"default",()=>l);var i=s("aHG4Z"),a=s("hycMe"),n=s("2CzCP");class o extends a.default{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){let a=this.coordinates.length,s=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[n.default.MOVE_TO_LINE_TO,a,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){let a=this.state,s=a.strokeStyle,o=a.lineWidth;if(void 0===s||void 0===o)return;this.updateStrokeStyle(a,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([n.default.SET_STROKE_STYLE,a.strokeStyle,a.lineWidth,a.lineCap,a.lineJoin,a.miterLimit,i.defaultLineDash,i.defaultLineDashOffset],n.beginPathInstruction);let l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(n.strokeInstruction),this.endGeometry(t)}drawMultiLineString(e,t,r){let a=this.state,s=a.strokeStyle,o=a.lineWidth;if(void 0===s||void 0===o)return;this.updateStrokeStyle(a,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([n.default.SET_STROKE_STYLE,a.strokeStyle,a.lineWidth,a.lineCap,a.lineJoin,a.miterLimit,i.defaultLineDash,i.defaultLineDashOffset],n.beginPathInstruction);let l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride(),c=0;for(let e=0,t=l.length;e<t;++e)c=this.drawFlatCoordinates_(u,c,l[e],h);this.hitDetectionInstructions.push(n.strokeInstruction),this.endGeometry(t)}finish(){let e=this.state;return void 0!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(n.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){void 0!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(n.strokeInstruction),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(n.beginPathInstruction)}}var l=o}),n("jODk1",function(e,r){t(e.exports,"default",()=>u);var i=s("exEDy"),a=s("aHG4Z"),n=s("hycMe"),o=s("2CzCP");class l extends n.default{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){let a=this.state,s=void 0!==a.fillStyle,n=void 0!==a.strokeStyle,l=r.length;this.instructions.push(o.beginPathInstruction),this.hitDetectionInstructions.push(o.beginPathInstruction);for(let a=0;a<l;++a){let s=r[a],l=this.coordinates.length,u=this.appendFlatLineCoordinates(e,t,s,i,!0,!n),h=[o.default.MOVE_TO_LINE_TO,l,u];this.instructions.push(h),this.hitDetectionInstructions.push(h),n&&(this.instructions.push(o.closePathInstruction),this.hitDetectionInstructions.push(o.closePathInstruction)),t=s}return s&&(this.instructions.push(o.fillInstruction),this.hitDetectionInstructions.push(o.fillInstruction)),n&&(this.instructions.push(o.strokeInstruction),this.hitDetectionInstructions.push(o.strokeInstruction)),t}drawCircle(e,t,r){let i=this.state,s=i.fillStyle,n=i.strokeStyle;if(void 0===s&&void 0===n)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,a.defaultFillStyle]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,a.defaultLineDash,a.defaultLineDashOffset]);let l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);let c=[o.default.CIRCLE,h];this.instructions.push(o.beginPathInstruction,c),this.hitDetectionInstructions.push(o.beginPathInstruction,c),void 0!==i.fillStyle&&(this.instructions.push(o.fillInstruction),this.hitDetectionInstructions.push(o.fillInstruction)),void 0!==i.strokeStyle&&(this.instructions.push(o.strokeInstruction),this.hitDetectionInstructions.push(o.strokeInstruction)),this.endGeometry(t)}drawPolygon(e,t,r){let i=this.state,s=i.fillStyle,n=i.strokeStyle;if(void 0===s&&void 0===n)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,a.defaultFillStyle]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,a.defaultLineDash,a.defaultLineDashOffset]);let l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,r){let i=this.state,s=i.fillStyle,n=i.strokeStyle;if(void 0===s&&void 0===n)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,a.defaultFillStyle]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,a.defaultLineDash,a.defaultLineDashOffset]);let l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride(),c=0;for(let e=0,t=l.length;e<t;++e)c=this.drawFlatCoordinatess_(u,c,l[e],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let e=this.tolerance;if(0!==e){let t=this.coordinates;for(let r=0,a=t.length;r<a;++r)t[r]=(0,i.snap)(t[r],e)}return super.finish()}setFillStrokeStyles_(){let e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)}}var u=l}),n("a0SEX",function(e,r){t(e.exports,"TEXT_ALIGN",()=>d),t(e.exports,"default",()=>f);var i=s("hlW0i"),a=s("jZquI"),n=s("aGiJY"),o=s("b6jom"),l=s("lVQul"),u=s("aHG4Z"),h=s("hycMe"),c=s("2CzCP");let d={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class p extends h.default{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[u.defaultFillStyle]={fillStyle:u.defaultFillStyle},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){let i=this.textFillState_,s=this.textStrokeState_,l=this.textState_;if(""===this.text_||!l||!i&&!s)return;let h=this.coordinates,d=h.length,p=e.getType(),f=null,m=e.getStride();if("line"===l.placement&&("LineString"==p||"MultiLineString"==p||"Polygon"==p||"MultiPolygon"==p)){let i;if(!(0,a.intersects)(this.maxExtent,e.getExtent()))return;if(f=e.getFlatCoordinates(),"LineString"==p)i=[f.length];else if("MultiLineString"==p)i=e.getEnds();else if("Polygon"==p)i=e.getEnds().slice(0,1);else if("MultiPolygon"==p){let t=e.getEndss();i=[];for(let e=0,r=t.length;e<r;++e)i.push(t[e][0])}this.beginGeometry(e,t,r);let s=l.repeat,u=s?void 0:l.textAlign,c=0;for(let e=0,t=i.length;e<t;++e){let t;t=s?(0,n.lineChunk)(s*this.resolution,f,c,i[e],m):[f.slice(c,i[e])];for(let r=0,a=t.length;r<a;++r){let a=t[r],s=0,n=a.length;if(void 0==u){let e=(0,o.matchingChunk)(l.maxAngle,a,0,a.length,2);s=e[0],n=e[1]}for(let e=s;e<n;e+=m)h.push(a[e],a[e+1]);let p=h.length;c=i[e],this.drawChars_(d,p),d=p}}this.endGeometry(t)}else{let i=l.overflow?null:[];switch(p){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),l.overflow||i.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":let a=e.getFlatInteriorPoints();f=[];for(let e=0,t=a.length;e<t;e+=3)l.overflow||i.push(a[e+2]/this.resolution),f.push(a[e],a[e+1]);if(0===f.length)return;m=2}let s=this.appendFlatPointCoordinates(f,m);if(s===d)return;if(i&&(s-d)/2!=f.length/m){let e=d/2;i=i.filter((t,r)=>{let i=h[(e+r)*2]===f[r*m]&&h[(e+r)*2+1]===f[r*m+1];return!i&&--e,i})}this.saveTextStates_();let n=l.backgroundFill?this.createFill(this.fillStyleToState(l.backgroundFill)):null,o=l.backgroundStroke?this.createStroke(this.strokeStyleToState(l.backgroundStroke)):null;this.beginGeometry(e,t,r);let g=l.padding;if(g!=u.defaultPadding&&(l.scale[0]<0||l.scale[1]<0)){let e=l.padding[0],t=l.padding[1],r=l.padding[2],i=l.padding[3];l.scale[0]<0&&(t=-t,i=-i),l.scale[1]<0&&(e=-e,r=-r),g=[e,t,r,i]}let y=this.pixelRatio;this.instructions.push([c.default.DRAW_IMAGE,d,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==u.defaultPadding?u.defaultPadding:g.map(function(e){return e*y}),n,o,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);let v=1/y,_=n?n.slice(0):null;_&&(_[1]=u.defaultFillStyle),this.hitDetectionInstructions.push([c.default.DRAW_IMAGE,d,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[v,v],NaN,this.declutterMode_,this.declutterImageWithText_,g,_,o,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?u.defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),this.endGeometry(t)}}saveTextStates_(){let e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;!e||i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash});let a=this.textKey_;a in this.textStates||(this.textStates[a]={font:t.font,textAlign:t.textAlign||u.defaultTextAlign,justify:t.justify,textBaseline:t.textBaseline||u.defaultTextBaseline,scale:t.scale});let s=this.fillKey_;!r||s in this.fillStates||(this.fillStates[s]={fillStyle:r.fillStyle})}drawChars_(e,t){let r=this.textStrokeState_,i=this.textState_,a=this.strokeKey_,s=this.textKey_,n=this.fillKey_;this.saveTextStates_();let o=this.pixelRatio,l=d[i.textBaseline],h=this.textOffsetY_*o,p=this.text_,f=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([c.default.DRAW_CHARS,e,t,l,i.overflow,n,i.maxAngle,o,h,a,f*o,p,s,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([c.default.DRAW_CHARS,e,t,l,i.overflow,n?u.defaultFillStyle:n,i.maxAngle,o,h,a,f*o,p,s,1/o,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,a,s;if(e){let t=e.getFill();t?((a=this.textFillState_)||(a={},this.textFillState_=a),a.fillStyle=(0,i.asColorLike)(t.getColor()||u.defaultFillStyle)):(a=null,this.textFillState_=a);let n=e.getStroke();if(n){(s=this.textStrokeState_)||(s={},this.textStrokeState_=s);let e=n.getLineDash(),t=n.getLineDashOffset(),r=n.getWidth(),a=n.getMiterLimit();s.lineCap=n.getLineCap()||u.defaultLineCap,s.lineDash=e?e.slice():u.defaultLineDash,s.lineDashOffset=void 0===t?u.defaultLineDashOffset:t,s.lineJoin=n.getLineJoin()||u.defaultLineJoin,s.lineWidth=void 0===r?u.defaultLineWidth:r,s.miterLimit=void 0===a?u.defaultMiterLimit:a,s.strokeStyle=(0,i.asColorLike)(n.getColor()||u.defaultStrokeStyle)}else s=null,this.textStrokeState_=s;r=this.textState_;let o=e.getFont()||u.defaultFont;(0,u.registerFont)(o);let h=e.getScaleArray();r.overflow=e.getOverflow(),r.font=o,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||u.defaultTextBaseline,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||u.defaultPadding,r.scale=void 0===h?[1,1]:h;let c=e.getOffsetX(),d=e.getOffsetY(),p=e.getRotateWithView(),f=e.getKeepUpright(),m=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=void 0===c?0:c,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==p&&p,this.textKeepUpright_=void 0===f||f,this.textRotation_=void 0===m?0:m,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:(0,l.getUid)(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=a&&a.fillStyle?"string"==typeof a.fillStyle?a.fillStyle:"|"+(0,l.getUid)(a.fillStyle):""}else this.text_="";this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}var f=p}),n("aGiJY",function(e,r){t(e.exports,"lineChunk",()=>a);var i=s("a6roo");function a(e,t,r,a,s){let n=[],o=r,l=0,u=t.slice(r,2);for(;l<e&&o+s<a;){let[r,a]=u.slice(-2),h=t[o+s],c=t[o+s+1],d=Math.sqrt((h-r)*(h-r)+(c-a)*(c-a));if((l+=d)>=e){let t=(e-l+d)/d,p=(0,i.lerp)(r,h,t),f=(0,i.lerp)(a,c,t);u.push(p,f),n.push(u),u=[p,f],l==e&&(o+=s),l=0}else if(l<e)u.push(t[o+s],t[o+s+1]),o+=s;else{let e=d-l,t=(0,i.lerp)(r,h,e/d),p=(0,i.lerp)(a,c,e/d);u.push(t,p),n.push(u),u=[t,p],l=0,o+=s}}return l>0&&n.push(u),n}}),n("b6jom",function(e,r){t(e.exports,"matchingChunk",()=>i);function i(e,t,r,i,a){let s,n,o,l,u,h,c,d,p,f=r,m=r,g=0,y=0,v=r;for(s=r;s<i;s+=a){let r=t[s],i=t[s+1];void 0!==l&&(o=Math.sqrt((d=r-l)*d+(p=i-u)*p),void 0!==h&&(y+=n,Math.acos((h*d+c*p)/(n*o))>e&&(y>g&&(g=y,f=v,m=s),y=0,v=s-a)),n=o,h=d,c=p),l=r,u=i}return(y+=o)>g?[v,s]:[f,m]}}),n("dVSax",function(e,r){t(e.exports,"ALL",()=>c),t(e.exports,"DECLUTTER",()=>d),t(e.exports,"NON_DECLUTTER",()=>p),t(e.exports,"default",()=>m);var i=s("kBSVF"),a=s("cgxQK"),n=s("jZquI"),o=s("bsQCi"),l=s("kKEgb"),u=s("14PDX"),h=s("c46kz");let c=["Polygon","Circle","LineString","Image","Text","Default"],d=["Image","Text"],p=c.filter(e=>!d.includes(e)),f={};var m=class{constructor(e,t,r,i,a,s,n){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,u.create)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(a,n)}clip(e,t){let r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(let r in e){let i=this.executorsByZIndex_[r];void 0===i&&(i={},this.executorsByZIndex_[r]=i);let a=e[r];for(let e in a){let r=a[e];i[e]=new h.default(this.resolution_,this.pixelRatio_,this.overlaps_,r,t)}}}hasExecutors(e){for(let t in this.executorsByZIndex_){let r=this.executorsByZIndex_[t];for(let t=0,i=e.length;t<i;++t)if(e[t]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,s,o,l){let h,d,p,m,g,y,v;let _=2*(s=Math.round(s))+1,x=(0,u.compose)(this.hitDetectionTransform_,s+.5,s+.5,1/t,-1/t,-r,-e[0],-e[1]),b=!this.hitDetectionContext_;b&&(this.hitDetectionContext_=(0,a.createCanvasContext2D)(_,_,void 0,{willReadFrequently:!0}));let S=this.hitDetectionContext_;S.canvas.width!==_||S.canvas.height!==_?(S.canvas.width=_,S.canvas.height=_):b||S.clearRect(0,0,_,_),void 0!==this.renderBuffer_&&(h=(0,n.createEmpty)(),(0,n.extendCoordinate)(h,e),(0,n.buffer)(h,t*(this.renderBuffer_+s),h));let w=function(e){if(void 0!==f[e])return f[e];let t=2*e+1,r=e*e,i=Array(r+1);for(let a=0;a<=e;++a)for(let s=0;s<=e;++s){let n=a*a+s*s;if(n>r)break;let o=i[n];o||(o=[],i[n]=o),o.push(((e+a)*t+(e+s))*4+3),a>0&&o.push(((e-a)*t+(e+s))*4+3),s>0&&(o.push(((e+a)*t+(e-s))*4+3),a>0&&o.push(((e-a)*t+(e-s))*4+3))}let a=[];for(let e=0,t=i.length;e<t;++e)i[e]&&a.push(...i[e]);return f[e]=a,a}(s);function E(e,t,r){let i=S.getImageData(0,0,_,_).data;for(let a=0,n=w.length;a<n;a++)if(i[w[a]]>0){if(!l||"none"===r||"Image"!==d&&"Text"!==d||l.includes(e)){let r=(w[a]-3)/4,i=s-r%_,n=s-(r/_|0),l=o(e,t,i*i+n*n);if(l)return l}S.clearRect(0,0,_,_);break}}let A=Object.keys(this.executorsByZIndex_).map(Number);for(A.sort(i.ascending),p=A.length-1;p>=0;--p){let e=A[p].toString();for(g=this.executorsByZIndex_[e],m=c.length-1;m>=0;--m)if(void 0!==(y=g[d=c[m]])&&(v=y.executeHitDetection(S,x,r,E,h)))return v}}getClipCoords(e){let t=this.maxExtent_;if(!t)return null;let r=t[0],i=t[1],a=t[2],s=t[3],n=[r,i,r,s,a,s,a,i];return(0,o.transform2D)(n,0,8,2,e,n),n}isEmpty(){return(0,l.isEmpty)(this.executorsByZIndex_)}execute(e,t,r,a,s,n,o){let l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?i.descending:i.ascending),n=n||c;let u=c.length;for(let i=0,h=l.length;i<h;++i){let h=l[i].toString(),c=this.executorsByZIndex_[h];for(let h=0,d=n.length;h<d;++h){let d=n[h],p=c[d];if(void 0!==p){let n=null===o?void 0:p.getZIndexContext(),c=n?n.getContext():e,f=this.maxExtent_&&"Image"!==d&&"Text"!==d;if(f&&(c.save(),this.clip(c,r)),n&&"Text"!==d&&"Image"!==d?n.pushFunction(e=>p.execute(e,t,r,a,s,o)):p.execute(c,t,r,a,s,o),f&&c.restore(),n){n.offset();let e=l[i]*u+h;this.deferredZIndexContexts_[e]||(this.deferredZIndexContexts_[e]=[]),this.deferredZIndexContexts_[e].push(n)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(i.ascending);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(e=>{e.draw(this.renderedContext_),e.clear()}),e[t[r]].length=0}}}),n("c46kz",function(e,r){t(e.exports,"default",()=>w);var i=s("kBSVF"),a=s("jZquI"),n=s("aSafW"),o=s("2soc3"),l=s("bsQCi"),u=s("14PDX"),h=s("haGk2"),c=s("aHG4Z"),d=s("2CzCP"),p=s("a0SEX");let f=(0,a.createEmpty)(),m=[],g=[],y=[],v=[];function _(e){return e[3].declutterBox}let x=RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function b(e,t){return"start"===t?t=x.test(e)?"right":"left":"end"===t&&(t=x.test(e)?"left":"right"),p.TEXT_ALIGN[t]}function S(e,t,r){return r>0&&e.push("\n",""),e.push(t,""),e}var w=class{constructor(e,t,r,i,a){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,u.create)(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=a?new h.default:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){let a;let s=e+t+r+i;if(this.labels_[s])return this.labels_[s];let n=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],d=l.justify?p.TEXT_ALIGN[l.justify]:b(Array.isArray(e)?e[0]:e,l.textAlign||c.defaultTextAlign),f=i&&n.lineWidth?n.lineWidth:0,m=Array.isArray(e)?e:String(e).split("\n").reduce(S,[]),{width:g,height:y,widths:v,heights:_,lineWidths:x}=(0,c.getTextDimensions)(l,m),w=g+f,E=[],A=(w+2)*h[0],T=(y+f)*h[1],C={width:A<0?Math.floor(A):Math.ceil(A),height:T<0?Math.floor(T):Math.ceil(T),contextInstructions:E};(1!=h[0]||1!=h[1])&&E.push("scale",h),i&&(E.push("strokeStyle",n.strokeStyle),E.push("lineWidth",f),E.push("lineCap",n.lineCap),E.push("lineJoin",n.lineJoin),E.push("miterLimit",n.miterLimit),E.push("setLineDash",[n.lineDash]),E.push("lineDashOffset",n.lineDashOffset)),r&&E.push("fillStyle",o.fillStyle),E.push("textBaseline","middle"),E.push("textAlign","center");let P=.5-d,R=d*w+P*f,I=[],L=[],O=0,M=0,k=0,N=0;for(let e=0,t=m.length;e<t;e+=2){let t=m[e];if("\n"===t){M+=O,O=0,R=d*w+P*f,++N;continue}let s=m[e+1]||l.font;s!==a&&(i&&I.push("font",s),r&&L.push("font",s),a=s),O=Math.max(O,_[k]);let n=[t,R+P*v[k]+d*(v[k]-x[N]),.5*(f+O)+M];R+=v[k],i&&I.push("strokeText",n),r&&L.push("fillText",n),++k}return Array.prototype.push.apply(E,I),Array.prototype.push.apply(E,L),this.labels_[s]=C,C}replayTextBackground_(e,t,r,i,a,s,n){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,a),e.lineTo.apply(e,t),s&&(this.alignAndScaleFill_=s[2],e.fillStyle=s[1],this.fill_(e)),n&&(this.setStrokeStyle_(e,n),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,n,o,l,h,c,d,p,_,x,b,S){let w;o*=p[0],l*=p[1];let E=r-o,A=i-l,T=s+h>e?e-h:s,C=n+c>t?t-c:n,P=x[3]+T*p[0]+x[1],R=x[0]+C*p[1]+x[2],I=E-x[3],L=A-x[0];return(b||0!==d)&&(m[0]=I,v[0]=I,m[1]=L,g[1]=L,g[0]=I+P,y[0]=g[0],y[1]=L+R,v[1]=y[1]),0!==d?(w=(0,u.compose)((0,u.create)(),r,i,1,1,d,-r,-i),(0,u.apply)(w,m),(0,u.apply)(w,g),(0,u.apply)(w,y),(0,u.apply)(w,v),(0,a.createOrUpdate)(Math.min(m[0],g[0],y[0],v[0]),Math.min(m[1],g[1],y[1],v[1]),Math.max(m[0],g[0],y[0],v[0]),Math.max(m[1],g[1],y[1],v[1]),f)):(0,a.createOrUpdate)(Math.min(I,I+P),Math.min(L,L+R),Math.max(I,I+P),Math.max(L,L+R),f),_&&(E=Math.round(E),A=Math.round(A)),{drawImageX:E,drawImageY:A,drawImageW:T,drawImageH:C,originX:h,originY:c,declutterBox:{minX:f[0],minY:f[1],maxX:f[2],maxY:f[3],value:S},canvasTransform:w,scale:p}}replayImageOrLabel_(e,t,r,i,a,s,n){let o=!!(s||n),l=i.declutterBox,u=n?n[2]*i.scale[0]/2:0;return l.minX-u<=t[0]&&l.maxX+u>=0&&l.minY-u<=t[1]&&l.maxY+u>=0&&(o&&this.replayTextBackground_(e,m,g,y,v,s,n),(0,c.drawImageOrLabel)(e,i.canvasTransform,a,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){let t=this.alignAndScaleFill_;if(t){let r=(0,u.apply)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),1!==t&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,r,i){let a=this.textStates[t],s=this.createLabel(e,t,i,r),n=this.strokeStates[r],o=this.pixelRatio,l=b(Array.isArray(e)?e[0]:e,a.textAlign||c.defaultTextAlign),u=p.TEXT_ALIGN[a.textBaseline||c.defaultTextBaseline],h=n&&n.lineWidth?n.lineWidth:0,d=s.width/o-2*a.scale[0],f=u*s.height/o+2*(.5-u)*h;return{label:s,anchorX:l*d+2*(.5-l)*h,anchorY:f}}execute_(e,t,r,s,h,p,f,m){let g,y,v,x,S,w,E,A,T,C,P,R,I,L,O,M,k,N;let D=this.zIndexContext_;this.pixelCoordinates_&&(0,i.equals)(r,this.renderedTransform_)?g=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),g=(0,l.transform2D)(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),(0,u.setFromArray)(this.renderedTransform_,r));let F=0,G=s.length,z=0,q=0,j=0,B=this.coordinateCache_,U=this.viewRotation_,H=Math.round(1e12*Math.atan2(-r[1],r[0]))/1e12,Z={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:U},V=this.instructions!=s||this.overlaps?0:200;for(;F<G;){let r=s[F];switch(r[0]){case d.default.BEGIN_GEOMETRY:O=r[1],N=r[3],O.getGeometry()?void 0===f||(0,a.intersects)(f,N.getExtent())?++F:F=r[2]+1:F=r[2],D&&(D.zIndex=r[4]);break;case d.default.BEGIN_PATH:q>V&&(this.fill_(e),q=0),j>V&&(e.stroke(),j=0),q||j||(e.beginPath(),w=NaN,E=NaN),++F;break;case d.default.CIRCLE:let i=g[z=r[1]],l=g[z+1],u=g[z+2],G=g[z+3],Y=u-i,W=G-l,$=Math.sqrt(Y*Y+W*W);e.moveTo(i+$,l),e.arc(i,l,$,0,2*Math.PI,!0),++F;break;case d.default.CLOSE_PATH:e.closePath(),++F;break;case d.default.CUSTOM:z=r[1],y=r[2];let X=r[3],K=r[4],J=r[5];Z.geometry=X,Z.feature=O,F in B||(B[F]=[]);let Q=B[F];J?J(g,z,y,2,Q):(Q[0]=g[z],Q[1]=g[z+1],Q.length=2),D&&(D.zIndex=r[6]),K(Q,Z),++F;break;case d.default.DRAW_IMAGE:let ee,et,er,ei;z=r[1],y=r[2],C=r[3],v=r[4],x=r[5];let ea=r[6],es=r[7],en=r[8],eo=r[9],el=r[10],eu=r[11],eh=r[12],ec=r[13];S=r[14]||"declutter";let ed=r[15];if(!C&&r.length>=20){P=r[19],R=r[20],I=r[21],L=r[22];let e=this.drawLabelWithPointPlacement_(P,R,I,L);C=e.label,r[3]=C;let t=r[23];v=(e.anchorX-t)*this.pixelRatio,r[4]=v;let i=r[24];x=(e.anchorY-i)*this.pixelRatio,r[5]=x,ea=C.height,r[6]=ea,ec=C.width,r[13]=ec}r.length>25&&(ee=r[25]),r.length>17?(et=r[16],er=r[17],ei=r[18]):(et=c.defaultPadding,er=null,ei=null),el&&H?eu+=U:el||H||(eu-=U);let ep=0;for(;z<y;z+=2){if(ee&&ee[ep++]<ec/this.pixelRatio)continue;let r=this.calculateImageOrLabelDimensions_(C.width,C.height,g[z],g[z+1],ec,ea,v,x,en,eo,eu,eh,h,et,!!er||!!ei,O),i=[e,t,C,r,es,er,ei];if(m){let e,t,a,s,n;if(ed){let r=y-z;if(!ed[r]){ed[r]={args:i,declutterMode:S};continue}let s=ed[r];e=s.args,t=s.declutterMode,delete ed[r],a=_(e)}if(e&&("declutter"!==t||!m.collides(a))&&(s=!0),"declutter"===S&&m.collides(r.declutterBox)||(n=!0),"declutter"===t&&"declutter"===S){let e=s&&n;s=e,n=e}s&&("none"!==t&&m.insert(a),this.replayImageOrLabel_.apply(this,e)),n&&("none"!==S&&m.insert(r.declutterBox),this.replayImageOrLabel_.apply(this,i))}else this.replayImageOrLabel_.apply(this,i)}++F;break;case d.default.DRAW_CHARS:let ef;let em=r[1],eg=r[2],ey=r[3],ev=r[4];L=r[5];let e_=r[6],ex=r[7],eb=r[8];I=r[9];let eS=r[10];P=r[11],R=r[12];let ew=[r[13],r[13]];S=r[14]||"declutter";let eE=r[15],eA=this.textStates[R],eT=eA.font,eC=[eA.scale[0]*ex,eA.scale[1]*ex];eT in this.widths_?ef=this.widths_[eT]:(ef={},this.widths_[eT]=ef);let eP=(0,n.lineStringLength)(g,em,eg,2),eR=Math.abs(eC[0])*(0,c.measureAndCacheTextWidth)(eT,P,ef);if(ev||eR<=eP){let r=(eP-eR)*b(P,this.textStates[R].textAlign),i=(0,o.drawTextOnPath)(g,em,eg,2,P,r,e_,Math.abs(eC[0]),c.measureAndCacheTextWidth,eT,ef,H?0:this.viewRotation_,eE);e:if(i){let r,a,s,n,o;let l=[];if(I)for(r=0,a=i.length;r<a;++r){s=(o=i[r])[4],n=this.createLabel(s,R,"",I),v=o[2]+(eC[0]<0?-eS:eS),x=ey*n.height+(.5-ey)*2*eS*eC[1]/eC[0]-eb;let a=this.calculateImageOrLabelDimensions_(n.width,n.height,o[0],o[1],n.width,n.height,v,x,0,0,o[3],ew,!1,c.defaultPadding,!1,O);if(m&&"declutter"===S&&m.collides(a.declutterBox))break e;l.push([e,t,n,a,1,null,null])}if(L)for(r=0,a=i.length;r<a;++r){s=(o=i[r])[4],n=this.createLabel(s,R,L,""),v=o[2],x=ey*n.height-eb;let a=this.calculateImageOrLabelDimensions_(n.width,n.height,o[0],o[1],n.width,n.height,v,x,0,0,o[3],ew,!1,c.defaultPadding,!1,O);if(m&&"declutter"===S&&m.collides(a.declutterBox))break e;l.push([e,t,n,a,1,null,null])}m&&"none"!==S&&m.load(l.map(_));for(let e=0,t=l.length;e<t;++e)this.replayImageOrLabel_.apply(this,l[e])}}++F;break;case d.default.END_GEOMETRY:if(void 0!==p){let e=p(O=r[1],N,S);if(e)return e}++F;break;case d.default.FILL:V?q++:this.fill_(e),++F;break;case d.default.MOVE_TO_LINE_TO:for(z=r[1],y=r[2],M=g[z],k=g[z+1],e.moveTo(M,k),w=M+.5|0,E=k+.5|0,z+=2;z<y;z+=2)M=g[z],k=g[z+1],A=M+.5|0,T=k+.5|0,(z==y-2||A!==w||T!==E)&&(e.lineTo(M,k),w=A,E=T);++F;break;case d.default.SET_FILL_STYLE:this.alignAndScaleFill_=r[2],q&&(this.fill_(e),q=0,j&&(e.stroke(),j=0)),e.fillStyle=r[1],++F;break;case d.default.SET_STROKE_STYLE:j&&(e.stroke(),j=0),this.setStrokeStyle_(e,r),++F;break;case d.default.STROKE:V?j++:e.stroke(),++F;break;default:++F}}q&&this.fill_(e),j&&e.stroke()}execute(e,t,r,i,a,s){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,a,void 0,void 0,s)}executeHitDetection(e,t,r,i,a){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,a)}}}),n("2soc3",function(e,r){t(e.exports,"drawTextOnPath",()=>n);var i=s("a6roo"),a=s("bsQCi");function n(e,t,r,s,n,o,l,u,h,c,d,p,f=!0){let m,g=e[t],y=e[t+1],v=0,_=0,x=0,b=0;function S(){v=g,_=y,t+=s,g=e[t],y=e[t+1],b+=x,x=Math.sqrt((g-v)*(g-v)+(y-_)*(y-_))}do S();while(t<r-s&&b+x<o)let w=0===x?0:(o-b)/x,E=(0,i.lerp)(v,g,w),A=(0,i.lerp)(_,y,w),T=t-s,C=b,P=o+u*h(c,n,d);for(;t<r-s&&b+x<P;)S();w=0===x?0:(P-b)/x;let R=(0,i.lerp)(v,g,w),I=(0,i.lerp)(_,y,w),L=!1;if(f){if(p){let e=[E,A,R,I];(0,a.rotate)(e,0,4,2,p,e,e),L=e[0]>e[2]}else L=E>R}let O=Math.PI,M=[],k=T+s===t;if(t=T,x=0,b=C,g=e[t],y=e[t+1],k){S(),m=Math.atan2(y-_,g-v),L&&(m+=m>0?-O:O);let e=(R+E)/2,t=(I+A)/2;return M[0]=[e,t,(P-o)/2,m,n],M}n=n.replace(/\n/g," ");for(let e=0,a=n.length;e<a;){S();let p=Math.atan2(y-_,g-v);if(L&&(p+=p>0?-O:O),void 0!==m){let e=p-m;if(Math.abs(e+=e>O?-2*O:e<-O?2*O:0)>l)return null}m=p;let f=e,E=0;for(;e<a;++e){let i=u*h(c,n[L?a-e-1:e],d);if(t+s<r&&b+x<o+E+i/2)break;E+=i}if(e===f)continue;let A=L?n.substring(a-f,a-e):n.substring(f,e);w=0===x?0:(o+E/2-b)/x;let T=(0,i.lerp)(v,g,w),C=(0,i.lerp)(_,y,w);M.push([T,C,E/2,p,A]),o+=E}return M}}),n("haGk2",function(e,r){t(e.exports,"default",()=>a);var i=s("cgxQK"),a=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy((0,i.getSharedCanvasContext2D)(),{get:(e,t)=>{if("function"==typeof(0,i.getSharedCanvasContext2D)()[t])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t),this.pushMethodArgs_},set:(e,t,r)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t,r),!0)})}pushMethodArgs_=(...e)=>(this.instructions_[this.zIndex+this.offset_].push(e),this);pushFunction(e){this.instructions_[this.zIndex+this.offset_].push(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){let i=t[r];if("function"==typeof i){i(e);continue}let a=t[++r];if("function"==typeof e[i])e[i](...a);else{if("function"==typeof a){e[i]=a(e);continue}e[i]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}}),n("3CYjy",function(e,r){t(e.exports,"HIT_DETECT_RESOLUTION",()=>c),t(e.exports,"createHitDetectionImageData",()=>d),t(e.exports,"hitDetect",()=>p);var i=s("kBSVF"),a=s("cgxQK"),n=s("jZquI"),o=s("a6roo"),l=s("gzr8q"),u=s("ayeEa"),h=s("htGzg");let c=.5;function d(e,t,r,s,o,d,p,f,m){let g=m?(0,l.toUserExtent)(o,m):o,y=e[0]*c,v=e[1]*c,_=(0,a.createCanvasContext2D)(y,v);_.imageSmoothingEnabled=!1;let x=_.canvas,b=new h.default(_,c,o,null,p,f,m?(0,l.getTransformFromProjections)((0,l.getUserProjection)(),m):null),S=r.length,w=Math.floor(16777215/S),E={};for(let e=1;e<=S;++e){let t=r[e-1],i=t.getStyleFunction()||s;if(!i)continue;let o=i(t,d);if(!o)continue;Array.isArray(o)||(o=[o]);let l=(e*w).toString(16).padStart(7,"#00000");for(let e=0,r=o.length;e<r;++e){let r=o[e],i=r.getGeometryFunction()(t);if(!i||!(0,n.intersects)(g,i.getExtent()))continue;let s=r.clone(),h=s.getFill();h&&h.setColor(l);let c=s.getStroke();c&&(c.setColor(l),c.setLineDash(null)),s.setText(void 0);let d=r.getImage();if(d){let e=d.getImageSize();if(!e)continue;let t=(0,a.createCanvasContext2D)(e[0],e[1],void 0,{alpha:!1}),r=t.canvas;t.fillStyle=l,t.fillRect(0,0,r.width,r.height),s.setImage(new u.default({img:r,anchor:d.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:d.getOrigin(),opacity:1,size:d.getSize(),scale:d.getScale(),rotation:d.getRotation(),rotateWithView:d.getRotateWithView()}))}let p=s.getZIndex()||0,f=E[p];f||(f={},E[p]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);let m=i.getType();if("GeometryCollection"===m){let e=i.getGeometriesArrayRecursive();for(let t=0,r=e.length;t<r;++t){let r=e[t];f[r.getType().replace("Multi","")].push(r,s)}}else f[m.replace("Multi","")].push(i,s)}}let A=Object.keys(E).map(Number).sort(i.ascending);for(let e=0,r=A.length;e<r;++e){let r=E[A[e]];for(let e in r){let i=r[e];for(let e=0,r=i.length;e<r;e+=2){b.setStyle(i[e+1]);for(let r=0,a=t.length;r<a;++r)b.setTransform(t[r]),b.drawGeometry(i[e])}}}return _.getImageData(0,0,x.width,x.height)}function p(e,t,r){let i=[];if(r){let a=Math.floor(Math.round(e[0])*c),s=Math.floor(Math.round(e[1])*c),n=((0,o.clamp)(a,0,r.width-1)+(0,o.clamp)(s,0,r.height-1)*r.width)*4,l=r.data[n],u=r.data[n+1],h=r.data[n+2]+256*(u+256*l),d=Math.floor(16777215/t.length);h&&h%d==0&&i.push(t[h/d-1])}return i}}),n("htGzg",function(e,r){t(e.exports,"default",()=>f);var i=s("kBSVF"),a=s("hlW0i"),n=s("jZquI"),o=s("63y7W"),l=s("bsQCi"),u=s("a6roo"),h=s("14PDX"),c=s("eGc18"),d=s("aHG4Z");class p extends c.default{constructor(e,t,r,i,a,s,n){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?(0,u.toFixed)(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=s,this.userTransform_=n,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,h.create)()}drawImages_(e,t,r,i){if(!this.image_)return;let a=(0,l.transform2D)(e,t,r,i,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);let u=this.imageRotation_;0===this.transformRotation_&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let e=0,t=a.length;e<t;e+=2){let t=a[e]-this.imageAnchorX_,r=a[e+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_[0]||1!=this.imageScale_[1]){let e=t+this.imageAnchorX_,i=r+this.imageAnchorY_;(0,h.compose)(n,e,i,1,1,u,-e,-i),s.save(),s.transform.apply(s,n),s.translate(e,i),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,t,r,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}drawText_(e,t,r,i){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);let a=(0,l.transform2D)(e,t,r,i,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.textRotation_;for(0===this.transformRotation_&&(n-=this.viewRotation_),this.textRotateWithView_&&(n+=this.viewRotation_);t<r;t+=i){let e=a[t]+this.textOffsetX_,r=a[t+1]+this.textOffsetY_;0!==n||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(e-this.textOffsetX_,r-this.textOffsetY_),s.rotate(n),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,e,r),this.textFillState_&&s.fillText(this.text_,e,r))}}moveToLineTo_(e,t,r,i,a){let s=this.context_,n=(0,l.transform2D)(e,t,r,i,this.transform_,this.pixelCoordinates_);s.moveTo(n[0],n[1]);let o=n.length;a&&(o-=2);for(let e=2;e<o;e+=2)s.lineTo(n[e],n[e+1]);return a&&s.closePath(),r}drawRings_(e,t,r,i){for(let a=0,s=r.length;a<s;++a)t=this.moveToLineTo_(e,t,r[a],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,n.intersects)(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=(0,o.transformGeom2D)(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],a=this.context_;a.beginPath(),a.arc(t[0],t[1],Math.sqrt(r*r+i*i),0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}""!==this.text_&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e)}}drawFeature(e,t){let r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){let t=e.getGeometriesArray();for(let e=0,r=t.length;e<r;++e)this.drawGeometry(t[e])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),""!==this.text_&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),""!==this.text_&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,n.intersects)(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(""!==this.text_){let t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getExtent();if((0,n.intersects)(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let t=this.context_,r=e.getFlatCoordinates(),i=0,a=e.getEnds(),s=e.getStride();t.beginPath();for(let e=0,t=a.length;e<t;++e)i=this.moveToLineTo_(r,i,a[e],s,!1);t.stroke()}if(""!==this.text_){let t=e.getFlatMidpoints();this.drawText_(t,0,t.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,n.intersects)(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(""!==this.text_){let t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,n.intersects)(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=this.context_,r=e.getOrientedFlatCoordinates(),i=0,a=e.getEndss(),s=e.getStride();t.beginPath();for(let e=0,t=a.length;e<t;++e){let t=a[e];i=this.drawRings_(r,i,t,s)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(""!==this.text_){let t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){let t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){let t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),(0,i.equals)(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){let t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:d.defaultTextAlign;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(e){let t=e.getColor();this.fillState_={fillStyle:(0,a.asColorLike)(t||d.defaultFillStyle)}}else this.fillState_=null;if(t){let e=t.getColor(),r=t.getLineCap(),i=t.getLineDash(),s=t.getLineDashOffset(),n=t.getLineJoin(),o=t.getWidth(),l=t.getMiterLimit(),u=i||d.defaultLineDash;this.strokeState_={lineCap:void 0!==r?r:d.defaultLineCap,lineDash:1===this.pixelRatio_?u:u.map(e=>e*this.pixelRatio_),lineDashOffset:(s||d.defaultLineDashOffset)*this.pixelRatio_,lineJoin:void 0!==n?n:d.defaultLineJoin,lineWidth:(void 0!==o?o:d.defaultLineWidth)*this.pixelRatio_,miterLimit:void 0!==l?l:d.defaultMiterLimit,strokeStyle:(0,a.asColorLike)(e||d.defaultStrokeStyle)}}else this.strokeState_=null}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}let r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),a=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();let s=e.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/r,s[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(e){let t=e.getFill();if(t){let e=t.getColor();this.textFillState_={fillStyle:(0,a.asColorLike)(e||d.defaultFillStyle)}}else this.textFillState_=null;let r=e.getStroke();if(r){let e=r.getColor(),t=r.getLineCap(),i=r.getLineDash(),s=r.getLineDashOffset(),n=r.getLineJoin(),o=r.getWidth(),l=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==t?t:d.defaultLineCap,lineDash:i||d.defaultLineDash,lineDashOffset:s||d.defaultLineDashOffset,lineJoin:void 0!==n?n:d.defaultLineJoin,lineWidth:void 0!==o?o:d.defaultLineWidth,miterLimit:void 0!==l?l:d.defaultMiterLimit,strokeStyle:(0,a.asColorLike)(e||d.defaultStrokeStyle)}}else this.textStrokeState_=null;let i=e.getFont(),s=e.getOffsetX(),n=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),c=e.getTextAlign(),p=e.getTextBaseline();this.textState_={font:void 0!==i?i:d.defaultFont,textAlign:void 0!==c?c:d.defaultTextAlign,textBaseline:void 0!==p?p:d.defaultTextBaseline},this.text_=void 0!==h?Array.isArray(h)?h.reduce((e,t,r)=>e+=r%2?" ":t,""):h:"",this.textOffsetX_=void 0!==s?this.pixelRatio_*s:0,this.textOffsetY_=void 0!==n?this.pixelRatio_*n:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==l?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}else this.text_=""}}var f=p}),n("713Fw",function(e,r){t(e.exports,"defaultOrder",()=>o),t(e.exports,"getSquaredTolerance",()=>l),t(e.exports,"getTolerance",()=>u),t(e.exports,"renderFeature",()=>h);var i=s("50PZ9"),a=s("lVQul");let n={Point:function(e,t,r,a,s,n){let o=r.getImage(),l=r.getText(),u=l&&l.getText(),h=n&&o&&u?{}:void 0;if(o){if(o.getImageState()!=i.default.LOADED)return;let n=e.getBuilder(r.getZIndex(),"Image");n.setImageStyle(o,h),n.drawPoint(t,a,s)}if(u){let i=e.getBuilder(r.getZIndex(),"Text");i.setTextStyle(l,h),i.drawText(t,a,s)}},LineString:function(e,t,r,i,a){let s=r.getStroke();if(s){let n=e.getBuilder(r.getZIndex(),"LineString");n.setFillStrokeStyle(null,s),n.drawLineString(t,i,a)}let n=r.getText();if(n&&n.getText()){let s=e.getBuilder(r.getZIndex(),"Text");s.setTextStyle(n),s.drawText(t,i,a)}},Polygon:function(e,t,r,i,a){let s=r.getFill(),n=r.getStroke();if(s||n){let o=e.getBuilder(r.getZIndex(),"Polygon");o.setFillStrokeStyle(s,n),o.drawPolygon(t,i,a)}let o=r.getText();if(o&&o.getText()){let s=e.getBuilder(r.getZIndex(),"Text");s.setTextStyle(o),s.drawText(t,i,a)}},MultiPoint:function(e,t,r,a,s,n){let o=r.getImage(),l=o&&0!==o.getOpacity(),u=r.getText(),h=u&&u.getText(),c=n&&l&&h?{}:void 0;if(l){if(o.getImageState()!=i.default.LOADED)return;let n=e.getBuilder(r.getZIndex(),"Image");n.setImageStyle(o,c),n.drawMultiPoint(t,a,s)}if(h){let i=e.getBuilder(r.getZIndex(),"Text");i.setTextStyle(u,c),i.drawText(t,a,s)}},MultiLineString:function(e,t,r,i,a){let s=r.getStroke();if(s){let n=e.getBuilder(r.getZIndex(),"LineString");n.setFillStrokeStyle(null,s),n.drawMultiLineString(t,i,a)}let n=r.getText();if(n&&n.getText()){let s=e.getBuilder(r.getZIndex(),"Text");s.setTextStyle(n),s.drawText(t,i,a)}},MultiPolygon:function(e,t,r,i,a){let s=r.getFill(),n=r.getStroke();if(n||s){let o=e.getBuilder(r.getZIndex(),"Polygon");o.setFillStrokeStyle(s,n),o.drawMultiPolygon(t,i,a)}let o=r.getText();if(o&&o.getText()){let s=e.getBuilder(r.getZIndex(),"Text");s.setTextStyle(o),s.drawText(t,i,a)}},GeometryCollection:function(e,t,r,i,a,s){let o,l;let u=t.getGeometriesArray();for(o=0,l=u.length;o<l;++o)(0,n[u[o].getType()])(e,u[o],r,i,a,s)},Circle:function(e,t,r,i,a){let s=r.getFill(),n=r.getStroke();if(s||n){let o=e.getBuilder(r.getZIndex(),"Circle");o.setFillStrokeStyle(s,n),o.drawCircle(t,i,a)}let o=r.getText();if(o&&o.getText()){let a=e.getBuilder(r.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i)}}};function o(e,t){return parseInt((0,a.getUid)(e),10)-parseInt((0,a.getUid)(t),10)}function l(e,t){let r=u(e,t);return r*r}function u(e,t){return .5*e/t}function h(e,t,r,a,s,o,l,u){let h=[],c=r.getImage();if(c){let e=!0,t=c.getImageState();t==i.default.LOADED||t==i.default.ERROR?e=!1:t==i.default.IDLE&&c.load(),e&&h.push(c.ready())}let d=r.getFill();d&&d.loading()&&h.push(d.ready());let p=h.length>0;return p&&Promise.all(h).then(()=>s(null)),function(e,t,r,i,a,s,o){let l=r.getGeometryFunction()(t);if(!l)return;let u=l.simplifyTransformed(i,a);r.getRenderer()?function e(t,r,i,a,s){if("GeometryCollection"==r.getType()){let n=r.getGeometries();for(let r=0,o=n.length;r<o;++r)e(t,n[r],i,a,s);return}t.getBuilder(i.getZIndex(),"Default").drawCustom(r,a,i.getRenderer(),i.getHitDetectionRenderer(),s)}(e,u,r,t,o):(0,n[u.getType()])(e,u,r,t,o,s)}(e,t,r,a,o,l,u),p}}),n("ddIVC",function(e,r){t(e.exports,"canvasPool",()=>p),t(e.exports,"default",()=>g);var i=s("kBSVF"),a=s("lqNjm"),n=s("cgxQK"),o=s("jZquI"),l=s("fj1q7"),u=s("6ej6F"),h=s("haGk2"),c=s("14PDX"),d=s("lgqLq");let p=[],f=null;class m extends d.default{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=(0,c.create)(),this.pixelTransform=(0,c.create)(),this.inversePixelTransform=(0,c.create)(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){let i;f||(f=(0,n.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})),f.clearRect(0,0,1,1);try{f.drawImage(e,t,r,1,1,0,0,1,1),i=f.getImageData(0,0,1,1).data}catch{return f=null,null}return i}getBackground(e){let t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0}useContainer(e,t,r){let s,o;let l=this.getLayer().getClassName();if(e&&e.className===l&&(!r||e&&e.style.backgroundColor&&(0,i.equals)((0,a.asArray)(e.style.backgroundColor),(0,a.asArray)(r)))){let t=e.firstElementChild;t instanceof HTMLCanvasElement&&(o=t.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(s=document.createElement("div")).className=l;let e=s.style;e.position="absolute",e.width="100%",e.height="100%";let t=(o=(0,n.createCanvasContext2D)()).canvas;s.appendChild(t),(e=t.style).position="absolute",e.left="0",e.transformOrigin="top left",this.container=s,this.context=o}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){let i=(0,o.getTopLeft)(r),a=(0,o.getTopRight)(r),s=(0,o.getBottomRight)(r),n=(0,o.getBottomLeft)(r);(0,c.apply)(t.coordinateToPixelTransform,i),(0,c.apply)(t.coordinateToPixelTransform,a),(0,c.apply)(t.coordinateToPixelTransform,s),(0,c.apply)(t.coordinateToPixelTransform,n);let l=this.inversePixelTransform;(0,c.apply)(l,i),(0,c.apply)(l,a),(0,c.apply)(l,s),(0,c.apply)(l,n),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(n[0]),Math.round(n[1])),e.clip()}prepareContainer(e,t){let r=e.extent,i=e.viewState.resolution,a=e.viewState.rotation,s=e.pixelRatio,n=Math.round((0,o.getWidth)(r)/i*s),l=Math.round((0,o.getHeight)(r)/i*s);(0,c.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/s,1/s,a,-n/2,-l/2),(0,c.makeInverse)(this.inversePixelTransform,this.pixelTransform);let u=(0,c.toString)(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){let e=this.context.canvas;e.width!=n||e.height!=l?(e.width=n,e.height=l):this.context.clearRect(0,0,n,l),u!==e.style.transform&&(e.style.transform=u)}}dispatchRenderEvent_(e,t,r){let i=this.getLayer();if(i.hasListener(e)){let a=new l.default(e,this.inversePixelTransform,r,t);i.dispatchEvent(a)}}preRender(e,t){this.frameState=t,t.declutter||this.dispatchRenderEvent_(u.default.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(u.default.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new h.default),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(u.default.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(u.default.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,a,s,n){let o=i/t,l=-e[0]+n,u=-e[1];return(0,c.compose)(this.tempTransform,a/2,s/2,o,-o,-r,l,u)}disposeInternal(){delete this.frameState,super.disposeInternal()}}var g=m}),n("lgqLq",function(e,r){t(e.exports,"default",()=>u);var i=s("50PZ9"),a=s("ejLRd"),n=s("cw4dl"),o=s("lVQul");class l extends a.default{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=[],this.maxStaleKeys=5}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return(0,o.abstract)()}getData(e){return null}prepareFrame(e){return(0,o.abstract)()}renderFrame(e,t){return(0,o.abstract)()}forEachFeatureAtCoordinate(e,t,r,i,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){let t=e.target;(t.getState()===i.default.LOADED||t.getState()===i.default.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=i.default.LOADED&&t!=i.default.ERROR&&e.addEventListener(n.default.CHANGE,this.boundHandleImageChange_),t==i.default.IDLE&&(e.load(),t=e.getState()),t==i.default.LOADED}renderIfReadyAndVisible(){let e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}var u=l}),n("aIaid",function(e,r){t(e.exports,"default",()=>u);var i=s("ejLRd"),a=s("7lBr2"),n=s("gbCDL"),o=s("VCbYw"),l=class extends a.default{constructor(e){e=e||{},super({handleEvent:function(e){return"pointermove"==e.type&&this.handleMove_(e),!0}}),this.maps=e.maps||[],!1===e.active&&this.setActive(!1)}setMap(e){this._listener&&((0,i.unByKey)(this._listener.center),(0,i.unByKey)(this._listener.rotation),(0,i.unByKey)(this._listener.resolution),this.getMap().getTargetElement().removeEventListener("mouseout",this._listener.mouseout)),this._listener=null,super.setMap(e),e&&(this._listener={},this._listener.center=this.getMap().getView().on("change:center",this.syncMaps.bind(this)),this._listener.rotation=this.getMap().getView().on("change:rotation",this.syncMaps.bind(this)),this._listener.resolution=this.getMap().getView().on("change:resolution",this.syncMaps.bind(this)),this._listener.mouseout=this.handleMouseOut_.bind(this),this.getMap().getTargetElement()&&this.getMap().getTargetElement().addEventListener("mouseout",this._listener.mouseout),this.syncMaps())}setActive(e){super.setActive(e),this.syncMaps()}syncMaps(){if(this.getActive()){var e=this.getMap();if(e){if(e.get("lockView"))return;for(var t=0;t<this.maps.length;t++)this.maps[t].set("lockView",!0),this.maps[t].getView().getRotation()!=e.getView().getRotation()&&this.maps[t].getView().setRotation(e.getView().getRotation()),this.maps[t].getView().getCenter()!=e.getView().getCenter()&&this.maps[t].getView().setCenter(e.getView().getCenter()),this.maps[t].getView().getResolution()!=e.getView().getResolution()&&this.maps[t].getView().setResolution(e.getView().getResolution()),this.maps[t].set("lockView",!1)}}}handleMove_(e){for(var t=0;t<this.maps.length;t++)this.maps[t].showTarget(e.coordinate);this.getMap().showTarget()}handleMouseOut_(){for(var e=0;e<this.maps.length;e++)this.maps[e]._targetOverlay&&this.maps[e]._targetOverlay.setPosition(void 0)}};n.default.prototype.showTarget=function(e){if(!this._targetOverlay){var t=document.createElement("div");t.classList.add("ol-target"),this._targetOverlay=new o.default({element:t}),this._targetOverlay.setPositioning("center-center"),this.addOverlay(this._targetOverlay),t.parentElement.classList.add("ol-target-overlay"),this._targetOverlay.setPosition([0,0])}this._targetOverlay.setPosition(e)},n.default.prototype.hideTarget=function(){this.removeOverlay(this._targetOverlay),this._targetOverlay=void 0};var u=l}),n("VCbYw",function(e,r){t(e.exports,"default",()=>d);var i=s("2u1lG"),a=s("fnScq"),n=s("erROg"),o=s("cgxQK"),l=s("bsgMw"),u=s("jZquI");let h={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class c extends a.default{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+n.CLASS_SELECTABLE,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(h.ELEMENT,this.handleElementChanged),this.addChangeListener(h.MAP,this.handleMapChanged),this.addChangeListener(h.OFFSET,this.handleOffsetChanged),this.addChangeListener(h.POSITION,this.handlePositionChanged),this.addChangeListener(h.POSITIONING,this.handlePositioningChanged),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),void 0!==e.position&&this.setPosition(e.position)}getElement(){return this.get(h.ELEMENT)}getId(){return this.id}getMap(){return this.get(h.MAP)||null}getOffset(){return this.get(h.OFFSET)}getPosition(){return this.get(h.POSITION)}getPositioning(){return this.get(h.POSITIONING)}handleElementChanged(){(0,o.removeChildren)(this.element);let e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),(0,l.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);let e=this.getMap();if(e){this.mapPostrenderListenerKey=(0,l.listen)(e,i.default.POSTRENDER,this.render,this),this.updatePixelPosition();let t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(h.ELEMENT,e)}setMap(e){this.set(h.MAP,e)}setOffset(e){this.set(h.OFFSET,e)}setPosition(e){this.set(h.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){let t=this.getMap();if(!t||!t.getTargetElement()||!this.get(h.POSITION))return;let r=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),a=this.getRect(i,[(0,o.outerWidth)(i),(0,o.outerHeight)(i)]),s=void 0===(e=e||{}).margin?20:e.margin;if(!(0,u.containsExtent)(r,a)){let i=a[0]-r[0],n=r[2]-a[2],o=a[1]-r[1],l=r[3]-a[3],u=[0,0];if(i<0?u[0]=i-s:n<0&&(u[0]=Math.abs(n)+s),o<0?u[1]=o-s:l<0&&(u[1]=Math.abs(l)+s),0!==u[0]||0!==u[1]){let r=t.getView().getCenterInternal(),i=t.getPixelFromCoordinateInternal(r);if(!i)return;let a=[i[0]+u[0],i[1]+u[1]],s=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(a),duration:s.duration,easing:s.easing})}}}getRect(e,t){let r=e.getBoundingClientRect(),i=r.left+window.pageXOffset,a=r.top+window.pageYOffset;return[i,a,i+t[0],a+t[1]]}setPositioning(e){this.set(h.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){let e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}let r=e.getPixelFromCoordinate(t),i=e.getSize();this.updateRenderedPosition(r,i)}updateRenderedPosition(e,t){let r=this.element.style,i=this.getOffset(),a=this.getPositioning();this.setVisible(!0);let s=Math.round(e[0]+i[0])+"px",n=Math.round(e[1]+i[1])+"px",o="0%",l="0%";"bottom-right"==a||"center-right"==a||"top-right"==a?o="-100%":("bottom-center"==a||"center-center"==a||"top-center"==a)&&(o="-50%"),"bottom-left"==a||"bottom-center"==a||"bottom-right"==a?l="-100%":("center-left"==a||"center-center"==a||"center-right"==a)&&(l="-50%");let u=`translate(${o}, ${l}) translate(${s}, ${n})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,r.transform=u)}getOptions(){return this.options}}var d=c}),n("1NiL5",function(e,r){t(e.exports,"default",()=>l);var i=s("aZxrf");s("9pPDN");var a=s("4QRwa"),n=s("fkmMz");class o extends i.default{constructor(e){super({title:e.title||"MVT",type:"MVT",attributions:e.attributions,declutter:!0}),e.url&&this.loadMapboxStyle({url:e.url,useTitle:!e.title})}}i.default.prototype.loadMapboxStyle=function(e){this.set("styleUrl",e.url),(0,n.default).get({url:e.url,success:t=>{e.useTitle&&(console.log("useTitle"),this.set("title",t.name||"MVT")),e.source||(e.source=Object.keys(t.sources)[0]),this.applyStyle(t,e.source),this.dispatchEvent({type:"style:load",source:e.source,style:t})}})},i.default.prototype.applyStyle=function(e,t){t||(t=Object.keys(e.sources)[0]),this._glStyle=e,(0,a.applyStyle)(this,e,t).then(()=>{this.dispatchEvent({type:"style:apply",source:t,style:e})})};var l=o}),n("aZxrf",function(e,r){t(e.exports,"default",()=>l);var i=s("gNqjI"),a=s("jPVWI");s("juLo9");var n=s("cWXYt");class o extends i.default{constructor(e){super(e),this.selectable(!1),this.setStyle((0,n.getStyleFn)())}}o.prototype.setSource=function(e){e&&(e.on("tileloadend",e=>{e.tile.getFeatures().forEach(e=>e.setLayer(this))}),!e.getAttributions()&&this.get("attributions")&&e.setAttributions(this.get("attributions"))),(0,i.default).prototype.setSource.call(this,e)},i.default.prototype.setIgnStyle=a.default.prototype.setIgnStyle,i.default.prototype.getIgnStyle=a.default.prototype.getIgnStyle,i.default.prototype.defaultIgnStyle=a.default.prototype.defaultIgnStyle,i.default.prototype.getPopupContent=a.default.prototype.getPopupContent,i.default.prototype.setPopupContent=a.default.prototype.setPopupContent,i.default.prototype.selectable=a.default.prototype.selectable;var l=o}),n("gNqjI",function(e,r){t(e.exports,"default",()=>u);var i=s("eJ4LZ"),a=s("iHrN6"),n=s("2YyN3"),o=s("8ElLP");class l extends n.default{constructor(e){let t=Object.assign({},e=e||{});delete t.preload;let r=void 0===e.cacheSize?0:e.cacheSize;delete e.cacheSize,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r;let a=e.renderMode||"hybrid";(0,i.assert)("hybrid"==a||"vector"==a,"`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=a,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),this.getBackground,this.setBackground}createRenderer(){return new a.default(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(o.default.PRELOAD)}getUseInterimTilesOnError(){return this.get(o.default.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(o.default.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(o.default.USE_INTERIM_TILES_ON_ERROR,e)}}var u=l}),n("iHrN6",function(e,r){t(e.exports,"default",()=>b);var i=s("av38f"),a=s("bCUH1"),n=s("kBSVF"),o=s("d1ltq"),l=s("jZquI"),u=s("8vXOK"),h=s("dVSax"),c=s("haGk2"),d=s("3CYjy"),p=s("6BjcK"),f=s("14PDX"),m=s("lVQul"),g=s("713Fw"),y=s("1FnBm");let v={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},_={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class x extends y.default{constructor(e,t){super(e,t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=(0,f.create)(),this.tileClipContexts_=null}drawTile(e,t,r,i,a,s,n,o){this.updateExecutorGroup_(e,t.pixelRatio,t.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,t),super.drawTile(e,t,r,i,a,s,n,o)}getTile(e,t,r,i){let s=this.getOrCreateTile(e,t,r,i);if(!s)return null;let n=i.viewState.resolution,o=i.viewHints;return(o[a.default.ANIMATING]||o[a.default.INTERACTING])&&s.wantedResolution||(s.wantedResolution=n),s}prepareFrame(e){let t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,r){let a=this.getLayer(),s=a.getRevision(),n=a.getRenderOrder()||null,o=e.wantedResolution,c=e.getReplayState(a);if(!c.dirty&&c.renderedResolution===o&&c.renderedRevision==s&&c.renderedRenderOrder==n)return;let d=a.getSource(),p=!!a.getDeclutter(),f=d.getTileGrid(),y=d.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),v=d.getSourceTiles(t,r,e),_=(0,m.getUid)(a);delete e.hitDetectionImageData[_],e.executorGroups[_]=[],c.dirty=!1;for(let r=0,s=v.length;r<s;++r){let s=v[r];if(s.getState()!=i.default.LOADED)continue;let m=s.tileCoord,x=f.getTileCoordExtent(m),b=(0,l.getIntersection)(y,x),S=(0,l.buffer)(b,a.getRenderBuffer()*o,this.tempExtent),w=(0,l.equals)(x,b)?null:S,E=new u.default(0,b,o,t),A=(0,g.getSquaredTolerance)(o,t),T=function(e,t){let r;let i=e.getStyleFunction()||a.getStyleFunction();if(i&&(r=i(e,o)),r){let i=this.renderFeature(e,A,r,E,p,t);c.dirty=c.dirty||i}},C=s.getFeatures();n&&n!==c.renderedRenderOrder&&C.sort(n);for(let e=0,t=C.length;e<t;++e){let t=C[e];(!w||(0,l.intersects)(w,t.getGeometry().getExtent()))&&T.call(this,t,e)}let P=E.finish(),R="vector"!==a.getRenderMode()&&p&&1===v.length?null:b,I=new h.default(R,o,t,d.getOverlaps(),P,a.getRenderBuffer(),!0);e.executorGroups[_].push(I)}c.renderedRevision=s,c.renderedRenderOrder=n,c.renderedResolution=o}forEachFeatureAtCoordinate(e,t,r,i,a){let s;let n=t.viewState.resolution,o=t.viewState.rotation;r=void 0==r?0:r;let u=this.getLayer(),h=u.getSource().getTileGridForProjection(t.viewState.projection),c=(0,l.boundingExtent)([e]);(0,l.buffer)(c,n*r,c);let d={},p=function(e,t,r){let s=e.getId();void 0===s&&(s=(0,m.getUid)(e));let n=d[s];if(n){if(!0!==n&&r<n.distanceSq){if(0===r)return d[s]=!0,a.splice(a.lastIndexOf(n),1),i(e,u,t);n.geometry=t,n.distanceSq=r}}else{if(0===r)return d[s]=!0,i(e,u,t);a.push(d[s]={feature:e,layer:u,geometry:t,distanceSq:r,callback:i})}},f=this.renderedTiles,g=(0,m.getUid)(u),y=u.getDeclutter(),v=y?t.declutter?.[y]?.all().map(e=>e.value):null;t:for(let t=0,i=f.length;t<i;++t){let i=f[t],a=h.getTileCoordExtent(i.wrappedTileCoord);if(!(0,l.intersects)(a,c))continue;let u=i.executorGroups[g];for(let t=0,i=u.length;t<i;++t)if(s=u[t].forEachFeatureAtCoordinate(e,n,o,r,p,v))break t}return s}getFeatures(e){return 0===this.renderedTiles.length?Promise.resolve([]):new Promise((t,r)=>{let a=this.getLayer(),s=a.getSource(),n=this.renderedProjection,u=n.getExtent(),h=this.renderedResolution,c=s.getTileGridForProjection(n),g=(0,f.apply)(this.renderedPixelToCoordinateTransform_,e.slice()),y=c.getTileCoordForCoordAndResolution(g,h).toString(),v=this.renderedTiles.find(e=>e.tileCoord.toString()===y&&e.getState()===i.default.LOADED);if(!v||v.loadingSourceTiles>0){t([]);return}s.getWrapX()&&n.canWrapX()&&!(0,l.containsExtent)(u,c.getTileCoordExtent(v.tileCoord))&&(0,o.wrapX)(g,n);let _=(0,m.getUid)(a),x=c.getTileCoordExtent(v.wrappedTileCoord),b=(0,l.getTopLeft)(x),S=[(g[0]-b[0])/h,(b[1]-g[1])/h],w=v.getSourceTiles().reduce((e,t)=>e.concat(t.getFeatures()),[]),E=v.hitDetectionImageData[_];if(!E){let e=(0,p.toSize)(c.getTileSize(c.getZForResolution(h,s.zDirection))),t=this.renderedRotation_,r=[this.getRenderTransform(c.getTileCoordCenter(v.wrappedTileCoord),h,0,d.HIT_DETECT_RESOLUTION,e[0]*d.HIT_DETECT_RESOLUTION,e[1]*d.HIT_DETECT_RESOLUTION,0)];E=(0,d.createHitDetectionImageData)(e,r,w,a.getStyleFunction(),c.getTileCoordExtent(v.wrappedTileCoord),v.getReplayState(a).renderedResolution,t),v.hitDetectionImageData[_]=E}t((0,d.hitDetect)(S,w,E))})}getFeaturesInExtent(e){let t=[],r=this.getTileCache();if(0===r.getCount())return t;let a=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),s=a.getZForResolution(this.renderedResolution),n={};return r.forEach(r=>{if(r.tileCoord[0]!==s||r.getState()!==i.default.LOADED)return;let o=r.getSourceTiles();for(let r=0,i=o.length;r<i;++r){let i=o[r],s=i.getKey();if(s in n)continue;n[s]=!0;let u=i.tileCoord;if((0,l.intersects)(e,a.getTileCoordExtent(u))){let r=i.getFeatures();if(r)for(let i=0,a=r.length;i<a;++i){let a=r[i],s=a.getGeometry();(0,l.intersects)(e,s.getExtent())&&t.push(a)}}}}),t}handleFontsChanged(){let e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){let r=this.context,i=r.globalAlpha;r.globalAlpha=t.opacity;let s=e.viewHints,n=!(s[a.default.ANIMATING]||s[a.default.INTERACTING]),o=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),u=l?e.declutter?.[l]:void 0,c=(0,m.getUid)(this.getLayer()),d=this.renderedTiles;for(let t=0,r=d.length;t<r;++t){let r=d[t],i=r.executorGroups[c];if(i)for(let t=i.length-1;t>=0;--t)i[t].execute(this.context,o,this.getTileRenderTransform(r,e),e.viewState.rotation,n,h.DECLUTTER,u)}r.globalAlpha=i}renderDeferredInternal(e){let t=this.renderedTiles,r=(0,m.getUid)(this.getLayer()),i=t.reduce((e,t,i)=>(t.executorGroups[r].forEach(t=>e.push({executorGroup:t,index:i})),e),[]),a=i.map(({executorGroup:e})=>e.getDeferredZIndexContexts()),s={};for(let e=0,t=i.length;e<t;++e){let t=i[e].executorGroup.getDeferredZIndexContexts();for(let e in t)s[e]=!0}Object.keys(s).map(Number).sort(n.ascending).forEach(e=>{a.forEach((t,r)=>{t[e]&&(t[e].forEach(e=>{let{executorGroup:t,index:a}=i[r],s=t.getRenderedContext(),n=s.globalAlpha;s.globalAlpha=this.renderedOpacity_;let o=this.tileClipContexts_[a];o&&o.draw(s),e.draw(s),o&&s.restore(),s.globalAlpha=n,e.clear()}),t[e].length=0)})})}getTileRenderTransform(e,t){let r=t.pixelRatio,i=t.viewState,a=i.center,s=i.resolution,n=i.rotation,o=t.size,l=Math.round(o[0]*r),u=Math.round(o[1]*r),h=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),c=e.tileCoord,d=h.getTileCoordExtent(e.wrappedTileCoord),p=h.getTileCoordExtent(c,this.tempExtent)[0]-d[0];return(0,f.multiply)((0,f.scale)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(a,s,n,r,l,u,p))}postRender(e,t){let r=t.viewHints,i=!(r[a.default.ANIMATING]||r[a.default.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;let s=this.getLayer(),n=s.getRenderMode(),o=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;let u=s.getDeclutter(),d=u?_[n].filter(e=>!(0,h.DECLUTTER).includes(e)):_[n],p=t.viewState,f=p.rotation,g=s.getSource(),y=g.getTileGridForProjection(p.projection).getZForResolution(p.resolution,g.zDirection),v=this.renderedTiles,x=[],b=[],S=[],w=(0,m.getUid)(s),E=!0;for(let r=v.length-1;r>=0;--r){let a;let n=v[r];E=E&&!n.getReplayState(s).dirty;let o=n.executorGroups[w].filter(e=>e.hasExecutors(d));if(0===o.length)continue;let h=this.getTileRenderTransform(n,t),p=n.tileCoord[0],m=!1,g=o[0].getClipCoords(h),_=e;if(g){_=(a=new c.default).getContext();for(let e=0,t=x.length;e<t;++e)if(y!==p&&p<b[e]){let t=x[e];(0,l.intersects)([g[0],g[3],g[4],g[7]],[t[0],t[3],t[4],t[7]])&&(m||(_.save(),m=!0),_.beginPath(),_.moveTo(g[0],g[1]),_.lineTo(g[2],g[3]),_.lineTo(g[4],g[5]),_.lineTo(g[6],g[7]),_.moveTo(t[6],t[7]),_.lineTo(t[4],t[5]),_.lineTo(t[2],t[3]),_.lineTo(t[0],t[1]),_.clip())}x.push(g),b.push(p)}for(let r=0,a=o.length;r<a;++r)o[r].execute(e,[e.canvas.width,e.canvas.height],h,f,i,d,t.declutter?.[u]);m&&(_===e?_.restore():S[r]=a)}e.globalAlpha=o,this.ready=E,this.tileClipContexts_=S,t.declutter||this.renderDeferredInternal(t),super.postRender(e,t)}renderFeature(e,t,r,i,a,s){if(!r)return!1;let n=!1;if(Array.isArray(r))for(let o=0,l=r.length;o<l;++o)n=(0,g.renderFeature)(i,e,r[o],t,this.boundHandleStyleImageChange_,void 0,a,s)||n;else n=(0,g.renderFeature)(i,e,r,t,this.boundHandleStyleImageChange_,void 0,a,s);return n}tileImageNeedsRender_(e){let t=this.getLayer();if("vector"===t.getRenderMode())return!1;let r=e.getReplayState(t),i=t.getRevision(),a=e.wantedResolution;return r.renderedTileResolution!==a||r.renderedTileRevision!==i}renderTileImage_(e,t){let r=this.getLayer(),i=e.getReplayState(r),a=r.getRevision(),s=e.executorGroups[(0,m.getUid)(r)];i.renderedTileRevision=a;let n=e.wrappedTileCoord,o=n[0],l=r.getSource(),u=t.pixelRatio,h=t.viewState.projection,c=l.getTileGridForProjection(h),d=c.getResolution(e.tileCoord[0]),p=t.pixelRatio/e.wantedResolution*d,g=c.getResolution(o),y=e.getContext();u=Math.round(Math.max(u,p/u));let _=l.getTilePixelSize(o,u,h);y.canvas.width=_[0],y.canvas.height=_[1];let x=u/p;if(1!==x){let e=(0,f.reset)(this.tmpTransform_);(0,f.scale)(e,x,x),y.setTransform.apply(y,e)}let b=c.getTileCoordExtent(n,this.tempExtent),S=p/g,w=(0,f.reset)(this.tmpTransform_);(0,f.scale)(w,S,-S),(0,f.translate)(w,-b[0],-b[3]);for(let e=0,t=s.length;e<t;++e)s[e].execute(y,[y.canvas.width*x,y.canvas.height*x],w,0,!0,v[r.getRenderMode()],null);i.renderedTileResolution=e.wantedResolution}}var b=x}),n("1FnBm",function(e,r){t(e.exports,"default",()=>S);var i=s("hyFBJ"),a=s("6EHBB"),n=s("jRKCY"),o=s("av38f"),l=s("kBSVF"),u=s("jZquI"),h=s("gzr8q"),c=s("lUH7Q"),d=s("6BjcK"),p=s("1rfTO"),f=s("9YraL"),m=s("14PDX"),g=s("lVQul"),y=s("ddIVC");function v(e,t,r,i){return`${e},${(0,f.getKeyZXY)(t,r,i)}`}function _(e,t,r){if(!(r in e))return e[r]=new Set([t]),!0;let i=e[r],a=i.has(t);return a||i.add(t),!a}function x(e,t){let r=e.layerStatesArray[e.layerIndex];r.extent&&(t=(0,u.getIntersection)(t,(0,h.fromUserExtent)(r.extent,e.viewState.projection)));let i=r.layer.getRenderSource();if(!i.getWrapX()){let r=i.getTileGridForProjection(e.viewState.projection).getExtent();r&&(t=(0,u.getIntersection)(t,r))}return t}class b extends y.default{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=(0,u.createEmpty)(),this.tempTileRange_=new n.default(0,0,0,0),this.tempTileCoord_=(0,f.createOrUpdate)(0,0,0);let r=void 0!==t.cacheSize?t.cacheSize:512;this.tileCache_=new p.default(r),this.maxStaleKeys=.5*r}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,r,i){let a;let s=this.tileCache_,n=this.getLayer().getSource(),o=v(n.getKey(),e,t,r);if(s.containsKey(o))a=s.get(o);else{if(!(a=n.getTile(e,t,r,i.pixelRatio,i.viewState.projection)))return null;s.set(o,a)}return a}getTile(e,t,r,i){return this.getOrCreateTile(e,t,r,i)||null}getData(e){let t=this.frameState;if(!t)return null;let r=this.getLayer(),s=(0,m.apply)(t.pixelToCoordinateTransform,e.slice()),n=r.getExtent();if(n&&!(0,u.containsCoordinate)(n,s))return null;let l=t.viewState,h=r.getRenderSource(),p=h.getTileGridForProjection(l.projection),f=h.getTilePixelRatio(t.pixelRatio);for(let e=p.getZForResolution(l.resolution);e>=p.getMinZoom();--e){let r;let n=p.getTileCoordForCoordAndZ(s,e),u=this.getTile(e,n[1],n[2],t);if(!u||u.getState()!==o.default.LOADED)continue;let m=p.getOrigin(e),g=(0,d.toSize)(p.getTileSize(e)),y=p.getResolution(e);if(u instanceof a.default||u instanceof c.default)r=u.getImage();else if(!(u instanceof i.default))continue;else if(!(r=(0,i.asImageLike)(u.getData())))continue;let v=Math.floor(f*((s[0]-m[0])/y-n[1]*g[0])),_=Math.floor(f*((m[1]-s[1])/y-n[2]*g[1])),x=Math.round(f*h.getGutterForProjection(l.projection));return this.getImageData(r,v+x,_+x)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;let t=this.getLayer().getSource();if(!t)return!1;let r=t.getRevision();return this.renderedRevision_?this.renderedRevision_!==r&&(this.renderedRevision_=r,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=r,!0}enqueueTiles(e,t,r,i,a){let s=e.viewState,n=this.getLayer(),l=n.getRenderSource(),h=l.getTileGridForProjection(s.projection),c=(0,g.getUid)(l);c in e.wantedTiles||(e.wantedTiles[c]={});let d=e.wantedTiles[c],p=n.getMapInternal(),m=Math.max(r-a,h.getMinZoom(),h.getZForResolution(Math.min(n.getMaxResolution(),p?p.getView().getResolutionForZoom(Math.max(n.getMinZoom(),0)):h.getResolution(0)),l.zDirection)),y=s.rotation,v=y?(0,u.getRotatedViewport)(s.center,s.resolution,y,e.size):void 0;for(let a=r;a>=m;--a){let r=h.getTileRangeForExtentAndZ(t,a,this.tempTileRange_),s=h.getResolution(a);for(let t=r.minX;t<=r.maxX;++t)for(let n=r.minY;n<=r.maxY;++n){if(y&&!h.tileCoordIntersectsViewport([a,t,n],v))continue;let r=this.getTile(a,t,n,e);if(!r||!_(i,r,a))continue;let l=r.getKey();if(d[l]=!0,r.getState()===o.default.IDLE&&!e.tileQueue.isKeyQueued(l)){let i=(0,f.createOrUpdate)(a,t,n,this.tempTileCoord_);e.tileQueue.enqueue([r,c,h.getTileCoordCenter(i),s])}}}}findStaleTile_(e,t){let r=this.tileCache_,i=e[0],a=e[1],s=e[2],n=this.getStaleKeys();for(let e=0;e<n.length;++e){let l=v(n[e],i,a,s);if(r.containsKey(l)){let e=r.peek(l);if(e.getState()===o.default.LOADED)return e.endTransition((0,g.getUid)(this)),_(t,e,i),!0}}return!1}findAltTiles_(e,t,r,i){let a=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!a)return!1;let s=!0,n=this.tileCache_,l=this.getLayer().getRenderSource().getKey();for(let e=a.minX;e<=a.maxX;++e)for(let t=a.minY;t<=a.maxY;++t){let a=v(l,r,e,t),u=!1;if(n.containsKey(a)){let e=n.peek(a);e.getState()===o.default.LOADED&&(_(i,e,r),u=!0)}u||(s=!1)}return s}renderFrame(e,t){let r,i=!0;this.renderComplete=!0;let a=e.layerStatesArray[e.layerIndex],s=e.viewState,n=s.projection,c=s.resolution,d=s.center,p=e.pixelRatio,f=this.getLayer(),y=f.getSource(),v=y.getTileGridForProjection(n),_=v.getZForResolution(c,y.zDirection),b=v.getResolution(_),S=y.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let w=e.extent,E=y.getTilePixelRatio(p);this.prepareContainer(e,t);let A=this.context.canvas.width,T=this.context.canvas.height,C=a.extent&&(0,h.fromUserExtent)(a.extent,n);C&&(w=(0,u.getIntersection)(w,(0,h.fromUserExtent)(a.extent,n)));let P=b*A/2/E,R=b*T/2/E,I=[d[0]-P,d[1]-R,d[0]+P,d[1]+R],L={};this.renderedTiles.length=0;let O=f.getPreload();if(e.nextExtent){let t=v.getZForResolution(s.nextResolution,y.zDirection),r=x(e,e.nextExtent);this.enqueueTiles(e,r,t,L,O)}let M=x(e,w);if(this.enqueueTiles(e,M,_,L,0),O>0&&setTimeout(()=>{this.enqueueTiles(e,M,_-1,L,O-1)},0),!(_ in L))return this.container;let k=(0,g.getUid)(this),N=e.time;for(let t of L[_]){let r=t.getState();if(r===o.default.EMPTY)continue;let a=t.tileCoord;if(r===o.default.LOADED&&1===t.getAlpha(k,N)){t.endTransition(k);continue}if(r!==o.default.IDLE&&(i=!1),r!==o.default.ERROR&&(this.renderComplete=!1),this.findStaleTile_(a,L)){(function(e,t,r){let i=e[r];i&&i.delete(t)})(L,t,_),e.animate=!0;continue}if(this.findAltTiles_(v,a,_+1,L))continue;let s=v.getMinZoom();for(let e=_-1;e>=s&&!this.findAltTiles_(v,a,e,L);--e);}let D=b/c*p/E,F=this.getRenderContext(e);(0,m.compose)(this.tempTransform,A/2,T/2,D,D,0,-A/2,-T/2),a.extent&&this.clipUnrotated(F,e,C),y.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e);let G=Object.keys(L).map(Number);G.sort(l.ascending);let z=[],q=[];for(let t=G.length-1;t>=0;--t){let i=G[t],a=y.getTilePixelSize(i,p,n),s=v.getResolution(i)/b,l=a[0]*s*D,h=a[1]*s*D,c=v.getTileCoordForCoordAndZ((0,u.getTopLeft)(I),i),d=v.getTileCoordExtent(c),f=(0,m.apply)(this.tempTransform,[E*(d[0]-I[0])/b,E*(I[3]-d[3])/b]),g=E*y.getGutterForProjection(n);for(let t of L[i]){if(t.getState()!==o.default.LOADED)continue;let a=t.tileCoord,s=c[1]-a[1],n=Math.round(f[0]-(s-1)*l),d=c[2]-a[2],p=Math.round(f[1]-(d-1)*h),m=Math.round(f[0]-s*l),v=Math.round(f[1]-d*h),_=n-m,x=p-v,b=1===G.length,S=!1;r=[m,v,m+_,v,m+_,v+x,m,v+x];for(let e=0,t=z.length;e<t;++e)if(!b&&i<q[e]){let t=z[e];(0,u.intersects)([m,v,m+_,v+x],[t[0],t[3],t[4],t[7]])&&(S||(F.save(),S=!0),F.beginPath(),F.moveTo(r[0],r[1]),F.lineTo(r[2],r[3]),F.lineTo(r[4],r[5]),F.lineTo(r[6],r[7]),F.moveTo(t[6],t[7]),F.lineTo(t[4],t[5]),F.lineTo(t[2],t[3]),F.lineTo(t[0],t[1]),F.clip())}z.push(r),q.push(i),this.drawTile(t,e,m,v,_,x,g,b),S&&F.restore(),this.renderedTiles.unshift(t),this.updateUsedTiles(e.usedTiles,y,t)}}return this.renderedResolution=b,this.extentChanged=!this.renderedExtent_||!(0,u.equals)(this.renderedExtent_,I),this.renderedExtent_=I,this.renderedPixelRatio=p,this.postRender(this.context,e),a.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete&&e.postRenderFunctions.push((e,t)=>{let r=(0,g.getUid)(y),i=t.wantedTiles[r],a=i?Object.keys(i).length:0;this.updateCacheSize(a),this.tileCache_.expireCache()}),this.renderComplete||i||(e.animate=!0),this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*e)}drawTile(e,t,r,a,s,n,o,l){let u;if(e instanceof i.default){if(!(u=(0,i.asImageLike)(e.getData())))throw Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;let h=this.getRenderContext(t),c=(0,g.getUid)(this),d=t.layerStatesArray[t.layerIndex],p=d.opacity*(l?e.getAlpha(c,t.time):1),f=p!==h.globalAlpha;f&&(h.save(),h.globalAlpha=p),h.drawImage(u,o,o,u.width-2*o,u.height-2*o,r,a,s,n),f&&h.restore(),p!==d.opacity?t.animate=!0:l&&e.endTransition(c)}getImage(){let e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){let i=(0,g.getUid)(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}var S=b}),n("hyFBJ",function(e,r){t(e.exports,"asImageLike",()=>n),t(e.exports,"asArrayLike",()=>o),t(e.exports,"default",()=>c);var i=s("hMeZw"),a=s("av38f");function n(e){return e instanceof Image||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageBitmap?e:null}function o(e){return e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e instanceof DataView?e:null}s("cgxQK");let l=Error("disposed"),u=[256,256];class h extends i.default{constructor(e){super(e.tileCoord,a.default.IDLE,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;let e=n(this.data_);return e?[e.width,e.height]:u}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==a.default.IDLE&&this.state!==a.default.ERROR)return;this.state=a.default.LOADING,this.changed();let e=this;this.loader_().then(function(t){e.data_=t,e.state=a.default.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=a.default.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(l),this.controller_=null),super.disposeInternal()}}var c=h}),n("hMeZw",function(e,r){t(e.exports,"default",()=>h);var i=s("av38f"),a=s("jZ9vT"),n=s("cw4dl"),o=s("9LzRi"),l=s("lVQul");class u extends o.default{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(n.default.CHANGE)}release(){this.setState(i.default.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==i.default.EMPTY){if(this.state!==i.default.ERROR&&this.state>e)throw Error("Tile load sequence violation");this.state=e,this.changed()}}load(){(0,l.abstract)()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(r){if(-1===r)return 1}else r=t,this.transitionStarts_[e]=r;let i=t-r+1e3/60;return i>=this.transition_?1:(0,a.easeIn)(i/this.transition_)}inTransition(e){return!!this.transition_&&-1!==this.transitionStarts_[e]}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}var h=u}),n("6EHBB",function(e,r){t(e.exports,"default",()=>u);var i=s("kUxvm"),a=s("hMeZw"),n=s("av38f"),o=s("cgxQK");class l extends a.default{constructor(e,t,r,i,a,s){super(e,t,s),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(e){this.image_=e,this.state=n.default.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=n.default.ERROR,this.unlistenImage_(),this.image_=function(){let e=(0,o.createCanvasContext2D)(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}(),this.changed()}handleImageLoad_(){let e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,i.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}var u=l}),n("jRKCY",function(e,r){t(e.exports,"createOrUpdate",()=>a),t(e.exports,"default",()=>s);class i{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function a(e,t,r,a,s){return void 0!==s?(s.minX=e,s.maxX=t,s.minY=r,s.maxY=a,s):new i(e,t,r,a)}var s=i}),n("lUH7Q",function(e,r){t(e.exports,"default",()=>m);var i=s("hMeZw"),a=s("av38f"),n=s("cgxQK"),o=s("cw4dl"),l=s("bsgMw"),u=s("jZquI"),h=s("a6roo"),c=s("gpSXC"),d=s("9JHmh"),p=s("9ndmc");class f extends i.default{constructor(e,t,r,i,s,n,o,l,f,m,g,y){super(s,a.default.IDLE,y),this.renderEdges_=void 0!==g&&g,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=n||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;let v=i.getTileCoordExtent(this.wrappedTileCoord_),_=this.targetTileGrid_.getExtent(),x=this.sourceTileGrid_.getExtent(),b=_?(0,u.getIntersection)(v,_):v;if(0===(0,u.getArea)(b)){this.state=a.default.EMPTY;return}let S=e.getExtent();S&&(x=x?(0,u.getIntersection)(x,S):S);let w=i.getResolution(this.wrappedTileCoord_[0]),E=(0,c.calculateSourceExtentResolution)(e,r,b,w);if(!isFinite(E)||E<=0){this.state=a.default.EMPTY;return}let A=void 0!==m?m:p.ERROR_THRESHOLD;if(this.triangulation_=new d.default(e,r,b,x,E*A,w),0===this.triangulation_.getTriangles().length){this.state=a.default.EMPTY;return}this.sourceZ_=t.getZForResolution(E);let T=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(T[1]=(0,h.clamp)(T[1],x[1],x[3]),T[3]=(0,h.clamp)(T[3],x[1],x[3])):T=(0,u.getIntersection)(T,x)),(0,u.getArea)(T)){let r=0,i=0;e.canWrapX()&&(r=(0,u.getWidth)(S),i=Math.floor((T[0]-S[0])/r)),(0,u.wrapAndSliceX)(T.slice(),e,!0).forEach(e=>{let a=t.getTileRangeForExtentAndZ(e,this.sourceZ_);for(let e=a.minX;e<=a.maxX;e++)for(let t=a.minY;t<=a.maxY;t++){let a=f(this.sourceZ_,e,t,o);if(a){let e=i*r;this.sourceTiles_.push({tile:a,offset:e})}}++i}),0===this.sourceTiles_.length&&(this.state=a.default.EMPTY)}else this.state=a.default.EMPTY}getImage(){return this.canvas_}reproject_(){let e=[];if(this.sourceTiles_.forEach(t=>{let r=t.tile;if(r&&r.getState()==a.default.LOADED){let i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;let a=this.clipExtent_?.slice();a&&(a[0]+=t.offset,a[2]+=t.offset),e.push({extent:i,clipExtent:a,image:r.getImage()})}}),this.sourceTiles_.length=0,0===e.length)this.state=a.default.ERROR;else{let t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i="number"==typeof r?r:r[0],s="number"==typeof r?r:r[1],n=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,c.render)(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),n,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=a.default.LOADED}this.changed()}load(){if(this.state==a.default.IDLE){this.state=a.default.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{let r=t.getState();if(r==a.default.IDLE||r==a.default.LOADING){e++;let r=(0,l.listen)(t,o.default.CHANGE,i=>{let s=t.getState();(s==a.default.LOADED||s==a.default.ERROR||s==a.default.EMPTY)&&((0,l.unlistenByKey)(r),0==--e&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},t,r){e.getState()==a.default.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(l.unlistenByKey),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,n.releaseCanvas)(this.canvas_.getContext("2d")),(0,c.canvasPool).push(this.canvas_),this.canvas_=null),super.release()}}var m=f}),n("gpSXC",function(e,r){let i;t(e.exports,"canvasPool",()=>u),t(e.exports,"calculateSourceResolution",()=>d),t(e.exports,"calculateSourceExtentResolution",()=>p),t(e.exports,"render",()=>f);var a=s("cgxQK"),n=s("jZquI"),o=s("a6roo"),l=s("gzr8q");let u=[];function h(e,t,r,i,a){e.beginPath(),e.moveTo(0,0),e.lineTo(t,r),e.lineTo(i,a),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,i)+1,Math.max(r,a)),e.restore()}function c(e,t){return Math.abs(e[4*t]-210)>2||Math.abs(e[4*t+3]-191.25)>2}function d(e,t,r,i){let a=(0,l.transform)(r,t,e),s=(0,l.getPointResolution)(t,i,r),o=t.getMetersPerUnit();void 0!==o&&(s*=o);let u=e.getMetersPerUnit();void 0!==u&&(s/=u);let h=e.getExtent();if(!h||(0,n.containsCoordinate)(h,a)){let t=(0,l.getPointResolution)(e,s,a)/s;isFinite(t)&&t>0&&(s/=t)}return s}function p(e,t,r,i){let a=d(e,t,(0,n.getCenter)(r),i);return(!isFinite(a)||a<=0)&&(0,n.forEachCorner)(r,function(r){return isFinite(a=d(e,t,r,i))&&a>0}),a}function f(e,t,r,s,l,d,p,f,m,g,y,v,_,x){let b;let S=(0,a.createCanvasContext2D)(Math.round(r*e),Math.round(r*t),u);if(v||(S.imageSmoothingEnabled=!1),0===m.length)return S.canvas;function w(e){return Math.round(e*r)/r}S.scale(r,r),S.globalCompositeOperation="lighter";let E=(0,n.createEmpty)();m.forEach(function(e,t,r){(0,n.extend)(E,e.extent)});let A=r/s,T=(v?1:1.0000000596046448)/A;if(!_||1!==m.length||0!==g){if(b=(0,a.createCanvasContext2D)(Math.round((0,n.getWidth)(E)*A),Math.round((0,n.getHeight)(E)*A),u),v||(b.imageSmoothingEnabled=!1),l&&x){let e=(l[0]-E[0])*A,t=-(l[3]-E[3])*A,r=(0,n.getWidth)(l)*A,i=(0,n.getHeight)(l)*A;b.rect(e,t,r,i),b.clip()}m.forEach(function(e,t,r){if(e.image.width>0&&e.image.height>0){if(e.clipExtent){b.save();let t=(e.clipExtent[0]-E[0])*A,r=-(e.clipExtent[3]-E[3])*A,i=(0,n.getWidth)(e.clipExtent)*A,a=(0,n.getHeight)(e.clipExtent)*A;b.rect(v?t:Math.round(t),v?r:Math.round(r),v?i:Math.round(t+i)-Math.round(t),v?a:Math.round(r+a)-Math.round(r)),b.clip()}let t=(e.extent[0]-E[0])*A,r=-(e.extent[3]-E[3])*A,i=(0,n.getWidth)(e.extent)*A,a=(0,n.getHeight)(e.extent)*A;b.drawImage(e.image,g,g,e.image.width-2*g,e.image.height-2*g,v?t:Math.round(t),v?r:Math.round(r),v?i:Math.round(t+i)-Math.round(t),v?a:Math.round(r+a)-Math.round(r)),e.clipExtent&&b.restore()}})}let C=(0,n.getTopLeft)(p);return f.getTriangles().forEach(function(e,t,r){let s;let l=e.source,p=e.target,f=l[0][0],g=l[0][1],y=l[1][0],_=l[1][1],x=l[2][0],A=l[2][1],P=w((p[0][0]-C[0])/d),R=w(-(p[0][1]-C[1])/d),I=w((p[1][0]-C[0])/d),L=w(-(p[1][1]-C[1])/d),O=w((p[2][0]-C[0])/d),M=w(-(p[2][1]-C[1])/d),k=f,N=g;f=0,g=0;let D=[[y-=k,_-=N,0,0,I-P],[x-=k,A-=N,0,0,O-P],[0,0,y,_,L-R],[0,0,x,A,M-R]],F=(0,o.solveLinearSystem)(D);if(F){if(S.save(),S.beginPath(),function(){if(void 0===i){let e=(0,a.createCanvasContext2D)(6,6,u);e.globalCompositeOperation="lighter",e.fillStyle="rgba(210, 0, 0, 0.75)",h(e,4,5,4,0),h(e,4,5,0,5);let t=e.getImageData(0,0,3,3).data;i=c(t,0)||c(t,4)||c(t,8),(0,a.releaseCanvas)(e),u.push(e.canvas)}return i}()||!v){S.moveTo(I,L);let e=P-I,t=R-L;for(let r=0;r<4;r++)S.lineTo(I+w((r+1)*e/4),L+w(r*t/3)),3!=r&&S.lineTo(I+w((r+1)*e/4),L+w((r+1)*t/3));S.lineTo(O,M)}else S.moveTo(I,L),S.lineTo(P,R),S.lineTo(O,M);if(S.clip(),S.transform(F[0],F[2],F[1],F[3],P,R),S.translate(E[0]-k,E[3]-N),b)s=b.canvas,S.scale(T,-T);else{let e=m[0],t=e.extent;s=e.image,S.scale((0,n.getWidth)(t)/s.width,-(0,n.getHeight)(t)/s.height)}S.drawImage(s,0,0),S.restore()}}),b&&((0,a.releaseCanvas)(b),u.push(b.canvas)),y&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,f.getTriangles().forEach(function(e,t,r){let i=e.target,a=(i[0][0]-C[0])/d,s=-(i[0][1]-C[1])/d,n=(i[1][0]-C[0])/d,o=-(i[1][1]-C[1])/d,l=(i[2][0]-C[0])/d,u=-(i[2][1]-C[1])/d;S.beginPath(),S.moveTo(n,o),S.lineTo(a,s),S.lineTo(l,u),S.closePath(),S.stroke()}),S.restore()),S.canvas}}),n("9JHmh",function(e,r){t(e.exports,"default",()=>l);var i=s("jZquI"),a=s("a6roo"),n=s("gzr8q"),o=s("14PDX"),l=class{constructor(e,t,r,a,s,l,u){this.sourceProj_=e,this.targetProj_=t;let h={},c=u?(0,n.createTransformFromCoordinateTransform)(e=>(0,o.apply)(u,(0,n.transform)(e,this.targetProj_,this.sourceProj_))):(0,n.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(e){let t=e[0]+"/"+e[1];return h[t]||(h[t]=c(e)),h[t]},this.maxSourceExtent_=a,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!a&&!!this.sourceProj_.getExtent()&&(0,i.getWidth)(a)>=(0,i.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,i.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,i.getWidth)(this.targetProj_.getExtent()):null;let d=(0,i.getTopLeft)(r),p=(0,i.getTopRight)(r),f=(0,i.getBottomRight)(r),m=(0,i.getBottomLeft)(r),g=this.transformInv_(d),y=this.transformInv_(p),v=this.transformInv_(f),_=this.transformInv_(m),x=10+(l?Math.max(0,Math.ceil(Math.log2((0,i.getArea)(r)/(l*l*65536)))):0);if(this.addQuad_(d,p,f,m,g,y,v,_,x),this.wrapsXInSource_){let e=1/0;this.triangles_.forEach(function(t,r,i){e=Math.min(e,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(t=>{if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-e>this.sourceWorldWidth_/2){let r=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];r[0][0]-e>this.sourceWorldWidth_/2&&(r[0][0]-=this.sourceWorldWidth_),r[1][0]-e>this.sourceWorldWidth_/2&&(r[1][0]-=this.sourceWorldWidth_),r[2][0]-e>this.sourceWorldWidth_/2&&(r[2][0]-=this.sourceWorldWidth_);let i=Math.min(r[0][0],r[1][0],r[2][0]);Math.max(r[0][0],r[1][0],r[2][0])-i<this.sourceWorldWidth_/2&&(t.source=r)}})}h={}}addTriangle_(e,t,r,i,a,s){this.triangles_.push({source:[i,a,s],target:[e,t,r]})}addQuad_(e,t,r,s,n,o,l,u,h){let c=(0,i.boundingExtent)([n,o,l,u]),d=this.sourceWorldWidth_?(0,i.getWidth)(c)/this.sourceWorldWidth_:null,p=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&d>.5&&d<1,m=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let a=(0,i.boundingExtent)([e,t,r,s]);m=(0,i.getWidth)(a)/this.targetWorldWidth_>.25||m}!f&&this.sourceProj_.isGlobal()&&d&&(m=d>.25||m)}if(!m&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!(0,i.intersects)(c,this.maxSourceExtent_))return;let g=0;if(!m&&(!isFinite(n[0])||!isFinite(n[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)m=!0;else if(1!=(g=(isFinite(n[0])&&isFinite(n[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(l[0])&&isFinite(l[1])?0:2)+(isFinite(u[0])&&isFinite(u[1])?0:1))&&2!=g&&4!=g&&8!=g)return}if(h>0){if(!m){let t;let i=[(e[0]+r[0])/2,(e[1]+r[1])/2],s=this.transformInv_(i);t=f?((0,a.modulo)(n[0],p)+(0,a.modulo)(l[0],p))/2-(0,a.modulo)(s[0],p):(n[0]+l[0])/2-s[0];let o=(n[1]+l[1])/2-s[1];m=t*t+o*o>this.errorThresholdSquared_}if(m){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){let i=[(t[0]+r[0])/2,(t[1]+r[1])/2],a=this.transformInv_(i),c=[(s[0]+e[0])/2,(s[1]+e[1])/2],d=this.transformInv_(c);this.addQuad_(e,t,i,c,n,o,a,d,h-1),this.addQuad_(c,i,r,s,d,a,l,u,h-1)}else{let i=[(e[0]+t[0])/2,(e[1]+t[1])/2],a=this.transformInv_(i),c=[(r[0]+s[0])/2,(r[1]+s[1])/2],d=this.transformInv_(c);this.addQuad_(e,i,c,s,n,a,d,u,h-1),this.addQuad_(i,t,r,c,a,o,l,d,h-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(11&g)==0&&this.addTriangle_(e,r,s,n,l,u),(14&g)==0&&this.addTriangle_(e,r,t,n,l,o),g&&((13&g)==0&&this.addTriangle_(t,s,e,o,u,n),(7&g)==0&&this.addTriangle_(t,s,r,o,u,l))}calculateSourceExtent(){let e=(0,i.createEmpty)();return this.triangles_.forEach(function(t,r,a){let s=t.source;(0,i.extendCoordinate)(e,s[0]),(0,i.extendCoordinate)(e,s[1]),(0,i.extendCoordinate)(e,s[2])}),e}getTriangles(){return this.triangles_}}}),n("9ndmc",function(e,r){t(e.exports,"ERROR_THRESHOLD",()=>i);let i=.5}),n("1rfTO",function(e,r){t(e.exports,"default",()=>n);var i=s("jjfV9"),a=s("eJ4LZ"),n=class{constructor(e){this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let e=this.pop();e instanceof i.default&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){let r=this.entries_[e];return(0,a.assert)(void 0!==r,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){let t=this.entries_[e];return(0,a.assert)(void 0!==t,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){let e;let t=Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.key_;return t}getValues(){let e;let t=Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){let e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){(0,a.assert)(!(e in this.entries_),"Tried to set a value for a key that is used already");let r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}}),n("9YraL",function(e,r){function i(e,t,r,i){return void 0!==i?(i[0]=e,i[1]=t,i[2]=r,i):[e,t,r]}function a(e,t,r){return e+"/"+t+"/"+r}function s(e){return a(e[0],e[1],e[2])}function n(e){var t;return t=e[0],(e[1]<<t)+e[2]}function o(e,t,r){return(t<<e)+r}function l(e,t){let r=e[0],i=e[1],a=e[2];if(t.getMinZoom()>r||r>t.getMaxZoom())return!1;let s=t.getFullTileRange(r);return!s||s.containsXY(i,a)}t(e.exports,"createOrUpdate",()=>i),t(e.exports,"getKeyZXY",()=>a),t(e.exports,"getKey",()=>s),t(e.exports,"hash",()=>n),t(e.exports,"hashZXY",()=>o),t(e.exports,"withinExtentAndZ",()=>l)}),n("8ElLP",function(e,r){t(e.exports,"default",()=>i);var i={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}}),n("jPVWI",function(e,r){t(e.exports,"default",()=>m);var i=s("3VGVQ"),a=s("610XN"),n=s("7qsnY"),o=s("gYZ48"),l=s("bFM0O"),u=s("j2K3b"),h=s("jZquI");s("agkzb"),s("eXEIX"),s("juLo9");var c=s("gIJof"),d=s("cWXYt"),p=s("86esn");class f extends i.default{constructor(e){super(e=e||{}),e.renderOrder=d.ordering,e.style=(0,d.getStyleFn)({ghost:e.ghostStyle}),e.displayInLayerSwitcher=!1,e.dessin=!0,e.popupHoverSelect=!1,this.layerVector_=new a.default(e),this.layerVector_.set("parent",this),this.getSource().setAttributions(e.copyright||""),this.layerVector_.selectable=()=>this.selectable(),this.layerVector_.set("name","vector"),this.getLayers().push(this.layerVector_),this.layerImage_=new n.default(e),this.layerImage_.set("parent",this),this.layerImage_.set("name","image"),this.getLayers().push(this.layerImage_),this.layerImage_.selectable=()=>this.selectable(),this.layerImage_.on(["filter","change:visible"],()=>{setTimeout(()=>{if(this._mcFilter&&this.layerImage_.getVisible()&&this.layerVector_.getMapInternal()&&this.layerVector_.getMapInternal().getViewport()){let e=this.layerVector_.getMapInternal().getViewport().querySelector(".ol-layers ."+this.layerImage_.getClassName());if(e){let t=[],r=[];this._mcFilter.get("filter")&&t.push(this._mcFilter.get("filter")),this._mcFilter.get("blend")&&r.push(this._mcFilter.get("blend")),e.style.filter=t.join(" "),e.style.mixBlendMode=r.join(" ")}else setTimeout(()=>this.layerImage_.dispatchEvent("filter"),200)}})}),this.on("change:visible",()=>this.layerImage_.dispatchEvent("filter")),this.getSource().getFeatures().forEach(e=>e._layer=this),this.setMode("vector"),this.getSource().on("addfeature",(function(t){let r=t.feature;r._layer=this;let i=Object.values(this.getAttributes());if(i.length){let e=r.getProperties();i.forEach(t=>{Object.prototype.hasOwnProperty.call(e,t.name)||r.set(t.name,t.default)})}e.onaddfeature&&e.onaddfeature(t)}).bind(this)),this.getSource().on("removefeature",(function(e){delete e.feature._layer}).bind(this)),(0,c.default)(()=>{this.clearCache(),this.layerVector_.changed()}),this.layerVector_.on("prerender",e=>{"cluster"===this.getMode()&&e.frameState.viewState.zoom<=this.get("maxZoomCluster")&&(this.layerVector_.setVisible(!1),this.layerCluster_.setVisible(!0),this.activateCluster(!0))})}}f.prototype.addFilter=function(e){(0,i.default).prototype.addFilter.call(this,e),this.layerVector_.addFilter(e),this.layerCluster_&&this.layerCluster_.addFilter(e),this.layerImage_.addFilter(e),this.layerImage_.dispatchEvent({type:"filter"})},f.prototype.removeFilter=function(e){(0,i.default).prototype.removeFilter.call(this,e),this.layerVector_.removeFilter(e),this.layerCluster_&&this.layerCluster_.removeFilter(e),this.layerImage_.removeFilter(e),this.layerImage_.dispatchEvent({type:"filter"})},f.prototype.getSource=function(){return this.layerVector_.getSource()},f.prototype.getStyle=function(){return this.layerVector_.getStyle()},f.prototype.getGeomTypes=function(e){var t={};return(this.getSource().getFeatures().forEach(e=>t[e.getGeometry().getType()]=!0),e)?!(Object.getOwnPropertyNames(t).length>2)&&t[e]:t},f.prototype.getPopupContent=function(e){return e?e.getPopupContent(this._popupContent||{}):this._popupContent||{}},f.prototype.setPopupContent=function(e){!e||e instanceof Array?this._popupContent={}:this._popupContent=e},f.prototype.setIgnStyle=function(e,t){(!this._ignStyle||Array.isArray(this._ignStyle))&&(this._ignStyle={}),void 0===t?this._ignStyle=e:""!==t&&/width|radius|size|offset/i.test(e)&&(t=Number(t)),""!==t&&t!=f.prototype.defaultIgnStyle[e]?this._ignStyle[e]=t:delete this._ignStyle[e]},f.prototype.getIgnStyle=function(e){return e?!0===e?Object.assign({},p.defaultIgnStyle,this._ignStyle):(0,d.getIgnStyle)(e):this._ignStyle},f.prototype.defaultIgnStyle=p.defaultIgnStyle,f.prototype.getConditionStyle=function(){return this._conditionStyle||[]},f.prototype.setConditionStyle=function(e){this._conditionStyle=e},f.prototype.getAttributes=function(){return this._attributes||(this._attributes={}),this._attributes},f.prototype.setAttributes=function(e){Array.isArray(e)?(this._attributes={},e.forEach(e=>this._attributes[e.name]=e)):this._attributes=e},f.prototype.clearCache=function(){(0,d.clearCache)()},f.prototype.setMode=function(e,t){t=t||{},this._renderMode=e,this.layerVector_.setVisible(!1),this.layerImage_.setVisible(!1),this.layerCluster_&&(this.layerCluster_.setVisible(!1),this.activateCluster(!1)),isNaN(parseFloat(t.maxZoomCluster))||this.set("maxZoomCluster",parseFloat(t.maxZoomCluster)),void 0===t.clusterDistance&&(t.clusterDistance=t.distance),this.set("clusterDistance",parseFloat(t.clusterDistance||t.distance)||40),this.set("clusterDash",!!t.clusterDash),t.clusterType?this.set("clusterType",t.clusterType):this.set("clusterType","normal"),t.clusterColor?this.set("clusterColor",t.clusterColor):this.set("clusterColor",null),t.displayClusterPopup?this.set("displayClusterPopup",t.displayClusterPopup):this.set("displayClusterPopup",!1);let r=Math.max(0,"number"==typeof t.minSizeCluster?t.minSizeCluster:0),i=Math.max(0,"number"==typeof t.maxSizeCluster?t.maxSizeCluster:0);if(r>i){let e=i;i=r,r=e}switch(this.set("minSizeCluster",r),this.set("maxSizeCluster",i),e){case"cluster":if(!this.layerCluster_){var a=new o.default({geometryFunction:function(e){var t=e.getGeometry();return"Point"===t.getType()?t:new u.default((0,h.getCenter)(t.getExtent()))},distance:t.clusterDistance||40,source:this.getSource()});this.layerCluster_=new l.default({name:"cluster",className:this.getClassName(),displayInLayerSwitcher:!1,source:a,animationDuration:t.animationDuration}),this.getLayers().push(this.layerCluster_),this.layerCluster_.set("parent",this),this.layerCluster_.selectable=()=>this.selectable(),this.layerCluster_.on("prerender",e=>{e.frameState.viewState.zoom>this.get("maxZoomCluster")&&(this.layerVector_.setVisible(!0),this.layerCluster_.setVisible(!1),this.activateCluster(!1))})}t.clusterDistance&&this.layerCluster_.getSource().setDistance(t.clusterDistance),this.layerCluster_.setStyle((0,d.getStyleFn)(t)),this.layerCluster_.setVisible(!0),this.activateCluster(!0);break;case"image":this.layerImage_.setVisible(!0);break;default:this.layerVector_.setVisible(!0)}},f.prototype.selectable=function(e){return!0===e?this.set("selectable",!0):!1===e&&this.set("selectable",!1),!1!==this.get("selectable")},f.prototype.getMode=function(){return this._renderMode||"vector"},f.prototype.getLayer=function(){switch(this.getMode()){case"cluster":return this.layerCluster_;case"image":return this.layerImage_;default:return this.layerVector_}},f.prototype.setDeclutter=function(e){this.layerVector_.declutter_=!!e,this.layerImage_.declutter_=!!e},f.prototype.getDeclutter=function(){return this.layerVector_.getDeclutter()},f.prototype.activateCluster=function(e,t){this.layerCluster_&&(this.layerCluster_.getSource().set("inactive",!e),e&&!t&&this.layerCluster_.getSource().refresh())};var m=f}),n("7qsnY",function(e,r){t(e.exports,"default",()=>o);var i=s("kVTQK"),a=s("2YyN3");class n extends a.default{constructor(e){let t=Object.assign({},e=e||{});delete t.imageRatio,super(t),this.imageRatio_=void 0!==e.imageRatio?e.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new i.default(this)}}var o=n}),n("kVTQK",function(r,i){t(r.exports,"default",()=>g);var a=s("4wfAy"),n=s("34ffr"),o=s("50PZ9"),l=s("bCUH1"),u=s("cw4dl"),h=s("jZquI"),c=s("djufG"),d=s("14PDX"),p=s("fnQuI"),f=s("6M65l");class m extends p.default{constructor(e){super(e),this.vectorRenderer_=new f.default(e),this.layerImageRatio_=e.getImageRatio(),this.coordinateToVectorPixelTransform_=(0,d.create)(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(e){if(!this.vectorRenderer_)return Promise.resolve([]);let t=(0,d.apply)(this.coordinateToVectorPixelTransform_,(0,d.apply)(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(t)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(t){let r=t.pixelRatio,i=t.viewState,s=i.resolution,p=t.viewHints,f=this.vectorRenderer_,m=t.extent;1!==this.layerImageRatio_&&(m=m.slice(0),(0,h.scaleFromCenter)(m,this.layerImageRatio_));let g=(0,h.getWidth)(m)/s,y=(0,h.getHeight)(m)/s;if(!p[l.default.ANIMATING]&&!p[l.default.INTERACTING]&&!(0,h.isEmpty)(m)){f.useContainer(null,null);let l=f.context,h=Object.assign({},t.layerStatesArray[t.layerIndex],{opacity:1}),p=Object.assign({},t,{extent:m,size:[g,y],viewState:Object.assign({},t.viewState,{rotation:0}),layerStatesArray:[h],layerIndex:0,declutter:null}),v=this.getLayer().getDeclutter();v&&(p.declutter={[v]:new(e(a))(9)});let _=!0,x=new n.default(m,s,r,l.canvas,function(e){f.prepareFrame(p)&&f.replayGroupChanged&&(f.clipping=!1,f.renderFrame(p,null)&&(f.renderDeclutter(p),f.renderDeferred(p),_=!1),e())});x.addEventListener(u.default.CHANGE,()=>{if(x.getState()!==o.default.LOADED)return;this.image=_?null:x;let e=x.getPixelRatio(),t=(0,c.fromResolutionLike)(x.getResolution())*r/e;this.renderedResolution=t,this.coordinateToVectorPixelTransform_=(0,d.compose)(this.coordinateToVectorPixelTransform_,g/2,y/2,1/t,-1/t,0,-i.center[0],-i.center[1])}),x.load()}return this.image&&(this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice()),!!this.image}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(e,t,r,i,a){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,i,a):super.forEachFeatureAtCoordinate(e,t,r,i,a)}}var g=m}),n("34ffr",function(e,r){t(e.exports,"default",()=>o);var i=s("kUxvm"),a=s("50PZ9");class n extends i.default{constructor(e,t,r,i,s){super(e,t,r,void 0!==s?a.default.IDLE:a.default.LOADED),this.loader_=void 0!==s?s:null,this.canvas_=i,this.error_=null}getError(){return this.error_}handleLoad_(e){e?(this.error_=e,this.state=a.default.ERROR):this.state=a.default.LOADED,this.changed()}load(){this.state==a.default.IDLE&&(this.state=a.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}var o=n}),n("djufG",function(e,r){t(e.exports,"fromResolutionLike",()=>i);function i(e){return Array.isArray(e)?Math.min(...e):e}}),n("fnQuI",function(e,r){t(e.exports,"default",()=>c);var i=s("50PZ9"),a=s("bCUH1"),n=s("jZquI"),o=s("gzr8q"),l=s("14PDX"),u=s("ddIVC");class h extends u.default{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){let t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,s=e.viewState,l=s.resolution,u=this.getLayer().getSource(),h=e.viewHints,c=e.extent;if(void 0!==t.extent&&(c=(0,n.getIntersection)(c,(0,o.fromUserExtent)(t.extent,s.projection))),!h[a.default.ANIMATING]&&!h[a.default.INTERACTING]&&!(0,n.isEmpty)(c)){if(u){let e=s.projection,t=u.getImage(c,l,r,e);t&&(this.loadImage(t)?this.image=t:t.getState()===i.default.EMPTY&&(this.image=null))}else this.image=null}return!!this.image}getData(e){let t=this.frameState;if(!t)return null;let r=this.getLayer(),i=(0,l.apply)(t.pixelToCoordinateTransform,e.slice()),a=r.getExtent();if(a&&!(0,n.containsCoordinate)(a,i))return null;let s=this.image.getExtent(),o=this.image.getImage(),u=(0,n.getWidth)(s),h=Math.floor(o.width*((i[0]-s[0])/u));if(h<0||h>=o.width)return null;let c=(0,n.getHeight)(s),d=Math.floor(o.height*((s[3]-i[1])/c));return d<0||d>=o.height?null:this.getImageData(o,h,d)}renderFrame(e,t){let r=this.image,i=r.getExtent(),a=r.getResolution(),[s,u]=Array.isArray(a)?a:[a,a],h=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],d=e.pixelRatio,p=e.viewState,f=p.center,m=p.resolution;this.prepareContainer(e,t);let g=this.context.canvas.width,y=this.context.canvas.height,v=this.getRenderContext(e),_=!1,x=!0;if(c.extent){let t=(0,o.fromUserExtent)(c.extent,p.projection);(_=(x=(0,n.intersects)(t,e.extent))&&!(0,n.containsExtent)(t,e.extent))&&this.clipUnrotated(v,e,t)}let b=r.getImage(),S=(0,l.compose)(this.tempTransform,g/2,y/2,d*s/(m*h),d*u/(m*h),0,h*(i[0]-f[0])/s,h*(f[1]-i[3])/u);this.renderedResolution=u*d/h;let w=b.width*S[0],E=b.height*S[3];if(this.getLayer().getSource().getInterpolate()||(v.imageSmoothingEnabled=!1),this.preRender(v,e),x&&w>=.5&&E>=.5){let e=S[4],t=S[5],r=c.opacity;1!==r&&(v.save(),v.globalAlpha=r),v.drawImage(b,0,0,+b.width,+b.height,e,t,w,E),1!==r&&v.restore()}return this.postRender(this.context,e),_&&v.restore(),v.imageSmoothingEnabled=!0,this.container}}var c=h}),n("gYZ48",function(e,r){t(e.exports,"default",()=>o);var i=s("hyHoG"),a=i.default.prototype.cluster;i.default.prototype.cluster=function(){this.get("inactive")||a.call(this)};var n=i.default.prototype.refresh;i.default.prototype.refresh=function(){this.get("inactive")||n.call(this)};var o=i.default}),n("hyHoG",function(e,r){t(e.exports,"default",()=>p);var i=s("iGyOD"),a=s("eJ4LZ"),n=s("d1ltq"),o=s("cw4dl"),l=s("jZquI"),u=s("j2K3b"),h=s("lVQul"),c=s("20LS2");class d extends c.default{constructor(e){e=e||{},super({attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=void 0!==e.distance?e.distance:20,this.minDistance=e.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=e.geometryFunction||function(e){let t=e.getGeometry();return(0,a.assert)(!t||"Point"===t.getType(),"The default `geometryFunction` can only handle `Point` or null geometries"),t},this.createCustomCluster_=e.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(e.source||null)}clear(e){this.features.length=0,super.clear(e)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(e,t,r){this.source?.loadFeatures(e,t,r),t!==this.resolution&&(this.resolution=t,this.refresh())}setDistance(e){this.updateDistance(e,this.minDistance)}setMinDistance(e){this.updateDistance(this.distance,e)}getMinDistance(){return this.minDistance}setSource(e){this.source&&this.source.removeEventListener(o.default.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(o.default.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(e,t){let r=0===e?0:Math.min(t,e)/e,i=e!==this.distance||this.interpolationRatio!==r;this.distance=e,this.minDistance=t,this.interpolationRatio=r,i&&this.refresh()}cluster(){if(void 0===this.resolution||!this.source)return;let e=(0,l.createEmpty)(),t=this.distance*this.resolution,r=this.source.getFeatures(),i={};for(let a=0,s=r.length;a<s;a++){let s=r[a];if(!((0,h.getUid)(s) in i)){let r=this.geometryFunction(s);if(r){let a=r.getCoordinates();(0,l.createOrUpdateFromCoordinate)(a,e),(0,l.buffer)(e,t,e);let s=this.source.getFeaturesInExtent(e).filter(function(e){let t=(0,h.getUid)(e);return!(t in i)&&(i[t]=!0,!0)});this.features.push(this.createCluster(s,e))}}}}createCluster(e,t){let r=[0,0];for(let t=e.length-1;t>=0;--t){let i=this.geometryFunction(e[t]);i?(0,n.add)(r,i.getCoordinates()):e.splice(t,1)}(0,n.scale)(r,1/e.length);let a=(0,l.getCenter)(t),s=this.interpolationRatio,o=new u.default([r[0]*(1-s)+a[0]*s,r[1]*(1-s)+a[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,e):new i.default({geometry:o,features:e})}}var p=d}),n("bFM0O",function(e,r){t(e.exports,"default",()=>d);var i=s("610XN"),a=s("20LS2"),n=s("iGyOD"),o=s("jZ9vT"),l=s("jZquI"),u=s("j2K3b"),h=s("kTGMi"),c=s("bQRGA"),d=class extends i.default{constructor(e){var t=e||{};super(t),this.oldcluster=new a.default,this.clusters=[],this.animation={start:!1},this.set("animationDuration","number"==typeof t.animationDuration?t.animationDuration:700),this.set("animationMethod",t.animationMethod||o.easeOut),this.on(["precompose","prerender"],this.animate.bind(this)),this.on(["postcompose","postrender"],this.postanimate.bind(this))}setSource(e){this._saveClusterFn||(this._saveClusterFn=this.saveCluster.bind(this)),this.getSource()&&this.getSource().un("change",this._saveClusterFn),(0,i.default).prototype.setSource.call(this,e),this.getSource()&&this.getSource().on("change",this._saveClusterFn)}saveCluster(){if(this.oldcluster&&(this.oldcluster.clear(),this.get("animationDuration"))){var e=this.getSource().getFeatures();e.length&&e[0].get("features")&&(this.oldcluster.addFeatures(this.clusters),this.clusters=e.slice(0),this.sourceChanged=!0)}}getClusterForFeature(e,t){for(var r,i=0;r=t[i];i++){var a=r.get("features");if(a&&a.length){for(var s,n=0;s=a[n];n++)if(e===s)return r}}return!1}stopAnimation(){this.animation.start=!1,this.animation.cA=[],this.animation.cB=[]}animate(e){var t=this.get("animationDuration");if(t){var r,i,a=e.frameState.viewState.resolution,s=this.animation,o=e.frameState.time;if(s.resolution!=a&&this.sourceChanged){var d=e.frameState.extent;for(s.resolution<a?(d=(0,l.buffer)(d,100*a),s.cA=this.oldcluster.getFeaturesInExtent(d),s.cB=this.getSource().getFeaturesInExtent(d),s.revers=!1):(d=(0,l.buffer)(d,100*a),s.cA=this.getSource().getFeaturesInExtent(d),s.cB=this.oldcluster.getFeaturesInExtent(d),s.revers=!0),s.clusters=[],r=0;i=s.cA[r];r++){var p=i.get("features");if(p&&p.length){var f=this.getClusterForFeature(p[0],s.cB);f&&s.clusters.push({f:i,pt:f.getGeometry().getCoordinates()})}}if(s.resolution=a,this.sourceChanged=!1,!s.clusters.length||s.clusters.length>1e3){this.stopAnimation();return}o=s.start=new Date().getTime()}if(s.start){var m=e.vectorContext||(0,h.default)(e),g=(o-s.start)/t;g>1&&(this.stopAnimation(),g=1),g=this.get("animationMethod")(g);var y=this.getStyle(),v="function"==typeof y?y:y.length?function(){return y}:function(){return[y]};for(e.context.save(),e.context.globalAlpha=this.getOpacity(),r=0;f=s.clusters[r];r++){var _=f.f.getGeometry().getCoordinates(),x=_[0]-f.pt[0],b=_[1]-f.pt[1];s.revers?(_[0]=f.pt[0]+g*x,_[1]=f.pt[1]+g*b):(_[0]=_[0]-g*x,_[1]=_[1]-g*b);var S=v(f.f,a,!0);if(S.length||(S=[S]),1!==f.f.get("features").length||x||b){var w=new u.default(_);p=new n.default(w)}else p=f.f.get("features")[0];for(var E,A=0;E=S[A];A++)if(E.getText()&&/\n/.test(E.getText().getText())){var T,C=E.getText().getOffsetX(),P=E.getText().getOffsetY(),R=E.getText().getRotation()||0,I=1.2*Number((E.getText().getFont()||"10px").match(/\d+/)),L=E.getText().getText().split("\n"),O=L.length-1,M=E.clone();L.forEach(function(t,r){switch(1==r&&(M.setImage(),M.setFill(),M.setStroke()),E.getText().getTextBaseline()){case"alphabetic":case"ideographic":case"bottom":T=O;break;case"hanging":case"top":T=0;break;default:T=O/2}M.getText().setOffsetX(C-Math.sin(R)*I*(r-T)),M.getText().setOffsetY(P+Math.cos(R)*I*(r-T)),M.getText().setText(t),m.drawFeature(p,(0,c.default)(e,M))})}else m.drawFeature(p,(0,c.default)(e,E))}e.context.restore(),e.frameState.animate=!0,e.context.save(),e.context.beginPath(),e.context.rect(0,0,0,0),e.context.clip(),this.clip_=!0}}}postanimate(e){this.clip_&&(e.context.restore(),this.clip_=!1)}}}),n("kTGMi",function(e,r){t(e.exports,"default",()=>n);var i=s("14PDX"),a=s("htGzg"),n=function(e){let t=e.frameState,r=(0,i.multiply)(e.inversePixelTransform.slice(),t.coordinateToPixelTransform);return new a.default(e.context,t.pixelRatio,t.extent,r,t.viewState.rotation)}}),n("bQRGA",function(e,r){t(e.exports,"default",()=>o);var i=s("lVQul"),a=s("ayeEa"),n=(0,i.VERSION).split(".");n=100*parseInt(n[0])+parseInt(n[1]);var o=function(e,t){var r=e.frameState.pixelRatio;if(n>605&&n<700&&1!==r&&t.getImage() instanceof a.default){var i=(t=t.clone()).getImage();i.setScale(i.getScale()*r);var s=i.getAnchor();if(s&&i.setDisplacement){var o=i.getDisplacement();o&&(o[0]-=s[0]/r,o[1]+=s[1]/r,i.setAnchor([0,0]))}else s&&(s[0]/=r,s[1]/=r)}return t}}),n("cWXYt",function(r,i){t(r.exports,"clearCache",()=>R),t(r.exports,"getIgnStyle",()=>M),t(r.exports,"ordering",()=>k),t(r.exports,"getStyleFn",()=>B),t(r.exports,"getSelectStyleFn",()=>H),t(r.exports,"getShownFeatureStyleFn",()=>Z),t(r.exports,"style2IgnStyle",()=>s("hwcfb").default),t(r.exports,"defaultIgnStyle",()=>s("86esn").defaultIgnStyle);var a=s("l9IGS"),n=s("kuKBR"),o=s("9yR4T"),l=s("4lFOe"),u=s("aUPR1"),h=s("d5AAH"),c=s("2zf1Y"),d=s("8SYbd"),p=s("lqNjm"),f=s("lW8xZ"),m=s("j2K3b"),g=s("cgPpQ"),y=s("ljDIj"),v=s("boqwt"),_=s("h1ihb"),x=s("3yg5q"),b=s("foAUE"),S=s("bXE6B");s("hwcfb");var w=s("2iBkg"),E=s("gVmm4"),A=s("l956U"),T=s("86esn");let C={},P=(window.devicePixelRatio,30);function R(){C={},window.devicePixelRatio}function I(e){return new y.default(function e(t){if(!t||!t[0].length||!t[0][0].length)return t;for(var r=[],i=0;i<t.length;i++)r=r.concat(e(t[i]));return r}(e.getGeometry().getCoordinates()))}let L={};function O(e,t){var r=e.join(",");if(!Object.prototype.hasOwnProperty.call(L,r))try{for(var i=[],a=0;a<3;a++){var s=e[a]/255;s<=.03928?i[a]=s/12.92:i[a]=Math.pow((s+.055)/1.055,2.4)}L[r]=.2126*i[0]+.7152*i[1]+.0722*i[2]}catch(e){L[r]=1}return L[r]<(t||.3)}function M(e,t){var r={};for(var i in T.defaultIgnStyle)r[i]=e.getIgnStyle(i,t);t||!e.getIgnStyle().pointGlyph||e.getIgnStyle().pointIcon||(r.pointIcon="");var a=!r.pointIcon&&/poi|bubble|marker|coma|shield|triangle|blazon/.test(e.getIgnStyle("pointForm",t));switch(r.pointShadow=a,r.pointOffsetY=a?1:0,/Point/.test(e.getGeometry().getType())?r.textPlacement="point":/Line/.test(e.getGeometry().getType())?"point"===r.textPlacement&&(r.textAlign="center",r.textBaseline="middle"):(r.textAlign="center",r.textPlacement="point",r.textBaseline="middle"),r.strokeDash){case"flecheRond":r.strokeDash="",r.strokeArrow="circle";break;case"flecheCarre":r.strokeDash="",r.strokeArrow="square";break;case"flecheTriangle":r.strokeDash="",r.strokeArrow="triangle"}return r}function k(e,t){let r=Number((e.getIgnStyle()||{}).zIndex||0),i=Number((t.getIgnStyle()||{}).zIndex||0);return r===i?t.getGeometry().getFirstCoordinate()[1]-e.getGeometry().getFirstCoordinate()[1]:r-i}function N(e){return e&&parseInt(e)?Math.min(Math.max(20,parseInt(e)/2),20):P}function D(e,t,r){return Math.max(t||8,Math.min(.75*e,r||P))}function F(e,t,r){return Math.min(.75*e+(t||8)+4,r||P)}function G(e){let t;t=(e=e||{}).type&&"color"==e.type?e.color:e.size>25?[192,0,0]:e.size>8?[255,128,0]:[0,128,0];var r,i=D(e.size,e.min,e.max);return!1!==e.dash&&(r=[0,r=2*Math.PI*i/6,r,r,r,r,r]),new l.default({radius:i,stroke:new h.default({color:"rgba("+t.join(",")+",0.5)",width:15,lineDash:r,lineCap:"butt"}),fill:new c.default({color:"rgba("+t.join(",")+",1)"}),declutterMode:"none"})}function z(e){var t=e.get("features");return t&&1===t.length?e.get("features")[0].getGeometry():e.getGeometry()}let q=new E.default,j={Point:/point/i,LineString:/linestring/i,Polygon:/polygon/i};function B(t){return t||(t={}),function(r,i,s){let o;window.devicePixelRatio;let l="#fff",f=t.clusterType,m=t.clusterDistance;t.clusterColor&&"color"==f&&(l=O(o=(0,p.asArray)(t.clusterColor).slice(0,3))?"#fff":"#000");let g=t.clusterDash,y="normal"==t.clusterType?0:"color"==t.clusterType?1:2,v=(t.clusterColor?t.clusterColor.join(","):"")+"-"+(!1===g?0:1)+"-"+(parseInt(m)?parseInt(m):40)+"-"+y;P=N(m);var _,x,b,S,w,E,A,T,R,I=r.get("features");if(I){if(1==I.length)r=I[0];else{if(!f&&I[0].getLayer()&&(f=I[0].getLayer().get("clusterType")),!f)return[];P=N(m=m||I[0].getLayer().get("clusterDistance")),(o=o||(I[0].getLayer()?I[0].getLayer().get("clusterColor"):null))&&(l=O(o=o.slice(0,3))?"#fff":"#000"),y="normal"==f?0:"color"==f?1:2,v=(o?o.join(","):"")+"-"+(!1===g?0:1)+"-"+(parseInt(m)?parseInt(m):40)+"-"+y;let i=[],s=I[0].getLayer();return(s&&(v+="-"+(i=[s.get("minSizeCluster"),s.get("maxSizeCluster")]).join("-")),"stat"==f)?function(t,r,i,s,o,l,p,f){let m=t.get("dataColor");for(let i in m||(m={},r.forEach(t=>{let r=function(t){let r;let i=t.getLayer().getStyle()(t);if(0==i.length)return null;switch(t.getGeometry().getType()){case"MultiPoint":case"Point":{let t=i[0].getImage();r=t._color,e(d).valid(r)||(t.img_?"transparent"===(r=t._stroke.getColor())&&(r="rgba(128,128,128,0.5)"):r=i.length>1?i[1].getImage()._color:null);break}default:r=i[0].getStroke().getColor()}return r}(t);null!==r&&(r in m?m[r]++:m[r]=1)}),t.dataColor=m),m)i.includes("#")||(m[e(d)(i).hex()]=m[i],delete m[i]);let g=Object.keys(m).sort(),y="",v=[],_=[];g.forEach(e=>{v.push(e),_.push(m[e]),y+=e.toString()+m[e].toString()});let x=_.reduce((e,t)=>e+t,0),b="cluster-stat:"+y+"-"+s,S=C[b];return S||(S=C[b]=new a.default({image:function(e){let t=(e=e||{}).colors,r=e.data,i=F(e.size,e.min,e.max);return new u.default({type:"donut",radius:i,data:r,colors:t,rotateWithView:!0,stroke:new h.default({color:"#FFF",width:2})})}({size:x,min:i[0],max:i[1],colors:v,data:_,dash:l}),text:new n.default({text:x.toString(),scale:1.3,fill:new c.default({color:"black"}),backgroundFill:new c.default({color:"rgba(255, 255, 255, 0.5)"})})})).setZIndex(f.zIndex||0),[S]}(r,I,i,v,0,g,0,t):(_=i,x=v,b=o,S=l,w=f,E=t,(R=C[T="cluster-"+w+":"+(A=I.length)+"-"+x])||(R=C[T]=new a.default({image:G({size:A,min:_[0],max:_[1],color:b,dash:g,type:w}),text:new n.default({text:A.toString(),fill:new c.default({color:S})})})).setZIndex(E.zIndex||0),[R])}}return r.getLayer()&&r.getLayer().getConditionStyle&&r.getLayer().getConditionStyle().length?function(e,t,r,i){let a=e.getLayer().getConditionStyle();for(let n=0;n<a.length;n++){let o=a[n];if(!o.symbol||j[o.symbol.getType()].test(e.getGeometry().getType())){let t=o.condition.conditions;var s=o.condition.all;for(let r=0;r<t.length;r++){let i=t[r];i.attr&&(s=o.condition.all?s&&q._checkCondition(e,i,o.condition.useCase):s||q._checkCondition(e,i,o.condition.useCase))}}if(s){if(!o.symbol)return[];return U(e,t,r,o.symbol.getIgnStyle(),i)}}return U(e,t,r,e.getLayer().getIgnStyle(!0),i)}(r,s,t,o):U(r,s,t,null,o)}}function U(e,t,r,i,s){let o;if(!i&&e.getLayer() instanceof S.default&&e.getLayer().layerStat&&e.getLayer().layerStat.getStyle)return[e.getLayer().layerStat.getStyle()(e)[0]];var u,d,g,y,E,T=M(e,i);T.pointIcon=(0,A.default).doData(T.pointIcon,e.getProperties());var P=e.getGeometry().getType(),R=e.get(T.labelAttribute)||T.labelAttribute,I={main:(L=(L=r.select)?"sel":"")+(t?"mainc":"main:")+T.pointRadius+"-"+T.pointIcon+"-"+T.pointFrame+"-"+T.pointCrop+"-"+T.pointGlyph+"-"+T.pointForm+"-"+T.symbolColor+"-"+T.pointColor+"-"+T.pointStrokeColor+"-"+T.pointStrokeWidth+"-"+T.pointRotation+"-"+T.pointGradient+"-"+T.strokeWidth+"-"+T.strokeDash+"-"+T.strokeColor+"-"+T.fillColor+"-"+T.fillPattern+"-"+T.sizePattern+"-"+T.spacingPattern+"-"+T.anglePattern+"-"+T.offsetPattern+"-"+T.scalePattern+"-"+T.fillColorPattern+"-",shadow:L+"shad:"+T.poointRadius,arrow:L+"arrow:"+T.strokeWidth+"-"+T.strokeArrow+"-"+T.strokeColor+"-",text:L+"text:"+T.pointRadius+"-"+T.textColor+"-"+T.textStyle+"-"+T.textSize+"-"+T.textFont+"-"+T.textOutlineColor+"-"+T.textOutlineWidth+"-"+T.textAlign+"-"+T.textBaseline+"-"+T.textBgFill+"-"+T.textBgStroke+"-"+T.textBgStrokeWidth+"-"+T.textPlacement+"-"+T.textOverflow};if(!(k=C[I.main])){var L,k,N,D=function(e){var t=e.strokeDash;if(t&&"string"==typeof t&&(t=e.strokeDash.split(","),e.strokeWidth>0))for(var r in t)t[r]=Math.max(0,(Number(t[r])+r%2*2-1)*e.strokeWidth)*(f.DEVICE_PIXEL_RATIO||1);return t}(T);N=t&&"Point"!==P?G({size:1,color:s}):function(e,t,r,i,a){var s;if(t.pointIcon&&t.pointRadius){let i=(0,w.getMediaURL)(t.pointIcon),a=(0,p.asArray)(t.pointColor||"transparent")[3],n=t.pointFrame&&a&&0!==t.pointStrokeWidth?2:0,o=Math.min(t.pointRadius,t.pointFrame?t.pointStrokeWidth:0);(s=new v.default({src:i,crossOrigin:"anonymous",kind:t.pointFrame,crop:t.pointCrop,radius:t.pointRadius-o,offsetX:n,offsetY:"anchored"===t.pointFrame?8-n-t.pointRadius:n,shadow:2*n,onload:function(){C[e]&&(C[e].setImage(s),r.changed())},stroke:new h.default({width:o,color:t.pointFrame?t.pointColor:"transparent"}),declutterMode:"none"})).declutterMode_="none",s.getPhoto().addEventListener("error",()=>{s._gethit=null,s.img_=null,s._crossOrigin=!1,s.getImage()})}else if(!i||a||t.pointRadius){let e=(0,p.asArray)(t.pointGlyph?t.pointColor:t.symbolColor);e[3]||(e[3]=1e-4),(s=new _.default({radius:t.pointRadius,glyph:t.pointGlyph,color:t.symbolColor,form:t.pointForm||(t.pointGlyph?void 0:"circle"),rotation:t.pointRotation*Math.PI/180,gradient:Number(t.pointGradient),offsetX:0,offsetY:-t.pointOffsetY*t.pointRadius,fill:new c.default({color:e}),stroke:new h.default({color:t.pointStrokeWidth?t.pointStrokeColor:"transparent",width:Math.min(t.pointStrokeWidth,t.pointRadius/2)}),declutterMode:"none"})).declutterMode_="none"}else s=new l.default({radius:5,fill:new c.default({color:"rgba(0,0,0,0.5)"}),stroke:new h.default({color:"rgba(255,255,255,1)",width:1.5}),declutterMode:"none"});return s}(I.main,T,e,r.ghost,R);var F=T.fillPattern&&"vide"!=T.fillPattern?new x.default({pattern:T.fillPattern,image:void 0,ratio:1,color:T.fillColor,size:T.sizePattern,spacing:T.spacingPattern,angle:T.anglePattern,offset:T.offsetPattern,scale:T.scalePattern,fill:new c.default({color:T.fillColorPattern})}):new c.default({color:T.fillColor}),q=new h.default({color:T.strokeWidth?T.strokeColor:r.ghost&&/line/i.test(P)?"rgba(0,0,0,0.25)":"transparent",width:T.strokeWidth||(r.ghost&&/line/i.test(P)?.5:0),lineDash:D});r.select&&/highlight|zoom/.test(r.select)&&q.setWidth(q.getWidth()+Math.max(3,1.2*q.getWidth())),k=C[I.main]=new a.default({image:N,fill:F,stroke:q,geometry:z})}return(k.setZIndex(r.zIndex||0),o=[k],T.pointShadow&&"Point"==P)?((k=C[I.shadow+"-"+T.pointRadius])||(k=C[I.shadow+"-"+T.pointRadius]=function(e){let t=new a.default({image:new b.default({radius:.5*e.pointRadius,declutterMode:"none"}),zIndex:-1,geometry:z});return t.getImage().declutterMode_="none",t}(T)),k.setZIndex(r.zIndex||0),o.unshift(k)):!t&&T.strokeArrow&&"LineString"==P&&((k=C[I.arrow])||(k=C[I.arrow]=function(e){var t=e.strokeWidth+6;let r=new _.default({form:e.strokeArrow,radius:t,offsetY:"triangle"===e.strokeArrow?-5:0,rotation:0,rotateWithView:!0,fill:new c.default({color:e.strokeColor}),declutterMode:"none"});return r.declutterMode_="none",new a.default({image:r,geometry:function(e){return new m.default(e.get("features")?e.get("features")[0].getGeometry().getLastCoordinate():e.getGeometry().getLastCoordinate())}})}(T)),u=k,g=(d=e.getGeometry().getCoordinates()).pop(),y=d.pop(),E=0,g&&y&&(E=Math.atan2(y[0]-g[0],y[1]-g[1])),u.getImage().setRotation(E),k.setZIndex(r.zIndex||0),o.push(k)),(R?((k=C[I.text])||(k=C[I.text]=function(e){if(!e.textOutlineColor)try{e.textOutlineColor=O((0,p.asArray)(e.textColor))?[255,255,255,.6]:[0,0,0,.6]}catch(t){e.textOutlineColor=[255,255,255,.6]}let t="rgba(0, 0, 0, 0)"!==e.textBgFill,r="rgba(0, 0, 0, 0)"!==e.textBgStroke,i=t||r?[4,2,2,4]:[0,0,0,0],s={font:e.textStyle+" "+e.textSize+"px "+e.textFont,fill:new c.default({color:e.textColor}),stroke:t?void 0:new h.default({color:e.textOutlineColor,width:e.textOutlineWidth}),textAlign:e.textAlign,maxAngle:3,textBaseline:e.textBaseline,placement:e.textPlacement,overflow:e.textOverflow,backgroundFill:t?new c.default({color:e.textBgFill}):void 0,backgroundStroke:r?new h.default({color:e.textBgStroke,width:e.textBgStrokeWidth}):void 0,padding:i};return"point"===e.textPlacement&&(s.offsetX="left"==e.textAlign?e.pointRadius+i[3]:"right"==e.textAlign?-e.pointRadius-i[1]:0,s.offsetY=/^top|^hanging/.test(e.textBaseline)?e.pointRadius+i[0]:/^bottom|^alphabetic/.test(e.textBaseline)?-e.pointRadius-i[2]:0),new a.default({text:new n.default(s),geometry:z})}(T)),k.getText().setText(R.replace?e.getLabelContent("(("+R.replace(/\\n/g,"\n")+"))"):e.getLabelContent("(("+R+"))")),k.setZIndex(r.zIndex||0),o.push(k)):R="",T.pointRadius||String(R).trim().length)?o:[new a.default({fill:new c.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new h.default({color:"#ffcc33",width:2}),image:new l.default({radius:4,fill:new c.default({color:"#ffcc33"}),declutterMode:"none"}),geometry:z})]}function H(e,t){let r=t||Number.MAX_SAFE_INTEGER,i=(e=e||{}).styleFn||B({zIndex:r,select:e.type}),s=e.color?(0,p.asArray)(e.color):[255,0,0],n=s.slice();n[3]=.5;let u=e.stroke||new h.default({color:s,width:2}),d=e.fill||new c.default({color:n}),f=e.radius||5,m=u.getColor(),y=!1!==e.showObject,v=e.points instanceof o.default?e.points:new l.default({stroke:new h.default({color:m,width:1}),radius:5,declutterMode:"none"}),_=new a.default({image:v,geometry:I,zIndex:r}),x=new h.default({color:m,width:5}),b=new a.default({image:new l.default({stroke:u,fill:d,radius:f,declutterMode:"none"}),stroke:u,fill:d,zIndex:r});return function(t,s){let n,o;let h=!(e.features.getLength()>10)&&e.points;switch(e.type){case"highlight":case"zoom":return o=i(t,s),n=[],o.forEach(e=>{let t=e.clone();t.getImage()&&(t.getImage().setScale(1.25),t.getImage().setRotation(e.getImage().getRotation())),!t.getStroke()&&!t.getFill()&&t.getText()&&t.getText().setScale(1.2),n.push(t)}),h&&n.push(_),n;case"overlay":return(n=y?i(t,s):[]).push(b),h&&n.push(_),n;default:{n=y?i(t,s):[];let e=t.getGeometry();if(/Point/.test(e.getType())){let e=t.get("features"),i=t,s=D;e instanceof Array&&(1==e.length?(i=e[0],e=!1):"stat"===e[0].getLayer().get("clusterType")&&(s=F));let o=(e instanceof Array?s(e.length):i.getIgnStyle("pointRadius")||5)+f;n.unshift(new a.default({image:new l.default({stroke:x,radius:o,declutterMode:"none"}),zIndex:r}))}else h&&n.push(_),n.unshift(new a.default({stroke:u,geometry:(0,g.fromExtent)(e.getExtent()),zIndex:r}));return n}}}}function Z(e){let t=1/0,r=(e=e||{}).styleFn||H(e,t),i=e.color?(0,p.asArray)(e.color):[255,0,0],s=e.stroke||new h.default({color:i,width:5}),n=i.slice();n[3]=.5;let o=e.fill||new c.default({color:n}),u=new a.default({fill:o,zIndex:t}),d=e.radius||5,f=s.getColor(),m=!1!==e.showObject,g=new h.default({color:f,width:5});return new a.default({image:new l.default({stroke:s,fill:o,radius:d,declutterMode:"none"}),stroke:s,fill:o,zIndex:t}),function(i,s){let n;switch(e.type){case"highlight":case"zoom":if("function"==typeof(n=r(i,s))&&(n=n(i)),n&&n.length){let e=i.getGeometry();if(n[0].setZIndex(t),/Point/.test(e.getType())){let e=i.get("features"),r=i,s=D;e instanceof Array&&(1==e.length?(r=e[0],e=!1):"stat"===e[0].getLayer().get("clusterType")&&(s=F));let o=(e instanceof Array?s(e.length):r.getIgnStyle("pointRadius")||5)+d;n.unshift(new a.default({image:new l.default({stroke:g,radius:o,declutterMode:"none"}),zIndex:t}))}else n.push(u),n[0].getStroke()&&n[0].getStroke().setWidth(n[0].getStroke().getWidth()+2)}return n;default:return m?r(i,s):[]}}}}),n("aUPR1",function(e,r){t(e.exports,"default",()=>l);var i=s("h6Aha"),a=s("2zf1Y"),n=s("lqNjm"),o=class extends i.default{constructor(e){var t=e||{},r=0;e.stroke&&(r=e.stroke.getWidth()),super({radius:t.radius+r,fill:new a.default({color:[0,0,0]}),rotation:t.rotation,displacement:t.displacement,snapToPixel:t.snapToPixel,declutterMode:t.declutterMode}),this.setScale(t.scale||1),this._stroke=t.stroke,this._radius=t.radius||20,this._donutratio=t.donutRatio||.5,this._type=t.type,this._offset=[t.offsetX?t.offsetX:0,t.offsetY?t.offsetY:0],this._animation="number"==typeof t.animation?{animate:!0,step:t.animation}:this._animation={animate:!1,step:1},this._max=t.max,this._done=!1,this._data=t.data,t.colors instanceof Array?this._colors=t.colors:(this._colors=o.colors[t.colors],this._colors||(this._colors=o.colors.classic)),this.render()}clone(){var e=new o({type:this._type,radius:this._radius,rotation:this.getRotation(),scale:this.getScale(),data:this.getData(),snapToPixel:!!this.getSnapToPixel&&this.getSnapToPixel(),stroke:this._stroke,colors:this._colors,offsetX:this._offset[0],offsetY:this._offset[1],animation:this._animation,declutterMode:this.getDeclutterMode?this.getDeclutterMode():null});return e.setScale(this.getScale()),e.setOpacity(this.getOpacity()),e}getData(){return this._data}setData(e){this._data=e,this._done=!1}getRadius(){return this._radius}setRadius(e,t){this._radius=e,this.donuratio_=t||this.donuratio_,this._done=!1}setAnimation(e){if(!1===e){if(!1==this._animation.animate)return;this._animation.animate=!1}else{if(this._animation.step==e)return;this._animation.animate=!0,this._animation.step=e}this._done=!1}createRenderOptions(){var e=super.createRenderOptions();return e.chartOptions=["chart",Object.values(this._animation||{}).join(","),this._type,(this._data||[]).join(","),(this._colors||[]).join(","),this._donutratio,this._max].join("-"),e}getImage(e){e=e||1;var t=super.getImage(e);if(this._done===e)return t;this._done=e;var r=0;this._stroke&&(o=(0,n.asString)(this._stroke.getColor()),r=this._stroke.getWidth());var i=t.getContext("2d");i.save(),i.setTransform(e,0,0,e,0,0),i.clearRect(0,0,t.width,t.height),i.lineJoin="round";var a=0;for(l=0;l<this._data.length;l++)a+=this._data[l];i.translate(0,0);var s=this._animation.animate?this._animation.step:1;switch(this._type){case"donut":case"pie3D":case"pie":var o,l,u,h,c=Math.PI*(s-1.5);for(u=t.width/2/e,i.strokeStyle=o,i.lineWidth=r,i.save(),"pie3D"==this._type&&(i.translate(0,.3*u),i.scale(1,.7),i.beginPath(),i.fillStyle="#369",i.arc(u,1.4*u,this._radius*s,0,2*Math.PI),i.fill(),i.stroke()),"donut"==this._type&&(i.save(),i.beginPath(),i.rect(0,0,2*u,2*u),i.arc(u,u,this._radius*s*this._donutratio,0,2*Math.PI),i.clip("evenodd")),l=0;l<this._data.length;l++)i.beginPath(),i.moveTo(u,u),i.fillStyle=this._colors[l%this._colors.length],h=c+2*Math.PI*this._data[l]/a*s,i.arc(u,u,this._radius*s,c,h),i.closePath(),i.fill(),i.stroke(),c=h;"donut"==this._type&&(i.restore(),i.beginPath(),i.strokeStyle=o,i.lineWidth=r,i.arc(u,u,this._radius*s*this._donutratio,Math.PI*(s-1.5),c),i.stroke()),i.restore();break;default:var d=0;if(this._max)d=this._max;else for(l=0;l<this._data.length;l++)d<this._data[l]&&(d=this._data[l]);var p=Math.min(5,2*this._radius/this._data.length);u=t.width/2/e;var f,m=t.width/e-r,g=u-this._data.length*p/2;for(l=0,i.strokeStyle=o,i.lineWidth=r;l<this._data.length;l++){i.beginPath(),i.fillStyle=this._colors[l%this._colors.length],f=g+p;var y=this._data[l]/d*2*this._radius*s;i.rect(g,m-y,p,y),i.closePath(),i.fill(),i.stroke(),g=f}}if(i.restore(),!this.setDisplacement){var v=this.getAnchor();v[0]=u-this._offset[0],v[1]=u-this._offset[1]}return t}};o.colors={classic:["#ffa500","blue","red","green","cyan","magenta","yellow","#0f0"],dark:["#960","#003","#900","#060","#099","#909","#990","#090"],pale:["#fd0","#369","#f64","#3b7","#880","#b5d","#666"],pastel:["#fb4","#79c","#f66","#7d7","#acc","#fdd","#ff9","#b9b"],neon:["#ff0","#0ff","#0f0","#f0f","#f00","#00f"]};var l=o}),n("8SYbd",function(e,t){e.exports,e.exports=function(){for(var e=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e<t?t:e>r?r:e},t={},r=0,i=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];r<i.length;r+=1){var a=i[r];t["[object "+a+"]"]=a.toLowerCase()}var s=function(e){return t[Object.prototype.toString.call(e)]||"object"},n=Math.PI,o={clip_rgb:function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var r=0;r<=3;r++)r<3?((t[r]<0||t[r]>255)&&(t._clipped=!0),t[r]=e(t[r],0,255)):3===r&&(t[r]=e(t[r],0,1));return t},limit:e,type:s,unpack:function(e,t){return(void 0===t&&(t=null),e.length>=3)?Array.prototype.slice.call(e):"object"==s(e[0])&&t?t.split("").filter(function(t){return void 0!==e[0][t]}).map(function(t){return e[0][t]}):e[0]},last:function(e){if(e.length<2)return null;var t=e.length-1;return"string"==s(e[t])?e[t].toLowerCase():null},TWOPI:2*n,PITHIRD:n/3,DEG2RAD:n/180,RAD2DEG:180/n},l={format:{},autodetect:[]},u=o.last,h=o.clip_rgb,c=o.type,d=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("object"===c(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var r=u(e),i=!1;if(!r){i=!0,l.sorted||(l.autodetect=l.autodetect.sort(function(e,t){return t.p-e.p}),l.sorted=!0);for(var a=0,s=l.autodetect;a<s.length;a+=1){var n=s[a];if(r=n.test.apply(n,e))break}}if(l.format[r]){var o=l.format[r].apply(null,i?e:e.slice(0,-1));this._rgb=h(o)}else throw Error("unknown format: "+e);3===this._rgb.length&&this._rgb.push(1)};d.prototype.toString=function(){return"function"==c(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var p=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p.Color,[null].concat(e)))};p.Color=d,p.version="2.4.2";var f=o.unpack,m=Math.max,g=o.unpack,y=o.unpack,v=o.type,_=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=f(e,"rgb"),i=r[0],a=r[1],s=r[2],n=1-m(i/=255,m(a/=255,s/=255)),o=n<1?1/(1-n):0;return[(1-i-n)*o,(1-a-n)*o,(1-s-n)*o,n]};d.prototype.cmyk=function(){return _(this._rgb)},p.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["cmyk"])))},l.format.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=g(e,"cmyk"))[0],i=e[1],a=e[2],s=e[3],n=e.length>4?e[4]:1;return 1===s?[0,0,0,n]:[r>=1?0:255*(1-r)*(1-s),i>=1?0:255*(1-i)*(1-s),a>=1?0:255*(1-a)*(1-s),n]},l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===v(e=y(e,"cmyk"))&&4===e.length)return"cmyk"}});var x=o.unpack,b=o.last,S=function(e){return Math.round(100*e)/100},w=o.unpack,E=function(){for(var e,t,r=[],i=arguments.length;i--;)r[i]=arguments[i];var a=(r=w(r,"rgba"))[0],s=r[1],n=r[2],o=Math.min(a/=255,s/=255,n/=255),l=Math.max(a,s,n),u=(l+o)/2;return(l===o?(e=0,t=Number.NaN):e=u<.5?(l-o)/(l+o):(l-o)/(2-l-o),a==l?t=(s-n)/(l-o):s==l?t=2+(n-a)/(l-o):n==l&&(t=4+(a-s)/(l-o)),(t*=60)<0&&(t+=360),r.length>3&&void 0!==r[3])?[t,e,u,r[3]]:[t,e,u]},A=o.unpack,T=o.last,C=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=x(e,"hsla"),i=b(e)||"lsa";return r[0]=S(r[0]||0),r[1]=S(100*r[1])+"%",r[2]=S(100*r[2])+"%","hsla"===i||r.length>3&&r[3]<1?(r[3]=r.length>3?r[3]:1,i="hsla"):r.length=3,i+"("+r.join(",")+")"},P=Math.round,R=o.unpack,I=Math.round,L=function(){for(var e,t,r,i,a=[],s=arguments.length;s--;)a[s]=arguments[s];var n=(a=R(a,"hsl"))[0],o=a[1],l=a[2];if(0===o)t=r=i=255*l;else{var u=[0,0,0],h=[0,0,0],c=l<.5?l*(1+o):l+o-l*o,d=2*l-c,p=n/360;u[0]=p+1/3,u[1]=p,u[2]=p-1/3;for(var f=0;f<3;f++)u[f]<0&&(u[f]+=1),u[f]>1&&(u[f]-=1),6*u[f]<1?h[f]=d+(c-d)*6*u[f]:2*u[f]<1?h[f]=c:3*u[f]<2?h[f]=d+(c-d)*(2/3-u[f])*6:h[f]=d;t=(e=[I(255*h[0]),I(255*h[1]),I(255*h[2])])[0],r=e[1],i=e[2]}return a.length>3?[t,r,i,a[3]]:[t,r,i,1]},O=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,M=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,k=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,N=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,D=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,F=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,G=Math.round,z=function(e){if(e=e.toLowerCase().trim(),l.format.named)try{return l.format.named(e)}catch(e){}if(t=e.match(O)){for(var t,r=t.slice(1,4),i=0;i<3;i++)r[i]=+r[i];return r[3]=1,r}if(t=e.match(M)){for(var a=t.slice(1,5),s=0;s<4;s++)a[s]=+a[s];return a}if(t=e.match(k)){for(var n=t.slice(1,4),o=0;o<3;o++)n[o]=G(2.55*n[o]);return n[3]=1,n}if(t=e.match(N)){for(var u=t.slice(1,5),h=0;h<3;h++)u[h]=G(2.55*u[h]);return u[3]=+u[3],u}if(t=e.match(D)){var c=t.slice(1,4);c[1]*=.01,c[2]*=.01;var d=L(c);return d[3]=1,d}if(t=e.match(F)){var p=t.slice(1,4);p[1]*=.01,p[2]*=.01;var f=L(p);return f[3]=+t[4],f}};z.test=function(e){return O.test(e)||M.test(e)||k.test(e)||N.test(e)||D.test(e)||F.test(e)};var q=o.type,j=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=A(e,"rgba"),i=T(e)||"rgb";return"hsl"==i.substr(0,3)?C(E(r),i):(r[0]=P(r[0]),r[1]=P(r[1]),r[2]=P(r[2]),("rgba"===i||r.length>3&&r[3]<1)&&(r[3]=r.length>3?r[3]:1,i="rgba"),i+"("+r.slice(0,"rgb"===i?3:4).join(",")+")")};d.prototype.css=function(e){return j(this._rgb,e)},p.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["css"])))},l.format.css=z,l.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===q(e)&&z.test(e))return"css"}});var B=o.unpack;l.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=B(e,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r},p.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["gl"])))},d.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var U=o.unpack,H=o.unpack,Z=Math.floor,V=o.unpack,Y=o.type,W=function(){for(var e,t=[],r=arguments.length;r--;)t[r]=arguments[r];var i=U(t,"rgb"),a=i[0],s=i[1],n=i[2],o=Math.min(a,s,n),l=Math.max(a,s,n),u=l-o;return 0===u?e=Number.NaN:(a===l&&(e=(s-n)/u),s===l&&(e=2+(n-a)/u),n===l&&(e=4+(a-s)/u),(e*=60)<0&&(e+=360)),[e,100*u/255,o/(255-u)*100]};d.prototype.hcg=function(){return W(this._rgb)},p.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hcg"])))},l.format.hcg=function(){for(var e,t,r,i,a,s,n,o,l,u=[],h=arguments.length;h--;)u[h]=arguments[h];var c=(u=H(u,"hcg"))[0],d=u[1],p=u[2];p*=255;var f=255*d;if(0===d)n=o=l=p;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var m=Z(c/=60),g=c-m,y=p*(1-d),v=y+f*(1-g),_=y+f*g,x=y+f;switch(m){case 0:n=(e=[x,_,y])[0],o=e[1],l=e[2];break;case 1:n=(t=[v,x,y])[0],o=t[1],l=t[2];break;case 2:n=(r=[y,x,_])[0],o=r[1],l=r[2];break;case 3:n=(i=[y,v,x])[0],o=i[1],l=i[2];break;case 4:n=(a=[_,y,x])[0],o=a[1],l=a[2];break;case 5:n=(s=[x,y,v])[0],o=s[1],l=s[2]}}return[n,o,l,u.length>3?u[3]:1]},l.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===Y(e=V(e,"hcg"))&&3===e.length)return"hcg"}});var $=o.unpack,X=o.last,K=Math.round,J=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=$(e,"rgba"),i=r[0],a=r[1],s=r[2],n=r[3],o=X(e)||"auto";void 0===n&&(n=1),"auto"===o&&(o=n<1?"rgba":"rgb");var l="000000"+((i=K(i))<<16|(a=K(a))<<8|(s=K(s))).toString(16);l=l.substr(l.length-6);var u="0"+K(255*n).toString(16);switch(u=u.substr(u.length-2),o.toLowerCase()){case"rgba":return"#"+l+u;case"argb":return"#"+u+l;default:return"#"+l}},Q=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,ee=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,et=function(e){if(e.match(Q)){(4===e.length||7===e.length)&&(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(ee)){(5===e.length||9===e.length)&&(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var r=parseInt(e,16),i=Math.round((255&r)/255*100)/100;return[r>>24&255,r>>16&255,r>>8&255,i]}throw Error("unknown hex color: "+e)},er=o.type;d.prototype.hex=function(e){return J(this._rgb,e)},p.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hex"])))},l.format.hex=et,l.autodetect.push({p:4,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===er(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var ei=o.unpack,ea=o.TWOPI,es=Math.min,en=Math.sqrt,eo=Math.acos,el=o.unpack,eu=o.limit,eh=o.TWOPI,ec=o.PITHIRD,ed=Math.cos,ep=o.unpack,ef=o.type,em=function(){for(var e,t=[],r=arguments.length;r--;)t[r]=arguments[r];var i=ei(t,"rgb"),a=i[0],s=i[1],n=i[2],o=es(a/=255,s/=255,n/=255),l=(a+s+n)/3,u=l>0?1-o/l:0;return 0===u?e=NaN:(e=eo(e=(a-s+(a-n))/2/en((a-s)*(a-s)+(a-n)*(s-n))),n>s&&(e=ea-e),e/=ea),[360*e,u,l]};d.prototype.hsi=function(){return em(this._rgb)},p.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hsi"])))},l.format.hsi=function(){for(var e,t,r,i=[],a=arguments.length;a--;)i[a]=arguments[a];var s=(i=el(i,"hsi"))[0],n=i[1],o=i[2];return isNaN(s)&&(s=0),isNaN(n)&&(n=0),s>360&&(s-=360),s<0&&(s+=360),(s/=360)<1/3?t=1-((r=(1-n)/3)+(e=(1+n*ed(eh*s)/ed(ec-eh*s))/3)):s<2/3?(s-=1/3,r=1-((e=(1-n)/3)+(t=(1+n*ed(eh*s)/ed(ec-eh*s))/3))):(s-=2/3,e=1-((t=(1-n)/3)+(r=(1+n*ed(eh*s)/ed(ec-eh*s))/3))),[255*(e=eu(o*e*3)),255*(t=eu(o*t*3)),255*(r=eu(o*r*3)),i.length>3?i[3]:1]},l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===ef(e=ep(e,"hsi"))&&3===e.length)return"hsi"}});var eg=o.unpack,ey=o.type;d.prototype.hsl=function(){return E(this._rgb)},p.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hsl"])))},l.format.hsl=L,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===ey(e=eg(e,"hsl"))&&3===e.length)return"hsl"}});var ev=o.unpack,e_=Math.min,ex=Math.max,eb=o.unpack,eS=Math.floor,ew=o.unpack,eE=o.type,eA=function(){for(var e,t,r=[],i=arguments.length;i--;)r[i]=arguments[i];var a=(r=ev(r,"rgb"))[0],s=r[1],n=r[2],o=e_(a,s,n),l=ex(a,s,n),u=l-o;return 0===l?(e=Number.NaN,t=0):(t=u/l,a===l&&(e=(s-n)/u),s===l&&(e=2+(n-a)/u),n===l&&(e=4+(a-s)/u),(e*=60)<0&&(e+=360)),[e,t,l/255]};d.prototype.hsv=function(){return eA(this._rgb)},p.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hsv"])))},l.format.hsv=function(){for(var e,t,r,i,a,s,n,o,l,u=[],h=arguments.length;h--;)u[h]=arguments[h];var c=(u=eb(u,"hsv"))[0],d=u[1],p=u[2];if(p*=255,0===d)n=o=l=p;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var f=eS(c/=60),m=c-f,g=p*(1-d),y=p*(1-d*m),v=p*(1-d*(1-m));switch(f){case 0:n=(e=[p,v,g])[0],o=e[1],l=e[2];break;case 1:n=(t=[y,p,g])[0],o=t[1],l=t[2];break;case 2:n=(r=[g,p,v])[0],o=r[1],l=r[2];break;case 3:n=(i=[g,y,p])[0],o=i[1],l=i[2];break;case 4:n=(a=[v,g,p])[0],o=a[1],l=a[2];break;case 5:n=(s=[p,g,y])[0],o=s[1],l=s[2]}}return[n,o,l,u.length>3?u[3]:1]},l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===eE(e=ew(e,"hsv"))&&3===e.length)return"hsv"}});var eT={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},eC=o.unpack,eP=Math.pow,eR=function(e){return(e/=255)<=.04045?e/12.92:eP((e+.055)/1.055,2.4)},eI=function(e){return e>eT.t3?eP(e,1/3):e/eT.t2+eT.t0},eL=function(){for(var e,t,r,i=[],a=arguments.length;a--;)i[a]=arguments[a];var s=eC(i,"rgb"),n=(e=s[0],t=s[1],r=s[2],[eI((.4124564*(e=eR(e))+.3575761*(t=eR(t))+.1804375*(r=eR(r)))/eT.Xn),eI((.2126729*e+.7151522*t+.072175*r)/eT.Yn),eI((.0193339*e+.119192*t+.9503041*r)/eT.Zn)]),o=n[0],l=n[1],u=n[2],h=116*l-16;return[h<0?0:h,500*(o-l),200*(l-u)]},eO=o.unpack,eM=Math.pow,ek=function(e){return 255*(e<=.00304?12.92*e:1.055*eM(e,1/2.4)-.055)},eN=function(e){return e>eT.t1?e*e*e:eT.t2*(e-eT.t0)},eD=function(){for(var e,t,r,i=[],a=arguments.length;a--;)i[a]=arguments[a];var s=(i=eO(i,"lab"))[0],n=i[1],o=i[2];return t=(s+16)/116,e=isNaN(n)?t:t+n/500,r=isNaN(o)?t:t-o/200,t=eT.Yn*eN(t),[ek(3.2404542*(e=eT.Xn*eN(e))-1.5371385*t-.4985314*(r=eT.Zn*eN(r))),ek(-.969266*e+1.8760108*t+.041556*r),ek(.0556434*e-.2040259*t+1.0572252*r),i.length>3?i[3]:1]},eF=o.unpack,eG=o.type;d.prototype.lab=function(){return eL(this._rgb)},p.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["lab"])))},l.format.lab=eD,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===eG(e=eF(e,"lab"))&&3===e.length)return"lab"}});var ez=o.unpack,eq=o.RAD2DEG,ej=Math.sqrt,eB=Math.atan2,eU=Math.round,eH=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=ez(e,"lab"),i=r[0],a=r[1],s=r[2],n=ej(a*a+s*s),o=(eB(s,a)*eq+360)%360;return 0===eU(1e4*n)&&(o=Number.NaN),[i,n,o]},eZ=o.unpack,eV=o.unpack,eY=o.DEG2RAD,eW=Math.sin,e$=Math.cos,eX=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=eV(e,"lch"),i=r[0],a=r[1],s=r[2];return isNaN(s)&&(s=0),[i,e$(s*=eY)*a,eW(s)*a]},eK=o.unpack,eJ=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=eX((e=eK(e,"lch"))[0],e[1],e[2]),i=eD(r[0],r[1],r[2]);return[i[0],i[1],i[2],e.length>3?e[3]:1]},eQ=o.unpack,e0=o.unpack,e1=o.type,e2=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=eZ(e,"rgb"),i=eL(r[0],r[1],r[2]);return eH(i[0],i[1],i[2])};d.prototype.lch=function(){return e2(this._rgb)},d.prototype.hcl=function(){return e2(this._rgb).reverse()},p.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["lch"])))},p.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["hcl"])))},l.format.lch=eJ,l.format.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=eQ(e,"hcl").reverse();return eJ.apply(void 0,r)},["lch","hcl"].forEach(function(e){return l.autodetect.push({p:2,test:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if("array"===e1(t=e0(t,e))&&3===t.length)return e}})});var e5={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},e3=o.type;d.prototype.name=function(){for(var e=J(this._rgb,"rgb"),t=0,r=Object.keys(e5);t<r.length;t+=1){var i=r[t];if(e5[i]===e)return i.toLowerCase()}return e},l.format.named=function(e){if(e5[e=e.toLowerCase()])return et(e5[e]);throw Error("unknown color name: "+e)},l.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===e3(e)&&e5[e.toLowerCase()])return"named"}});var e4=o.unpack,e6=o.type,e8=o.type,e7=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=e4(e,"rgb");return(r[0]<<16)+(r[1]<<8)+r[2]};d.prototype.num=function(){return e7(this._rgb)},p.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["num"])))},l.format.num=function(e){if("number"==e6(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw Error("unknown num color: "+e)},l.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===e8(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var e9=o.unpack,te=o.type,tt=Math.round;d.prototype.rgb=function(e){return(void 0===e&&(e=!0),!1===e)?this._rgb.slice(0,3):this._rgb.slice(0,3).map(tt)},d.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map(function(t,r){return r<3?!1===e?t:tt(t):t})},p.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["rgb"])))},l.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=e9(e,"rgba");return void 0===r[3]&&(r[3]=1),r},l.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===te(e=e9(e,"rgba"))&&(3===e.length||4===e.length&&"number"==te(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var tr=Math.log,ti=function(e){var t,r,i,a=e/100;return a<66?(t=255,r=a<6?0:-155.25485562709179-.44596950469579133*(r=a-2)+104.49216199393888*tr(r),i=a<20?0:-254.76935184120902+.8274096064007395*(i=a-10)+115.67994401066147*tr(i)):(t=351.97690566805693+.114206453784165*(t=a-55)-40.25366309332127*tr(t),r=325.4494125711974+.07943456536662342*(r=a-50)-28.0852963507957*tr(r),i=255),[t,r,i,1]},ta=o.unpack,ts=Math.round,tn=function(){for(var e,t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var i=ta(t,"rgb"),a=i[0],s=i[2],n=1e3,o=4e4;o-n>.4;){var l=ti(e=(o+n)*.5);l[2]/l[0]>=s/a?o=e:n=e}return ts(e)};d.prototype.temp=d.prototype.kelvin=d.prototype.temperature=function(){return tn(this._rgb)},p.temp=p.kelvin=p.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["temp"])))},l.format.temp=l.format.kelvin=l.format.temperature=ti;var to=o.unpack,tl=Math.cbrt,tu=Math.pow,th=Math.sign,tc=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=to(e,"rgb"),i=r[0],a=r[1],s=r[2],n=[td(i/255),td(a/255),td(s/255)],o=n[0],l=n[1],u=n[2],h=tl(.4122214708*o+.5363325363*l+.0514459929*u),c=tl(.2119034982*o+.6806995451*l+.1073969566*u),d=tl(.0883024619*o+.2817188376*l+.6299787005*u);return[.2104542553*h+.793617785*c-.0040720468*d,1.9779984951*h-2.428592205*c+.4505937099*d,.0259040371*h+.7827717662*c-.808675766*d]};function td(e){var t=Math.abs(e);return t<.04045?e/12.92:(th(e)||1)*tu((t+.055)/1.055,2.4)}var tp=o.unpack,tf=Math.pow,tm=Math.sign,tg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=tp(e,"lab"))[0],i=e[1],a=e[2],s=tf(r+.3963377774*i+.2158037573*a,3),n=tf(r-.1055613458*i-.0638541728*a,3),o=tf(r-.0894841775*i-1.291485548*a,3);return[255*ty(4.0767416621*s-3.3077115913*n+.2309699292*o),255*ty(-1.2684380046*s+2.6097574011*n-.3413193965*o),255*ty(-.0041960863*s-.7034186147*n+1.707614701*o),e.length>3?e[3]:1]};function ty(e){var t=Math.abs(e);return t>.0031308?(tm(e)||1)*(1.055*tf(t,1/2.4)-.055):12.92*e}var tv=o.unpack,t_=o.type;d.prototype.oklab=function(){return tc(this._rgb)},p.oklab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["oklab"])))},l.format.oklab=tg,l.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===t_(e=tv(e,"oklab"))&&3===e.length)return"oklab"}});var tx=o.unpack,tb=o.unpack,tS=o.unpack,tw=o.type,tE=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=tx(e,"rgb"),i=tc(r[0],r[1],r[2]);return eH(i[0],i[1],i[2])};d.prototype.oklch=function(){return tE(this._rgb)},p.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(d,[null].concat(e,["oklch"])))},l.format.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=eX((e=tb(e,"lch"))[0],e[1],e[2]),i=tg(r[0],r[1],r[2]);return[i[0],i[1],i[2],e.length>3?e[3]:1]},l.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===tw(e=tS(e,"oklch"))&&3===e.length)return"oklch"}});var tA=o.type;d.prototype.alpha=function(e,t){return(void 0===t&&(t=!1),void 0!==e&&"number"===tA(e))?t?(this._rgb[3]=e,this):new d([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},d.prototype.clipped=function(){return this._rgb._clipped||!1},d.prototype.darken=function(e){void 0===e&&(e=1);var t=this.lab();return t[0]-=eT.Kn*e,new d(t,"lab").alpha(this.alpha(),!0)},d.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},d.prototype.darker=d.prototype.darken,d.prototype.brighter=d.prototype.brighten,d.prototype.get=function(e){var t=e.split("."),r=t[0],i=t[1],a=this[r]();if(!i)return a;var s=r.indexOf(i)-("ok"===r.substr(0,2)?2:0);if(s>-1)return a[s];throw Error("unknown channel "+i+" in mode "+r)};var tT=o.type,tC=Math.pow;d.prototype.luminance=function(e){if(void 0!==e&&"number"===tT(e)){if(0===e)return new d([0,0,0,this._rgb[3]],"rgb");if(1===e)return new d([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),r=20,i=function(t,a){var s=t.interpolate(a,.5,"rgb"),n=s.luminance();return!(1e-7>Math.abs(e-n))&&r--?n>e?i(t,s):i(s,a):s},a=(t>e?i(new d([0,0,0]),this):i(this,new d([255,255,255]))).rgb();return new d(a.concat([this._rgb[3]]))}return tP.apply(void 0,this._rgb.slice(0,3))};var tP=function(e,t,r){return .2126*(e=tR(e))+.7152*(t=tR(t))+.0722*(r=tR(r))},tR=function(e){return(e/=255)<=.03928?e/12.92:tC((e+.055)/1.055,2.4)},tI={},tL=o.type,tO=function(e,t,r){void 0===r&&(r=.5);for(var i=[],a=arguments.length-3;a-- >0;)i[a]=arguments[a+3];var s=i[0]||"lrgb";if(tI[s]||i.length||(s=Object.keys(tI)[0]),!tI[s])throw Error("interpolation mode "+s+" is not defined");return"object"!==tL(e)&&(e=new d(e)),"object"!==tL(t)&&(t=new d(t)),tI[s](e,t,r).alpha(e.alpha()+r*(t.alpha()-e.alpha()))};d.prototype.mix=d.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];return tO.apply(void 0,[this,e,t].concat(r))},d.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,r=t[3];return e?(this._rgb=[t[0]*r,t[1]*r,t[2]*r,r],this):new d([t[0]*r,t[1]*r,t[2]*r,r],"rgb")},d.prototype.saturate=function(e){void 0===e&&(e=1);var t=this.lch();return t[1]+=eT.Kn*e,t[1]<0&&(t[1]=0),new d(t,"lch").alpha(this.alpha(),!0)},d.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var tM=o.type;d.prototype.set=function(e,t,r){void 0===r&&(r=!1);var i=e.split("."),a=i[0],s=i[1],n=this[a]();if(!s)return n;var o=a.indexOf(s)-("ok"===a.substr(0,2)?2:0);if(o>-1){if("string"==tM(t))switch(t.charAt(0)){case"+":case"-":n[o]+=+t;break;case"*":n[o]*=+t.substr(1);break;case"/":n[o]/=+t.substr(1);break;default:n[o]=+t}else if("number"===tM(t))n[o]=t;else throw Error("unsupported value for Color.set");var l=new d(n,a);return r?(this._rgb=l._rgb,this):l}throw Error("unknown channel "+s+" in mode "+a)},tI.rgb=function(e,t,r){var i=e._rgb,a=t._rgb;return new d(i[0]+r*(a[0]-i[0]),i[1]+r*(a[1]-i[1]),i[2]+r*(a[2]-i[2]),"rgb")};var tk=Math.sqrt,tN=Math.pow;tI.lrgb=function(e,t,r){var i=e._rgb,a=i[0],s=i[1],n=i[2],o=t._rgb,l=o[0],u=o[1],h=o[2];return new d(tk(tN(a,2)*(1-r)+tN(l,2)*r),tk(tN(s,2)*(1-r)+tN(u,2)*r),tk(tN(n,2)*(1-r)+tN(h,2)*r),"rgb")},tI.lab=function(e,t,r){var i=e.lab(),a=t.lab();return new d(i[0]+r*(a[0]-i[0]),i[1]+r*(a[1]-i[1]),i[2]+r*(a[2]-i[2]),"lab")};var tD=function(e,t,r,i){var a,s,n,o,l,u,h,c,p,f,m,g,y,v;return"hsl"===i?(n=e.hsl(),o=t.hsl()):"hsv"===i?(n=e.hsv(),o=t.hsv()):"hcg"===i?(n=e.hcg(),o=t.hcg()):"hsi"===i?(n=e.hsi(),o=t.hsi()):"lch"===i||"hcl"===i?(i="hcl",n=e.hcl(),o=t.hcl()):"oklch"===i&&(n=e.oklch().reverse(),o=t.oklch().reverse()),("h"===i.substr(0,1)||"oklch"===i)&&(l=(a=n)[0],h=a[1],p=a[2],u=(s=o)[0],c=s[1],f=s[2]),isNaN(l)||isNaN(u)?isNaN(l)?isNaN(u)?g=Number.NaN:(g=u,(1==p||0==p)&&"hsv"!=i&&(m=c)):(g=l,(1==f||0==f)&&"hsv"!=i&&(m=h)):(v=u>l&&u-l>180?u-(l+360):u<l&&l-u>180?u+360-l:u-l,g=l+r*v),void 0===m&&(m=h+r*(c-h)),y=p+r*(f-p),"oklch"===i?new d([y,m,g],i):new d([g,m,y],i)},tF=function(e,t,r){return tD(e,t,r,"lch")};tI.lch=tF,tI.hcl=tF,tI.num=function(e,t,r){var i=e.num();return new d(i+r*(t.num()-i),"num")},tI.hcg=function(e,t,r){return tD(e,t,r,"hcg")},tI.hsi=function(e,t,r){return tD(e,t,r,"hsi")},tI.hsl=function(e,t,r){return tD(e,t,r,"hsl")},tI.hsv=function(e,t,r){return tD(e,t,r,"hsv")},tI.oklab=function(e,t,r){var i=e.oklab(),a=t.oklab();return new d(i[0]+r*(a[0]-i[0]),i[1]+r*(a[1]-i[1]),i[2]+r*(a[2]-i[2]),"oklab")},tI.oklch=function(e,t,r){return tD(e,t,r,"oklch")};var tG=o.clip_rgb,tz=Math.pow,tq=Math.sqrt,tj=Math.PI,tB=Math.cos,tU=Math.sin,tH=Math.atan2,tZ=function(e,t){for(var r=e.length,i=[0,0,0,0],a=0;a<e.length;a++){var s=e[a],n=t[a]/r,o=s._rgb;i[0]+=tz(o[0],2)*n,i[1]+=tz(o[1],2)*n,i[2]+=tz(o[2],2)*n,i[3]+=o[3]*n}return i[0]=tq(i[0]),i[1]=tq(i[1]),i[2]=tq(i[2]),i[3]>.9999999&&(i[3]=1),new d(tG(i))},tV=o.type,tY=Math.pow,tW=function(e){var t="rgb",r=p("#ccc"),i=0,a=[0,1],s=[],n=[0,0],o=!1,l=[],u=!1,h=0,c=1,d=!1,f={},m=!0,g=1,y=function(e){if("string"===tV(e=e||["#fff","#000"])&&p.brewer&&p.brewer[e.toLowerCase()]&&(e=p.brewer[e.toLowerCase()]),"array"===tV(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=p(e[t]);s.length=0;for(var r=0;r<e.length;r++)s.push(r/(e.length-1))}return S(),l=e},v=function(e){if(null!=o){for(var t=o.length-1,r=0;r<t&&e>=o[r];)r++;return r-1}return 0},_=function(e){return e},x=function(e){return e},b=function(e,i){if(null==i&&(i=!1),isNaN(e)||null===e)return r;if(i)u=e;else if(o&&o.length>2){var a,u;u=v(e)/(o.length-2)}else u=c!==h?(e-h)/(c-h):1;u=x(u),i||(u=_(u)),1!==g&&(u=tY(u,g));var d=Math.floor(1e4*(u=Math.min(1,Math.max(0,u=n[0]+u*(1-n[0]-n[1])))));if(m&&f[d])a=f[d];else{if("array"===tV(l))for(var y=0;y<s.length;y++){var b=s[y];if(u<=b||u>=b&&y===s.length-1){a=l[y];break}if(u>b&&u<s[y+1]){u=(u-b)/(s[y+1]-b),a=p.interpolate(l[y],l[y+1],u,t);break}}else"function"===tV(l)&&(a=l(u));m&&(f[d]=a)}return a},S=function(){return f={}};y(e);var w=function(e){var t=p(b(e));return u&&t[u]?t[u]():t};return w.classes=function(e){if(null!=e){if("array"===tV(e))o=e,a=[e[0],e[e.length-1]];else{var t=p.analyze(a);o=0===e?[t.min,t.max]:p.limits(t,"e",e)}return w}return o},w.domain=function(e){if(!arguments.length)return a;h=e[0],c=e[e.length-1],s=[];var t=l.length;if(e.length===t&&h!==c)for(var r=0,i=Array.from(e);r<i.length;r+=1){var n=i[r];s.push((n-h)/(c-h))}else{for(var o=0;o<t;o++)s.push(o/(t-1));if(e.length>2){var u=e.map(function(t,r){return r/(e.length-1)}),d=e.map(function(e){return(e-h)/(c-h)});d.every(function(e,t){return u[t]===e})||(x=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=d[t+1];)t++;var r=(e-d[t])/(d[t+1]-d[t]);return u[t]+r*(u[t+1]-u[t])})}}return a=[h,c],w},w.mode=function(e){return arguments.length?(t=e,S(),w):t},w.range=function(e,t){return y(e),w},w.out=function(e){return u=e,w},w.spread=function(e){return arguments.length?(i=e,w):i},w.correctLightness=function(e){return null==e&&(e=!0),d=e,S(),_=d?function(e){for(var t=b(0,!0).lab()[0],r=b(1,!0).lab()[0],i=t>r,a=b(e,!0).lab()[0],s=t+(r-t)*e,n=a-s,o=0,l=1,u=20;Math.abs(n)>.01&&u-- >0;)i&&(n*=-1),n<0?(o=e,e+=(l-e)*.5):(l=e,e+=(o-e)*.5),n=(a=b(e,!0).lab()[0])-s;return e}:function(e){return e},w},w.padding=function(e){return null!=e?("number"===tV(e)&&(e=[e,e]),n=e,w):n},w.colors=function(t,r){arguments.length<2&&(r="hex");var i=[];if(0==arguments.length)i=l.slice(0);else if(1===t)i=[w(.5)];else if(t>1){var s=a[0],n=a[1]-s;i=(function(e,t,r){for(var i=[],a=e<t,s=r?a?t+1:t-1:t,n=e;a?n<s:n>s;a?n++:n--)i.push(n);return i})(0,t,!1).map(function(e){return w(s+e/(t-1)*n)})}else{e=[];var u=[];if(o&&o.length>2)for(var h=1,c=o.length,d=1<=c;d?h<c:h>c;d?h++:h--)u.push((o[h-1]+o[h])*.5);else u=a;i=u.map(function(e){return w(e)})}return p[r]&&(i=i.map(function(e){return e[r]()})),i},w.cache=function(e){return null!=e?(m=e,w):m},w.gamma=function(e){return null!=e?(g=e,w):g},w.nodata=function(e){return null!=e?(r=p(e),w):r},w},t$=function(e){for(var t=[1,1],r=1;r<e;r++){for(var i=[1],a=1;a<=t.length;a++)i[a]=(t[a]||0)+t[a-1];t=i}return t},tX=function(e){var t,r,i,a,s,n,o,l,u,h,c;if(2===(e=e.map(function(e){return new d(e)})).length)s=(t=e.map(function(e){return e.lab()}))[0],n=t[1],a=function(e){return new d([0,1,2].map(function(t){return s[t]+e*(n[t]-s[t])}),"lab")};else if(3===e.length)s=(r=e.map(function(e){return e.lab()}))[0],n=r[1],o=r[2],a=function(e){return new d([0,1,2].map(function(t){return(1-e)*(1-e)*s[t]+2*(1-e)*e*n[t]+e*e*o[t]}),"lab")};else if(4===e.length)s=(i=e.map(function(e){return e.lab()}))[0],n=i[1],o=i[2],l=i[3],a=function(e){return new d([0,1,2].map(function(t){return(1-e)*(1-e)*(1-e)*s[t]+3*(1-e)*(1-e)*e*n[t]+3*(1-e)*e*e*o[t]+e*e*e*l[t]}),"lab")};else if(e.length>=5)u=e.map(function(e){return e.lab()}),h=t$(c=e.length-1),a=function(e){var t=1-e;return new d([0,1,2].map(function(r){return u.reduce(function(i,a,s){return i+h[s]*Math.pow(t,c-s)*Math.pow(e,s)*a[r]},0)}),"lab")};else throw RangeError("No point in running bezier with only one color.");return a},tK=function(e,t,r){if(!tK[r])throw Error("unknown blend mode "+r);return tK[r](e,t)},tJ=function(e){return function(t,r){var i=p(r).rgb(),a=p(t).rgb();return p.rgb(e(i,a))}},tQ=function(e){return function(t,r){var i=[];return i[0]=e(t[0],r[0]),i[1]=e(t[1],r[1]),i[2]=e(t[2],r[2]),i}};tK.normal=tJ(tQ(function(e){return e})),tK.multiply=tJ(tQ(function(e,t){return e*t/255})),tK.screen=tJ(tQ(function(e,t){return 255*(1-(1-e/255)*(1-t/255))})),tK.overlay=tJ(tQ(function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))})),tK.darken=tJ(tQ(function(e,t){return e>t?t:e})),tK.lighten=tJ(tQ(function(e,t){return e>t?e:t})),tK.dodge=tJ(tQ(function(e,t){return 255===e?255:(e=t/255*255/(1-e/255))>255?255:e})),tK.burn=tJ(tQ(function(e,t){return 255*(1-(1-t/255)/(e/255))}));for(var t0=o.type,t1=o.clip_rgb,t2=o.TWOPI,t5=Math.pow,t3=Math.sin,t4=Math.cos,t6=Math.floor,t8=Math.random,t7=Math.log,t9=Math.pow,re=Math.floor,rt=Math.abs,rr=function(e,t){void 0===t&&(t=null);var r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===s(e)&&(e=Object.values(e)),e.forEach(function(e){t&&"object"===s(e)&&(e=e[t]),null==e||isNaN(e)||(r.values.push(e),r.sum+=e,e<r.min&&(r.min=e),e>r.max&&(r.max=e),r.count+=1)}),r.domain=[r.min,r.max],r.limits=function(e,t){return ri(r,e,t)},r},ri=function(e,t,r){void 0===t&&(t="equal"),void 0===r&&(r=7),"array"==s(e)&&(e=rr(e));var i=e.min,a=e.max,n=e.values.sort(function(e,t){return e-t});if(1===r)return[i,a];var o=[];if("c"===t.substr(0,1)&&(o.push(i),o.push(a)),"e"===t.substr(0,1)){o.push(i);for(var l=1;l<r;l++)o.push(i+l/r*(a-i));o.push(a)}else if("l"===t.substr(0,1)){if(i<=0)throw Error("Logarithmic scales are only possible for values > 0");var u=Math.LOG10E*t7(i),h=Math.LOG10E*t7(a);o.push(i);for(var c=1;c<r;c++)o.push(t9(10,u+c/r*(h-u)));o.push(a)}else if("q"===t.substr(0,1)){o.push(i);for(var d=1;d<r;d++){var p=(n.length-1)*d/r,f=re(p);if(f===p)o.push(n[f]);else{var m=p-f;o.push(n[f]*(1-m)+n[f+1]*m)}}o.push(a)}else if("k"===t.substr(0,1)){var g,y=n.length,v=Array(y),_=Array(r),x=!0,b=0,S=null;(S=[]).push(i);for(var w=1;w<r;w++)S.push(i+w/r*(a-i));for(S.push(a);x;){for(var E=0;E<r;E++)_[E]=0;for(var A=0;A<y;A++)for(var T=n[A],C=Number.MAX_VALUE,P=void 0,R=0;R<r;R++){var I=rt(S[R]-T);I<C&&(C=I,P=R),_[P]++,v[A]=P}for(var L=Array(r),O=0;O<r;O++)L[O]=null;for(var M=0;M<y;M++)null===L[g=v[M]]?L[g]=n[M]:L[g]+=n[M];for(var k=0;k<r;k++)L[k]*=1/_[k];x=!1;for(var N=0;N<r;N++)if(L[N]!==S[N]){x=!0;break}S=L,++b>200&&(x=!1)}for(var D={},F=0;F<r;F++)D[F]=[];for(var G=0;G<y;G++)D[g=v[G]].push(n[G]);for(var z=[],q=0;q<r;q++)z.push(D[q][0]),z.push(D[q][D[q].length-1]);z=z.sort(function(e,t){return e-t}),o.push(z[0]);for(var j=1;j<z.length;j+=2){var B=z[j];isNaN(B)||-1!==o.indexOf(B)||o.push(B)}}return o},ra={analyze:rr,limits:ri},rs=Math.sqrt,rn=Math.pow,ro=Math.min,rl=Math.max,ru=Math.atan2,rh=Math.abs,rc=Math.cos,rd=Math.sin,rp=Math.exp,rf=Math.PI,rm={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},rg=0,ry=Object.keys(rm);rg<ry.length;rg+=1){var rv=ry[rg];rm[rv.toLowerCase()]=rm[rv]}return p.average=function(e,t,r){void 0===t&&(t="lrgb"),void 0===r&&(r=null);var i=e.length;r||(r=Array.from(Array(i)).map(function(){return 1}));var a=i/r.reduce(function(e,t){return e+t});if(r.forEach(function(e,t){r[t]*=a}),e=e.map(function(e){return new d(e)}),"lrgb"===t)return tZ(e,r);for(var s=e.shift(),n=s.get(t),o=[],l=0,u=0,h=0;h<n.length;h++)if(n[h]=(n[h]||0)*r[0],o.push(isNaN(n[h])?0:r[0]),"h"===t.charAt(h)&&!isNaN(n[h])){var c=n[h]/180*tj;l+=tB(c)*r[0],u+=tU(c)*r[0]}var p=s.alpha()*r[0];e.forEach(function(e,i){var a=e.get(t);p+=e.alpha()*r[i+1];for(var s=0;s<n.length;s++)if(!isNaN(a[s])){if(o[s]+=r[i+1],"h"===t.charAt(s)){var h=a[s]/180*tj;l+=tB(h)*r[i+1],u+=tU(h)*r[i+1]}else n[s]+=a[s]*r[i+1]}});for(var f=0;f<n.length;f++)if("h"===t.charAt(f)){for(var m=tH(u/o[f],l/o[f])/tj*180;m<0;)m+=360;for(;m>=360;)m-=360;n[f]=m}else n[f]=n[f]/o[f];return p/=i,new d(n,t).alpha(p>.99999?1:p,!0)},p.bezier=function(e){var t=tX(e);return t.scale=function(){return tW(t)},t},p.blend=tK,p.cubehelix=function(e,t,r,i,a){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===r&&(r=1),void 0===i&&(i=1),void 0===a&&(a=[0,1]);var s,n=0;"array"===t0(a)?s=a[1]-a[0]:(s=0,a=[a,a]);var o=function(o){var l=t2*((e+120)/360+t*o),u=t5(a[0]+s*o,i),h=(0!==n?r[0]+o*n:r)*u*(1-u)/2,c=t4(l),d=t3(l);return p(t1([255*(u+h*(-.14861*c+1.78277*d)),255*(u+h*(-.29227*c-.90649*d)),255*(u+1.97294*c*h),1]))};return o.start=function(t){return null==t?e:(e=t,o)},o.rotations=function(e){return null==e?t:(t=e,o)},o.gamma=function(e){return null==e?i:(i=e,o)},o.hue=function(e){return null==e?r:("array"===t0(r=e)?0==(n=r[1]-r[0])&&(r=r[1]):n=0,o)},o.lightness=function(e){return null==e?a:("array"===t0(e)?(a=e,s=e[1]-e[0]):(a=[e,e],s=0),o)},o.scale=function(){return p.scale(o)},o.hue(r),o},p.mix=p.interpolate=tO,p.random=function(){for(var e="#",t=0;t<6;t++)e+="0123456789abcdef".charAt(t6(16*t8()));return new d(e,"hex")},p.scale=tW,p.analyze=ra.analyze,p.contrast=function(e,t){e=new d(e),t=new d(t);var r=e.luminance(),i=t.luminance();return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)},p.deltaE=function(e,t,r,i,a){void 0===r&&(r=1),void 0===i&&(i=1),void 0===a&&(a=1);var s=function(e){return 360*e/(2*rf)},n=function(e){return 2*rf*e/360};e=new d(e),t=new d(t);var o=Array.from(e.lab()),l=o[0],u=o[1],h=o[2],c=Array.from(t.lab()),p=c[0],f=c[1],m=c[2],g=(l+p)/2,y=(rs(rn(u,2)+rn(h,2))+rs(rn(f,2)+rn(m,2)))/2,v=.5*(1-rs(rn(y,7)/(rn(y,7)+rn(25,7)))),_=u*(1+v),x=f*(1+v),b=rs(rn(_,2)+rn(h,2)),S=rs(rn(x,2)+rn(m,2)),w=(b+S)/2,E=s(ru(h,_)),A=s(ru(m,x)),T=E>=0?E:E+360,C=A>=0?A:A+360,P=rh(T-C)>180?(T+C+360)/2:(T+C)/2,R=1-.17*rc(n(P-30))+.24*rc(n(2*P))+.32*rc(n(3*P+6))-.2*rc(n(4*P-63)),I=C-T;I=180>=rh(I)?I:C<=T?I+360:I-360,I=2*rs(b*S)*rd(n(I)/2);var L=S-b,O=1+.015*rn(g-50,2)/rs(20+rn(g-50,2)),M=1+.045*w,k=1+.015*w*R,N=30*rp(-rn((P-275)/25,2)),D=-(2*rs(rn(w,7)/(rn(w,7)+rn(25,7))))*rd(2*n(N));return rl(0,ro(100,rs(rn((p-l)/(r*O),2)+rn(L/(i*M),2)+rn(I/(a*k),2)+L/(i*M)*D*(I/(a*k)))))},p.distance=function(e,t,r){void 0===r&&(r="lab"),e=new d(e),t=new d(t);var i=e.get(r),a=t.get(r),s=0;for(var n in i){var o=(i[n]||0)-(a[n]||0);s+=o*o}return Math.sqrt(s)},p.limits=ra.limits,p.valid=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(d,[null].concat(e))),!0}catch(e){return!1}},p.scales={cool:function(){return tW([p.hsl(180,1,.9),p.hsl(250,.7,.4)])},hot:function(){return tW(["#000","#f00","#ff0","#fff"]).mode("rgb")}},p.colors=e5,p.brewer=rm,p}()}),n("boqwt",function(e,r){t(e.exports,"default",()=>u);var i=s("h6Aha"),a=s("lqNjm"),n=s("d5AAH"),o=s("2zf1Y"),l=class extends i.default{constructor(e){(e=e||{}).displacement||(e.displacement=[e.offsetX||0,-e.offsetY||0]);var t="anchored"===e.kind?8:0,r=Number(e.shadow)||0;e.stroke||(e.stroke=new n.default({width:0,color:"#000"}));var a=e.stroke.getWidth();if(a<0&&(a=0),"folio"==e.kind&&(a+=6),e.stroke.setWidth(a),super({radius:e.radius+a+t/2+r/2,points:0,displacement:[e.displacement[0]||0,(e.displacement[1]||0)+t],fill:i.default.prototype.render?new o.default({color:[0,0,0,0]}):null,declutterMode:e.declutterMode}),this.sanchor_=t,this._shadow=r,!this.getHitDetectionImage){var s=super.getImage.call(this);if(!this.hitDetectionCanvas_){for(var l in this)if(this[l]&&this[l].getContext&&this[l]!==s){this.hitDetectionCanvas_=this[l];break}}this.hitDetectionCanvas_=document.createElement("canvas"),this.hitDetectionCanvas_.width=s.width,this.hitDetectionCanvas_.height=s.height;var u=this.hitDetectionCanvas_;this.getHitDetectionImage=function(){return u}}this._stroke=e.stroke,this._fill=e.fill,this._crop=e.crop,this._crossOrigin=e.crossOrigin,this._kind=e.kind||"default",this._radius=e.radius,this._src=e.src,this._offset=[e.offsetX?e.offsetX:0,e.offsetY?e.offsetY:0],this._onload=e.onload,this._onerror=e.onerror,"number"==typeof e.opacity&&this.setOpacity(e.opacity),"number"==typeof e.rotation&&this.setRotation(e.rotation),this.render(),this.getImage()}setOffset(e){this._offset=[e[0]||0,e[1]||0],this.render(),this.getImage()}clone(){var e=new l({stroke:this._stroke,fill:this._fill,shadow:this._shadow,crop:this._crop,crossOrigin:this._crossOrigin,kind:this._kind,radius:this._radius,src:this._src,offsetX:this._offset[0],offsetY:this._offset[1],opacity:this.getOpacity(),rotation:this.getRotation(),declutterMode:this.getDeclutterMode?this.getDeclutterMode():null});return e.render(),e.getImage(),e}drawBack_(e,t,r,i){var a=this._shadow,s=e.canvas;e.beginPath(),e.fillStyle=t,e.clearRect(0,0,s.width,s.height);var n=s.width/i,o=s.height/i;switch(this._kind){case"square":e.rect(0,0,n-a,o-a);break;case"circle":e.arc(this._radius+r,this._radius+r,this._radius+r,0,2*Math.PI,!1);break;case"folio":r-=6,e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=1;var l=n-a-12,u=Math.atan(6/l);e.save(),e.rotate(-u),e.translate(-6,2),e.beginPath(),e.rect(6,6,l,l),e.stroke(),e.fill(),e.restore(),e.save(),e.translate(6,-1),e.rotate(u),e.beginPath(),e.rect(6,6,l,l),e.stroke(),e.fill(),e.restore(),e.beginPath(),e.rect(6,6,l,l),e.stroke();break;case"anchored":e.roundRect(this.sanchor_/2,0,n-this.sanchor_-a,o-this.sanchor_-a,r),e.moveTo(n/2-this.sanchor_-a/2,o-this.sanchor_-a),e.lineTo(n/2+this.sanchor_-a/2,o-this.sanchor_-a),e.lineTo(n/2-a/2,o-a);break;default:e.roundRect(0,0,n-a,o-a,r)}e.closePath()}createRenderOptions(){var e=super.createRenderOptions();return e.photoOptions=["photo",this._crossOrigin,this._crop,this._src,this._shadow,this._kind].join("-"),e}getImage(e){e=e||window.devicePixelRatio;var t,r=super.getImage(e);if((this._gethit||this.img_)&&this._currentRatio===e)return r;this._currentRatio=e;var i=0;this._stroke&&(t=(0,a.asString)(this._stroke.getColor()),i=this._stroke.getWidth()),this._gethit=!0;var s=this.getHitDetectionImage().getContext("2d");s.save(),s.setTransform(1,0,0,1,0,0),this.drawBack_(s,"#000",i,1),s.fill(),s.restore(),this._gethit=!1,(s=r.getContext("2d")).save(),s.setTransform(e,0,0,e,0,0),this.drawBack_(s,t,i,e),this._shadow&&(s.shadowColor="rgba(0,0,0,0.5)",s.shadowBlur=e*this._shadow/2,s.shadowOffsetX=e*this._shadow/2,s.shadowOffsetY=e*this._shadow/2),s.fill(),s.restore();var n=this,o=this.img_=new Image;if(this._crossOrigin&&(o.crossOrigin=this._crossOrigin),o.src=this._src,o.width?n.drawImage_(r,o,e):(o.onload=function(){n.drawImage_(r,o,e),n._onload&&n._onload()},n._onerror&&(o.onerror=function(){n._onerror()})),!this.getDisplacement){var l=this.getAnchor();l[0]=(r.width/e-this._shadow)/2-this._offset[0],this.sanchor_?l[1]=r.height/e-this._shadow-this._offset[1]:l[1]=(r.height/e-this._shadow)/2-this._offset[1]}return r}getPhoto(){return this.img_}drawImage_(e,t,r){var s,n,o,l,u,h,c,d,p,f=e.getContext("2d"),m=0;this._stroke&&(m=this._stroke.getWidth());var g=2*this._radius;f.save(),i.default.prototype.render&&f.setTransform(r,0,0,r,0,0),"circle"==this._kind&&(f.beginPath(),f.arc(this._radius+m,this._radius+m,this._radius,0,2*Math.PI,!1),f.clip()),this._crop?(d=p=(s=Math.min(t.width/g,t.height/g))*g,h=(t.width-d)/2,c=(t.height-p)/2,n=o=0,l=u=g+1):(s=Math.min(g/t.width,g/t.height),h=c=0,d=t.width,p=t.height,l=s*d,u=s*p,n=(g-l)/2,o=(g-u)/2),n+=m+this.sanchor_/2,o+=m,f.drawImage(t,h,c,d,p,n,o,l,u),"circle"==this._kind&&m&&(f.beginPath(),f.strokeStyle=(0,a.asString)(this._stroke.getColor()),f.lineWidth=m/4,f.arc(this._radius+m,this._radius+m,this._radius,0,2*Math.PI,!1),f.stroke()),f.restore()}};CanvasRenderingContext2D.prototype.roundRect=function(e,t,r,i,a){return a?(r<2*a&&(a=r/2),i<2*a&&(a=i/2),this.beginPath(),this.moveTo(e+a,t),this.arcTo(e+r,t,e+r,t+i,a),this.arcTo(e+r,t+i,e,t+i,a),this.arcTo(e,t+i,e,t,a),this.arcTo(e,t,e+r,t,a),this.closePath()):this.rect(e,t,r,i),this};var u=l}),n("3yg5q",function(e,r){t(e.exports,"default",()=>l);var i=s("lW8xZ"),a=s("2zf1Y"),n=s("lqNjm"),o=class extends a.default{constructor(e){super(),e=e||{};var t=this.canvas_=document.createElement("canvas"),r=(Number(e.scale)>0?Number(e.scale):1)*i.DEVICE_PIXEL_RATIO||i.DEVICE_PIXEL_RATIO,a=t.getContext("2d");if(e.image){e.image.load();var s,o,l=e.image.getImage();if(l.width)t.width=Math.round(l.width*r),t.height=Math.round(l.height*r),a.globalAlpha="number"==typeof e.opacity?e.opacity:1,a.drawImage(l,0,0,l.width,l.height,0,0,t.width,t.height),s=a.createPattern(t,"repeat");else{var u=this;s=[0,0,0,0],l.onload=function(){t.width=Math.round(l.width*r),t.height=Math.round(l.height*r),a.globalAlpha="number"==typeof e.opacity?e.opacity:1,a.drawImage(l,0,0,l.width,l.height,0,0,t.width,t.height),s=a.createPattern(t,"repeat"),u.setColor(s)}}}else{var h=this.getPattern_(e);if(t.width=Math.round(h.width*r),t.height=Math.round(h.height*r),a.beginPath(),e.fill&&(a.fillStyle=(0,n.asString)(e.fill.getColor()),a.fillRect(0,0,t.width,t.height)),a.scale(r,r),a.lineCap="round",a.lineWidth=h.stroke||1,a.fillStyle=(0,n.asString)(e.color||"#000"),a.strokeStyle=(0,n.asString)(e.color||"#000"),h.circles)for(o=0;o<h.circles.length;o++){var c=h.circles[o];a.beginPath(),a.arc(c[0],c[1],c[2],0,2*Math.PI),h.fill&&a.fill(),h.stroke&&a.stroke()}if(h.repeat||(h.repeat=[[0,0]]),h.char&&(a.font=h.font||h.width+"px Arial",a.textAlign="center",a.textBaseline="middle",h.angle?(a.fillText(h.char,h.width/4,h.height/4),a.fillText(h.char,5*h.width/4,5*h.height/4),a.fillText(h.char,h.width/4,5*h.height/4),a.fillText(h.char,5*h.width/4,h.height/4),a.fillText(h.char,3*h.width/4,3*h.height/4),a.fillText(h.char,-h.width/4,-h.height/4),a.fillText(h.char,3*h.width/4,-h.height/4),a.fillText(h.char,-h.width/4,3*h.height/4)):a.fillText(h.char,h.width/2,h.height/2)),h.lines)for(o=0;o<h.lines.length;o++)for(var d=0;d<h.repeat.length;d++){var p=h.lines[o];a.beginPath(),a.moveTo(p[0]+h.repeat[d][0],p[1]+h.repeat[d][1]);for(var f=2;f<p.length;f+=2)a.lineTo(p[f]+h.repeat[d][0],p[f+1]+h.repeat[d][1]);h.fill&&a.fill(),h.stroke&&a.stroke(),a.save(),a.strokeStyle="red",a.strokeWidth=.1,a.restore()}if(s=a.createPattern(t,"repeat"),e.offset){var m=e.offset;if("number"==typeof m&&(m=[m,m]),m instanceof Array){var g=Math.round(m[0]*r),y=Math.round(m[1]*r);a.scale(1/r,1/r),a.clearRect(0,0,t.width,t.height),a.translate(g,y),a.fillStyle=s,a.fillRect(-g,-y,t.width,t.height),s=a.createPattern(t,"repeat")}}}this.setColor(s)}static addPattern(e,t){t||(t={}),o.patterns[e||t.char]={width:t.width||t.size||10,height:t.height||t.size||10,font:t.font,char:t.char,circles:t.circles,lines:t.lines,repeat:t.repeat,stroke:t.stroke,angle:t.angle,fill:t.fill}}clone(){var e=super.clone();return e.canvas_=this.canvas_,e}getImage(){return this.canvas_}getPattern_(e){var t,r=o.patterns[e.pattern]||o.patterns.dot,i=Math.round(e.spacing)||10;switch(e.pattern){case"dot":case"circle":t=0===e.size?0:e.size/2||2,e.angle?(i=r.width=r.height=Math.round(1.4*i),r.circles=[[i/4,i/4,t],[3*i/4,3*i/4,t]],"circle"==e.pattern&&(r.circles=r.circles.concat([[i/4+i,i/4,t],[i/4,i/4+i,t],[3*i/4-i,3*i/4,t],[3*i/4,3*i/4-i,t],[i/4+i,i/4+i,t],[3*i/4-i,3*i/4-i,t]]))):(r.width=r.height=i,r.circles=[[i/2,i/2,t]],"circle"==e.pattern&&(r.circles=r.circles.concat([[i/2+i,i/2,t],[i/2-i,i/2,t],[i/2,i/2+i,t],[i/2,i/2-i,t],[i/2+i,i/2+i,t],[i/2+i,i/2-i,t],[i/2-i,i/2+i,t],[i/2-i,i/2-i,t]])));break;case"tile":case"square":t=0===e.size?0:e.size/2||2,e.angle?(r.width=r.height=i,r.lines=[[i/2-t,i/2,i/2,i/2-t,i/2+t,i/2,i/2,i/2+t,i/2-t,i/2]]):(r.width=r.height=i,r.lines=[[i/2-t,i/2-t,i/2+t,i/2-t,i/2+t,i/2+t,i/2-t,i/2+t,i/2-t,i/2-t]]),"square"==e.pattern&&(r.repeat=[[0,0],[0,i],[i,0],[0,-i],[-i,0],[-i,-i],[i,i],[-i,i],[i,-i]]);break;case"cross":e.angle&&(e.angle=45);case"hatch":var a=Math.round(((e.angle||0)-90)%360);a>180&&(a-=360);var s=Math.cos(a*=Math.PI/180),n=Math.sin(a);if(1e-4>Math.abs(n))r.width=r.height=i,r.lines=[[0,.5,i,.5]],r.repeat=[[0,0],[0,i]];else if(1e-4>Math.abs(s))r.width=r.height=i,r.lines=[[.5,0,.5,i]],r.repeat=[[0,0],[i,0]],"cross"==e.pattern&&(r.lines.push([0,.5,i,.5]),r.repeat.push([0,i]));else{var l=r.width=Math.round(Math.abs(i/n))||1,u=r.height=Math.round(Math.abs(i/s))||1;"cross"==e.pattern?(r.lines=[[-l,-u,2*l,2*u],[2*l,-u,-l,2*u]],r.repeat=[[0,0]]):s*n>0?(r.lines=[[-l,-u,2*l,2*u]],r.repeat=[[0,0],[l,0],[0,u]]):(r.lines=[[2*l,-u,-l,2*u]],r.repeat=[[0,0],[-l,0],[0,u]])}r.stroke=0===e.size?0:e.size||4}return r}};o.patterns={hatch:{width:5,height:5,lines:[[0,2.5,5,2.5]],stroke:1},cross:{width:7,height:7,lines:[[0,3,10,3],[3,0,3,10]],stroke:1},dot:{width:8,height:8,circles:[[5,5,2]],stroke:!1,fill:!0},circle:{width:10,height:10,circles:[[5,5,2]],stroke:1,fill:!1},square:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],stroke:1,fill:!1},tile:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],fill:!0},woven:{width:12,height:12,lines:[[3,3,9,9],[0,12,3,9],[9,3,12,0],[-1,1,1,-1],[13,11,11,13]],stroke:1},crosses:{width:8,height:8,lines:[[2,2,6,6],[2,6,6,2]],stroke:1},caps:{width:8,height:8,lines:[[2,6,4,2,6,6]],stroke:1},nylon:{width:20,height:20,lines:[[1,6,1,1,6,1],[6,11,11,11,11,6],[11,16,11,21,16,21],[16,11,21,11,21,16]],repeat:[[0,0],[-20,0],[0,-20]],stroke:1},hexagon:{width:20,height:12,lines:[[0,10,4,4,10,4,14,10,10,16,4,16,0,10]],stroke:1,repeat:[[0,0],[10,6],[10,-6],[-10,-6]]},cemetry:{width:15,height:19,lines:[[0,3.5,7,3.5],[3.5,0,3.5,10]],stroke:1,repeat:[[0,0],[7,9]]},sand:{width:20,height:20,circles:[[1,2,1],[9,3,1],[2,16,1],[7,8,1],[6,14,1],[4,19,1],[14,2,1],[12,10,1],[14,18,1],[18,8,1],[18,14,1]],fill:1},conglomerate:{width:60,height:40,circles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],lines:[[7,5,6,7,9,9,11,8,11,6,9,5,7,5],[16,10,15,13,16,14,19,15,21,13,22,9,20,8,19,8,16,10],[24,6,26,7,27,5,26,4,24,4,24,6]],repeat:[[30,0],[-15,20],[15,20],[45,20]],stroke:1},conglomerate2:{width:60,height:40,circles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],lines:[[7,5,6,7,9,9,11,8,11,6,9,5,7,5],[16,10,15,13,16,14,19,15,21,13,22,9,20,8,19,8,16,10],[24,6,26,7,27,5,26,4,24,4,24,6]],repeat:[[30,0],[-15,20],[15,20],[45,20]],fill:1},gravel:{width:15,height:10,circles:[[4,2,1],[5,9,1],[1,7,1]],lines:[[7,5,6,6,7,7,8,7,9,7,10,5,9,4,7,5],[11,2,14,4,14,1,12,1,11,2]],stroke:1},brick:{width:18,height:16,lines:[[0,1,18,1],[0,10,18,10],[6,1,6,10],[12,10,12,18],[12,0,12,1]],stroke:1},dolomite:{width:20,height:16,lines:[[0,1,20,1],[0,9,20,9],[1,9,6,1],[11,9,14,16],[14,0,14.4,1]],stroke:1},coal:{width:20,height:16,lines:[[1,5,7,1,7,7],[11,10,12,5,18,9],[5,10,2,15,9,15],[15,16,15,13,20,16],[15,0,15,2,20,0]],fill:1},breccia:{width:20,height:16,lines:[[1,5,7,1,7,7,1,5],[11,10,12,5,18,9,11,10],[5,10,2,15,9,15,5,10],[15,16,15,13,22,18],[15,0,15,2,20,0]],stroke:1},clay:{width:20,height:20,lines:[[0,0,3,11,0,20],[11,0,10,3,13,13,11,20],[0,0,10,3,20,0],[0,12,3,11,13,13,20,12]],stroke:1},flooded:{width:15,height:10,lines:[[0,1,10,1],[0,6,5,6],[10,6,15,6]],stroke:1},chaos:{width:40,height:40,lines:[[40,2,40,0,38,0,40,2],[4,0,3,2,2,5,0,0,0,3,2,7,5,6,7,7,8,10,9,12,9,13,9,14,8,14,6,15,2,15,0,20,0,22,2,20,5,19,8,15,10,14,11,12.25,10,12,10,10,12,9,13,7,12,6,13,4,16,7,17,4,20,0,18,0,15,3,14,2,14,0,12,1,11,0,10,1,11,4,10,7,9,8,8,5,6,4,5,3,5,1,5,0,4,0],[7,1,7,3,8,3,8,2,7,1],[4,3,5,5,4,5,4,3],[34,5,33,7,38,10,38,8,36,5,34,5],[27,0,23,2,21,8,30,0,27,0],[25,8,26,12,26,16,22.71875,15.375,20,13,18,15,17,18,13,22,17,21,19,22,21,20,19,18,22,17,30,25,26,26,24,28,21.75,33.34375,20,36,18,40,20,40,24,37,25,32,27,31,26,38,27,37,30,32,32,35,36,37,38,40,38,39,40,40,37,36,34,32,37,31,36,29,33,27,34,24,39,21,40,21,40,16,37,20,31,22,32,25,27,20,29,15,30,20,32,20,34,18,33,12,31,11,29,14,26,9,25,8],[39,24,37,26,40,28,39,24],[13,15,9,19,14,18,13,15],[18,23,14,27,16,27,17,25,20,26,18,23],[6,24,2,26,1,28,2,30,5,28,12,30,16,32,18,30,15,30,12,28,9,25,7,27,6,24],[29,27,32,28,33,31,30,29,27,28,29,27],[5,35,1,33,3,36,13,38,15,35,10,36,5,35]],fill:1},grass:{width:27,height:22,lines:[[0,10.5,13,10.5],[2.5,10,1.5,7],[4.5,10,4.5,5,3.5,4],[7,10,7.5,6,8.5,3],[10,10,11,6]],repeat:[[0,0],[14,10]],stroke:1},swamp:{width:24,height:23,lines:[[0,10.5,9.5,10.5],[2.5,10,2.5,7],[4.5,10,4.5,4],[6.5,10,6.5,6],[3,12.5,7,12.5]],repeat:[[0,0],[14,10]],stroke:1},reed:{width:26,height:23,lines:[[2.5,10,2,7],[4.5,10,4.2,4],[6.5,10,6.8,4],[8.5,10,9,6],[3.7,4,3.7,2.5],[4.7,4,4.7,2.5],[6.3,4,6.3,2.5],[7.3,4,7.3,2.5]],circles:[[4.2,2.5,.5],[18.2,12.5,.5],[6.8,2.5,.5],[20.8,12.5,.5],[9,6,.5],[23,16,.5]],repeat:[[0,0],[14,10]],stroke:1},wave:{width:10,height:8,lines:[[0,0,5,4,10,0]],stroke:1},vine:{width:13,height:13,lines:[[3,0,3,6],[9,7,9,13]],stroke:1},forest:{width:55,height:30,circles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],stroke:1},forest2:{width:55,height:30,circles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],fill:1,stroke:1},scrub:{width:26,height:20,lines:[[1,4,4,8,6,4]],circles:[[20,13,1.5]],stroke:1},tree:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78]],repeat:[[3,1],[18,16]],stroke:1},tree2:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61]],repeat:[[3,1],[18,16]],fill:1,stroke:1},pine:{width:30,height:30,lines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49]],repeat:[[3,1],[18,16]],stroke:1},pine2:{width:30,height:30,lines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49,2.83,11.31,5.66,11.31]],repeat:[[3,1],[18,16]],fill:1,stroke:1},mixtree:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61],[23.66,27.31,20.83,27.31,20.83,24.49,18,24.49,20.83,16,23.66,24.49,20.83,24.49,20.83,27.31,23.66,27.31]],repeat:[[3,1]],stroke:1},mixtree2:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61],[23.66,27.31,20.83,27.31,20.83,24.49,18,24.49,20.83,16,23.66,24.49,20.83,24.49,20.83,27.31,23.66,27.31]],repeat:[[3,1]],fill:1,stroke:1},pines:{width:22,height:20,lines:[[1,4,3.5,1,6,4],[1,8,3.5,5,6,8],[3.5,1,3.5,11],[12,14.5,14.5,14,17,14.5],[12,18,17,18],[14.5,12,14.5,18]],repeat:[[2,1]],stroke:1},rock:{width:20,height:20,lines:[[1,0,1,9],[4,0,4,9],[7,0,7,9],[10,1,19,1],[10,4,19,4],[10,7,19,7],[0,11,9,11],[0,14,9,14],[0,17,9,17],[12,10,12,19],[15,10,15,19],[18,10,18,19]],repeat:[[.5,.5]],stroke:1},rocks:{width:20,height:20,lines:[[5,0,3,0,5,4,4,6,0,3,0,5,3,6,5,9,3.75,10,2.5,10,0,9,0,10,4,11,5,14,4,15,0,13,0,13,0,13,0,14,0,14,5,16,5,18,3,19,0,19,-.25,19.9375,5,20,10,19,10,20,11,20,12,19,14,20,15,20,17,19,20,20,20,19,19,16,20,15,20,11,20,10,19,8,20,5,20,0,19,0,20,2,19,4,17,4,16,3,15,0,14,0,15,4,11,5,10,4,11,0,10,0,9,4,6,5,5,0],[18,5,19,6,18,10,16,10,14,9,16,5,18,5],[5,6,9,5,10,6,10,9,6,10,5,6],[14,5,14,8,13,9,12,9,11,7,12,5,14,5],[5,11,8,10,9,11,10,14,6,15,6,15,5,11],[13,10,14,11,15,14,15,14,15,14,11,15,10,11,11,10,13,10],[15,12,16,11,19,11,19,15,16,14,16,14,15,12],[6,16,9,15,10,18,5,19,6,16],[10,16,14,16,14,18,13,19,11,18,10,16],[15,15,18,16,18,18,16,19,15,18,15,15]],stroke:1}};var l=o}),n("foAUE",function(e,r){t(e.exports,"default",()=>o);var i=s("2zf1Y"),a=s("h6Aha"),n=class extends a.default{constructor(e){e=e||{},super({radius:e.radius,fill:e.fill,displacement:e.displacement,declutterMode:e.declutterMode}),this._fill=e.fill||new i.default({color:"rgba(0,0,0,0.5)"}),this._radius=e.radius,this._blur=0===e.blur?0:e.blur||e.radius/3,this._offset=[e.offsetX?e.offsetX:0,e.offsetY?e.offsetY:0],e.displacement||(e.displacement=[e.offsetX||0,-e.offsetY||0]),this.setDisplacement||this.getImage(),this.render()}clone(){var e=new n({fill:this._fill,radius:this._radius,blur:this._blur,offsetX:this._offset[0],offsetY:this._offset[1],declutterMode:this.getDeclutterMode?this.getDeclutterMode():null});return e.setScale(this.getScale()),e.setOpacity(this.getOpacity()),e}createRenderOptions(){var e=super.createRenderOptions();return e.shadowOptions=["shadow",this._radius,this._fill,this._blur].join("-"),e}getImage(e){e=e||1;var t=this._radius,r=super.getImage(e),i=r.getContext("2d");if(i.save(),i.resetTransform(),i.clearRect(0,0,r.width,r.height),i.beginPath(),i.setTransform(e,0,0,e,0,0),i.scale(1,.5),i.arc(t,-t,t-this._blur,0,2*Math.PI,!1),i.fillStyle="#000",i.shadowColor=this._fill.getColor(),i.shadowBlur=.7*this._blur*e,i.shadowOffsetX=0,i.shadowOffsetY=1.5*t*e,i.closePath(),i.fill(),i.shadowColor="transparent",i.restore(),!this.getDisplacement){var a=this.getAnchor();a[0]=r.width/2-this._offset[0],a[1]=r.height/2-this._offset[1]}return r}},o=n}),n("bXE6B",function(r,i){t(r.exports,"default",()=>P),s("eXEIX");var a=s("j2K3b"),n=s("hvEnP"),o=s("cgPpQ"),l=s("iGyOD"),u=s("20LS2"),h=s("7qsnY"),c=s("8WefF"),d=s("3VGVQ"),p=s("l9IGS"),f=s("2zf1Y"),m=s("d5AAH"),g=s("4lFOe"),y=s("lqNjm"),v=s("aUPR1"),_=s("h1ihb"),x=s("bJBiI"),b=s("8SYbd"),S=s("jPVWI"),w=s("hThUZ"),E=s("cHblF");s("cWXYt");var A=s("hwcfb"),T=s("cVsLl");class C extends d.default{constructor(e){super(e=e||{});var t=this;this.set("type","Statistique"),this.set("sort",!1!==e.sort),this.vectorSource=e.source||new u.default,this.typeGeom=e.typeGeom||{};var r=this.vectorSource.clear;this.vectorSource.clear=function(){t.typeGeom={},r.call(this)},this.vectorSource.on("addfeature",e=>{this.typeGeom[e.feature.getGeometry().getType()]=!0}),this.vectorSource.on("addfeature",e=>{e.feature._layer=this}),this.vectorSource.getFeatures().forEach(e=>{e._layer=this,this.typeGeom[e.getGeometry().getType()]=!0}),this.vectorSource.on("removefeature",(function(e){delete e.feature._layer}).bind(this)),this.layerStat=new h.default({source:this.vectorSource,displayInLayerSwitcher:!1}),this.layerStat.selectable=()=>this.selectable(),this.layerHeat=new c.default({source:this.vectorSource,visible:!1,displayInLayerSwitcher:!1,radius:5,blur:15}),this.getLayers().push(this.layerStat),this.getLayers().push(this.layerHeat),["layerStat","layerHeat"].forEach(e=>{let t=this[e];t.on(["filter","change:visible"],()=>{setTimeout(()=>{if(this._mcFilter&&t.getVisible()){let e=document.body.querySelector(".ol-viewport .ol-layers ."+t.getClassName());if(e){let t=[],r=[];this._mcFilter.get("filter")&&t.push(this._mcFilter.get("filter")),this._mcFilter.get("blend")&&r.push(this._mcFilter.get("blend")),e.style.filter=t.join(" "),e.style.mixBlendMode=r.join(" ")}}})}),this.on("change:visible",()=>t.dispatchEvent("filter"))}),this.defaultStyle={fill:new f.default({color:"rgba(255,255,255,0.4)"}),stroke:new m.default({color:"#3399CC",width:1.25}),whiteStroke:new m.default({color:"#fff",width:1.25})},this.defaultStyle.style=new p.default({image:new g.default({fill:this.defaultStyle.fill,stroke:this.defaultStyle.stroke,radius:5}),fill:this.defaultStyle.fill,stroke:this.defaultStyle.stroke}),this.defaultStyle.area=new p.default({fill:this.defaultStyle.fill,stroke:this.defaultStyle.stroke})}}C.prototype.getPopupContent=function(e){return e?e.getPopupContent(this._popupContent||{}):this._popupContent||{}},C.prototype.setPopupContent=function(e){!e||e instanceof Array?this._popupContent={}:this._popupContent=e},C.prototype.getSource=function(){return this.vectorSource},C.prototype.setSource=function(e,t){this.vectorSource=e||new u.default,this.typeGeom=t||{};var r=this.vectorSource.clear;this.vectorSource.clear=(function(){this.typeGeom={},r.call(this)}).bind(this),this.vectorSource.on("addfeature",e=>{this.typeGeom[e.feature.getGeometry().getType()]=!0}),this.vectorSource.on("addfeature",e=>{e.feature._layer=this}),this.vectorSource.getFeatures().forEach(e=>{e._layer=this,this.typeGeom[e.getGeometry().getType()]=!0}),this.vectorSource.on("removefeature",(function(e){delete e.feature._layer}).bind(this)),this.layerStat.setSource(this.vectorSource),this.layerHeat.setSource(this.vectorSource)},C.prototype.setComposite=function(e){this.setBlendMode(e?"multiply":void 0)},C.prototype.isGeom=function(e){switch(e){case"Point":return this.typeGeom.Point||this.typeGeom.MultiPoint;case"Polygon":return this.typeGeom.Polygon||this.typeGeom.MultiPolygon;case"Line":return this.typeGeom.LineString||this.typeGeom.MultiLineString;default:return!1}},C.prototype._getStyle=function(e){e||(e=this.stat);var t=this;function r(e){var t=e._interiorPoint;return t||(t=(0,w.default)(e.getGeometry()),e._interiorPoint=t),t}e||(e={});var i={},a=this.isGeom("Polygon"),s=this.isGeom("Point"),n=this.isGeom("Line");return function(o){if(!e.color&&!e.colors)return[t.defaultStyle.style];var l,u,h,c,d,x,b,S=e.cols[0];switch(e.typeMap){case"sectoriel":if(!(l=o._stat?e.radius(o._stat.sum):void 0))return[t.defaultStyle.style];return(u=i[l+"-"+o._stat.data.join("-")])||(u=[],e.stroke&&(x=new m.default({color:!0===e.stroke?"#3399CC":e.stroke,width:1.25}),u.push(new p.default({stroke:x}))),u.push(new p.default({image:new v.default({type:e.chartType,radius:l,data:o._stat.data||[],colors:e.colors,stroke:new m.default({color:"neon"==e.colors?"#000":"#fff",width:2})}),geometry:r(o)}))),u;case"symbol":{h=parseFloat(o.get(S)),(c=e.color(h).rgb()).push(e.alpha),e.rmin<0&&e.col2&&(h=parseFloat(o.get(e.col2)));let v=(n?"symboline-":"symbol-")+c+"-"+(l=e.radius(h).toFixed(2))+(e.stroke?"-1":"-0");return(u=i[v])||(l=e.radius(h),a||s?(d=new f.default({color:c}),x=null,u=i[v]=[],e.stroke&&(x=new m.default({color:!0===e.stroke?"#3399CC":e.stroke,width:1.25}),u.push(new p.default({stroke:x}))),e.symbol&&"ign-form-rond"!=e.symbol?(x=t.defaultStyle.whiteStroke,b=new _.default({glyph:e.symbol,fill:d,stroke:x,radius:l}),o.setIgnStyle({pointRadius:l,pointGlyph:e.symbol,pointColor:x?(0,y.asString)(x.getColor()):null,symbolColor:d?(0,y.asString)(d.getColor()):"rgba(0,0,0,0)"})):b=new g.default({fill:d,stroke:x,radius:l}),u.push(new p.default({image:b,zIndex:e.rmax-l,geometry:r}))):u=n?i[v]=[new p.default({stroke:new m.default({width:l,color:c,zIndex:e.rmax-l})})]:i[v]=[t.defaultStyle.style]),u}default:{h="categorie"===e.typeMap?o.get(S):parseFloat(o.get(S));let r=(n?"line-":"")+(c=e.color(h).rgb()).join("-")+(e.stroke?"-1":"-0");return(u=i[r])||(a||s?(d=new f.default({color:c}),x=e.stroke?new m.default({color:!0===e.stroke?"#3399CC":e.stroke,width:!1===e.stroke?0:1.25}):null,b=new _.default({glyph:e.symbol||"ign-form-rond",fill:d,stroke:x||new m.default({color:"",width:0}),radius:e.rsymb||5}),u=i[r]=[new p.default({image:b,fill:d,stroke:x})]):u=n?i[r]=[new p.default({stroke:new m.default({color:c,width:3})})]:[t.defaultStyle.style]),u}}}},C.prototype.getStatistic=function(){return this._cloneStatistic(this.stat)},C.prototype._cloneStatistic=function(e){e=e||{};let t=this.stat||{};return{typeMap:e.typeMap||t.typeMap||"choroplethe",cols:(e.cols||t.cols||[]).slice(),mode:e.mode||t.mode||"q",nbClass:e.nbClass||t.nbClass||5,col2:""===e.col2?"":e.col2||t.col2||"",symbol:e.symbol||t.symbol||"",rsymb:e.rsymb||t.rsymb||5,rmin:e.rmin||t.rmin||3,rmax:e.rmax||t.rmax||20,rProp:e.rProp||t.rProp||"length",stroke:void 0===e.stroke?void 0===t.stroke||t.stroke:e.stroke,limits:(e.limits||t.limits||[]).slice(),alpha:e.alpha||t.alpha||1,chartType:e.chartType||t.chartType||"pie",hradius:e.hradius||t.hradius||5,hblur:e.hblur||t.hblur||15,brewerColors:(e.brewerColors||t.brewerColors||[]).slice()}},C.prototype.setStatistic=function(t,r){if(r){this.dispatchEvent({type:"stat:start"}),setTimeout(()=>this.setStatistic(t),r);return}if(this.stat=t=this._cloneStatistic(t),this.layerHeat.setVisible("heatmap"===t.typeMap),this.layerStat.setVisible("heatmap"!==t.typeMap),"heatmap"===t.typeMap&&!this.typeGeom.Point)return this.dispatchEvent({type:"stat:end",error:!0,status:"HEATPTS",statusText:"Une heatmap nécessite une couche contenant des points..."}),!1;let i=t.min=1/0,a=t.max=-1/0;t.values={att:t.cols[0],length:0,val:{}};let s=this.vectorSource.getFeatures();switch(t.typeMap){case"categorie":if(t.cols.length){var n,o,l,u,h=t.cols[0];if(-1!=h){l={},s.forEach(e=>{l[e.get(h)]=!0});var c=Object.keys(l),d=c.length;if(this.get("sort"))for(c.sort((e,t)=>(/^-?\d+$/.test(e)&&(e=parseInt(e)),/^-?\d+$/.test(t)&&(t=parseInt(t)),e<t?-1:e>t?1:0)),l={},o=0;o<d;o++)l[c[o]]=o;t.values={att:h,length:d,val:l}}}t.limits=[];break;case"sectoriel":var p=t.cols;for(n=0;n<s.length;n++){var f=[],m=0;for(o=0;o<p.length;o++){var g=Number(s[n].get(p[o]))||0;m+=g,f.push(g)}a=Math.max(a,m),i=Math.min(i,m),s[n]._stat={data:f,sum:m}}t.limits=[];break;default:for(n=0,l=[],t.max2=0;n<s.length;n++){var y=s[n].get(t.cols[0]);if((y||"heatmap"===t.typeMap)&&(isNaN(u=void 0===y?1:parseFloat(y))||(l.push(u),s[n]._stat={},t.max=a=Math.max(a,u),t.min=i=Math.min(i,u)),t.col2)){let e=parseFloat(s[n].get(t.col2));isNaN(e)||(t.max2=Math.max(t.max2,e))}}"c"===t.mode?t.limits||(t.limits=this.limits(t,l)):(0>Object.keys(C.mode).indexOf(t.mode)&&(t.mode="q"),t.limits=this.limits(t,l))}if(t.min=i,t.max=a,this._values=l,this.stat.values.length>110)return this.dispatchEvent({type:"stat:end",error:!0,status:"MAXVAL",statusText:"Trop de valeur différentes pour calculer une statistique."}),!1;switch(t.typeMap){case"sectoriel":t.colors=t.brewerColors;break;case"categorie":{let r=t.brewerColors;t.values.length?t.color=function(i){return e(b)(r[t.values.val[i]]||"#aaa")}:t.color=function(){return e(b)("#ccc")};break}default:if(t.limits&&t.limits.length){let r=t.brewerColors;t.color=e(b).scale(r).classes(t.limits)}else t.color=function(){return e(b)("#ccc")}}switch(this.vectorSource.changed(),t.typeMap){case"heatmap":for(this.layerHeat.setBlur(t.hblur),this.layerHeat.setRadius(t.hradius),n=0;n<s.length;n++)u=t.cols[0]?Number(s[n].get(t.cols[0])):1,i<0?s[n].set("weight",(u-i)/(a-i)):s[n].set("weight",u/a);break;case"sectoriel":var v=Math.sqrt(i),_=Math.sqrt(a);t.rmin<0?t.radius=function(e){let r;return(r="area"===t.rProp?Math.sqrt(e*t.rmax*t.rmax/a):t.rmax*e/a)>0?r:0}:t.radius=function(e){return t.rmin+(Math.sqrt(e)-v)/(_-v)*(t.rmax-t.rmin)};break;case"categorie":t.radius=function(){return 5};break;default:t.rmin<0?t.radius=function(e){let r;let i=t.col2?t.max2:a;return(r="area"===t.rProp?Math.sqrt(e*t.rmax*t.rmax/i):t.rmax*e/i)>0?r:0}:t.radius=function(e){for(var r=t.limits.length,i=1;i<r&&!(e<t.limits[i]);i++);return t.rmin+i*(t.rmax-t.rmin)/r}}if("heatmap"!==t.typeMap){var x=this._getStyle(t);this.layerStat.getSource().setStyle?this.layerStat.getSource().setStyle(x):this.layerStat.setStyle(x)}return this.dispatchEvent({type:"stat:end",error:!1,stat:this.getStatistic()}),!0},C.prototype.getStatLegend=function(){let e;let t=[],r=this.stat,i=this._getStyle();switch(r.typeMap){case"choroplethe":case"symbol":if(r.cols[0]<0)break;for(let s=r.limits.length-1;s>0;s--)(e=new l.default(this.isGeom("Polygon")||this.isGeom("Point")||!this.isGeom("Line")?"symbol"==r.typeMap||this.isGeom("Point")?new a.default([0,0]):new o.default([[[0,0],[0,0],[0,0],[0,0],[0,0]]]):new n.default([[0,0],[0,0]]))).set(r.cols[0],(r.limits[s-1]+r.limits[s])/2),r.col2&&e.set(r.col2,10*r.max2/r.rmax),e.setStyle(i(e)),t.push({title:parseFloat(r.limits[s-1].toFixed(2))+" - "+parseFloat(r.limits[s].toFixed(2)),feature:e});if("symbol"==r.typeMap&&r.col2&&r.rmin<0){t.push({title:r.col2});for(let s=0;s<4;s++){let n=Math.round(r.max2/Math.pow(2,s));(e=new l.default(new a.default([0,0]))).set(r.cols[0],r.limits[0]),e.set(r.col2,n),e.setStyle(i(e)),t.push({title:String(n),feature:e})}}break;case"categorie":this.getValues().forEach(s=>{(e=new l.default(this.isGeom("Polygon")||this.isGeom("Point")||!this.isGeom("Line")?"symbol"==r.typeMap||this.isGeom("Point")?new a.default([0,0]):new o.default([[[0,0],[0,0],[0,0],[0,0],[0,0]]]):new n.default([[0,0],[0,0]]))).set(r.cols[0],s),e.setStyle(i(e)),t.push({title:s,feature:e})});break;case"sectoriel":var s=r.colors;r.cols.forEach((r,i)=>{(e=new l.default(new o.default([[[0,0],[0,0],[0,0],[0,0],[0,0]]]))).setStyle(new p.default({stroke:this.defaultStyle.stroke,fill:new f.default({color:s[i]})})),t.unshift({title:r,feature:e})})}return t},C.prototype.getParametricStyle=function(e,t){if(e||(e=this.getStatistic()),"heatmap"===e.typeMap||"sectoriel"===e.typeMap)return[];let r=[],i=e.cols[0],a=this.getStatLegend().reverse();switch(a.forEach(e=>{e.feature&&e.feature.setIgnStyle((0,A.default)(e.feature))}),e.typeMap){case"categorie":case"choroplethe":case"symbol":a.forEach((t,s)=>{let n;n="categorie"===e.typeMap?[{attr:i,op:"=",val:t.title}]:s<a.length-1?[{attr:i,op:"<",val:e.limits[s+1]}]:[{attr:"",op:"=",val:""}],r.push({title:t.title,condition:{all:!0,conditions:n},symbol:new E.default(t)})})}return"SLD"===t?(0,x.toSLD)(r):r},C.prototype.hasVectorStyle=function(e){let t=this.getStatistic();return"heatmap"!==t.typeMap&&"sectoriel"!==t.typeMap&&(!e||"symbol"!==t.typeMap||!(t.rmin<0))},C.prototype.getVectorStyle=function(e){if(!this.hasVectorStyle())return!1;let t=this.getStatistic(),r=new u.default,i=this.getSource().getFeatures(),a=this.getLayers().item(0).getStyleFunction(),s=this.getParametricStyle(t);e=e&&s.length>0,i.forEach(i=>{let s=a(i),n={};if("symbol"===t.typeMap){if(!/LineString/.test(i.getGeometry().getType())){let e=(0,w.default)(i.getGeometry());e!==i.getGeometry()&&(i=i.clone()).setGeometry(e)}let e=s[s.length-1];e.getImage()?(n.symbolColor=(0,y.asString)(e.getImage().getFill().getColor()),n.pointRadius=Math.round(10*(e.getImage().getRadius()||0))/10):(n.strokeColor=(0,y.asString)(s[0].getStroke().getColor()),n.strokeWidth=s[0].getStroke().getWidth())}else{let e=s[s.length-1];e.getImage()?(n.symbolColor=(0,y.asString)(e.getImage().getFill().getColor()),n.pointRadius=Math.round(10*(e.getImage().getRadius()||0))/10):(s[0].getFill()&&(n.fillColor=(0,y.asString)(s[0].getFill().getColor())),s[0].getStroke()?(n.strokeColor=(0,y.asString)(s[0].getStroke().getColor()),n.strokeWidth=s[0].getStroke().getWidth()):n.strokeColor="rgba(255,255,255,0)")}e||i.setIgnStyle(n),r.addFeature(i)});let n=new S.default({id:this.get("id"),title:this.get("title"),description:this.get("description"),minZoom:this.getMinZoom(),maxZoom:this.getMaxZoom(),source:r});return e&&this.get("url")?(n.set("type","file"),n.set("url",this.get("url"))):n.set("type","Vector"),n.setPopupContent(this.getPopupContent()),n._legend=this._legend,n.setMode("image"),this.getSource().getAttributions()&&n.getSource().setAttributions(this.getSource().getAttributions()()),this.get("grayscale")&&n.grayscale(!0),this.get("blendMode")&&n.setBlendMode(this.get("blendMode")),n.setIgnStyle("strokeColor",!0===t.stroke?"#fff":t.stroke),n.setIgnStyle("pointStrokeColor",!0===t.stroke?"#fff":t.stroke),n.setIgnStyle("pointGlyph",t.symbol||"ign-form-rond"),n.setIgnStyle("strokeWidth",t.stroke?1.25:0),n.setIgnStyle("pointStrokeWidth",t.stroke?1.25:0),e&&n.setConditionStyle(s),n},C.prototype.getValues=function(){switch(this.stat.typeMap){case"categorie":return Object.keys(this._values||{});case"heatmap":return;default:return this._values}},C.prototype.getLimits=function(){return this.stat.limits},C.prototype.getMode=function(){return this.stat.mode},C.prototype.addFilter=function(e){(0,d.default).prototype.addFilter.call(this,e),["layerStat","layerHeat"].forEach(t=>{this[t].addFilter(e),this[t].dispatchEvent({type:"filter"})})},C.prototype.removeFilter=function(e){(0,d.default).prototype.removeFilter.call(this,e),["layerStat","layerHeat"].forEach(t=>{this[t].removeFilter(e),this[t].dispatchEvent({type:"filter"})})},C.type=["choroplethe","categorie","symbol","sectoriel","heatmap"],C.typeString={choroplethe:"choroplèthe",categorie:"catégorie",symbol:"symbole",sectoriel:"sectoriel",heatmap:"carte de chaleur"},C.paramList={typeMap:["choroplethe","categorie","symbol","sectoriel","heatmap"],cols:["choroplethe","categorie","symbol","sectoriel","heatmap"],mode:["choroplethe","categorie","symbol","sectoriel"],nbClass:["choroplethe","symbol"],symbol:["symbol","categorie"],rsymb:["categorie"],col2:["symbol"],rmin:["symbol","sectoriel"],rmax:["symbol","sectoriel"],stroke:["choroplethe","categorie","symbol","sectoriel"],limits:["choroplethe","symbol"],alpha:["symbol"],chartType:["sectoriel"],hradius:["heatmap"],hblur:["heatmap"],brewerColors:["choroplethe","categorie","symbol","sectoriel"]},C.mode={q:"Quantiles",e:"Equidistance",l:"Logarithmique",k:"Clusters",j:"Jenks",h:"Head/tail",c:"Manuelle"},C.prototype.selectable=function(e){return(!this.stat||"heatmap"!==this.stat.typeMap)&&(!0===e?this.set("selectable",!0):!1===e&&this.set("selectable",!1),!1!==this.get("selectable"))},C.prototype.limits=function(e,t){var r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,C,P,R,I,L,O,M,k,N,D,F,G,z,q,j,B,U,H,Z,V,Y,W,$,X,K,J,Q,ee,et,er,ei=e.mode||"q",ea=e.nbClass||5,es=e.min,en=e.max;if(et=t.sort(function(e,t){return e-t}),1===ea)return[es,en];switch(E=[],ei.substr(0,1)){case"c":E.push(es),E.push(en);break;case"j":E=(0,T.default)(t,ea);break;case"e":for(E.push(es),b=O=1,D=ea-1;1<=D?O<=D:O>=D;b=1<=D?++O:--O)E.push(es+b/ea*(en-es));E.push(en);break;case"l":if(es<=0)throw"Logarithmic scales are only possible for values > 0";for(C=Math.LOG10E*Math.log(es),A=Math.LOG10E*Math.log(en),E.push(es),b=er=1,F=ea-1;1<=F?er<=F:er>=F;b=1<=F?++er:--er)E.push(Math.pow(10,C+b/ea*(A-C)));E.push(en);break;case"q":for(E.push(es),b=r=1,U=ea-1;1<=U?r<=U:r>=U;b=1<=U?++r:--r)(k=Math.floor(M=(et.length-1)*b/ea))===M?E.push(et[k]):(N=M-k,E.push(et[k]*(1-N)+et[k+1]*N));E.push(en);break;case"k":for(m=Array(R=et.length),_=Array(ea),K=!0,I=0,y=null,(y=[]).push(es),b=i=1,H=ea-1;1<=H?i<=H:i>=H;b=1<=H?++i:--i)y.push(es+b/ea*(en-es));for(y.push(en);K;){for(S=a=0,Z=ea-1;0<=Z?a<=Z:a>=Z;S=0<=Z?++a:--a)_[S]=0;for(b=s=0,V=R-1;0<=V?s<=V:s>=V;b=0<=V?++s:--s){for(ee=et[b],P=Number.MAX_VALUE,S=n=0,Y=ea-1;0<=Y?n<=Y:n>=Y;S=0<=Y?++n:--n)(x=Math.abs(y[S]-ee))<P&&(P=x,g=S);_[g]++,m[b]=g}for(L=Array(ea),S=o=0,W=ea-1;0<=W?o<=W:o>=W;S=0<=W?++o:--o)L[S]=null;for(b=l=0,$=R-1;0<=$?l<=$:l>=$;b=0<=$?++l:--l)null===L[v=m[b]]?L[v]=et[b]:L[v]+=et[b];for(S=u=0,X=ea-1;0<=X?u<=X:u>=X;S=0<=X?++u:--u)L[S]*=1/_[S];for(K=!1,S=h=0,G=ea-1;0<=G?h<=G:h>=G;S=0<=G?++h:--h)if(L[S]!==y[b]){K=!0;break}y=L,++I>200&&(K=!1)}for(w={},S=c=0,z=ea-1;0<=z?c<=z:c>=z;S=0<=z?++c:--c)w[S]=[];for(b=d=0,q=R-1;0<=q?d<=q:d>=q;b=0<=q?++d:--d)w[v=m[b]].push(et[b]);for(J=[],S=p=0,j=ea-1;0<=j?p<=j:p>=j;S=0<=j?++p:--p)J.push(w[S][0]),J.push(w[S][w[S].length-1]);for(J=J.sort(function(e,t){return e-t}),E.push(J[0]),b=f=1,B=J.length-1;f<=B;b=f+=2)isNaN(Q=J[b])||-1!==E.indexOf(Q)||E.push(Q);break;case"h":{function eo(e){return e.reduce(function(e,t){return e+t},0)/e.length}let e=eo(t);for(E=[es];t.length>1;){if(E.length>=ea){E.push(en);break}if(0===(t=t.filter(t=>t>e)).length)break;e=eo(t),E.push(e)}}}return E};var P=C}),n("8WefF",function(e,r){t(e.exports,"default",()=>d);var i=s("cgxQK"),a=s("a6roo"),n=s("14k51"),o=s("2q51R"),l=s("2YyN3");let u={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},h=["#00f","#0ff","#0f0","#ff0","#f00"];class c extends l.default{constructor(e){let t=Object.assign({},e=e||{});delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.gradient_=null,this.addChangeListener(u.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:h),this.setBlur(void 0!==e.blur?e.blur:15),this.setRadius(void 0!==e.radius?e.radius:8);let r=e.weight?e.weight:"weight";this.weightFunction_="string"==typeof r?e=>e.get(r):r,this.setRenderOrder(null)}getBlur(){return this.get(u.BLUR)}getGradient(){return this.get(u.GRADIENT)}getRadius(){return this.get(u.RADIUS)}handleGradientChanged_(){this.gradient_=function(e){let t=(0,i.createCanvasContext2D)(1,256),r=t.createLinearGradient(0,0,1,256),a=1/(e.length-1);for(let t=0,i=e.length;t<i;++t)r.addColorStop(t*a,e[t]);return t.fillStyle=r,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())}setBlur(e){this.set(u.BLUR,e)}setGradient(e){this.set(u.GRADIENT,e)}setRadius(e){this.set(u.RADIUS,e)}createRenderer(){let e=new(0,o.ShaderBuilder)().addAttribute("float a_weight").addVarying("v_weight","float","a_weight").addUniform("float u_size").addUniform("float u_blurSlope").setSymbolSizeExpression("vec2(u_size)").setSymbolColorExpression("vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * u_blurSlope) * v_weight)");return new n.default(this,{className:this.getClassName(),attributes:[{name:"weight",callback:e=>{let t=this.weightFunction_(e);return void 0!==t?(0,a.clamp)(t,0,1):1}}],uniforms:{u_size:()=>(this.get(u.RADIUS)+this.get(u.BLUR))*2,u_blurSlope:()=>this.get(u.RADIUS)/Math.max(1,this.get(u.BLUR))},hitDetectionEnabled:!0,vertexShader:e.getSymbolVertexShader(),fragmentShader:e.getSymbolFragmentShader(),postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}}var d=c}),n("14k51",function(e,r){t(e.exports,"default",()=>w);var i=s("bCUH1"),a=s("eJ4LZ"),n=s("bsgMw"),o=s("jZquI"),l=s("2YyN3"),u=s("gzr8q"),h=s("RJ0Sz"),c=s("bxq6G"),d=s("gKdkP"),p=s("14PDX"),f=s("lVQul"),m=s("77SUz"),g=s("knkkM"),y=s("4WkA9"),v=s("5XVOZ"),_=s("6AH2e"),x=s("iHIuK"),b=s("hQEK0");class S extends x.default{constructor(e,t){let r=t.uniforms||{},i=(0,p.create)();r[g.DefaultUniform.PROJECTION_MATRIX]=i,super(e,{uniforms:r,postProcesses:t.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new m.default(v.ARRAY_BUFFER,v.DYNAMIC_DRAW),this.indicesBuffer_=new m.default(v.ELEMENT_ARRAY_BUFFER,v.DYNAMIC_DRAW),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.program_,this.hitDetectionEnabled_=t.hitDetectionEnabled??!0;let a=t.attributes?t.attributes.map(function(e){return{name:"a_"+e.name,size:1,type:g.AttributeType.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:g.AttributeType.FLOAT},{name:"a_index",size:1,type:g.AttributeType.FLOAT}],this.hitDetectionEnabled_&&(this.attributes.push({name:"a_hitColor",size:4,type:g.AttributeType.FLOAT}),this.attributes.push({name:"a_featureUid",size:1,type:g.AttributeType.FLOAT})),this.attributes.push(...a),this.customAttributes=t.attributes?t.attributes:[],this.previousExtent_=(0,o.createEmpty)(),this.currentTransform_=i,this.renderTransform_=(0,p.create)(),this.invertRenderTransform_=(0,p.create)(),this.renderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.lastSentId=0,this.worker_=(0,_.create)(),this.worker_.addEventListener("message",e=>{let t=e.data;if(t.type===h.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS){let r=t.projectionTransform;this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,(0,p.makeInverse)(this.invertRenderTransform_,this.renderTransform_),this.renderInstructions_=new Float32Array(e.data.renderInstructions),t.id===this.lastSentId&&(this.ready=!0),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;let s=this.getLayer().getSource();this.sourceListenKeys_=[(0,n.listen)(s,d.default.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,n.listen)(s,d.default.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,n.listen)(s,d.default.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,n.listen)(s,d.default.CLEAR,this.handleSourceFeatureClear_,this)],s.forEachFeature(e=>{let t=e.getGeometry();t&&"Point"===t.getType()&&(this.featureCache_[(0,f.getUid)(e)]={feature:e,properties:e.getProperties(),flatCoordinates:t.getFlatCoordinates()},this.featureCount_++)})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new y.default(this.helper)),this.verticesBuffer_.getArray()&&this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.getArray()&&this.helper.flushBufferData(this.indicesBuffer_)}handleSourceFeatureAdded_(e){let t=e.feature,r=t.getGeometry();r&&"Point"===r.getType()&&(this.featureCache_[(0,f.getUid)(t)]={feature:t,properties:t.getProperties(),flatCoordinates:r.getFlatCoordinates()},this.featureCount_++)}handleSourceFeatureChanged_(e){let t=e.feature,r=(0,f.getUid)(t),i=this.featureCache_[r],a=t.getGeometry();i?a&&"Point"===a.getType()?(i.properties=t.getProperties(),i.flatCoordinates=a.getFlatCoordinates()):(delete this.featureCache_[r],this.featureCount_--):a&&"Point"===a.getType()&&(this.featureCache_[r]={feature:t,properties:t.getProperties(),flatCoordinates:a.getFlatCoordinates()},this.featureCount_++)}handleSourceFeatureDelete_(e){let t=e.feature,r=(0,f.getUid)(t);r in this.featureCache_&&(delete this.featureCache_[r],this.featureCount_--)}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(e){let t=this.helper.getGL();this.preRender(t,e);let[r,i,a]=(0,b.getWorldParameters)(e,this.getLayer());return this.renderWorlds(e,!1,r,i,a),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,a),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),this.helper.getCanvas()}prepareFrameInternal(e){let t=this.getLayer(),r=t.getSource(),a=e.viewState,s=!e.viewHints[i.default.ANIMATING]&&!e.viewHints[i.default.INTERACTING],n=!(0,o.equals)(this.previousExtent_,e.extent),u=this.sourceRevision_<r.getRevision();if(u&&(this.sourceRevision_=r.getRevision()),s&&(n||u)){let i=a.projection,s=a.resolution,n=t instanceof l.default?t.getRenderBuffer():0,u=(0,o.buffer)(e.extent,n*s);r.loadFeatures(u,s,i),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(e){let t=(0,p.create)();this.helper.makeProjectionTransform(e,t);let r=(0,u.getUserProjection)(),i=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,a=i*this.featureCount_,s=this.renderInstructions_&&this.renderInstructions_.length===a?this.renderInstructions_:new Float32Array(a);this.renderInstructions_=null;let n=[],o=[],l=-1,d=e.viewState.projection;for(let e in this.featureCache_){let i=this.featureCache_[e];if(r?n=(0,u.fromUserCoordinate)(i.flatCoordinates,d):(n[0]=i.flatCoordinates[0],n[1]=i.flatCoordinates[1]),(0,p.apply)(t,n),s[++l]=n[0],s[++l]=n[1],this.hitDetectionEnabled_){let t=(0,c.colorEncodeId)(l+5,o);s[++l]=t[0],s[++l]=t[1],s[++l]=t[2],s[++l]=t[3],s[++l]=Number(e)}for(let e=0;e<this.customAttributes.length;e++){let t=this.customAttributes[e].callback(i.feature,i.properties);s[++l]=t}}let f={id:++this.lastSentId,type:h.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS,renderInstructions:s.buffer,customAttributesSize:i-2};f.projectionTransform=t,this.ready=!1,this.worker_.postMessage(f,[s.buffer])}forEachFeatureAtCoordinate(e,t,r,i,s){if((0,a.assert)(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.renderInstructions_||!this.hitDetectionEnabled_)return;let n=(0,p.apply)(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(n[0]/2,n[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],u=(0,c.colorDecodeId)(l),h=Math.floor(this.renderInstructions_[u]).toString(),d=this.getLayer().getSource().getFeatureByUid(h);if(d)return i(d,this.getLayer(),null)}renderWorlds(e,t,r,i,a){let s=r;this.helper.useProgram(this.program_,e),t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,p.translate)(this.currentTransform_,s*a,0),(0,p.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.applyHitDetectionUniform(t);let r=this.indicesBuffer_.getSize();this.helper.drawElements(0,r)}while(++s<i)}disposeInternal(){this.worker_.terminate(),this.sourceListenKeys_.forEach(function(e){(0,n.unlistenByKey)(e)}),this.sourceListenKeys_=null,super.disposeInternal()}renderDeclutter(){}}var w=S}),n("RJ0Sz",function(e,r){t(e.exports,"WebGLWorkerMessageType",()=>i);let i={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"}}),n("bxq6G",function(e,r){t(e.exports,"LINESTRING_ANGLE_COSINE_CUTOFF",()=>i),t(e.exports,"colorEncodeId",()=>a),t(e.exports,"colorDecodeId",()=>n),s("atSou"),s("a6roo"),s("14PDX");let i=.985;function a(e,t){return(t=t||[])[0]=Math.floor(e/256/256/256)/255,t[1]=Math.floor(e/256/256)%256/255,t[2]=Math.floor(e/256)%256/255,t[3]=e%256/255,t}function n(e){return 0+(Math.round(16777216*e[0]*255)+Math.round(65536*e[1]*255)+Math.round(256*e[2]*255)+Math.round(255*e[3]))}}),n("atSou",function(e,r){function i(e,t,r=2){let i,p,f;let y=t&&t.length,_=y?t[0]*r:e.length,x=a(e,0,_,r,!0),b=[];if(!x||x.next===x.prev)return b;if(y&&(x=function(e,t,r,i){let o=[];for(let r=0,s=t.length;r<s;r++){let n=t[r]*i,l=r<s-1?t[r+1]*i:e.length,u=a(e,n,l,i,!1);u===u.next&&(u.steiner=!0),o.push(function(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(u))}o.sort(n);for(let e=0;e<o.length;e++)r=function(e,t){let r=function(e,t){let r,i=t,a=e.x,s=e.y,n=-1/0;if(c(e,i))return i;do{if(c(e,i.next))return i.next;if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){let e=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=a&&e>n&&(n=e,r=i.x<i.next.x?i:i.next,e===a))return r}i=i.next}while(i!==t)if(!r)return null;let o=r,u=r.x,d=r.y,p=1/0;i=r;do{if(a>=i.x&&i.x>=u&&a!==i.x&&l(s<d?a:n,s,u,d,s<d?n:a,s,i.x,i.y)){var f,g;let t=Math.abs(s-i.y)/(a-i.x);m(i,e)&&(t<p||t===p&&(i.x>r.x||i.x===r.x&&(f=r,g=i,0>h(f.prev,f,g.prev)&&0>h(g.next,f,f.next))))&&(r=i,p=t)}i=i.next}while(i!==o)return r}(e,t);if(!r)return t;let i=g(r,e);return s(i,i.next),s(r,r.next)}(o[e],r);return r}(e,t,x,r)),e.length>80*r){i=1/0,p=1/0;let t=-1/0,a=-1/0;for(let s=r;s<_;s+=r){let r=e[s],n=e[s+1];r<i&&(i=r),n<p&&(p=n),r>t&&(t=r),n>a&&(a=n)}f=0!==(f=Math.max(t-i,a-p))?32767/f:0}return function e(t,r,i,a,n,l,p){if(!t)return;!p&&l&&function(e,t,r,i){let a=e;do 0===a.z&&(a.z=o(a.x,a.y,t,r,i)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e)a.prevZ.nextZ=null,a.prevZ=null,function(e){let t;let r=1;do{let i,a=e;e=null;let s=null;for(t=0;a;){t++;let n=a,o=0;for(let e=0;e<r&&(o++,n=n.nextZ);e++);let l=r;for(;o>0||l>0&&n;)0!==o&&(0===l||!n||a.z<=n.z)?(i=a,a=a.nextZ,o--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;a=n}s.nextZ=null,r*=2}while(t>1)}(a)}(t,a,n,l);let f=t;for(;t.prev!==t.next;){let y=t.prev,_=t.next;if(l?function(e,t,r,i){let a=e.prev,s=e.next;if(h(a,e,s)>=0)return!1;let n=a.x,l=e.x,c=s.x,d=a.y,p=e.y,f=s.y,m=Math.min(n,l,c),g=Math.min(d,p,f),y=Math.max(n,l,c),v=Math.max(d,p,f),_=o(m,g,t,r,i),x=o(y,v,t,r,i),b=e.prevZ,S=e.nextZ;for(;b&&b.z>=_&&S&&S.z<=x;){if(b.x>=m&&b.x<=y&&b.y>=g&&b.y<=v&&b!==a&&b!==s&&u(n,d,l,p,c,f,b.x,b.y)&&h(b.prev,b,b.next)>=0||(b=b.prevZ,S.x>=m&&S.x<=y&&S.y>=g&&S.y<=v&&S!==a&&S!==s&&u(n,d,l,p,c,f,S.x,S.y)&&h(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;b&&b.z>=_;){if(b.x>=m&&b.x<=y&&b.y>=g&&b.y<=v&&b!==a&&b!==s&&u(n,d,l,p,c,f,b.x,b.y)&&h(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;S&&S.z<=x;){if(S.x>=m&&S.x<=y&&S.y>=g&&S.y<=v&&S!==a&&S!==s&&u(n,d,l,p,c,f,S.x,S.y)&&h(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}(t,a,n,l):function(e){let t=e.prev,r=e.next;if(h(t,e,r)>=0)return!1;let i=t.x,a=e.x,s=r.x,n=t.y,o=e.y,l=r.y,c=Math.min(i,a,s),d=Math.min(n,o,l),p=Math.max(i,a,s),f=Math.max(n,o,l),m=r.next;for(;m!==t;){if(m.x>=c&&m.x<=p&&m.y>=d&&m.y<=f&&u(i,n,a,o,s,l,m.x,m.y)&&h(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}(t)){r.push(y.i,t.i,_.i),v(t),t=_.next,f=_.next;continue}if((t=_)===f){p?1===p?e(t=function(e,t){let r=e;do{let i=r.prev,a=r.next.next;!c(i,a)&&d(i,r,r.next,a)&&m(i,a)&&m(a,i)&&(t.push(i.i,r.i,a.i),v(r),v(r.next),r=e=a),r=r.next}while(r!==e)return s(r)}(s(t),r),r,i,a,n,l,2):2===p&&function(t,r,i,a,n,o){let l=t;do{let t=l.next.next;for(;t!==l.prev;){var u,p;if(l.i!==t.i&&(u=l,p=t,u.next.i!==p.i&&u.prev.i!==p.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&d(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(u,p)&&(m(u,p)&&m(p,u)&&function(e,t){let r=e,i=!1,a=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&a<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e)return i}(u,p)&&(h(u.prev,u,p.prev)||h(u,p.prev,p))||c(u,p)&&h(u.prev,u,u.next)>0&&h(p.prev,p,p.next)>0))){let u=g(l,t);l=s(l,l.next),u=s(u,u.next),e(l,r,i,a,n,o,0),e(u,r,i,a,n,o,0);return}t=t.next}l=l.next}while(l!==t)}(t,r,i,a,n,l):e(s(t),r,i,a,n,l,1);break}}}(x,b,r,i,p,f,0),b}function a(e,t,r,i,a){let s;if(a===function(e,t,r,i){let a=0;for(let s=t,n=r-i;s<r;s+=i)a+=(e[n]-e[s])*(e[s+1]+e[n+1]),n=s;return a}(e,t,r,i)>0)for(let a=t;a<r;a+=i)s=y(a/i|0,e[a],e[a+1],s);else for(let a=r-i;a>=t;a-=i)s=y(a/i|0,e[a],e[a+1],s);return s&&c(s,s.next)&&(v(s),s=s.next),s}function s(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(c(r,r.next)||0===h(r.prev,r,r.next))){if(v(r),(r=t=r.prev)===r.next)break;i=!0}else r=r.next;while(i||r!==t)return t}function n(e,t){let r=e.x-t.x;return 0===r&&0==(r=e.y-t.y)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function o(e,t,r,i,a){return(e=((e=((e=((e=((e=(e-r)*a|0)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)|(t=((t=((t=((t=((t=(t-i)*a|0)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)<<1}function l(e,t,r,i,a,s,n,o){return(a-n)*(t-o)>=(e-n)*(s-o)&&(e-n)*(i-o)>=(r-n)*(t-o)&&(r-n)*(s-o)>=(a-n)*(i-o)}function u(e,t,r,i,a,s,n,o){return!(e===n&&t===o)&&l(e,t,r,i,a,s,n,o)}function h(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function c(e,t){return e.x===t.x&&e.y===t.y}function d(e,t,r,i){let a=f(h(e,t,r)),s=f(h(e,t,i)),n=f(h(r,i,e)),o=f(h(r,i,t));return!!(a!==s&&n!==o||0===a&&p(e,r,t)||0===s&&p(e,i,t)||0===n&&p(r,e,i)||0===o&&p(r,t,i))}function p(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function f(e){return e>0?1:e<0?-1:0}function m(e,t){return 0>h(e.prev,e,e.next)?h(e,t,e.next)>=0&&h(e,e.prev,t)>=0:0>h(e,t,e.prev)||0>h(e,e.next,t)}function g(e,t){let r=_(e.i,e.x,e.y),i=_(t.i,t.x,t.y),a=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function y(e,t,r,i){let a=_(e,t,r);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function v(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}t(e.exports,"default",()=>i)}),n("77SUz",function(e,r){t(e.exports,"default",()=>l);var i=s("eJ4LZ"),a=s("5XVOZ");let n={STATIC_DRAW:a.STATIC_DRAW,STREAM_DRAW:a.STREAM_DRAW,DYNAMIC_DRAW:a.DYNAMIC_DRAW};function o(e){switch(e){case a.ARRAY_BUFFER:return Float32Array;case a.ELEMENT_ARRAY_BUFFER:return Uint32Array;default:return Float32Array}}var l=class{constructor(e,t){this.array_=null,this.type_=e,(0,i.assert)(e===a.ARRAY_BUFFER||e===a.ELEMENT_ARRAY_BUFFER,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=void 0!==t?t:n.STATIC_DRAW}ofSize(e){return this.array_=new(o(this.type_))(e),this}fromArray(e){return this.array_=o(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(o(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){let t=o(this.type_);if(!(e instanceof t))throw Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}}),n("5XVOZ",function(e,r){t(e.exports,"ARRAY_BUFFER",()=>a),t(e.exports,"ELEMENT_ARRAY_BUFFER",()=>n),t(e.exports,"STREAM_DRAW",()=>o),t(e.exports,"STATIC_DRAW",()=>l),t(e.exports,"DYNAMIC_DRAW",()=>u),t(e.exports,"UNSIGNED_BYTE",()=>h),t(e.exports,"UNSIGNED_SHORT",()=>c),t(e.exports,"UNSIGNED_INT",()=>d),t(e.exports,"FLOAT",()=>p),t(e.exports,"getContext",()=>m);var i=s("lW8xZ");let a=34962,n=34963,o=35040,l=35044,u=35048,h=5121,c=5123,d=5125,p=5126,f=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function m(e,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!i.SAFARI_BUG_237906},t);let r=f.length;for(let i=0;i<r;++i)try{let r=e.getContext(f[i],t);if(r)return r}catch{}return null}}),n("knkkM",function(e,r){t(e.exports,"DefaultUniform",()=>d),t(e.exports,"AttributeType",()=>p),t(e.exports,"default",()=>v);var i=s("jjfV9"),a=s("kKEgb"),n=s("14PDX"),o=s("lVQul"),l=s("jYEYW"),u=s("6M4MS"),h=s("5XVOZ"),c=s("aMlwv");let d={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},p={UNSIGNED_BYTE:h.UNSIGNED_BYTE,UNSIGNED_SHORT:h.UNSIGNED_SHORT,UNSIGNED_INT:h.UNSIGNED_INT,FLOAT:h.FLOAT},f={},m=0;class g extends i.default{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?"shared/"+e.canvasCacheKey:function(){let e="unique/"+m;return m+=1,e}(),this.gl_=function(e){let t=f[e];if(!t){let r=document.createElement("canvas");r.width=1,r.height=1,r.style.position="absolute",r.style.left="0",t={users:0,context:(0,h.getContext)(r)},f[e]=t}return t.users+=1,t.context}(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;let t=this.gl_.canvas;t.addEventListener(u.default.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(u.default.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,n.create)(),this.offsetScaleMatrix_=(0,n.create)(),this.tmpMat4_=(0,l.create)(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(e=>new c.default({webGlContext:this.gl_,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})):[new c.default({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(let t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_==="shared/"+e}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];let t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){let t=this.gl_,r=(0,o.getUid)(e),i=this.bufferCache_[r];i||(i={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=i),t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){let t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){let t=(0,o.getUid)(e);delete this.bufferCache_[t]}disposeInternal(){let e=this.gl_.canvas;e.removeEventListener(u.default.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(u.default.RESTORED,this.boundHandleWebGLContextRestored_),function(e){let t=f[e];if(!t||(t.users-=1,t.users>0))return;let r=t.context,i=r.getExtension("WEBGL_lose_context");i&&i.loseContext();let a=r.canvas;a.width=1,a.height=1,delete f[e]}(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){let i=this.gl_,a=this.getCanvas(),s=e.size,n=e.pixelRatio;(a.width!==s[0]*n||a.height!==s[1]*n)&&(a.width=s[0]*n,a.height=s[1]*n,a.style.width=s[0]+"px",a.style.height=s[1]+"px");for(let t=this.postProcessPasses_.length-1;t>=0;t--)this.postProcessPasses_[t].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){let r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){let e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);let r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){let i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){let i=this.getGL();this.bindBuffer(e);let a=this.getAttributeLocation(t);i.enableVertexAttribArray(a),i.vertexAttribPointer(a,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){let a=this.gl_,s=t.getSize();a.bindFramebuffer(a.FRAMEBUFFER,t.getFramebuffer()),a.bindRenderbuffer(a.RENDERBUFFER,t.getDepthbuffer()),a.viewport(0,0,s[0],s[1]),a.bindTexture(a.TEXTURE_2D,t.getTexture()),a.clearColor(0,0,0,0),a.depthRange(0,1),a.clearDepth(1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,r?a.ZERO:a.ONE_MINUS_SRC_ALPHA),i?(a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST)}drawElements(e,t){let r=this.gl_;this.getExtension("OES_element_index_uint");let i=r.UNSIGNED_INT;r.drawElements(r.TRIANGLES,t-e,i,4*e)}finalizeDraw(e,t,r){for(let i=0,a=this.postProcessPasses_.length;i<a;i++)i===a-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){let t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(d.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(d.ZOOM,e.viewState.zoom),this.setUniformFloatValue(d.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(d.PIXEL_RATIO,i),this.setUniformFloatVec2(d.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(d.ROTATION,r)}applyHitDetectionUniform(e){let t=this.getUniformLocation(d.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(d.PIXEL_RATIO,.5)}applyUniforms(e){let t;let r=this.gl_,i=0;this.uniforms_.forEach(a=>{if((t="function"==typeof a.value?a.value(e):a.value)instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof ImageData||t instanceof WebGLTexture){t instanceof WebGLTexture&&!a.texture?(a.prevValue=void 0,a.texture=t):a.texture||(a.prevValue=void 0,a.texture=r.createTexture()),this.bindTexture(a.texture,i,a.name),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);let e=!(t instanceof HTMLImageElement)||t.complete;t instanceof WebGLTexture||!e||a.prevValue===t||(a.prevValue=t,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),i++}else if(Array.isArray(t)&&6===t.length)this.setUniformMatrixValue(a.name,(0,l.fromTransform)(this.tmpMat4_,t));else if(Array.isArray(t)&&t.length<=4)switch(t.length){case 2:r.uniform2f(this.getUniformLocation(a.name),t[0],t[1]);return;case 3:r.uniform3f(this.getUniformLocation(a.name),t[0],t[1],t[2]);return;case 4:r.uniform4f(this.getUniformLocation(a.name),t[0],t[1],t[2],t[3]);return;default:return}else"number"==typeof t&&r.uniform1f(this.getUniformLocation(a.name),t)})}useProgram(e,t){this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){let r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){let r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),a=this.compileShader(t,r.VERTEX_SHADER),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getShaderParameter(i,r.COMPILE_STATUS))throw Error(`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`);if(r.deleteShader(i),!r.getShaderParameter(a,r.COMPILE_STATUS))throw Error(`Vertex shader compilation failed: ${r.getShaderInfoLog(a)}`);if(r.deleteShader(a),!r.getProgramParameter(s,r.LINK_STATUS))throw Error(`GL program linking failed: ${r.getProgramInfoLog(s)}`);return s}getUniformLocation(e){let t=(0,o.getUid)(this.currentProgram_);return void 0===this.uniformLocationsByProgram_[t]&&(this.uniformLocationsByProgram_[t]={}),void 0===this.uniformLocationsByProgram_[t][e]&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){let t=(0,o.getUid)(this.currentProgram_);return void 0===this.attribLocationsByProgram_[t]&&(this.attribLocationsByProgram_[t]={}),void 0===this.attribLocationsByProgram_[t][e]&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){let r=e.size,i=e.viewState.rotation,a=e.viewState.resolution,s=e.viewState.center;return(0,n.compose)(t,0,0,2/(a*r[0]),2/(a*r[1]),-i,-s[0],-s[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,r,i,a){let s=this.getAttributeLocation(e);s<0||(this.gl_.enableVertexAttribArray(s),this.gl_.vertexAttribPointer(s,t,r,!1,i,a))}enableAttributes(e){let t=function(e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];t+=i.size*y(i.type)}return t}(e),r=0;for(let i=0;i<e.length;i++){let a=e[i];this.enableAttributeArray_(a.name,a.size,a.type||h.FLOAT,t,r),r+=a.size*y(a.type)}}handleWebGLContextLost(e){(0,a.clear)(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){let a=this.gl_;r=r||a.createTexture();let s=i?a.NEAREST:a.LINEAR;a.bindTexture(a.TEXTURE_2D,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);let n=a.RGBA,o=a.RGBA,l=a.UNSIGNED_BYTE;return t instanceof Uint8Array?a.texImage2D(a.TEXTURE_2D,0,n,e[0],e[1],0,o,l,t):t?a.texImage2D(a.TEXTURE_2D,0,n,o,l,t):a.texImage2D(a.TEXTURE_2D,0,n,e[0],e[1],0,o,l,null),r}}function y(e){switch(e){case p.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case p.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case p.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case p.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var v=g}),n("jYEYW",function(e,r){function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function a(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}t(e.exports,"create",()=>i),t(e.exports,"fromTransform",()=>a)}),n("6M4MS",function(e,r){t(e.exports,"default",()=>i);var i={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"}}),n("aMlwv",function(e,r){t(e.exports,"default",()=>o);var i=s("lVQul");let a=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,n=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;var o=class{constructor(e){this.gl_=e.webGlContext;let t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();let r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||a),t.compileShader(r);let i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||n),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(r=>{this.uniforms_.push({value:e.uniforms[r],location:t.getUniformLocation(this.renderTargetProgram_,r)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){let t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;let e=t.RGBA,i=t.RGBA,a=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,0,e,r[0],r[1],0,i,a,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,a){let s=this.getGL(),n=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){let t=(0,i.getUid)(s.canvas);if(!e.renderTargets[t]){let r=s.getContextAttributes();r&&r.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[t]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,n[0],n[1]),s.uniform1i(this.renderTargetTextureLocation_,0);let o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),a&&a(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){let t;let r=this.getGL(),i=1;this.uniforms_.forEach(function(a){if((t="function"==typeof a.value?a.value(e):a.value)instanceof HTMLCanvasElement||t instanceof ImageData)a.texture||(a.texture=r.createTexture()),r.activeTexture(r[`TEXTURE${i}`]),r.bindTexture(r.TEXTURE_2D,a.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),t instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,t.width,t.height,0,r.UNSIGNED_BYTE,new Uint8Array(t.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.uniform1i(a.location,i++);else if(Array.isArray(t))switch(t.length){case 2:r.uniform2f(a.location,t[0],t[1]);return;case 3:r.uniform3f(a.location,t[0],t[1],t[2]);return;case 4:r.uniform4f(a.location,t[0],t[1],t[2],t[3]);return;default:return}else"number"==typeof t&&r.uniform1f(a.location,t)})}}}),n("4WkA9",function(e,r){t(e.exports,"default",()=>n);var i=s("kBSVF");let a=new Uint8Array(4);var n=class{constructor(e,t){this.helper_=e;let r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){(0,i.equals)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){let e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a;this.readAll();let r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return a[0]=this.data_[4*r],a[1]=this.data_[4*r+1],a[2]=this.data_[4*r+2],a[3]=this.data_[4*r+3],a}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){let e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}}),n("6AH2e",function(e,r){t(e.exports,"create",()=>a);var i=s("awmEs").Buffer;function a(){let e='const t="GENERATE_POLYGON_BUFFERS",e="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS";function r(t,e,n=2){const r=e&&e.length,o=r?e[0]*n:t.length;let u=x(t,0,o,n,!0);const f=[];if(!u||u.next===u.prev)return f;let s,l,h;if(r&&(u=function(t,e,n,r){const o=[];for(let n=0,i=e.length;n<i;n++){const u=x(t,e[n]*r,n<i-1?e[n+1]*r:t.length,r,!1);u===u.next&&(u.steiner=!0),o.push(p(u))}o.sort(c);for(let t=0;t<o.length;t++)n=a(o[t],n);return n}(t,e,u,n)),t.length>80*n){s=1/0,l=1/0;let e=-1/0,r=-1/0;for(let x=n;x<o;x+=n){const n=t[x],o=t[x+1];n<s&&(s=n),o<l&&(l=o),n>e&&(e=n),o>r&&(r=o)}h=Math.max(e-s,r-l),h=0!==h?32767/h:0}return i(u,f,n,s,l,h,0),f}function x(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=I(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=I(x/r|0,t[x],t[x+1],o);return o&&m(o,o.next)&&(z(o),o=o.next),o}function o(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==M(r.prev,r,r.next))r=r.next;else{if(z(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,r,x,c,a){if(!t)return;!a&&c&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=y(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,u=0;for(let t=0;t<n&&(u++,i=i.nextZ,i);t++);let f=n;for(;u>0||f>0&&i;)0!==u&&(0===f||!i||x.z<=i.z)?(r=x,x=x.nextZ,u--):(r=i,i=i.nextZ,f--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,r,x,c);let h=t;for(;t.prev!==t.next;){const y=t.prev,p=t.next;if(c?f(t,r,x,c):u(t))e.push(y.i,t.i,p.i),z(t),t=p.next,h=p.next;else if((t=p)===h){a?1===a?i(t=s(o(t),e),e,n,r,x,c,2):2===a&&l(t,e,n,r,x,c):i(o(t),e,n,r,x,c,1);break}}}function u(t){const e=t.prev,n=t,r=t.next;if(M(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,u=e.y,f=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(u,f,s),a=Math.max(x,o,i),h=Math.max(u,f,s);let y=r.next;for(;y!==e;){if(y.x>=l&&y.x<=a&&y.y>=c&&y.y<=h&&g(x,u,o,f,i,s,y.x,y.y)&&M(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function f(t,e,n,r){const x=t.prev,o=t,i=t.next;if(M(x,o,i)>=0)return!1;const u=x.x,f=o.x,s=i.x,l=x.y,c=o.y,a=i.y,h=Math.min(u,f,s),p=Math.min(l,c,a),v=Math.max(u,f,s),b=Math.max(l,c,a),m=y(h,p,e,n,r),Z=y(v,b,e,n,r);let d=t.prevZ,w=t.nextZ;for(;d&&d.z>=m&&w&&w.z<=Z;){if(d.x>=h&&d.x<=v&&d.y>=p&&d.y<=b&&d!==x&&d!==i&&g(u,l,f,c,s,a,d.x,d.y)&&M(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,w.x>=h&&w.x<=v&&w.y>=p&&w.y<=b&&w!==x&&w!==i&&g(u,l,f,c,s,a,w.x,w.y)&&M(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;d&&d.z>=m;){if(d.x>=h&&d.x<=v&&d.y>=p&&d.y<=b&&d!==x&&d!==i&&g(u,l,f,c,s,a,d.x,d.y)&&M(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;w&&w.z<=Z;){if(w.x>=h&&w.x<=v&&w.y>=p&&w.y<=b&&w!==x&&w!==i&&g(u,l,f,c,s,a,w.x,w.y)&&M(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function s(t,e){let n=t;do{const r=n.prev,x=n.next.next;!m(r,x)&&Z(r,n,n.next,x)&&A(r,x)&&A(x,r)&&(e.push(r.i,n.i,x.i),z(n),z(n.next),n=t=x),n=n.next}while(n!==t);return o(n)}function l(t,e,n,r,x,u){let f=t;do{let t=f.next.next;for(;t!==f.prev;){if(f.i!==t.i&&b(f,t)){let s=E(f,t);return f=o(f,f.next),s=o(s,s.next),i(f,e,n,r,x,u,0),void i(s,e,n,r,x,u,0)}t=t.next}f=f.next}while(f!==t)}function c(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function a(t,e){const n=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(m(t,n))return n;do{if(m(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const u=o,f=o.x,s=o.y;let l=1/0;n=o;do{if(r>=n.x&&n.x>=f&&r!==n.x&&v(x<s?r:i,x,f,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);A(n,t)&&(e<l||e===l&&(n.x>o.x||n.x===o.x&&h(o,n)))&&(o=n,l=e)}n=n.next}while(n!==u);return o}(t,e);if(!n)return e;const r=E(n,t);return o(r,r.next),o(n,n.next)}function h(t,e){return M(t.prev,t,e.prev)<0&&M(e.next,t,t.next)<0}function y(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,x,o,i,u){return(x-i)*(e-u)>=(t-i)*(o-u)&&(t-i)*(r-u)>=(n-i)*(e-u)&&(n-i)*(o-u)>=(x-i)*(r-u)}function g(t,e,n,r,x,o,i,u){return!(t===i&&e===u)&&v(t,e,n,r,x,o,i,u)}function b(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Z(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(A(t,e)&&A(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(M(t.prev,t,e.prev)||M(t,e.prev,e))||m(t,e)&&M(t.prev,t,t.next)>0&&M(e.prev,e,e.next)>0)}function M(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function Z(t,e,n,r){const x=w(M(t,e,n)),o=w(M(t,e,r)),i=w(M(n,r,t)),u=w(M(n,r,e));return x!==o&&i!==u||(!(0!==x||!d(t,n,e))||(!(0!==o||!d(t,r,e))||(!(0!==i||!d(n,t,r))||!(0!==u||!d(n,e,r)))))}function d(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function A(t,e){return M(t.prev,t,t.next)<0?M(t,e,t.next)>=0&&M(t,t.prev,e)>=0:M(t,e,t.prev)<0||M(t,t.next,e)<0}function E(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function I(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function z(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function P(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function B(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5];return t[0]=u/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-u*f)/n,t[5]=-(x*s-o*f)/n,t}new Array(6);const N=[],R={vertexPosition:0,indexPosition:0};function S(t,e,n,r,x){t[e+0]=n,t[e+1]=r,t[e+2]=x}function T(t,e,n,r,x,o){const i=3+x,u=t[e+0],f=t[e+1],s=N;s.length=x;for(let n=0;n<s.length;n++)s[n]=t[e+2+n];let l=o?o.vertexPosition:0,c=o?o.indexPosition:0;const a=l/i;return S(n,l,u,f,0),s.length&&n.set(s,l+3),l+=i,S(n,l,u,f,1),s.length&&n.set(s,l+3),l+=i,S(n,l,u,f,2),s.length&&n.set(s,l+3),l+=i,S(n,l,u,f,3),s.length&&n.set(s,l+3),l+=i,r[c++]=a,r[c++]=a+1,r[c++]=a+3,r[c++]=a+1,r[c++]=a+2,r[c++]=a+3,R.vertexPosition=l,R.indexPosition=c,R}function _(t,e,n,r,x,o,i,u,f,s,l){const c=10+u.length,a=o.length/c,h=[t[e+0],t[e+1]],y=[t[n],t[n+1]],p=t[e+2],v=t[n+2],g=P(f,[...h]),b=P(f,[...y]);function M(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),u=[(n[0]-t[0])/i,(n[1]-t[1])/i],f=0===r||0===i?0:Math.acos((s=u[0]*x[0]+u[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;return u[0]*o[0]+u[1]*o[1]>0?f:2*Math.PI-f}let m=-1,Z=-1,d=l;const w=null!==x;if(null!==r){m=M(g,b,P(f,[...[t[r],t[r+1]]])),Math.cos(m)<=.985&&(d+=Math.tan((m-Math.PI)/2))}if(w){Z=M(b,g,P(f,[...[t[x],t[x+1]]])),Math.cos(Z)<=.985&&(d+=Math.tan((Math.PI-Z)/2))}function A(t,e){return 0===e?1e4*t:Math.sign(e)*(1e4*t+Math.abs(e))}return o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(0,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(1,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(2,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(3,l)),o.push(...u),i.push(a,a+1,a+2,a+1,a+3,a+2),{length:s+Math.sqrt((b[0]-g[0])*(b[0]-g[0])+(b[1]-g[1])*(b[1]-g[1])),angle:d}}function O(t,e,n,x,o){const i=2+o;let u=e;const f=t.slice(u,u+o);u+=o;const s=t[u++];let l=0;const c=new Array(s-1);for(let e=0;e<s;e++)l+=t[u++],e<s-1&&(c[e]=l);const a=t.slice(u,u+2*l),h=r(a,c,2);for(let t=0;t<h.length;t++)x.push(h[t]+n.length/i);for(let t=0;t<a.length;t+=2)n.push(a[t],a[t+1],...f);return u+2*l}const U=self;U.onmessage=r=>{const x=r.data;switch(x.type){case e:{const t=3,e=2,n=x.customAttributesSize,r=e+n,o=new Float32Array(x.renderInstructions),i=o.length/r,u=4*i*(n+t),f=new Uint32Array(6*i),s=new Float32Array(u);let l;for(let t=0;t<o.length;t+=r)l=T(o,t,s,f,n,l);const c=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:o.buffer},x);U.postMessage(c,[s.buffer,f.buffer,o.buffer]);break}case n:{const t=[],e=[],n=x.customAttributesSize,r=3,o=new Float32Array(x.renderInstructions);let i=0;const u=[1,0,0,1,0,0];let f,s;for(B(u,x.renderInstructionsTransform);i<o.length;){s=Array.from(o.slice(i,i+n)),i+=n,f=o[i++];const x=i,l=i+(f-1)*r,c=o[x]===o[l]&&o[x+1]===o[l+1];let a=0,h=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=i+(n-1)*r:c&&(y=l-r);let p=null;n<f-2?p=i+(n+2)*r:c&&(p=x+r);const v=_(o,i+n*r,i+(n+1)*r,y,p,t,e,s,u,a,h);a=v.length,h=v.angle}i+=f*r}const l=Uint32Array.from(e),c=Float32Array.from(t),a=Object.assign({vertexBuffer:c.buffer,indexBuffer:l.buffer,renderInstructions:o.buffer},x);U.postMessage(a,[c.buffer,l.buffer,o.buffer]);break}case t:{const t=[],e=[],n=x.customAttributesSize,r=new Float32Array(x.renderInstructions);let o=0;for(;o<r.length;)o=O(r,o,t,e,n);const i=Uint32Array.from(e),u=Float32Array.from(t),f=Object.assign({vertexBuffer:u.buffer,indexBuffer:i.buffer,renderInstructions:r.buffer},x);U.postMessage(f,[u.buffer,i.buffer,r.buffer]);break}}};';return new Worker("undefined"==typeof Blob?"data:application/javascript;base64,"+i.from(e,"binary").toString("base64"):URL.createObjectURL(new Blob([e],{type:"application/javascript"})))}}),n("awmEs",function(e,r){t(e.exports,"Buffer",()=>i,e=>i=e),t(e.exports,"INSPECT_MAX_BYTES",()=>a,e=>a=e);var i,a,n=s("cK8LV"),o=s("7y6mg");let l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function u(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,h.prototype),t}function h(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return p(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!h.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|y(e,t),i=u(r),a=i.write(e,t);return a!==r&&(i=i.slice(0,a)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(q(e,Uint8Array)){let t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(q(e,ArrayBuffer)||e&&q(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(q(e,SharedArrayBuffer)||e&&q(e.buffer,SharedArrayBuffer)))return m(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return h.from(i,t,r);let a=function(e){var t;if(h.isBuffer(e)){let t=0|g(e.length),r=u(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?u(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return d(e),u(e<0?0:0|g(e))}function f(e){let t=e.length<0?0:0|g(e.length),r=u(t);for(let i=0;i<t;i+=1)r[i]=255&e[i];return r}function m(e,t,r){let i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),h.prototype),i}function g(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function y(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let a=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(a)return i?-1:F(e).length;t=(""+t).toLowerCase(),a=!0}}function v(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let a="";for(let i=t;i<r;++i)a+=j[e[i]];return a}(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return function(e,t,r){let i="";r=Math.min(e.length,r);for(let a=t;a<r;++a)i+=String.fromCharCode(127&e[a]);return i}(this,t,r);case"latin1":case"binary":return function(e,t,r){let i="";r=Math.min(e.length,r);for(let a=t;a<r;++a)i+=String.fromCharCode(e[a]);return i}(this,t,r);case"base64":var a,s;return a=t,s=r,0===a&&s===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(a,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let i=e.slice(t,r),a="";for(let e=0;e<i.length-1;e+=2)a+=String.fromCharCode(i[e]+256*i[e+1]);return a}(this,t,r);default:if(i)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function _(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function x(e,t,r,i,a){var s;if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(s=r=+r)!=s&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return -1;r=e.length-1}else if(r<0){if(!a)return -1;r=0}if("string"==typeof t&&(t=h.from(t,i)),h.isBuffer(t))return 0===t.length?-1:b(e,t,r,i,a);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,i,a);throw TypeError("val must be string, number or Buffer")}function b(e,t,r,i,a){let s,n=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;n=2,o/=2,l/=2,r/=2}function u(e,t){return 1===n?e[t]:e.readUInt16BE(t*n)}if(a){let i=-1;for(s=r;s<o;s++)if(u(e,s)===u(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===l)return i*n}else -1!==i&&(s-=s-i),i=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){let r=!0;for(let i=0;i<l;i++)if(u(e,s+i)!==u(t,i)){r=!1;break}if(r)return s}return -1}function S(e,t,r){r=Math.min(e.length,r);let i=[],a=t;for(;a<r;){let t=e[a],s=null,n=t>239?4:t>223?3:t>191?2:1;if(a+n<=r){let r,i,o,l;switch(n){case 1:t<128&&(s=t);break;case 2:(192&(r=e[a+1]))==128&&(l=(31&t)<<6|63&r)>127&&(s=l);break;case 3:r=e[a+1],i=e[a+2],(192&r)==128&&(192&i)==128&&(l=(15&t)<<12|(63&r)<<6|63&i)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:r=e[a+1],i=e[a+2],o=e[a+3],(192&r)==128&&(192&i)==128&&(192&o)==128&&(l=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&o)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,n=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),a+=n}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}function w(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function E(e,t,r,i,a,s){if(!h.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<s)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function A(e,t,r,i,a){M(t,i,a,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let n=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=n,n>>=8,e[r++]=n,n>>=8,e[r++]=n,n>>=8,e[r++]=n,r}function T(e,t,r,i,a){M(t,i,a,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let n=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=n,n>>=8,e[r+2]=n,n>>=8,e[r+1]=n,n>>=8,e[r]=n,r+8}function C(e,t,r,i,a,s){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function P(e,t,r,i,a){return t=+t,r>>>=0,a||C(e,t,r,4,34028234663852886e22,-34028234663852886e22),o.write(e,t,r,i,23,4),r+4}function R(e,t,r,i,a){return t=+t,r>>>=0,a||C(e,t,r,8,17976931348623157e292,-17976931348623157e292),o.write(e,t,r,i,52,8),r+8}i=h,a=50,h.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),h.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(e,t,r){return(d(e),e<=0)?u(e):void 0!==t?"string"==typeof r?u(e).fill(t,r):u(e).fill(t):u(e)},h.allocUnsafe=function(e){return p(e)},h.allocUnsafeSlow=function(e){return p(e)},h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(q(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),q(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let a=0,s=Math.min(r,i);a<s;++a)if(e[a]!==t[a]){r=e[a],i=t[a];break}return r<i?-1:i<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let i=h.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){let t=e[r];if(q(t,Uint8Array))a+t.length>i.length?(h.isBuffer(t)||(t=h.from(t)),t.copy(i,a)):Uint8Array.prototype.set.call(i,t,a);else if(h.isBuffer(t))t.copy(i,a);else throw TypeError('"list" argument must be an Array of Buffers');a+=t.length}return i},h.byteLength=y,h.prototype._isBuffer=!0,h.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)_(this,t,t+1);return this},h.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},h.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},h.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?S(this,0,e):v.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(e){if(!h.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){let e="",t=a;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},l&&(h.prototype[l]=h.prototype.inspect),h.prototype.compare=function(e,t,r,i,a){if(q(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===a&&(a=this.length),t<0||r>e.length||i<0||a>this.length)throw RangeError("out of range index");if(i>=a&&t>=r)return 0;if(i>=a)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,a>>>=0,this===e)return 0;let s=a-i,n=r-t,o=Math.min(s,n),l=this.slice(i,a),u=e.slice(t,r);for(let e=0;e<o;++e)if(l[e]!==u[e]){s=l[e],n=u[e];break}return s<n?-1:n<s?1:0},h.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return x(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return x(this,e,t,r,!1)},h.prototype.write=function(e,t,r,i){var a,s,n,o,l,u,h,c;if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let p=!1;for(;;)switch(i){case"hex":return function(e,t,r,i){let a;r=Number(r)||0;let s=e.length-r;i?(i=Number(i))>s&&(i=s):i=s;let n=t.length;for(i>n/2&&(i=n/2),a=0;a<i;++a){let i=parseInt(t.substr(2*a,2),16);if(i!=i)break;e[r+a]=i}return a}(this,e,t,r);case"utf8":case"utf-8":return a=t,s=r,z(F(e,this.length-a),this,a,s);case"ascii":case"latin1":case"binary":return n=t,o=r,z(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,n,o);case"base64":return l=t,u=r,z(G(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=t,c=r,z(function(e,t){let r,i;let a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,a.push(r%256),a.push(i);return a}(e,this.length-h),this,h,c);default:if(p)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),p=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,h.prototype),i},h.prototype.readUintLE=h.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);let i=this[e],a=1,s=0;for(;++s<t&&(a*=256);)i+=this[e+s]*a;return i},h.prototype.readUintBE=h.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);let i=this[e+--t],a=1;for(;t>0&&(a*=256);)i+=this[e+--t]*a;return i},h.prototype.readUint8=h.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readBigUInt64LE=B(function(e){k(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&N(e,this.length-8);let i=t+256*this[++e]+65536*this[++e]+16777216*this[++e],a=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(i)+(BigInt(a)<<BigInt(32))}),h.prototype.readBigUInt64BE=B(function(e){k(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&N(e,this.length-8);let i=16777216*t+65536*this[++e]+256*this[++e]+this[++e],a=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(i)<<BigInt(32))+BigInt(a)}),h.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);let i=this[e],a=1,s=0;for(;++s<t&&(a*=256);)i+=this[e+s]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},h.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);let i=t,a=1,s=this[e+--i];for(;i>0&&(a*=256);)s+=this[e+--i]*a;return s>=(a*=128)&&(s-=Math.pow(2,8*t)),s},h.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readBigInt64LE=B(function(e){k(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&N(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),h.prototype.readBigInt64BE=B(function(e){k(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&N(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),h.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),o.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),o.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),o.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),o.read(this,e,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}let a=1,s=0;for(this[t]=255&e;++s<r&&(a*=256);)this[t+s]=e/a&255;return t+r},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}let a=r-1,s=1;for(this[t+a]=255&e;--a>=0&&(s*=256);)this[t+a]=e/s&255;return t+r},h.prototype.writeUint8=h.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigUInt64LE=B(function(e,t=0){return A(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeBigUInt64BE=B(function(e,t=0){return T(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}let a=0,s=1,n=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===n&&0!==this[t+a-1]&&(n=1),this[t+a]=(e/s>>0)-n&255;return t+r},h.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}let a=r-1,s=1,n=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===n&&0!==this[t+a+1]&&(n=1),this[t+a]=(e/s>>0)-n&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigInt64LE=B(function(e,t=0){return A(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeBigInt64BE=B(function(e,t=0){return T(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeFloatLE=function(e,t,r){return P(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return P(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return R(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return R(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,i){if(!h.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);let a=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),a},h.prototype.fill=function(e,t,r,i){let a;if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){let t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{let s=h.isBuffer(e)?e:h.from(e,i),n=s.length;if(0===n)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%n]}return this};let I={};function L(e,t,r){I[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function O(e){let t="",r=e.length,i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function M(e,t,r,i,a,s){if(e>r||e<t){let i;let a="bigint"==typeof t?"n":"";throw i=s>3?0===t||t===BigInt(0)?`>= 0${a} and < 2${a} ** ${(s+1)*8}${a}`:`>= -(2${a} ** ${(s+1)*8-1}${a}) and < 2 ** ${(s+1)*8-1}${a}`:`>= ${t}${a} and <= ${r}${a}`,new I.ERR_OUT_OF_RANGE("value",i,e)}k(a,"offset"),(void 0===i[a]||void 0===i[a+s])&&N(a,i.length-(s+1))}function k(e,t){if("number"!=typeof e)throw new I.ERR_INVALID_ARG_TYPE(t,"number",e)}function N(e,t,r){if(Math.floor(e)!==e)throw k(e,r),new I.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new I.ERR_BUFFER_OUT_OF_BOUNDS;throw new I.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}L("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),L("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),L("ERR_OUT_OF_RANGE",function(e,t,r){let i=`The value of "${e}" is out of range.`,a=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?a=O(String(r)):"bigint"==typeof r&&(a=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(a=O(a)),a+="n"),i+=` It must be ${t}. Received ${a}`},RangeError);let D=/[^+/0-9A-Za-z-_]/g;function F(e,t){let r;t=t||1/0;let i=e.length,a=null,s=[];for(let n=0;n<i;++n){if((r=e.charCodeAt(n))>55295&&r<57344){if(!a){if(r>56319||n+1===i){(t-=3)>-1&&s.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(t-=3)>-1&&s.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,i){let a;for(a=0;a<i&&!(a+r>=t.length)&&!(a>=e.length);++a)t[a+r]=e[a];return a}function q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let j=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let i=16*r;for(let a=0;a<16;++a)t[i+a]=e[r]+e[a]}return t}();function B(e){return"undefined"==typeof BigInt?U:e}function U(){throw Error("BigInt not supported")}}),n("cK8LV",function(e,r){t(e.exports,"toByteArray",()=>i,e=>i=e),t(e.exports,"fromByteArray",()=>a,e=>a=e),i=function(e){var t,r,i=function(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}(e),a=i[0],s=i[1],l=new o((a+s)*3/4-s),u=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},a=function(e){for(var t,r=e.length,i=r%3,a=[],n=0,o=r-i;n<o;n+=16383)a.push(function(e,t,r){for(var i,a=[],n=t;n<r;n+=3)a.push(s[(i=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(255&e[n+2]))>>18&63]+s[i>>12&63]+s[i>>6&63]+s[63&i]);return a.join("")}(e,n,n+16383>o?o:n+16383));return 1===i?a.push(s[(t=e[r-1])>>2]+s[t<<4&63]+"=="):2===i&&a.push(s[(t=(e[r-2]<<8)+e[r-1])>>10]+s[t>>4&63]+s[t<<2&63]+"="),a.join("")};for(var i,a,s=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,h=l.length;u<h;++u)s[u]=l[u],n[l.charCodeAt(u)]=u;n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63}),n("7y6mg",function(e,r){var i,a;t(e.exports,"read",()=>i,e=>i=e),t(e.exports,"write",()=>a,e=>a=e),i=function(e,t,r,i,a){var s,n,o=8*a-i-1,l=(1<<o)-1,u=l>>1,h=-7,c=r?a-1:0,d=r?-1:1,p=e[t+c];for(c+=d,s=p&(1<<-h)-1,p>>=-h,h+=o;h>0;s=256*s+e[t+c],c+=d,h-=8);for(n=s&(1<<-h)-1,s>>=-h,h+=i;h>0;n=256*n+e[t+c],c+=d,h-=8);if(0===s)s=1-u;else{if(s===l)return n?NaN:1/0*(p?-1:1);n+=Math.pow(2,i),s-=u}return(p?-1:1)*n*Math.pow(2,s-i)},a=function(e,t,r,i,a,s){var n,o,l,u=8*s-a-1,h=(1<<u)-1,c=h>>1,d=23===a?5960464477539062e-23:0,p=i?0:s-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(o=isNaN(t)?1:0,n=h):(n=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-n))<1&&(n--,l*=2),n+c>=1?t+=d/l:t+=d*Math.pow(2,1-c),t*l>=2&&(n++,l/=2),n+c>=h?(o=0,n=h):n+c>=1?(o=(t*l-1)*Math.pow(2,a),n+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,a),n=0));a>=8;e[r+p]=255&o,p+=f,o/=256,a-=8);for(n=n<<a|o,u+=a;u>0;e[r+p]=255&n,p+=f,n/=256,u-=8);e[r+p-f]|=128*m}}),n("iHIuK",function(e,r){t(e.exports,"default",()=>c);var i=s("7xQTT"),a=s("fj1q7"),n=s("6ej6F"),o=s("14PDX"),l=s("knkkM"),u=s("lgqLq");class h extends u.default{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=(0,o.create)(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(i.default.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){let r=this.getLayer();if(r.hasListener(n.default.PRECOMPOSE)){let i=new a.default(n.default.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){let r=this.getLayer();if(r.hasListener(n.default.POSTCOMPOSE)){let i=new a.default(n.default.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t,r=!0,i=-1;for(let a=0,s=e.layerStatesArray.length;a<s;a++){let s=e.layerStatesArray[a].layer,n=s.getRenderer();if(!(n instanceof h)){r=!0;continue}let o=s.getClassName();if((r||o!==t)&&(i+=1,r=!1),t=o,n===this)break}let a="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(a)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new l.default({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:a}),t&&(this.helper.getCanvas().className=t),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(i.default.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){let i=this.getLayer();if(i.hasListener(e)){(0,o.compose)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);let s=new a.default(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(n.default.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(n.default.POSTRENDER,e,t)}}var c=h}),n("hQEK0",function(e,r){t(e.exports,"getWorldParameters",()=>a);var i=s("jZquI");function a(e,t){let r=e.viewState.projection,a=t.getSource().getWrapX()&&r.canWrapX(),s=r.getExtent(),n=e.extent,o=a?(0,i.getWidth)(s):null,l=a?Math.ceil((n[2]-s[2])/o)+1:1;return[a?Math.floor((n[0]-s[0])/o):0,l,o]}}),n("2q51R",function(e,r){t(e.exports,"ShaderBuilder",()=>u);var i=s("avk8s"),a=s("bxq6G"),n=s("77Abf");let o=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders
`,l=(0,n.createDefaultStyle)();class u{constructor(){this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${(0,i.numberToGlsl)(l["circle-radius"])} + ${(0,i.numberToGlsl)(.5*l["circle-stroke-width"])})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=(0,i.colorToGlsl)(l["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=(0,i.numberToGlsl)(l["stroke-width"]),this.strokeColorExpression_=(0,i.colorToGlsl)(l["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=(0,i.stringToGlsl)("round"),this.strokeJoinExpression_=(0,i.stringToGlsl)("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=(0,i.colorToGlsl)(l["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e){return this.uniforms_.push(e),this}addAttribute(e){return this.attributes_.push(e),this}addVarying(e,t,r){return this.varyings_.push({name:e,type:t,expression:r}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){this.vertexShaderFunctions_.includes(e)||this.vertexShaderFunctions_.push(e)}addFragmentShaderFunction(e){this.fragmentShaderFunctions_.includes(e)||this.fragmentShaderFunctions_.push(e)}getSymbolVertexShader(){return this.hasSymbol_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
attribute vec2 a_position;
attribute float a_index;
attribute vec4 a_hitColor;
${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.vertexShaderFunctions_.join("\n")}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx;
  if (a_index == 0.0) {
    offsetPx -= halfSizePx;
  } else if (a_index == 1.0) {
    offsetPx += halfSizePx * vec2(1., -1.);
  } else if (a_index == 2.0) {
    offsetPx += halfSizePx;
  } else {
    offsetPx += halfSizePx * vec2(-1., 1.);
  }
  float angle = ${this.symbolRotationExpression_};
  ${this.symbolRotateWithView_?"angle += u_rotation;":""}
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  v_hitColor = a_hitColor;
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y); 
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.fragmentShaderFunctions_.join("\n")}

void main(void) {
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_parameters;
attribute float a_distance;
attribute vec2 a_joinAngles;
attribute vec4 a_hitColor;
${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.vertexShaderFunctions_.join("\n")}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);
  currentLineMetric = vertexNumber < 1.5 ? a_measureStart : a_measureEnd;
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)
  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);
  
  // compute current vertex position
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 joinDirection;
  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${a.LINESTRING_ANGLE_COSINE_CUTOFF} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStart = segmentStartPx;
  v_segmentEnd = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = a_hitColor;
  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);
  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.fragmentShaderFunctions_.join("\n")}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${a.LINESTRING_ANGLE_COSINE_CUTOFF}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${(0,i.stringToGlsl)("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${(0,i.stringToGlsl)("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${(0,i.stringToGlsl)("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${(0,i.stringToGlsl)("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

void main(void) {
  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLength = length(v_segmentEnd - v_segmentStart);
  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPoint = currentPoint - v_segmentStart;
  float lengthToPoint = max(0., min(dot(segmentTangent, startToPoint), segmentLength));
  float currentLengthPx = lengthToPoint + v_distanceOffsetPx; 
  float currentRadiusPx = abs(dot(segmentNormal, startToPoint));
  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPoint / segmentLength);

  if (${this.discardExpression_}) { discard; }

  vec4 color = ${this.strokeColorExpression_};
  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);
  float distance = max(
    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distance = max(distance, ${this.strokeDistanceFieldExpression_});
  color.a *= smoothstep(0.5, -0.5, distance);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
attribute vec2 a_position;
attribute vec4 a_hitColor;
${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}
varying vec4 v_hitColor;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.vertexShaderFunctions_.join("\n")}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = a_hitColor;
${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}
}`:null}getFillFragmentShader(){return this.hasFill_?`${o}
${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}
varying vec4 v_hitColor;
${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}
${this.fragmentShaderFunctions_.join("\n")}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}}),n("avk8s",function(e,r){t(e.exports,"numberToGlsl",()=>u),t(e.exports,"colorToGlsl",()=>c),t(e.exports,"stringToGlsl",()=>f);var i=s("lqNjm"),a=s("dAsIA"),n=s("6BjcK"),o=s("bzfCn"),l=s("3oUFG");function u(e){let t=e.toString();return t.includes(".")?t:t+".0"}function h(e){if(e.length<2||e.length>4)throw Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${e.length}(${e.map(u).join(", ")})`}function c(e){let t=(0,i.asArray)(e),r=t.length>3?t[3]:1;return h([t[0]/255,t[1]/255,t[2]/255,r])}let d={},p=0;function f(e){return u((e in d||(d[e]=p++),d[e]))}let m="getBandValue";function g(e){return(t,r,i)=>{let a=r.args.length,s=Array(a);for(let e=0;e<a;++e)s[e]=v(r.args[e],i,t);return e(s,t)}}let y={[l.Ops.Get]:(e,t)=>{let r=t.args[0].value;return r in e.properties||(e.properties[r]={name:r,type:t.type}),(e.inFragmentShader?"v_prop_":"a_prop_")+r},[l.Ops.Id]:e=>(e.featureId=!0,(e.inFragmentShader?"v_":"a_")+"featureId"),[l.Ops.GeometryType]:e=>(e.geometryType=!0,(e.inFragmentShader?"v_":"a_")+"geometryType"),[l.Ops.LineMetric]:()=>"currentLineMetric",[l.Ops.Var]:(e,t)=>{let r=t.args[0].value;return r in e.variables||(e.variables[r]={name:r,type:t.type}),"u_var_"+r},[l.Ops.Resolution]:()=>"u_resolution",[l.Ops.Zoom]:()=>"u_zoom",[l.Ops.Time]:()=>"u_time",[l.Ops.Any]:g(e=>`(${e.join(" || ")})`),[l.Ops.All]:g(e=>`(${e.join(" && ")})`),[l.Ops.Not]:g(([e])=>`(!${e})`),[l.Ops.Equal]:g(([e,t])=>`(${e} == ${t})`),[l.Ops.NotEqual]:g(([e,t])=>`(${e} != ${t})`),[l.Ops.GreaterThan]:g(([e,t])=>`(${e} > ${t})`),[l.Ops.GreaterThanOrEqualTo]:g(([e,t])=>`(${e} >= ${t})`),[l.Ops.LessThan]:g(([e,t])=>`(${e} < ${t})`),[l.Ops.LessThanOrEqualTo]:g(([e,t])=>`(${e} <= ${t})`),[l.Ops.Multiply]:g(e=>`(${e.join(" * ")})`),[l.Ops.Divide]:g(([e,t])=>`(${e} / ${t})`),[l.Ops.Add]:g(e=>`(${e.join(" + ")})`),[l.Ops.Subtract]:g(([e,t])=>`(${e} - ${t})`),[l.Ops.Clamp]:g(([e,t,r])=>`clamp(${e}, ${t}, ${r})`),[l.Ops.Mod]:g(([e,t])=>`mod(${e}, ${t})`),[l.Ops.Pow]:g(([e,t])=>`pow(${e}, ${t})`),[l.Ops.Abs]:g(([e])=>`abs(${e})`),[l.Ops.Floor]:g(([e])=>`floor(${e})`),[l.Ops.Ceil]:g(([e])=>`ceil(${e})`),[l.Ops.Round]:g(([e])=>`floor(${e} + 0.5)`),[l.Ops.Sin]:g(([e])=>`sin(${e})`),[l.Ops.Cos]:g(([e])=>`cos(${e})`),[l.Ops.Atan]:g(([e,t])=>void 0!==t?`atan(${e}, ${t})`:`atan(${e})`),[l.Ops.Sqrt]:g(([e])=>`sqrt(${e})`),[l.Ops.Match]:g(e=>{let t=e[0],r=e[e.length-1],i=null;for(let a=e.length-3;a>=1;a-=2){let s=e[a],n=e[a+1];i=`(${t} == ${s} ? ${n} : ${i||r})`}return i}),[l.Ops.Between]:g(([e,t,r])=>`(${e} >= ${t} && ${e} <= ${r})`),[l.Ops.Interpolate]:g(([e,t,...r])=>{let i="";for(let a=0;a<r.length-2;a+=2){let s;let n=r[a],o=i||r[a+1],l=r[a+2],h=r[a+3];s=e===u(1)?`(${t} - ${n}) / (${l} - ${n})`:`(pow(${e}, (${t} - ${n})) - 1.0) / (pow(${e}, (${l} - ${n})) - 1.0)`,i=`mix(${o}, ${h}, clamp(${s}, 0.0, 1.0))`}return i}),[l.Ops.Case]:g(e=>{let t=e[e.length-1],r=null;for(let i=e.length-3;i>=0;i-=2){let a=e[i],s=e[i+1];r=`(${a} ? ${s} : ${r||t})`}return r}),[l.Ops.In]:g(([e,...t],r)=>{let i=`operator_in_${Object.keys(r.functions).length}`,a=[];for(let e=0;e<t.length;e+=1)a.push(`  if (inputValue == ${t[e]}) { return true; }`);return r.functions[i]=`bool ${i}(float inputValue) {
${a.join("\n")}
  return false;
}`,`${i}(${e})`}),[l.Ops.Array]:g(e=>`vec${e.length}(${e.join(", ")})`),[l.Ops.Color]:g(e=>{if(1===e.length)return`vec4(vec3(${e[0]} / 255.0), 1.0)`;if(2===e.length)return`vec4(vec3(${e[0]} / 255.0), ${e[1]})`;let t=e.slice(0,3).map(e=>`${e} / 255.0`);if(3===e.length)return`vec4(${t.join(", ")}, 1.0)`;let r=e[3];return`vec4(${t.join(", ")}, ${r})`}),[l.Ops.Band]:g(([e,t,r],i)=>{if(!(m in i.functions)){let e="",t=i.bandCount||1;for(let r=0;r<t;r++){let i=Math.floor(r/4),s=r%4;r===t-1&&1===s&&(s=3);let n=`${a.Uniforms.TILE_TEXTURE_ARRAY}[${i}]`;e+=`  if (band == ${r+1}.0) {
    return texture2D(${n}, v_textureCoord + vec2(dx, dy))[${s}];
  }
`}i.functions[m]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${a.Uniforms.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${a.Uniforms.TEXTURE_PIXEL_HEIGHT};
${e}
}`}return`${m}(${e}, ${t??"0.0"}, ${r??"0.0"})`}),[l.Ops.Palette]:(e,t)=>{let[r,...a]=t.args,s=a.length,n=new Uint8Array(4*s);for(let e=0;e<a.length;e++){let t=a[e].value,r=(0,i.asArray)(t),s=4*e;n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=255*r[3]}e.paletteTextures||(e.paletteTextures=[]);let u=`u_paletteTextures[${e.paletteTextures.length}]`,h=new o.default(u,n);e.paletteTextures.push(h);let c=v(r,l.NumberType,e);return`texture2D(${u}, vec2((${c} + 0.5) / ${s}.0, 0.5))`}};function v(e,t,r){if(e instanceof l.CallExpression){let i=y[e.operator];if(void 0===i)throw Error(`No compiler defined for this operator: ${JSON.stringify(e.operator)}`);return i(r,e,t)}if((e.type&l.NumberType)>0)return u(e.value);if((e.type&l.BooleanType)>0)return e.value.toString();if((e.type&l.StringType)>0)return f(e.value.toString());if((e.type&l.ColorType)>0)return c(e.value);if((e.type&l.NumberArrayType)>0)return h(e.value);if((e.type&l.SizeType)>0){var i;return i=e.value,h((0,n.toSize)(i))}throw Error(`Unexpected expression ${e.value} (expected type ${(0,l.typeName)(t)})`)}}),n("dAsIA",function(e,r){t(e.exports,"Uniforms",()=>a),s("av38f"),s("jZquI"),s("gzr8q"),s("6BjcK"),s("14PDX"),s("jYEYW"),s("77SUz");var i=s("knkkM");s("1fBMl"),s("5XVOZ");let a={...s("fOidj").Uniforms,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"};i.AttributeType.FLOAT}),n("1fBMl",function(e,r){t(e.exports,"default",()=>g);var i=s("hyFBJ"),a=s("6EHBB"),n=s("cgxQK"),o=s("lUH7Q"),l=s("6BjcK"),u=s("5XVOZ"),h=s("2LCvK"),c=s("77SUz");function d(e,t,r){let i=r?e.LINEAR:e.NEAREST;e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i)}function p(e,t,r,i,a,s){let n,o,l;let u=e.getGL();r instanceof Float32Array?(n=u.FLOAT,e.getExtension("OES_texture_float"),o=null!==e.getExtension("OES_texture_float_linear")):(n=u.UNSIGNED_BYTE,o=!0),d(u,t,s&&o);let h=r.byteLength/i[1],c=1;switch(h%8==0?c=8:h%4==0?c=4:h%2==0&&(c=2),a){case 1:l=u.LUMINANCE;break;case 2:l=u.LUMINANCE_ALPHA;break;case 3:l=u.RGB;break;case 4:l=u.RGBA;break;default:throw Error(`Unsupported number of bands: ${a}`)}let p=u.getParameter(u.UNPACK_ALIGNMENT);u.pixelStorei(u.UNPACK_ALIGNMENT,c),u.texImage2D(u.TEXTURE_2D,0,l,i[0],i[1],0,l,n,r),u.pixelStorei(u.UNPACK_ALIGNMENT,p)}let f=null;class m extends h.default{constructor(e){super(e),this.textures=[],this.renderSize_=(0,l.toSize)(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;let t=new c.default(u.ARRAY_BUFFER,u.STATIC_DRAW);t.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(t),this.coords=t,this.setTile(e.tile)}setHelper(e){let t=this.helper?.getGL();if(t){this.helper.deleteBuffer(this.coords);for(let e=0;e<this.textures.length;++e)t.deleteTexture(this.textures[e])}super.setHelper(e),e&&e.flushBufferData(this.coords)}uploadTile(){let e;let t=this.helper,r=t.getGL(),s=this.tile;this.textures.length=0,e=s instanceof a.default||s instanceof o.default?s.getImage():s.getData();let n=(0,i.asImageLike)(e);if(n){let e=r.createTexture();this.textures.push(e),this.bandCount=4,d(r,e,s.interpolate),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),this.setReady();return}e=(0,i.asArrayLike)(e);let l=s.getSize(),u=[l[0]+2*this.gutter,l[1]+2*this.gutter],h=e instanceof Float32Array,c=u[0]*u[1],f=h?Float32Array:Uint8Array,m=f.BYTES_PER_ELEMENT,g=e.byteLength/u[1];this.bandCount=Math.floor(g/m/u[0]);let y=Math.ceil(this.bandCount/4);if(1===y){let i=r.createTexture();this.textures.push(i),p(t,i,e,u,this.bandCount,s.interpolate),this.setReady();return}let v=Array(y);for(let e=0;e<y;++e){let t=r.createTexture();this.textures.push(t);let i=e<y-1?4:(this.bandCount-1)%4+1;v[e]=new f(c*i)}let _=0,x=0,b=u[0]*this.bandCount;for(let t=0;t<u[1];++t){for(let t=0;t<b;++t){let r=e[x+t],i=Math.floor(_/this.bandCount),a=t%this.bandCount,s=v[Math.floor(a/4)],n=s.length/c;s[i*n+a%4]=r,++_}x+=g/m}for(let e=0;e<y;++e){let r=this.textures[e],i=v[e],a=i.length/c;p(t,r,i,u,a,s.interpolate)}this.setReady()}getImagePixelData_(e,t,r){let i;let a=this.gutter,s=this.renderSize_[0],o=this.renderSize_[1];f||(f=(0,n.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})),f.clearRect(0,0,1,1);let l=e.width,u=e.height;try{f.drawImage(e,a+Math.floor(t/s*(l-2*a)),a+Math.floor(r/o*(u-2*a)),1,1,0,0,1,1),i=f.getImageData(0,0,1,1).data}catch{return f=null,null}return i}getArrayPixelData_(e,t,r,i){let a=this.gutter,s=this.renderSize_[0],n=this.renderSize_[1],o=t[0],l=t[1],u=o+2*a,h=a+Math.floor(r/s*o),c=a+Math.floor(i/n*l);if(e instanceof DataView){let t=e.byteLength/(u*(l+2*a)),r=t*(c*u+h),i=e.buffer.slice(r,r+t);return new DataView(i)}let d=this.bandCount*(c*u+h);return e.slice(d,d+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof i.default){let r=this.tile.getData(),a=(0,i.asArrayLike)(r);if(a){let r=this.tile.getSize();return this.getArrayPixelData_(a,r,e,t)}return this.getImagePixelData_((0,i.asImageLike)(r),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}var g=m}),n("2LCvK",function(e,r){t(e.exports,"default",()=>h);var i=s("6EHBB"),a=s("av38f"),n=s("cw4dl"),o=s("9LzRi"),l=s("lVQul");class u extends o.default{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=e.gutter||0,this.helper=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile){if(this.tile&&this.tile.removeEventListener(n.default.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===a.default.LOADED,this.loaded)this.uploadTile();else{if(e instanceof i.default){let t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(n.default.CHANGE,this.handleTileChange_)}}}uploadTile(){(0,l.abstract)()}setReady(){this.ready=!0,this.dispatchEvent(n.default.CHANGE)}handleTileChange_(){this.tile.getState()===a.default.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(e){this.helper=e,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(n.default.CHANGE,this.handleTileChange_)}}var h=u}),n("fOidj",function(e,r){t(e.exports,"Uniforms",()=>g),t(e.exports,"getCacheKey",()=>x),t(e.exports,"default",()=>S);var i=s("jRKCY"),a=s("av38f"),n=s("kBSVF"),o=s("jZquI"),l=s("gzr8q"),u=s("6BjcK"),h=s("1rfTO"),c=s("9YraL"),d=s("14PDX"),p=s("lVQul"),f=s("jYEYW"),m=s("iHIuK");let g={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function y(e,t){return e.tileIds.has((0,p.getUid)(t))}function v(e,t,r){let i=e.representationsByZ;r in i||(i[r]=new Set),i[r].add(t),e.tileIds.add((0,p.getUid)(t.tile))}function _(e,t){let r=e.layerStatesArray[e.layerIndex];r.extent&&(t=(0,o.getIntersection)(t,(0,l.fromUserExtent)(r.extent,e.viewState.projection)));let i=r.layer.getRenderSource();if(!i.getWrapX()){let r=i.getTileGridForProjection(e.viewState.projection).getExtent();r&&(t=(0,o.getIntersection)(t,r))}return t}function x(e,t){return`${e.getKey()},${e.getRevision()},${(0,c.getKey)(t)}`}class b extends m.default{constructor(e,t){super(e,{uniforms:t.uniforms,postProcesses:t.postProcesses}),this.renderComplete=!1,this.tileTransform_=(0,d.create)(),this.tempMat4=(0,f.create)(),this.tempTileRange_=new i.default(0,0,0,0),this.tempTileCoord_=(0,c.createOrUpdate)(0,0,0),this.tempSize_=[0,0];let r=void 0!==t.cacheSize?t.cacheSize:512;this.tileRepresentationCache=new h.default(r),this.frameState=null,this.renderedProjection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}prepareFrameInternal(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;let t=this.getLayer().getRenderSource();return!(!t||(0,o.isEmpty)(_(e,e.extent)))&&"ready"===t.getState()}createTileRepresentation(e){return(0,p.abstract)()}enqueueTiles(e,t,r,i,s){let n=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(n.projection),d=u.getGutterForProjection(n.projection),f=(0,p.getUid)(u);f in e.wantedTiles||(e.wantedTiles[f]={});let m=e.wantedTiles[f],g=this.tileRepresentationCache,_=l.getMapInternal(),b=Math.max(r-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=n.rotation,w=S?(0,o.getRotatedViewport)(n.center,n.resolution,S,e.size):void 0;for(let s=r;s>=b;--s){let r=h.getTileRangeForExtentAndZ(t,s,this.tempTileRange_),o=h.getResolution(s);for(let t=r.minX;t<=r.maxX;++t)for(let l=r.minY;l<=r.maxY;++l){let r,p;if(S&&!h.tileCoordIntersectsViewport([s,t,l],w))continue;let _=(0,c.createOrUpdate)(s,t,l,this.tempTileCoord_),b=x(u,_);if(g.containsKey(b)&&(p=(r=g.get(b)).tile),(!r||r.tile.key!==u.getKey())&&!(p=u.getTile(s,t,l,e.pixelRatio,n.projection))||y(i,p))continue;r?r.setTile(p):(r=this.createTileRepresentation({tile:p,grid:h,helper:this.helper,gutter:d}),g.set(b,r)),v(i,r,s);let E=p.getKey();m[E]=!0,p.getState()!==a.default.IDLE||e.tileQueue.isKeyQueued(E)||e.tileQueue.enqueue([p,f,h.getTileCoordCenter(_),o])}}}beforeTilesRender(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}beforeTilesMaskRender(e){return!1}renderTile(e,t,r,i,a,s,n,o,l,u,h){}renderTileMask(e,t,r,i){}drawTile_(e,t,r,i,a,s,n){if(!t.ready)return;let o=t.tile.tileCoord,l=(0,c.getKey)(o),h=l in s?s[l]:1,p=n.getResolution(r),f=(0,u.toSize)(n.getTileSize(r),this.tempSize_),m=n.getOrigin(r),g=n.getTileCoordExtent(o),y=h<1?-1:1/(r+2);h<1&&(e.animate=!0);let v=e.viewState,_=v.center[0],x=v.center[1],b=f[0]+2*i,S=f[1]+2*i,w=(_-m[0])/(f[0]*p),E=(m[1]-x)/(f[1]*p),A=v.resolution/p,T=o[1],C=o[2];(0,d.reset)(this.tileTransform_),(0,d.scale)(this.tileTransform_,2/(e.size[0]*A/b),-2/(e.size[1]*A/b)),(0,d.rotate)(this.tileTransform_,v.rotation),(0,d.scale)(this.tileTransform_,1,1/(b/S)),(0,d.translate)(this.tileTransform_,(f[0]*(T-w)-i)/b,(f[1]*(C-E)-i)/S),this.renderTile(t,this.tileTransform_,e,a,p,f,m,g,y,i,h)}renderFrame(e){this.frameState=e,this.renderComplete=!0;let t=this.helper.getGL();this.preRender(t,e);let r=e.viewState,i=this.getLayer(),s=i.getRenderSource(),o=s.getTileGridForProjection(r.projection),l=s.getGutterForProjection(r.projection),u=_(e,e.extent),h=o.getZForResolution(r.resolution,s.zDirection),d={tileIds:new Set,representationsByZ:{}},f=i.getPreload();if(e.nextExtent){let t=o.getZForResolution(r.nextResolution,s.zDirection),i=_(e,e.nextExtent);this.enqueueTiles(e,i,t,d,f)}this.enqueueTiles(e,u,h,d,0),f>0&&setTimeout(()=>{this.enqueueTiles(e,u,h-1,d,f-1)},0);let m={},g=!1,y=d.representationsByZ;if(h in y){let t=(0,p.getUid)(this),r=e.time;for(let e of y[h]){let i=e.tile;if(i.getState()===a.default.EMPTY)continue;let s=i.tileCoord;if(e.ready){let e=i.getAlpha(t,r);if(1===e){i.endTransition(t);continue}g=!0,m[(0,c.getKey)(s)]=e}if(this.renderComplete=!1,this.findAltTiles_(o,s,h+1,d))continue;let n=o.getMinZoom();for(let e=h-1;e>=n&&!this.findAltTiles_(o,s,e,d);--e);}}let v=Object.keys(y).map(Number).sort(n.descending);if(this.beforeTilesMaskRender(e))for(let e=0,t=v.length;e<t;++e){let t=v[e];for(let e of y[t]){let r=e.tile.tileCoord;if((0,c.getKey)(r) in m)continue;let i=o.getTileCoordExtent(r);this.renderTileMask(e,t,i,1/(t+2))}}this.beforeTilesRender(e,g);for(let t=0,r=v.length;t<r;++t){let r=v[t];for(let t of y[r]){let i=t.tile.tileCoord;(0,c.getKey)(i) in m||this.drawTile_(e,t,r,l,u,m,o)}}if(h in y)for(let t of y[h]){let r=t.tile.tileCoord;(0,c.getKey)(r) in m&&this.drawTile_(e,t,h,l,u,m,o)}this.beforeFinalize(e),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);let x=this.helper.getCanvas(),b=this.tileRepresentationCache;for(;b.canExpireCache();)b.pop().dispose();return this.postRender(t,e),x}beforeFinalize(e){}findAltTiles_(e,t,r,i){let a=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!a)return!1;let s=!0,n=this.tileRepresentationCache,o=this.getLayer().getRenderSource();for(let e=a.minX;e<=a.maxX;++e)for(let t=a.minY;t<=a.maxY;++t){let a=x(o,[r,e,t]),l=!1;if(n.containsKey(a)){let e=n.get(a);e.ready&&!y(i,e.tile)&&(v(i,e,r),l=!0)}l||(s=!1)}return s}clearCache(){super.clearCache();let e=this.tileRepresentationCache;e.forEach(e=>e.dispose()),e.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(e=>e.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}}var S=b}),n("bzfCn",function(e,r){t(e.exports,"default",()=>i);var i=class{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){let t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}}),n("77Abf",function(e,r){t(e.exports,"createDefaultStyle",()=>i);function i(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}}),n("bJBiI",function(e,r){t(e.exports,"toSLD",()=>a);class i{constructor(){this.doc=(new DOMParser).parseFromString('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><StyledLayerDescriptor version="1.0.0" xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd" xmlns="http://www.opengis.net/sld" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:se="http://www.opengis.net/se"></StyledLayerDescriptor>',"text/xml"),this.root=this.doc.getElementsByTagName("StyledLayerDescriptor")[0]}addChild(e,t,r){"[object Object]"!==Object.prototype.toString.call(r)&&(r={value:r||""});let i=this.doc.createElement(e);return Object.keys(r).forEach(e=>{"value"===e?i.innerHTML=r.value:i.setAttribute(e,r[e])}),(t=t||this.root).appendChild(i),i}serializeToString(){return new XMLSerializer().serializeToString(this.doc).replace(/ xmlns=""/g,"")}}function a(e){let t;let r=new i,a=r.addChild("NamedLayer");r.addChild("Name",a,"Ma carte - statistique");let s=r.addChild("UserStyle",a);r.addChild("Name",s,"statistic"),r.addChild("Title",s,"statistic");let n=r.addChild("FeatureTypeStyle",s);return e.forEach(e=>{let i=r.addChild("Rule",n);r.addChild("Name",i,e.title);let a=e.condition.conditions[0];if(t||a.attr){let e=r.addChild("Filter",i,{xmlns:"http://www.opengis.net/ogc"});if(t){a.attr&&(e=r.addChild("And",e));let i=r.addChild(function(e){switch(e){case"=":return"PropertyIsNotEqualTo";case"!=":return"PropertyIsEqualTo";case"<":return"PropertyIsGreaterThanOrEqualTo";case"<=":return"PropertyIsGreaterThan";case">":return"PropertyIsLessThanOrEqualTo";case">=":return"PropertyIsLessThan"}return"none"}(t.op),e);r.addChild("PropertyName",i,t.attr),r.addChild("Literal",i,t.val)}if(a.attr){let t=r.addChild(function(e){switch(e){case"=":return"PropertyIsEqualTo";case"!=":return"PropertyIsNotEqualTo";case"<":return"PropertyIsLessThan";case"<=":return"PropertyIsLessThanOrEqualTo";case">":return"PropertyIsGreaterThan";case">=":return"PropertyIsGreaterThanOrEqualTo"}}(a.op),e);r.addChild("PropertyName",t,a.attr),r.addChild("Literal",t,a.val)}t=a}let s=e.symbol.getIgnStyle();switch(e.symbol.getType()){case"Point":{let e=r.addChild("PointSymbolizer",i),t=r.addChild("Graphic",e),a=r.addChild("Mark",t);r.addChild("WellKnownName",a,"circle");let n=r.addChild("Fill",a);r.addChild("CssParameter",n,{name:"fill",value:s.symbolColor});let o=r.addChild("Stroke",a);r.addChild("CssParameter",o,{name:"stroke",value:s.pointStrokeColor}),r.addChild("CssParameter",o,{name:"stroke-width",value:s.pointStrokeWidth}),r.addChild("Size",t,2*s.pointRadius),r.addChild("Rotation",t,s.pointRotation);break}case"Polygon":{let e=r.addChild("PolygonSymbolizer",i);if(s.fillColor){let t=r.addChild("Fill",e);r.addChild("CssParameter",t,{value:s.fillColor,name:"fill"})}if(s.strokeWidth){let t=r.addChild("Stroke",e);r.addChild("CssParameter",t,{value:s.strokeColor,name:"stroke"}),r.addChild("CssParameter",t,{value:s.strokeWidth,name:"stroke-width"})}}break;default:console.log("[SLD] Type is not implemented: ",e.symbol.getType())}}),r.serializeToString()}}),n("hThUZ",function(e,r){t(e.exports,"default",()=>a);var i=s("j2K3b");function a(e){if(!e.getType)return new i.default([0,0]);switch(e.getType()){case"MultiPolygon":var t,r=e.getPolygons();if(!r.length)return e;for(var a=0,s=0;s<r.length;s++){var n=r[s].getArea();n>a&&(a=n,t=r[s])}return t.getInteriorPoint();case"Polygon":return e.getInteriorPoint();case"Point":return e;default:return new i.default(e.getFirstCoordinate())}}}),n("cHblF",function(e,r){t(e.exports,"default",()=>p);var i=s("fnScq"),a=s("iGyOD"),n=s("3HxCM"),o=s("hvEnP"),l=s("j2K3b"),u=s("cgPpQ"),h=s("6BrXC"),c=s("cWXYt");class d extends i.default{constructor(e){super(),void 0===(e=e||{}).margin&&(e.margin=10);let t=e.feature,r=Object.assign({},e.style),i=(e.type||"").replace(/^Polygone$/,"Polygon");switch(t instanceof a.default&&(t.get("features")&&(t=t.get("features")[0]),t&&(i=t.getGeometry().getType(),r=t.getIgnStyle(!0))),i=(0,h.default)(i)){case"Point":t=new a.default(new l.default([0,0]));break;case"LineString":t=new a.default(new o.default([[0,0],[1,0]]));break;case"Polygon":t=new a.default(new u.default([[[0,0]]]));break;default:t=null}t&&(t.setStyle((0,c.getStyleFn)()),t.setIgnStyle(r),this._img=(0,n.default).getLegendImage({feature:t,size:e.size,margin:e.margin,pixelratio:1,onload:()=>{this._drawImage()}}),t.on("change",()=>{this._drawImage()})),this.set("name",e.name),this._margin=e.margin,this._feature=t,this._type=i,this.setIgnStyle(r),this._size=e.size}}d.prototype._drawImage=function(){this._feature.setIgnStyle(this._style);let e=(0,n.default).getLegendImage({size:this._size,margin:this._margin,pixelratio:1,feature:this._feature});this._img.getContext("2d").clearRect(0,0,this._img.width,this._img.height),this._img.getContext("2d").drawImage(e,0,0),this.dispatchEvent({type:"load"})},d.prototype.getImage=function(e){if(e){let e=document.createElement("canvas");return e.width=this._img.width,e.height=this._img.height,e.getContext("2d").drawImage(this._img,0,0),e}return this._img},d.prototype.setIgnStyle=function(e,t){this._feature&&(this._feature.setIgnStyle(e,t),this._style=Object.assign({},this._feature.getIgnStyle(!0)),delete this._style.zIndex,this._feature.changed())},d.prototype.getIgnStyle=function(){return Object.assign({},this._style)},d.prototype.getType=function(){return this._type},d.prototype.setFeatureProperties=function(e){let t=this._feature.getGeometry();this._feature.setProperties(e),this._feature.setGeometry(t)},d.prototype.stringify=function(){return{name:this.get("name"),type:this.getType(),style:this.getIgnStyle()}};var p=d}),n("3HxCM",function(e,r){t(e.exports,"default",()=>b);var i=s("fnScq"),a=s("ejLRd"),n=s("31ZqB"),o=s("lW8xZ"),l=s("jtzGF"),u=s("lqNjm"),h=s("iGyOD"),c=s("j2K3b"),d=s("hvEnP"),p=s("cgPpQ"),f=s("jZquI"),m=s("iQyfo"),g=s("kuKBR"),y=s("2zf1Y"),v=s("bJF7J"),_=s("3xROf"),x=class extends i.default{constructor(e){super(),e=e||{},this._items=new n.default;var t,r=[];this._items.on("add",(function(e){r.push({item:e.element,on:e.element.on("change",(function(){this.refresh()}).bind(this))}),t&&(clearTimeout(t),t=null),t=setTimeout((function(){this.refresh()}).bind(this),0)}).bind(this)),this._items.on("remove",(function(e){for(var i=0;i<r;i++)if(e.element===r[i].item){(0,a.unByKey)(r[i].on),r.splice(i,1);break}t&&(clearTimeout(t),t=null),t=setTimeout((function(){this.refresh()}).bind(this),0)}).bind(this)),this._listElement=(0,m.default).create("UL",{className:"ol-legend"}),this._canvas=document.createElement("canvas"),this.setLayer(e.layer),this.set("maxWidth",e.maxWidth,!0),this.set("size",e.size||[40,25],!0),this.set("margin",0===e.margin?0:e.margin||10,!0),this._textStyle=e.textStyle||new g.default({font:"16px sans-serif",fill:new y.default({color:"#333"}),backgroundFill:new y.default({color:"rgba(255,255,255,.8)"})}),this._title=new v.default({title:e.title||"",className:"ol-title"}),e.titleStyle?this._titleStyle=e.titleStyle:(this._titleStyle=this._textStyle.clone(),this._titleStyle.setFont("bold "+this._titleStyle.getFont())),this.setStyle(e.style),e.items instanceof Array&&e.items.forEach((function(e){this.addItem(e)}).bind(this)),this.refresh()}static getLegendImage(e,t,r){void 0===(e=e||{}).margin&&(e.margin=10);var i,a,s,n,u=e.size||[40,25];e.width&&(u[0]=e.width),e.heigth&&(u[1]=e.heigth),e.onload=e.onload||function(){setTimeout(function(){x.getLegendImage(e,t,r)},100)};var m=u[0]+2*e.margin,g=e.lineHeight||u[1]+2*e.margin,y=e.pixelratio||o.DEVICE_PIXEL_RATIO;t||(r=0,(t=document.createElement("canvas")).width=m*y,t.height=g*y);var v=t.getContext("2d");v.save();var _=(0,l.toContext)(v,{pixelRatio:y}),b=e.typeGeom,S=e.feature;!S&&b&&(S=new h.default(/Point/.test(b)?new c.default([0,0]):/LineString/.test(b)?new d.default([0,0]):new p.default([[0,0]])),e.properties&&S.setProperties(e.properties)),S?("function"==typeof(i=S.getStyle())&&(i=i(S)),i||(i="function"==typeof e.style?e.style(S):e.style||[]),b=S.getGeometry().getType()):i=[],i instanceof Array||(i=[i]);var w=m/2,E=g/2,A=u[0]/2,T=u[1]/2;if("Point"===b){var C=null;for(a=0;s=i[a];a++){var P=s.getImage();if(P){var R=P.getPhoto?P.getPhoto():P.getImage();if(R&&R instanceof HTMLImageElement&&!R.naturalWidth&&("function"==typeof e.onload&&R.addEventListener("load",function(){setTimeout(function(){e.onload()},100)}),P.load()),P.getAnchor){var I=P.getAnchor();if(I){var L=P.getSize(),O=I[0]-L[0],M=I[1]-L[1];C?(0,f.extend)(C,[O,M,O+L[0],M+L[1]]):C=[O,M,O+L[0],M+L[1]]}}}}C&&(w+=(C[2]+C[0])/2,E+=(C[3]+C[1])/2)}for(E+=r||0,a=0;s=i[a];a++){switch(_.setStyle(s),v.save(),b){case c.default:case"Point":case"MultiPoint":n=new c.default([w,E]);break;case d.default:case"LineString":case"MultiLineString":v.rect(e.margin*y,0,u[0]*y,t.height),v.clip(),n=new d.default([[w-A,E],[w+A,E]]);break;case p.default:case"Polygon":case"MultiPolygon":n=new p.default([[[w-A,E-T],[w+A,E-T],[w+A,E+T],[w-A,E+T],[w-A,E-T]]])}s.getGeometryFunction()&&(n=s.getGeometryFunction()(new h.default(n))),_.drawGeometry(n),v.restore()}return v.restore(),t}setTitle(e){this._title.setTitle(e),this.refresh()}getTitle(){return this._title.get("title")}setLayer(e){this._layerListener&&(0,a.unByKey)(this._layerListener),this._layer=e,e?this._layerListener=e.on("change:visible",(function(){this.refresh()}).bind(this)):this._layerListener=null}getTextStyle(){return this._textStyle}set(e,t,r){super.set(e,t,r),r||this.refresh()}getListElement(){return this._listElement}getCanvas(){return this._canvas}setStyle(e){this._style=e,this.refresh()}addItem(e){e instanceof x?(this._items.push(e),e.on("refresh",(function(){this.refresh(!0)}).bind(this))):e instanceof v.default||e instanceof _.default?this._items.push(e):this._items.push(new v.default(e))}removeItem(e){this._items.remove(e)}removeItemAt(e){this._items.removeAt(e)}getItems(){return this._items}_drawText(e,t,r,i){e.save(),e.scale(o.DEVICE_PIXEL_RATIO,o.DEVICE_PIXEL_RATIO);var a=(t=t||"").split("\n");1===a.length?e.fillText(t,r,i):(e.textBaseline="bottom",e.fillText(a[0],r,i),e.textBaseline="top",e.fillText(a[1],r,i)),e.restore()}_measureText(e,t){var r=(t||"").split("\n");if(1===r.length)return e.measureText(t);var i=e.measureText(r[0]),a=e.measureText(r[1]);return{width:Math.max(i.width,a.width),height:i.height+a.height}}refresh(e){var t=this._listElement;if(t){t.innerHTML="";var r=this.get("margin"),i=this.get("size")[0]+2*r,a=this.get("lineHeight")||this.get("size")[1]+2*r,s=this.getCanvas(),n=s.getContext("2d");n.textAlign="left",n.textBaseline="middle";var l=o.DEVICE_PIXEL_RATIO,h=Math.min(this.getWidth(),this.get("maxWidth")||1/0),c=this.getHeight();s.width=h*l,s.height=c*l,s.style.height=c+"px",n.textBaseline="middle",n.fillStyle=(0,u.asString)(this._textStyle.getFill().getColor()),this.getTitle()&&(t.appendChild(this._title.getElement([i,a],(function(e){this.dispatchEvent({type:"select",index:-1,symbol:e,item:this._title})}).bind(this))),n.font=this._titleStyle.getFont(),n.textAlign="center",this._drawText(n,this.getTitle(),s.width/l/2,a/2));var d=0;this.getTitle()&&(d=a);var p=0;this._items.forEach((function(e,o){if(e instanceof x){if((!e._layer||e._layer.getVisible())&&e.getCanvas().height){n.drawImage(e.getCanvas(),0,d*l);for(var u=e._listElement.querySelectorAll("li"),h=0;h<u.length;h++){var c=u[h].cloneNode();c.innerHTML=u[h].innerHTML,t.appendChild(c),p++}d+=e.getHeight()}}else{if(e instanceof _.default){e.get("title")&&(t.appendChild(this._title.getElement([i,a],(function(e){this.dispatchEvent({type:"select",index:-1,symbol:e,item:this._title})}).bind(this))),n.font=e.get("textStyle")?e.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(e.get("className"))?(n.textAlign="center",this._drawText(n,e.get("title"),s.width/l/2,d+a/2)):this._drawText(n,e.get("title"),r,d+a/2),d+=a);var f=e.getImage();try{n.drawImage(f,0,0,f.naturalWidth,f.naturalHeight,0,d*l,e.getWidth()*l,e.getHeight()*l)}catch(e){}d+=e.getHeight()}else{var m=e.getProperties(),g=m.height||a;n.textAlign="left",m.feature||m.typeGeom?(s=this.getLegendImage(m,s,d),n.font=e.get("textStyle")?e.get("textStyle").getFont():this._textStyle.getFont(),this._drawText(n,e.get("title"),i+r,d+g/2)):(n.font=e.get("textStyle")?e.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(m.className)?(n.textAlign="center",this._drawText(n,e.get("title"),s.width/l/2,d+g/2)):this._drawText(n,e.get("title"),r,d+g/2)),d+=g}t.appendChild(e.getElement([i,a],(function(t){this.dispatchEvent({type:"select",index:o,symbol:t,item:e})}).bind(this))),p++}}).bind(this)),this.set("items",p,!0),this.dispatchEvent({type:"items",nb:p}),e||this.dispatchEvent({type:"refresh",width:i,height:(this._items.length+1)*a})}}getHeight(){var e=this.get("margin"),t=this.get("lineHeight")||this.get("size")[1]+2*e,r=this.getTitle()?t:0;return this._items.forEach(function(i){i instanceof x?(!i._layer||i._layer.getVisible())&&(r+=i.getHeight()):i instanceof _.default?(i.get("title")&&(r+=t),r+=i.getHeight()):i.get("height")?r+=i.get("height")+2*e:r+=t}),r}getWidth(){var e=this.getCanvas().getContext("2d"),t=this.get("margin"),r=this.get("size")[0]+2*t;e.font=this._titleStyle.getFont();var i=this._measureText(e,this.getTitle("title")).width;return this._items.forEach((function(t){t instanceof x?(!t._layer||t._layer.getVisible())&&(i=Math.max(i,t.getWidth())):t instanceof _.default?(i=Math.max(i,t.getWidth()),t.get("title")&&(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._titleStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width))):t.get("feature")||t.get("typeGeom")?(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._textStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width+r)):(e.font=t.get("textStyle")?t.get("textStyle").getFont():this._titleStyle.getFont(),i=Math.max(i,this._measureText(e,t.get("title")).width))}).bind(this)),i+2*t}getLegendImage(e,t,r){e=e||{};var i=this.get("size");return x.getLegendImage({className:e.className,feature:e.feature,typeGeom:e.typeGeom,style:e.style||this._style,properties:e.properties,margin:e.margin||this.get("margin"),size:[e.width||i[0],e.height||i[1]],lineHeight:e.lineHeight||this.get("lineHeight"),onload:(function(){this.refresh()}).bind(this)},t,r)}},b=x}),n("jtzGF",function(e,r){t(e.exports,"toContext",()=>o);var i=s("lW8xZ");s("gzr8q");var a=s("htGzg");s("713Fw");var n=s("14PDX");function o(e,t){let r=e.canvas,s=(t=t||{}).pixelRatio||i.DEVICE_PIXEL_RATIO,o=t.size;o&&(r.width=o[0]*s,r.height=o[1]*s,r.style.width=o[0]+"px",r.style.height=o[1]+"px");let l=[0,0,r.width,r.height],u=(0,n.scale)((0,n.create)(),s,s);return new a.default(e,s,l,u,0)}}),n("bJF7J",function(e,r){t(e.exports,"default",()=>n);var i=s("fnScq"),a=s("iQyfo"),n=class extends i.default{constructor(e){super(e=e||{}),e.feature&&this.set("feature",e.feature.clone()),this.setWidth(e.width),this.setHeight(e.height)}setTitle(e){this.set("title",e||""),this.changed()}setWidth(e){this.set("width",e||null),this.changed()}setHeight(e){this.set("heigth",e||null),this.changed()}getElement(e,t){this.get("width")&&(e[0]=this.get("width")),this.get("height")&&(e[1]=this.get("height"));var r=(0,a.default).create("LI",{className:this.get("className"),click:function(e){t(!1),e.stopPropagation()},style:{height:e[1]+"px"},"aria-label":this.get("title")});return(0,a.default).create("DIV",{click:function(e){t(!0),e.stopPropagation()},style:{width:e[0]+"px",height:e[1]+"px"},parent:r}),r}}}),n("3xROf",function(e,r){t(e.exports,"default",()=>n);var i=s("fnScq"),a=s("iQyfo"),n=class extends i.default{constructor(e){super(e=e||{}),this.set("width",e.width),this._img=e.img||new Image,this._img.onload=(function(){this.changed()}).bind(this),e.img||(this._img.src=e.src)}setTitle(e){this.set("title",e||""),this.changed()}setWidth(e){this.set("width",e||null),this.changed()}getWidth(){return this._img.naturalWidth?this.get("width")||this._img.naturalWidth:0}getHeight(){return this._img.naturalWidth?this.get("width")?this.get("width")*this._img.naturalHeight/this._img.naturalWidth:this._img.naturalHeight||0:0}getImage(){return this._img}getElement(e,t){this.get("width")&&(e[0]=this.get("width")),this.get("height")&&(e[1]=this.get("height"));var r=(0,a.default).create("LI",{className:this.get("className"),click:function(e){t(!1),e.stopPropagation()},style:{height:this.getHeight()+"px"},"aria-label":this.get("title")});return(0,a.default).create("DIV",{click:function(e){t(!0),e.stopPropagation()},style:{width:this.getWidth()+"px",height:this.getHeight()+"px"},parent:r}),r}}}),n("6BrXC",function(e,r){t(e.exports,"default",()=>i);var i=function(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"LinearRing":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"GeometryCollection":case"Circle":return!1}}}),n("cVsLl",function(e,r){t(e.exports,"default",()=>i);var i=function(e,t){t>=e.length&&(t=e.length-2),t<0&&(t=0);var r=function(e,t){var r,i,a=[],s=[],n=0;for(r=0;r<e.length+1;r++){var o=[],l=[];for(i=0;i<t+1;i++)o.push(0),l.push(0);a.push(o),s.push(l)}for(r=1;r<t+1;r++)for(i=2,a[1][r]=1,s[1][r]=0;i<e.length+1;i++)s[i][r]=1/0;for(var u=2;u<e.length+1;u++){for(var h=0,c=0,d=0,p=0,f=1;f<u+1;f++){var m=u-f+1,g=e[m-1];if(d++,h+=g,c+=g*g,n=c-h*h/d,0!=(p=m-1))for(i=2;i<t+1;i++)s[u][i]>=n+s[p][i-1]&&(a[u][i]=m,s[u][i]=n+s[p][i-1])}a[u][1]=1,s[u][1]=n}return{lower_class_limits:a,variance_combinations:s}}(e=e.slice().sort(function(e,t){return e-t}),t).lower_class_limits;return function(e,t,r){var i=e.length-1,a=[],s=r;for(a[r]=e[e.length-1],a[0]=e[0];s>1;)a[s-1]=e[t[i][s]-2],i=t[i][s]-1,s--;return a}(e,r,t)}}),n("hwcfb",function(e,r){t(e.exports,"default",()=>o),s("juLo9");var i=s("lqNjm"),a=s("4lFOe"),n=s("h1ihb"),o=function(e,t){let r=e.getStyle();if(r){"function"==typeof r&&(r=r(e)),r instanceof Array||(r=[r]),t&&e.setStyle(!1);for(let t=0;t<r.length&&!function(e,t){let r=t.getImage();if(r){if(r instanceof a.default)e.setIgnStyle("pointForm","circle"),e.setIgnStyle("pointGlyph","ign-form-rond"),e.setIgnStyle("pointRadius",r.getRadius()),e.setIgnStyle("pointStrokeWidth",r.getStroke()?r.getStroke().getWidth():0),e.setIgnStyle("pointColor",(0,i.asString)(r.getFill()?r.getFill().getColor():"rgba(255,255,255,0)")),e.setIgnStyle("symbolColor",e.getIgnStyle("pointColor")),e.setIgnStyle("pointStrokeColor",(0,i.asString)(r.getStroke()?r.getStroke().getColor():"rgba(255,255,255,0)"));else{if(!(r instanceof n.default))return!1;e.setIgnStyle("pointForm","circle"),e.setIgnStyle("pointGlyph","ign-form-rond"),e.setIgnStyle("pointRadius",r.getRadius()),e.setIgnStyle("pointStrokeWidth",r.getStroke()?r.getStroke().getWidth():0),e.setIgnStyle("pointColor",(0,i.asString)(r.getFill()?r.getFill().getColor():"rgba(255,255,255,0)")),e.setIgnStyle("symbolColor",e.getIgnStyle("pointColor")),e.setIgnStyle("pointStrokeColor",(0,i.asString)(r.getStroke()?r.getStroke().getColor():"rgba(255,255,255,0)"))}return!0}return!1}(e,r[t]);t++);for(let t=0;t<r.length&&!function(e,t){let r=t.getStroke();return r?(e.setIgnStyle("strokeWidth",r.getWidth()),e.setIgnStyle("strokeColor",(0,i.asString)(r.getColor())),!0):(e.setIgnStyle("strokeWidth",0),e.setIgnStyle("strokeColor","rgba(255,255,255,0)"),!1)}(e,r[t]);t++);for(let t=0;t<r.length&&!function(e,t){let r=t.getFill();return!!r&&(e.setIgnStyle("fillColor",(0,i.asString)(r.getColor())),!0)}(e,r[t]);t++);return e.getIgnStyle()}}}),n("9pPDN",function(e,r){t(e.exports,"applyStyle",()=>s("4QRwa").applyStyle),s("ilKez"),s("4QRwa"),s("70cY1")}),n("ilKez",function(e,r){let i,a;t(e.exports,"getValue",()=>w),t(e.exports,"_colorWithOpacity",()=>A),t(e.exports,"styleFunctionArgs",()=>P),t(e.exports,"stylefunction",()=>R);var n=s("6g00w"),o=s("byP80"),l=s("eQaCk"),u=s("29SgV"),h=s("4lFOe"),c=s("2zf1Y"),d=s("ayeEa"),p=s("d5AAH"),f=s("l9IGS"),m=s("kuKBR"),g=s("elpZt"),y=s("ePotS");let v={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},_={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},x=function(e,t){let r=(0,n.createPropertyExpression)(e,t);if("error"===r.result)throw Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));return r.value},b={},S={zoom:0};function w(e,t,r,i,a,s,o){let l=e.id;s||(s={},console.warn("No functionCache provided to getValue()")),s[l]||(s[l]={});let u=s[l];if(!u[r]){let i=(e[t]||b)[r],a=n.v8[`${t}_${e.type}`][r];void 0===i&&(i=a.default);let s=(0,n.isExpression)(i);if(!s&&(0,n.isFunction)(i)&&(i=(0,n.convertFunction)(i,a),s=!0),s){let e=x(i,a);u[r]=e.evaluate.bind(e)}else"color"==a.type&&(i=(0,n.Color).parse(i)),u[r]=function(){return i}}return S.zoom=i,u[r](S,a,o)}function E(e,t,r,i,a){return w(e,"layout",`${i}-allow-overlap`,t,r,a)?w(e,"layout",`${i}-ignore-placement`,t,r,a)?"none":"obstacle":"declutter"}function A(e,t){if(e){if(0===e.a||0===t)return;let r=e.a;return t=void 0===t?1:t,0===r?"transparent":"rgba("+Math.round(255*e.r/r)+","+Math.round(255*e.g/r)+","+Math.round(255*e.b/r)+","+r*t+")"}return e}let T=/\{[^{}}]*\}/g;function C(e,t){return e.replace(T,function(e){return t[e.slice(1,-1)]||""})}let P={};function R(e,t,r,s=y.defaultResolutions,x,T,R,I){let L,O,M,k;if("string"==typeof t&&(t=JSON.parse(t)),8!=t.version)throw Error("glStyle version 8 required.");P[(0,y.getStyleFunctionKey)(t,e)]=Array.from(arguments),T&&(0,l.toPromise)(()=>T).then(async t=>{let r;if("undefined"!=typeof Image){let i=new Image;if("string"==typeof t)i.crossOrigin="anonymous",i.src=t;else{let e;t instanceof Request?e=await fetch(t):t instanceof Response&&(e=t);let a=await e.blob();r=URL.createObjectURL(a),i.src=r}i.addEventListener("load",function t(){i.removeEventListener("load",t),L=i,O=[i.width,i.height],e.changed(),r&&URL.revokeObjectURL(r)}),i.addEventListener("error",function e(){URL.revokeObjectURL(r),i.removeEventListener("error",e)})}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){let e=self;e.postMessage({action:"loadImage",src:t}),e.addEventListener("message",function(e){"imageLoaded"===e.data.action&&e.data.src===t&&(O=[(L=e.data.image).width,L.height])})}});let N=(0,n.derefLayers)(t.layers),D={},F=[],G={},z={},q=(0,y.getFunctionCache)(t),j=(0,y.getFilterCache)(t);for(let e=0,i=N.length;e<i;++e){let i=N[e],a=i.id;if("string"==typeof r&&i.source==r||Array.isArray(r)&&-1!==r.indexOf(a)){let r=i["source-layer"];if(k){if(i.source!==k)throw Error(`Layer "${a}" does not use source "${k}`)}else{k=i.source;let e=t.sources[k];if(!e)throw Error(`Source "${k}" is not defined`);let r=e.type;if("vector"!==r&&"geojson"!==r)throw Error(`Source "${k}" is not of type "vector" or "geojson", but "${r}"`)}let s=D[r];s||(s=[],D[r]=s),s.push({layer:i,index:e}),F.push(a)}}let B=new p.default,U=new c.default,H=[],Z=function(r,l,T){let P=r.getProperties(),k=D[P.layer];if(!k)return;let N=s.indexOf(l);-1==N&&(N=(0,y.getZoomForResolution)(l,s));let F=v[r.getGeometry().getType()],Z={id:r.getId(),properties:P,type:F},V=e.get("mapbox-featurestate")[r.getId()],Y=-1;for(let s=0,v=k.length;s<v;++s){var W;let v=k[s],D=v.layer,$=D.id;if(void 0!==T&&T!==$)continue;let X=D.layout||b,K=D.paint||b;if("none"===X.visibility||"minzoom"in D&&N<D.minzoom||"maxzoom"in D&&N>=D.maxzoom)continue;let J=D.filter;if(!J||(W=N,j||console.warn("No filterCache provided to evaluateFilter()"),$ in j||(j[$]=(0,n.featureFilter)(J).filter),S.zoom=W,j[$](S,Z))){let s,n,b,S,T,k,j,W,$,J,Q,ee,et,er,ei;let ea=v.index;if(3==F&&("fill"==D.type||"fill-extrusion"==D.type)){if(n=w(D,"paint",D.type+"-opacity",N,Z,q,V),D.type+"-pattern" in K){let e=w(D,"paint",D.type+"-pattern",N,Z,q,V);if(e){let t="string"==typeof e?C(e,P):e.toString();if(L&&x&&x[t]){(!(k=H[++Y])||!k.getFill()||k.getStroke()||k.getText())&&(k=new f.default({fill:new c.default}),H[Y]=k),b=k.getFill(),k.setZIndex(ea);let e=t+"."+n,r=z[e];if(!r){let i=x[t],a=(0,y.createCanvas)(i.width,i.height),s=a.getContext("2d");s.globalAlpha=n,s.drawImage(L,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r=s.createPattern(a,"repeat"),z[e]=r}b.setColor(r)}}}else s=A(w(D,"paint",D.type+"-color",N,Z,q,V),n),D.type+"-outline-color" in K&&(T=A(w(D,"paint",D.type+"-outline-color",N,Z,q,V),n)),T||(T=s),(s||T)&&((!(k=H[++Y])||s&&!k.getFill()||!s&&k.getFill()||T&&!k.getStroke()||!T&&k.getStroke()||k.getText())&&(k=new f.default({fill:s?new c.default:void 0,stroke:T?new p.default:void 0}),H[Y]=k),s&&(b=k.getFill()).setColor(s),T&&((S=k.getStroke()).setColor(T),S.setWidth(.5)),k.setZIndex(ea))}if(1!=F&&"line"==D.type){s="line-pattern"in K?void 0:A(w(D,"paint","line-color",N,Z,q,V),w(D,"paint","line-opacity",N,Z,q,V));let e=w(D,"paint","line-width",N,Z,q,V);s&&e>0&&((!(k=H[++Y])||!k.getStroke()||k.getFill()||k.getText())&&(k=new f.default({stroke:new p.default}),H[Y]=k),(S=k.getStroke()).setLineCap(w(D,"layout","line-cap",N,Z,q,V)),S.setLineJoin(w(D,"layout","line-join",N,Z,q,V)),S.setMiterLimit(w(D,"layout","line-miter-limit",N,Z,q,V)),S.setColor(s),S.setWidth(e),S.setLineDash(K["line-dasharray"]?w(D,"paint","line-dasharray",N,Z,q,V).map(function(t){return t*e}):null),k.setZIndex(ea))}let es=!1,en=null,eo=0;if((1==F||2==F)&&"icon-image"in X){let t=w(D,"layout","icon-image",N,Z,q,V);if(t){let s;j="string"==typeof t?C(t,P):t.toString();let n=I?I(e,j):void 0;if(L&&x&&x[j]||n){let e=w(D,"layout","icon-rotation-alignment",N,Z,q,V);if(2==F){let t=r.getGeometry();if(t.getFlatMidpoint||t.getFlatMidpoints){let r=t.getExtent();if(Math.sqrt(Math.max(Math.pow((r[2]-r[0])/l,2),Math.pow((r[3]-r[1])/l,2)))>150){let r="MultiLineString"===t.getType()?t.getFlatMidpoints():t.getFlatMidpoint();if(a||(i=[NaN,NaN],a=new u.default("Point",i,[],2,{},void 0)),s=a,i[0]=r[0],i[1]=r[1],"line"===w(D,"layout","symbol-placement",N,Z,q,V)&&"map"===e){let e=t.getStride(),i=t.getFlatCoordinates();for(let t=0,a=i.length-e;t<a;t+=e){let a=i[t],s=i[t+1],n=i[t+e],o=i[t+e+1],l=Math.min(a,n),u=Math.max(a,n),h=r[0];if(.001>Math.abs((o-s)*(h-a)-(n-a)*(r[1]-s))&&h<=u&&h>=l){eo=Math.atan2(s-o,n-a);break}}}}}}if(2!==F||s){let t=w(D,"layout","icon-size",N,Z,q,V),r=void 0!==K["icon-color"]?w(D,"paint","icon-color",N,Z,q,V):null;if(!r||0!==r.a){let i=w(D,"paint","icon-halo-color",N,Z,q,V),a=w(D,"paint","icon-halo-width",N,Z,q,V),s=`${j}.${t}.${a}.${i}`;if(null!==r&&(s+=`.${r}`),!(W=G[s])){let o;let l=E(D,N,Z,"icon",q);"icon-offset"in X&&(o=w(D,"layout","icon-offset",N,Z,q,V).slice(0),o[0]*=t,o[1]*=-t);let u=r?[255*r.r,255*r.g,255*r.b,r.a]:void 0;if(n){let r={color:u,rotateWithView:"map"===e,displacement:o,declutterMode:l,scale:t};"string"==typeof n?r.src=n:(r.img=n,r.imgSize=[n.width,n.height]),W=new d.default(r)}else{let s,n,h;let c=x[j];a?c.sdf?(s=(0,y.drawIconHalo)((0,y.drawSDF)(L,c,r||[0,0,0,1]),{x:0,y:0,width:c.width,height:c.height,pixelRatio:c.pixelRatio},a,i),u=void 0):s=(0,y.drawIconHalo)(L,c,a,i):(c.sdf?(M||(M=(0,y.drawSDF)(L,{x:0,y:0,width:O[0],height:O[1]},{r:1,g:1,b:1,a:1})),s=M):s=L,n=[c.width,c.height],h=[c.x,c.y]),W=new d.default({color:u,img:s,imgSize:O,size:n,offset:h,rotateWithView:"map"===e,scale:t/c.pixelRatio,displacement:o,declutterMode:l})}G[s]=W}}W&&((!(k=H[++Y])||!k.getImage()||k.getFill()||k.getStroke())&&(k=new f.default,H[Y]=k),k.setGeometry(s),W.setRotation(eo+(0,y.deg2rad)(w(D,"layout","icon-rotate",N,Z,q,V))),W.setOpacity(w(D,"paint","icon-opacity",N,Z,q,V)),W.setAnchor(_[w(D,"layout","icon-anchor",N,Z,q,V)]),k.setImage(W),en=k.getText(),k.setText(void 0),k.setZIndex(ea),es=!0,$=!1)}else $=!0}}}if(1==F&&"circle"===D.type){(!(k=H[++Y])||!k.getImage()||k.getFill()||k.getStroke())&&(k=new f.default,H[Y]=k);let e="circle-radius"in K?w(D,"paint","circle-radius",N,Z,q,V):5,t=A(w(D,"paint","circle-stroke-color",N,Z,q,V),w(D,"paint","circle-stroke-opacity",N,Z,q,V)),r=w(D,"paint","circle-translate",N,Z,q,V),i=A(w(D,"paint","circle-color",N,Z,q,V),w(D,"paint","circle-opacity",N,Z,q,V)),a=w(D,"paint","circle-stroke-width",N,Z,q,V),s=e+"."+t+"."+i+"."+a+"."+r[0]+"."+r[1];(W=G[s])||(W=new h.default({radius:e,displacement:[r[0],-r[1]],stroke:t&&a>0?new p.default({width:a,color:t}):void 0,fill:i?new c.default({color:i}):void 0,declutterMode:"none"}),G[s]=W),k.setImage(W),en=k.getText(),k.setText(void 0),k.setGeometry(void 0),k.setZIndex(ea),es=!0}if("text-field"in X){et=Math.round(w(D,"layout","text-size",N,Z,q,V));let e=w(D,"layout","text-font",N,Z,q,V);ee=w(D,"layout","text-line-height",N,Z,q,V),(Q=(0,o.default)(R?R(e,t.metadata?t.metadata["ol:webfonts"]:void 0):e,et,ee)).includes("sans-serif")||(Q+=",sans-serif"),er=w(D,"layout","text-letter-spacing",N,Z,q,V),ei=w(D,"layout","text-max-width",N,Z,q,V);let r=w(D,"layout","text-field",N,Z,q,V);J="object"==typeof r&&r.sections?1===r.sections.length?r.toString():r.sections.reduce((t,r,i)=>{let a=r.fontStack?r.fontStack.split(","):e,s=(0,o.default)(R?R(a):a,et*(r.scale||1),ee),n=r.text;if("\n"===n)return t.push("\n",""),t;if(2==F)return t.push((0,g.applyLetterSpacing)(n,er),s),t;n=(0,g.wrapText)(n,s,ei,er).split("\n");for(let e=0,r=n.length;e<r;++e)e>0&&t.push("\n",""),t.push(n[e],s);return t},[]):C(r,P).trim(),n=w(D,"paint","text-opacity",N,Z,q,V)}if(J&&n&&!$){let e;es||((!(k=H[++Y])||!k.getText()||k.getFill()||k.getStroke())&&(k=new f.default,H[Y]=k),k.setImage(void 0),k.setGeometry(void 0));let t=E(D,N,Z,"text",q);k.getText()||k.setText(en),(!(en=k.getText())||"getDeclutterMode"in en&&en.getDeclutterMode()!==t)&&(en=new m.default({padding:[2,2,2,2],declutterMode:t}),k.setText(en));let r=w(D,"layout","text-transform",N,Z,q,V);"uppercase"==r?J=Array.isArray(J)?J.map((e,t)=>t%2?e:e.toUpperCase()):J.toUpperCase():"lowercase"==r&&(J=Array.isArray(J)?J.map((e,t)=>t%2?e:e.toLowerCase()):J.toLowerCase());let i=Array.isArray(J)?J:2==F?(0,g.applyLetterSpacing)(J,er):(0,g.wrapText)(J,Q,ei,er);if(en.setText(i),en.setFont(Q),en.setRotation((0,y.deg2rad)(w(D,"layout","text-rotate",N,Z,q,V))),"function"==typeof en.setKeepUpright){let e=w(D,"layout","text-keep-upright",N,Z,q,V);en.setKeepUpright(e)}let a=w(D,"layout","text-anchor",N,Z,q,V),s=es||1==F?"point":w(D,"layout","symbol-placement",N,Z,q,V);if("line-center"===s?(en.setPlacement("line"),e="center"):en.setPlacement(s),"line"===s&&"function"==typeof en.setRepeat){let e=w(D,"layout","symbol-spacing",N,Z,q,V);en.setRepeat(2*e)}en.setOverflow("point"===s);let o=w(D,"paint","text-halo-width",N,Z,q,V),l=w(D,"layout","text-offset",N,Z,q,V),u=w(D,"paint","text-translate",N,Z,q,V),h=0,c=0;if("point"==s){e="center",-1!==a.indexOf("left")?(e="left",c=o):-1!==a.indexOf("right")&&(e="right",c=-o);let t=w(D,"layout","text-rotation-alignment",N,Z,q,V);en.setRotateWithView("map"==t)}else en.setMaxAngle((0,y.deg2rad)(w(D,"layout","text-max-angle",N,Z,q,V))*J.length/i.length),en.setRotateWithView(!1);en.setTextAlign(e);let d="middle";0==a.indexOf("bottom")?(d="bottom",h=-o-.5*(ee-1)*et):0==a.indexOf("top")&&(d="top",h=o+.5*(ee-1)*et),en.setTextBaseline(d);let p=w(D,"layout","text-justify",N,Z,q,V);en.setJustify("auto"===p?void 0:p),en.setOffsetX(l[0]*et+c+u[0]),en.setOffsetY(l[1]*et+h+u[1]),U.setColor(A(w(D,"paint","text-color",N,Z,q,V),n)),en.setFill(U);let v=A(w(D,"paint","text-halo-color",N,Z,q,V),n);if(v&&o>0){B.setColor(v),o*=2;let e=.5*et;B.setWidth(o<=e?o:e),en.setStroke(B)}else en.setStroke(void 0);let _=w(D,"layout","text-padding",N,Z,q,V),x=en.getPadding();_!==x[0]&&(x[0]=_,x[1]=_,x[2]=_,x[3]=_),k.setZIndex(ea)}}}if(Y>-1)return H.length=Y+1,H};return e.setStyle(Z),e.set("mapbox-source",k),e.set("mapbox-layers",F),e.set("mapbox-featurestate",e.get("mapbox-featurestate")||{}),Z}}),n("6g00w",function(e,r){t(e.exports,"derefLayers",()=>l),t(e.exports,"Color",()=>J),t(e.exports,"isFunction",()=>tD),t(e.exports,"isExpression",()=>tG),t(e.exports,"createPropertyExpression",()=>tB),t(e.exports,"featureFilter",()=>tZ),t(e.exports,"convertFunction",()=>tJ),t(e.exports,"v8",()=>rw);var i,a,s,n={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let o=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function l(e){e=e.slice();let t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=function(e,t){let r={};for(let t in e)"ref"!==t&&(r[t]=e[t]);return o.forEach(e=>{e in t&&(r[e]=t[e])}),r}(e[r],t[e[r].ref]));return e}class u{constructor(e,t,r,i){this.message=(e?`${e}: `:"")+r,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)}}function h(e,...t){for(let r of t)for(let t in r)e[t]=r[t];return e}class c extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class d{constructor(e,t=[]){for(let[r,i]of(this.parent=e,this.bindings={},t))this.bindings[r]=i}concat(e){return new d(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let p={kind:"null"},f={kind:"number"},m={kind:"string"},g={kind:"boolean"},y={kind:"color"},v={kind:"projectionDefinition"},_={kind:"object"},x={kind:"value"},b={kind:"collator"},S={kind:"formatted"},w={kind:"padding"},E={kind:"resolvedImage"},A={kind:"variableAnchorOffsetCollection"};function T(e,t){return{kind:"array",itemType:e,N:t}}function C(e){if("array"!==e.kind)return e.kind;{let t=C(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}}let P=[p,f,m,g,y,v,S,_,T(x),w,E,A];function R(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!R(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else if(e.kind===t.kind)return null;else if("value"===e.kind){for(let e of P)if(!R(e,t))return null}return`Expected ${C(e)} but found ${C(t)} instead.`}function I(e,t){return t.some(t=>t.kind===e.kind)}function L(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}function O(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}let M=4/29,k=6/29,N=6/29*3*(6/29),D=6/29*(6/29)*(6/29),F=Math.PI/180,G=180/Math.PI;function z(e){return(e%=360)<0&&(e+=360),e}function q([e,t,r,i]){let a,s;let n=B((.2225045*(e=j(e))+.7168786*(t=j(t))+.0606169*(r=j(r)))/1);e===t&&t===r?a=s=n:(a=B((.4360747*e+.3850649*t+.1430804*r)/.96422),s=B((.0139322*e+.0971045*t+.7141733*r)/.82521));let o=116*n-16;return[o<0?0:o,500*(a-n),200*(n-s),i]}function j(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function B(e){return e>D?Math.pow(e,1/3):e/N+M}function U([e,t,r,i]){let a=(e+16)/116,s=isNaN(t)?a:a+t/500,n=isNaN(r)?a:a-r/200;return a=1*Z(a),[H(3.1338561*(s=.96422*Z(s))-1.6168667*a-.4906146*(n=.82521*Z(n))),H(-.9787684*s+1.9161415*a+.033454*n),H(.0719453*s-.2289914*a+1.4052427*n),i]}function H(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function Z(e){return e>k?e*e*e:N*(e-M)}function V(e){return parseInt(e.padEnd(2,e),16)/255}function Y(e,t){return W(t?e/100:e,0,1)}function W(e,t,r){return Math.min(Math.max(t,e),r)}function $(e){return!e.some(Number.isNaN)}let X={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function K(e,t,r){return e.map((e,i)=>e+r*(t[i]-e))}class J{constructor(e,t,r,i=1,a=!0){this.r=e,this.g=t,this.b=r,this.a=i,a||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,t,r,i]))}static parse(e){if(e instanceof J)return e;if("string"!=typeof e)return;let t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];let t=X[e];if(t){let[e,r,i]=t;return[e/255,r/255,i/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){let t=e.length<6?1:2,r=1;return[V(e.slice(r,r+=t)),V(e.slice(r,r+=t)),V(e.slice(r,r+=t)),V(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){let t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){let[e,r,i,a,s,n,o,l,u,h,c,d]=t,p=[a||" ",o||" ",h].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){let e=[i,n,u].join(""),t="%%%"===e?100:""===e?255:0;if(t){let e=[W(+r/t,0,1),W(+s/t,0,1),W(+l/t,0,1),c?Y(+c,d):1];if($(e))return e}}return}}let r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){let[e,t,i,a,s,n,o,l,u]=r,h=[i||" ",s||" ",o].join("");if("  "===h||"  /"===h||",,"===h||",,,"===h){let e=[+t,W(+a,0,100),W(+n,0,100),l?Y(+l,u):1];if($(e))return function([e,t,r,i]){function a(i){let a=(i+e/30)%12,s=t*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return e=z(e),t/=100,r/=100,[a(0),a(8),a(4),i]}(e)}}}(e);if(t)return new J(...t,!1)}get rgb(){let{r:e,g:t,b:r,a:i}=this,a=i||1/0;return this.overwriteGetter("rgb",[e/a,t/a,r/a,i])}get hcl(){return this.overwriteGetter("hcl",function(e){let[t,r,i,a]=q(e),s=Math.sqrt(r*r+i*i);return[Math.round(1e4*s)?z(Math.atan2(i,r)*G):NaN,s,t,a]}(this.rgb))}get lab(){return this.overwriteGetter("lab",q(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,i]=this.rgb;return`rgba(${[e,t,r].map(e=>Math.round(255*e)).join(",")},${i})`}static interpolate(e,t,r,i="rgb"){switch(i){case"rgb":{let[i,a,s,n]=K(e.rgb,t.rgb,r);return new J(i,a,s,n,!1)}case"hcl":{let i,a;let[s,n,o,l]=e.hcl,[u,h,c,d]=t.hcl;if(isNaN(s)||isNaN(u))isNaN(s)?isNaN(u)?i=NaN:(i=u,(1===o||0===o)&&(a=h)):(i=s,(1===c||0===c)&&(a=n));else{let e=u-s;u>s&&e>180?e-=360:u<s&&s-u>180&&(e+=360),i=s+r*e}let[p,f,m,g]=function([e,t,r,i]){return U([r,Math.cos(e=isNaN(e)?0:e*F)*t,Math.sin(e)*t,i])}([i,null!=a?a:n+r*(h-n),o+r*(c-o),l+r*(d-l)]);return new J(p,f,m,g,!1)}case"lab":{let[i,a,s,n]=U(K(e.lab,t.lab,r));return new J(i,a,s,n,!1)}}}}J.black=new J(0,0,0,1),J.white=new J(1,1,1,1),J.transparent=new J(0,0,0,0),J.red=new J(1,0,0,1);class Q{constructor(e,t,r){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let ee=["bottom","center","top"];class et{constructor(e,t,r,i,a,s){this.text=e,this.image=t,this.scale=r,this.fontStack=i,this.textColor=a,this.verticalAlign=s}}class er{constructor(e){this.sections=e}static fromString(e){return new er([new et(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof er?e:er.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class ei{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ei)return e;if("number"==typeof e)return new ei([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1)&&!(e.length>4)){for(let t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ei(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new ei(K(e.values,t.values,r))}}class ea{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let es=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class en{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof en)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){let r=e[t],i=e[t+1];if("string"!=typeof r||!es.has(r)||!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new en(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){let i=e.values,a=t.values;if(i.length!==a.length)throw new ea(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);let s=[];for(let e=0;e<i.length;e+=2){if(i[e]!==a[e])throw new ea(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${i[e]}, to[${e}]: ${a[e]}`);s.push(i[e]);let[t,n]=i[e+1],[o,l]=a[e+1];s.push([t+r*(o-t),n+r*(l-n)])}return new en(s)}}class eo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new eo({name:e,available:!1}):null}}class el{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new el(e,t,r)}static parse(e){return e instanceof el?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new el(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new el(e.from,e.to,e.transition):"string"==typeof e?new el(e,e,1):void 0}}function eu(e,t,r,i){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[e,t,r,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[e,t,r,i]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function eh(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof el||e instanceof J||e instanceof Q||e instanceof er||e instanceof ei||e instanceof en||e instanceof eo)return!0;if(Array.isArray(e)){for(let t of e)if(!eh(t))return!1;return!0}if("object"!=typeof e)return!1;for(let t in e)if(!eh(e[t]))return!1;return!0}function ec(e){if(null===e)return p;if("string"==typeof e)return m;if("boolean"==typeof e)return g;{let t;if("number"==typeof e)return f;if(e instanceof J)return y;if(e instanceof el)return v;if(e instanceof Q)return b;if(e instanceof er)return S;if(e instanceof ei)return w;if(e instanceof en)return A;if(e instanceof eo)return E;if(!Array.isArray(e))return _;let r=e.length;for(let r of e){let e=ec(r);if(t){if(t===e)continue;t=x;break}t=e}return T(t||x,r)}}function ed(e){let t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof J||e instanceof el||e instanceof er||e instanceof ei||e instanceof en||e instanceof eo?e.toString():JSON.stringify(e)}class ep{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!eh(e[1]))return t.error("invalid value");let r=e[1],i=ec(r),a=t.expectedType;return"array"===i.kind&&0===i.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(i=a),new ep(i,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let ef={string:m,number:f,boolean:g,object:_};class em{constructor(e,t){this.type=e,this.args=t}static parse(e,t){let r;if(e.length<2)return t.error("Expected at least one argument.");let i=1,a=e[0];if("array"===a){let a,s;if(e.length>2){let r=e[1];if("string"!=typeof r||!(r in ef)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);a=ef[r],i++}else a=x;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);s=e[2],i++}r=T(a,s)}else{if(!ef[a])throw Error(`Types doesn't contain name = ${a}`);r=ef[a]}let s=[];for(;i<e.length;i++){let r=t.parse(e[i],i,x);if(!r)return null;s.push(r)}return new em(r,s)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(!R(this.type,ec(r)))return r;if(t===this.args.length-1)throw new ea(`Expected value to be of type ${C(this.type)}, but found ${C(ec(r))} instead.`)}throw Error()}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let eg={"to-boolean":g,"to-color":y,"to-number":f,"to-string":m};class ey{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[0];if(!eg[r])throw Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");let i=eg[r],a=[];for(let r=1;r<e.length;r++){let i=t.parse(e[r],r,x);if(!i)return null;a.push(i)}return new ey(i,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let i of this.args){if(t=i.evaluate(e),r=null,t instanceof J)return t;if("string"==typeof t){let r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:eu(t[0],t[1],t[2],t[3])))return new J(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ea(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let i=ei.parse(t);if(i)return i}throw new ea(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let i=en.parse(t);if(i)return i}throw new ea(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(let r of this.args){if(null===(t=r.evaluate(e)))return 0;let i=Number(t);if(!isNaN(i))return i}throw new ea(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return er.fromString(ed(this.args[0].evaluate(e)));case"resolvedImage":return eo.fromString(ed(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return ed(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let ev=["Unknown","Point","LineString","Polygon"];class e_{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ev[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=J.parse(e)),t}}class ex{constructor(e,t,r=[],i,a=new d,s=[]){this.registry=e,this.path=r,this.key=r.map(e=>`[${e}]`).join(""),this.scope=a,this.errors=s,this.expectedType=i,this._isConstant=t}parse(e,t,r,i,a={}){return t?this.concat(t,r,i)._parse(e,a):this._parse(e,a)}_parse(e,t){function r(e,t,r){return"assert"===r?new em(t,[e]):"coerce"===r?new ey(t,[e]):e}if((null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)&&(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let a=this.registry[i];if(a){let i=a.parse(e,this);if(!i)return null;if(this.expectedType){let e=this.expectedType,a=i.type;if(("string"===e.kind||"number"===e.kind||"boolean"===e.kind||"object"===e.kind||"array"===e.kind)&&"value"===a.kind)i=r(i,e,t.typeAnnotation||"assert");else if("projectionDefinition"===e.kind&&("string"===a.kind||"array"===a.kind))i=r(i,e,t.typeAnnotation||"coerce");else if(("color"===e.kind||"formatted"===e.kind||"resolvedImage"===e.kind)&&("value"===a.kind||"string"===a.kind))i=r(i,e,t.typeAnnotation||"coerce");else if("padding"===e.kind&&("value"===a.kind||"number"===a.kind||"array"===a.kind))i=r(i,e,t.typeAnnotation||"coerce");else if("variableAnchorOffsetCollection"===e.kind&&("value"===a.kind||"array"===a.kind))i=r(i,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,a))return null}if(!(i instanceof ep)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){let e=new e_;try{i=new ep(i.type,i.evaluate(e))}catch(e){return this.error(e.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){let i="number"==typeof e?this.path.concat(e):this.path,a=r?this.scope.concat(r):this.scope;return new ex(this.registry,this._isConstant,i,t||null,a,this.errors)}error(e,...t){let r=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new c(r,e))}checkSubtype(e,t){let r=R(e,t);return r&&this.error(r),r}}class eb{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let r=[];for(let i=1;i<e.length-1;i+=2){let a=e[i];if("string"!=typeof a)return t.error(`Expected string, but found ${typeof a} instead.`,i);if(/[^a-zA-Z0-9_]/.test(a))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);let s=t.parse(e[i+1],i+1);if(!s)return null;r.push([a,s])}let i=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return i?new eb(r,i):null}outputDefined(){return this.result.outputDefined()}}class eS{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");let r=e[1];return t.scope.has(r)?new eS(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class ew{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,f),i=t.parse(e[2],2,T(t.expectedType||x));return r&&i?new ew(i.type.itemType,r,i):null}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ea(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new ea(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new ea(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class eE{constructor(e,t){this.type=g,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,x),i=t.parse(e[2],2,x);return r&&i?I(r.type,[g,m,f,p,x])?new eE(r,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${C(r.type)} instead`):null}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!L(t,["boolean","string","number","null"]))throw new ea(`Expected first argument to be of type boolean, string, number or null, but found ${C(ec(t))} instead.`);if(!L(r,["string","array"]))throw new ea(`Expected second argument to be of type array or string, but found ${C(ec(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class eA{constructor(e,t,r){this.type=f,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,x),i=t.parse(e[2],2,x);if(!r||!i)return null;if(!I(r.type,[g,m,f,p,x]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${C(r.type)} instead`);if(4!==e.length)return new eA(r,i);{let a=t.parse(e[3],3,f);return a?new eA(r,i,a):null}}evaluate(e){let t;let r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!L(r,["boolean","string","number","null"]))throw new ea(`Expected first argument to be of type boolean, string, number or null, but found ${C(ec(r))} instead.`);if(this.fromIndex&&(t=this.fromIndex.evaluate(e)),L(i,["string"])){let e=i.indexOf(r,t);return -1===e?-1:[...i.slice(0,e)].length}if(L(i,["array"]))return i.indexOf(r,t);throw new ea(`Expected second argument to be of type array or string, but found ${C(ec(i))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class eT{constructor(e,t,r,i,a,s){this.inputType=e,this.type=t,this.input=r,this.cases=i,this.outputs=a,this.otherwise=s}static parse(e,t){let r,i;if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);let a={},s=[];for(let n=2;n<e.length-1;n+=2){let o=e[n],l=e[n+1];Array.isArray(o)||(o=[o]);let u=t.concat(n);if(0===o.length)return u.error("Expected at least one branch label.");for(let e of o){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ec(e)))return null}else r=ec(e);if(void 0!==a[String(e)])return u.error("Branch labels must be unique.");a[String(e)]=s.length}let h=t.parse(l,n,i);if(!h)return null;i=i||h.type,s.push(h)}let n=t.parse(e[1],1,x);if(!n)return null;let o=t.parse(e[e.length-1],e.length-1,i);return!o||"value"!==n.type.kind&&t.concat(1).checkSubtype(r,n.type)?null:new eT(r,i,n,a,s,o)}evaluate(e){let t=this.input.evaluate(e);return(ec(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class eC{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){let r;if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=t.parse(e[a],a,g);if(!s)return null;let n=t.parse(e[a+1],a+1,r);if(!n)return null;i.push([s,n]),r=r||n.type}let a=t.parse(e[e.length-1],e.length-1,r);if(!a)return null;if(!r)throw Error("Can't infer output type");return new eC(r,i,a)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class eP{constructor(e,t,r,i){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,x),i=t.parse(e[2],2,f);if(!r||!i)return null;if(!I(r.type,[T(x),m,x]))return t.error(`Expected first argument to be of type array or string, but found ${C(r.type)} instead`);if(4!==e.length)return new eP(r.type,r,i);{let a=t.parse(e[3],3,f);return a?new eP(r.type,r,i,a):null}}evaluate(e){let t;let r=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(this.endIndex&&(t=this.endIndex.evaluate(e)),L(r,["string"]))return[...r].slice(i,t).join("");if(L(r,["array"]))return r.slice(i,t);throw new ea(`Expected first argument to be of type array or string, but found ${C(ec(r))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function eR(e,t){let r,i;let a=e.length-1,s=0,n=a,o=0;for(;s<=n;)if(r=e[o=Math.floor((s+n)/2)],i=e[o+1],r<=t){if(o===a||t<i)return o;s=o+1}else if(r>t)n=o-1;else throw new ea("Input is not a number.");return 0}class eI{constructor(e,t,r){for(let[i,a]of(this.type=e,this.input=t,this.labels=[],this.outputs=[],r))this.labels.push(i),this.outputs.push(a)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");let r=t.parse(e[1],1,f);if(!r)return null;let i=[],a=null;t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let r=1;r<e.length;r+=2){let s=1===r?-1/0:e[r],n=e[r+1],o=r,l=r+1;if("number"!=typeof s)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(i.length&&i[i.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);let u=t.parse(n,l,a);if(!u)return null;a=a||u.type,i.push([s,u])}return new eI(a,r,i)}evaluate(e){let t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let a=t.length;return i>=t[a-1]?r[a-1].evaluate(e):r[eR(t,i)].evaluate(e)}eachChild(e){for(let t of(e(this.input),this.outputs))e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}var eL=(s=function(){if(a)return i;function e(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=i}return a=1,i=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,i=0;i<8;i++){var a=this.sampleCurveX(r)-e;if(Math.abs(a)<t)return r;var s=this.sampleCurveDerivativeX(r);if(1e-6>Math.abs(s))break;r-=a/s}var n=0,o=1;for(i=0,r=e;i<20&&!(Math.abs((a=this.sampleCurveX(r))-e)<t);i++)e>a?n=r:o=r,r=(o-n)*.5+n;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},i}())&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s;class eO{constructor(e,t,r,i,a){for(let[s,n]of(this.type=e,this.operator=t,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[],a))this.labels.push(s),this.outputs.push(n)}static interpolationFactor(e,t,r,i){let a=0;if("exponential"===e.name)a=eM(t,e.base,r,i);else if("linear"===e.name)a=eM(t,1,r,i);else if("cubic-bezier"===e.name){let s=e.controlPoints;a=new eL(s[0],s[1],s[2],s[3]).solve(eM(t,1,r,i))}return a}static parse(e,t){let[r,i,a,...s]=e;if(!Array.isArray(i)||0===i.length)return t.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){let e=i[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:e}}else{if("cubic-bezier"!==i[0])return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);let e=i.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:e}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(a=t.parse(a,2,f)))return null;let n=[],o=null;"interpolate-hcl"===r||"interpolate-lab"===r?o=y:t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let e=0;e<s.length;e+=2){let r=s[e],i=s[e+1],a=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',a);let u=t.parse(i,l,o);if(!u)return null;o=o||u.type,n.push([r,u])}return O(o,f)||O(o,v)||O(o,y)||O(o,w)||O(o,A)||O(o,T(f))?new eO(o,r,i,a,n):t.error(`Type ${C(o)} is not interpolatable.`)}evaluate(e){let t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let a=t.length;if(i>=t[a-1])return r[a-1].evaluate(e);let s=eR(t,i),n=t[s],o=t[s+1],l=eO.interpolationFactor(this.interpolation,i,n,o),u=r[s].evaluate(e),h=r[s+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return u+l*(h-u);case"color":return J.interpolate(u,h,l);case"padding":return ei.interpolate(u,h,l);case"variableAnchorOffsetCollection":return en.interpolate(u,h,l);case"array":return K(u,h,l);case"projectionDefinition":return el.interpolate(u,h,l)}case"interpolate-hcl":return J.interpolate(u,h,l,"hcl");case"interpolate-lab":return J.interpolate(u,h,l,"lab")}}eachChild(e){for(let t of(e(this.input),this.outputs))e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function eM(e,t,r,i){let a=i-r,s=e-r;return 0===a?0:1===t?s/a:(Math.pow(t,s)-1)/(Math.pow(t,a)-1)}J.interpolate,ei.interpolate,en.interpolate;class ek{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null,i=t.expectedType;i&&"value"!==i.kind&&(r=i);let a=[];for(let i of e.slice(1)){let e=t.parse(i,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,a.push(e)}if(!r)throw Error("No output type");return i&&a.some(e=>R(i,e.type))?new ek(x,a):new ek(r,a)}evaluate(e){let t,r=null,i=0;for(let a of this.args)if(i++,(r=a.evaluate(e))&&r instanceof eo&&!r.available&&(t||(t=r.name),r=null,i===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function eN(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function eD(e,t,r,i){return 0===i.compare(t,r)}function eF(e,t,r){let i="=="!==e&&"!="!==e;return class a{constructor(e,t,r){this.type=g,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");let r=e[0],s=t.parse(e[1],1,x);if(!s)return null;if(!eN(r,s.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${C(s.type)}'.`);let n=t.parse(e[2],2,x);if(!n)return null;if(!eN(r,n.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${C(n.type)}'.`);if(s.type.kind!==n.type.kind&&"value"!==s.type.kind&&"value"!==n.type.kind)return t.error(`Cannot compare types '${C(s.type)}' and '${C(n.type)}'.`);i&&("value"===s.type.kind&&"value"!==n.type.kind?s=new em(n.type,[s]):"value"!==s.type.kind&&"value"===n.type.kind&&(n=new em(s.type,[n])));let o=null;if(4===e.length){if("string"!==s.type.kind&&"string"!==n.type.kind&&"value"!==s.type.kind&&"value"!==n.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(o=t.parse(e[3],3,b)))return null}return new a(s,n,o)}evaluate(a){let s=this.lhs.evaluate(a),n=this.rhs.evaluate(a);if(i&&this.hasUntypedArgument){let t=ec(s),r=ec(n);if(t.kind!==r.kind||!("string"===t.kind||"number"===t.kind))throw new ea(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){let e=ec(s),r=ec(n);if("string"!==e.kind||"string"!==r.kind)return t(a,s,n)}return this.collator?r(a,s,n,this.collator.evaluate(a)):t(a,s,n)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}let eG=eF("==",function(e,t,r){return t===r},eD),ez=eF("!=",function(e,t,r){return t!==r},function(e,t,r,i){return!eD(e,t,r,i)}),eq=eF("<",function(e,t,r){return t<r},function(e,t,r,i){return 0>i.compare(t,r)}),ej=eF(">",function(e,t,r){return t>r},function(e,t,r,i){return i.compare(t,r)>0}),eB=eF("<=",function(e,t,r){return t<=r},function(e,t,r,i){return 0>=i.compare(t,r)}),eU=eF(">=",function(e,t,r){return t>=r},function(e,t,r,i){return i.compare(t,r)>=0});class eH{constructor(e,t,r){this.type=b,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");let r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");let i=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,g);if(!i)return null;let a=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,g);if(!a)return null;let s=null;return!r.locale||(s=t.parse(r.locale,1,m))?new eH(i,a,s):null}evaluate(e){return new Q(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class eZ{constructor(e,t,r,i,a){this.type=m,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=a}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");let r=t.parse(e[1],1,f);if(!r)return null;let i=e[2];if("object"!=typeof i||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let a=null;if(i.locale&&!(a=t.parse(i.locale,1,m)))return null;let s=null;if(i.currency&&!(s=t.parse(i.currency,1,m)))return null;let n=null;if(i["min-fraction-digits"]&&!(n=t.parse(i["min-fraction-digits"],1,f)))return null;let o=null;return!i["max-fraction-digits"]||(o=t.parse(i["max-fraction-digits"],1,f))?new eZ(r,a,s,n,o):null}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class eV{constructor(e){this.type=S,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");let i=[],a=!1;for(let r=1;r<=e.length-1;++r){let s=e[r];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;let e=null;if(s["font-scale"]&&!(e=t.parse(s["font-scale"],1,f)))return null;let r=null;if(s["text-font"]&&!(r=t.parse(s["text-font"],1,T(m))))return null;let n=null;if(s["text-color"]&&!(n=t.parse(s["text-color"],1,y)))return null;let o=null;if(s["vertical-align"]){if("string"==typeof s["vertical-align"]&&!ee.includes(s["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${s["vertical-align"]}' instead.`);if(!(o=t.parse(s["vertical-align"],1,m)))return null}let l=i[i.length-1];l.scale=e,l.font=r,l.textColor=n,l.verticalAlign=o}else{let s=t.parse(e[r],1,x);if(!s)return null;let n=s.type.kind;if("string"!==n&&"value"!==n&&"null"!==n&&"resolvedImage"!==n)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:s,scale:null,font:null,textColor:null,verticalAlign:null})}}return new eV(i)}evaluate(e){return new er(this.sections.map(t=>{let r=t.content.evaluate(e);return ec(r)===E?new et("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new et(ed(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)}))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class eY{constructor(e){this.type=E,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");let r=t.parse(e[1],1,m);return r?new eY(r):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=eo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class eW{constructor(e){this.type=f,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${C(r.type)} instead.`):new eW(r):null}evaluate(e){let t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new ea(`Expected value to be of type string or array, but found ${C(ec(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}function e$(e,t){let r=Math.pow(2,t.z);return[(e[0]/8192+t.x)/r*360-180,360/Math.PI*Math.atan(Math.exp((180-(e[1]/8192+t.y)/r*360)*Math.PI/180))-90]}function eX(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function eK(e,t){return!(e[0]<=t[0])&&!(e[2]>=t[2])&&!(e[1]<=t[1])&&!(e[3]>=t[3])}function eJ(e,t,r,i){var a;let s=[t[0]-e[0],t[1]-e[1]];return 0!=(a=[i[0]-r[0],i[1]-r[1]])[0]*s[1]-a[1]*s[0]&&!!(e1(e,t,r,i)&&e1(r,i,e,t))}function eQ(e,t,r=!1){let i=!1;for(let n of t)for(let t=0;t<n.length-1;t++){var a,s;if(function(e,t,r){let i=e[0]-t[0],a=e[1]-t[1],s=e[0]-r[0],n=e[1]-r[1];return i*n-s*a==0&&i*s<=0&&a*n<=0}(e,n[t],n[t+1]))return r;a=n[t],s=n[t+1],a[1]>e[1]!=s[1]>e[1]&&e[0]<(s[0]-a[0])*(e[1]-a[1])/(s[1]-a[1])+a[0]&&(i=!i)}return i}function e0(e,t){for(let r of e)if(!eQ(r,t))return!1;for(let r=0;r<e.length-1;++r)if(function(e,t,r){for(let i of r)for(let r=0;r<i.length-1;++r)if(eJ(e,t,i[r],i[r+1]))return!0;return!1}(e[r],e[r+1],t))return!1;return!0}function e1(e,t,r,i){let a=e[0]-r[0],s=e[1]-r[1],n=t[0]-r[0],o=t[1]-r[1],l=i[0]-r[0],u=i[1]-r[1],h=a*u-l*s,c=n*u-l*o;return h>0&&c<0||h<0&&c>0}function e2(e,t,r){let i=[];for(let a=0;a<e.length;a++){let s=[];for(let i=0;i<e[a].length;i++){let n=function(e,t){let r=(180+e[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,a=Math.pow(2,t.z);return[Math.round(r*a*8192),Math.round(i*a*8192)]}(e[a][i],r);eX(t,n),s.push(n)}i.push(s)}return i}function e5(e,t,r){let i=[];for(let a=0;a<e.length;a++){let s=e2(e[a],t,r);i.push(s)}return i}function e3(e,t,r,i){if(e[0]<r[0]||e[0]>r[2]){let t=.5*i,a=e[0]-r[0]>t?-i:r[0]-e[0]>t?i:0;0===a&&(a=e[0]-r[2]>t?-i:r[2]-e[0]>t?i:0),e[0]+=a}eX(t,e)}function e4(e,t,r,i){let a=8192*Math.pow(2,i.z),s=[8192*i.x,8192*i.y],n=[];for(let i of e)for(let e of i){let i=[e.x+s[0],e.y+s[1]];e3(i,t,r,a),n.push(i)}return n}function e6(e,t,r,i){let a=8192*Math.pow(2,i.z),s=[8192*i.x,8192*i.y],n=[];for(let r of e){let e=[];for(let i of r){let r=[i.x+s[0],i.y+s[1]];eX(t,r),e.push(r)}n.push(e)}if(t[2]-t[0]<=a/2)for(let e of(t[0]=t[1]=1/0,t[2]=t[3]=-1/0,n))for(let i of e)e3(i,t,r,a);return n}class e8{constructor(e,t){this.type=g,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(eh(e[1])){let t=e[1];if("FeatureCollection"===t.type){let e=[];for(let r of t.features){let{type:t,coordinates:i}=r.geometry;"Polygon"===t&&e.push(i),"MultiPolygon"===t&&e.push(...i)}if(e.length)return new e8(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){let e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new e8(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new e8(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){let s=e2(t.coordinates,i,a),n=e4(e.geometry(),r,i,a);if(!eK(r,i))return!1;for(let e of n)if(!eQ(e,s))return!1}if("MultiPolygon"===t.type){let s=e5(t.coordinates,i,a),n=e4(e.geometry(),r,i,a);if(!eK(r,i))return!1;for(let e of n)if(!function(e,t){for(let r of t)if(eQ(e,r))return!0;return!1}(e,s))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){let s=e2(t.coordinates,i,a),n=e6(e.geometry(),r,i,a);if(!eK(r,i))return!1;for(let e of n)if(!e0(e,s))return!1}if("MultiPolygon"===t.type){let s=e5(t.coordinates,i,a),n=e6(e.geometry(),r,i,a);if(!eK(r,i))return!1;for(let e of n)if(!function(e,t){for(let r of t)if(e0(e,r))return!0;return!1}(e,s))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class e7{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let a=e-1>>1,s=t[a];if(r(i,s)>=0)break;t[e]=s,e=a}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,a=t[e];for(;e<i;){let i=(e<<1)+1,s=i+1;if(s<this.length&&0>r(t[s],t[i])&&(i=s),r(t[i],a)>=0)break;t[e]=t[i],e=i}t[e]=a}}function e9(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function te(e,t){return t.area-e.area}let tt=1/298.257223563*(2-1/298.257223563),tr=Math.PI/180;class ti{constructor(e){let t=6378137*tr,r=Math.cos(e*tr),i=1/(1-tt*(1-r*r)),a=Math.sqrt(i);this.kx=t*a*r,this.ky=t*a*i*(1-tt)}distance(e,t){let r=this.wrap(e[0]-t[0])*this.kx,i=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+i*i)}pointOnLine(e,t){let r,i,a,s,n=1/0;for(let o=0;o<e.length-1;o++){let l=e[o][0],u=e[o][1],h=this.wrap(e[o+1][0]-l)*this.kx,c=(e[o+1][1]-u)*this.ky,d=0;(0!==h||0!==c)&&((d=(this.wrap(t[0]-l)*this.kx*h+(t[1]-u)*this.ky*c)/(h*h+c*c))>1?(l=e[o+1][0],u=e[o+1][1]):d>0&&(l+=h/this.kx*d,u+=c/this.ky*d));let p=(h=this.wrap(t[0]-l)*this.kx)*h+(c=(t[1]-u)*this.ky)*c;p<n&&(n=p,r=l,i=u,a=o,s=d)}return{point:[r,i],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function ta(e,t){return t[0]-e[0]}function ts(e){return e[1]-e[0]+1}function tn(e,t){return e[1]>=e[0]&&e[1]<t}function to(e,t){if(e[0]>e[1])return[null,null];let r=ts(e);if(t){if(2===r)return[e,null];let t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];let i=Math.floor(r/2)-1;return[[e[0],e[0]+i],[e[0]+i+1,e[1]]]}function tl(e,t){if(!tn(t,e.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let i=t[0];i<=t[1];++i)eX(r,e[i]);return r}function tu(e){let t=[1/0,1/0,-1/0,-1/0];for(let r of e)for(let e of r)eX(t,e);return t}function th(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function tc(e,t,r){if(!th(e)||!th(t))return NaN;let i=0,a=0;return e[2]<t[0]&&(i=t[0]-e[2]),e[0]>t[2]&&(i=e[0]-t[2]),e[1]>t[3]&&(a=e[1]-t[3]),e[3]<t[1]&&(a=t[1]-e[3]),r.distance([0,0],[i,a])}function td(e,t,r){let i=r.pointOnLine(t,e);return r.distance(e,i.point)}function tp(e,t,r,i,a){return Math.min(Math.min(td(e,[r,i],a),td(t,[r,i],a)),Math.min(td(r,[e,t],a),td(i,[e,t],a)))}function tf(e,t){for(let r of e)for(let e of r)if(eQ(e,t,!0))return!0;return!1}function tm(e,t,r,i,a,s){if(!s)return;let n=tc(tl(i,s),a,r);n<t&&e.push([n,s,[0,0]])}function tg(e,t,r,i,a,s,n){if(!s||!n)return;let o=tc(tl(i,s),tl(a,n),r);o<t&&e.push([o,s,n])}function ty(e,t,r,i,a=1/0){let s=Math.min(i.distance(e[0],r[0][0]),a);if(0===s)return s;let n=new e7([[0,[0,e.length-1],[0,0]]],ta),o=tu(r);for(;n.length>0;){let a=n.pop();if(a[0]>=s)continue;let l=a[1],u=t?50:100;if(ts(l)<=u){if(!tn(l,e.length))return NaN;if(t){let t=function(e,t,r,i){if(!tn(t,e.length))return NaN;for(let i=t[0];i<=t[1];++i)if(eQ(e[i],r,!0))return 0;let a=1/0;for(let s=t[0];s<t[1];++s){let t=e[s],n=e[s+1];for(let e of r)for(let r=0,s=e.length,o=s-1;r<s;o=r++){let s=e[o],l=e[r];if(eJ(t,n,s,l))return 0;a=Math.min(a,tp(t,n,s,l,i))}}return a}(e,l,r,i);if(isNaN(t)||0===t)return t;s=Math.min(s,t)}else for(let t=l[0];t<=l[1];++t)if(0===(s=Math.min(s,function(e,t,r){if(eQ(e,t,!0))return 0;let i=1/0;for(let a of t){let t=a[0],s=a[a.length-1];if(t!==s&&0===(i=Math.min(i,td(e,[s,t],r))))break;let n=r.pointOnLine(a,e);if(0===(i=Math.min(i,r.distance(e,n.point))))break}return i}(e[t],r,i))))return 0}else{let r=to(l,t);tm(n,s,i,e,o,r[0]),tm(n,s,i,e,o,r[1])}}return s}function tv(e,t,r,i,a,s=1/0){let n=Math.min(s,a.distance(e[0],r[0]));if(0===n)return n;let o=new e7([[0,[0,e.length-1],[0,r.length-1]]],ta);for(;o.length>0;){let s=o.pop();if(s[0]>=n)continue;let l=s[1],u=s[2],h=t?50:100,c=i?50:100;if(ts(l)<=h&&ts(u)<=c){if(!tn(l,e.length)&&tn(u,r.length))return NaN;if(t&&i)n=Math.min(n,function(e,t,r,i,a){if(!(tn(t,e.length)&&tn(i,r.length)))return 1/0;let s=1/0;for(let n=t[0];n<t[1];++n){let t=e[n],o=e[n+1];for(let e=i[0];e<i[1];++e){let i=r[e],n=r[e+1];if(eJ(t,o,i,n))return 0;s=Math.min(s,tp(t,o,i,n,a))}}return s}(e,l,r,u,a));else if(t&&!i){let t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(0===(n=Math.min(n,td(r[e],t,a))))return n}else if(!t&&i){let t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(0===(n=Math.min(n,td(e[r],t,a))))return n}else n=Math.min(n,function(e,t,r,i,a){if(!(tn(t,e.length)&&tn(i,r.length)))return NaN;let s=1/0;for(let n=t[0];n<=t[1];++n)for(let t=i[0];t<=i[1];++t)if(0===(s=Math.min(s,a.distance(e[n],r[t]))))return s;return s}(e,l,r,u,a))}else{let s=to(l,t),h=to(u,i);tg(o,n,a,e,r,s[0],h[0]),tg(o,n,a,e,r,s[0],h[1]),tg(o,n,a,e,r,s[1],h[0]),tg(o,n,a,e,r,s[1],h[1])}}return n}function t_(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class tx{constructor(e,t){this.type=f,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(eh(e[1])){let t=e[1];if("FeatureCollection"===t.type)return new tx(t,t.features.map(e=>t_(e.geometry)).flat());if("Feature"===t.type)return new tx(t,t_(t.geometry));if("type"in t&&"coordinates"in t)return new tx(t,t_(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){let r=e.geometry(),i=r.flat().map(t=>e$([t.x,t.y],e.canonical));if(0===r.length)return NaN;let a=new ti(i[0][1]),s=1/0;for(let e of t){switch(e.type){case"Point":s=Math.min(s,tv(i,!1,[e.coordinates],!1,a,s));break;case"LineString":s=Math.min(s,tv(i,!1,e.coordinates,!0,a,s));break;case"Polygon":s=Math.min(s,ty(i,!1,e.coordinates,a,s))}if(0===s)break}return s}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){let r=e.geometry(),i=r.flat().map(t=>e$([t.x,t.y],e.canonical));if(0===r.length)return NaN;let a=new ti(i[0][1]),s=1/0;for(let e of t){switch(e.type){case"Point":s=Math.min(s,tv(i,!0,[e.coordinates],!1,a,s));break;case"LineString":s=Math.min(s,tv(i,!0,e.coordinates,!0,a,s));break;case"Polygon":s=Math.min(s,ty(i,!0,e.coordinates,a,s))}if(0===s)break}return s}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){let r=e.geometry();if(0===r.length||0===r[0].length)return NaN;let i=(function(e,t){let r,i;if(e.length<=1)return[e];let a=[];for(let t of e){let e=function(e){let t=0;for(let r=0,i=e.length,a=i-1,s,n;r<i;a=r++)s=e[r],t+=((n=e[a]).x-s.x)*(s.y+n.y);return t}(t);0!==e&&(t.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(r&&a.push(r),r=[t]):r.push(t))}if(r&&a.push(r),t>1)for(let e=0;e<a.length;e++)a[e].length<=t||(function e(t,r,i=0,a=t.length-1,s=function(e,t){return e<t?-1:e>t?1:0}){for(;a>i;){if(a-i>600){let n=a-i+1,o=r-i+1,l=Math.log(n),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(n-u)/n)*(o-n/2<0?-1:1),c=Math.max(i,Math.floor(r-o*u/n+h)),d=Math.min(a,Math.floor(r+(n-o)*u/n+h));e(t,r,c,d,s)}let n=t[r],o=i,l=a;for(e9(t,i,r),s(t[a],n)>0&&e9(t,i,a);o<l;){for(e9(t,o,l),o++,l--;0>s(t[o],n);)o++;for(;s(t[l],n)>0;)l--}0===s(t[i],n)?e9(t,i,l):e9(t,++l,a),l<=r&&(i=l+1),r<=l&&(a=l-1)}}(a[e],t,1,a[e].length-1,te),a[e]=a[e].slice(0,t));return a})(r,0).map(t=>t.map(t=>t.map(t=>e$([t.x,t.y],e.canonical)))),a=new ti(i[0][0][0][1]),s=1/0;for(let e of t)for(let t of i){switch(e.type){case"Point":s=Math.min(s,ty([e.coordinates],!1,t,a,s));break;case"LineString":s=Math.min(s,ty(e.coordinates,!0,t,a,s));break;case"Polygon":s=Math.min(s,function(e,t,r,i=1/0){let a=tu(e),s=tu(t);if(i!==1/0&&tc(a,s,r)>=i)return i;if(eK(a,s)){if(tf(e,t))return 0}else if(tf(t,e))return 0;let n=1/0;for(let i of e)for(let e=0,a=i.length,s=a-1;e<a;s=e++){let a=i[s],o=i[e];for(let e of t)for(let t=0,i=e.length,s=i-1;t<i;s=t++){let i=e[s],l=e[t];if(eJ(a,o,i,l))return 0;n=Math.min(n,tp(a,o,i,l,r))}}return n}(t,e.coordinates,a,s))}if(0===s)return s}return s}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}let tb={"==":eG,"!=":ez,">":ej,"<":eq,">=":eU,"<=":eB,array:em,at:ew,boolean:em,case:eC,coalesce:ek,collator:eH,format:eV,image:eY,in:eE,"index-of":eA,interpolate:eO,"interpolate-hcl":eO,"interpolate-lab":eO,length:eW,let:eb,literal:ep,match:eT,number:em,"number-format":eZ,object:em,slice:eP,step:eI,string:em,"to-boolean":ey,"to-color":ey,"to-number":ey,"to-string":ey,var:eS,within:e8,distance:tx};class tS{constructor(e,t,r,i){this.name=e,this.type=t,this._evaluate=r,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let r=e[0],i=tS.definitions[r];if(!i)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);let a=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,n=s.filter(([t])=>!Array.isArray(t)||t.length===e.length-1),o=null;for(let[i,s]of n){o=new ex(t.registry,tT,t.path,null,t.scope);let n=[],l=!1;for(let t=1;t<e.length;t++){let r=e[t],a=Array.isArray(i)?i[t-1]:i.type,s=o.parse(r,1+n.length,a);if(!s){l=!0;break}n.push(s)}if(!l){if(Array.isArray(i)&&i.length!==n.length){o.error(`Expected ${i.length} arguments, but found ${n.length} instead.`);continue}for(let e=0;e<n.length;e++){let t=Array.isArray(i)?i[e]:i.type,r=n[e];o.concat(e+1).checkSubtype(t,r.type)}if(0===o.errors.length)return new tS(r,a,s,n)}}if(1===n.length)t.errors.push(...o.errors);else{let r=(n.length?n:s).map(([e])=>Array.isArray(e)?`(${e.map(C).join(", ")})`:`(${C(e.type)}...)`).join(" | "),i=[];for(let r=1;r<e.length;r++){let a=t.parse(e[r],1+i.length);if(!a)return null;i.push(C(a.type))}t.error(`Expected arguments of type ${r}, but found (${i.join(", ")}) instead.`)}return null}static register(e,t){for(let r in tS.definitions=t,t)e[r]=tS}}function tw(e,[t,r,i,a]){t=t.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);let s=a?a.evaluate(e):1,n=eu(t,r,i,s);if(n)throw new ea(n);return new J(t/255,r/255,i/255,s,!1)}function tE(e,t){let r=t[e];return void 0===r?null:r}function tA(e){return{type:e}}function tT(e){if(e instanceof eS)return tT(e.boundExpression);if(e instanceof tS&&"error"===e.name||e instanceof eH||e instanceof e8||e instanceof tx)return!1;let t=e instanceof ey||e instanceof em,r=!0;return e.eachChild(e=>{r=t?r&&tT(e):r&&e instanceof ep}),!!r&&tC(e)&&tR(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function tC(e){if(e instanceof tS){if("get"===e.name&&1===e.args.length||"feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;else if(/^filter-/.test(e.name))return!1}if(e instanceof e8||e instanceof tx)return!1;let t=!0;return e.eachChild(e=>{t&&!tC(e)&&(t=!1)}),t}function tP(e){if(e instanceof tS&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!tP(e)&&(t=!1)}),t}function tR(e,t){if(e instanceof tS&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(e=>{r&&!tR(e,t)&&(r=!1)}),r}function tI(e){return{result:"success",value:e}}function tL(e){return{result:"error",value:e}}function tO(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function tM(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function tk(e){return!!e.expression&&e.expression.interpolated}function tN(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function tD(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}tS.register(tb,{error:[{kind:"error"},[m],(e,[t])=>{throw new ea(t.evaluate(e))}],typeof:[m,[x],(e,[t])=>C(ec(t.evaluate(e)))],"to-rgba":[T(f,4),[y],(e,[t])=>{let[r,i,a,s]=t.evaluate(e).rgb;return[255*r,255*i,255*a,s]}],rgb:[y,[f,f,f],tw],rgba:[y,[f,f,f,f],tw],has:{type:g,overloads:[[[m],(e,[t])=>t.evaluate(e) in e.properties()],[[m,_],(e,[t,r])=>t.evaluate(e) in r.evaluate(e)]]},get:{type:x,overloads:[[[m],(e,[t])=>tE(t.evaluate(e),e.properties())],[[m,_],(e,[t,r])=>tE(t.evaluate(e),r.evaluate(e))]]},"feature-state":[x,[m],(e,[t])=>tE(t.evaluate(e),e.featureState||{})],properties:[_,[],e=>e.properties()],"geometry-type":[m,[],e=>e.geometryType()],id:[x,[],e=>e.id()],zoom:[f,[],e=>e.globals.zoom],"heatmap-density":[f,[],e=>e.globals.heatmapDensity||0],"line-progress":[f,[],e=>e.globals.lineProgress||0],accumulated:[x,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[f,tA(f),(e,t)=>{let r=0;for(let i of t)r+=i.evaluate(e);return r}],"*":[f,tA(f),(e,t)=>{let r=1;for(let i of t)r*=i.evaluate(e);return r}],"-":{type:f,overloads:[[[f,f],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[f],(e,[t])=>-t.evaluate(e)]]},"/":[f,[f,f],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[f,[f,f],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[f,[],()=>Math.LN2],pi:[f,[],()=>Math.PI],e:[f,[],()=>Math.E],"^":[f,[f,f],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[f,[f],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[f,[f],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[f,[f],(e,[t])=>Math.log(t.evaluate(e))],log2:[f,[f],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[f,[f],(e,[t])=>Math.sin(t.evaluate(e))],cos:[f,[f],(e,[t])=>Math.cos(t.evaluate(e))],tan:[f,[f],(e,[t])=>Math.tan(t.evaluate(e))],asin:[f,[f],(e,[t])=>Math.asin(t.evaluate(e))],acos:[f,[f],(e,[t])=>Math.acos(t.evaluate(e))],atan:[f,[f],(e,[t])=>Math.atan(t.evaluate(e))],min:[f,tA(f),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[f,tA(f),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[f,[f],(e,[t])=>Math.abs(t.evaluate(e))],round:[f,[f],(e,[t])=>{let r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[f,[f],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[f,[f],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[g,[m,x],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[g,[x],(e,[t])=>e.id()===t.value],"filter-type-==":[g,[m],(e,[t])=>e.geometryType()===t.value],"filter-<":[g,[m,x],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i<a}],"filter-id-<":[g,[x],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<i}],"filter->":[g,[m,x],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i>a}],"filter-id->":[g,[x],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>i}],"filter-<=":[g,[m,x],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[g,[x],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<=i}],"filter->=":[g,[m,x],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[g,[x],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>=i}],"filter-has":[g,[x],(e,[t])=>t.value in e.properties()],"filter-has-id":[g,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[g,[T(m)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[g,[T(x)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[g,[m,T(x)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[g,[m,T(x)],(e,[t,r])=>(function(e,t,r,i){for(;r<=i;){let a=r+i>>1;if(t[a]===e)return!0;t[a]>e?i=a-1:r=a+1}return!1})(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:g,overloads:[[[g,g],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[tA(g),(e,t)=>{for(let r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:g,overloads:[[[g,g],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[tA(g),(e,t)=>{for(let r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[g,[g],(e,[t])=>!t.evaluate(e)],"is-supported-script":[g,[m],(e,[t])=>{let r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[m,[m],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[m,[m],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[m,tA(x),(e,t)=>t.map(t=>ed(t.evaluate(e))).join("")],"resolved-locale":[m,[b],(e,[t])=>t.evaluate(e).resolvedLocale()]});class tF{constructor(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new e_,this._defaultValue=t?"color"===(r=t).type&&tD(r.default)?new J(0,0,0,0):"color"===r.type?J.parse(r.default)||null:"padding"===r.type?ei.parse(r.default)||null:"variableAnchorOffsetCollection"===r.type?en.parse(r.default)||null:"projectionDefinition"===r.type?el.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,i,a,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s||null;try{let e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new ea(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function tG(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in tb}function tz(e,t){let r=new ex(tb,tT,[],t?function(e){let t={color:y,string:m,number:f,enum:m,boolean:g,formatted:S,padding:w,projectionDefinition:v,resolvedImage:E,variableAnchorOffsetCollection:A};return"array"===e.type?T(t[e.value]||x,e.length):t[e.type]}(t):void 0),i=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?tI(new tF(i,t)):tL(r.errors)}class tq{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!tP(t.expression)}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,a,s)}evaluate(e,t,r,i,a,s){return this._styleExpression.evaluate(e,t,r,i,a,s)}}class tj{constructor(e,t,r,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!tP(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,a,s)}evaluate(e,t,r,i,a,s){return this._styleExpression.evaluate(e,t,r,i,a,s)}interpolationFactor(e,t,r){return this.interpolationType?eO.interpolationFactor(this.interpolationType,e,t,r):0}}function tB(e,t){let r=tz(e,t);if("error"===r.result)return r;let i=r.value.expression,a=tC(i);if(!a&&!tO(t))return tL([new c("","data expressions not supported")]);let s=tR(i,["zoom"]);if(!s&&!tM(t))return tL([new c("","zoom expressions not supported")]);let n=function e(t){let r=null;if(t instanceof eb)r=e(t.result);else if(t instanceof ek){for(let i of t.args)if(r=e(i))break}else(t instanceof eI||t instanceof eO)&&t.input instanceof tS&&"zoom"===t.input.name&&(r=t);return r instanceof c||t.eachChild(t=>{let i=e(t);i instanceof c?r=i:!r&&i?r=new c("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&i&&r!==i&&(r=new c("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}(i);if(!n&&!s)return tL([new c("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(n instanceof c)return tL([n]);if(n instanceof eO&&!tk(t))return tL([new c("",'"interpolate" expressions cannot be used with this property')]);if(!n)return tI(a?new tq("constant",r.value):new tq("source",r.value));let o=n instanceof eO?n.interpolation:void 0;return tI(a?new tj("camera",r.value,n.labels,o):new tj("composite",r.value,n.labels,o))}function tU(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(let t of e.slice(1))if(!tU(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}let tH={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tZ(e){if(null==e)return{filter:()=>!0,needGeometry:!1};tU(e)||(e=function e(t){if(!t)return!0;let r=t[0];return t.length<=1?"any"!==r:"=="===r?tY(t[1],t[2],"=="):"!="===r?tX(tY(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?tY(t[1],t[2],r):"any"===r?["any"].concat(t.slice(1).map(e)):"all"===r?["all"].concat(t.slice(1).map(e)):"none"===r?["all"].concat(t.slice(1).map(e).map(tX)):"in"===r?tW(t[1],t.slice(2)):"!in"===r?tX(tW(t[1],t.slice(2))):"has"===r?t$(t[1]):"!has"!==r||tX(t$(t[1]))}(e));let t=tz(e,tH);if("error"!==t.result)return{filter:(e,r,i)=>t.value.evaluate(e,r,{},i),needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)};throw Error(t.value.map(e=>`${e.key}: ${e.message}`).join(", "))}function tV(e,t){return e<t?-1:e>t?1:0}function tY(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function tW(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:if(t.length>200&&!t.some(e=>typeof e!=typeof t[0]))return["filter-in-large",e,["literal",t.sort(tV)]];return["filter-in-small",e,["literal",t]]}}function t$(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function tX(e){return["!",e]}function tK(e){return"object"==typeof e?["literal",e]:e}function tJ(e,t){let r=e.stops;if(!r)return function(e,t){let r=["get",e.property];if(void 0===e.default)return"string"===t.type?["string",r]:r;{if("enum"===t.type)return["match",r,Object.keys(t.values),r,e.default];let i=["color"===t.type?"to-color":t.type,r,tK(e.default)];return"array"===t.type&&i.splice(1,0,t.value,t.length||null),i}}(e,t);let i=r&&"object"==typeof r[0][0],a=i||void 0!==e.property;return(r=r.map(e=>!a&&t.tokens&&"string"==typeof e[1]?[e[0],function(e){let t=["concat"],r=/{([^{}]+)}/g,i=0;for(let a=r.exec(e);null!==a;a=r.exec(e)){let s=e.slice(i,r.lastIndex-a[0].length);i=r.lastIndex,s.length>0&&t.push(s),t.push(["get",a[1]])}if(1===t.length)return e;if(i<e.length)t.push(e.slice(i));else if(2===t.length)return["to-string",t[1]];return t}(e[1])]:[e[0],tK(e[1])]),i)?function(e,t,r){let i={},a={},s=[];for(let t=0;t<r.length;t++){let n=r[t],o=n[0].zoom;void 0===i[o]&&(i[o]={zoom:o,type:e.type,property:e.property,default:e.default},a[o]=[],s.push(o)),a[o].push([n[0].value,n[1]])}if("exponential"===t3({},t)){let r=[tQ(e),["linear"],["zoom"]];for(let e of s){let s=t1(i[e],t,a[e]);t5(r,e,s,!1)}return r}{let e=["step",["zoom"]];for(let r of s){let s=t1(i[r],t,a[r]);t5(e,r,s,!0)}return t2(e),e}}(e,t,r):i||!a?function(e,t,r,i=["zoom"]){let a;let s=t3(e,t),n=!1;if("interval"===s)a=["step",i],n=!0;else if("exponential"===s){let t=void 0!==e.base?e.base:1;a=[tQ(e),1===t?["linear"]:["exponential",t],i]}else throw Error(`Unknown zoom function type "${s}"`);for(let e of r)t5(a,e[0],e[1],n);return t2(a),a}(e,t,r):t1(e,t,r)}function tQ(e){switch(e.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function t0(e,t){var r,i;let a=tK((r=e.default,i=t.default,void 0!==r?r:void 0!==i?i:void 0));return void 0===a&&"resolvedImage"===t.type?"":a}function t1(e,t,r){let i=t3(e,t),a=["get",e.property];if("categorical"===i&&"boolean"==typeof r[0][0]){let i=["case"];for(let e of r)i.push(["==",a,e[0]],e[1]);return i.push(t0(e,t)),i}if("categorical"===i){let i=["match",a];for(let e of r)t5(i,e[0],e[1],!1);return i.push(t0(e,t)),i}if("interval"===i){let t=["step",["number",a]];for(let e of r)t5(t,e[0],e[1],!0);return t2(t),void 0===e.default?t:["case",["==",["typeof",a],"number"],t,tK(e.default)]}if("exponential"===i){let t=void 0!==e.base?e.base:1,i=[tQ(e),1===t?["linear"]:["exponential",t],["number",a]];for(let e of r)t5(i,e[0],e[1],!1);return void 0===e.default?i:["case",["==",["typeof",a],"number"],i,tK(e.default)]}throw Error(`Unknown property function type ${i}`)}function t2(e){"step"===e[0]&&3===e.length&&(e.push(0),e.push(e[3]))}function t5(e,t,r,i){e.length>3&&t===e[e.length-2]||(i&&2===e.length||e.push(t),e.push(r))}function t3(e,t){return e.type?e.type:t.expression.interpolated?"exponential":"interval"}function t4(e){let t=e.key,r=e.value;return r?[new u(t,r,"constants have been deprecated as of v8")]:[]}function t6(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function t8(e){if(Array.isArray(e))return e.map(t8);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){let t={};for(let r in e)t[r]=t8(e[r]);return t}return t6(e)}function t7(e){let t=e.key,r=e.value,i=e.valueSpec||{},a=e.objectElementValidators||{},s=e.style,n=e.styleSpec,o=e.validateSpec,l=[],h=tN(r);if("object"!==h)return[new u(t,r,`object expected, ${h} found`)];for(let e in r){let h;let c=e.split(".")[0],d=i[c]||i["*"];if(a[c])h=a[c];else if(i[c])h=o;else if(a["*"])h=a["*"];else if(i["*"])h=o;else{l.push(new u(t,r[e],`unknown property "${e}"`));continue}l=l.concat(h({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:d,style:s,styleSpec:n,object:r,objectKey:e,validateSpec:o},r))}for(let e in i)!a[e]&&i[e].required&&void 0===i[e].default&&void 0===r[e]&&l.push(new u(t,r,`missing required property "${e}"`));return l}function t9(e){let t=e.value,r=e.valueSpec,i=e.validateSpec,a=e.style,s=e.styleSpec,n=e.key,o=e.arrayElementValidator||i;if("array"!==tN(t))return[new u(n,t,`array expected, ${tN(t)} found`)];if(r.length&&t.length!==r.length)return[new u(n,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new u(n,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let l={type:r.value,values:r.values};s.$version<7&&(l.function=r.function),"object"===tN(r.value)&&(l=r.value);let h=[];for(let r=0;r<t.length;r++)h=h.concat(o({array:t,arrayIndex:r,value:t[r],valueSpec:l,validateSpec:e.validateSpec,style:a,styleSpec:s,key:`${n}[${r}]`}));return h}function re(e){let t=e.key,r=e.value,i=e.valueSpec,a=tN(r);return("number"===a&&r!=r&&(a="NaN"),"number"!==a)?[new u(t,r,`number expected, ${a} found`)]:"minimum"in i&&r<i.minimum?[new u(t,r,`${r} is less than the minimum value ${i.minimum}`)]:"maximum"in i&&r>i.maximum?[new u(t,r,`${r} is greater than the maximum value ${i.maximum}`)]:[]}function rt(e){let t,r,i;let a=e.valueSpec,s=t6(e.value.type),n={},o="categorical"!==s&&void 0===e.value.property,l="array"===tN(e.value.stops)&&"array"===tN(e.value.stops[0])&&"object"===tN(e.value.stops[0][0]),h=t7({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===s)return[new u(e.key,e.value,'identity function may not have a "stops" property')];let t=[],r=e.value;return t=t.concat(t9({key:e.key,value:r,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:c})),"array"===tN(r)&&0===r.length&&t.push(new u(e.key,r,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:a,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===s&&o&&h.push(new u(e.key,e.value,'missing required property "property"')),"identity"===s||e.value.stops||h.push(new u(e.key,e.value,'missing required property "stops"')),"exponential"===s&&e.valueSpec.expression&&!tk(e.valueSpec)&&h.push(new u(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(o||tO(e.valueSpec)?o&&!tM(e.valueSpec)&&h.push(new u(e.key,e.value,"zoom functions not supported")):h.push(new u(e.key,e.value,"property functions not supported"))),("categorical"===s||l)&&void 0===e.value.property&&h.push(new u(e.key,e.value,'"property" property is required')),h;function c(e){let t=[],s=e.value,o=e.key;if("array"!==tN(s))return[new u(o,s,`array expected, ${tN(s)} found`)];if(2!==s.length)return[new u(o,s,`array length 2 expected, length ${s.length} found`)];if(l){if("object"!==tN(s[0]))return[new u(o,s,`object expected, ${tN(s[0])} found`)];if(void 0===s[0].zoom)return[new u(o,s,"object stop key must have zoom")];if(void 0===s[0].value)return[new u(o,s,"object stop key must have value")];if(i&&i>t6(s[0].zoom))return[new u(o,s[0].zoom,"stop zoom values must appear in ascending order")];t6(s[0].zoom)!==i&&(i=t6(s[0].zoom),r=void 0,n={}),t=t.concat(t7({key:`${o}[0]`,value:s[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:re,value:d}}))}else t=t.concat(d({key:`${o}[0]`,value:s[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},s));return tG(t8(s[1]))?t.concat([new u(`${o}[1]`,s[1],"expressions are not allowed in function stops.")]):t.concat(e.validateSpec({key:`${o}[1]`,value:s[1],valueSpec:a,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,i){let o=tN(e.value),l=t6(e.value),h=null!==e.value?e.value:i;if(t){if(o!==t)return[new u(e.key,h,`${o} stop domain type must match previous stop domain type ${t}`)]}else t=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new u(e.key,h,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==s){let t=`number expected, ${o} found`;return tO(a)&&void 0===s&&(t+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new u(e.key,h,t)]}return"categorical"!==s||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==s&&"number"===o&&void 0!==r&&l<r?[new u(e.key,h,"stop domain values must appear in ascending order")]:(r=l,"categorical"===s&&l in n)?[new u(e.key,h,"stop domain values must be unique")]:(n[l]=!0,[]):[new u(e.key,h,`integer expected, found ${l}`)]}}function rr(e){let t=("property"===e.expressionContext?tB:tz)(t8(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new u(`${e.key}${t.key}`,e.value,t.message));let r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new u(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!tP(r))return[new u(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!tP(r))return[new u(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!tR(r,["zoom","feature-state"]))return[new u(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!tC(r))return[new u(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ri(e){let t=e.key,r=e.value,i=e.valueSpec,a=[];return Array.isArray(i.values)?-1===i.values.indexOf(t6(r))&&a.push(new u(t,r,`expected one of [${i.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(i.values).indexOf(t6(r))&&a.push(new u(t,r,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(r)} found`)),a}function ra(e){return tU(t8(e.value))?rr(h({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){let r;let i=t.value,a=t.key;if("array"!==tN(i))return[new u(a,i,`array expected, ${tN(i)} found`)];let s=t.styleSpec,n=[];if(i.length<1)return[new u(a,i,"filter array must have at least 1 element")];switch(n=n.concat(ri({key:`${a}[0]`,value:i[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),t6(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===t6(i[1])&&n.push(new u(a,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&n.push(new u(a,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&"string"!==(r=tN(i[1]))&&n.push(new u(`${a}[1]`,i[1],`string expected, ${r} found`));for(let e=2;e<i.length;e++)r=tN(i[e]),"$type"===t6(i[1])?n=n.concat(ri({key:`${a}[${e}]`,value:i[e],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&n.push(new u(`${a}[${e}]`,i[e],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let r=1;r<i.length;r++)n=n.concat(e({key:`${a}[${r}]`,value:i[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=tN(i[1]),2!==i.length?n.push(new u(a,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==r&&n.push(new u(`${a}[1]`,i[1],`string expected, ${r} found`))}return n}(e)}function rs(e,t){let r;let i=e.key,a=e.validateSpec,s=e.style,n=e.styleSpec,o=e.value,l=e.objectKey,h=n[`${t}_${e.layerType}`];if(!h)return[];let c=l.match(/^(.*)-transition$/);if("paint"===t&&c&&h[c[1]]&&h[c[1]].transition)return a({key:i,value:o,valueSpec:n.transition,style:s,styleSpec:n});let d=e.valueSpec||h[l];if(!d)return[new u(i,o,`unknown property "${l}"`)];if("string"===tN(o)&&tO(d)&&!d.tokens&&(r=/^{([^}]+)}$/.exec(o)))return[new u(i,o,`"${l}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(r[1])} }\`.`)];let p=[];return"symbol"===e.layerType&&("text-field"===l&&s&&!s.glyphs&&p.push(new u(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&tD(t8(o))&&"identity"===t6(o.type)&&p.push(new u(i,o,'"text-font" does not support identity functions'))),p.concat(a({key:e.key,value:o,valueSpec:d,style:s,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:l}))}function rn(e){return rs(e,"paint")}function ro(e){return rs(e,"layout")}function rl(e){let t=[],r=e.value,i=e.key,a=e.style,s=e.styleSpec;r.type||r.ref||t.push(new u(i,r,'either "type" or "ref" is required'));let n=t6(r.type),o=t6(r.ref);if(r.id){let s=t6(r.id);for(let n=0;n<e.arrayIndex;n++){let e=a.layers[n];t6(e.id)===s&&t.push(new u(i,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in r&&t.push(new u(i,r[e],`"${e}" is prohibited for ref layers`))}),a.layers.forEach(t=>{t6(t.id)===o&&(e=t)}),e?e.ref?t.push(new u(i,r.ref,"ref cannot reference another ref layer")):n=t6(e.type):t.push(new u(i,r.ref,`ref layer "${o}" not found`))}else if("background"!==n){if(r.source){let e=a.sources&&a.sources[r.source],s=e&&t6(e.type);e?"vector"===s&&"raster"===n?t.push(new u(i,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==s&&"hillshade"===n?t.push(new u(i,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===s&&"raster"!==n?t.push(new u(i,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==s||r["source-layer"]?"raster-dem"===s&&"hillshade"!==n?t.push(new u(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===n&&r.paint&&r.paint["line-gradient"]&&("geojson"!==s||!e.lineMetrics)&&t.push(new u(i,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new u(i,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new u(i,r.source,`source "${r.source}" not found`))}else t.push(new u(i,r,'missing required property "source"'))}return t=t.concat(t7({key:i,value:r,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${i}.type`,value:r.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:ra,layout:e=>t7({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>ro(h({layerType:n},e))}}),paint:e=>t7({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>rn(h({layerType:n},e))}})}}))}function ru(e){let t=e.value,r=e.key,i=tN(t);return"string"!==i?[new u(r,t,`string expected, ${i} found`)]:[]}let rh={promoteId:function({key:e,value:t}){if("string"===tN(t))return ru({key:e,value:t});{let r=[];for(let i in t)r.push(...ru({key:`${e}.${i}`,value:t[i]}));return r}}};function rc(e){let t;let r=e.value,i=e.key,a=e.styleSpec,s=e.style,n=e.validateSpec;if(!r.type)return[new u(i,r,'"type" is required')];let o=t6(r.type);switch(o){case"vector":case"raster":return t7({key:i,value:r,valueSpec:a[`source_${o.replace("-","_")}`],style:e.style,styleSpec:a,objectElementValidators:rh,validateSpec:n});case"raster-dem":return function(e){var t;let r=null!==(t=e.sourceName)&&void 0!==t?t:"",i=e.value,a=e.styleSpec,s=a.source_raster_dem,n=e.style,o=[],l=tN(i);if(void 0===i)return o;if("object"!==l)return o.push(new u("source_raster_dem",i,`object expected, ${l} found`)),o;let h="custom"===t6(i.encoding),c=["redFactor","greenFactor","blueFactor","baseShift"],d=e.value.encoding?`"${e.value.encoding}"`:"Default";for(let t in i)!h&&c.includes(t)?o.push(new u(t,i[t],`In "${r}": "${t}" is only valid when "encoding" is set to "custom". ${d} encoding found`)):s[t]?o=o.concat(e.validateSpec({key:t,value:i[t],valueSpec:s[t],validateSpec:e.validateSpec,style:n,styleSpec:a})):o.push(new u(t,i[t],`unknown property "${t}"`));return o}({sourceName:i,value:r,style:e.style,styleSpec:a,validateSpec:n});case"geojson":if(t=t7({key:i,value:r,valueSpec:a.source_geojson,style:s,styleSpec:a,validateSpec:n,objectElementValidators:rh}),r.cluster)for(let e in r.clusterProperties){let[a,s]=r.clusterProperties[e],o="string"==typeof a?[a,["accumulated"],["get",e]]:a;t.push(...rr({key:`${i}.${e}.map`,value:s,validateSpec:n,expressionContext:"cluster-map"})),t.push(...rr({key:`${i}.${e}.reduce`,value:o,validateSpec:n,expressionContext:"cluster-reduce"}))}return t;case"video":return t7({key:i,value:r,valueSpec:a.source_video,style:s,validateSpec:n,styleSpec:a});case"image":return t7({key:i,value:r,valueSpec:a.source_image,style:s,validateSpec:n,styleSpec:a});case"canvas":return[new u(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ri({key:`${i}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:s,validateSpec:n,styleSpec:a})}}function rd(e){let t=e.value,r=e.styleSpec,i=r.light,a=e.style,s=[],n=tN(t);if(void 0===t)return s;if("object"!==n)return s.concat([new u("light",t,`object expected, ${n} found`)]);for(let n in t){let o=n.match(/^(.*)-transition$/);s=o&&i[o[1]]&&i[o[1]].transition?s.concat(e.validateSpec({key:n,value:t[n],valueSpec:r.transition,validateSpec:e.validateSpec,style:a,styleSpec:r})):i[n]?s.concat(e.validateSpec({key:n,value:t[n],valueSpec:i[n],validateSpec:e.validateSpec,style:a,styleSpec:r})):s.concat([new u(n,t[n],`unknown property "${n}"`)])}return s}function rp(e){let t=e.value,r=e.styleSpec,i=r.sky,a=e.style,s=tN(t);if(void 0===t)return[];if("object"!==s)return[new u("sky",t,`object expected, ${s} found`)];let n=[];for(let s in t)n=i[s]?n.concat(e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:a,styleSpec:r})):n.concat([new u(s,t[s],`unknown property "${s}"`)]);return n}function rf(e){let t=e.value,r=e.styleSpec,i=r.terrain,a=e.style,s=[],n=tN(t);if(void 0===t)return s;if("object"!==n)return s.concat([new u("terrain",t,`object expected, ${n} found`)]);for(let n in t)s=i[n]?s.concat(e.validateSpec({key:n,value:t[n],valueSpec:i[n],validateSpec:e.validateSpec,style:a,styleSpec:r})):s.concat([new u(n,t[n],`unknown property "${n}"`)]);return s}function rm(e){let t=[],r=e.value,i=e.key;if(!Array.isArray(r))return ru({key:i,value:r});{let a=[],s=[];for(let n in r){r[n].id&&a.includes(r[n].id)&&t.push(new u(i,r,`all the sprites' ids must be unique, but ${r[n].id} is duplicated`)),a.push(r[n].id),r[n].url&&s.includes(r[n].url)&&t.push(new u(i,r,`all the sprites' URLs must be unique, but ${r[n].url} is duplicated`)),s.push(r[n].url);let o={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(t7({key:`${i}[${n}]`,value:r[n],valueSpec:o,validateSpec:e.validateSpec}))}return t}}let rg={"*":()=>[],array:t9,boolean:function(e){let t=e.value,r=e.key,i=tN(t);return"boolean"!==i?[new u(r,t,`boolean expected, ${i} found`)]:[]},number:re,color:function(e){let t=e.key,r=e.value,i=tN(r);return"string"!==i?[new u(t,r,`color expected, ${i} found`)]:J.parse(String(r))?[]:[new u(t,r,`color expected, "${r}" found`)]},constants:t4,enum:ri,filter:ra,function:rt,layer:rl,object:t7,source:rc,light:rd,sky:rp,terrain:rf,projection:function(e){let t=e.value,r=e.styleSpec,i=r.projection,a=e.style,s=tN(t);if(void 0===t)return[];if("object"!==s)return[new u("projection",t,`object expected, ${s} found`)];let n=[];for(let s in t)n=i[s]?n.concat(e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:a,styleSpec:r})):n.concat([new u(s,t[s],`unknown property "${s}"`)]);return n},projectionDefinition:function(e){var t;let r=e.key,i=e.value,a=tN(i=i instanceof String?i.valueOf():i);return"array"!==a||Array.isArray(t=i)&&3===t.length&&"string"==typeof t[0]&&"string"==typeof t[1]&&"number"==typeof t[2]||["interpolate","step","literal"].includes(i[0])?["array","string"].includes(a)?[]:[new u(r,i,`projection expected, invalid type "${a}" found`)]:[new u(r,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:ru,formatted:function(e){return 0===ru(e).length?[]:rr(e)},resolvedImage:function(e){return 0===ru(e).length?[]:rr(e)},padding:function(e){let t=e.key,r=e.value;if("array"!==tN(r))return re({key:t,value:r,valueSpec:{}});{if(r.length<1||r.length>4)return[new u(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let i={type:"number"},a=[];for(let s=0;s<r.length;s++)a=a.concat(e.validateSpec({key:`${t}[${s}]`,value:r[s],validateSpec:e.validateSpec,valueSpec:i}));return a}},variableAnchorOffsetCollection:function(e){let t=e.key,r=e.value,i=tN(r),a=e.styleSpec;if("array"!==i||r.length<1||r.length%2!=0)return[new u(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let s=[];for(let i=0;i<r.length;i+=2)s=(s=s.concat(ri({key:`${t}[${i}]`,value:r[i],valueSpec:a.layout_symbol["text-anchor"]}))).concat(t9({key:`${t}[${i+1}]`,value:r[i+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:a}));return s},sprite:rm};function ry(e){let t=e.value,r=e.valueSpec,i=e.styleSpec;return(e.validateSpec=ry,r.expression&&tD(t6(t)))?rt(e):r.expression&&tG(t8(t))?rr(e):r.type&&rg[r.type]?rg[r.type](e):t7(h({},e,{valueSpec:r.type?i[r.type]:r}))}function rv(e){let t=e.value,r=e.key,i=ru(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new u(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new u(r,t,'"glyphs" url must include a "{range}" token'))),i}function r_(e,t=n){let r=[];return r=r.concat(ry({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:ry,objectElementValidators:{glyphs:rv,"*":()=>[]}})),e.constants&&(r=r.concat(t4({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:ry}))),rb(r)}function rx(e){return function(t){return e({...t,validateSpec:ry})}}function rb(e){return[].concat(e).sort((e,t)=>e.line-t.line)}function rS(e){return function(...t){return rb(e.apply(this,t))}}r_.source=rS(rx(rc)),r_.sprite=rS(rx(rm)),r_.glyphs=rS(rx(rv)),r_.light=rS(rx(rd)),r_.sky=rS(rx(rp)),r_.terrain=rS(rx(rf)),r_.layer=rS(rx(rl)),r_.filter=rS(rx(ra)),r_.paintProperty=rS(rx(rn)),r_.layoutProperty=rS(rx(ro));let rw=n}),n("byP80",function(e,r){t(e.exports,"default",()=>n);var i={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},a=/(italic|oblique)$/i,s={};function n(e,t,r){var n=s[e];if(!n){Array.isArray(e)||(e=[e]);for(var o,l,u=400,h="normal",c=[],d=0,p=e.length;d<p;++d){var f=e[d].split(" "),m=f[f.length-1].toLowerCase();for(var g in"normal"==m||"italic"==m||"oblique"==m?(h=l?h:m,l=!0,f.pop(),m=f[f.length-1].toLowerCase()):a.test(m)&&(m=m.replace(a,""),h=l?h:f[f.length-1].replace(m,""),l=!0),i){var y=f.length>1?f[f.length-2].toLowerCase():"";if(m==g||m==g.replace("-","")||y+"-"+m==g){u=o?u:i[g],f.pop(),y&&g.startsWith(y)&&f.pop();break}}o||"number"!=typeof m||(u=m,o=!0);var v=f.join(" ").replace("Klokantech Noto Sans","Noto Sans");-1!==v.indexOf(" ")&&(v='"'+v+'"'),c.push(v)}n=s[e]=[h,u,c]}return n[0]+" "+n[1]+" "+t+"px"+(r?"/"+r:"")+" "+n[2]}}),n("elpZt",function(e,r){let i,a;t(e.exports,"applyLetterSpacing",()=>h),t(e.exports,"wrapText",()=>function e(t,r,i,a){if(-1!==t.indexOf("\n")){let s=t.split("\n"),n=[];for(let t=0,o=s.length;t<o;++t)n.push(e(s[t],r,i,a));return n.join("\n")}let s=i+","+r+","+t+","+a,n=p[s];if(!n){let e=t.split(" ");if(e.length>1){let t=c();t.font=r;let s=t.measureText("M").width*i,o="",l=[];for(let t=0,r=e.length;t<r;++t){let r=e[t],i=o+(o?" ":"")+r;d(i,a)<=s?o=i:(o&&l.push(o),o=r)}o&&l.push(o);for(let e=0,t=l.length;e<t&&t>1;++e){let r=l[e];if(d(r,a)<.35*s){let i=e>0?d(l[e-1],a):1/0,s=e<t-1?d(l[e+1],a):1/0;l.splice(e,1),t-=1,i<s?(l[e-1]+=" "+r,e-=1):l[e]=r+" "+l[e]}}for(let e=0,t=l.length-1;e<t;++e){let r=l[e],i=l[e+1];if(d(r,a)>.7*s&&d(i,a)<.6*s){let n=r.split(" "),o=n.pop();d(o,a)<.2*s&&(l[e]=n.join(" "),l[e+1]=o+" "+i),t-=1}}n=l.join("\n")}else n=t;n=h(n,a),p[s]=n}return n}),t(e.exports,"getFonts",()=>y);var n=s("byP80"),o=s("aHG4Z"),l=s("ePotS");let u=Array(256).join(" ");function h(e,t){if(t>=.05){let r="",i=e.split("\n"),a=u.slice(0,Math.round(t/.1));for(let e=0,t=i.length;e<t;++e)e>0&&(r+="\n"),r+=i[e].split("").join(a);return r}return e}function c(){return i||(i=(0,l.createCanvas)(1,1).getContext("2d")),i}function d(e,t){return c().measureText(e).width+(e.length-1)*t}let p={},f=/font-family: ?([^;]*);/,m=/("|')/g,g={};function y(e,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){let r=e.toString();if(r in g)return g[r];let i=[];for(let t=0,r=e.length;t<r;++t){e[t]=e[t].replace("Arial Unicode MS","Arial");let r=e[t],a=(0,n.default)(r,1);(0,o.registerFont)(a);let s=a.split(" ");i.push([s.slice(3).join(" ").replace(/"/g,""),s[1],s[0]])}for(let e=0,r=i.length;e<r;++e){let r=i[e],s=r[0];if(!function(e){if(!a){a={};let e=document.styleSheets;for(let t=0,r=e.length;t<r;++t){let r=e[t];try{let e=r.rules||r.cssRules;if(e)for(let t=0,r=e.length;t<r;++t){let r=e[t];5==r.type&&(a[r.cssText.match(f)[1].replace(m,"")]=!0)}}catch{}}}return e in a}(s)&&100!==(0,o.checkedFonts).get(`${r[2]}
${r[1]} 
${s}`)){let e=t.replace("{font-family}",s.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",s.replace(/ /g,"+")).replace("{fontweight}",r[1]).replace("{-fontstyle}",r[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",r[2]);if(!document.querySelector('link[href="'+e+'"]')){let t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.appendChild(t)}}}return g[r]=e,e}}),n("ePotS",function(e,r){t(e.exports,"getStyleFunctionKey",()=>p),t(e.exports,"getFunctionCache",()=>f),t(e.exports,"clearFunctionCache",()=>m),t(e.exports,"getFilterCache",()=>g),t(e.exports,"deg2rad",()=>y),t(e.exports,"defaultResolutions",()=>v),t(e.exports,"createCanvas",()=>_),t(e.exports,"getZoomForResolution",()=>x),t(e.exports,"getResolutionForZoom",()=>b),t(e.exports,"fetchResource",()=>w),t(e.exports,"getGlStyle",()=>E),t(e.exports,"getTileJson",()=>T),t(e.exports,"drawIconHalo",()=>C),t(e.exports,"drawSDF",()=>P);var i=s("cFxEe"),a=s("av38f"),n=s("eQaCk"),o=s("lVQul"),l=s("6zYyV");let u={},h={},c=0;function d(e){return e.id||(e.id=c++),e.id}function p(e,t){return d(e)+"."+(0,o.getUid)(t)}function f(e){let t=u[e.id];return t||(t={},u[d(e)]=t),t}function m(){for(let e in u)delete u[e]}function g(e){let t=h[e.id];return t||(t={},h[d(e)]=t),t}function y(e){return e*Math.PI/180}let v=function(){let e=[];for(let t=78271.51696402048;e.length<=24;t/=2)e.push(t);return e}();function _(e,t){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(e,t);let r=document.createElement("canvas");return r.width=e,r.height=t,r}function x(e,t){let r=0,i=t.length;for(;r<i;++r)if(t[r]<e&&r+1<i){let i=t[r]/t[r+1];return r+Math.log(t[r]/e)/Math.log(i)}return i-1}function b(e,t){let r=Math.floor(e),i=Math.pow(2,e-r);return t[r]/i}let S={};function w(e,t,r={},i){if(t in S)return i&&(i.url=S[t][0].url),S[t][1];let a=r.transformRequest&&r.transformRequest(t,e)||t,s=function(e){return delete S[t],Promise.reject(Error("Error fetching source "+t))},o=function(e){return delete S[t],e.ok?e.json():Promise.reject(Error("Error fetching source "+t))},l=(0,n.toPromise)(()=>a).then(e=>e instanceof Response?(i&&(i.url=e.url),o(e)):(e instanceof Request||(e=new Request(e)),e.headers.get("Accept")||e.headers.set("Accept","application/json"),i&&(i.url=e.url),fetch(e).then(o).catch(s))).catch(s);return S[t]=[a,l],l}function E(e,t){if("string"!=typeof e)return Promise.resolve(e);if(!e.trim().startsWith("{"))return w("Style",e=(0,l.normalizeStyleUrl)(e,t.accessToken),t);try{let t=JSON.parse(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}let A={};function T(e,t,r={}){let s=[t,JSON.stringify(e)].toString(),o=A[s];if(!o||r.transformRequest){let u;r.transformRequest&&(u=(e,t)=>{let s=r.transformRequest&&r.transformRequest(t,"Tiles")||t;if(e instanceof i.default)e.setLoader((t,r,i)=>{let o=function(r){r.arrayBuffer().then(r=>{let a=e.getFormat().readFeatures(r,{extent:t,featureProjection:i});e.setFeatures(a)})};(0,n.toPromise)(()=>s).then(t=>{if(t instanceof Response)return o(t);fetch(t).then(o).catch(t=>e.setState(a.default.ERROR))}).catch(t=>e.setState(a.default.ERROR))});else{let t=e.getImage();(0,n.toPromise)(()=>s).then(r=>{if("string"==typeof r){t.src=r;return}let i=e=>e.blob().then(e=>{let r=URL.createObjectURL(e);t.addEventListener("load",()=>URL.revokeObjectURL(r)),t.addEventListener("error",()=>URL.revokeObjectURL(r)),t.src=r});if(r instanceof Response)return i(r);fetch(r).then(i).catch(t=>e.setState(a.default.ERROR))}).catch(t=>e.setState(a.default.ERROR))}});let h=e.url;if(h&&!e.tiles){let i=(0,l.normalizeSourceUrl)(h,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(h.startsWith("mapbox://"))o=Promise.resolve({tileJson:Object.assign({},e,{url:void 0,tiles:i}),tileLoadFunction:u});else{let e={};o=w("Source",i[0],r,e).then(function(t){return t.tiles=t.tiles.map(function(i){return"tms"===t.scheme&&(i=i.replace("{y}","{-y}")),(0,l.normalizeSourceUrl)(i,r.accessToken,r.accessTokenParam||"access_token",e.url)[0]}),Promise.resolve({tileJson:t,tileLoadFunction:u})})}}else o=Promise.resolve({tileJson:Object.assign({},e=Object.assign({},e,{tiles:e.tiles.map(function(i){return"tms"===e.scheme&&(i=i.replace("{y}","{-y}")),(0,l.normalizeSourceUrl)(i,r.accessToken,r.accessTokenParam||"access_token",t||location.href)[0]})})),tileLoadFunction:u});A[s]=o}return o}function C(e,t,r,i){let a=[2*r*t.pixelRatio+t.width,2*r*t.pixelRatio+t.height],s=_(a[0],a[1]),n=s.getContext("2d");n.drawImage(e,t.x,t.y,t.width,t.height,r*t.pixelRatio,r*t.pixelRatio,t.width,t.height);let o=n.getImageData(0,0,a[0],a[1]);n.globalCompositeOperation="destination-over",n.fillStyle=`rgba(${255*i.r},${255*i.g},${255*i.b},${i.a})`;let l=o.data;for(let e=0,i=o.width;e<i;++e)for(let a=0,s=o.height;a<s;++a)l[(a*i+e)*4+3]>0&&n.arc(e,a,r*t.pixelRatio,0,2*Math.PI);return n.fill(),s}function P(e,t,r){let i=_(t.width,t.height),a=i.getContext("2d");a.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);let s=a.getImageData(0,0,t.width,t.height),n=s.data;for(let e=0,t=s.width;e<t;++e)for(let i=0,a=s.height;i<a;++i){let a=(i*t+e)*4,s=function(e,t,r){let i=Math.max(0,Math.min(1,(r-e)/(.85-e)));return i*i*(3-2*i)}(.65,0,n[a+3]/255);s>0?(n[a+0]=Math.round(255*r.r*s),n[a+1]=Math.round(255*r.g*s),n[a+2]=Math.round(255*r.b*s),n[a+3]=Math.round(255*s)):n[a+3]=0}return a.putImageData(s,0,0),i}}),n("cFxEe",function(e,r){t(e.exports,"default",()=>o);var i=s("hMeZw"),a=s("av38f");class n extends i.default{constructor(e,t,r,i,a,s){super(e,t,s),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=a,this.url_=r,this.key=r}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==a.default.IDLE&&(this.setState(a.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(a.default.ERROR)}setFeatures(e){this.features_=e,this.setState(a.default.LOADED)}setLoader(e){this.loader_=e}}var o=n}),n("6zYyV",function(e,r){t(e.exports,"normalizeSpriteUrl",()=>s),t(e.exports,"normalizeStyleUrl",()=>n),t(e.exports,"normalizeSourceUrl",()=>l);let i="https://api.mapbox.com";function a(e){let t="mapbox://";return 0!==e.indexOf(t)?"":e.slice(t.length)}function s(e,t,r){let s=a(e);if(!s)return decodeURI(new URL(e,r).href);let n="sprites/";if(0!==s.indexOf(n))throw Error(`unexpected sprites url: ${e}`);let o=s.slice(n.length);return`${i}/styles/v1/${o}/sprite?access_token=${t}`}function n(e,t){let r=a(e);if(!r)return decodeURI(new URL(e,location.href).href);let s="styles/";if(0!==r.indexOf(s))throw Error(`unexpected style url: ${e}`);let n=r.slice(s.length);return`${i}/styles/v1/${n}?&access_token=${t}`}let o=["a","b","c","d"];function l(e,t,r,i){let s=new URL(e,i||location.href),n=a(e);if(!n)return t&&(s.searchParams.has(r)||s.searchParams.set(r,t)),[decodeURI(s.href)];if("mapbox.satellite"===n){let e=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${n}/{z}/{x}/{y}${e}.webp?access_token=${t}`]}return o.map(e=>`https://${e}.tiles.mapbox.com/v4/${n}/{z}/{x}/{y}.vector.pbf?access_token=${t}`)}}),n("4QRwa",function(e,r){t(e.exports,"applyStyle",()=>A),t(e.exports,"applyBackground",()=>C),s("6g00w");var i=s("gbCDL");s("4QhZh");var a=s("jZquI"),n=s("kPMpK"),o=s("9MiJs"),l=s("3VGVQ");s("dMe05");var u=s("2K2IB");s("eEuqc");var h=s("610XN"),c=s("gNqjI"),d=s("gmEQj"),p=s("aDAjs"),f=s("gzr8q");s("8jZo4");var m=s("205E0"),g=s("4evd8"),y=s("20LS2"),v=s("5Nyxy"),_=s("co8nU"),x=s("5NhYx"),b=s("6zYyV");s("QOQqa");var S=s("ilKez"),w=s("elpZt"),E=s("ePotS");function A(e,t,r="",i={},s){let l,u,m,A;let T=!0;if("string"==typeof r||Array.isArray(r)?A=r:(m=r,A=m.source||m.layers,i=m),"string"==typeof i?(l=i,m={}):(l=i.styleUrl,m=i),!1===m.updateSource&&(T=!1),s||(s=m.resolutions),l||"string"!=typeof t||t.trim().startsWith("{")||(l=t),l){var C,P;C=l=l.startsWith("data:")?location.href:(0,b.normalizeStyleUrl)(l,m.accessToken),(P=m).accessToken||(P=Object.assign({},P),new URL(C).searchParams.forEach((e,t)=>{P.accessToken=e,P.accessTokenParam=t})),m=P}return new Promise(function(r,i){(0,E.getGlStyle)(t,m).then(function(t){let C,P,R;if(8!=t.version)return i(Error("glStyle version 8 required."));if(!(e instanceof h.default||e instanceof c.default))return i(Error("Can only apply to VectorLayer or VectorTileLayer"));let I=e instanceof c.default?"vector":"geojson";if(A?u=Array.isArray(A)?t.layers.find(function(e){return e.id===A[0]}).source:A:A=u=Object.keys(t.sources).find(function(e){return t.sources[e].type===I}),!u)return i(Error(`No ${I} source found in the glStyle.`));function L(){if(!T)return Promise.resolve();if(e instanceof c.default){var r,i,s;return(r=t.sources[u],i=l,s=m,new Promise(function(e,t){(0,E.getTileJson)(r,i,s).then(function({tileJson:t,tileLoadFunction:i}){let n=function(e,t,r){let i=new g.default({tileJSON:t,tileSize:e.tileSize||t.tileSize||512}),s=i.getTileJSON(),n=i.getTileGrid(),o=(0,f.get)(r.projection||"EPSG:3857"),l=function(e,t){let r=e.bounds;if(r){let e=(0,f.fromLonLat)([r[0],r[1]],t),i=(0,f.fromLonLat)([r[2],r[3]],t);return[e[0],e[1],i[0],i[1]]}return(0,f.get)(t).getExtent()}(s,o),u=o.getExtent(),h=s.minzoom||0,c=s.maxzoom||22,d={attributions:i.getAttributions(),projection:o,tileGrid:new _.default({origin:u?(0,a.getTopLeft)(u):n.getOrigin(0),extent:l||n.getExtent(),minZoom:h,resolutions:(function(e,t=512){return e.getExtent()?(0,x.createXYZ)({extent:e.getExtent(),tileSize:t,maxZoom:22}).getResolutions():E.defaultResolutions})(o,t.tileSize).slice(0,c+1),tileSize:n.getTileSize(0)})};return Array.isArray(s.tiles)?d.urls=s.tiles:d.url=s.tiles,d}(r,t,s);n.tileLoadFunction=i,n.format=new o.default,e(new v.default(n))}).catch(t)})).then(function(t){let r=e.getSource();r?t!==r&&(r.setTileUrlFunction(t.getTileUrlFunction()),"function"==typeof r.setUrls&&"function"==typeof t.getUrls&&r.setUrls(t.getUrls()),r.format_||(r.format_=t.format_),r.getAttributions()||r.setAttributions(t.getAttributions()),r.getTileLoadFunction()===v.defaultLoadFunction&&r.setTileLoadFunction(t.getTileLoadFunction()),(0,f.equivalent)(r.getProjection(),t.getProjection())&&(r.tileGrid=t.getTileGrid())):e.setSource(t);let i=e.getSource().getTileGrid();!isFinite(e.getMaxResolution())&&!isFinite(e.getMinZoom())&&i.getMinZoom()>0&&e.setMaxResolution((0,E.getResolutionForZoom)(Math.max(0,i.getMinZoom()-1e-12),i.getResolutions()))})}let h=t.sources[u],p=e.getSource();p&&p.get("mapbox-source")===h||(p=function(e,t,r){let i=r.projection?new n.default({dataProjection:r.projection}):new n.default,a=e.data,s={};if("string"==typeof a){let[s]=(0,b.normalizeSourceUrl)(a,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(s)){let t=(e,t,r)=>{let i=function(e){let t=e?e.getCode():"EPSG:3857";return`{bbox-${t.toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}(r);return s.replace(i,`${e.join(",")}`)},a=new y.default({attributions:e.attribution,format:i,loader:(e,i,s,n,o)=>{let l="function"==typeof t?t(e,i,s):t;(0,E.fetchResource)("GeoJSON",l,r).then(e=>{let t=a.getFormat().readFeatures(e,{featureProjection:s});a.addFeatures(t),n(t)}).catch(t=>{a.removeLoadedExtent(e),o()})},strategy:d.bbox});return a.set("mapbox-source",e),a}let n=new y.default({attributions:e.attribution,format:i,url:s,loader:(e,t,i,a,o)=>{(0,E.fetchResource)("GeoJSON",s,r).then(e=>{let t=n.getFormat().readFeatures(e,{featureProjection:i});n.addFeatures(t),a(t)}).catch(t=>{n.removeLoadedExtent(e),o()})}});return n}s.features=i.readFeatures(a,{featureProjection:(0,f.getUserProjection)()||"EPSG:3857"});let o=new y.default(Object.assign({attributions:e.attribution,format:i},s));return o.set("mapbox-source",e),o}(h,l,m));let S=e.getSource();return S?p!==S&&(S.getAttributions()||S.setAttributions(p.getAttributions()),S.format_||(S.format_=p.getFormat()),S.url_=p.getUrl()):e.setSource(p),Promise.resolve()}function O(){if(R||t.sprite&&!C)R?(e.setStyle(R),L().then(r).catch(i)):i(Error("Something went wrong trying to apply style."));else{if(m.projection&&!s){let e=(0,f.get)(m.projection).getUnits();"m"!==e&&(s=(0,E.defaultResolutions).map(t=>t/p.METERS_PER_UNIT[e]))}R=(0,S.stylefunction)(e,t,A,s,C,P,(e,t=m.webfonts)=>(0,w.getFonts)(e,t),m.getImage),e.getStyle()?L().then(r).catch(i):i(Error(`Nothing to show for source [${u}]`))}}if(t.sprite){let e=new URL((0,b.normalizeSpriteUrl)(t.sprite,m.accessToken,l||location.href)),r=.5==(window.devicePixelRatio>=1.5?.5:1)?"@2x":"",a=e.origin+e.pathname+r+".json"+e.search;new Promise(function(t,r){(0,E.fetchResource)("Sprite",a,m).then(t).catch(function(i){a=e.origin+e.pathname+".json"+e.search,(0,E.fetchResource)("Sprite",a,m).then(t).catch(r)})}).then(function(t){if(void 0===t&&i(Error("No sprites found.")),C=t,P=e.origin+e.pathname+r+".png"+e.search,m.transformRequest){let e=m.transformRequest(P,"SpriteImage")||P;(e instanceof Request||e instanceof Promise)&&(P=e)}O()}).catch(function(e){i(Error(`Sprites cannot be loaded: ${a}: ${e.message}`))})}else O()}).catch(i)})}let T={};function C(e,t,r={}){return(0,E.getGlStyle)(t,r).then(function(t){!function(e,t,r){t.layers.some(function(t){if("background"===t.type){if(e instanceof u.default)return e.setBackground(function(e){return P(t,e,r,{})}),!0;if(e instanceof i.default||e instanceof l.default)return e.getLayers().insertAt(0,function(e,t,r){let i=document.createElement("div");return i.className="ol-mapbox-style-background",i.style.position="absolute",i.style.width="100%",i.style.height="100%",new u.default({source:new m.default({}),render(a){let s=P(e,a.viewState.resolution,t,r);return i.style.backgroundColor=s,i}})}(t,r,{})),!0}})}(e,t,r)})}function P(e,t,r,i){let a;let s={id:e.id,type:e.type},n=e.layout||{},o=e.paint||{};s.paint=o;let l=(0,E.getZoomForResolution)(t,r.resolutions||E.defaultResolutions),u=(0,S.getValue)(s,"paint","background-color",l,T,i);return void 0!==o["background-opacity"]&&(a=(0,S.getValue)(s,"paint","background-opacity",l,T,i)),"none"==n.visibility?void 0:(0,S._colorWithOpacity)(u,a)}}),n("kPMpK",function(e,r){t(e.exports,"default",()=>m);var i=s("iGyOD"),a=s("63y7W"),n=s("ee3b9"),o=s("kKEgb"),l=s("gzr8q"),u=s("29SgV"),h=s("9z1G1"),c=s("k8QYM");class d extends c.default{constructor(e){e=e||{},super(),this.dataProjection=(0,l.get)(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=(0,l.get)(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null,a=p((r="Feature"===e.type?e:{type:"Feature",geometry:e,properties:null}).geometry,t);if(this.featureClass===u.default)return(0,h.createRenderFeature)({geometry:a,id:r.id,properties:r.properties},t);let s=new i.default;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry((0,h.createGeometry)(a,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){let r=null;if("FeatureCollection"===e.type){r=[];let i=e.features;for(let e=0,a=i.length;e<a;++e){let a=this.readFeatureFromObject(i[e],t);a&&r.push(a)}}else r=[this.readFeatureFromObject(e,t)];return r.flat()}readGeometryFromObject(e,t){return function(e,t){let r=p(e,t);return(0,h.createGeometry)(r,t)}(e,t)}readProjectionFromObject(e){let t;let r=e.crs;if(r){if("name"==r.type)t=(0,l.get)(r.properties.name);else if("EPSG"===r.type)t=(0,l.get)("EPSG:"+r.properties.code);else throw Error("Unknown SRS type")}else t=this.dataProjection;return t}writeFeatureObject(e,t){t=this.adaptOptions(t);let r={type:"Feature",geometry:null,properties:null},i=e.getId();if(void 0!==i&&(r.id=i),!e.hasProperties())return r;let a=e.getProperties(),s=e.getGeometry();return s&&(r.geometry=f(s,t),delete a[e.getGeometryName()]),(0,o.isEmpty)(a)||(r.properties=a),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);let r=[];for(let i=0,a=e.length;i<a;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return f(e,this.adaptOptions(t))}}function p(e,t){let r;if(!e)return null;switch(e.type){case"Point":r=function(e){let t=e.coordinates;return{type:"Point",flatCoordinates:t,layout:(0,a.getLayoutForStride)(t.length)}}(e);break;case"LineString":r=function(e){let t=e.coordinates,r=t.flat();return{type:"LineString",flatCoordinates:r,ends:[r.length],layout:(0,a.getLayoutForStride)(t[0]?.length||2)}}(e);break;case"Polygon":r=function(e){let t=e.coordinates,r=[],i=t[0]?.[0]?.length,s=(0,n.deflateCoordinatesArray)(r,0,t,i);return{type:"Polygon",flatCoordinates:r,ends:s,layout:(0,a.getLayoutForStride)(i)}}(e);break;case"MultiPoint":r=function(e){let t=e.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:(0,a.getLayoutForStride)(t[0]?.length||2)}}(e);break;case"MultiLineString":r=function(e){let t=e.coordinates,r=t[0]?.[0]?.length||2,i=[],s=(0,n.deflateCoordinatesArray)(i,0,t,r);return{type:"MultiLineString",flatCoordinates:i,ends:s,layout:(0,a.getLayoutForStride)(r)}}(e);break;case"MultiPolygon":r=function(e){let t=e.coordinates,r=[],i=t[0]?.[0]?.[0].length||2,s=(0,n.deflateMultiCoordinatesArray)(r,0,t,i);return{type:"MultiPolygon",flatCoordinates:r,ends:s,layout:(0,a.getLayoutForStride)(i)}}(e);break;case"GeometryCollection":r=e.geometries.map(function(e){return p(e,void 0)});break;default:throw Error("Unsupported GeoJSON type: "+e.type)}return r}function f(e,t){var r,i,a,s;let n,o,l;let u=(e=(0,h.transformGeometryWithOptions)(e,!0,t)).getType();switch(u){case"Point":n={type:"Point",coordinates:e.getCoordinates()};break;case"LineString":n={type:"LineString",coordinates:e.getCoordinates()};break;case"Polygon":r=e,t&&(o=t.rightHanded),n={type:"Polygon",coordinates:r.getCoordinates(o)};break;case"MultiPoint":n={type:"MultiPoint",coordinates:e.getCoordinates()};break;case"MultiLineString":n={type:"MultiLineString",coordinates:e.getCoordinates()};break;case"MultiPolygon":i=e,t&&(l=t.rightHanded),n={type:"MultiPolygon",coordinates:i.getCoordinates(l)};break;case"GeometryCollection":a=e,s=Object.assign({},s=t),delete s.featureProjection,n={type:"GeometryCollection",geometries:a.getGeometriesArray().map(function(e){return f(e,s)})};break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw Error("Unsupported geometry type: "+u)}return n}var m=d}),n("9z1G1",function(e,r){t(e.exports,"default",()=>g),t(e.exports,"transformGeometryWithOptions",()=>y),t(e.exports,"createRenderFeature",()=>function e(t,r){var i,s;let n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(r=>e({...t,geometry:r})).flat();let o="MultiPolygon"===n.type?"Polygon":n.type;if("GeometryCollection"===o||"Circle"===o)throw Error("Unsupported geometry type: "+o);let l=n.layout.length;return y(new(0,f.default)(o,"Polygon"===o?(i=n.flatCoordinates,Array.isArray((s=n.ends)[0])?(0,a.linearRingssAreOriented)(i,0,s,l)||(i=i.slice(),(0,a.orientLinearRingsArray)(i,0,s,l)):(0,a.linearRingsAreOriented)(i,0,s,l)||(i=i.slice(),(0,a.orientLinearRings)(i,0,s,l)),i):n.flatCoordinates,n.ends?.flat(),l,t.properties||{},t.id).enableSimplifyTransformed(),!1,r)}),t(e.exports,"createGeometry",()=>function e(t,r){if(!t)return null;if(Array.isArray(t)){let i=t.map(t=>e(t,r));return new d.default(i)}return y(new v[t.type](t.flatCoordinates,t.layout||"XY",t.ends),!1,r)});var i=s("iGyOD"),a=s("2cCpz"),n=s("j2K3b"),o=s("hvEnP"),l=s("cgPpQ"),u=s("ljDIj"),h=s("7TB1l"),c=s("dEQmT"),d=s("6pyIt"),p=s("gzr8q"),f=s("29SgV"),m=s("lVQul"),g=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=i.default,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?(0,p.get)(t.dataProjection):this.readProjection(e);t.extent&&r&&"tile-pixels"===r.getUnits()&&(r=(0,p.get)(r)).setWorldExtent(t.extent),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return(0,m.abstract)()}readFeature(e,t){return(0,m.abstract)()}readFeatures(e,t){return(0,m.abstract)()}readGeometry(e,t){return(0,m.abstract)()}readProjection(e){return(0,m.abstract)()}writeFeature(e,t){return(0,m.abstract)()}writeFeatures(e,t){return(0,m.abstract)()}writeGeometry(e,t){return(0,m.abstract)()}};function y(e,t,r){let i=r?(0,p.get)(r.featureProjection):null,a=r?(0,p.get)(r.dataProjection):null,s=e;if(i&&a&&!(0,p.equivalent)(i,a)){t&&(s=e.clone());let r=t?i:a,n=t?a:i;"tile-pixels"===r.getUnits()?s.transform(r,n):s.applyTransform((0,p.getTransform)(r,n))}if(t&&r&&void 0!==r.decimals){let t=Math.pow(10,r.decimals);s===e&&(s=e.clone()),s.applyTransform(function(e){for(let r=0,i=e.length;r<i;++r)e[r]=Math.round(e[r]*t)/t;return e})}return s}let v={Point:n.default,LineString:o.default,Polygon:l.default,MultiPoint:u.default,MultiLineString:h.default,MultiPolygon:c.default}}),n("6pyIt",function(e,r){t(e.exports,"default",()=>h);var i=s("cw4dl"),a=s("bsgMw"),n=s("jZquI"),o=s("fvrVu");class l extends o.default{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(a.unlistenByKey),this.changeEventsKeys_.length=0}listenGeometriesChange_(){let e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push((0,a.listen)(e[t],i.default.CHANGE,this.changed,this))}clone(){let e=new l(u(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<(0,n.closestSquaredDistanceXY)(this.getExtent(),e,t))return i;let a=this.geometries_;for(let s=0,n=a.length;s<n;++s)i=a[s].closestPointXY(e,t,r,i);return i}containsXY(e,t){let r=this.geometries_;for(let i=0,a=r.length;i<a;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){(0,n.createOrUpdateEmpty)(e);let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)(0,n.extend)(e,t[r].getExtent());return e}getGeometries(){return u(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[],t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;let t=[],r=this.geometries_,i=!1;for(let a=0,s=r.length;a<s;++a){let s=r[a],n=s.getSimplifiedGeometry(e);t.push(n),n!==s&&(i=!0)}return i?new l(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(e,t){let r=this.geometries_;for(let i=0,a=r.length;i<a;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=(0,n.getCenter)(this.getExtent()));let i=this.geometries_;for(let a=0,s=i.length;a<s;++a)i[a].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(u(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){let r=this.geometries_;for(let i=0,a=r.length;i<a;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function u(e){return e.map(e=>e.clone())}var h=l}),n("k8QYM",function(e,r){t(e.exports,"default",()=>l);var i=s("lVQul"),a=s("9z1G1");class n extends a.default{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(o(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(o(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return(0,i.abstract)()}readFeaturesFromObject(e,t){return(0,i.abstract)()}readGeometry(e,t){return this.readGeometryFromObject(o(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return(0,i.abstract)()}readProjection(e){return this.readProjectionFromObject(o(e))}readProjectionFromObject(e){return(0,i.abstract)()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return(0,i.abstract)()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return(0,i.abstract)()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return(0,i.abstract)()}}function o(e){return"string"==typeof e?JSON.parse(e)||null:null!==e?e:null}var l=n}),n("9MiJs",function(e,r){t(e.exports,"default",()=>x);var i=s("k0bUy"),a=s("hvEnP"),n=s("7TB1l"),o=s("ljDIj"),l=s("dEQmT"),u=s("j2K3b"),h=s("cgPpQ"),c=s("2cCpz"),d=s("5zIbz"),p=s("gzr8q"),f=s("29SgV"),m=s("9z1G1");class g extends m.default{constructor(e){super(),e=e||{},this.dataProjection=new d.default({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:f.default,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,r,i){e.pos=t.geometry;let a=e.readVarint()+e.pos,s=1,n=0,o=0,l=0,u=0,h=0;for(;e.pos<a;){if(!n){let t=e.readVarint();s=7&t,n=t>>3}if(n--,1===s||2===s)o+=e.readSVarint(),l+=e.readSVarint(),1===s&&u>h&&(i.push(u),h=u),r.push(o,l),u+=2;else if(7===s)u>h&&(r.push(r[h],r[h+1]),u+=2);else throw Error("Invalid command found in the PBF")}u>h&&(i.push(u),h=u)}createFeature_(e,t,r){var i;let s,d,p;let g=t.type;if(0===g)return null;let y=t.properties;this.idProperty_?(d=y[this.idProperty_],delete y[this.idProperty_]):d=t.id,y[this.layerName_]=t.layer.name;let v=[],_=[];this.readRawGeometry_(e,t,v,_);let x=(i=_.length,1===g?p=1===i?"Point":"MultiPoint":2===g?p=1===i?"LineString":"MultiLineString":3===g&&(p="Polygon"),p);if(this.featureClass===f.default)(s=new this.featureClass(x,v,_,2,y,d)).transform(r.dataProjection);else{let e;if("Polygon"==x){let t=(0,c.inflateEnds)(v,_);e=t.length>1?new l.default(v,"XY",t):new h.default(v,"XY",_)}else e="Point"===x?new u.default(v,"XY"):"LineString"===x?new a.default(v,"XY"):"MultiPoint"===x?new o.default(v,"XY"):"MultiLineString"===x?new n.default(v,"XY",_):null;s=new this.featureClass,this.geometryName_&&s.setGeometryName(this.geometryName_);let t=(0,m.transformGeometryWithOptions)(e,!1,r);s.setGeometry(t),void 0!==d&&s.setId(d),s.setProperties(y,!0)}return s}getType(){return"arraybuffer"}readFeatures(e,t){let r=this.layers_;t=this.adaptOptions(t);let a=(0,p.get)(t.dataProjection);a.setWorldExtent(t.extent),t.dataProjection=a;let s=new i.default(e),n=s.readFields(y,{}),o=[];for(let e in n){if(r&&!r.includes(e))continue;let i=n[e],l=i?[0,0,i.extent,i.extent]:null;a.setExtent(l);for(let e=0,r=i.length;e<r;++e){let r=function(e,t,r){e.pos=t.features[r];let i=e.readVarint()+e.pos,a={layer:t,type:0,properties:{}};return e.readFields(_,a,i),a}(s,i,e),a=this.createFeature_(s,r,t);null!==a&&o.push(a)}}return o}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function y(e,t,r){if(3===e){let e={keys:[],values:[],features:[]},i=r.readVarint()+r.pos;r.readFields(v,e,i),e.length=e.features.length,e.length&&(t[e.name]=e)}}function v(e,t,r){if(15===e)t.version=r.readVarint();else if(1===e)t.name=r.readString();else if(5===e)t.extent=r.readVarint();else if(2===e)t.features.push(r.pos);else if(3===e)t.keys.push(r.readString());else if(4===e){let i=null,a=r.readVarint()+r.pos;for(;r.pos<a;)i=1==(e=r.readVarint()>>3)?r.readString():2===e?r.readFloat():3===e?r.readDouble():4===e?r.readVarint64():5===e?r.readVarint():6===e?r.readSVarint():7===e?r.readBoolean():null;t.values.push(i)}}function _(e,t,r){if(1==e)t.id=r.readVarint();else if(2==e){let e=r.readVarint()+r.pos;for(;r.pos<e;){let e=t.layer.keys[r.readVarint()],i=t.layer.values[r.readVarint()];t.properties[e]=i}}else 3==e?t.type=r.readVarint():4==e&&(t.geometry=r.pos)}var x=g}),n("k0bUy",function(e,r){t(e.exports,"default",()=>a);let i="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class a{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,r=this.length){for(;this.pos<r;){let r=this.readVarint(),i=r>>3,a=this.pos;this.type=7&r,e(i,t,this),this.pos===a&&this.skip(r)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){let e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){let e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){let e=this.dataView.getUint32(this.pos,!0)+4294967296*this.dataView.getUint32(this.pos+4,!0);return this.pos+=8,e}readSFixed64(){let e=this.dataView.getUint32(this.pos,!0)+4294967296*this.dataView.getInt32(this.pos+4,!0);return this.pos+=8,e}readFloat(){let e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){let e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){let t,r;let i=this.buf;return(t=127&(r=i[this.pos++]),r<128)?t:(t|=(127&(r=i[this.pos++]))<<7,r<128)?t:(t|=(127&(r=i[this.pos++]))<<14,r<128)?t:(t|=(127&(r=i[this.pos++]))<<21,r<128)?t:function(e,t,r){let i,a;let s=r.buf;if(i=(112&(a=s[r.pos++]))>>4,a<128||(i|=(127&(a=s[r.pos++]))<<3,a<128)||(i|=(127&(a=s[r.pos++]))<<10,a<128)||(i|=(127&(a=s[r.pos++]))<<17,a<128)||(i|=(127&(a=s[r.pos++]))<<24,a<128)||(i|=(1&(a=s[r.pos++]))<<31,a<128))return function(e,t,r){return r?4294967296*t+(e>>>0):(t>>>0)*4294967296+(e>>>0)}(e,i,t);throw Error("Expected varint not more than 10 bytes")}(t|=(15&(r=i[this.pos]))<<28,e,this)}readVarint64(){return this.readVarint(!0)}readSVarint(){let e=this.readVarint();return e%2==1?-((e+1)/2):e/2}readBoolean(){return!!this.readVarint()}readString(){let e=this.readVarint()+this.pos,t=this.pos;return(this.pos=e,e-t>=12&&i)?i.decode(this.buf.subarray(t,e)):function(e,t,r){let i="",a=t;for(;a<r;){let t,s,n;let o=e[a],l=null,u=o>239?4:o>223?3:o>191?2:1;if(a+u>r)break;1===u?o<128&&(l=o):2===u?(192&(t=e[a+1]))==128&&(l=(31&o)<<6|63&t)<=127&&(l=null):3===u?(t=e[a+1],s=e[a+2],(192&t)==128&&(192&s)==128&&((l=(15&o)<<12|(63&t)<<6|63&s)<=2047||l>=55296&&l<=57343)&&(l=null)):4===u&&(t=e[a+1],s=e[a+2],n=e[a+3],(192&t)==128&&(192&s)==128&&(192&n)==128&&((l=(15&o)<<18|(63&t)<<12|(63&s)<<6|63&n)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,u=1):l>65535&&(l-=65536,i+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),i+=String.fromCharCode(l),a+=u}return i}(this.buf,t,e)}readBytes(){let e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){let r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(e){let t=7&e;if(0===t)for(;this.buf[this.pos++]>127;);else if(2===t)this.pos=this.readVarint()+this.pos;else if(5===t)this.pos+=4;else if(1===t)this.pos+=8;else throw Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){let e=new Uint8Array(t);e.set(this.buf),this.buf=e,this.dataView=new DataView(e.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(23283064365386963e-26*e),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(23283064365386963e-26*e),!0),this.pos+=8}writeVarint(e){if((e=+e||0)>268435455||e<0){(function(e,t){var r;let i,a;if(e>=0?(i=e%4294967296|0,a=e/4294967296|0):(i=~(-e%4294967296),a=~(-e/4294967296),4294967295^i?i=i+1|0:(i=0,a=a+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw Error("Given varint doesn't fit into 10 bytes");t.realloc(10),r=i,t.buf[t.pos++]=127&r|128,r>>>=7,t.buf[t.pos++]=127&r|128,r>>>=7,t.buf[t.pos++]=127&r|128,r>>>=7,t.buf[t.pos++]=127&r|128,r>>>=7,t.buf[t.pos]=127&r,function(e,t){let r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e)&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e)&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))}(a,t)})(e,this);return}this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-(2*e)-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;let t=this.pos;this.pos=function(e,t,r){for(let i=0,a,s;i<t.length;i++){if((a=t.charCodeAt(i))>55295&&a<57344){if(s){if(a<56320){e[r++]=239,e[r++]=191,e[r++]=189,s=a;continue}a=s-55296<<10|a-56320|65536,s=null}else{a>56319||i+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):s=a;continue}}else s&&(e[r++]=239,e[r++]=191,e[r++]=189,s=null);a<128?e[r++]=a:(a<2048?e[r++]=a>>6|192:(a<65536?e[r++]=a>>12|224:(e[r++]=a>>18|240,e[r++]=a>>12&63|128),e[r++]=a>>6&63|128),e[r++]=63&a|128)}return r}(this.buf,e,this.pos);let r=this.pos-t;r>=128&&s(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){let t=e.length;this.writeVarint(t),this.realloc(t);for(let r=0;r<t;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,t){this.pos++;let r=this.pos;e(t,this);let i=this.pos-r;i>=128&&s(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i}writeMessage(e,t,r){this.writeTag(e,2),this.writeRawMessage(t,r)}writePackedVarint(e,t){t.length&&this.writeMessage(e,n,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,o,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,h,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,l,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,u,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,c,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,d,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,p,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,f,t)}writeBytesField(e,t){this.writeTag(e,2),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,5),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,5),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,1),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,1),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,0),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,0),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,2),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,5),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,1),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function s(e,t,r){let i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(i);for(let t=r.pos-1;t>=e;t--)r.buf[t+i]=r.buf[t]}function n(e,t){for(let r=0;r<e.length;r++)t.writeVarint(e[r])}function o(e,t){for(let r=0;r<e.length;r++)t.writeSVarint(e[r])}function l(e,t){for(let r=0;r<e.length;r++)t.writeFloat(e[r])}function u(e,t){for(let r=0;r<e.length;r++)t.writeDouble(e[r])}function h(e,t){for(let r=0;r<e.length;r++)t.writeBoolean(e[r])}function c(e,t){for(let r=0;r<e.length;r++)t.writeFixed32(e[r])}function d(e,t){for(let r=0;r<e.length;r++)t.writeSFixed32(e[r])}function p(e,t){for(let r=0;r<e.length;r++)t.writeFixed64(e[r])}function f(e,t){for(let r=0;r<e.length;r++)t.writeSFixed64(e[r])}}),n("dMe05",function(e,r){t(e.exports,"default",()=>o);var i=s("fnQuI"),a=s("55uKe");class n extends a.default{constructor(e){super(e)}createRenderer(){return new i.default(this)}getData(e){return super.getData(e)}}var o=n}),n("55uKe",function(e,r){t(e.exports,"default",()=>n);var i=s("2K2IB");class a extends i.default{constructor(e){super(e=e||{})}}var n=a}),n("eEuqc",function(e,r){t(e.exports,"default",()=>o);var i=s("1FnBm"),a=s("g0oXy");class n extends a.default{constructor(e){super(e)}createRenderer(){return new i.default(this,{cacheSize:this.getCacheSize()})}}var o=n}),n("g0oXy",function(e,r){t(e.exports,"default",()=>o);var i=s("2K2IB"),a=s("8ElLP");class n extends i.default{constructor(e){let t=Object.assign({},e=e||{}),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(void 0!==e.preload?e.preload:0),this.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(a.default.PRELOAD)}setPreload(e){this.set(a.default.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(a.default.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(a.default.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}var o=n}),n("8jZo4",function(e,r){t(e.exports,"default",()=>A);var i=s("jjfV9"),a=s("34ffr"),n=s("2CoDJ"),o=s("cgxQK"),l=s("iTTi2"),u=s("cw4dl"),h=s("jZquI"),c=s("dMe05"),d=s("eEuqc"),p=s("14PDX"),f=s("lVQul"),m=s("3i1Ma"),g=s("205E0"),y=s("cpPSZ"),v=s("awmEs").Buffer;function _(e){return function(t){let r=t.buffers,i=t.meta,a=t.imageOps,s=t.width,n=t.height,o=r.length,l=r[0].byteLength;if(a){let t=Array(o);for(let e=0;e<o;++e)t[e]=new ImageData(new Uint8ClampedArray(r[e]),s,n);return e(t,i).data.buffer}let u=new Uint8ClampedArray(l),h=Array(o),c=Array(o);for(let e=0;e<o;++e)h[e]=new Uint8ClampedArray(r[e]),c[e]=[0,0,0,0];for(let t=0;t<l;t+=4){for(let e=0;e<o;++e){let r=h[e];c[e][0]=r[t],c[e][1]=r[t+1],c[e][2]=r[t+2],c[e][3]=r[t+3]}let r=e(c,i);u[t]=r[0],u[t+1]=r[1],u[t+2]=r[2],u[t+3]=r[3]}return u.buffer}}class x extends i.default{constructor(e){let t;super(),this.imageOps_=!!e.imageOps;let r=Array(t=0===e.threads?0:this.imageOps_?1:e.threads||1);if(t)for(let i=0;i<t;++i)r[i]=function(e,t){let r=Object.keys(e.lib||{}).map(function(t){return"const "+t+" = "+e.lib[t].toString()+";"}).concat(["const __minion__ = ("+_.toString()+")(",e.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),i=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+v.from(r.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(r,{type:"text/javascript"})));return i.addEventListener("message",t),i}(e,this.onWorkerMessage_.bind(this,i));else r[0]=function(e,t){let r=_(e.operation),i=!1;return{postMessage:function(e){setTimeout(function(){i||t({data:{buffer:r(e),meta:e.meta}})},0)},terminate:function(){i=!0}}}(e,this.onWorkerMessage_.bind(this,0));this.workers_=r,this.queue_=[],this.maxQueueLength_=e.queue||1/0,this.running_=0,this.dataLookup_={},this.job_=null}process(e,t,r){this.enqueue_({inputs:e,meta:t,callback:r}),this.dispatch_()}enqueue_(e){for(this.queue_.push(e);this.queue_.length>this.maxQueueLength_;)this.queue_.shift().callback(null,null)}dispatch_(){if(this.running_||0===this.queue_.length)return;let e=this.queue_.shift();this.job_=e;let t=e.inputs[0].width,r=e.inputs[0].height,i=e.inputs.map(function(e){return e.data.buffer}),a=this.workers_.length;if(this.running_=a,1===a){this.workers_[0].postMessage({buffers:i,meta:e.meta,imageOps:this.imageOps_,width:t,height:r},i);return}let s=4*Math.ceil(e.inputs[0].data.length/4/a);for(let n=0;n<a;++n){let a=n*s,o=[];for(let e=0,t=i.length;e<t;++e)o.push(i[e].slice(a,a+s));this.workers_[n].postMessage({buffers:o,meta:e.meta,imageOps:this.imageOps_,width:t,height:r},o)}}onWorkerMessage_(e,t){this.disposed||(this.dataLookup_[e]=t.data,--this.running_,0===this.running_&&this.resolveJob_())}resolveJob_(){let e,t;let r=this.job_,i=this.workers_.length;if(1===i)e=new Uint8ClampedArray(this.dataLookup_[0].buffer),t=this.dataLookup_[0].meta;else{let a=r.inputs[0].data.length;e=new Uint8ClampedArray(a),t=Array(i);let s=4*Math.ceil(a/4/i);for(let r=0;r<i;++r){let i=this.dataLookup_[r].buffer,a=r*s;e.set(new Uint8ClampedArray(i),a),t[r]=this.dataLookup_[r].meta}}this.job_=null,this.dataLookup_={},r.callback(null,new ImageData(e,r.inputs[0].width,r.inputs[0].height),t),this.dispatch_()}disposeInternal(){for(let e=0;e<this.workers_.length;++e)this.workers_[e].terminate();this.workers_.length=0}}let b={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};class S extends l.default{constructor(e,t,r){super(e),this.extent=t.extent,this.resolution=t.viewState.resolution/t.pixelRatio,this.data=r}}class w extends m.default{constructor(e){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=void 0!==e.operationType?e.operationType:"pixel",this.threads_=void 0!==e.threads?e.threads:1,this.layers_=function(e){let t=e.length,r=Array(t);for(let i=0;i<t;++i)r[i]=function(e){let t;return e instanceof g.default?e instanceof y.default?t=new d.default({source:e}):e instanceof m.default&&(t=new c.default({source:e})):t=e,t}(e[i]);return r}(e.sources);let t=this.changed.bind(this);for(let e=0,r=this.layers_.length;e<r;++e)this.layers_[e].addEventListener(u.default.CHANGE,t);this.useResolutions_=null!==e.resolutions,this.tileQueue_=new n.default(function(){return 1},this.processSources_.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:(0,p.create)(),declutter:null,extent:null,index:0,layerIndex:0,layerStatesArray:this.layers_.map(function(e){return e.getLayerState()}),pixelRatio:1,pixelToCoordinateTransform:(0,p.create)(),postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:(0,f.getUid)(this),renderTargets:{}},this.setAttributions(function(t){let r=[];for(let i=0,a=e.sources.length;i<a;++i){let a=e.sources[i],s=a instanceof g.default?a:a.getSource();if(!s)continue;let n=s.getAttributions()?.(t);"string"==typeof n?r.push(n):void 0!==n&&r.push(...n)}return r}),void 0!==e.operation&&this.setOperation(e.operation,e.lib)}setOperation(e,t){this.processor_&&this.processor_.dispose(),this.processor_=new x({operation:e,imageOps:"image"===this.operationType_,queue:1,lib:t,threads:this.threads_}),this.changed()}updateFrameState_(e,t,r){let i=Object.assign({},this.frameState_);i.viewState=Object.assign({},i.viewState);let a=(0,h.getCenter)(e);i.size[0]=Math.ceil((0,h.getWidth)(e)/t),i.size[1]=Math.ceil((0,h.getHeight)(e)/t),i.extent=[a[0]-i.size[0]*t/2,a[1]-i.size[1]*t/2,a[0]+i.size[0]*t/2,a[1]+i.size[1]*t/2],i.time=Date.now();let s=i.viewState;return s.center=a,s.projection=r,s.resolution=t,i}allSourcesReady_(){let e,t=!0;for(let r=0,i=this.layers_.length;r<i;++r)if(!(e=this.layers_[r].getSource())||"ready"!==e.getState()){t=!1;break}return t}getImage(e,t,r,i){if(!this.allSourcesReady_())return null;this.tileQueue_.loadMoreTiles(16,16),t=this.findNearestResolution(t);let a=this.updateFrameState_(e,t,i);if(this.requestedFrameState_=a,this.renderedImageCanvas_){let e=this.renderedImageCanvas_.getResolution(),r=this.renderedImageCanvas_.getExtent();t===e&&(0,h.equals)(a.extent,r)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),a.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){let e=this.requestedFrameState_,t=this.layers_.length,r=Array(t);for(let i=0;i<t;++i){e.layerIndex=i,e.renderTargets={};let t=function(e,t){let r;let i=e.getRenderer();if(!i)throw Error("Unsupported layer type: "+e);if(!i.prepareFrame(t))return null;let a=t.size[0],s=t.size[1];if(0===a||0===s)return null;let n=i.renderFrame(t,null);if(n instanceof HTMLCanvasElement)r=n;else{if(n&&(r=n.firstElementChild),!(r instanceof HTMLCanvasElement))throw Error("Unsupported rendered element: "+r);if(r.width===a&&r.height===s)return r.getContext("2d").getImageData(0,0,a,s)}if(E){let e=E.canvas;e.width!==a||e.height!==s?E=(0,o.createCanvasContext2D)(a,s,void 0,{willReadFrequently:!0}):E.clearRect(0,0,a,s)}else E=(0,o.createCanvasContext2D)(a,s,void 0,{willReadFrequently:!0});return E.drawImage(r,0,0,a,s),E.getImageData(0,0,a,s)}(this.layers_[i],e);if(!t)return;r[i]=t}let i={};this.dispatchEvent(new S(b.BEFOREOPERATIONS,e,i)),this.processor_.process(r,i,this.onWorkerComplete_.bind(this,e))}onWorkerComplete_(e,t,r,i){let s;if(t||!r)return;let n=e.extent,l=e.viewState.resolution;if(l===this.requestedFrameState_.viewState.resolution&&(0,h.equals)(n,this.requestedFrameState_.extent)){if(this.renderedImageCanvas_)s=this.renderedImageCanvas_.getImage().getContext("2d");else{let e=Math.round((0,h.getWidth)(n)/l),t=Math.round((0,h.getHeight)(n)/l);s=(0,o.createCanvasContext2D)(e,t),this.renderedImageCanvas_=new a.default(n,l,1,s.canvas)}s.putImageData(r,0,0),e.animate?requestAnimationFrame(this.changed.bind(this)):this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new S(b.AFTEROPERATIONS,e,i))}}getResolutions(e){if(!this.useResolutions_)return null;let t=super.getResolutions();if(!t)for(let r=0,i=this.layers_.length;r<i&&!(t=this.layers_[r].getSource().getResolutions(e));++r);return t}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}w.prototype.dispose;let E=null;var A=w}),n("3i1Ma",function(e,r){t(e.exports,"getRequestExtent",()=>_),t(e.exports,"default",()=>x);var i=s("kUxvm"),a=s("50PZ9"),n=s("kBSVF"),o=s("iTTi2"),l=s("cw4dl"),u=s("jZquI"),h=s("a6roo"),c=s("gzr8q"),d=s("kRXzy"),p=s("djufG"),f=s("205E0"),m=s("fqTWj");let g={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class y extends o.default{constructor(e,t){super(e),this.image=t}}class v extends f.default{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:void 0===e.interpolate||e.interpolate}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!e.loader&&0===e.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){let t=this.getResolutions();if(t){let r=(0,n.linearFindNearest)(t,e,0);e=t[r]}return e}getImage(e,t,r,i){let a=this.getProjection();if(!a||!i||(0,c.equivalent)(a,i))return a&&(i=a),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,c.equivalent)(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&(0,u.equals)(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new d.default(a,i,e,t,r,(e,t,r)=>this.getImageInternal(e,t,r,a),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,a){if(this.loader){let s=_(e,t,r,1),n=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===a&&(this.wantedExtent_&&(0,u.containsExtent)(this.wantedExtent_,s)||(0,u.containsExtent)(this.image.getExtent(),s))&&(this.wantedResolution_&&(0,p.fromResolutionLike)(this.wantedResolution_)===n||(0,p.fromResolutionLike)(this.image.getResolution())===n)))return this.image;this.wantedProjection_=a,this.wantedExtent_=s,this.wantedResolution_=n,this.image=new i.default(s,n,r,this.loader),this.image.addEventListener(l.default.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){let t;let r=e.target;switch(r.getState()){case a.default.LOADING:this.loading=!0,t=g.IMAGELOADSTART;break;case a.default.LOADED:this.loading=!1,t=g.IMAGELOADEND;break;case a.default.ERROR:this.loading=!1,t=g.IMAGELOADERROR;break;default:return}this.hasListener(t)&&this.dispatchEvent(new y(t,r))}}function _(e,t,r,i){let a=t/r,s=(0,u.getCenter)(e),n=(0,h.ceil)((0,u.getWidth)(e)/a,m.DECIMALS),o=(0,h.ceil)((0,u.getHeight)(e)/a,m.DECIMALS),l=(0,h.ceil)((i-1)*n/2,m.DECIMALS),c=(0,h.ceil)((i-1)*o/2,m.DECIMALS);return(0,u.getForViewAndSize)(s,a,0,[n+2*l,o+2*c])}var x=v}),n("kRXzy",function(e,r){t(e.exports,"default",()=>f);var i=s("kUxvm"),a=s("50PZ9"),n=s("cw4dl"),o=s("bsgMw"),l=s("jZquI"),u=s("gpSXC"),h=s("djufG"),c=s("9JHmh"),d=s("9ndmc");class p extends i.default{constructor(e,t,r,i,s,n,o){let h=e.getExtent();h&&e.canWrapX()&&((h=h.slice())[0]=-1/0,h[2]=1/0);let p=t.getExtent();p&&t.canWrapX()&&((p=p.slice())[0]=-1/0,p[2]=1/0);let f=p?(0,l.getIntersection)(r,p):r,m=(0,l.getCenter)(f),g=(0,u.calculateSourceResolution)(e,t,m,i),y=d.ERROR_THRESHOLD,v=new c.default(e,t,f,h,g*y,i),_=v.calculateSourceExtent(),x=(0,l.isEmpty)(_)?null:n(_,g,s),b=x?a.default.IDLE:a.default.EMPTY,S=x?x.getPixelRatio():1;super(r,i,S,b),this.targetProj_=t,this.maxSourceExtent_=h,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=x,this.sourcePixelRatio_=S,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==a.default.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){let e=this.sourceImage_.getState();if(e==a.default.LOADED){let e=(0,l.getWidth)(this.targetExtent_)/this.targetResolution_,t=(0,l.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,u.render)(e,t,this.sourcePixelRatio_,(0,h.fromResolutionLike)(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==a.default.IDLE){this.state=a.default.LOADING,this.changed();let e=this.sourceImage_.getState();e==a.default.LOADED||e==a.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,o.listen)(this.sourceImage_,n.default.CHANGE,e=>{let t=this.sourceImage_.getState();(t==a.default.LOADED||t==a.default.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){(0,o.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null}}var f=p}),n("fqTWj",function(e,r){t(e.exports,"DECIMALS",()=>i);let i=4}),n("cpPSZ",function(e,r){t(e.exports,"TileSourceEvent",()=>c),t(e.exports,"default",()=>d);var i=s("iTTi2"),a=s("6BjcK"),n=s("9YraL"),o=s("5NhYx"),l=s("lVQul"),u=s("205E0");class h extends u.default{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileGrid&&(0,a.toSize)(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=e.key||(0,l.getUid)(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){let t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,a){return(0,l.abstract)()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:(0,o.getForProjection)(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){let i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),n=(0,a.toSize)(i.getTileSize(e),this.tmpSize);return 1==s?n:(0,a.scale)(n,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){let r=void 0!==t?t:this.getProjection(),i=void 0!==t?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=(0,o.wrapX)(i,e,r)),(0,n.withinExtentAndZ)(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class c extends i.default{constructor(e,t){super(e),this.tile=t}}var d=h}),n("5NhYx",function(e,r){t(e.exports,"getForProjection",()=>u),t(e.exports,"wrapX",()=>h),t(e.exports,"extentFromProjection",()=>p),t(e.exports,"createXYZ",()=>c);var i=s("jZquI"),a=s("gzr8q"),n=s("6BjcK"),o=s("co8nU"),l=s("3QMf6");function u(e){let t=e.getDefaultTileGrid();return t||(t=function(e,t,r,a){a=void 0!==a?a:"top-left";let s=d(e,t,r);return new o.default({extent:e,origin:(0,i.getCorner)(e,a),resolutions:s,tileSize:r})}(p(e),void 0,void 0,void 0),e.setDefaultTileGrid(t)),t}function h(e,t,r){let a=t[0],s=e.getTileCoordCenter(t),n=p(r);if(!(0,i.containsCoordinate)(n,s)){let t=(0,i.getWidth)(n),r=Math.ceil((n[0]-s[0])/t);return s[0]+=t*r,e.getTileCoordForCoordAndZ(s,a)}return t}function c(e){let t=e||{},r=t.extent||(0,a.get)("EPSG:3857").getExtent(),i={extent:r,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:d(r,t.maxZoom,t.tileSize,t.maxResolution)};return new o.default(i)}function d(e,t,r,a){t=void 0!==t?t:l.DEFAULT_MAX_ZOOM,r=(0,n.toSize)(void 0!==r?r:l.DEFAULT_TILE_SIZE);let s=(0,i.getHeight)(e),o=(0,i.getWidth)(e);a=a>0?a:Math.max(o/r[0],s/r[1]);let u=t+1,h=Array(u);for(let e=0;e<u;++e)h[e]=a/Math.pow(2,e);return h}function p(e){let t=(e=(0,a.get)(e)).getExtent();if(!t){let r=180*a.METERS_PER_UNIT.degrees/e.getMetersPerUnit();t=(0,i.createOrUpdate)(-r,-r,r,r)}return t}}),n("co8nU",function(e,r){t(e.exports,"default",()=>f);var i=s("jRKCY"),a=s("kBSVF"),n=s("eJ4LZ"),o=s("jZquI"),l=s("4NB4B"),u=s("a6roo"),h=s("6BjcK"),c=s("9YraL"),d=s("3QMf6");let p=[0,0,0];var f=class{constructor(e){let t;if(this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,(0,n.assert)((0,a.isSorted)(this.resolutions_,(e,t)=>t-e,!0),"`resolutions` must be sorted in descending order"),!e.origins)for(let e=0,r=this.resolutions_.length-1;e<r;++e)if(t){if(this.resolutions_[e]/this.resolutions_[e+1]!==t){t=void 0;break}}else t=this.resolutions_[e]/this.resolutions_[e+1];this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,(0,n.assert)(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let r=e.extent;void 0===r||this.origin_||this.origins_||(this.origin_=(0,o.getTopLeft)(r)),(0,n.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,(0,n.assert)(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:d.DEFAULT_TILE_SIZE,(0,n.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map((e,t)=>{let a=new i.default(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));if(r){let e=this.getTileRangeForExtentAndZ(r,t);a.minX=Math.max(e.minX,a.minX),a.maxX=Math.min(e.maxX,a.maxX),a.minY=Math.max(e.minY,a.minY),a.maxY=Math.min(e.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){let i=this.getTileRangeForExtentAndZ(e,t);for(let e=i.minX,a=i.maxX;e<=a;++e)for(let a=i.minY,s=i.maxY;a<=s;++a)r([t,e,a])}forEachTileCoordParentTileRange(e,t,r,a){let s,n,o;let l=null,u=e[0]-1;for(2===this.zoomFactor_?(n=e[1],o=e[2]):l=this.getTileCoordExtent(e,a);u>=this.minZoom;){if(void 0!==n&&void 0!==o?(n=Math.floor(n/2),o=Math.floor(o/2),s=(0,i.createOrUpdate)(n,n,o,o,r)):s=this.getTileRangeForExtentAndZ(l,u,r),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(2===this.zoomFactor_){let r=2*e[1],a=2*e[2];return(0,i.createOrUpdate)(r,r+1,a,a+1,t)}let a=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;let a=e[0],s=e[1],n=e[2];if(t===a)return(0,i.createOrUpdate)(s,n,s,n,r);if(this.zoomFactor_){let e=Math.pow(this.zoomFactor_,t-a),o=Math.floor(s*e),l=Math.floor(n*e);if(t<a)return(0,i.createOrUpdate)(o,o,l,l,r);let u=Math.floor(e*(s+1))-1,h=Math.floor(e*(n+1))-1;return(0,i.createOrUpdate)(o,u,l,h,r)}let o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,p);let a=p[1],s=p[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,p);let n=p[1],o=p[2];return(0,i.createOrUpdate)(a,n,s,o,r)}getTileCoordCenter(e){let t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=(0,h.toSize)(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){let r=this.getOrigin(e[0]),i=this.getResolution(e[0]),a=(0,h.toSize)(this.getTileSize(e[0]),this.tmpSize_),s=r[0]+e[1]*a[0]*i,n=r[1]-(e[2]+1)*a[1]*i,l=s+a[0]*i,u=n+a[1]*i;return(0,o.createOrUpdate)(s,n,l,u,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,a){let s=this.getZForResolution(r),n=r/this.getResolution(s),o=this.getOrigin(s),l=(0,h.toSize)(this.getTileSize(s),this.tmpSize_),d=n*(e-o[0])/r/l[0],p=n*(o[1]-t)/r/l[1];return i?(d=(0,u.ceil)(d,5)-1,p=(0,u.ceil)(p,5)-1):(d=(0,u.floor)(d,5),p=(0,u.floor)(p,5)),(0,c.createOrUpdate)(s,d,p,a)}getTileCoordForXYAndZ_(e,t,r,i,a){let s=this.getOrigin(r),n=this.getResolution(r),o=(0,h.toSize)(this.getTileSize(r),this.tmpSize_),l=(e-s[0])/n/o[0],d=(s[1]-t)/n/o[1];return i?(l=(0,u.ceil)(l,5)-1,d=(0,u.ceil)(d,5)-1):(l=(0,u.floor)(l,5),d=(0,u.floor)(d,5)),(0,c.createOrUpdate)(r,l,d,a)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){let r=(0,a.linearFindNearest)(this.resolutions_,e,t||0);return(0,u.clamp)(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return(0,l.intersectsLinearRing)(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){let t=this.resolutions_.length,r=Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}}),n("4evd8",function(e,r){t(e.exports,"default",()=>c);var i=s("jZquI"),a=s("gNxZS"),n=s("gzr8q"),o=s("5NhYx"),l=s("ga5CQ"),u=s("42VYg");class h extends u.default{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:(0,n.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url){if(e.jsonp)(0,a.jsonp)(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{let t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){let t=e.target;if(!t.status||t.status>=200&&t.status<300){let e;try{e=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(e)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){let t;let r=(0,n.get)("EPSG:4326"),a=this.getProjection();if(void 0!==e.bounds){let s=(0,n.getTransformFromProjections)(r,a);t=(0,i.applyTransform)(e.bounds,s)}let s=(0,o.extentFromProjection)(a),u=e.minzoom||0,h=e.maxzoom||22,c=(0,o.createXYZ)({extent:s,maxZoom:h,minZoom:u,tileSize:this.tileSize_});if(this.tileGrid=c,this.tileUrlFunction=(0,l.createFromTemplates)(e.tiles,c),e.attribution&&!this.getAttributions()){let r=void 0!==t?t:s;this.setAttributions(function(t){return(0,i.intersects)(r,t.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}var c=h}),n("gNxZS",function(e,r){t(e.exports,"jsonp",()=>a);var i=s("lVQul");function a(e,t,r,a){let s=document.createElement("script"),n="olc_"+(0,i.getUid)(t);function o(){delete window[n],s.parentNode.removeChild(s)}s.async=!0,s.src=e+(e.includes("?")?"&":"?")+(a||"callback")+"="+n;let l=setTimeout(function(){o(),r&&r()},1e4);window[n]=function(e){clearTimeout(l),o(),t(e)},document.head.appendChild(s)}}),n("ga5CQ",function(e,r){t(e.exports,"createFromTemplates",()=>o),t(e.exports,"createFromTileUrlFunctions",()=>l);var i=s("a6roo"),a=s("9YraL"),n=s("9AVh1");function o(e,t){let r=e.length,i=Array(r);for(let a=0;a<r;++a)i[a]=function(e,t){return function(r,i,a){let s;if(!r)return;let o=r[0];if(t){let e=t.getFullTileRange(o);e&&(s=e.getHeight()-1)}return(0,n.renderXYZTemplate)(e,o,r[1],r[2],s)}}(e[a],t);return l(i)}function l(e){return 1===e.length?e[0]:function(t,r,s){if(!t)return;let n=(0,a.hash)(t),o=(0,i.modulo)(n,e.length);return e[o](t,r,s)}}}),n("9AVh1",function(e,r){function i(e,t){let r=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&r.push(e+"="+encodeURIComponent(t[e]))});let i=r.join("&");return e=e.replace(/[?&]$/,""),(e+=e.includes("?")?"&":"?")+i}t(e.exports,"appendParams",()=>i),t(e.exports,"renderXYZTemplate",()=>u),t(e.exports,"expandUrl",()=>h),s("a6roo"),s("9YraL");let a=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,l=/\{-y\}/g;function u(e,t,r,i,s){return e.replace(a,t.toString()).replace(n,r.toString()).replace(o,i.toString()).replace(l,function(){if(void 0===s)throw Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-i).toString()})}function h(e){let t=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){let i;let a=r[1].charCodeAt(0),s=r[2].charCodeAt(0);for(i=a;i<=s;++i)t.push(e.replace(r[0],String.fromCharCode(i)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e)){let i=parseInt(r[2],10);for(let a=parseInt(r[1],10);a<=i;a++)t.push(e.replace(r[0],a.toString()));return t}return t.push(e),t}}),n("42VYg",function(e,r){t(e.exports,"default",()=>f);var i=s("6EHBB"),a=s("av38f"),n=s("cw4dl"),o=s("gzr8q"),l=s("lUH7Q"),u=s("5NhYx"),h=s("lVQul"),c=s("5k6kp");class d extends c.default{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:p,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:i.default,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!(0,o.equivalent)(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||(0,o.equivalent)(t,e)))return this.tileGrid;let r=(0,h.getUid)(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=(0,u.getForProjection)(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,o){let l=[e,t,r],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,i,s):void 0,c=new this.tileClass(l,void 0!==h?a.default.IDLE:a.default.EMPTY,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(n.default.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,r,i,a){let s=this.getProjection();if(!s||!a||(0,o.equivalent)(s,a))return this.getTileInternal(e,t,r,i,s||a);let n=[e,t,r],u=this.getKey(),h=this.getTileGridForProjection(s),c=this.getTileGridForProjection(a),d=this.getTileCoordForTileUrlFunction(n,a),p=new l.default(s,h,a,c,n,d,this.getTilePixelRatio(i),this.getGutter(),(e,t,r,i)=>this.getTileInternal(e,t,r,i,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return p.key=u,p}getTileInternal(e,t,r,i,a){let s=this.getKey();return this.createTile_(e,t,r,i,a,s)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){let r=(0,o.get)(e);if(r){let e=(0,h.getUid)(r);e in this.tileGridForProjection||(this.tileGridForProjection[e]=t)}}}function p(e,t){e.getImage().src=t}var f=d}),n("5k6kp",function(e,r){t(e.exports,"default",()=>c);var i=s("av38f"),a=s("ga5CQ"),n=s("9AVh1"),o=s("lVQul"),l=s("cpPSZ"),u=s("65P3L");class h extends l.default{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===h.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){let t;let r=e.target,a=(0,o.getUid)(r),s=r.getState();s==i.default.LOADING?(this.tileLoadingKeys_[a]=!0,t=u.default.TILELOADSTART):a in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[a],t=s==i.default.ERROR?u.default.TILELOADERROR:s==i.default.LOADED?u.default.TILELOADEND:void 0),void 0!=t&&this.dispatchEvent(new l.TileSourceEvent(t,r))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,void 0!==t?this.setKey(t):this.changed()}setUrl(e){let t=(0,n.expandUrl)(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;let t=e.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,a.createFromTemplates)(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}var c=h}),n("65P3L",function(e,r){t(e.exports,"default",()=>i);var i={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"}}),n("5Nyxy",function(e,r){t(e.exports,"defaultLoadFunction",()=>v),t(e.exports,"default",()=>y);var i=s("av38f"),a=s("25aE7"),n=s("cFxEe"),o=s("cw4dl"),l=s("jZquI"),u=s("kWPIP"),h=s("kKEgb"),c=s("6BjcK"),d=s("co8nU"),p=s("3QMf6"),f=s("5NhYx"),m=s("5k6kp");class g extends m.default{constructor(e){let t=e.projection||"EPSG:3857";super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:e.tileGrid||(0,f.createXYZ)({extent:e.extent||(0,f.extentFromProjection)(t),maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512}),tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:v,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=void 0==e.overlaps||e.overlaps,this.tileClass=e.tileClass?e.tileClass:n.default,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,r){if(r.getState()===i.default.IDLE){r.setState(i.default.LOADING);let a=r.wrappedTileCoord,s=this.getTileGridForProjection(t),n=s.getTileCoordExtent(a),u=a[0],c=s.getResolution(u);(0,l.buffer)(n,-c,n);let d=this.tileGrid,p=d.getExtent();p&&(0,l.getIntersection)(n,p,n);let f=d.getZForResolution(c,this.zDirection);d.forEachTileCoord(n,f,a=>{let s=this.tileUrlFunction(a,e,t);this.sourceTiles_[s]||(this.sourceTiles_[s]=new this.tileClass(a,s?i.default.IDLE:i.default.EMPTY,s,this.format_,this.tileLoadFunction));let n=this.sourceTiles_[s];r.sourceTiles.push(n),this.tileKeysBySourceTileUrl_[s]||(this.tileKeysBySourceTileUrl_[s]=[]),this.tileKeysBySourceTileUrl_[s].push(r.getKey());let l=n.getState();if(l<i.default.LOADED){let e=t=>{this.handleTileChange(t);let a=n.getState();if(a===i.default.LOADED||a===i.default.ERROR){let t=n.getKey();t in r.errorTileKeys?n.getState()===i.default.LOADED&&delete r.errorTileKeys[t]:r.loadingSourceTiles--,a===i.default.ERROR?r.errorTileKeys[t]=!0:n.removeEventListener(o.default.CHANGE,e),0===r.loadingSourceTiles&&r.setState((0,h.isEmpty)(r.errorTileKeys)?i.default.LOADED:i.default.ERROR)}};n.addEventListener(o.default.CHANGE,e),r.loadingSourceTiles++}l===i.default.IDLE&&(n.extent=d.getTileCoordExtent(a),n.projection=t,n.resolution=d.getResolution(a[0]),n.load())}),r.loadingSourceTiles||r.setState(r.sourceTiles.some(e=>e.getState()===i.default.ERROR)?i.default.ERROR:i.default.LOADED)}return r.sourceTiles}removeSourceTiles(e){let t=e.getKey(),r=e.sourceTiles;for(let e=0,i=r.length;e<i;++e){let i=r[e].getTileUrl();if(!this.tileKeysBySourceTileUrl_[i])return;let a=this.tileKeysBySourceTileUrl_[i].indexOf(t);-1!==a&&(this.tileKeysBySourceTileUrl_[i].splice(a,1),0===this.tileKeysBySourceTileUrl_[i].length&&(delete this.tileKeysBySourceTileUrl_[i],delete this.sourceTiles_[i]))}}getTile(e,t,r,s,n){let o=[e,t,r],u=this.getTileCoordForTileUrlFunction(o,n),h=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(n);if(u&&h){let t=c.getTileCoordExtent(u);(0,l.buffer)(t,-c.getResolution(e),t),(0,l.intersects)(h,t)||(u=null)}let d=!0;if(null!==u){let t=this.tileGrid,r=c.getResolution(e),i=t.getZForResolution(r,1),a=c.getTileCoordExtent(u);(0,l.buffer)(a,-r,a),t.forEachTileCoord(a,i,e=>{d=d&&!this.tileUrlFunction(e,s,n)})}let p=new a.default(o,d?i.default.EMPTY:i.default.IDLE,u,this.getSourceTiles.bind(this,s,n),this.removeSourceTiles.bind(this));return p.key=this.getKey(),p}getTileGridForProjection(e){let t=e.getCode(),r=this.tileGrids_[t];if(!r){let e=this.tileGrid,i=e.getResolutions().slice(),a=i.map(function(t,r){return e.getOrigin(r)}),s=i.map(function(t,r){return e.getTileSize(r)}),n=p.DEFAULT_MAX_ZOOM+1;for(let e=i.length;e<n;++e)i.push(i[e-1]/2),a.push(a[e-1]),s.push(s[e-1]);r=new d.default({extent:e.getExtent(),origins:a,resolutions:i,tileSizes:s}),this.tileGrids_[t]=r}return r}getTilePixelRatio(e){return e}getTilePixelSize(e,t,r){let i=this.getTileGridForProjection(r),a=(0,c.toSize)(i.getTileSize(e),this.tmpSize);return[Math.round(a[0]*t),Math.round(a[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}}var y=g;function v(e,t){e.setLoader(function(r,i,a){(0,u.loadFeaturesXhr)(t,e.getFormat(),r,i,a,e.onLoad.bind(e),e.onError.bind(e))})}}),n("25aE7",function(e,r){t(e.exports,"default",()=>u);var i=s("hMeZw"),a=s("cgxQK"),n=s("lVQul");let o=[];class l extends i.default{constructor(e,t,r,i,a){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.removeSourceTiles_=a,this.wrappedTileCoord=r}getContext(){return this.context_||(this.context_=(0,a.createCanvasContext2D)(1,1,o)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){let t=(0,n.getUid)(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&((0,a.releaseCanvas)(this.context_),o.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}var u=l}),n("QOQqa",function(e,r){t(e.exports,"hillshade",()=>i);function i(e,t){let r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S;let w=e[0],E=w.width,A=w.height,T=w.data,C=new Uint8ClampedArray(T.length),P=2*t.resolution,R=E-1,I=A-1,L=[0,0,0,0],O=2*Math.PI,M=Math.PI/2,k=Math.PI*t.sunEl/180,N=Math.PI*t.sunAz/180,D=Math.cos(k),F=Math.sin(k),G=t.highlightColor,z=t.shadowColor,q=t.accentColor,j=t.encoding;function B(e,t="mapbox"){return"mapbox"===t?(65536*e[0]+256*e[1]+e[2])*.1-1e4:"terrarium"===t?256*e[0]+e[1]+e[2]/256-32768:void 0}for(i=0;i<=I;++i)for(r=0,n=0===i?0:i-1,o=i===I?I:i+1;r<=R;++r)a=0===r?0:r-1,s=r===R?R:r+1,l=(i*E+a)*4,L[0]=T[l],L[1]=T[l+1],L[2]=T[l+2],L[3]=T[l+3],u=t.vert*B(L,j),l=(i*E+s)*4,L[0]=T[l],L[1]=T[l+1],L[2]=T[l+2],L[3]=T[l+3],h=(t.vert*B(L,j)-u)/P,l=(n*E+r)*4,L[0]=T[l],L[1]=T[l+1],L[2]=T[l+2],L[3]=T[l+3],u=t.vert*B(L,j),l=(o*E+r)*4,L[0]=T[l],L[1]=T[l+1],L[2]=T[l+2],L[3]=T[l+3],p=(p=Math.atan2(c=(t.vert*B(L,j)-u)/P,-h))<0?M-p:p>M?O-p+M:M-p,S=F*Math.cos(d=Math.atan(Math.sqrt(h*h+c*c)))+D*Math.sin(d)*Math.cos(N-p),f=Math.cos(d),m=255*S,_=Math.min(Math.max(2*t.sunEl,0),1),x=1.875-1.75*t.opacity,b=.5!==t.opacity?(Math.pow(x,d)-1)/(Math.pow(x,M)-1)*M:d,y={r:(1-f)*q.r*_*255,g:(1-f)*q.g*_*255,b:(1-f)*q.b*_*255,a:(1-f)*q.a*_*255},g=Math.abs(((p+N)/Math.PI+.5)%2-1),v={r:(G.r*(1-g)+z.r*g)*m,g:(G.g*(1-g)+z.g*g)*m,b:(G.b*(1-g)+z.b*g)*m,a:(G.a*(1-g)+z.a*g)*m},C[l=(i*E+r)*4]=y.r*(1-g)+v.r,C[l+1]=y.g*(1-g)+v.g,C[l+2]=y.b*(1-g)+v.b,C[l+3]=T[l+3]*t.opacity*_*Math.sin(b);return new ImageData(C,E,A)}}),n("70cY1",function(e,t){s("iTTi2"),s("cw4dl"),s("9MiJs"),s("gNqjI"),s("5Nyxy"),s("4QRwa")}),n("fkmMz",function(e,r){t(e.exports,"default",()=>n);var i=s("fnScq"),a=class extends i.default{constructor(e){e=e||{},super(),this._auth=e.auth,this.set("dataType",e.dataType||"JSON")}static get(e){var t=new a(e);e.success&&t.on("success",function(t){e.success(t.response,t)}),e.error&&t.on("error",function(t){e.error(t)}),t.send(e.url,e.data,e.options)}static getCORS(e,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.send(),r.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&t(r.getResponseHeader("Access-Control-Allow-Origin"))}}send(e,t,r){var i=this,a=!1!==(r=r||{}).encode;a&&(e=encodeURI(e));var s="";for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(s+=(s?"&":"?")+n+"="+(a?encodeURIComponent(t[n]):t[n]));this._request&&!1!==r.abort&&this._request.abort();var o=this._request=new XMLHttpRequest;o.open("GET",e+s,!0),r.timeout&&(o.timeout=r.timeout),this._auth&&o.setRequestHeader("Authorization","Basic "+this._auth),this.dispatchEvent({type:"loadstart"}),o.onload=function(){if(i._request=null,i.dispatchEvent({type:"loadend"}),this.status>=200&&this.status<400){var e;try{e="JSON"===i.get("dataType")?JSON.parse(this.response):this.response}catch(e){i.dispatchEvent({type:"error",status:0,statusText:"parsererror",error:e,options:r,jqXHR:this});return}i.dispatchEvent({type:"success",response:e,status:this.status,statusText:this.statusText,options:r,jqXHR:this})}else i.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:r,jqXHR:this})},o.ontimeout=function(){i._request=null,i.dispatchEvent({type:"loadend"}),i.dispatchEvent({type:"error",status:this.status,statusText:"Timeout",options:r,jqXHR:this})},o.onerror=function(){i._request=null,i.dispatchEvent({type:"loadend"}),i.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:r,jqXHR:this})},o.send()}},n=a}),n("6cpWg",function(e,r){t(e.exports,"default",()=>a);var i=s("4DafG"),a=class extends i.default{constructor(e){e=e||{};var t=document.createElement("DIV");if(t.classList.add("ol-unselectable","ol-control","ol-bar"),e.className){var r=e.className.split(" ").filter(function(e){return e.length>0});t.classList.add.apply(t.classList,r)}if(e.group&&t.classList.add("ol-group"),super({element:t,target:e.target}),this.set("toggleOne",e.toggleOne),this.set("autoDeactivate",e.autoDeactivate),this.controls_=[],e.controls instanceof Array)for(var i=0;i<e.controls.length;i++)this.addControl(e.controls[i])}setVisible(e){e?this.element.style.display="":this.element.style.display="none"}getVisible(){return"none"!=this.element.style.display}setMap(e){super.setMap(e);for(var t=0;t<this.controls_.length;t++)this.controls_[t].setMap(e)}getControls(){return this.controls_}setPosition(e){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right"),e=e.split("-");for(var t=0;t<e.length;t++)switch(e[t]){case"top":case"left":case"bottom":case"right":this.element.classList.add("ol-"+e[t])}}addControl(e){this.controls_.push(e),e.setTarget(this.element),this.getMap()&&this.getMap().addControl(e),e._activateBar&&e.un("change:active",e._activateBar),e._activateBar=(function(t){this.onActivateControl_(t,e)}).bind(this),e.on("change:active",e._activateBar),e.getActive&&this.onActivateControl_({target:e,active:e.getActive()},e)}removeControl(e){let t=this.controls_.indexOf(e);t>-1&&(this.controls_.splice(t,1),this.getMap()&&this.getMap().removeControl(e),e._activateBar&&e.un("change:active",e._activateBar),delete e._activateBar)}deactivateControls(e){for(var t=0;t<this.controls_.length;t++)this.controls_[t]!==e&&this.controls_[t].setActive&&this.controls_[t].setActive(!1)}getActiveControls(){for(var e,t=[],r=0;e=this.controls_[r];r++)e.getActive&&e.getActive()&&t.push(e);return t}setActive(e){if(!e&&this.get("autoDeactivate")&&this.deactivateControls(),e)for(var t,r=this.getControls(),i=0;t=r[i];i++)t.get("autoActivate")&&t.setActive(!0)}onActivateControl_(e,t){if(this.get("toggleOne")){if(e.active){var r;for(r=0;r<this.controls_.length&&this.controls_[r]!==t;r++);if(r==this.controls_.length)return;this.deactivateControls(this.controls_[r])}else if(!this.getActiveControls().length){for(var i,a=0;i=this.controls_[a];a++)if(i.get("autoActivate")){i.setActive(!0);break}}}e.type?this.dispatchEvent({type:"control:active",control:t,active:e.active}):this.dispatchEvent({type:"control:add",control:t,active:e.active})}getControlsByName(e){return this.getControls().filter(function(t){return t.get("name")===e})}}}),n("93mJv",function(e,r){t(e.exports,"default",()=>h);var i=s("ejLRd"),a=s("ao9pQ"),n=s("l9IGS"),o=s("lqNjm"),l=s("6sFdl"),u=s("iQyfo"),h=class extends a.default{constructor(e){super(e=e||{}),this.element.classList.add("ol-canvas-control"),this.setCanvas(!!e.canvas),e||(e={}),e.style||(e.style=new n.default),this.setStyle(e.style)}setCanvas(e){if(this.isCanvas_=e,e&&this.setCollapsed(!1),this.element.style.visibility=e?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch(e){}}setStyle(e){var t=e.getText();this.font_=t?t.getFont():"10px sans-serif";var r=t?t.getStroke():null,i=t?t.getFill():null;this.fontStrokeStyle_=r?(0,o.asString)(r.getColor()):"#fff",this.fontFillStyle_=i?(0,o.asString)(i.getColor()):"#000",this.fontStrokeWidth_=r?r.getWidth():3,this.getMap()&&this.getMap().render()}setMap(e){(0,l.default).prototype.getCanvas.call(this,e);var t=this.getMap();if(this._listener&&(0,i.unByKey)(this._listener),this._listener=null,super.setMap(e),t)try{t.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this.drawAttribution_.bind(this))),this.setCanvas(this.isCanvas_)}drawAttribution_(e){if(this.isCanvas_){var t,r=this.getContext(e);if(r){var i="";Array.prototype.slice.call(this.element.querySelectorAll("li")).filter(function(e){return"none"!==e.style.display}).map(function(e){i+=(i?" - ":"")+e.textContent});var a=e.frameState.pixelRatio;r.save(),r.scale(a,a);var s=this.element.getBoundingClientRect(),n=this.getMap().getViewport().getBoundingClientRect(),o=this.getMap().getSize()[0]/n.width;r.translate((s.left-n.left)*o,(s.top-n.top)*o);var l=this.element.clientHeight,h=this.element.clientWidth,c=(0,u.default).getStyle(this.element,"textAlign")||"center";switch(c){case"left":t=0;break;case"right":t=h;break;default:t=h/2}r.beginPath(),r.strokeStyle=this.fontStrokeStyle_,r.fillStyle=this.fontFillStyle_,r.lineWidth=this.fontStrokeWidth_,r.textAlign=c,r.textBaseline="middle",r.font=this.font_,r.lineJoin="round",r.strokeText(i,t,l/2),r.fillText(i,t,l/2),r.closePath(),r.restore()}}}getContext(e){return(0,l.default).prototype.getContext.call(this,e)}}}),n("6sFdl",function(e,r){t(e.exports,"default",()=>c);var i=s("4DafG"),a=s("ejLRd"),n=s("l9IGS"),o=s("2zf1Y"),l=s("d5AAH"),u=s("kuKBR"),h=s("9EqYA"),c=class extends i.default{constructor(e){super(e=e||{}),this.setStyle(e.style)}setMap(e){this.getCanvas(e);var t=this.getMap();if(this._listener&&((0,a.unByKey)(this._listener),this._listener=null),super.setMap(e),t)try{t.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this._draw.bind(this)))}getCanvas(e){return(0,h.default)(e)}getContext(e){var t=e.context;if(!t&&this.getMap()){var r=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0];t=r?r.getContext("2d"):null}return t}setStyle(e){this._style=e||new n.default({})}getStyle(){return this._style}getStroke(){return this._style.getStroke()||this._style.setStroke(new l.default({color:"#000",width:1.25})),this._style.getStroke()}getFill(){return this._style.getFill()||this._style.setFill(new o.default({color:"#fff"})),this._style.getFill()}getTextStroke(){var e=this._style.getText();return e||(e=new u.default({})),e.getStroke()||e.setStroke(new l.default({color:"#fff",width:3})),e.getStroke()}getTextFill(){var e=this._style.getText();return e||(e=new u.default({})),e.getFill()||e.setFill(new o.default({color:"#fff"})),e.getFill()}getTextFont(){var e=this._style.getText();return e||(e=new u.default({})),e.getFont()||e.setFont("12px sans-serif"),e.getFont()}_draw(){console.warn("[CanvasBase] draw function not implemented.")}}}),n("9EqYA",function(e,r){t(e.exports,"default",()=>i);var i=function(e){if(!e)return null;var t=e.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return t||(e.getViewport().querySelector(".ol-layers")?((t=document.createElement("canvas")).className="ol-fixedoverlay",e.getViewport().querySelector(".ol-layers").after(t),e.on("precompose",function(r){t.width=e.getSize()[0]*r.frameState.pixelRatio,t.height=e.getSize()[1]*r.frameState.pixelRatio})):t=e.getViewport().querySelector("canvas")),t}}),n("945U7",function(e,r){t(e.exports,"default",()=>h);var i=s("ejLRd"),a=s("19kfR"),n=s("l9IGS"),o=s("lqNjm"),l=s("6sFdl"),u=s("iQyfo"),h=class extends a.default{constructor(e){super(e),this.element.classList.add("ol-canvas-control"),this.scaleHeight_=6,e||(e={}),e.style||(e.style=new n.default),this.setStyle(e.style)}setMap(e){(0,l.default).prototype.getCanvas.call(this,e);var t=this.getMap();if(this._listener&&(0,i.unByKey)(this._listener),this._listener=null,super.setMap(e),t)try{t.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this.drawScale_.bind(this))),this.element.style.visibility="hidden",this.olscale=this.element.querySelector(".ol-scale-line-inner")}setStyle(e){var t=e.getStroke();this.strokeStyle_=t?(0,o.asString)(t.getColor()):"#000",this.strokeWidth_=t?t.getWidth():2;var r=e.getFill();this.fillStyle_=r?(0,o.asString)(r.getColor()):"#fff";var i=e.getText();this.font_=i?i.getFont():"10px Arial",t=i?i.getStroke():null,r=i?i.getFill():null,this.fontStrokeStyle_=t?(0,o.asString)(t.getColor()):this.fillStyle_,this.fontStrokeWidth_=t?t.getWidth():3,this.fontFillStyle_=r?(0,o.asString)(r.getColor()):this.strokeStyle_,this.getMap()&&this.getMap().render()}drawScale_(e){if("hidden"===this.element.style.visibility&&"none"!==(0,u.default).getStyle(this.element,"display")){var t=this.getContext(e);if(t){var r=parseInt(this.olscale.style.width);if(r){var i=this.olscale.textContent,a={left:this.element.offsetLeft,top:this.element.offsetTop},s=e.frameState.pixelRatio;t.save(),t.scale(s,s),a.top+=this.element.clientHeight-this.scaleHeight_,t.beginPath(),t.strokeStyle=this.fontStrokeStyle_,t.fillStyle=this.fontFillStyle_,t.lineWidth=this.fontStrokeWidth_,t.textAlign="center",t.textBaseline="bottom",t.font=this.font_,t.lineJoin="round",t.strokeText(i,a.left+r/2,a.top),t.fillText(i,a.left+r/2,a.top),t.closePath(),a.top+=2,t.lineWidth=this.strokeWidth_,t.strokeStyle=this.strokeStyle_;for(var n=4,o=parseInt(i);o%10==0;)o/=10;o%5==0&&(n=5);for(var l=0;l<n;l++)t.beginPath(),t.fillStyle=l%2?this.fillStyle_:this.strokeStyle_,t.rect(a.left+l*r/n,a.top,r/n,this.scaleHeight_),t.stroke(),t.fill(),t.closePath();t.restore()}}}}getContext(e){return(0,l.default).prototype.getContext.call(this,e)}}}),n("19kfR",function(e,r){t(e.exports,"default",()=>c);var i=s("erROg"),a=s("gzr8q"),n=s("4DafG");let o="units",l=[1,2,5],u=25.4/.28;class h extends n.default{constructor(e){e=e||{};let t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;let r=void 0!==e.className?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+i.CLASS_UNSELECTABLE,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==e.minWidth?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(o,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(o)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(o,e)}setDpi(e){this.dpi_=e}updateElement_(){let e,t,r,i,s;let n=this.viewState_;if(!n){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let o=n.center,h=n.projection,c=this.getUnits(),d=(0,a.getPointResolution)(h,n.resolution,o,"degrees"==c?"degrees":"m"),p=this.minWidth_*(this.dpi_||u)/u,f=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||u)/u:void 0,m=p*d,g="";if("degrees"==c){let e=a.METERS_PER_UNIT.degrees;(m*=e)<e/60?(g="″",d*=3600):m<e?(g="′",d*=60):g="°"}else if("imperial"==c)m<.9144?(g="in",d/=.0254):m<1609.344?(g="ft",d/=.3048):(g="mi",d/=1609.344);else if("nautical"==c)d/=1852,g="NM";else if("metric"==c)m<1e-6?(g="nm",d*=1e9):m<.001?(g="μm",d*=1e6):m<1?(g="mm",d*=1e3):m<1e3?g="m":(g="km",d/=1e3);else if("us"==c)m<.9144?(g="in",d*=39.37):m<1609.344?(g="ft",d/=.30480061):(g="mi",d/=1609.3472);else throw Error("Invalid units");let y=3*Math.floor(Math.log(p*d)/Math.log(10)),v=0;for(;;){let a=Math.pow(10,r=Math.floor(y/3));if(isNaN(t=Math.round((e=l[(y%3+3)%3]*a)/d))){this.element.style.display="none",this.renderedVisible_=!1;return}if(void 0!==f&&t>=f){e=v,t=i,r=s;break}if(t>=p)break;v=e,i=t,s=r,++y}let _=this.scaleBar_?this.createScaleBar(t,e,g):e.toFixed(r<0?-r:0)+" "+g;this.renderedHTML_!=_&&(this.innerElement_.innerHTML=_,this.renderedHTML_=_),this.renderedWidth_!=t&&(this.innerElement_.style.width=t+"px",this.renderedWidth_=t),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){let i=this.getScaleForResolution(),a=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),s=this.scaleBarSteps_,n=e/s,o=[this.createMarker("absolute")];for(let i=0;i<s;++i){let a=i%2==0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";o.push(`<div><div class="ol-scale-singlebar ${a}" style="width: ${n}px;"></div>`+this.createMarker("relative")+(i%2==0||2===s?this.createStepText(i,e,!1,t,r):"")+"</div>")}return o.push(this.createStepText(s,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+a+"</div>":"")+o.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${"absolute"===e?3:-10}px;"></div>`}createStepText(e,t,r,i,a){let s=0===e?0:Math.round(i/this.scaleBarSteps_*e*100)/100,n=0===e?-3:-(t/this.scaleBarSteps_*1),o=0===e?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${n}px;text-align: ${0===e?"left":"center"};min-width: ${o}px;left: ${r?t+"px":"unset"};">`+s+(0===e?"":" "+a)+"</div>"}getScaleForResolution(){return 1e3/25.4*(0,a.getPointResolution)(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m")*(this.dpi_||u)}render(e){let t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}var c=h}),n("oelnd",function(e,r){t(e.exports,"default",()=>o);var i=s("gzr8q"),a=s("lMlc8"),n=s("fSP3G"),o=class extends n.default{constructor(e){(e=e||{}).className=e.className||"IGNF",e.typing=e.typing||500,1==e.version?(e.url="https://wxs.ign.fr/"+(e.apiKey||"essentiels")+"/ols/apis/completion",e.copy='<a href="https://www.geoportail.gouv.fr/" target="new">&copy; IGN-Géoportail</a>'):2==e.version?(e.url="https://wxs.ign.fr/"+(e.apiKey||"essentiels")+"/geoportail/geocodage/rest/0.1/completion",e.copy='<a href="https://www.geoportail.gouv.fr/" target="new">&copy; IGN-Géoportail</a>'):(e.url="https://data.geopf.fr/geocodage/completion",e.copy='<a href="https://geoservices.ign.fr/" target="new">&copy; IGN-Géoplateforme</a>'),super(e),this.set("position",e.position),this.set("useExtent",e.useExtent),this.set("bbox",e.bbox),this.set("type",e.type||"StreetAddress,PositionOfInterest"),this.set("terr",e.terr),this.set("timeout",e.timeout||2e3)}reverseGeocode(e,t){var r=(0,i.transform)(e,this.getMap().getView().getProjection(),"EPSG:4326");this._handleSelect({x:r[0],y:r[1],fulltext:r[0].toFixed(6)+","+r[1].toFixed(6)},!0,t);var a="Commune"===this.get("type")?"PositionOfInterest":this.get("type")||"StreetAddress";/,/.test(a)&&(a="StreetAddress");var s=this.get("url").replace("ols/apis/completion","geoportail/ols").replace("completion","reverse");if(/ols/.test(s)){var n='<?xml version="1.0" encoding="UTF-8"?><XLS xmlns:xls="http://www.opengis.net/xls" xmlns:gml="http://www.opengis.net/gml" xmlns="http://www.opengis.net/xls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.2" xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"> <Request requestID="1" version="1.2" methodName="ReverseGeocodeRequest" maximumResponses="1" >  <ReverseGeocodeRequest>   <ReverseGeocodePreference>'+a+"</ReverseGeocodePreference>   <Position>    <gml:Point><gml:pos>"+r[1]+" "+r[0]+"</gml:pos></gml:Point>   </Position>  </ReverseGeocodeRequest> </Request></XLS>";this.ajax(s,{xls:n},(function(e){var i={};if(e){var a=(e=e.replace(/\n|\r/g,"")).replace(/.*<gml:pos>(.*)<\/gml:pos>.*/,"$1").split(" ");if(Number(a[1])||Number(a[0])){if(i.x=r[0],i.y=r[1],i.city=e.replace(/.*<Place type="Municipality">([^<]*)<\/Place>.*/,"$1"),i.insee=e.replace(/.*<Place type="INSEE">([^<]*)<\/Place>.*/,"$1"),i.zipcode=e.replace(/.*<PostalCode>([^<]*)<\/PostalCode>.*/,"$1"),/<Street>/.test(e)){i.kind="",i.country="StreetAddress",i.street=e.replace(/.*<Street>([^<]*)<\/Street>.*/,"$1");var s=e.replace(/.*<Building number="([^"]*).*/,"$1");i.fulltext=s+" "+i.street+", "+i.zipcode+" "+i.city}else i.kind=e.replace(/.*<Place type="Nature">([^<]*)<\/Place>.*/,"$1"),i.country="PositionOfInterest",i.street="",i.fulltext=i.zipcode+" "+i.city}else i={x:r[0],y:r[1],fulltext:r[0].toFixed(6)+","+r[1].toFixed(6)}}else i={x:r[0],y:r[1],fulltext:r[0].toFixed(6)+","+r[1].toFixed(6)};"function"==typeof t?t.call(this,[i]):(this.getHistory().shift(),this._handleSelect(i,!0,t))}).bind(this),{timeout:this.get("timeout"),dataType:"XML"})}else this.ajax(s+"?lon="+r[0]+"&lat="+r[1],{},(function(e){var i;try{(i=(e=JSON.parse(e).features[0]).properties).x=e.geometry.coordinates[0],i.y=e.geometry.coordinates[1],i.click=r,i.name?i.fulltext=i.name+", "+i.postcode+" "+i.city:i.fulltext=i.postcode+" "+i.city}catch(e){i={x:r[0],y:r[1],lonlat:r,fulltext:r[0].toFixed(6)+","+r[1].toFixed(6)}}"function"==typeof t?t.call(this,[i]):(this.getHistory().shift(),this._handleSelect(i,!0,t))}).bind(this),{timeout:this.get("timeout"),dataType:"XML"})}getTitle(e){return e.fulltext}requestData(e){var t={text:e,type:"Commune"===this.get("type")?"PositionOfInterest":this.get("type")||"StreetAddress,PositionOfInterest",terr:this.get("terr")||void 0,maximumResponses:this.get("maxItems")};if("Commune"===this.get("type")&&(t.poiType="commune"),this.get("position")){var r=this.getMap().getView().getCenter();t.lonlat=(0,i.transform)(r,this.getMap().getView().getProjection(),"EPSG:4326").join(",")}if(this.get("bbox"))t.bbox=(0,i.transformExtent)(this.get("bbox"),this.getMap().getView().getProjection(),"EPSG:4326").join(",");else if(this.get("useExtent")){var a=this.getMap().getView().calculateExtent();t.bbox=(0,i.transformExtent)(a,this.getMap().getView().getProjection(),"EPSG:4326").join(",")}return t}handleResponse(e){return e.results}select(e,t,r,s){if(e.x||e.y){var n=[Number(e.x),Number(e.y)];try{n=(0,i.transform)(n,"EPSG:4326",this.getMap().getView().getProjection())}catch(e){}"Commune"===this.get("type")?this.searchCommune(e,(function(){(0,a.default).prototype.select.call(this,e,t,n,s)}).bind(this)):super.select(e,t,n,s)}else this.searchCommune(e)}searchCommune(e,t){var r=this.get("url").replace("ols/apis/completion","geoportail/ols").replace("completion","reverse");if(/ols/.test(r)){var i='<?xml version="1.0" encoding="UTF-8"?><XLS xmlns:xls="http://www.opengis.net/xls" xmlns:gml="http://www.opengis.net/gml" xmlns="http://www.opengis.net/xls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.2" xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"><RequestHeader/><Request requestID="1" version="1.2" methodName="LocationUtilityService"><GeocodeRequest returnFreeForm="false"><Address countryCode="PositionOfInterest"><freeFormAddress>'+e.zipcode+" "+e.city+"+</freeFormAddress></Address></GeocodeRequest></Request></XLS>";this.ajax(this.get("url").replace("ols/apis/completion","geoportail/ols"),{xls:i},(function(r){if(r){var i=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("GeocodedAddress")[0],a=i.getElementsByTagName("gml:Point")[0].textContent.trim().split(" ");e.x=Number(a[1]),e.y=Number(a[0]);for(var s=i.getElementsByTagName("Place"),n=0;n<s.length;n++)switch(s[n].attributes.type.value){case"Nature":e.kind=s[n].textContent;break;case"INSEE":e.insee=s[n].textContent}(e.x||e.y)&&(t?t.call(this,[e]):this._handleSelect(e))}}).bind(this),{dataType:"XML"})}else this.ajax(r+"?lon="+e.x+"&lat="+e.y+"&index=parcel&limit=1",{},(function(r){try{var i=JSON.parse(r).features[0];e.insee=i.properties.departmentcode+i.properties.municipalitycode,e.districtcode=i.properties.districtcode,t?t.call(this,[e]):this._handleSelect(e)}catch(e){}}).bind(this),{timeout:this.get("timeout"),dataType:"XML"})}}}),n("lMlc8",function(e,r){t(e.exports,"default",()=>l);var i=s("4DafG"),a=s("ejLRd"),n=s("iQyfo"),o=class extends i.default{constructor(e){var t=((e=e||{}).className||"")+" ol-search"+(e.target?"":" ol-unselectable ol-control"),r=(0,n.default).create("DIV",{className:t});super({element:r,target:e.target});var i=this;if(void 0==e.typing&&(e.typing=300),this._classname=e.className||"search",!1!==e.collapsed&&r.classList.add("ol-collapsed"),e.target||(this.button=document.createElement("BUTTON"),this.button.setAttribute("type","button"),this.button.setAttribute("title",e.title||e.label||"Search"),this.button.addEventListener("click",function(){if(r.classList.toggle("ol-collapsed"),!r.classList.contains("ol-collapsed")){r.querySelector("input.search").focus();for(var e=r.querySelectorAll("li"),t=0;t<e.length;t++)e[t].classList.remove("select");l.value||i.drawList_()}}),r.appendChild(this.button)),e.inputLabel){var a=document.createElement("LABEL");a.innerText=e.inputLabel,r.appendChild(a)}var s,o="",l=this._input=document.createElement("INPUT");l.setAttribute("type","search"),l.setAttribute("class","search"),l.setAttribute("autocomplete","off"),l.setAttribute("placeholder",e.placeholder||"Search..."),l.addEventListener("change",function(e){i.dispatchEvent({type:"change:input",input:e,value:l.value})});var u=function(t){var a=r.querySelector("ul.autocomplete li.select"),n=l.value;if("ArrowDown"==t.key||"ArrowUp"==t.key||"Down"==t.key||"Up"==t.key){if(a){var u=/Down/.test(t.key)?a.nextElementSibling:a.previousElementSibling;u&&!u.classList.contains("copy")&&(a.classList.remove("select"),u.classList.add("select"),l.value=u.innerText)}else(a=r.querySelector("ul.autocomplete li")).classList.add("select"),l.value=a.innerText}else if("input"==t.type)n||setTimeout(function(){i.drawList_()},200),a&&(l.value=n="",a.classList.remove("select"));else if(a&&("search"===t.type||"Enter"===t.key))r.classList.contains("ol-control")&&l.blur(),a.classList.remove("select"),o=n,i._handleSelect(i._list[a.getAttribute("data-search")]);else if("search"===t.type||"Enter"===t.key||o!=n&&e.typing>=0){if(o=n){s&&clearTimeout(s);var h=i.get("minLength");s=setTimeout(function(){if(o.length>=h){var e=i.autocomplete(o,function(e){i.drawList_(e)});e&&i.drawList_(e)}else i.drawList_()},e.typing)}else i.drawList_()}else(a=r.querySelector("ul.autocomplete li"))&&a.classList.remove("select")};if(l.addEventListener("keyup",u),l.addEventListener("search",u),l.addEventListener("cut",u),l.addEventListener("paste",u),l.addEventListener("input",u),e.noCollapse||(l.addEventListener("blur",(function(){setTimeout((function(){l!==document.activeElement&&(r.classList.add("ol-collapsed"),this.set("reverse",!1),r.classList.remove("ol-revers"))}).bind(this),200)}).bind(this)),l.addEventListener("focus",(function(){this.get("reverse")||(r.classList.remove("ol-collapsed"),r.classList.remove("ol-revers"))}).bind(this)),l.addEventListener("keydown",(function(){this.set("reverse",!1),r.classList.remove("ol-collapsed"),r.classList.remove("ol-revers")}).bind(this))),r.appendChild(l),e.reverse){var h=(0,n.default).create("BUTTON",{type:"button",class:"ol-revers",title:e.reverseTitle||"click on the map",on:{focus:(function(){this.get("reverse")?this.set("reverse",!1):(this.set("reverse",!this.get("reverse")),l.focus(),r.classList.add("ol-revers"))}).bind(this)}});r.appendChild(h)}var c=document.createElement("UL");c.classList.add("autocomplete"),r.appendChild(c),"function"==typeof e.getTitle&&(this.getTitle=e.getTitle),"function"==typeof e.autocomplete&&(this.autocomplete=e.autocomplete),this.set("copy",e.copy),this.set("minLength",e.minLength||1),this.set("maxItems",e.maxItems||10),this.set("maxHistory",e.maxHistory||e.maxItems||10),e.onselect&&this.on("select",e.onselect),e.centerOnSelect&&this.on("select",(function(e){var t=this.getMap();t&&t.getView().setCenter(e.coordinate)}).bind(this)),e.zoomOnSelect&&this.on("select",(function(t){var r=this.getMap();r&&(r.getView().setCenter(t.coordinate),r.getView().getZoom()<e.zoomOnSelect&&r.getView().setZoom(e.zoomOnSelect))}).bind(this)),this.restoreHistory(),this.drawList_()}setMap(e){this._listener&&(0,a.unByKey)(this._listener),this._listener=null,super.setMap(e),e&&(this._listener=e.on("click",this._handleClick.bind(this)))}collapse(e){!1===e?this.element.classList.remove("ol-collapsed"):this.element.classList.add("ol-collapsed")}getInputField(){return this._input}getTitle(e){return e.name||"No title"}_getTitleTxt(e){return(0,n.default).create("DIV",{html:this.getTitle(e)}).innerText}search(){var e=this.element.querySelector("input.search");this._triggerCustomEvent("search",e)}_handleClick(e){this.get("reverse")&&(document.activeElement.blur(),this.reverseGeocode(e.coordinate))}reverseGeocode(){}_triggerCustomEvent(e,t){(0,n.default).dispatchEvent(e,t)}setInput(e,t){var r=this.element.querySelector("input.search");r.value=e,t&&this._triggerCustomEvent("keyup",r)}select(e,t,r,i){var a={type:"select",search:e,reverse:!!t,coordinate:r};if(i)for(var s in i)a[s]=i[s];this.dispatchEvent(a)}_handleSelect(e,t,r){if(e){var i,a=this.get("history");try{var s=JSON.stringify(e);for(i=a.length-1;i>=0;i--)a[i]&&JSON.stringify(a[i])!==s||a.splice(i,1)}catch(t){for(i=a.length-1;i>=0;i--)a[i]===e&&a.splice(i,1)}a.unshift(e);for(var n=Math.max(0,this.get("maxHistory")||10)||0;a.length>n;)a.pop();this.saveHistory(),this.select(e,t,null,r),t&&(this.setInput(this._getTitleTxt(e)),this.drawList_(),setTimeout((function(){this.collapse(!1)}).bind(this),300))}}saveHistory(){try{this.get("maxHistory")>=0?localStorage["ol@search-"+this._classname]=JSON.stringify(this.get("history")):localStorage.removeItem("ol@search-"+this._classname)}catch(e){console.warn("Failed to access localStorage...")}}restoreHistory(){if(this._history[this._classname])this.set("history",this._history[this._classname]);else try{this._history[this._classname]=JSON.parse(localStorage["ol@search-"+this._classname]),this.set("history",this._history[this._classname])}catch(e){this.set("history",[])}}clearHistory(){this.set("history",[]),this.saveHistory(),this.drawList_()}getHistory(){return this.get("history")}autocomplete(e,t){return t([]),!1}drawList_(e){var t=this,r=this.element.querySelector("ul.autocomplete");if(r.innerHTML="",this._list=[],e)r.setAttribute("class","autocomplete");else{if(this.element.querySelector("input.search").value)return;e=this.get("history"),r.setAttribute("class","autocomplete history")}for(var i,a=Math.min(t.get("maxItems"),e.length),s=0;s<a;s++)if(e[s]&&(!s||!t.equalFeatures(e[s],e[s-1]))){(i=document.createElement("LI")).setAttribute("data-search",this._list.length),this._list.push(e[s]),i.addEventListener("click",function(e){t._handleSelect(t._list[e.currentTarget.getAttribute("data-search")])});var n=t.getTitle(e[s]);n instanceof Element?i.appendChild(n):i.innerHTML=n,r.appendChild(i)}a&&this.get("copy")&&((i=document.createElement("LI")).classList.add("copy"),i.innerHTML=this.get("copy"),r.appendChild(i))}equalFeatures(){return!1}};o.prototype._history={};var l=o}),n("fSP3G",function(e,r){t(e.exports,"default",()=>n);var i=s("lMlc8"),a=s("fkmMz"),n=class extends i.default{constructor(e){(e=e||{}).className=e.className||"JSON",delete e.autocomplete,e.minLength=e.minLength||3,e.typing=e.typing||800,super(e);var t=e.url||"";if("https:"===window.location.protocol){var r=document.createElement("a");r.href=t,r.protocol=window.location.protocol,t=r.href}this.set("url",t),this._ajax=new a.default({dataType:"JSON",auth:e.authentication}),this._ajax.on("success",(function(e){e.status>=200&&e.status<400?"function"==typeof this._callback&&this._callback(e.response):("function"==typeof this._callback&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments))}).bind(this)),this._ajax.on("error",(function(){"function"==typeof this._callback&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments)}).bind(this)),this._ajax.on("loadstart",(function(){this.element.classList.add("searching")}).bind(this)),this._ajax.on("loadend",(function(){this.element.classList.remove("searching")}).bind(this)),"function"==typeof e.handleResponse&&(this.handleResponse=e.handleResponse)}ajax(e,t,r,i){i=i||{},this._callback=r,this._ajax.set("dataType",i.dataType||"JSON"),this._ajax.send(e,t,i)}autocomplete(e,t){var r=this.requestData(e),i=encodeURI(this.get("url"));this.ajax(i,r,function(e){"function"==typeof t&&t(this.handleResponse(e))})}requestData(e){return{q:e}}handleResponse(e){return e}}}),n("jEzQ5",function(e,r){t(e.exports,"default",()=>u);var i=s("ejLRd"),a=s("4DafG"),n=s("gzr8q"),o=s("iQyfo"),l=s("4TTbe"),u=class extends a.default{constructor(e){var t=e||{},r=document.createElement("div");super({element:r,target:t.target});var i=this,a=document.createElement("button");if((0,o.default).create("I",{parent:a}),this.replaceState_=!1!==t.urlReplace,this.fixed_=t.fixed||6,this.hash_=t.anchor?"#":"?",this._localStorage=t.localStorage,!this._localStorage)try{localStorage.removeItem("ol@permalink")}catch(e){console.warn("Failed to access localStorage...")}function s(){"function"==typeof t.onclick?t.onclick(i.getLink()):i.setUrlReplace(!i.replaceState_)}a.addEventListener("click",s,!1),a.addEventListener("touchstart",s,!1),r.className=(t.className||"ol-permalink")+" ol-unselectable ol-control",r.appendChild(a),(t.hidden||!1===t.visible)&&(0,o.default).hide(r),this.set("geohash",t.geohash),this.set("initial",!1),this.on("change",this.viewChange_.bind(this)),this.search_={};var n={},u=document.location.hash||document.location.search||"";if(this.replaceState_&&!u&&this._localStorage)try{u=localStorage["ol@permalink"]}catch(e){console.warn("Failed to access localStorage...")}if(u){u=u.replace(/(^#|^\?)/,"").split("&");for(var h=0;h<u.length;h++){var c=u[h].split("=");switch(c[0]){case"lon":case"lat":case"z":case"r":n[c[0]]=c[1];break;case"gh":{let e=c[1].split("-"),t=(0,l.toLonLat)(e[0]);n.lon=t[0],n.lat=t[1],n.z=e[1];break}case"l":break;default:this.search_[c[0]]=c[1]}}}n.hasOwnProperty("lon")&&this.set("initial",n),this.set("refreshDelay",t.refreshDelay||500),this.replaceState_&&this.setPosition()}getInitialPosition(){return this.get("initial")}setMap(e){this._listener&&((0,i.unByKey)(this._listener.change),(0,i.unByKey)(this._listener.moveend)),this._listener=null,super.setMap.call(this,e),e&&(this._listener={change:e.getLayerGroup().on("change",this.layerChange_.bind(this)),moveend:e.on("moveend",this.viewChange_.bind(this))},this.setPosition())}getLayerByLink(e,t){!t&&this.getMap()&&(t=this.getMap().getLayers().getArray());for(var r=0;r<t.length;r++){if(t[r].get("permalink")==e)return t[r];if(t[r].getLayers){var i=this.getLayerByLink(e,t[r].getLayers().getArray());if(i)return i}}return!1}setGeohash(e){this.set("geohash",e),this.setUrlParam()}setPosition(e){var t=this.getMap();if(t){var r=this.replaceState_||e?document.location.hash||document.location.search:"";if(!r&&this._localStorage)try{r=localStorage["ol@permalink"]}catch(e){console.warn("Failed to access localStorage...")}if(r){var i,a,s={};for(i=0,r=r.replace(/(^#|^\?)/,"").split("&");i<r.length;i++)s[(a=r[i].split("="))[0]]=a[1];if(s.gh){var o=s.gh.split("-"),u=(0,l.toLonLat)(o[0]);s.lon=u[0],s.lat=u[1],s.z=o[1]}var h=(0,n.transform)([Number(s.lon),Number(s.lat)],"EPSG:4326",t.getView().getProjection());if(h[0]&&h[1]&&t.getView().setCenter(h),s.z&&t.getView().setZoom(Number(s.z)),s.r&&t.getView().setRotation(Number(s.r)),s.l){(function e(r){r||(r=t.getLayers().getArray());for(var i=0;i<r.length;i++)r[i].get("permalink")&&r[i].setVisible(!1),r[i].getLayers&&e(r[i].getLayers().getArray())})();var c=s.l.split("|");for(i=0;i<c.length;i++){a=c[i].split(":");var d=this.getLayerByLink(a[0]),p=Number(a[1]);d&&(d.setOpacity(p),d.setVisible(!0))}}}}}getUrlParams(){return this.search_}setUrlParam(e,t){e&&(void 0===t||""===t?delete this.search_[encodeURIComponent(e)]:this.search_[encodeURIComponent(e)]=encodeURIComponent(t)),this.viewChange_()}getUrlParam(e){return decodeURIComponent(this.search_[encodeURIComponent(e)]||"")}hasUrlParam(e){return this.search_.hasOwnProperty(encodeURIComponent(e))}getLink(e){var t=this.getMap(),r=(0,n.transform)(t.getView().getCenter(),t.getView().getProjection(),"EPSG:4326"),i=Math.round(10*t.getView().getZoom())/10,a=t.getView().getRotation(),s=this.layerStr_,o=(a?"&r="+Math.round(1e4*a)/1e4:"")+(s?"&l="+s:"");if(o=this.get("geohash")?"gh="+(0,l.fromLonLat)(r,8)+"-"+i+o:"lon="+r[0].toFixed(this.fixed_)+"&lat="+r[1].toFixed(this.fixed_)+"&z="+i+o,"position"===e)return o;for(var u in this.search_)o+="&"+u+(void 0!==this.search_[u]?"="+this.search_[u]:"");return e?o:document.location.protocol+"//"+document.location.host+document.location.pathname+this.hash_+o}getUrlReplace(){return this.replaceState_}setUrlReplace(e){try{if(this.replaceState_=e,e)this.replaceUrl_(this.getLink(),!0);else{var t="";for(var r in this.search_)t+=(""==t?"?":"&")+r+(void 0!==this.search_[r]?"="+this.search_[r]:"");this.replaceUrl_(document.location.origin+document.location.pathname+t,!0)}}catch(e){}}replaceUrl_(e,t){clearTimeout(this.refreshTout_),t?window.history.replaceState(null,null,e):this.refreshTout_=setTimeout(function(){window.history.replaceState(null,null,e)},this.get("refreshDelay"))}viewChange_(){try{this.replaceState_&&this.replaceUrl_(this.getLink())}catch(e){}if(this._localStorage)try{localStorage["ol@permalink"]=this.getLink(this._localStorage)}catch(e){console.warn("Failed to access localStorage...")}}layerChange_(){this._tout&&(clearTimeout(this._tout),this._tout=null),this._tout=setTimeout((function(){this._tout=null;var e="";(function t(r){for(var i=0;i<r.length;i++)r[i].getVisible()&&r[i].get("permalink")&&(e&&(e+="|"),e+=r[i].get("permalink")+":"+r[i].get("opacity")),r[i].getLayers&&t(r[i].getLayers().getArray())})(this.getMap().getLayers().getArray()),this.layerStr_=e,this.viewChange_()}).bind(this),200)}}}),n("4TTbe",function(e,r){t(e.exports,"fromLonLat",()=>a),t(e.exports,"toLonLat",()=>s);var i={base32:"0123456789bcdefghjkmnpqrstuvwxyz"},a=function(e,t){var r=e[0],n=e[1];if(!t){for(var o=1;o<=12;o++){var l=a([r,n],o),u=s(l);if(u.lat==n&&u.lon==r)return l}t=12}(t<1||t>12)&&(t=12);for(var h=0,c=0,d=!0,p="",f=-90,m=90,g=-180,y=180;p.length<t;){if(d){var v=(g+y)/2;r>=v?(h=2*h+1,g=v):(h*=2,y=v)}else{var _=(f+m)/2;n>=_?(h=2*h+1,f=_):(h*=2,m=_)}d=!d,5==++c&&(p+=i.base32.charAt(h),c=0,h=0)}return p},s=function(e){var t=n(e),r=t[1],i=t[0],a=t[3],s=t[2],o=(r+a)/2,l=(i+s)/2;return o=o.toFixed(Math.floor(2-Math.log(a-r)/Math.LN10)),[Number(l=l.toFixed(Math.floor(2-Math.log(s-i)/Math.LN10))),Number(o)]},n=function(e){if(!e)return!1;e=e.toLowerCase();for(var t=!0,r=-90,a=90,s=-180,n=180,o=0;o<e.length;o++){var l=e.charAt(o),u=i.base32.indexOf(l);if(-1==u)return!1;for(var h=4;h>=0;h--){var c=u>>h&1;if(t){var d=(s+n)/2;1==c?s=d:n=d}else{var p=(r+a)/2;1==c?r=p:a=p}t=!t}}return[s,r,n,a]}}),n("3cHIk",function(e,r){t(e.exports,"default",()=>m);var i=s("ejLRd"),a=s("4DafG"),n=s("d5AAH"),o=s("iQyfo"),l=s("6od7S"),u=s("rnKfx"),h=s("hQ5BY"),c=s("e9bRc"),d=s("bbejh"),p=s("6RZDJ"),f=class extends a.default{constructor(e){e=e||{};var t,r,a,s,f=(0,o.default).create("DIV",{className:(e.className||"ol-print")+" ol-unselectable ol-control"});super({element:f}),this._lang=e.lang||"en",e.target||(0,o.default).create("BUTTON",{type:"button",title:e.title||"Print",click:(function(){this.print()}).bind(this),parent:f}),e.openWindow&&this.on("print",function(e){e.canvas&&window.open().document.write('<img src="'+e.canvas.toDataURL()+'"/>')}),e.target=(0,o.default).create("DIV");var m=this._printCtrl=new h.default(e);m.on(["print","error","printing"],(function(e){this._printing(e)}).bind(this)),this._compass=new p.default({src:e.northImage||"compact",visible:!1,className:"olext-print-compass",style:new n.default({color:"#333",width:0})});var g=this._printDialog=new l.default({target:e.targetDialog||document.body,closeBox:!0,className:"ol-ext-print-dialog"}),y=g.getContentElement();this._input={};var v=(0,o.default).create("DIV",{className:"ol-print-param",parent:y});this._pages=[(0,o.default).create("DIV",{className:"ol-page"})];var _=(0,o.default).create("DIV",{className:"ol-map",parent:this._pages[0]});(0,o.default).create("DIV",{html:this._pages[0],className:"ol-print-map",parent:y}),(0,o.default).create("H2",{html:this.i18n("title"),parent:v});var x=(0,o.default).create("UL",{parent:v}),b=(0,o.default).create("LI",{className:"ol-orientation",parent:x});this._input.orientation={list:b};var S=(0,o.default).create("LABEL",{className:"portrait",parent:b});this._input.orientation.portrait=(0,o.default).create("INPUT",{type:"radio",name:"ol-print-orientation",value:"portrait",checked:!0,on:{change:(function(e){this.setOrientation(e.target.value)}).bind(this)},parent:S}),(0,o.default).create("SPAN",{html:this.i18n("portrait"),parent:S}),S=(0,o.default).create("LABEL",{className:"landscape",parent:b}),this._input.orientation.landscape=(0,o.default).create("INPUT",{type:"radio",name:"ol-print-orientation",value:"landscape",on:{change:(function(e){this.setOrientation(e.target.value)}).bind(this)},parent:S}),(0,o.default).create("SPAN",{html:this.i18n("landscape"),parent:S}),b=(0,o.default).create("LI",{html:(0,o.default).create("LABEL",{html:this.i18n("size")}),className:"ol-size",parent:x});var w=this._input.size=(0,o.default).create("SELECT",{on:{change:(function(){this.setSize(w.value||a)}).bind(this)},parent:b});for(t in this.paperSize)(0,o.default).create("OPTION",{html:t+(this.paperSize[t]?" - "+this.paperSize[t][0]+"x"+this.paperSize[t][1]+" mm":this.i18n("custom")),value:t,parent:w});b=(0,o.default).create("LI",{html:(0,o.default).create("LABEL",{html:this.i18n("margin")}),className:"ol-margin",parent:x});var E=this._input.margin=(0,o.default).create("SELECT",{on:{change:(function(){this.setMargin(E.value)}).bind(this)},parent:b});for(t in this.marginSize)(0,o.default).create("OPTION",{html:this.i18n(t)+" - "+this.marginSize[t]+" mm",value:this.marginSize[t],parent:E});b=(0,o.default).create("LI",{html:(0,o.default).create("LABEL",{html:this.i18n("scale")}),className:"ol-scale",parent:x});var A=this._input.scale=(0,o.default).create("SELECT",{on:{change:(function(){this.setScale(parseInt(A.value))}).bind(this)},parent:b});Object.keys(this.scales).forEach((function(e){(0,o.default).create("OPTION",{html:this.scales[e],value:e,parent:A})}).bind(this)),b=(0,o.default).create("LI",{className:"ol-legend",parent:x});var T=(0,o.default).createSwitch({html:this.i18n("legend"),checked:!1,on:{change:(function(){N.legend.control.setCanvas(T.checked)}).bind(this)},parent:b});b=(0,o.default).create("LI",{className:"ol-print-north",parent:x});var C=this._input.north=(0,o.default).createSwitch({html:this.i18n("north"),checked:"checked",on:{change:(function(){C.checked?this._compass.element.classList.add("ol-print-compass"):this._compass.element.classList.remove("ol-print-compass"),this.getMap().render()}).bind(this)},parent:b});b=(0,o.default).create("LI",{className:"ol-print-title",parent:x});var P=(0,o.default).createSwitch({html:this.i18n("mapTitle"),checked:!1,on:{change:(function(e){N.title.control.setVisible(e.target.checked)}).bind(this)},parent:b}),R=(0,o.default).create("INPUT",{type:"text",placeholder:this.i18n("mapTitle"),on:{keydown:function(e){13===e.keyCode&&e.preventDefault()},keyup:function(){N.title.control.setTitle(R.value)},change:(function(){N.title.control.setTitle(R.value)}).bind(this)},parent:b}),I=(0,o.default).create("DIV",{className:"ol-user-param",parent:v});b=(0,o.default).create("LI",{className:"ol-saveas",parent:x}),(0,o.default).create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:b});var L=(0,o.default).create("SELECT",{on:{change:(function(){var e=L.value;if(L.value="",!(this.formats[e].clipboard&&this._copyMap(e))){var t="string"==typeof this.getSize()?this.getSize():null,r=Object.assign({format:t,size:t?this.paperSize[t]:null,orient:this.getOrientation(),margin:this.getMargin()},this.formats[e]);m.print(r)}}).bind(this)},parent:b});(0,o.default).create("OPTION",{html:this.i18n("saveas"),style:{display:"none"},value:"",parent:L}),this.formats.forEach((function(t,r){if(t.pdf){if(!1===e.pdf)return}else if(t.clipboard){if(!1===e.copy)return}else if(!1===e.save)return;(0,o.default).create("OPTION",{html:this.i18n(t.title),value:r,parent:L})}).bind(this)),1===L.querySelectorAll("option").length&&(L.style.display="none"),b=(0,o.default).create("LI",{className:"ol-savelegend",parent:x});var O=(0,o.default).create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:b}),M=(0,o.default).create("SELECT",{on:{change:(function(){var e,t=N.legend.control.getLegend().getCanvas(),r=document.createElement("CANVAS");r.width=t.width,r.height=t.height;var i=r.getContext("2d");if(i.fillStyle="#fff",i.fillRect(0,0,r.width,r.height),i.drawImage(t,0,0),this.formats[M.value].clipboard)r.toBlob(function(e){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},e.type,{value:e,enumerable:!0}))]),O.classList.add("visible"),setTimeout(function(){O.classList.remove("visible")},1e3)}catch(e){}},"image/png");else try{e=r.toDataURL(this.formats[M.value].imageType,this.formats[M.value].quality);var a="string"==typeof this.getSize()?this.getSize():"A4",s=r.width/96*25.4,n=r.height/96*25.4,o=this.paperSize[a];"landscape"===this.getOrientation()&&(o=[o[1],o[0]]);var l=[(o[0]-s)/2,(o[1]-n)/2];this.dispatchEvent({type:"print",print:{legend:!0,format:a,orientation:this.getOrientation(),unit:"mm",size:this.paperSize[a],position:l,imageWidth:s,imageHeight:n},image:e,imageType:this.formats[M.value].imageType,pdf:this.formats[M.value].pdf,quality:this.formats[M.value].quality,canvas:r})}catch(e){}M.value=""}).bind(this)},parent:b});(0,o.default).create("OPTION",{html:this.i18n("saveLegend"),style:{display:"none"},value:"",parent:M}),this.formats.forEach((function(e,t){(0,o.default).create("OPTION",{html:this.i18n(e.title),value:t,parent:M})}).bind(this));var k=(0,o.default).create("DIV",{className:"ol-ext-buttons",parent:v});(0,o.default).create("BUTTON",{html:this.i18n("printBt"),type:"submit",click:function(e){e.preventDefault(),window.print()},parent:k}),(0,o.default).create("BUTTON",{html:this.i18n("cancel"),type:"button",click:function(){g.hide()},parent:k}),(0,o.default).create("DIV",{html:this.i18n("errorMsg"),className:"ol-error",parent:v});var N={};g.on("show",(function(){this.dispatchEvent({type:"show",userElement:I,dialog:this._printDialog,page:this.getPage()});var e=this.getMap();e&&(document.body.classList.add("ol-print-document"),r=e.getTargetElement(),a=e.getSize(),"string"==typeof this.getSize()?this.setSize(this.getSize()):this.setSize(a),e.setTarget(_),s&&(0,i.unByKey)(s),s=e.on("moveend",(function(){this.setScale((0,d.getMapScale)(e))}).bind(this)),this.setScale((0,d.getMapScale)(e)),N={},this.getMap().getControls().forEach((function(e){e instanceof u.default&&(N.legend={control:e}),e instanceof c.default&&(N.title={control:e}),e instanceof p.default&&(N.compass?e.element.classList.remove("ol-print-compass"):(this._input.north.checked?e.element.classList.add("ol-print-compass"):e.element.classList.remove("ol-print-compass"),this._compass=e,N.compass={control:e}))}).bind(this)),N.title?(P.checked=N.title.isVisible=N.title.control.getVisible(),R.value=N.title.control.getTitle(),P.parentNode.parentNode.classList.remove("hidden")):P.parentNode.parentNode.classList.add("hidden"),N.legend?(N.legend.ison=N.legend.control.onCanvas(),N.legend.collapsed=N.legend.control.isCollapsed(),N.legend.control.collapse(!1),M.parentNode.classList.remove("hidden"),T.parentNode.parentNode.classList.remove("hidden"),T.checked=!N.legend.collapsed,N.legend.control.setCanvas(!N.legend.collapsed)):(M.parentNode.classList.add("hidden"),T.parentNode.parentNode.classList.add("hidden")))}).bind(this)),g.on("hide",(function(){document.body.classList.remove("ol-print-document"),r&&(this.getMap().setTarget(r),r=null,s&&(0,i.unByKey)(s),N.title&&N.title.control.setVisible(N.title.isVisible),N.legend&&(N.legend.control.setCanvas(N.legend.ison),N.legend.control.collapse(N.legend.collapsed)),this.dispatchEvent({type:"hide"}))}).bind(this)),window.addEventListener("resize",(function(){this.setSize()}).bind(this)),e.saveAs&&this.on("print",function(t){t.pdf||t.canvas.toBlob(function(r){var i=(t.print.legend?"legend.":"map.")+t.imageType.replace("image/","");e.saveAs(r,i)},t.imageType,t.quality)}),e.jsPDF&&this.on("print",function(t){if(t.pdf){var r=new e.jsPDF({orientation:t.print.orientation,unit:t.print.unit,format:t.print.size});r.addImage(t.image,"JPEG",t.print.position[0],t.print.position[0],t.print.imageWidth,t.print.imageHeight),r.save(t.print.legend?"legend.pdf":"map.pdf")}})}static addLang(e,t){f.prototype._labels[e]=t}isOpen(){return this._printDialog.isOpen()}i18n(e){var t=this._labels.en[e]||e;return this._labels[this._lang]&&this._labels[this._lang][e]&&(t=this._labels[this._lang][e]),t}getOrientation(){return this._orientation||"portrait"}setOrientation(e){this._orientation="landscape"===e?"landscape":"portrait",this._printDialog.element.dataset.orientation=this._orientation,this._input.orientation[this._orientation].checked=!0,this.setSize()}getMargin(){return this._margin||0}setMargin(e){this._margin=e,this._input.margin.value=e,this.setSize()}getSize(){return this._size}setSize(e){if(this._printDialog.getContentElement().dataset.status="",e?this._size=e:e=this._size,e){if("string"==typeof e){for(var t in this.paperSize)t&&RegExp(t,"i").test(e)&&(e=t);this.paperSize[e]||(e=this._size="A4"),this._input.size.value=e,e=[Math.trunc(96*this.paperSize[e][0]/25.4),Math.trunc(96*this.paperSize[e][1]/25.4)],"landscape"===this.getOrientation()&&(e=[e[1],e[0]]),this.getPage().classList.remove("margin")}else this._input.size.value="",this.getPage().classList.add("margin");var r=this.getPage(),i=r.parentNode.getBoundingClientRect(),a=Math.min((i.width-40)/e[0],(i.height-40)/e[1],1);r.style.width=e[0]+"px",r.style.height=e[1]+"px",r.style["-webkit-transform"]=r.style.transform="translate(-50%,-50%) scale("+a+")";var s=Math.round(5/a);r.style["-webkit-box-shadow"]=r.style["box-shadow"]=s+"px "+s+"px "+s+"px rgba(0,0,0,.6)",r.style.padding=96*this.getMargin()/25.4+"px",this.getMap()&&this.getMap().updateSize(),this.dispatchEvent({type:"dialog:refresh"})}}_printing(e){this._printDialog.getContentElement().dataset.status=e.type,e.clipboard||this.dispatchEvent(e)}_copyMap(e){var t=this._printDialog.element.querySelector(".ol-clipboard-copy");return this._printCtrl.copyMap(this.formats[e],function(e){e&&(t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},1e3))}),!0}getContentElement(){return this._printDialog.getContentElement()}getUserElement(){return this._printDialog.getContentElement().querySelector(".ol-user-param")}getPage(){return this._pages[0]}setMap(e){this.getMap()&&(this.getMap().removeControl(this._compass),this.getMap().removeControl(this._printCtrl),this.getMap().removeControl(this._printDialog)),super.setMap(e),this.getMap()&&(this.getMap().addControl(this._compass),this.getMap().addControl(this._printCtrl),this.getMap().addControl(this._printDialog))}setScale(e){(0,d.setMapScale)(this.getMap(),e),this._input.scale.value=" "+100*Math.round(e/100)}getScale(){return(0,d.getMapScale)(this.getMap())}print(e){(e=e||{}).size&&this.setSize(e.size),e.scale&&this.setScale(e.scale),e.orientation&&this.setOrientation(e.orientation),e.margin&&this.setMargin(e.margin),this._printDialog.show()}getPrintControl(){return this._printCtrl}};f.prototype._labels={en:{title:"Print",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",size:"Page size",custom:"screen size",margin:"Margin",scale:"Scale",legend:"Legend",north:"North arrow",mapTitle:"Map title",saveas:"Save as...",saveLegend:"Save legend...",copied:"✔ Copied to clipboard",errorMsg:"Can't save map canvas...",printBt:"Print...",clipboardFormat:"copy to clipboard...",jpegFormat:"save as jpeg",pngFormat:"save as png",pdfFormat:"save as pdf",none:"none",small:"small",large:"large",cancel:"cancel"},fr:{title:"Imprimer",orientation:"Orientation",portrait:"Portrait",landscape:"Paysage",size:"Taille du papier",custom:"taille écran",margin:"Marges",scale:"Echelle",legend:"Légende",north:"Flèche du nord",mapTitle:"Titre de la carte",saveas:"Enregistrer sous...",saveLegend:"Enregistrer la légende...",copied:"✔ Carte copiée",errorMsg:"Impossible d'enregistrer la carte",printBt:"Imprimer",clipboardFormat:"copier dans le presse-papier...",jpegFormat:"enregistrer un jpeg",pngFormat:"enregistrer un png",pdfFormat:"enregistrer un pdf",none:"aucune",small:"petites",large:"larges",cancel:"annuler"},de:{title:"Drucken",orientation:"Ausrichtung",portrait:"Hochformat",landscape:"Querformat",size:"Papierformat",custom:"Bildschirmgröße",margin:"Rand",scale:"Maßstab",legend:"Legende",north:"Nordpfeil",mapTitle:"Kartentitel",saveas:"Speichern als...",saveLegend:"Legende speichern...",copied:"✔ In die Zwischenablage kopiert",errorMsg:"Kann Karte nicht speichern...",printBt:"Drucken...",clipboardFormat:"in die Zwischenablage kopieren...",jpegFormat:"speichern als jpeg",pngFormat:"speichern als png",pdfFormat:"speichern als pdf",none:"kein",small:"klein",large:"groß",cancel:"abbrechen"},zh:{title:"打印",orientation:"方向",portrait:"纵向",landscape:"横向",size:"页面大小",custom:"屏幕大小",margin:"外边距",scale:"尺度",legend:"图例",north:"指北针",mapTitle:"地图名字",saveas:"保存为...",saveLegend:"保存图例为...",copied:"✔ 已复制到剪贴板",errorMsg:"无法保存地图...",printBt:"打印...",cancel:"取消"},it:{title:"Stampa",orientation:"Orientamento",portrait:"Verticale",landscape:"Orizzontale",size:"Formato pagina",custom:"Dimensione schermo",margin:"Margini",scale:"Scala",legend:"Legenda",north:"Freccia nord",mapTitle:"Titolo della mappa",saveas:"Salva con nome...",saveLegend:"Salva legenda...",copied:"✔ Copiato negli appunti",errorMsg:"Impossibile salvare la mappa",printBt:"Stampa",clipboardFormat:"Copia negli appunti...",jpegFormat:"salva come jpeg",pngFormat:"salva come png",pdfFormat:"salva come pdf",none:"nessuno",small:"piccolo",large:"grande",cancel:"annulla"}},f.prototype.paperSize={"":null,A0:[841,1189],A1:[594,841],A2:[420,594],A3:[297,420],A4:[210,297],"US Letter":[215.9,279.4],A5:[148,210],B4:[257,364],B5:[182,257]},f.prototype.marginSize={none:0,small:5,large:10},f.prototype.formats=[{title:"clipboardFormat",imageType:"image/png",clipboard:!0},{title:"jpegFormat",imageType:"image/jpeg",quality:.8},{title:"pngFormat",imageType:"image/png",quality:.8},{title:"pdfFormat",imageType:"image/jpeg",pdf:!0}],f.prototype.scales={" 5000":"1/5.000"," 10000":"1/10.000"," 25000":"1/25.000"," 50000":"1/50.000"," 100000":"1/100.000"," 250000":"1/250.000"," 1000000":"1/1.000.000"};var m=f}),n("rnKfx",function(e,r){t(e.exports,"default",()=>n);var i=s("lqNjm"),a=s("6sFdl");s("3HxCM");var n=class extends a.default{constructor(e){e=e||{};var t=document.createElement("div");if(super({element:t,target:e.target}),e.target)t.className=e.className||"ol-legend";else{t.className=(e.className||"ol-legend")+" ol-unselectable ol-control"+(!1===e.collapsible?" ol-uncollapsible":" ol-collapsed");var r=document.createElement("button");r.setAttribute("type","button"),r.addEventListener("click",(function(){this.toggle()}).bind(this)),t.appendChild(r),(r=document.createElement("button")).setAttribute("type","button"),r.className="ol-closebox",r.addEventListener("click",(function(){this.toggle()}).bind(this)),t.appendChild(r)}this._legend=e.legend,this._legend.getCanvas().className="ol-legendImg",t.appendChild(this._legend.getCanvas()),t.appendChild(this._legend.getListElement()),!1!==e.collapsible&&!1===e.collapsed&&this.show(),this._legend.on("select",(function(e){this.dispatchEvent(e)}).bind(this)),this._legend.on("refresh",(function(){if(this._onCanvas&&this.getMap())try{this.getMap().renderSync()}catch(e){}}).bind(this)),this._legend.on("items",(function(t){t.nb?(this.element.classList.remove("ol-empty"),this.element.title=e.title||"legend"):(this.element.classList.add("ol-empty"),this.element.title=e.emptyTitle||"no legend"),this.dispatchEvent(t)}).bind(this))}getLegend(){return this._legend}setCanvas(e){if(this._onCanvas=e,this.element.style.visibility=e?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch(e){}}onCanvas(){return!!this._onCanvas}_draw(e){if(this._onCanvas&&!this.element.classList.contains("ol-collapsed")){var t=this._legend.getCanvas(),r=this.getContext(e),a=r.canvas.height-t.height;r.save(),r.rect(0,a,t.width,t.height);var s="#fff";this._legend.getTextStyle().getBackgroundFill()&&(s=(0,i.asString)(this._legend.getTextStyle().getBackgroundFill().getColor())),r.fillStyle=r.strokeStyle=s,r.lineWidth=10,r.lineJoin="round",r.stroke(),r.clearRect(0,a,t.width,t.height),r.fill(),r.drawImage(t,0,a),r.restore()}}show(){if(this.element.classList.contains("ol-collapsed")&&(this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!1}),this.getMap()))try{this.getMap().renderSync()}catch(e){}}hide(){if(!this.element.classList.contains("ol-collapsed")&&(this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!0}),this.getMap()))try{this.getMap().renderSync()}catch(e){}}collapse(e){!1===e?this.show():this.hide()}isCollapsed(){return this.element.classList.contains("ol-collapsed")}toggle(){if(this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:this.element.classList.contains("ol-collapsed")}),this.getMap())try{this.getMap().renderSync()}catch(e){}}}}),n("hQ5BY",function(e,r){t(e.exports,"default",()=>n);var i=s("4DafG"),a=s("iQyfo"),n=class extends i.default{constructor(e){e=e||{};var t=(0,a.default).create("DIV",{className:e.className||"ol-print"});super({element:t,target:e.target}),e.target||(t.classList.add("ol-unselectable","ol-control"),(0,a.default).create("BUTTON",{type:"button",title:e.title||"Print",click:(function(){this.print()}).bind(this),parent:t})),this.set("immediate",e.immediate),this.set("imageType",e.imageType||"image/jpeg"),this.set("quality",e.quality||.8),this.set("orientation",e.orientation)}toClipboard(e,t){try{e.canvas.toBlob(function(e){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},e.type,{value:e,enumerable:!0}))]),"function"==typeof t&&t(!0)}catch(e){"function"==typeof t&&t(!1)}})}catch(e){"function"==typeof t&&t(!1)}}copyMap(e,t){this.once("print",(function(e){this.toClipboard(e,t)}).bind(this)),this.print(e)}_getCanvas(e,t,r){var i;if(e.context)r=e.context.canvas;else{if(r)i=r.getContext("2d");else{r=document.createElement("canvas");var s=this.getMap().getSize();r.width=s[0],r.height=s[1],i=r.getContext("2d"),/jp.*g$/.test(t)&&(i.fillStyle=this.get("bgColor")||"white",i.fillRect(0,0,r.width,r.height))}this.getMap().getViewport().querySelectorAll(".ol-layers canvas, canvas.ol-fixedoverlay").forEach((function(e){if(e.width&&(i.save(),"0"!==e.parentNode.style.opacity)){i.globalAlpha=parseFloat(e.parentNode.style.opacity)||1,i.globalCompositeOperation=(0,a.default).getStyle(e.parentNode,"mix-blend-mode"),i.filter=(0,a.default).getStyle(e.parentNode,"filter");var t=(0,a.default).getStyle(e,"transform")||(0,a.default).getStyle(e,"-webkit-transform");/^matrix/.test(t)?((t=t.replace(/^matrix\(|\)$/g,"").split(",")).forEach(function(e,r){t[r]=parseFloat(e)}),i.transform(t[0],t[1],t[2],t[3],t[4],t[5]),i.drawImage(e,0,0)):i.drawImage(e,0,0,(0,a.default).getStyle(e,"width"),(0,a.default).getStyle(e,"height")),i.restore()}}).bind(this))}return r}fastPrint(e,t){e=e||{},this._ol6?requestAnimationFrame((function(){t(this._getCanvas({},e.imageType,e.canvas))}).bind(this)):(this.getMap().once("postcompose",(function(r){r.context||(this._ol6=!0),t(this._getCanvas(r,e.imageType,e.canvas))}).bind(this)),this.getMap().render())}print(e){var t=(e=e||{}).imageType||this.get("imageType"),r=e.quality||this.get("quality");if(this.getMap()){if("silent"!==e.immediate&&this.dispatchEvent(Object.assign({type:"printing"},e)),!e.immediate){setTimeout((function(){(e=Object.assign({},e)).immediate="silent",this.print(e)}).bind(this),200);return}this.getMap().once(this.get("immediate")?"postcompose":"rendercomplete",(function(i){var a,s,n,o,l=this._getCanvas(i,t),u=e.size||[210,297],h=e.format||"a4",c=e.orient||this.get("orientation"),d="number"==typeof e.margin?e.margin:10;if(l){"landscape"!==c&&"portrait"!==c&&(c=l.width>l.height?"landscape":"portrait"),"landscape"===c&&(u=[u[1],u[0]]);var p=Math.min((u[0]-2*d)/l.width,(u[1]-2*d)/l.height);a=p*l.width,s=p*l.height,n=[(u[0]-a)/2,(u[1]-s)/2]}try{o=l?l.toDataURL(t,r):null}catch(e){this.dispatchEvent({type:"error",canvas:l});return}var f=Object.assign({type:"print",print:{format:h,orientation:c,unit:"mm",size:u,position:n,imageWidth:a,imageHeight:s},image:o,imageType:t,quality:r,canvas:l},e);this.dispatchEvent(f)}).bind(this)),this.getMap().render()}}}}),n("e9bRc",function(e,r){t(e.exports,"default",()=>o);var i=s("lqNjm"),a=s("6sFdl"),n=s("iQyfo"),o=class extends a.default{constructor(e){e=e||{},super({element:(0,n.default).create("DIV",{className:(e.className||"")+" ol-control-title ol-unselectable",style:{display:"block",visibility:"hidden"}}),style:e.style}),this.setTitle(e.title||""),this.setVisible(!1!==e.visible),this.element.style.font=this.getTextFont()}setStyle(e){super.setStyle(e),this.element&&(this.element.style.font=this.getTextFont()),this.getMap()&&this.getMap().render()}setTitle(e){if(this.element.textContent=e,this.set("title",e),this.getMap())try{this.getMap().renderSync()}catch(e){}}getTitle(){return this.get("title")}setVisible(e){if(this.element.style.display=e?"block":"none",this.getMap())try{this.getMap().renderSync()}catch(e){}}getVisible(){return"none"!==this.element.style.display}_draw(e){if(this.getVisible()){var t=this.getContext(e);if(t){var r=e.frameState.pixelRatio;t.save(),t.scale(r,r);var a=this.element.getBoundingClientRect(),s=this.getMap().getViewport().getBoundingClientRect(),n=this.getMap().getSize()[0]/s.width;t.translate(Math.round((a.left-s.left)*n),Math.round((a.top-s.top)*n));var o=this.element.clientHeight,l=this.element.clientWidth,u=l/2;t.beginPath(),t.fillStyle=(0,i.asString)(this.getFill().getColor()),t.rect(0,0,l,o),t.fill(),t.closePath(),t.beginPath(),t.fillStyle=(0,i.asString)(this.getTextFill().getColor()),t.strokeStyle=(0,i.asString)(this.getTextStroke().getColor()),t.lineWidth=this.getTextStroke().getWidth(),t.textAlign="center",t.textBaseline="middle",t.font=this.getTextFont(),t.lineJoin="round",t.lineWidth&&t.strokeText(this.getTitle(),u,o/2),t.fillText(this.getTitle(),u,o/2),t.closePath(),t.restore()}}}}}),n("bbejh",function(e,r){t(e.exports,"getMapScale",()=>n),t(e.exports,"setMapScale",()=>o);var i=s("7qu5m"),a=s("gzr8q"),n=function(e,t){var r=e.getView(),s=r.getProjection(),n=r.getCenter(),o=e.getPixelFromCoordinate(n);o[1]+=1;var l=e.getCoordinateFromPixel(o);return(t||96)/.0254*(0,i.getDistance)((0,a.transform)(n,s,"EPSG:4326"),(0,a.transform)(l,s,"EPSG:4326"))},o=function(e,t,r){if(e&&t){var s=t;if("string"==typeof t&&((s=(t=t.replace(":","/").split("/"))[1])||(s=t[0]||""),s=parseInt(s=s.replace(/[^\d]/g,"")),t[1])){var n=parseInt(t[0]);n&&(s/=n)}if(s){var o=e.getView(),l=o.getProjection(),u=o.getCenter(),h=e.getPixelFromCoordinate(u);h[1]+=1;var c=e.getCoordinateFromPixel(h),d=(0,i.getDistance)((0,a.transform)(u,l,"EPSG:4326"),(0,a.transform)(c,l,"EPSG:4326"));return d*=(r||96)/.0254,o.setResolution(o.getResolution()*s/d),s}}}}),n("6RZDJ",function(e,r){t(e.exports,"default",()=>l);var i=s("6sFdl"),a=s("l9IGS"),n=s("d5AAH"),o=s("iQyfo"),l=class extends i.default{constructor(e){e=e||{};var t=document.createElement("div");t.className="ol-control ol-compassctrl ol-unselectable ol-hidden"+(e.className?" "+e.className:""),t.style.position="absolute",t.style.visibility="hidden";var r=e.style instanceof n.default?new a.default({stroke:e.style}):e.style;e.style||(r=new a.default({stroke:new n.default({width:0})})),super({element:t,style:r}),this.set("rotateVithView",!1!==e.rotateWithView),this.setVisible(!1!==e.visible),this.setImage(e.image||e.src)}setImage(e){if(e instanceof Image)this.img_=e,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch(e){}}).bind(this);else if("string"==typeof e)switch(e){case"compact":this.img_=this.compactCompass_(this.element.clientWidth,this.getStroke().getColor());break;case"default":this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor());break;default:this.img_=new Image,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch(e){}}).bind(this),this.img_.src=e}else this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor())}compactCompass_(e,t){var r=document.createElement("canvas"),i=r.getContext("2d"),a=(e=r.width=r.height=e||150)/2;return i.translate(a,a),i.fillStyle=t||"#963",i.lineWidth=5,i.lineJoin=i.lineCap="round",i.font="bold "+.4*a+"px sans-serif",i.textBaseline="bottom",i.textAlign="center",i.strokeStyle="#fff",i.globalAlpha=.75,i.strokeText("N",0,-a/2),i.globalAlpha=1,i.fillText("N",0,-a/2),i.beginPath(),i.moveTo(0,a/4),i.lineTo(a/3,a/2),i.lineTo(0,-a/2),i.lineTo(-a/3,a/2),i.lineTo(0,a/4),i.lineWidth=12,i.fillStyle="#fff",i.globalAlpha=.75,i.fill(),i.stroke(),i.globalAlpha=1,i.fillStyle=i.strokeStyle=t||"#963",i.lineWidth=5,i.beginPath(),i.moveTo(0,a/4),i.lineTo(0,-a/2),i.lineTo(a/3,a/2),i.lineTo(0,a/4),i.fill(),i.stroke(),i.beginPath(),i.moveTo(0,a/4),i.lineTo(0,-a/2),i.lineTo(-a/3,a/2),i.lineTo(0,a/4),i.stroke(),r}defaultCompass_(e,t){var r=document.createElement("canvas"),i=r.getContext("2d"),a=(e=r.width=r.height=e||150)/2,s=.22*a;function n(e,r){i.fillStyle=t||"#963",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(r,r),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-r,-r),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(-r,r),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(r,-r),i.moveTo(0,0),i.fill(),i.stroke()}function o(e,t){i.globalCompositeOperation="destination-out",i.fillStyle="#fff",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(t,-t),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-t,t),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(t,t),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(-t,-t),i.moveTo(0,0),i.fill(),i.globalCompositeOperation="source-over",i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(t,-t),i.moveTo(0,0),i.lineTo(-e,0),i.lineTo(-t,t),i.moveTo(0,0),i.lineTo(0,e),i.lineTo(t,t),i.moveTo(0,0),i.lineTo(0,-e),i.lineTo(-t,-t),i.moveTo(0,0),i.stroke()}return i.translate(a,a),i.strokeStyle=t||"#963",i.lineWidth=1.5,i.beginPath(),i.arc(0,0,.41*e,0,2*Math.PI),i.arc(0,0,.44*e,0,2*Math.PI),i.stroke(),i.rotate(Math.PI/4),n(.9*a,.8*s),o(.9*a,.8*s),i.rotate(-Math.PI/4),n(a,s),o(a,s),r}getVisible(){return"block"===(0,o.default).getStyle(this.element,"display")}setVisible(e){e?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible"),this.getMap()&&this.getMap().render()}_draw(e){var t=this.getContext(e);if(t&&this.getVisible()){var r,i=t.canvas,a=[];for(r=0;r<8;r++)a[r]=[Math.cos(Math.PI*r/8),Math.sin(Math.PI*r/8)];var s=e.frameState.pixelRatio;t.save(),t.scale(s,s);var n=this.element.clientWidth,o=this.element.clientHeight,l={left:this.element.offsetLeft,top:this.element.offsetTop},u=this.img_,h=e.frameState.viewState.rotation;if(t.beginPath(),t.translate(l.left+n/2,l.top+o/2),this.get("rotateVithView")&&t.rotate(h),this.getStroke().getWidth()){t.beginPath(),t.strokeStyle=this.getStroke().getColor(),t.lineWidth=this.getStroke().getWidth();var c=Math.max(i.width,i.height);for(r=0;r<8;r++)t.moveTo(-a[r][0]*c,-a[r][1]*c),t.lineTo(a[r][0]*c,a[r][1]*c);t.stroke()}u.width&&t.drawImage(u,-n/2,-o/2,n,o),t.closePath(),t.restore()}}}}),n("loIjs",function(e,r){t(e.exports,"default",()=>d);var i=s("d1ltq"),a=s("bsgMw"),n=s("kShgF"),o=s("gzr8q"),l=s("4DafG");let u="projection",h="coordinateFormat";class c extends l.default{constructor(e){e=e||{};let t=document.createElement("div");t.className=void 0!==e.className?e.className:"ol-mouse-position",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un,this.addChangeListener(u,this.handleProjectionChanged_),e.coordinateFormat&&this.setCoordinateFormat(e.coordinateFormat),e.projection&&this.setProjection(e.projection),this.renderOnMouseOut_=void 0!==e.placeholder,this.placeholder_=this.renderOnMouseOut_?e.placeholder:"&#160;",this.renderedHTML_=t.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=!1!==e.wrapX}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(h)}getProjection(){return this.get(u)}handleMouseMove(e){let t=this.getMap();this.updateHTML_(t.getEventPixel(e))}handleMouseOut(e){this.updateHTML_(null)}setMap(e){if(super.setMap(e),e){let t=e.getViewport();this.listenerKeys.push((0,a.listen)(t,n.default.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,a.listen)(t,n.default.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(e){this.set(h,e)}setProjection(e){this.set(u,(0,o.get)(e))}updateHTML_(e){let t=this.placeholder_;if(e&&this.mapProjection_){if(!this.transform_){let e=this.getProjection();e?this.transform_=(0,o.getTransformFromProjections)(this.mapProjection_,e):this.transform_=o.identityTransform}let r=this.getMap().getCoordinateFromPixelInternal(e);if(r){let e=(0,o.getUserProjection)();if(e&&(this.transform_=(0,o.getTransformFromProjections)(this.mapProjection_,e)),this.transform_(r,r),this.wrapX_){let t=e||this.getProjection()||this.mapProjection_;(0,i.wrapX)(r,t)}let a=this.getCoordinateFormat();t=a?a(r):r.toString()}}this.renderedHTML_&&t===this.renderedHTML_||(this.element.innerHTML=t,this.renderedHTML_=t)}render(e){let t=e.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}}var d=c}),n("dbRSi",function(e,r){t(e.exports,"default",()=>n);var i=s("8rtB0"),a=s("gmF1Q"),n=class extends i.default{constructor(e){(e=e||{}).followTrack=e.followTrack||"auto",e.zoom=e.zoom||16;var t,r=new a.default(e);super({className:e.className=((e.className||"")+" ol-geobt").trim(),interaction:r,title:e.title||"Geolocation",onToggle:function(){r.pause(!0),r.setFollowTrack(e.followTrack||"auto")}}),this.setActive(!1),r.on("tracking",(function(e){this.dispatchEvent({type:"position",coordinate:e.geolocation.getPosition()})}).bind(this)),r.on("change:active",(function(){this.dispatchEvent({type:"position"}),t&&(clearTimeout(t),t=null),r.getActive()&&(t=setTimeout((function(){r.setActive(!1),t=null}).bind(this),e.delay||3e3))}).bind(this))}}}),n("8rtB0",function(e,r){t(e.exports,"default",()=>a);var i=s("QtBcx"),a=class extends i.default{constructor(e){(e=e||{}).toggleFn&&(e.onToggle=e.toggleFn),e.handleClick=function(){t.toggle(),e.onToggle&&e.onToggle.call(t,t.getActive())},e.className=(e.className||"")+" ol-toggle",super(e);var t=this;this.interaction_=e.interaction,this.interaction_&&(this.interaction_.setActive(e.active),this.interaction_.on("change:active",function(){t.setActive(t.interaction_.getActive())})),this.set("title",e.title),this.set("autoActivate",e.autoActivate),e.bar&&this.setSubBar(e.bar),this.setActive(e.active),this.setDisable(e.disable)}setMap(e){!e&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),super.setMap(e),e&&(this.interaction_&&e.addInteraction(this.interaction_),this.subbar_&&e.addControl(this.subbar_))}getSubBar(){return this.subbar_}setSubBar(e){var t=this.getMap();t&&this.subbar_&&t.removeControl(this.subbar_),this.subbar_=e,e&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),t&&t.addControl(this.subbar_))}getDisable(){var e=this.element.querySelector("button");return e&&e.disabled}setDisable(e){this.getDisable()!=e&&(this.element.querySelector("button").disabled=e,e&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!e,disable:e}))}getActive(){return this.element.classList.contains("ol-active")}toggle(){this.getActive()?this.setActive(!1):this.setActive(!0)}setActive(e){this.interaction_&&this.interaction_.setActive(e),this.subbar_&&this.subbar_.setActive(e),this.getActive()!==e&&(e?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!e,active:e}))}setInteraction(e){this.interaction_=e}getInteraction(){return this.interaction_}}}),n("QtBcx",function(e,r){t(e.exports,"default",()=>n);var i=s("4DafG"),a=s("iQyfo"),n=class extends i.default{constructor(e){e=e||{};var t=document.createElement("div");t.className=(e.className||"")+" ol-button ol-unselectable ol-control",super({element:t,target:e.target});var r=this,i=this.button_=document.createElement(/ol-text-button/.test(e.className)?"div":"button");i.type="button",e.title&&(i.title=e.title),e.name&&(i.name=e.name),e.html instanceof Element?i.appendChild(e.html):i.innerHTML=e.html||"",i.addEventListener("click",function(t){t&&t.preventDefault&&(t.preventDefault(),t.stopPropagation()),e.handleClick&&e.handleClick.call(r,t)}),t.appendChild(i),!e.title&&i.firstElementChild&&(i.title=i.firstElementChild.title),e.title&&this.set("title",e.title),e.title&&this.set("title",e.title),e.name&&this.set("name",e.name)}setVisible(e){e?(0,a.default).show(this.element):(0,a.default).hide(this.element)}getDisable(){var e=this.element.querySelector("button");return e&&e.disabled}setDisable(e){this.getDisable()!=e&&(this.element.querySelector("button").disabled=e)}setTitle(e){this.button_.setAttribute("title",e)}setHtml(e){(0,a.default).setHTML(this.button_,e)}getButtonElement(){return this.button_}}}),n("gmF1Q",function(e,r){t(e.exports,"default",()=>b);var i=s("7lBr2"),a=s("hQfiM"),n=s("4lFOe"),o=s("d5AAH"),l=s("j2K3b"),u=s("hvEnP"),h=s("cgPpQ"),c=s("iTxNH"),d=s("l9IGS"),p=s("h6Aha"),f=s("2zf1Y"),m=s("610XN"),g=s("20LS2"),y=s("iGyOD"),v=s("jZquI"),_=s("gzr8q"),x=s("7qu5m"),b=class extends i.default{constructor(e){e=e||{},super({handleEvent:function(){return!this.get("followTrack")||"auto"==this.get("followTrack")}}),this.geolocation=new a.default({projection:"EPSG:4326",trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),this.geolocation.on("change",this.draw_.bind(this)),this.path_=[],this.lastPosition_=!1;var t=[255,255,255,1],r=[0,153,255,1],i=new n.default({radius:6,fill:new f.default({color:r}),stroke:new o.default({color:t,width:1.5})}),s=[new d.default({stroke:new o.default({color:t,width:5})}),new d.default({stroke:new o.default({color:r,width:3}),fill:new f.default({color:[255,255,255,.5]})})],l=new p.default({radius:10.5,points:3,rotation:0,fill:new f.default({color:r}),stroke:new o.default({color:t,width:1.5})}),u=l.getImage(),h=u.getContext("2d"),c=document.createElement("canvas");c.width=c.height=u.width,c.getContext("2d").drawImage(u,0,0),h.clearRect(0,0,u.width,u.height),h.drawImage(c,0,0,u.width,u.height,3,0,u.width-6,u.height),this.locStyle={error:new d.default({fill:new f.default({color:[255,0,0,.2]})}),warn:new d.default({fill:new f.default({color:[255,192,0,.2]})}),ok:new d.default({fill:new f.default({color:[0,255,0,.2]})})},this.overlayLayer_=new m.default({source:new g.default,name:"GeolocationDraw overlay",style:e.style||function(e){return void 0===e.get("heading")?s[1].setImage(i):(s[1].setImage(l),l.setRotation(e.get("heading")||0)),s}}),this.sketch_=[new y.default,new y.default,new y.default],this.overlayLayer_.getSource().addFeatures(this.sketch_),this.features_=e.features,this.source_=e.source,this.condition_=e.condition||function(e){return e.getAccuracy()<this.get("minAccuracy")},this.set("type",e.type||"LineString"),this.set("attributes",e.attributes||{}),this.set("minAccuracy",e.minAccuracy||20),this.set("tolerance",e.tolerance||5),this.set("zoom",e.zoom),this.set("minZoom",e.minZoom),this.setFollowTrack(void 0===e.followTrack||e.followTrack),this.setActive(!1)}simplify3D(e,t){var r=e.getCoordinates(),i=this.getMap().getView().getProjection();"Polygon"===this.get("type")&&(r=r[0]);for(var a,s=[r[0]],n=(0,_.transform)(r[0],i,"EPSG:4326"),o=1;o<r.length;o++)a=(0,_.transform)(r[o],i,"EPSG:4326"),(0,x.getDistance)(n,a)>t&&(s.push(r[o]),n=a);return s[s.length-1]!==r[r.length-1]&&s.push(r[r.length-1]),e="Polygon"===this.get("type")?new h.default([s],"XYZM"):new u.default(s,"XYZM")}setMap(e){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),super.setMap(e),this.overlayLayer_.setMap(e),e&&this.geolocation.setProjection(e.getView().getProjection())}setActive(e){if(e!==this.getActive()){if(super.setActive(e),this.getMap()){this.geolocation.setTracking(e);try{this.getMap().renderSync()}catch(e){}}if(this.overlayLayer_){if(this.overlayLayer_.setVisible(e),this.pause(!e),e)this.reset(),this.dispatchEvent({type:"drawstart",feature:this.sketch_[1]});else{var t=this.sketch_[1].clone();t.getGeometry()&&(this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)),this.dispatchEvent({type:"drawend",feature:t})}}}}simulate(e,t){if(this._track&&clearTimeout(this._track.timeout),!e){this._track=!1;return}var r=(t=t||{}).delay||1e3;this._track={track:e,pos:0,timeout:setTimeout((function e(){if(this._track.pos>=this._track.track.length){this._track=!1;return}var i=this._track.track[this._track.pos];i[2]=i[3]||0,i[3]=new Date().getTime(),this._track.pos++,!1!==t.repeat&&(this._track.pos=this._track.pos%this._track.track.length),this.getActive()&&this.draw_(!0,i,t.accuracy),this._track.timeout=setTimeout(e.bind(this),r)}).bind(this),0)}}simulating(){return!!this._track}reset(){this.sketch_[1].setGeometry(),this.path_=[],this.lastPosition_=!1}start(){this.setActive(!0)}stop(){this.setActive(!1)}pause(e){this.pause_=!1!==e}isPaused(){return this.pause_}setFollowTrack(e){this.set("followTrack",e);var t,r=this.getMap();if(this.getActive()&&r){if("position"!==e&&(t=this.get("minZoom")?Math.max(this.get("minZoom"),r.getView().getZoom()):this.get("zoom")),!1===e||this.lastPosition_)"auto"===e&&this.lastPosition_&&r.getView().animate({center:this.lastPosition_,zoom:t});else{var i=this.path_[this.path_.length-1];i&&r.getView().animate({center:i,zoom:t})}}this.lastPosition_=!1,this.dispatchEvent({type:"follow",following:!1!==e})}draw_(e,t,r){var i,a,s,n,o,d,p=this.getMap();if(p){if(this._track){if(!0!==e)return;if(a=t,i=r||10,this.path_&&this.path_.length){var f=this.path_[this.path_.length-1];o=Math.atan2(t[0]-f[0],t[1]-f[1])}var m=new c.default(a,p.getView().getResolution()*i);s=(0,h.fromCircle)(m)}else i=(n=this.geolocation).getAccuracy(),a=this.getPosition(n),s=n.getAccuracyGeometry(),o=n.getHeading();switch(this.get("followTrack")){case!0:!0!=this.get("followTrack")||(this.get("minZoom")?this.get("minZoom")>p.getView().getZoom()&&p.getView().setZoom(this.get("minZoom")):p.getView().setZoom(this.get("zoom")||16),(0,v.containsExtent)(p.getView().calculateExtent(p.getSize()),s.getExtent())||p.getView().fit(s.getExtent())),p.getView().setCenter(a);break;case"position":p.getView().setCenter(a);break;case"auto":if(this.lastPosition_){var g=p.getView().getCenter();g[0]!=this.lastPosition_[0]||g[1]!=this.lastPosition_[1]?this.setFollowTrack(!1):(p.getView().setCenter(a),this.lastPosition_=a)}else p.getView().setCenter(a),this.get("minZoom")?this.get("minZoom")>p.getView().getZoom()&&p.getView().setZoom(this.get("minZoom")):this.get("zoom")&&p.getView().setZoom(this.get("zoom")),this.lastPosition_=a;break;case"visible":(0,v.containsCoordinate)(p.getView().calculateExtent(p.getSize()),a)||p.getView().setCenter(a)}var y=this.sketch_[0];if(y.setGeometry(s),i<this.get("minAccuracy")/2?y.setStyle(this.locStyle.ok):i<this.get("minAccuracy")?y.setStyle(this.locStyle.warn):y.setStyle(this.locStyle.error),this.pause_&&(this.lastPosition_=a),!this.pause_&&(!n||this.condition_.call(this,n))){switch(y=this.sketch_[1],this.path_.push(a),this.get("type")){case"Point":this.path_=[a],y.setGeometry(new l.default(a,"XYZM"));var _=this.get("attributes");_.heading&&y.set("heading",n.getHeading()),_.accuracy&&y.set("accuracy",n.getAccuracy()),_.altitudeAccuracy&&y.set("altitudeAccuracy",n.getAltitudeAccuracy()),_.speed&&y.set("speed",n.getSpeed());break;case"LineString":this.path_.length>1?(d=new u.default(this.path_,"XYZM"),this.get("tolerance")&&(d=this.simplify3D(d,this.get("tolerance"))),y.setGeometry(d)):y.setGeometry();break;case"Polygon":this.path_.length>2?(d=new h.default([this.path_],"XYZM"),this.get("tolerance")&&(d=this.simplify3D(d,this.get("tolerance"))),y.setGeometry(d)):y.setGeometry()}this.dispatchEvent({type:"drawing",feature:this.sketch_[1],geolocation:n})}this.sketch_[2].setGeometry(new l.default(a)),this.sketch_[2].set("heading",o),this.dispatchEvent({type:"tracking",feature:this.sketch_[1],geolocation:n})}}getPosition(e){var t=e.getPosition();return t.push(Math.round(100*(e.getAltitude()||0))/100),t.push(Math.round(new Date().getTime()/1e3)),t}}}),n("hQfiM",function(e,r){t(e.exports,"default",()=>d);var i=s("fnScq"),a=s("iTTi2"),n=s("cgPpQ"),o=s("a6roo"),l=s("gzr8q");let u={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"};class h extends a.default{constructor(e){super("error"),this.code=e.code,this.message=e.message}}class c extends i.default{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=l.identityTransform,this.watchId_=void 0,this.addChangeListener(u.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(u.TRACKING,this.handleTrackingChanged_),void 0!==e.projection&&this.setProjection(e.projection),void 0!==e.trackingOptions&&this.setTrackingOptions(e.trackingOptions),this.setTracking(void 0!==e.tracking&&e.tracking)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){let e=this.getProjection();e&&(this.transform_=(0,l.getTransformFromProjections)((0,l.get)("EPSG:4326"),e),this.position_&&this.set(u.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){let e=this.getTracking();e&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):e||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){let t=e.coords;this.set(u.ACCURACY,t.accuracy),this.set(u.ALTITUDE,null===t.altitude?void 0:t.altitude),this.set(u.ALTITUDE_ACCURACY,null===t.altitudeAccuracy?void 0:t.altitudeAccuracy),this.set(u.HEADING,null===t.heading?void 0:(0,o.toRadians)(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];let r=this.transform_(this.position_);this.set(u.POSITION,r.slice()),this.set(u.SPEED,null===t.speed?void 0:t.speed);let i=(0,n.circular)(this.position_,t.accuracy);i.applyTransform(this.transform_),this.set(u.ACCURACY_GEOMETRY,i),this.changed()}positionError_(e){this.dispatchEvent(new h(e))}getAccuracy(){return this.get(u.ACCURACY)}getAccuracyGeometry(){return this.get(u.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(u.ALTITUDE)}getAltitudeAccuracy(){return this.get(u.ALTITUDE_ACCURACY)}getHeading(){return this.get(u.HEADING)}getPosition(){return this.get(u.POSITION)}getProjection(){return this.get(u.PROJECTION)}getSpeed(){return this.get(u.SPEED)}getTracking(){return this.get(u.TRACKING)}getTrackingOptions(){return this.get(u.TRACKING_OPTIONS)}setProjection(e){this.set(u.PROJECTION,(0,l.get)(e))}setTracking(e){this.set(u.TRACKING,e)}setTrackingOptions(e){this.set(u.TRACKING_OPTIONS,e)}}var d=c}),n("bS8Lk",function(e,r){t(e.exports,"default",()=>l);var i=s("9Idxm"),a=s("iQyfo"),n=s("kOWwI");let o=new i.default({target:document.body,className:"ol-collapsed"});(0,n.default).addControl(o),o.cancel=function(e,t,r){let i=(0,a.default).create("DIV",{html:e});"function"==typeof t&&(0,a.default).create("A",{html:r||"annuler",className:"cancel",click:()=>{o.hide(),t()},parent:i}),o.show(i,8e3)};var l=o}),n("9Idxm",function(e,r){t(e.exports,"default",()=>n);var i=s("4DafG"),a=s("iQyfo"),n=class extends i.default{constructor(e){e=e||{};var t=document.createElement("DIV");super({element:t,target:e.target}),this.contentElement=(0,a.default).create("DIV",{click:(function(){this.get("hideOnClick")&&this.hide()}).bind(this),parent:t});var r=(e.className||"")+" ol-notification";e.target||(r+=" ol-unselectable ol-control ol-collapsed"),t.setAttribute("class",r),this.set("closeBox",e.closeBox),this.set("hideOnClick",e.hideOnClick)}show(e,t){var r=this,i=this.element;e&&(e instanceof Node?(this.contentElement.innerHTML="",this.contentElement.appendChild(e)):this.contentElement.innerHTML=e,this.get("closeBox")?(this.contentElement.classList.add("ol-close"),(0,a.default).create("SPAN",{className:"closeBox",click:(function(){this.hide()}).bind(this),parent:this.contentElement})):this.contentElement.classList.remove("ol-close")),this._listener&&(clearTimeout(this._listener),this._listener=null),i.classList.add("ol-collapsed"),this._listener=setTimeout(function(){i.classList.remove("ol-collapsed"),!t||t>=0?r._listener=setTimeout(function(){i.classList.add("ol-collapsed"),r._listener=null},t||3e3):r._listener=null},100)}hide(){this._listener&&(clearTimeout(this._listener),this._listener=null),this.element.classList.add("ol-collapsed")}toggle(e){this.element.classList.contains("ol-collapsed")?this.show(null,e):this.hide()}}}),n("lUmQH",function(r,i){t(r.exports,"default",()=>m);var a=s("jQ8kQ"),n=s("iQyfo"),o=s("l956U"),l=s("kbFhP"),u=s("keikI"),h=s("1EpmD"),c=s("kPMpK"),d=s("iArnh"),p=s("bS8Lk"),f=s("2iBkg"),m=function(){let t=new a.default({switcherClass:"mainSwitcher ol-layer-shop ol-layerswitcher",oninfo:r=>{!function(t,r){let i=(0,n.default).create("DIV",{className:"md"});(0,n.default).create("DIV",{html:(0,o.default)(t.get("desc")||t.get("description"),t.getProperties()),parent:i}),t.getSource().getAttributions()&&(0,n.default).create("DIV",{className:"copy",html:t.getSource().getAttributions()({extent:[-1/0,-1/0,1/0,1/0]}).join(" - "),parent:i}),(0,l.default).show({className:"layer-info"+(t.get("exportable")?" exportable":""),title:t.get("title"),content:i,buttons:{pk:"ok"}}),(0,o.default).renderWidget(i),t.get("exportable")&&t.getSource().getFeatures().length&&(0,n.default).create("BUTTON",{html:'<i class="fi-download"></i> télécharger',className:"button, button-ghost",click:()=>{let i=t.getSource().getFeatures();if(!i.length){(0,l.default).showAlert("Aucune données à enregistrer<br/>dans ce calque...");return}let a=(new c.default).writeFeatures(i,{featureProjection:r.getView().getProjection(),rightHanded:!0});var s=new Blob([a],{type:"text/plain;charset=utf-8"});e(d).saveAs(s,t.get("title")+".geojson"),(0,l.default).close(),(0,p.default).show(i.length+" objets enregistrés...")},parent:(0,l.default).element.querySelector(".ol-buttons")})}(r,t.getMap())},selection:!1,minibar:!0});return t.set("selection",!1),t.on("drawlist",e=>{(e.layer.get("inview")||e.layer.getVisible())&&(e.layer.get("inview")||e.layer.set("inview",!0),e.li.dataset.inview="");let t="la couche "+e.layer.get("title")+" n'est pas visible sur cette zone à cette échelle";(0,n.default).create("DIV",{className:"disabled",title:t,"aria-label":t,parent:e.li})}),(0,n.default).create("BUTTON",{html:"+ de données",click:()=>{(function(e){let t;let r=e.getMap().getLayers(),i=(0,n.default).create("DIV"),a=(0,n.default).create("INPUT",{type:"search",placeHolder:"rechercher...",parent:i});(0,n.default).addListener(a,["input"],()=>{t&&clearTimeout(t),setTimeout(()=>{let e=RegExp((0,h.default)(a.value),"i");(0,l.default).getContentElement().querySelectorAll(".theme li").forEach(t=>{e.test((0,h.default)(t.innerText))?(delete t.dataset.hidden,t.dataset.visible=""):(delete t.dataset.visible,t.dataset.hidden="")}),(0,l.default).getContentElement().querySelectorAll(".theme").forEach(e=>{e.querySelector("li[data-visible]")?delete e.dataset.hidden:e.dataset.hidden=""})},300)});let s=(0,n.default).create("UL",{parent:i}),c={};r.forEach(e=>{let t=e.get("theme")||"";c[t]||(c[t]=[]),c[t].push(e)}),Object.keys(c).reverse().forEach(e=>{let t=(0,n.default).create("LI",{class:"theme",html:(0,n.default).create("H3",{html:(0,o.default).iconize(e),click:()=>{void 0!==t.dataset.expended?delete t.dataset.expended:t.dataset.expended=""}}),parent:s});(0,n.default).create("SPAN",{className:"count",parent:t});let r=(0,n.default).create("UL",{parent:t});c[e].forEach(e=>{let t=(0,n.default).create("LI");r.prepend(t);let i=new u.default({type:"checkbox",after:e.get("title")||e.get("name"),checked:e.get("inview")||e.getVisible(),parent:t});e.get("logo")&&(0,n.default).create("DIV",{className:"img",html:(0,n.default).create("IMG",{src:(0,f.getMediaURL)(e.get("logo"))}),parent:t}),(0,n.default).create("DIV",{html:(0,o.default)(e.get("desc")||e.get("description"),e.getProperties()),parent:t}),i.on("check",t=>{e.setVisible(t.checked),e.set("inview",t.checked),d()})});let i=(0,n.default).create("LI",{className:"selall"});r.prepend(i),(0,n.default).create("BUTTON",{text:"tout sélectionner",click:()=>{i.parentNode.querySelectorAll('[type="checkbox"]').forEach(e=>{e.checked||e.click()})},parent:i}),(0,n.default).create("SPAN",{text:"/",parent:i}),(0,n.default).create("BUTTON",{text:"tout supprimer",click:()=>{i.parentNode.querySelectorAll('[type="checkbox"]').forEach(e=>{e.checked&&e.click()})},parent:i})});let d=function(){s.querySelectorAll(".count").forEach(e=>{let t=e.parentNode.querySelectorAll('[type="checkbox"]:checked').length,r=e.parentNode.querySelectorAll('[type="checkbox"]').length;e.innerText=t+" / "+r})};d(),(0,l.default).show({className:"layer-inview medium",title:"Ajouter des données",closeBox:!1,content:i,buttons:["Terminé"],onButton:()=>{e.drawPanel()}}),(0,l.default).set("hideOnBack",!0),(0,l.default).once("hide",()=>{(0,l.default).set("hideOnBack",!1)})})(t)},parent:t.getBarElement("bottom")}),t}}),n("jQ8kQ",function(e,r){t(e.exports,"default",()=>n);var i=s("iQyfo"),a=s("hddSm"),n=class extends a.default{constructor(e){(e=e||{}).selection=!0,e.noScroll=!0,super(e),this.element.classList.add("ol-layer-shop");var t=this.element.insertBefore((0,i.default).create("DIV",{className:"ol-title-bar"}),this.getPanel());this.on("select",(function(e){t.innerText=e.layer?e.layer.get("title"):"",this.element.setAttribute("data-layerClass",this.getLayerClass(e.layer))}).bind(this)),this._topbar=this.element.insertBefore((0,i.default).create("DIV",{className:"ol-bar ol-top-bar"}),this.getPanel()),this._bottombar=(0,i.default).create("DIV",{className:"ol-bar ol-bottom-bar",parent:this.element}),this._controls=[]}setMap(e){this.getMap()&&this._controls.forEach((function(e){this.getMap().removeControl(e)}).bind(this)),super.setMap(e),e&&(this.selectLayer(),this._listener.removeLayer=e.getLayers().on("remove",(function(e){e.element===this.getSelection()&&this.selectLayer()}).bind(this)),this._controls.forEach((function(e){this.getMap().addControl(e)}).bind(this)))}getBarElement(e){return"bottom"===e?this._bottombar:this._topbar}addControl(e,t){this._controls.push(e),e.setTarget("bottom"===t?this._bottombar:this._topbar),this.getMap()&&this.getMap().addControl(e)}}}),n("hddSm",function(e,r){t(e.exports,"default",()=>f);var i=s("ejLRd"),a=s("4DafG"),n=s("eEuqc"),o=s("610XN"),l=s("gNqjI"),u=s("dMe05"),h=s("8WefF"),c=s("jZquI"),d=s("iQyfo"),p=class extends a.default{constructor(e){e=e||{};var t=(0,d.default).create("DIV",{className:e.switcherClass||"ol-layerswitcher"});super({element:t,target:e.target});var r=this;this.dcount=0,this.show_progress=e.show_progress,this.oninfo="function"==typeof e.oninfo?e.oninfo:null,this.onextent="function"==typeof e.onextent?e.onextent:null,this.hasextent=e.extent||e.onextent,this.hastrash=e.trash,this.reordering=!1!==e.reordering,this._layers=[],this._layerGroup=e.layerGroup&&e.layerGroup.getLayers?e.layerGroup:null,this.onchangeCheck="function"==typeof e.onchangeCheck?e.onchangeCheck:null,"function"==typeof e.displayInLayerSwitcher&&(this.displayInLayerSwitcher=e.displayInLayerSwitcher),e.target||(t.classList.add("ol-unselectable"),t.classList.add("ol-control"),t.classList.add(!1!==e.collapsed?"ol-collapsed":"ol-forceopen"),this.button=(0,d.default).create("BUTTON",{type:"button",parent:t}),this.button.addEventListener("touchstart",function(e){t.classList.toggle("ol-forceopen"),t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:t.classList.contains("ol-collapsed")}),e.preventDefault(),r.overflow()}),this.button.addEventListener("click",function(){t.classList.toggle("ol-forceopen"),t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!t.classList.contains("ol-forceopen")}),r.overflow()}),e.mouseover&&(t.addEventListener("mouseleave",function(){t.classList.add("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!0})}),t.addEventListener("mouseover",function(){t.classList.remove("ol-collapsed"),r.dispatchEvent({type:"toggle",collapsed:!1})})),e.minibar&&(e.noScroll=!0),e.noScroll||(this.topv=(0,d.default).create("DIV",{className:"ol-switchertopdiv",parent:t,click:function(){r.overflow("+50%")}}),this.botv=(0,d.default).create("DIV",{className:"ol-switcherbottomdiv",parent:t,click:function(){r.overflow("-50%")}})),this._noScroll=e.noScroll),this.panel_=(0,d.default).create("UL",{className:"panel"}),this.panelContainer_=(0,d.default).create("DIV",{className:"panel-container",html:this.panel_,parent:t}),e.target||e.noScroll||(0,d.default).addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",function(e){r.overflow(Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)))&&(e.stopPropagation(),e.preventDefault())}),this.header_=(0,d.default).create("LI",{className:"ol-header",parent:this.panel_}),this.set("drawDelay",e.drawDelay||0),this.set("selection",e.selection),e.minibar&&setTimeout((function(){var e=(0,d.default).scrollDiv(this.panelContainer_,{mousewheel:!0,vertical:!0,minibar:!0});this.on(["drawlist","toggle"],function(){e.refresh()})}).bind(this))}displayInLayerSwitcher(e){return!1!==e.get("displayInLayerSwitcher")}setMap(e){if(super.setMap(e),this.drawPanel(),this._listener)for(var t in this._listener)(0,i.unByKey)(this._listener[t]);this._listener=null,e&&(this._listener={moveend:e.on("moveend",this.viewChange.bind(this)),size:e.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=e.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))}show(){this.element.classList.add("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!1})}hide(){this.element.classList.remove("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!0})}toggle(){this.element.classList.toggle("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!this.isOpen()})}isOpen(){return this.element.classList.contains("ol-forceopen")}setHeader(e){(0,d.default).setHTML(this.header_,e)}overflow(e){if(!this.button||this._noScroll)return!1;if((0,d.default).hidden(this.panel_)){(0,d.default).setStyle(this.element,{height:"auto"});return}var t=(0,d.default).outerHeight(this.element),r=(0,d.default).outerHeight(this.panel_),i=this.button.offsetTop+(0,d.default).outerHeight(this.button),a=this.panel_.offsetTop-i;if(!(r>t-i))return(0,d.default).setStyle(this.element,{height:"auto"}),(0,d.default).setStyle(this.panel_,{top:0}),(0,d.default).hide(this.botv),(0,d.default).hide(this.topv),!1;(0,d.default).setStyle(this.element,{height:"100%"});var s=this.panel_.querySelectorAll("li.ol-visible .li-content")[0],n=s?2*(0,d.default).getStyle(s,"height"):0;switch(e){case 1:a+=n;break;case -1:a-=n;break;case"+50%":a+=Math.round(t/2);break;case"-50%":a-=Math.round(t/2)}return a+r<=t-3*i/2?(a=t-3*i/2-r,(0,d.default).hide(this.botv)):(0,d.default).show(this.botv),a>=0?(a=0,(0,d.default).hide(this.topv)):(0,d.default).show(this.topv),(0,d.default).setStyle(this.panel_,{top:a+"px"}),!0}_setLayerForLI(e,t){var r=[];t.getLayers&&r.push(t.getLayers().on("change:length",this.drawPanel.bind(this))),e&&(r.push(t.on("change:opacity",(function(){this.setLayerOpacity(t,e)}).bind(this))),r.push(t.on("change:visible",(function(){this.setLayerVisibility(t,e)}).bind(this)))),r.push(t.on("propertychange",(function(e){("displayInLayerSwitcher"===e.key||"openInLayerSwitcher"===e.key||"title"===e.key||"name"===e.key)&&this.drawPanel(e)}).bind(this))),this._layers.push({li:e,layer:t,listeners:r})}setLayerOpacity(e,t){var r=t.querySelector(".layerswitcher-opacity-cursor");r&&(r.style.left=100*e.getOpacity()+"%"),this.dispatchEvent({type:"layer:opacity",layer:e})}setLayerVisibility(e,t){var r=t.querySelector(".ol-visibility");r&&(r.checked=e.getVisible()),e.getVisible()?t.classList.add("ol-visible"):t.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:e})}_clearLayerForLI(){this._layers.forEach(function(e){e.listeners.forEach(function(e){(0,i.unByKey)(e)})}),this._layers=[]}_getLayerForLI(e){for(var t,r=0;t=this._layers[r];r++)if(t.li===e)return t.layer;return null}viewChange(){this.panel_.querySelectorAll("li").forEach((function(e){var t=this._getLayerForLI(e);t&&(this.testLayerVisibility(t)?e.classList.remove("ol-layer-hidden"):e.classList.add("ol-layer-hidden"))}).bind(this))}getPanel(){return this.panelContainer_}drawPanel(){if(this.getMap()){var e=this;this.dcount++,setTimeout(function(){e.drawPanel_()},this.get("drawDelay")||0)}}drawPanel_(){if(!--this.dcount&&!this.dragging_){var e=this.panelContainer_.scrollTop;this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach((function(e){e.classList.contains("ol-header")||e.remove()}).bind(this)),this._layerGroup?this.drawList(this.panel_,this._layerGroup.getLayers()):this.getMap()&&this.drawList(this.panel_,this.getMap().getLayers()),this.panelContainer_.scrollTop=e}}switchLayerVisibility(e,t){e.get("baseLayer")?(e.getVisible()||e.setVisible(!0),t.forEach(function(t){e!==t&&t.get("baseLayer")&&t.getVisible()&&t.setVisible(!1)})):e.setVisible(!e.getVisible())}testLayerVisibility(e){if(!this.getMap())return!0;var t=this.getMap().getView().getResolution(),r=this.getMap().getView().getZoom();if(e.getMaxResolution()<=t||e.getMinResolution()>=t||e.getMinZoom&&(e.getMinZoom()>=r||e.getMaxZoom()<r))return!1;var i=e.getExtent();if(i){var a=this.getMap().getView().calculateExtent(this.getMap().getSize());return(0,c.intersects)(a,i)}return!0}dragOrdering_(e){e.stopPropagation(),e.preventDefault();var t,r,i,a,s,n=this,o=e.currentTarget.parentNode.parentNode,l=!0,u=this.panel_,h=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY;function c(e){if(t=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY,l&&Math.abs(h-t)>2&&(l=!1,o.classList.add("drag"),a=n._getLayerForLI(o),r=!1,s=n._getLayerForLI(o.parentNode.parentNode),i=(0,d.default).create("LI",{className:"ol-dragover",html:o.innerHTML,style:{position:"absolute","z-index":1e4,left:o.offsetLeft,opacity:.5,width:(0,d.default).outerWidth(o),height:(0,d.default).getStyle(o,"height")},parent:u}),n.element.classList.add("drag"),n.dispatchEvent({type:"reorder-start",layer:a,group:s})),!l){var c;if(e.preventDefault(),e.stopPropagation(),(0,d.default).setStyle(i,{top:t-(0,d.default).offsetRect(u).top+u.scrollTop+5}),e.touches)for(c=document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);c.shadowRoot;)c=c.shadowRoot.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);else c=e.target,e.target.shadowRoot&&(c=e.composedPath()[0]);for(c.classList.contains("ol-switcherbottomdiv")?n.overflow(-1):c.classList.contains("ol-switchertopdiv")&&n.overflow(1);c&&"LI"!==c.tagName;)c=c.parentNode;c&&c.classList.contains("dropover")||o.parentNode.querySelectorAll("li").forEach(function(e){e.classList.remove("dropover"),e.classList.remove("dropover-after"),e.classList.remove("dropover-before")}),c&&c.parentNode.classList.contains("drag")&&c!==o?((r=n._getLayerForLI(c))&&!r.get("allwaysOnTop")==!a.get("allwaysOnTop")?(c.classList.add("dropover"),c.classList.add(o.offsetTop<c.offsetTop?"dropover-after":"dropover-before")):r=!1,(0,d.default).show(i)):(r=!1,c===o?(0,d.default).hide(i):(0,d.default).show(i)),r?i.classList.remove("forbidden"):i.classList.add("forbidden")}}o.parentNode.classList.add("drag"),(0,d.default).addListener(document,"mousemove touchmove",c),(0,d.default).addListener(document,"mouseup touchend touchcancel",function e(){if(r){var t=a,l=n.getSelection()===t;if(t&&r){for(var u,h=(u=s?s.getLayers():n._layerGroup?n._layerGroup.getLayers():n.getMap().getLayers()).getArray(),p=0;p<h.length;p++)if(h[p]==t){u.removeAt(p);break}for(var f=0;f<h.length;f++)if(h[f]===r){p>f?u.insertAt(f,t):u.insertAt(f+1,t);break}}l&&n.selectLayer(t),n.dispatchEvent({type:"reorder-end",layer:t,group:s})}o.parentNode.querySelectorAll("li").forEach(function(e){e.classList.remove("dropover"),e.classList.remove("dropover-after"),e.classList.remove("dropover-before")}),o.classList.remove("drag"),o.parentNode.classList.remove("drag"),n.element.classList.remove("drag"),i&&i.remove(),(0,d.default).removeListener(document,"mousemove touchmove",c),(0,d.default).removeListener(document,"mouseup touchend touchcancel",e)})}dragOpacity_(e){e.stopPropagation(),e.preventDefault();var t=this,r=e.target,i=this._getLayerForLI(r.parentNode.parentNode.parentNode);if(i){var a=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX,s=(0,d.default).getStyle(r,"left")-a;t.dragging_=!0,(0,d.default).addListener(document,"mouseup touchend touchcancel",function e(){(0,d.default).removeListener(document,"mouseup touchend touchcancel",e),(0,d.default).removeListener(document,"mousemove touchmove",n),t.dragging_=!1}),(0,d.default).addListener(document,"mousemove touchmove",n)}function n(e){var t=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX,a=Math.max(0,Math.min(1,(s+t)/(0,d.default).getStyle(r.parentNode,"width")));(0,d.default).setStyle(r,{left:100*a+"%"}),r.parentNode.nextElementSibling.innerHTML=Math.round(100*a),i.setOpacity(a)}}drawList(e,t){var r=this,i=t.getArray(),a=function(e){e.stopPropagation(),e.preventDefault();var i=r._getLayerForLI(this.parentNode.parentNode);r.switchLayerVisibility(i,t),r.get("selection")&&i.getVisible()&&r.selectLayer(i),r.onchangeCheck&&r.onchangeCheck(i)};function s(e){e.stopPropagation(),e.preventDefault();var t=r._getLayerForLI(this.parentNode.parentNode);r.oninfo(t),r.dispatchEvent({type:"info",layer:t})}function o(e){e.stopPropagation(),e.preventDefault();var t=r._getLayerForLI(this.parentNode.parentNode);r.onextent?r.onextent(t):r.getMap().getView().fit(t.getExtent(),r.getMap().getSize()),r.dispatchEvent({type:"extent",layer:t})}function l(e){e.stopPropagation(),e.preventDefault();var t,i=this.parentNode.parentNode.parentNode.parentNode,a=r._getLayerForLI(i);a?(t=r._getLayerForLI(this.parentNode.parentNode),a.getLayers().remove(t),0!=a.getLayers().getLength()||a.get("noSwitcherDelete")||l.call(i.querySelectorAll(".layerTrash")[0],e)):(i=this.parentNode.parentNode,r.getMap().removeLayer(r._getLayerForLI(i)))}function u(u){if(!this.displayInLayerSwitcher(u)){this._setLayerForLI(null,u);return}var c=(0,d.default).create("LI",{className:(u.getVisible()?"ol-visible ":" ")+(u.get("baseLayer")?"baselayer":""),parent:e});this._setLayerForLI(c,u),this._selectedLayer===u&&c.classList.add("ol-layer-select");var p=(0,d.default).create("DIV",{className:"ol-layerswitcher-buttons",parent:c}),f=(0,d.default).create("DIV",{className:"li-content",parent:c}),m=(0,d.default).create("INPUT",{type:u.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:u.getVisible(),click:function(e){a.bind(this)(e),setTimeout(function(){e.target.checked=u.getVisible()})},on:{keydown:(function(i){switch(i.key){case"ArrowLeft":case"ArrowRight":i.preventDefault(),i.stopPropagation();var a="ArrowLeft"===i.key?-.1:.1,s=Math.min(1,Math.max(0,u.getOpacity()+a));u.setOpacity(s);break;case"Enter":r.get("selection")&&(i.preventDefault(),i.stopPropagation(),r.selectLayer(u));break;case"-":case"+":u.getLayers&&(this._focus=u,u.set("openInLayerSwitcher",!u.get("openInLayerSwitcher")));case"ArrowUp":case"ArrowDown":if(i.ctrlKey&&this.reordering){i.preventDefault(),i.stopPropagation();var n=t.getArray().indexOf(u);n>-1&&("ArrowDown"===i.key?n>0&&(t.remove(u),t.insertAt(n-1,u),r._focus=u,r.dispatchEvent({type:"reorder-end",layer:u})):n<t.getLength()-1&&(t.remove(u),t.insertAt(n+1,u),r._focus=u,r.dispatchEvent({type:"reorder-end",layer:u})))}break;default:var o=this._getLayerForLI(e.parentNode);this.dispatchEvent({type:"layer:keydown",key:i.key,group:o,li:c,layer:u,originalEvent:i})}}).bind(this)},parent:f});u===r._focus&&(m.focus(),r.overflow());var g=(0,d.default).create("LABEL",{title:u.get("title")||u.get("name"),click:a,style:{userSelect:"none"},parent:f});if(g.addEventListener("selectstart",function(){return!1}),(0,d.default).create("SPAN",{html:u.get("title")||u.get("name"),click:(function(e){this.get("selection")&&(e.stopPropagation(),this.selectLayer(u))}).bind(this),parent:g}),this.reordering&&(h<i.length-1&&(u.get("allwaysOnTop")||!i[h+1].get("allwaysOnTop"))||h>0&&(!u.get("allwaysOnTop")||i[h-1].get("allwaysOnTop")))&&(0,d.default).create("DIV",{className:"layerup ol-noscroll",title:this.tip.up,on:{"mousedown touchstart":function(e){r.dragOrdering_(e)}},parent:p}),u.getLayers){var y=0;u.getLayers().forEach(function(e){r.displayInLayerSwitcher(e)&&y++}),y&&(0,d.default).create("DIV",{className:u.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var e=r._getLayerForLI(this.parentNode.parentNode);e.set("openInLayerSwitcher",!e.get("openInLayerSwitcher"))},parent:p})}if(this.oninfo&&(0,d.default).create("DIV",{className:"layerInfo",title:this.tip.info,click:s,parent:p}),this.hastrash&&!u.get("noSwitcherDelete")&&(0,d.default).create("DIV",{className:"layerTrash",title:this.tip.trash,click:l,parent:p}),this.hasextent&&i[h].getExtent()){var v=i[h].getExtent();4==v.length&&v[0]<v[2]&&v[1]<v[3]&&(0,d.default).create("DIV",{className:"layerExtent",title:this.tip.extent,click:o,parent:p})}if(this.show_progress&&u instanceof n.default){var _=(0,d.default).create("DIV",{className:"layerswitcher-progress",parent:f});this.setprogress_(u),u.layerswitcher_progress=(0,d.default).create("DIV",{parent:_})}var x=(0,d.default).create("DIV",{className:"layerswitcher-opacity",click:function(e){if(e.target===this){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(1,e.offsetX/(0,d.default).getStyle(this,"width")));r._getLayerForLI(this.parentNode.parentNode).setOpacity(t),this.parentNode.querySelectorAll(".layerswitcher-opacity-label")[0].innerHTML=Math.round(100*t)}},parent:f});if((0,d.default).create("DIV",{className:"layerswitcher-opacity-cursor ol-noscroll",style:{left:100*u.getOpacity()+"%"},on:{"mousedown touchstart":function(e){r.dragOpacity_(e)}},parent:x}),(0,d.default).create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(100*u.getOpacity()),parent:f}),u.getLayers&&(c.classList.add("ol-layer-group"),!0===u.get("openInLayerSwitcher"))){var b=(0,d.default).create("UL",{parent:c});this.drawList(b,u.getLayers())}c.classList.add(this.getLayerClass(u)),this.dispatchEvent({type:"drawlist",layer:u,li:c})}for(var h=i.length-1;h>=0;h--)u.call(this,i[h]);this.viewChange(),e===this.panel_&&(this.overflow(""),this._focus=null)}getLayerClass(e){return e?e.getLayers?"ol-layer-group":e instanceof o.default?"ol-layer-vector":e instanceof l.default?"ol-layer-vectortile":e instanceof n.default?"ol-layer-tile":e instanceof u.default?"ol-layer-image":e instanceof h.default?"ol-layer-heatmap":e.getFeatures?"ol-layer-vectorimage":"unknown":"none"}selectLayer(e,t){if(!e){if(!this.getMap())return;e=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=e,this.element.querySelector("input.ol-visibility:focus")&&(this._focus=e),this.drawPanel(),t||this.dispatchEvent({type:"select",layer:e})}getSelection(){return this._selectedLayer}setprogress_(e){if(!e.layerswitcher_progress){var t=0,r=0,i=function(){r===t?(r=t=0,(0,d.default).setStyle(e.layerswitcher_progress,{width:0})):(0,d.default).setStyle(e.layerswitcher_progress,{width:(t/r*100).toFixed(1)+"%"})};e.getSource().on("tileloadstart",function(){r++,i()}),e.getSource().on("tileloadend",function(){t++,i()}),e.getSource().on("tileloaderror",function(){t++,i()})}}};p.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"};var f=p}),n("iArnh",function(e,t){var i;e.exports,i=function(){function t(e,t,r){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,r)},i.onerror=function(){console.error("could not download file")},i.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,n=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(e,r,n){var o=s.URL||s.webkitURL,l=document.createElement("a");r=r||e.name||"download",l.download=r,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?a(l):i(l.href)?t(e,r,n):a(l,l.target="_blank")):(l.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(l.href)},4e4),setTimeout(function(){a(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,s){if(r=r||e.name||"download","string"!=typeof e){var n;navigator.msSaveOrOpenBlob((void 0===(n=s)?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),r)}else if(i(e))t(e,r,s);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){a(o)})}}:function(e,r,i,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,r,i);var o="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&l||n)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var e=h.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},h.readAsDataURL(e)}else{var c=s.URL||s.webkitURL,d=c.createObjectURL(e);a?a.location=d:location.href=d,a=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});s.saveAs=o.saveAs=o,e.exports=o},"function"==typeof define&&define.amd?define([],i):i()}),n("7qUmJ",function(e,r){t(e.exports,"default",()=>o);var i=s("5VeMq"),a=s("iQyfo"),n=s("l956U"),o=class extends i.default{constructor(e){super(e=e||{}),this.select=e.select}show(e,t,r,i){t instanceof Array||(t=[t]),r instanceof Array||(r=[r]),this._contents=t.slice(),this._features=r,this._count=1,i&&Number.isInteger(i)&&0<i&&i<this._contents.length+1&&(this._count=i);let a=t[this._count-1];var s=this._getHtml(a,i);s&&s.innerText?(this.element.classList.contains("ol-fixed")||this.hide(),this.select.setIndex(this._count),this.select.setShownFeature(this._features[this._count-1]),super.show(e,s)):this.hide()}_getHtml(e,t){let r=(0,a.default).create("DIV",{className:"ol-popupfeature"});return this._contents.length>1?(0,n.default).showSelection(r,this.select,t||1,this._contents,this._features):(e instanceof Element?r.appendChild(e):(0,a.default).create("DIV",{className:"ol-popup-content",html:e,parent:r}),r)}}}),n("5VeMq",function(e,r){t(e.exports,"default",()=>n);var i=s("VCbYw"),a=s("iQyfo"),n=class extends i.default{constructor(e){e=e||{};var t=document.createElement("div");e.element=t,super(e),"number"==typeof e.offsetBox?this.offsetBox=[e.offsetBox,e.offsetBox,e.offsetBox,e.offsetBox]:this.offsetBox=e.offsetBox,this.closeBox=e.closeBox,this.onclose=e.onclose,this.onshow=e.onshow,(0,a.default).create("BUTTON",{className:"closeBox"+(e.closeBox?" hasclosebox":""),type:"button",click:(function(){this.hide()}).bind(this),parent:t}),!1!==e.anchor&&(0,a.default).create("DIV",{className:"anchor",parent:t}),this.content=(0,a.default).create("DIV",{html:e.html||"",className:"ol-popup-content",parent:t}),e.minibar&&(0,a.default).scrollDiv(this.content,{vertical:!0,mousewheel:!0,minibar:!0}),e.stopEvent&&(t.addEventListener("mousedown",function(e){e.stopPropagation()}),t.addEventListener("touchstart",function(e){e.stopPropagation()})),this._elt=t,this.setPositioning(e.positioning||"auto"),this.setPopupClass(e.popupClass||e.className||"default"),e.anim&&this.addPopupClass("anim"),e.position&&setTimeout((function(){this.show(e.position)}).bind(this))}getClassPositioning(){var e="",t=this.getPositioning();return/bottom/.test(t)&&(e+="ol-popup-bottom "),/top/.test(t)&&(e+="ol-popup-top "),/left/.test(t)&&(e+="ol-popup-left "),/right/.test(t)&&(e+="ol-popup-right "),/^center/.test(t)&&(e+="ol-popup-middle "),/center$/.test(t)&&(e+="ol-popup-center "),e}setClosebox(e){this.closeBox=e,e?this.element.classList.add("hasclosebox"):this.element.classList.remove("hasclosebox")}setPopupClass(e){var t=["ol-popup"];this.getVisible()&&t.push("visible"),this.element.className="";var r=this.getClassPositioning().split(" ").filter(function(e){return e.length>0});e?e.split(" ").filter(function(e){return e.length>0}).forEach(function(e){t.push(e)}):t.push("default"),r.forEach(function(e){t.push(e)}),this.closeBox&&t.push("hasclosebox"),this.element.classList.add.apply(this.element.classList,t)}addPopupClass(e){this.element.classList.add(e)}removePopupClass(e){this.element.classList.remove(e)}setPositioning(e){void 0!==e&&(/auto/.test(e)?(this.autoPositioning=e.split("-"),1==this.autoPositioning.length&&(this.autoPositioning[1]="auto")):this.autoPositioning=!1,"center"==(e=e.replace(/auto/g,"center"))&&(e="bottom-center"),this.setPositioning_(e))}setPositioning_(e){if(this.element){super.setPositioning(e),this.element.classList.remove("ol-popup-top","ol-popup-bottom","ol-popup-left","ol-popup-right","ol-popup-center","ol-popup-middle");var t=this.getClassPositioning().split(" ").filter(function(e){return e.length>0});this.element.classList.add.apply(this.element.classList,t)}}getVisible(){return this.element.classList.contains("visible")}show(e,t){t||"string"!=typeof e||(t=e,e=null),!0===e&&(e=this.getPosition());var r=this,i=this.getMap();if(i&&(t&&t!==this.prevHTML&&(this.prevHTML=t,this.content.innerHTML="",t instanceof Element?this.content.appendChild(t):(0,a.default).create("DIV",{html:t,parent:this.content}),Array.prototype.slice.call(this.content.querySelectorAll("img")).forEach(function(e){e.addEventListener("load",function(){try{i.renderSync()}catch(e){}r.content.dispatchEvent(new Event("scroll"))})})),e)){if(this.autoPositioning){var s=i.getPixelFromCoordinate(e),n=i.getSize(),o=[];"auto"==this.autoPositioning[0]?o[0]=s[1]<n[1]/3?"top":"bottom":o[0]=this.autoPositioning[0],o[1]=s[0]<2*n[0]/3?"left":"right",this.setPositioning_(o[0]+"-"+o[1]),this.offsetBox&&this.setOffset([this.offsetBox["left"==o[1]?2:0],this.offsetBox["top"==o[0]?3:1]])}else this.offsetBox&&this.setOffset(this.offsetBox);this.setPosition(e),this.element.parentElement.style.display="","function"==typeof this.onshow&&this.onshow(),this.dispatchEvent({type:"show"}),this._tout=setTimeout(function(){r.element.classList.add("visible")},0)}}hide(){void 0!=this.getPosition()&&("function"==typeof this.onclose&&this.onclose(),this.setPosition(void 0),this._tout&&clearTimeout(this._tout),this.element.classList.remove("visible"),this.dispatchEvent({type:"hide"}))}}}),n("17jqf",function(e,r){t(e.exports,"default",()=>l);var i=s("ejLRd"),a=s("7lBr2"),n=s("7qu5m"),o=s("5VeMq"),l=class extends o.default{constructor(e){(e=e||{}).popupClass=e.popupClass||e.className||"tooltips black",e.positioning=e.positioning||"center-left",e.stopEvent=!!e.stopEvent,super(e),this.set("maximumFractionDigits",e.maximumFractionDigits||2),"function"==typeof e.formatLength&&(this.formatLength=e.formatLength),"function"==typeof e.formatArea&&(this.formatArea=e.formatArea),"function"==typeof e.getHTML&&(this.getHTML=e.getHTML),this._interaction=new a.default({handleEvent:(function(e){if("pointermove"===e.type||"click"===e.type){var t=this.getHTML(this._feature,this.get("info"));t?this.show(e.coordinate,t):this.hide(),this._coord=e.coordinate}return!0}).bind(this)})}setMap(e){this.getMap()&&this.getMap().removeInteraction(this._interaction),super.setMap(e),this.getMap()&&this.getMap().addInteraction(this._interaction)}getHTML(e,t){return this.get("measure")?this.get("measure")+(t?"<br/>"+t:""):t||""}setInfo(e){e?setTimeout((function(){this.set("info",e),this.show(this._coord,this.get("info"))}).bind(this)):(this.set("info",""),this.hide())}removeFeature(){this.setFeature()}formatArea(e){return e>Math.pow(10,-1*this.get("maximumFractionDigits"))?e>1e4?(e/1e6).toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits)")})+" km²":e.toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" m²":""}formatLength(e){return e>Math.pow(10,-1*this.get("maximumFractionDigits"))?e>100?(e/1e3).toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" km":e.toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" m":""}setFeature(e){e&&e.feature&&(e=e.feature),this._feature=e,this._listener&&this._listener.forEach(function(e){(0,i.unByKey)(e)}),this._listener=[],this.set("measure",""),e&&this._listener.push(e.getGeometry().on("change",(function(e){var t,r=e.target;r.getArea?t=this.formatArea((0,n.getArea)(r,{projection:this.getMap().getView().getProjection()})):r.getLength&&(t=this.formatLength((0,n.getLength)(r,{projection:this.getMap().getView().getProjection()}))),this.set("measure",t)}).bind(this)))}}}),n("6yJ0x",function(e,r){t(e.exports,"default",()=>n);var i=s("7lBr2"),a=s("iQyfo"),n=class extends i.default{constructor(e){e||(e=e||{});var t=!1;super({handleEvent:function(i){if(!r.getActive())return!0;switch(i.type){case"pointerdrag":t=!0;break;case"pointerup":t=!1;break;case"pointermove":t||r.handleMove_(i)}return!e.handleEvent||e.handleEvent(i)}});var r=this;this.setLayerFilter(e.layerFilter),e.layers&&e.layers.length&&this.setLayerFilter(function(t){return e.layers.indexOf(t)>=0}),this.setFeatureFilter(e.featureFilter),this.set("hitTolerance",e.hitTolerance),this.setCursor(e.cursor)}setMap(e){void 0!==this.previousCursor_&&this.getMap()&&((0,a.default).setCursor(this.getMap(),this.previousCursor_),this.previousCursor_=void 0),super.setMap(e)}setActive(e){super.setActive(e),this.cursor_&&this.getMap()&&this.getMap().getTargetElement()&&void 0!==this.previousCursor_&&((0,a.default).setCursor(this.getMap(),this.previousCursor_),this.previousCursor_=void 0)}setCursor(e){!e&&void 0!==this.previousCursor_&&this.getMap()&&((0,a.default).setCursor(this.getMap(),this.previousCursor_),this.previousCursor_=void 0),this.cursor_=e}setFeatureFilter(e){"function"==typeof e?this.featureFilter_=e:this.featureFilter_=function(){return!0}}setLayerFilter(e){"function"==typeof e?this.layerFilter_=e:this.layerFilter_=function(){return!0}}handleMove_(e){var t=this.getMap();if(t){var r,i,s=this,n=t.forEachFeatureAtPixel(e.pixel,function(e,t){return s.featureFilter_.call(null,e,t)?(r=e,i=t,!0):(r=i=null,!1)},{hitTolerance:this.get("hitTolerance"),layerFilter:s.layerFilter_});if(n&&this.dispatchEvent({type:"hover",feature:r,layer:i,coordinate:e.coordinate,pixel:e.pixel,map:e.map,originalEvent:e.originalEvent,dragging:e.dragging}),this.feature_===r&&this.layer_===i||(this.feature_=r,this.layer_=i,r?this.dispatchEvent({type:"enter",feature:r,layer:i,coordinate:e.coordinate,pixel:e.pixel,map:e.map,originalEvent:e.originalEvent,dragging:e.dragging}):this.dispatchEvent({type:"leave",coordinate:e.coordinate,pixel:e.pixel,map:e.map,originalEvent:e.originalEvent,dragging:e.dragging})),this.cursor_){var o=t.getTargetElement().style;n?o.cursor!=this.cursor_&&(this.previousCursor_=o.cursor,(0,a.default).setCursor(t,this.cursor_)):void 0!==this.previousCursor_&&((0,a.default).setCursor(t,this.previousCursor_),this.previousCursor_=void 0)}}}}}),n("lbwk5",function(e,r){t(e.exports,"default",()=>T);var i=s("6vpLi"),a=s("gzr8q"),n=s("e7Hhj"),o=s("6v9hi"),l=s("lMv07"),u=s("eZiYk"),h=s("cBppj"),c=s("cLiWE"),d=s("5UlEr"),p=s("DXhxE"),f=s("iKsmi"),m=s("1RZpL"),g=s("2x3of"),y=s("c614M"),v=s("l1YgS"),_=s("eRyYI"),x=s("4Esdr"),b=s("ikPfL"),S=s("6ClR3"),w=s("fRAGe"),E=s("8qGq9");class A extends i.default{constructor(){super()}}A.layerFormats=[n.default,o.default,u.default,h.default,l.default,d.default,c.default,v.default,g.default,y.default,_.default,x.default,b.default,S.default,w.default,E.default],A.prototype.read=function(e,t){(0,m.upgradeCarte)(t);let r=e.map;return e.layerId_=0,r.set("title",t.param.title||t.param.titre||""),r.set("description",t.param.description||""),this.readView(e,t),r.getLayers().clear(),this.readLayers(t,e.get("key")).forEach(e=>r.addLayer(e)),this.readControls(e,t),e.getSymbolLib().clear(),t.symbolLib.forEach(t=>{/Point|Polygon|LineString/.test(t.type)&&e.addSymbolLib(t)}),e},A.prototype.readView=function(e,t){let r=e.map.getView();r.setCenter((0,a.fromLonLat)([t.param.lon,t.param.lat],r.getProjection())),r.setZoom(t.param.zoom),r.setRotation(t.param.rot);let i=e.getControl("permalink").getUrlReplace(),s=e.getControl("permalink");s.setPosition(!0),e.map.set("noMouseWheel",s.hasUrlParam("noZoom")),i||e.getControl("permalink").setUrlReplace(!1)},A.prototype.readControls=function(e,t){let r=t.controls;for(let t in r)e.showControl(t,r[t]);new p.default(e.getControl("mousePosition"),r.mousePosition),new f.default(e.getControl("legend"),r.legend,!1,e.getMap().getLayers().getArray()),e.showControl("legend",r.legend.visible)},A.prototype.readLayers=function(e,t){let r=[];return e.layers.forEach(e=>{let i=this.readLayer(e,t);i&&r.push(i)}),r},A.prototype.readLayer=function(e,t){for(let r=0;r<A.layerFormats.length;r++){let i=(new A.layerFormats[r]).read(e,t);if(i)return i}return null},A.prototype.writeLayers=function(e,t){let r=[];return e.forEach(e=>{let i=this.writeLayer(e,t);i?r.push(i):console.warn("Layer ["+e.get("type")+":"+e.get("title")+"]  has no writer...")}),r},A.prototype.writeLayer=function(e,t){for(let r=0;r<A.layerFormats.length;r++){let i=(new A.layerFormats[r]).write(e,t);if(i)return i}return null},A.prototype.write=function(e,t){let r={param:{titre:e.get("title"),description:e.get("description")}},i=e.getMap().getView(),s=(0,a.toLonLat)(i.getCenter());return r.param.lon=s[0],r.param.lat=s[1],r.param.zoom=i.getZoom(),r.param.rot=i.getRotation(),r.param.controlParams={zoomBtn:e.hasControl("zoom"),scaleLine:e.hasControl("scaleLine"),pSearchBar:e.hasControl("searchBar"),legend:e.hasControl("legend"),coords:e.hasControl("mousePosition"),selectLayer:e.hasControl("layerSwitcher"),geoloc:e.hasControl("locate"),profil:e.hasControl("profil"),printDlg:e.hasControl("printDlg")},r.param.proj=new(0,p.default)().write(e.getControl("mousePosition")),r.legende=(new(0,f.default)).write(e.getControl("legend")),r.layers=this.writeLayers(e.getMap().getLayers(),t),r.symbolLib=[],e.getSymbolLib().forEach(e=>{r.symbolLib.push(e.stringify())}),r},window.format=new A;var T=A}),n("6vpLi",function(e,r){t(e.exports,"default",()=>n);var i=s("fnScq");class a extends i.default{constructor(){super()}}a.prototype.read=function(){return console.warn("[Abstract] read method not implemented..."),null},a.prototype.write=function(){return console.warn("[Abstract] write method not implemented..."),""};var n=a}),n("e7Hhj",function(e,r){t(e.exports,"default",()=>o);var i=s("bqoF2"),a=s("5TDW7");class n extends a.default{constructor(){super()}}n.prototype.read=function(e,t){if("Geoportail"===e.type){switch(e.layer){case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD":case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.ROUTIER":case"GEOGRAPHICALGRIDSYSTEMS.PLANIGN":e.layer="GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.NIVEAUXGRIS":e.layer="GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",e.grayscale=!0}try{let r=new i.default({gppKey:t,layer:e.layer,preload:10});return this.readOptions(r,e),r}catch(e){return console.error(e.message),!1}}},n.prototype.write=function(e){if("Geoportail"!==e.get("type"))return!1;var t=this.writeOptions(e);return t.layer=e.get("layer"),t};var o=n}),n("bqoF2",function(e,r){t(e.exports,"default",()=>n);var i=s("6gELa");s("2C2LU");class a extends i.default{constructor(e,t){e.gppKey=e.key="",super(e,t)}}var n=a}),n("6gELa",function(e,r){t(e.exports,"default",()=>h);var i=s("eEuqc"),a=s("kUWI9"),n=s("fkmMz"),o=s("gzr8q"),l=s("k7cyy"),u=class extends i.default{constructor(e,t,r){t=t||{},r=r||{},"string"!=typeof e&&(r=t||{},e=(t=e).layer);var i=t.maxZoom;t.source&&(e=t.source.getLayer(),t.gppKey=t.source.getGPPKey());var a=window.geoportailConfig&&(window.geoportailConfig.capabilities[t.gppKey||t.key]||window.geoportailConfig.capabilities.default)||u.capabilities;for(var s in(a=a[e])||(a=u.capabilities[e]),a||(a={title:e,originators:[]},console.error('ol.layer.Geoportail: no layer definition for "'+e+'"\nTry to use ol/layer/Geoportail~loadCapabilities() to get it.')),a)void 0===r[s]&&(r[s]=a[s]);(t.gppKey||t.key)&&(r.gppKey=t.gppKey||t.key),t.source||(t.source=new l.default(e,r)),t.title||(t.title=a.title),t.name||(t.name=e),t.layer=e,t.queryable||(t.queryable=a.queryable),t.desc||(t.desc=a.desc),!t.extent&&a.bbox&&a.bbox[0]>-170&&a.bbox[2]<170&&(t.extent=(0,o.transformExtent)(a.bbox,"EPSG:4326",t.projection||"EPSG:3857")),t.maxZoom=i,!t.maxResolution&&r.minZoom&&(t.source.getTileGrid().minZoom-=r.minZoom>1?2:1,t.maxResolution=t.source.getTileGrid().getResolution(t.source.getTileGrid().minZoom),t.source.getTileGrid().minZoom=r.minZoom),super(t),this._originators=a.originators}static register(e,t){u.capabilities[e]=t}static isRegistered(e){return u.capabilities[e]&&u.capabilities[e].key}static loadCapabilities(e){var t=function(){},r=function(){},i=function(){};this.getCapabilities(e).then(function(e){u.capabilities=e,t(e)}).catch(function(e){r(e)}).finally(function(e){i(e)});var a={then:function(e){return"function"==typeof e&&(t=e),a},catch:function(e){return"function"==typeof e&&(r=e),a},finally:function(e){return"function"==typeof e&&(i=e),a}};return a}static getCapabilities(e){"gpf"===e&&(e=void 0);var t=function(){},r=function(){},i=function(){},s=e?"https://data.geopf.fr/private/wmts":"https://data.geopf.fr/wmts",o=s+"?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetCapabilities";e&&(o+="&apikey="+e),(0,n.default).get({url:o,dataType:"TEXT",error:function(e){r(e),i({})},success:function(r){var n=new DOMParser().parseFromString(r,"text/xml");n=n.getElementsByTagName("Layer");for(var o=(r=new a.default().read(r)).Contents.Layer,l={},h={},c=0;c<o.length;c++){var d=o[c],p=function(e){for(var t={min:parseFloat(e[0].TileMatrix),max:parseFloat(e[0].TileMatrix)},r=1;r<e.length;r++)t.min=Math.min(t.min,parseFloat(e[r].TileMatrix)),t.max=Math.max(t.max,parseFloat(e[r].TileMatrix));return t}(d.TileMatrixSetLink[0].TileMatrixSetLimits),f=function(e){for(var t=0;t<u.themes.length;t++)if(u.themes[t].rex.test(e))return u.themes[t].theme;return"autre"}(d.Identifier);h[f]||(h[f]={});var m=[];d.Style&&d.Style.forEach(function(e){e.LegendURL&&m.push(e.LegendURL[0].href)}),h[f][d.Identifier]=l[d.Identifier]={layer:d.Identifier,key:e,theme:f,desc:d.Abstract,server:s,bbox:d.WGS84BoundingBox,format:d.Format[0],minZoom:p.min,maxZoom:p.max,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:n[c].getElementsByTagName("InfoFormat").length>0,style:d.Style&&d.Style.length?d.Style[0].Identifier:"normal",tilematrix:"PM",title:d.Title,legend:m}}t(l,h),i(l,h)}});var l={then:function(e){return"function"==typeof e&&(t=e),l},catch:function(e){return"function"==typeof e&&(r=e),l},finally:function(e){return"function"==typeof e&&(i=e),l}};return l}};u.capabilities={"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2":{layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",theme:"cartes",desc:"Cartographie multi-échelles sur le territoire national, issue des bases de données vecteur de l’IGN, mis à jour régulièrement et réalisée selon un processus entièrement automatisé.",server:"https://data.geopf.fr/wmts",bbox:[-175,-85,175,85],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Plan IGN v2"},"CADASTRALPARCELS.PARCELLAIRE_EXPRESS":{layer:"CADASTRALPARCELS.PARCELLAIRE_EXPRESS",theme:"parcellaire",desc:"Plan cadastral informatisé vecteur de la DGFIP édition Juillet 2023.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PCI vecteur"},"ORTHOIMAGERY.ORTHOPHOTOS":{layer:"ORTHOIMAGERY.ORTHOPHOTOS",theme:"ortho",desc:"Photographies aériennes",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/jpeg",minZoom:0,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Photographies aériennes"},"GEOGRAPHICALGRIDSYSTEMS.MAPS":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS",theme:"cartes",desc:"Cartes IGN",server:"https://data.geopf.fr/private/wmts",bbox:[-180,-68.1389,180,80],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartes IGN"},"ADMINEXPRESS-COG-CARTO.LATEST":{layer:"ADMINEXPRESS-COG-CARTO.LATEST",theme:"administratif",desc:"Limites administratives Express COG code officiel géographique 2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"ADMINEXPRESS COG CARTO"},"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN":{layer:"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN",theme:"cartes",desc:"Carte des zones ayant une valeur de pente supérieure à 30°-35°-40°-45° d'après la BD ALTI au pas de 5m",server:"https://data.geopf.fr/wmts",bbox:[-63.1614,-21.5446,56.0018,51.0991],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte des pentes"},"ELEVATION.SLOPES":{layer:"ELEVATION.SLOPES",theme:"altimetrie",desc:"La couche altitude se compose d'un MNT (Modèle Numérique de Terrain) affiché en teintes hypsométriques et issu de la BD ALTI®.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:6,maxZoom:14,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Altitude"},"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1":{key:"cartes",server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1",title:"Plan IGN j+1",format:"image/png",style:"normal",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:18,bbox:[-179.5,-75,179.5,75],desc:"Plan IGN j+1",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information géographique et forestière",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:18,constraint:[{minZoom:0,maxZoom:18,bbox:[-179,-80,179,80]}]}}},"TRANSPORTNETWORKS.ROADS":{layer:"TRANSPORTNETWORKS.ROADS",theme:"topographie",desc:"Affichage du réseau routier français et européen.",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Routes"},"GEOGRAPHICALNAMES.NAMES":{layer:"GEOGRAPHICALNAMES.NAMES",theme:"topographie",desc:"Affichage des noms des villes, villages, lieux-dits ...",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Dénominations géographiques",legend:["https://data.geopf.fr/annexes/ressources/legendes/LEGEND.jpg"]},"CARTES.NATURALEARTH":{layer:"CARTES.NATURALEARTH",theme:"cartes",desc:"Carte générale du monde politique avec les frontières et capitales d'Etat, les entités administratives secondaires, villes principales, fleuves, lacs et océans. Edition : 1.4.0",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:1,maxZoom:9,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Monde Natural Earth",legend:["https://data.geopf.fr/annexes/ressources/legendes/LEGEND.jpg"]},"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW",key:"",theme:"cartes",desc:"Carte Mondiale pour la mini-vue",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:1,maxZoom:8,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte Mondiale pour la mini-vue",legend:["https://data.geopf.fr/annexes/ressources/legendes/LEGEND.jpg"]}},u.themes=[{theme:"edugeo",rex:/EDUGEO|PVA_IGN_zone-marais|VERDUN|DOUAUMONT/},{theme:"cartes",rex:/GEOGRAPHICALGRIDSYSTEMS|CARTES|SCAN/},{theme:"energie",rex:/CHALEUR|CHAUD|FROID|METHAN|CONSO|ENR|ELECTRIQUE|EOLIEN|SOLAIRE|PRODUCTIBLE|GEOTHERM|PROD\.INSTALLATION|POTENTIEL\.HYDRO/},{theme:"risque",rex:/SISMIC|RISKZONE/},{theme:"agriculture",rex:/AGRICULTURE|PAC/},{theme:"altimetrie",rex:/ELEVATION|SLOPE|ISOHYPSE/},{theme:"parcellaire",rex:/PARCELS|Parcellaire|RPG|PCRS|PCI/},{theme:"administratif",rex:/ADMIN/},{theme:"ocsge",rex:/OCSGE|CoSIA/},{theme:"clc",rex:/\.CLC|\.CHA/},{theme:"environnement",rex:/PROTECTEDAREAS|FORETS|DEBROUSSAILLEMENT|LANDCOVER|PROTECTEDSITES|CHASSE|INPE|OFB/},{theme:"topographie",rex:/BDCARTO|PARKING|RAILWAYS|BUILDINGS|RUNWAYS|UTILITYANDGOVERNMENTALSERVICES|GEOGRAPHICALNAMES\.NAMES|HYDROGRAPHY|TRANSPORTNETWORKS\.ROADS$|hedge.hedge/},{theme:"transport",rex:/TRANSPORT|SECUROUTE|AUTOROUT/},{theme:"economie",rex:/INSEE|AREAMANAGEMENT|PINEL|PRIORITYDISCTRICT/},{theme:"agriculture",rex:/LANDUSE|PRAIRIES/},{theme:"satellite",rex:/ORTHO-SAT|SPOT5|RAPIDEYE/},{theme:"orthohisto",rex:/ORTHOPHOTOS\d|ORTHO-EXPRESS-\d/},{theme:"ortho",rex:/ORTHOIMAGERY/}];var h=u}),n("kUWI9",function(e,r){t(e.exports,"default",()=>T);var i=s("jZquI"),a=s("fbciu"),n=s("4cjlx"),o=s("dfksr"),l=s("3VMq2"),u=s("5kLwh");let h=[null,"http://www.opengis.net/wmts/1.0"],c=[null,"http://www.opengis.net/ows/1.1"],d=(0,a.makeStructureNS)(h,{Contents:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},f,e,t)})});class p extends o.default{constructor(){super(),this.owsParser_=new n.default}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let r=this.owsParser_.readFromNode(e);return r?(r.version=t,(r=(0,a.pushParseAndPop)(r,d,e,[]))||null):null}}let f=(0,a.makeStructureNS)(h,{Layer:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},m,e,t)}),TileMatrixSet:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},S,e,t)})}),m=(0,a.makeStructureNS)(h,{Style:(0,a.makeObjectPropertyPusher)(function(e,t){let r=(0,a.pushParseAndPop)({},g,e,t);if(!r)return;let i="true"===e.getAttribute("isDefault");return r.isDefault=i,r}),Format:(0,a.makeObjectPropertyPusher)(u.readString),TileMatrixSetLink:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},y,e,t)}),Dimension:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},x,e,t)}),ResourceURL:(0,a.makeObjectPropertyPusher)(function(e,t){let r=e.getAttribute("format"),i=e.getAttribute("template"),a=e.getAttribute("resourceType"),s={};return r&&(s.format=r),i&&(s.template=i),a&&(s.resourceType=a),s})},(0,a.makeStructureNS)(c,{Title:(0,a.makeObjectPropertySetter)(u.readString),Abstract:(0,a.makeObjectPropertySetter)(u.readString),WGS84BoundingBox:(0,a.makeObjectPropertySetter)(E),BoundingBox:(0,a.makeObjectPropertyPusher)(function(e,t){let r=e.getAttribute("crs"),s=(0,a.pushParseAndPop)([],b,e,t);if(2==s.length)return{extent:(0,i.boundingExtent)(s),crs:r}}),Identifier:(0,a.makeObjectPropertySetter)(u.readString)})),g=(0,a.makeStructureNS)(h,{LegendURL:(0,a.makeObjectPropertyPusher)(function(e,t){let r={};return r.format=e.getAttribute("format"),r.href=(0,l.readHref)(e),r})},(0,a.makeStructureNS)(c,{Title:(0,a.makeObjectPropertySetter)(u.readString),Identifier:(0,a.makeObjectPropertySetter)(u.readString)})),y=(0,a.makeStructureNS)(h,{TileMatrixSet:(0,a.makeObjectPropertySetter)(u.readString),TileMatrixSetLimits:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)([],v,e,t)})}),v=(0,a.makeStructureNS)(h,{TileMatrixLimits:(0,a.makeArrayPusher)(function(e,t){return(0,a.pushParseAndPop)({},_,e,t)})}),_=(0,a.makeStructureNS)(h,{TileMatrix:(0,a.makeObjectPropertySetter)(u.readString),MinTileRow:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),MaxTileRow:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),MinTileCol:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),MaxTileCol:(0,a.makeObjectPropertySetter)(u.readPositiveInteger)}),x=(0,a.makeStructureNS)(h,{Default:(0,a.makeObjectPropertySetter)(u.readString),Value:(0,a.makeObjectPropertyPusher)(u.readString)},(0,a.makeStructureNS)(c,{Identifier:(0,a.makeObjectPropertySetter)(u.readString)})),b=(0,a.makeStructureNS)(c,{LowerCorner:(0,a.makeArrayPusher)(A),UpperCorner:(0,a.makeArrayPusher)(A)}),S=(0,a.makeStructureNS)(h,{WellKnownScaleSet:(0,a.makeObjectPropertySetter)(u.readString),TileMatrix:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},w,e,t)})},(0,a.makeStructureNS)(c,{SupportedCRS:(0,a.makeObjectPropertySetter)(u.readString),Identifier:(0,a.makeObjectPropertySetter)(u.readString),BoundingBox:(0,a.makeObjectPropertySetter)(E)})),w=(0,a.makeStructureNS)(h,{TopLeftCorner:(0,a.makeObjectPropertySetter)(A),ScaleDenominator:(0,a.makeObjectPropertySetter)(u.readDecimal),TileWidth:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),TileHeight:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),MatrixWidth:(0,a.makeObjectPropertySetter)(u.readPositiveInteger),MatrixHeight:(0,a.makeObjectPropertySetter)(u.readPositiveInteger)},(0,a.makeStructureNS)(c,{Identifier:(0,a.makeObjectPropertySetter)(u.readString)}));function E(e,t){let r=(0,a.pushParseAndPop)([],b,e,t);if(2==r.length)return(0,i.boundingExtent)(r)}function A(e,t){let r=(0,u.readString)(e).split(/\s+/);if(!r||2!=r.length)return;let i=+r[0],a=+r[1];if(!(isNaN(i)||isNaN(a)))return[i,a]}var T=p}),n("fbciu",function(e,r){let i,a;t(e.exports,"XML_SCHEMA_INSTANCE_URI",()=>o),t(e.exports,"createElementNS",()=>l),t(e.exports,"getDocument",()=>P),t(e.exports,"getAllTextContent",()=>u),t(e.exports,"isDocument",()=>h),t(e.exports,"parse",()=>c),t(e.exports,"makeArrayExtender",()=>d),t(e.exports,"makeArrayPusher",()=>p),t(e.exports,"makeReplacer",()=>f),t(e.exports,"makeObjectPropertyPusher",()=>m),t(e.exports,"makeObjectPropertySetter",()=>g),t(e.exports,"makeChildAppender",()=>y),t(e.exports,"makeArraySerializer",()=>v),t(e.exports,"makeSimpleNodeFactory",()=>_),t(e.exports,"OBJECT_PROPERTY_NODE_FACTORY",()=>x),t(e.exports,"makeSequence",()=>b),t(e.exports,"makeStructureNS",()=>S),t(e.exports,"parseNode",()=>w),t(e.exports,"pushParseAndPop",()=>E),t(e.exports,"pushSerializeAndPop",()=>T),t(e.exports,"getXMLSerializer",()=>C);var n=s("kBSVF");let o="http://www.w3.org/2001/XMLSchema-instance";function l(e,t){return P().createElementNS(e,t)}function u(e,t){return(function e(t,r,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)r?i.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(t.nodeValue);else{let a;for(a=t.firstChild;a;a=a.nextSibling)e(a,r,i)}return i})(e,t,[]).join("")}function h(e){return"documentElement"in e}function c(e){return new DOMParser().parseFromString(e,"application/xml")}function d(e,t){return function(r,i){let a=e.call(t??this,r,i);if(void 0!==a){let e=i[i.length-1];(0,n.extend)(e,a)}}}function p(e,t){return function(r,i){let a=e.call(t??this,r,i);void 0!==a&&i[i.length-1].push(a)}}function f(e,t){return function(r,i){let a=e.call(t??this,r,i);void 0!==a&&(i[i.length-1]=a)}}function m(e,t,r){return function(i,a){let s=e.call(r??this,i,a);if(void 0!==s){let e;let r=a[a.length-1],n=void 0!==t?t:i.localName;n in r?e=r[n]:(e=[],r[n]=e),e.push(s)}}}function g(e,t,r){return function(i,a){let s=e.call(r??this,i,a);void 0!==s&&(a[a.length-1][void 0!==t?t:i.localName]=s)}}function y(e,t){return function(r,i,a){e.call(t??this,r,i,a),a[a.length-1].node.appendChild(r)}}function v(e,t){let r,i;return function(t,a,s){if(void 0===r){r={};let a={};a[t.localName]=e,r[t.namespaceURI]=a,i=_(t.localName)}A(r,i,a,s)}}function _(e,t){return function(r,i,a){let s=i[i.length-1].node,n=e;return void 0===n&&(n=a),l(void 0!==t?t:s.namespaceURI,n)}}let x=_();function b(e,t){let r=t.length,i=Array(r);for(let a=0;a<r;++a)i[a]=e[t[a]];return i}function S(e,t,r){let i,a;for(i=0,r=void 0!==r?r:{},a=e.length;i<a;++i)r[e[i]]=t;return r}function w(e,t,r,i){let a;for(a=t.firstElementChild;a;a=a.nextElementSibling){let t=e[a.namespaceURI];if(void 0!==t){let e=t[a.localName];void 0!==e&&e.call(i,a,r)}}}function E(e,t,r,i,a){return i.push(e),w(t,r,i,a),i.pop()}function A(e,t,r,i,a,s){let n,o;let l=(void 0!==a?a:r).length;for(let u=0;u<l;++u)void 0!==(n=r[u])&&void 0!==(o=t.call(s,n,i,void 0!==a?a[u]:void 0))&&e[o.namespaceURI][o.localName].call(s,o,n,i)}function T(e,t,r,i,a,s,n){return a.push(e),A(t,r,i,a,s,n),a.pop()}function C(){return void 0===i&&"undefined"!=typeof XMLSerializer&&(i=new XMLSerializer),i}function P(){return void 0===a&&"undefined"!=typeof document&&(a=document.implementation.createDocument("","",null)),a}}),n("4cjlx",function(e,r){t(e.exports,"default",()=>E);var i=s("fbciu"),a=s("dfksr"),n=s("3VMq2"),o=s("5kLwh");let l=[null,"http://www.opengis.net/ows/1.1"],u=(0,i.makeStructureNS)(l,{ServiceIdentification:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},S,e,t)}),ServiceProvider:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},w,e,t)}),OperationsMetadata:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},v,e,t)})});class h extends a.default{constructor(){super()}readFromNode(e){return(0,i.pushParseAndPop)({},u,e,[])||null}}let c=(0,i.makeStructureNS)(l,{DeliveryPoint:(0,i.makeObjectPropertySetter)(o.readString),City:(0,i.makeObjectPropertySetter)(o.readString),AdministrativeArea:(0,i.makeObjectPropertySetter)(o.readString),PostalCode:(0,i.makeObjectPropertySetter)(o.readString),Country:(0,i.makeObjectPropertySetter)(o.readString),ElectronicMailAddress:(0,i.makeObjectPropertySetter)(o.readString)}),d=(0,i.makeStructureNS)(l,{Value:(0,i.makeObjectPropertyPusher)(function(e,t){return(0,o.readString)(e)})}),p=(0,i.makeStructureNS)(l,{AllowedValues:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},d,e,t)})}),f=(0,i.makeStructureNS)(l,{Phone:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},_,e,t)}),Address:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},c,e,t)})}),m=(0,i.makeStructureNS)(l,{HTTP:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},g,e,t)})}),g=(0,i.makeStructureNS)(l,{Get:(0,i.makeObjectPropertyPusher)(function(e,t){let r=(0,n.readHref)(e);if(r)return(0,i.pushParseAndPop)({href:r},x,e,t)}),Post:void 0}),y=(0,i.makeStructureNS)(l,{DCP:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},m,e,t)})}),v=(0,i.makeStructureNS)(l,{Operation:function(e,t){let r=e.getAttribute("name"),a=(0,i.pushParseAndPop)({},y,e,t);a&&(t[t.length-1][r]=a)}}),_=(0,i.makeStructureNS)(l,{Voice:(0,i.makeObjectPropertySetter)(o.readString),Facsimile:(0,i.makeObjectPropertySetter)(o.readString)}),x=(0,i.makeStructureNS)(l,{Constraint:(0,i.makeObjectPropertyPusher)(function(e,t){let r=e.getAttribute("name");if(r)return(0,i.pushParseAndPop)({name:r},p,e,t)})}),b=(0,i.makeStructureNS)(l,{IndividualName:(0,i.makeObjectPropertySetter)(o.readString),PositionName:(0,i.makeObjectPropertySetter)(o.readString),ContactInfo:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},f,e,t)})}),S=(0,i.makeStructureNS)(l,{Abstract:(0,i.makeObjectPropertySetter)(o.readString),AccessConstraints:(0,i.makeObjectPropertySetter)(o.readString),Fees:(0,i.makeObjectPropertySetter)(o.readString),Title:(0,i.makeObjectPropertySetter)(o.readString),ServiceTypeVersion:(0,i.makeObjectPropertySetter)(o.readString),ServiceType:(0,i.makeObjectPropertySetter)(o.readString)}),w=(0,i.makeStructureNS)(l,{ProviderName:(0,i.makeObjectPropertySetter)(o.readString),ProviderSite:(0,i.makeObjectPropertySetter)(n.readHref),ServiceContact:(0,i.makeObjectPropertySetter)(function(e,t){return(0,i.pushParseAndPop)({},b,e,t)})});var E=h}),n("dfksr",function(e,r){t(e.exports,"default",()=>n);var i=s("lVQul"),a=s("fbciu"),n=class{read(e){if(!e)return null;if("string"==typeof e){let t=(0,a.parse)(e);return this.readFromDocument(t)}return(0,a.isDocument)(e)?this.readFromDocument(e):this.readFromNode(e)}readFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null}readFromNode(e){(0,i.abstract)()}}}),n("3VMq2",function(e,r){t(e.exports,"readHref",()=>i);function i(e){return e.getAttributeNS("http://www.w3.org/1999/xlink","href")}}),n("5kLwh",function(e,r){t(e.exports,"readBoolean",()=>n),t(e.exports,"readBooleanString",()=>o),t(e.exports,"readDateTime",()=>l),t(e.exports,"readDecimal",()=>u),t(e.exports,"readDecimalString",()=>h),t(e.exports,"readPositiveInteger",()=>c),t(e.exports,"readNonNegativeIntegerString",()=>d),t(e.exports,"readString",()=>p),t(e.exports,"writeBooleanTextNode",()=>f),t(e.exports,"writeStringTextNode",()=>_),t(e.exports,"writeCDATASection",()=>m),t(e.exports,"writeDateTimeTextNode",()=>g),t(e.exports,"writeDecimalTextNode",()=>y),t(e.exports,"writeNonNegativeIntegerTextNode",()=>v);var i=s("7f9mA"),a=s("fbciu");function n(e){return o((0,a.getAllTextContent)(e,!1))}function o(e){let t=/^\s*(true|1)|(false|0)\s*$/.exec(e);if(t)return void 0!==t[1]}function l(e){let t=Date.parse((0,a.getAllTextContent)(e,!1));return isNaN(t)?void 0:t/1e3}function u(e){return h((0,a.getAllTextContent)(e,!1))}function h(e){let t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);if(t)return parseFloat(t[1])}function c(e){return d((0,a.getAllTextContent)(e,!1))}function d(e){let t=/^\s*(\d+)\s*$/.exec(e);if(t)return parseInt(t[1],10)}function p(e){return(0,a.getAllTextContent)(e,!1).trim()}function f(e,t){_(e,t?"1":"0")}function m(e,t){e.appendChild((0,a.getDocument)().createCDATASection(t))}function g(e,t){let r=new Date(1e3*t),s=r.getUTCFullYear()+"-"+(0,i.padNumber)(r.getUTCMonth()+1,2)+"-"+(0,i.padNumber)(r.getUTCDate(),2)+"T"+(0,i.padNumber)(r.getUTCHours(),2)+":"+(0,i.padNumber)(r.getUTCMinutes(),2)+":"+(0,i.padNumber)(r.getUTCSeconds(),2)+"Z";e.appendChild((0,a.getDocument)().createTextNode(s))}function y(e,t){let r=t.toPrecision();e.appendChild((0,a.getDocument)().createTextNode(r))}function v(e,t){let r=t.toString();e.appendChild((0,a.getDocument)().createTextNode(r))}function _(e,t){e.appendChild((0,a.getDocument)().createTextNode(t))}}),n("k7cyy",function(e,r){t(e.exports,"default",()=>h);var i=s("gAUZM"),a=s("jZquI"),n=s("sxATa"),o=s("gzr8q"),l=s("fkmMz"),u=class extends i.default{constructor(e,t){t=t||{},e.layer&&(e=(t=e).layer);for(var r=[],i=[],s=(0,a.getWidth)((0,o.get)("EPSG:3857").getExtent())/256,l=0;l<=(t.maxZoom?t.maxZoom:20);l++)r[l]=l,i[l]=s/Math.pow(2,l);var h=new n.default({origin:[-20037508,20037508],resolutions:i,matrixIds:r});h.minZoom=t.minZoom?t.minZoom:0;var c=[u.defaultAttribution];t.attributions&&(c=t.attributions);var d=t.server||"https://data.geopf.fr/wmts",p=t.gppKey||t.key||"";super({url:u.getServiceURL(d,p),layer:e,matrixSet:"PM",format:t.format?t.format:"image/jpeg",projection:"EPSG:3857",tileGrid:h,style:t.style?t.style:"normal",attributions:c,crossOrigin:void 0===t.crossOrigin?"anonymous":t.crossOrigin,wrapX:!1!==t.wrapX}),this._server=d,this._gppKey=p,t.authentication&&this.setTileLoadFunction(u.tileLoadFunctionWithAuthentication(t.authentication,this.getFormat()))}static tileLoadFunctionWithAuthentication(e,t){if(e)return function(r,i){var a=new XMLHttpRequest;a.open("GET",i),a.setRequestHeader("Authorization","Basic "+e),a.responseType="arraybuffer",a.onload=function(){var e=new Uint8Array(this.response),i=new Blob([e],{type:t}),a=(window.URL||window.webkitURL).createObjectURL(i);r.getImage().src=a},a.onerror=function(){r.getImage().src=""},a.send()}}serviceURL(){return u.getServiceURL(this._server,this._gppKey)}getGPPKey(){return this._gppKey}setGPPKey(e,t){this._gppKey=e;var r=this.serviceURL();this.setTileUrlFunction(function(){var e=u.prototype.getTileUrlFunction().apply(this,arguments);return e?r+"?"+e.split("?")[1]:e}),t&&this.setTileLoadFunction(u.tileLoadFunctionWithAuthentication(t,this.getFormat()))}getFeatureInfoUrl(e,t,r,i){i=i||{},r||(r=this.getProjection());var a=this.tileGrid.getTileCoordForCoordAndResolution(e,t),s=this.getTileUrlFunction()(a,1,r);if(!s)return s;var n=this.tileGrid.getResolution(a[0]),o=this.tileGrid.getTileCoordExtent(a),l=Math.floor((e[0]-o[0])/(n/1)),u=Math.floor((o[3]-e[1])/(n/1));return s.replace(/Request=GetTile/i,"Request=getFeatureInfo")+"&INFOFORMAT="+(i.INFO_FORMAT||"text/plain")+"&I="+l+"&J="+u}getFeatureInfo(e,t,r){var i=this.getFeatureInfoUrl(e,t,null,r);(0,l.default).get({url:i,dataType:r.format||"text/plain",options:{encode:!1},success:function(e){r.callback&&r.callback(e)},error:r.error||function(){}})}};u.defaultAttribution='<a href="https://geoservices.ign.fr/">Géoservices</a> &copy; <a href="http://www.ign.fr/">IGN-France</a>',u.getServiceURL=function(e,t){return("gpf"===t&&(t=""),e||(e=t?"https://data.geopf.fr/private/wmts":"https://data.geopf.fr/wmts"),/geopf/.test(e))?t?e+"?apikey="+t:e:e.replace(/^(https?:\/\/[^/]*)(.*)$/,"$1/"+t+"$2")};var h=u}),n("gAUZM",function(e,r){t(e.exports,"default",()=>l),s("jZquI"),s("gzr8q"),s("sxATa");var i=s("ga5CQ"),a=s("9AVh1"),n=s("42VYg");class o extends n.default{constructor(e){let t=void 0!==e.requestEncoding?e.requestEncoding:"KVP",r=e.tileGrid,s=e.urls;void 0===s&&void 0!==e.url&&(s=(0,a.expandUrl)(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:s,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.version_=void 0!==e.version?e.version:"1.0.0",this.format_=void 0!==e.format?e.format:"image/jpeg",this.dimensions_=void 0!==e.dimensions?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),s&&s.length>0&&(this.tileUrlFunction=(0,i.createFromTileUrlFunctions)(s.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;let t=e.join("\n");this.setTileUrlFunction((0,i.createFromTileUrlFunctions)(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){let e=this.urls?this.urls.slice(0):[];for(let t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){let t=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==t&&Object.assign(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e="KVP"==t?(0,a.appendParams)(e,r):e.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase() in r?r[t.toLowerCase()]:e});let i=this.tileGrid,s=this.dimensions_;return function(r,n,o){if(!r)return;let l={TileMatrix:i.getMatrixId(r[0]),TileCol:r[1],TileRow:r[2]};Object.assign(l,s);let u=e;return"KVP"==t?(0,a.appendParams)(u,l):u.replace(/\{(\w+?)\}/g,function(e,t){return encodeURIComponent(l[t])})}}}var l=o}),n("sxATa",function(e,r){t(e.exports,"default",()=>o),t(e.exports,"createFromCapabilitiesMatrixSet",()=>l);var i=s("gzr8q"),a=s("co8nU");class n extends a.default{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}var o=n;function l(e,t,r){let a=[],s=[],o=[],l=[],u=[];r=void 0!==r?r:[];let h="TileMatrix",c="Identifier",d="ScaleDenominator",p="TopLeftCorner",f=e.SupportedCRS,m=(0,i.get)(f),g=m.getMetersPerUnit(),y=m.getAxisOrientation().startsWith("ne");return e[h].sort(function(e,t){return t[d]-e[d]}),e[h].forEach(function(t){if(!(r.length>0)||r.find(function(r){return t[c]==r[h]||!t[c].includes(":")&&e[c]+":"+t[c]===r[h]})){s.push(t[c]);let e=28e-5*t[d]/g,r=t.TileWidth,i=t.TileHeight;y?o.push([t[p][1],t[p][0]]):o.push(t[p]),a.push(e),l.push(r==i?r:[r,i]),u.push([t.MatrixWidth,t.MatrixHeight])}}),new n({extent:t,origins:o,resolutions:a,matrixIds:s,tileSizes:l,sizes:u})}}),n("2C2LU",function(e,t){var r=s("bo74g");window.geoportailConfig||(window.geoportailConfig={capabilities:{}}),window.geoportailConfig.capabilities.default={"GEOGRAPHICALGRIDSYSTEMS.MAPS":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS",key:r.default.gppKey,theme:"cartes",desc:"Cartes IGN",server:"https://data.geopf.fr/private/wmts",bbox:[-180,-68.1389,180,80],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartes IGN"},"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-OACI":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-OACI",key:r.default.gppKey,theme:"cartes",desc:"Les cartes OACI (Organisation de l'aviation civile internationale) ont été conçues pour le vol à vue (VFR : Visual Flights Rules). Elles proposent des informations aéronautiques fournies par le Service de l'information aéronautique (SIA) de la Direction générale de l'aviation civile (DGAC).",server:"https://data.geopf.fr/private/wmts",bbox:[-5.99644,40.3893,11.146,51.4441],format:"image/jpeg",minZoom:6,maxZoom:11,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"carte OACI-VFR 2023"},"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN25TOUR":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN25TOUR",key:r.default.gppKey,theme:"cartes",desc:"La carte topographique représente avec précision le relief, symbolisé par des courbes de niveaux, ainsi que les détails du terrain : routes, sentiers, constructions, bois, arbre isolé, rivière, source... </br>En France, la carte topographique de base est réalisée par l'IGN. Le SCAN 25 Touristique comprend les pictogrammes du thème tourisme de la carte de base.",server:"https://data.geopf.fr/private/wmts",bbox:[-178.206,-46.5029,77.6492,51.1751],format:"image/jpeg",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte topographique (IGN Scan25)"},"GEOGRAPHICALGRIDSYSTEMS.CASSINI":{layer:"GEOGRAPHICALGRIDSYSTEMS.CASSINI",key:r.default.gppKey,theme:"cartes",desc:"Carte de Cassini en couleur (feuilles gravées et aquarellées), issue de l’exemplaire dit de « Marie-Antoinette » du XVIIIe siècle.",server:"https://data.geopf.fr/private/wmts",bbox:[-6.00063,42.019,9.2809,51.2455],format:"image/jpeg",minZoom:6,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte de Cassini (XVIIIe siècle)",legend:["https://data.geopf.fr/annexes/ressources/legendes/LEGEND.jpg"]},"ADMINEXPRESS-COG-CARTO.LATEST":{layer:"ADMINEXPRESS-COG-CARTO.LATEST",key:"",theme:"administratif",desc:"Limites administratives Express COG code officiel géographique 2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"ADMINEXPRESS COG CARTO"},"ADMINEXPRESS-COG.LATEST":{layer:"ADMINEXPRESS-COG.LATEST",key:"",theme:"administratif",desc:"Limites administratives Express COG code officiel géographique. 2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"ADMINEXPRESS COG"},"ADMINEXPRESS_2023-11-15":{layer:"ADMINEXPRESS_2023-11-15",key:"",theme:"administratif",desc:"Limites administratives mises à jour en continu ; Edition : 2023-11-15",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Limites administratives mises à jour en continu"},ADMINEXPRESS_COG_2020:{layer:"ADMINEXPRESS_COG_2020",key:"",theme:"administratif",desc:"Limites administratives Express COG code officiel géographique 2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"ADMINEXPRESS_COG (2022)"},ADMIN_EXPRESS:{layer:"ADMIN_EXPRESS",key:"",theme:"administratif",desc:"Limites administratives des collectivités territoriales. Régions, départements, cantons, communes, arrondissements (pour Paris, Lyon et Marseille) et établissements publics de coopération intercommunale (EPCI).",server:"https://data.geopf.fr/wmts",bbox:[-63.1618,-21.4,55.8469,51.0992],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Limites administratives"},"AREAMANAGEMENT.ZFU":{layer:"AREAMANAGEMENT.ZFU",key:"",theme:"economie",desc:"Zones franches créées au sein de quartiers de plus de 8 500 habitants particulièrement défavorisés, en tenant compte des éléments de nature à faciliter l’implantation d’entreprises ou le développement d’activités économiques.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Zones franches urbaines"},"AREAMANAGEMENT.ZUS":{layer:"AREAMANAGEMENT.ZUS",key:"",theme:"economie",desc:"Zones urbaines caractérisées par la présence de grands ensembles ou de quartiers d’habitat dégradé et par un déséquilibre accentué entre l’habitat et l’emploi.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Zones urbaines sensibles"},"Aire-Parcellaire":{layer:"Aire-Parcellaire",key:"",theme:"parcellaire",desc:"Selon les règlements européens n°110/2008 du 15 janvier 2008, n°1151/2012 du 21 novembre 2012 et n°1308/2013 de l’OCM , le cahier des charges des appellations définit l’aire géographique. Le terme de « délimitation parcellaire » désigne une aire qui repose sur les limites administratives du cadastre (les parcelles) et dont le maillage suffisamment fin permet de tenir compte de variations très localisées des éléments du milieu physique. Elle correspond à l'aire de production de la matière première. Elle est incluse dans l'aire géographique. Données produites par l'Institut National des Origines et la Qualité (INAO)",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Délimitation parcellaire AOC viticole"},"BDCARTO_ETAT-MAJOR.NIVEAU3":{layer:"BDCARTO_ETAT-MAJOR.NIVEAU3",key:"",theme:"autre",desc:"BDCARTO ETAT-MAJOR NIVEAU 3",server:"https://data.geopf.fr/wmts",bbox:[-5.15012,42.6423,7.19384,51.0938],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"BD CARTO Etat-major N3"},"BDCARTO_ETAT-MAJOR.NIVEAU4":{layer:"BDCARTO_ETAT-MAJOR.NIVEAU4",key:"",theme:"autre",desc:"BDCARTO ETAT-MAJOR NIVEAU 4",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"BD CARTO Etat-major N4"},BDTOPO:{layer:"BDTOPO",key:"",theme:"autre",desc:"La BD TOPO® contient une description vectorielle, structurée en objets, des éléments du territoire et de ses infrastructures, de précision métrique.",server:"https://data.geopf.fr/wmts",bbox:[-63.1618,-21.4,55.8469,51.0992],format:"application/x-protobuf",minZoom:4,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDTopo"},"BUILDINGS.BUILDINGS":{layer:"BUILDINGS.BUILDINGS",key:"",theme:"topographie",desc:"Affichage des constructions couvrant le territoire français.",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Bâtiments"},"CADASTRAL.PARCELS.SECTIONS":{layer:"CADASTRAL.PARCELS.SECTIONS",key:"",theme:"parcellaire",desc:"Affichage des divisions cadastrales (partie du plan cadastral correspondant à une section ou à une subdivision de section). Donnée établie d'après les plans cadastraux transmis par la DGFiP (Direction générale des Finances publiques).",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:13,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Sections cadastrales - BD PARCELLAIRE"},"CADASTRALPARCELS.HEATMAP":{layer:"CADASTRALPARCELS.HEATMAP",key:"",theme:"parcellaire",desc:"Cartographie des décalages entre les données BD Parcellaire et Parcellaire Express",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"DECALAGE DE LA REPRESENTATION CADASTRALE",tilematrix:"PM",title:"Décalage de la représentation cadastrale"},"CADASTRALPARCELS.HISTO.2008-2013.PARCELS":{layer:"CADASTRALPARCELS.HISTO.2008-2013.PARCELS",key:"",theme:"parcellaire",desc:"Limites des parcelles cadastrales historiques (2008-2013) issues de plans scannés et de plans numériques.",server:"https://data.geopf.fr/wmts",bbox:[-63.1607,-21.3922,55.8464,51.0945],format:"image/png",minZoom:0,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"bdparcellaire",tilematrix:"PM",title:"Parcelles cadastrales historiques (2008-2013)"},"CADASTRALPARCELS.PARCELLAIRE_EXPRESS":{layer:"CADASTRALPARCELS.PARCELLAIRE_EXPRESS",key:"",theme:"parcellaire",desc:"Plan cadastral informatisé vecteur de la DGFIP édition Juillet 2023.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PCI vecteur"},"CADASTRALPARCELS.PARCELS":{layer:"CADASTRALPARCELS.PARCELS",key:"",theme:"parcellaire",desc:"Limites des parcelles cadastrales issues de plans scannés et de plans numériques.",server:"https://data.geopf.fr/wmts",bbox:[-63.1607,-21.3922,55.8464,51.091],format:"image/png",minZoom:0,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"bdparcellaire",tilematrix:"PM",title:"Parcelles cadastrales"},"CADASTRALPARCELS.QUALREFBDP":{layer:"CADASTRALPARCELS.QUALREFBDP",key:"",theme:"parcellaire",desc:"Métadonnées complémentaires des divisions cadastrales. Davantage d’informations dans le document disponible https://data.geopf.fr/annexes/ressources/fiches/bdparcellaire/Metadonnees_BDPARCELLAIRE.pdf",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"DIVCAD_MTD",tilematrix:"PM",title:"Qualité du géoréférencement de la BD Parcellaire"},"CARTES-14-18-EDUGEO_PYR-PNG_FXX_WM":{layer:"CARTES-14-18-EDUGEO_PYR-PNG_FXX_WM",key:"",theme:"edugeo",desc:"Zone de Verdun et ses environs: voies de communication (novembre 1916)",server:"https://data.geopf.fr/wmts",bbox:[4.79205,48.9421,5.9969,49.5144],format:"image/png",minZoom:6,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun et ses environs: voies de communication (novembre 1916)"},"CARTES.NATURALEARTH":{layer:"CARTES.NATURALEARTH",key:"",theme:"cartes",desc:"Carte générale du monde politique avec les frontières et capitales d'Etat, les entités administratives secondaires, villes principales, fleuves, lacs et océans. Edition : 1.4.0",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:1,maxZoom:9,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Monde Natural Earth"},CGET_QP_BDD_WLD_WM_WMTS_20150914:{layer:"CGET_QP_BDD_WLD_WM_WMTS_20150914",key:"",theme:"autre",desc:'<div style="text-align:justify;">Les quartiers prioritaires de la politique de la ville sont issus de la loi de programmation pour la ville et cohésion urbaine n° 2014-173 du 21 février 2014.<br/> <div style="text-decoration:underline;"><a href="http://www.ville.gouv.fr/?geographie-prioritaire-de-la" alt="http://www.ville.gouv.fr/?geographie-prioritaire-de-la">Téléchargement des données</a></div><br/> Sources : Commissariat Général à l\'Egalité des Territoires :  1er janvier 2015</div>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Quartiers prioritaires"},"COMMUNES.PRIORITYDISCTRICT":{layer:"COMMUNES.PRIORITYDISCTRICT",key:"",theme:"autre",desc:'<div style="text-align:justify;">Les quartiers prioritaires de la politique de la ville sont issus de la loi de programmation pour la ville et cohésion urbaine n° 2014-173 du 21 février 2014.<br/> <div style="text-decoration:underline;"><a href="http://www.ville.gouv.fr/?geographie-prioritaire-de-la" alt="http://www.ville.gouv.fr/?geographie-prioritaire-de-la">Téléchargement des données</a></div><br/> Sources : Commissariat Général à l\'Egalité des Territoires :  1er janvier 2015</div>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Quartiers prioritaires"},"COMMUNES.SISMICITE":{layer:"COMMUNES.SISMICITE",key:"",theme:"autre",desc:'<div style="text-align:justify;">Représentation des niveaux de sismicité pour chaque commune.</br> Le zonage sismique de la France, en vigueur à compter du 1er mai 2011, est défini par le décret n°2010-1255 du 22 octobre 2010.</br> </br> Sources :</br> Direction Générale de la Prévention des Risques : base GASPAR - 10/2014</br> IGN : BDTOPO&reg; - 04/2014',server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Communes selon les zones de sismicité"},DEBROUSSAILLEMENT:{layer:"DEBROUSSAILLEMENT",key:"",theme:"environnement",desc:"Zonage informatif des obligations légales de débroussaillement",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"nolegend",tilematrix:"PM",title:"Zonage informatif des obligations légales de débroussaillement"},"DREAL.ZONAGE_PINEL":{layer:"DREAL.ZONAGE_PINEL",key:"",theme:"autre",desc:"La réduction d'impôt « Pinel » (code général des impôts) s'applique à l’investissement locatif réalisé dans les zones où la tension entre l'offre et la demande de logements est la plus forte. La loi n°2019-1479 du 28 décembre 2019 de finances pour 2020, prévoit à titre expérimental, un dispositif dérogatoire au droit commun pour la Bretagne. Ainsi, les communes ou parties de communes éligibles à la réduction d'impôt « Pinel » sont fixées par arrêté du préfet de région. Cet arrêté est pris après avis du président du conseil régional et du comité régional de l'habitat et de l'hébergement. Cet article prévoit également que le préfet de région fixe, par arrêté, les plafonds de loyer et de ressources du locataire pour chaque commune ou partie de commune éligible et par type de logement. L’une des particularités de cette expérimentation réside dans l’éligibilité du dispositif qui peut être limitée à une partie seulement du territoire communal. Lorsqu’une commune n’est éligible que pour une partie de son territoire, deux approches sont distinguées, à savoir à la maille de l’IRIS (correspondant à un quartier) ou à la maille du carreau de 200 mètres sur 200 mètres.",server:"https://data.geopf.fr/wmts",bbox:[-5.15012,47.2719,-1.00687,48.9064],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Zonage du dispositif Pinel en Bretagne 2020-2021"},"EDUGEO.LANDUSE.AGRICULTURE2012":{layer:"EDUGEO.LANDUSE.AGRICULTURE2012",key:"",theme:"edugeo",desc:"Registre parcellaire graphique : zones de culture déclarées par les exploitants en 2012",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2012"},"EDUGEO.NATURALRISKZONES.1910FLOODEDWATERSHEDS":{layer:"EDUGEO.NATURALRISKZONES.1910FLOODEDWATERSHEDS",key:"",theme:"edugeo",desc:"Carte des plus hautes eaux connues (PHEC) sur le bassin de la Seine : crue de la seine et de ses affluents en 1910, ainsi que d'autres crues à des dates postérieures sur d'autres cours d'eau.",server:"https://data.geopf.fr/wmts",bbox:[.419457,47.4163,5.43248,50.064],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Crues du bassin de la Seine - PHEC"},"ELEVATION.CONTOUR.LINE":{layer:"ELEVATION.CONTOUR.LINE",key:"",theme:"altimetrie",desc:"Le produit « Courbes de niveau » est un modèle numérique de terrain sous forme de courbes de même altitude, appelées aussi « isoplèthes d’altitude », ou plus techniquement « isohypses ». Ces courbes permettent la description du relief français.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Courbes de niveau"},"ELEVATION.ELEVATIONGRIDCOVERAGE":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE",key:"",theme:"altimetrie",desc:"BDAlti V1 au pas de 25m",server:"https://data.geopf.fr/wmts",bbox:[-64,-23,168,52],format:"image/x-bil;bits=32",minZoom:0,maxZoom:11,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"MNT BDAlti V1"},"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES",key:"",theme:"altimetrie",desc:"Modèle Numérique de Terrain issu du RGEALTI",server:"https://data.geopf.fr/wmts",bbox:[-62.9528,-13.0078,45.3043,51.1053],format:"image/x-bil;bits=32",minZoom:6,maxZoom:14,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Modèle Numérique de Terrain issu du RGEALTI"},"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES.MNS":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES.MNS",key:"",theme:"altimetrie",desc:"Modèle numérique de surface",server:"https://data.geopf.fr/wmts",bbox:[-63.1968,-21.4338,55.8639,51.22],format:"image/x-bil;bits=32",minZoom:4,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Modèle numérique de surface"},"ELEVATION.ELEVATIONGRIDCOVERAGE.SHADOW":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE.SHADOW",key:"",theme:"altimetrie",desc:"Couche d'ombrage calculée à partir des données altimétriques de l'IGN permettant de mieux appréhender le relief. L'estompage proposé est réalisé à partir des données MNT BDAlti au pas de 25m avec deux soleils : un au nord-est de hauteur 45°, l'autre zénithal.",server:"https://data.geopf.fr/wmts",bbox:[-63.187,-21.4069,55.8884,50.9218],format:"image/png",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"estompage_grayscale",tilematrix:"PM",title:"Estompage"},"ELEVATION.ELEVATIONGRIDCOVERAGE.SRTM3":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE.SRTM3",key:"",theme:"altimetrie",desc:"MNT SRTM3 construit par la NASA et le NGA.",server:"https://data.geopf.fr/wmts",bbox:[-180,-56.0004,180,61.0004],format:"image/x-bil;bits=32",minZoom:1,maxZoom:10,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"MNT SRTM3"},"ELEVATION.ELEVATIONGRIDCOVERAGE.THRESHOLD":{layer:"ELEVATION.ELEVATIONGRIDCOVERAGE.THRESHOLD",key:"",theme:"altimetrie",desc:"La carte expérimentale des seuils de pente pour l'agriculture est dérivée du MNT RGEAlti, modèle numérique de terrain maillé au pas de 1 m. Les seuils de représentation de cette carte sont : 7% à 10% : bleu, 10% à 15% : mauve, 15% à 20% : orange, plus de 20% : rouge. Données disponibles en France Métropolitaine du 1/4265 au 1/69885283 - mise à jour du 30/06/2017.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:3,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"ELEVATION.ELEVATIONGRIDCOVERAGE.THRESHOLD",tilematrix:"PM",title:"Seuils de pente pour l'agriculture"},"ELEVATION.LEVEL0":{layer:"ELEVATION.LEVEL0",key:"",theme:"altimetrie",desc:"Formalisation de la limite entre le domaine terrestre et le domaine marin.",server:"https://data.geopf.fr/wmts",bbox:[-63.2529,-21.51,55.9472,51.1388],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Trait de côte Histolitt"},"ELEVATION.SLOPES":{layer:"ELEVATION.SLOPES",key:"",theme:"altimetrie",desc:"La couche altitude se compose d'un MNT (Modèle Numérique de Terrain) affiché en teintes hypsométriques et issu de la BD ALTI®.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:6,maxZoom:14,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Altitude"},"ELEVATION.SLOPES.HIGHRES":{layer:"ELEVATION.SLOPES.HIGHRES",key:"",theme:"altimetrie",desc:"Modèle numérique continu terre-mer sur la frange littorale.",server:"https://data.geopf.fr/wmts",bbox:[5.75296,42.9786,6.25761,43.2733],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Litto3D ®"},"ELEVATIONGRIDCOVERAGE.HIGHRES.QUALITY":{layer:"ELEVATIONGRIDCOVERAGE.HIGHRES.QUALITY",key:"",theme:"altimetrie",desc:"Informations sur la précision du RGEAlti.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"Graphe de source du RGE Alti",tilematrix:"PM",title:"Masque de source du RGE Alti"},"EVOL-SURFACE-FORESTIERE-1980-2011_EDUGEO_PYR-PNG_FXX_LAMB93_20150918":{layer:"EVOL-SURFACE-FORESTIERE-1980-2011_EDUGEO_PYR-PNG_FXX_LAMB93_20150918",key:"",theme:"edugeo",desc:"Évolution annuelle des surfaces forestières entre les années 1980 et 2011",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Évolution des surfaces forestières (1980 et 2011)"},"FORETS.PUBLIQUES":{layer:"FORETS.PUBLIQUES",key:"",theme:"environnement",desc:"Localisation des forêts publiques domaniales et non domaniales (communales, sectionales, départementales et d'établissements publics) gérées par l'Office national des forêts (ONF).",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:3,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"FORETS PUBLIQUES ONF",tilematrix:"PM",title:"Forêts publiques"},"GEOGRAPHICALGRIDSYSTEMS.1900TYPEMAPS":{layer:"GEOGRAPHICALGRIDSYSTEMS.1900TYPEMAPS",key:"",theme:"cartes",desc:"Carte topographique de Paris et de ses environs éditée en 1906.",server:"https://data.geopf.fr/wmts",bbox:[1.62941,48.4726,3,49.1548],format:"image/jpeg",minZoom:10,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte topographique - environs de Paris (1906)"},"GEOGRAPHICALGRIDSYSTEMS.1914_11_15_ARRAS_VERDUN_BELFORT_fronts_600K":{layer:"GEOGRAPHICALGRIDSYSTEMS.1914_11_15_ARRAS_VERDUN_BELFORT_fronts_600K",key:"",theme:"edugeo",desc:"Zone de front : Arras Verdun Belfort (15 novembre 1914)",server:"https://data.geopf.fr/wmts",bbox:[.87353,47.3396,8.88521,51.2857],format:"image/png",minZoom:6,maxZoom:10,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Front : Arras Verdun Belfort (15 novembre 1914)"},"GEOGRAPHICALGRIDSYSTEMS.BONNE":{layer:"GEOGRAPHICALGRIDSYSTEMS.BONNE",key:"",theme:"cartes",desc:"Carte de Guyane française établie par M. Bonne, Ingénieur-Hydrographe de la Marine. Cette carte figure dans l'\"atlas de toutes les parties connues du globe terrestre\", ouvrage rédigé par l'abbé Guillaume-Thomas RAYNAL et publié à Genève en 1780.",server:"https://data.geopf.fr/wmts",bbox:[-55.9127,-.49941,-50.0835,7.88966],format:"image/jpeg",minZoom:0,maxZoom:10,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Guyane française (1780)"},"GEOGRAPHICALGRIDSYSTEMS.COASTALMAPS":{layer:"GEOGRAPHICALGRIDSYSTEMS.COASTALMAPS",key:"",theme:"cartes",desc:"Assemblage des cartes marines du Service hydrographique et océanographique de la marine (SHOM) et des cartes terrestres de l’IGN. Attention : Cette donnée n’est pas destinée à la navigation maritime.",server:"https://data.geopf.fr/wmts",bbox:[-61.8799,-21.5205,56.1352,51.1895],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte littorale (SHOM/IGN)"},"GEOGRAPHICALGRIDSYSTEMS.DOUAUMONT_FORT_positions_5K_18mai1916":{layer:"GEOGRAPHICALGRIDSYSTEMS.DOUAUMONT_FORT_positions_5K_18mai1916",key:"",theme:"edugeo",desc:"Zone du Fort de Douaumont (18 mai 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.42696,49.2064,5.45493,49.2229],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Fort Douaumont (18 mai 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.AJACCIO1976":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.AJACCIO1976",key:"",theme:"edugeo",desc:"Zone d'Ajaccio - Cartographie 1976",server:"https://data.geopf.fr/wmts",bbox:[8.507,41.6654,9.13252,42.0381],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie AJACCIO 1976"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BELFORT-MONTBELLIARD1973":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BELFORT-MONTBELLIARD1973",key:"",theme:"edugeo",desc:"Zone d'Ajaccio - BELFORT MONTBELLIARD 1973",server:"https://data.geopf.fr/wmts",bbox:[6.50535,47.3676,7.25597,47.8735],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie BELFORT MONTBELLIARD 1973"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BERRY-SUD1952":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BERRY-SUD1952",key:"",theme:"edugeo",desc:"Zone de BERRY SUD - Cartographie 1952",server:"https://data.geopf.fr/wmts",bbox:[1.00082,46.168,1.75144,46.6854],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie BERRY SUD 1952"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BETHUNE1956":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BETHUNE1956",key:"",theme:"edugeo",desc:"Zone de BETHUNE 1956",server:"https://data.geopf.fr/wmts",bbox:[2.37696,50.17,3.37778,50.6484],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie BETHUNE 1956"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BIARRITZ1979":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BIARRITZ1979",key:"",theme:"edugeo",desc:"Zone de Biarritz 1979",server:"https://data.geopf.fr/wmts",bbox:[-1.87654,43.1433,-1.25103,43.6885],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie BIARRITZ 1979"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BOURG-ST-MAURICE1974":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.BOURG-ST-MAURICE1974",key:"",theme:"edugeo",desc:"Zone de BOURG St-MAURICE - Cartographie 1974",server:"https://data.geopf.fr/wmts",bbox:[6.50535,45.3827,7.13087,45.7331],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie BOURG St-MAURICE 1974"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CAEN1969":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CAEN1969",key:"",theme:"edugeo",desc:"Zone de CAEN - Cartographie 1969",server:"https://data.geopf.fr/wmts",bbox:[-.875721,49.035,-.125103,49.4434],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie CAEN 1969"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CAP-DAGDE1971":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CAP-DAGDE1971",key:"",theme:"edugeo",desc:"Zone du Cap d'Agde 1971",server:"https://data.geopf.fr/wmts",bbox:[3.00247,43.1433,3.62799,43.5073],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Cap d'AGDE 1971"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CLERMONT-FERRAND1966":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CLERMONT-FERRAND1966",key:"",theme:"edugeo",desc:"Zone de CLERMONT FERRAND 1966",server:"https://data.geopf.fr/wmts",bbox:[2.75227,45.6457,3.37778,45.9944],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie CLERMONT FERRAND 1966"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CREIL-SUD-PICARDIE1979":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.CREIL-SUD-PICARDIE1979",key:"",theme:"edugeo",desc:"Zone de CREIL SUD PICARDIE 1979",server:"https://data.geopf.fr/wmts",bbox:[2.25185,49.035,3.12757,49.6058],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie CREIL SUD PICARDIE 1979"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.DIJON1962":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.DIJON1962",key:"",theme:"edugeo",desc:"Zone de Dijon 1962",server:"https://data.geopf.fr/wmts",bbox:[4.75391,46.9422,5.37943,47.5368],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Dijon 1962"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Douaumont1916":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Douaumont1916",key:"",theme:"edugeo",desc:"Zone de Douaumont et ses environs (avril 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.38761,49.1519,5.49243,49.2326],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Douaumont et ses environs (avril 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1965":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1965",key:"",theme:"edugeo",desc:"Zone de Grenoble 1965",server:"https://data.geopf.fr/wmts",bbox:[5.50453,44.9416,6.13005,45.3827],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie GRENOBLE 1965"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1976":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1976",key:"",theme:"edugeo",desc:"Zone de Grenoble 1976",server:"https://data.geopf.fr/wmts",bbox:[5.50453,45.0301,6.25515,45.4705],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie GRENOBLE 1976"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1991":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GRENOBLE1991",key:"",theme:"edugeo",desc:"Zone de Grenoble 1991",server:"https://data.geopf.fr/wmts",bbox:[5.50453,44.9416,6.13005,45.3827],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie GRENOBLE 1991"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GUADELOUPE1955":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GUADELOUPE1955",key:"",theme:"edugeo",desc:"Zone de Guadeloupe 1955",server:"https://data.geopf.fr/wmts",bbox:[-61.6758,16.1695,-61.3005,16.6495],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Guadeloupe 1955"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GUYANE1958":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.GUYANE1958",key:"",theme:"edugeo",desc:"Zone de Guyane 1958",server:"https://data.geopf.fr/wmts",bbox:[-54.4198,5.12238,-53.419,5.99398],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Guyane 1958"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LA-REUNION1980":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LA-REUNION1980",key:"",theme:"edugeo",desc:"Zone de la Réunion 1980",server:"https://data.geopf.fr/wmts",bbox:[55.0453,-21.4954,55.6708,-20.6783],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie LA REUNION 1980"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LA-ROCHELLE-ROCHEFORT1959":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LA-ROCHELLE-ROCHEFORT1959",key:"",theme:"edugeo",desc:"Zone de LA ROCHELLE-ROCHEFORT 1959",server:"https://data.geopf.fr/wmts",bbox:[-1.37613,45.7331,-.750618,46.4273],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie LA ROCHELLE-ROCHEFORT 1959"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LE-HAVRE1975":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LE-HAVRE1975",key:"",theme:"edugeo",desc:"Zone de Le Havre - Cartographie 1975",server:"https://data.geopf.fr/wmts",bbox:[-.125103,49.2805,.500412,49.6868],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Le Havre 1975"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LE-HAVRE1979":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LE-HAVRE1979",key:"",theme:"edugeo",desc:"Zone de Le Havre - Cartographie 1979",server:"https://data.geopf.fr/wmts",bbox:[-.125103,49.2805,.625515,49.6868],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Le Havre 1979"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LIMOGES1966":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LIMOGES1966",key:"",theme:"edugeo",desc:"Zone de Limoges 1966",server:"https://data.geopf.fr/wmts",bbox:[1.00082,45.6457,1.50124,45.9944],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Limoges 1966"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1947":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1947",key:"",theme:"edugeo",desc:"Zone de LYON - Cartographie 1947",server:"https://data.geopf.fr/wmts",bbox:[4.50371,45.4705,5.37943,46.0813],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie LYON 1947"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1980":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1980",key:"",theme:"edugeo",desc:"Zone de LYON - Cartographie 1980",server:"https://data.geopf.fr/wmts",bbox:[4.62881,45.4705,5.12922,45.9944],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie LYON 1980"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1985":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.LYON1985",key:"",theme:"edugeo",desc:"Zone de LYON - Cartographie 1985",server:"https://data.geopf.fr/wmts",bbox:[4.62881,45.5582,5.12922,45.9944],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie LYON 1985"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Le-Mort-Homme-et-ses-environs-avril-1916":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Le-Mort-Homme-et-ses-environs-avril-1916",key:"",theme:"edugeo",desc:"Zone du Mort Homme et ses environs (avril 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.20969,49.1978,5.31045,49.2602],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Le Mort Homme et ses environs (avril 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1966":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1966",key:"",theme:"edugeo",desc:"Zone de MARNE LA VALLÉE 1966",server:"https://data.geopf.fr/wmts",bbox:[2.37696,48.7059,3.12757,49.035],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARNE LA VALLÉE 1966"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1978":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1978",key:"",theme:"edugeo",desc:"Zone de MARNE LA VALLÉE 1978",server:"https://data.geopf.fr/wmts",bbox:[2.37696,48.7059,2.75227,49.035],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARNE LA VALLÉE 1978"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1987":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARNE-LA-VALLEE1987",key:"",theme:"edugeo",desc:"Zone de MARNE LA VALLÉE 1987",server:"https://data.geopf.fr/wmts",bbox:[2.37696,48.7059,3.12757,49.035],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARNE LA VALLÉE 1987"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1947":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1947",key:"",theme:"edugeo",desc:"Zone de MARSEILLE MARTIGUES 1947",server:"https://data.geopf.fr/wmts",bbox:[4.50371,43.052,5.62963,43.6885],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARSEILLE MARTIGUES 1947"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1980":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1980",key:"",theme:"edugeo",desc:"Zone de MARSEILLE MARTIGUES 1980",server:"https://data.geopf.fr/wmts",bbox:[5.00412,43.052,5.62963,43.5073],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARSEILLE MARTIGUES 1980"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1986":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.MARSEILLE-MARTIGUES1986",key:"",theme:"edugeo",desc:"Zone de MARSEILLE MARTIGUES 1986",server:"https://data.geopf.fr/wmts",bbox:[4.87902,43.052,5.62963,43.6885],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie MARSEILLE MARTIGUES 1986"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.METZ-NANCY1983":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.METZ-NANCY1983",key:"",theme:"edugeo",desc:"Zone de METZ NANCY 1983",server:"https://data.geopf.fr/wmts",bbox:[5.75474,48.4576,6.50535,49.362],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie METZ NANCY 1983"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.NANTES1972":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.NANTES1972",key:"",theme:"edugeo",desc:"Zone de NANTES 1972",server:"https://data.geopf.fr/wmts",bbox:[-2.50206,47.0276,-1.25103,47.4522],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie NANTES 1972"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.PARIS1964":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.PARIS1964",key:"",theme:"edugeo",desc:"Zone de Paris - Cartographie 1964",server:"https://data.geopf.fr/wmts",bbox:[2.00165,48.7884,2.50206,49.117],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie 1964"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.PARIS1979":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.PARIS1979",key:"",theme:"edugeo",desc:"Zone de Paris - Cartographie 1979",server:"https://data.geopf.fr/wmts",bbox:[2.00165,48.7059,2.62716,49.035],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie 1979"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Positions_20K_avr1916":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.Positions_20K_avr1916",key:"",theme:"edugeo",desc:"Zone de l'Organisation défensive sur la Meuse (avril 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.11659,49.1307,5.58059,49.2732],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Organisation défensive sur la Meuse (avril 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.REIMS1974":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.REIMS1974",key:"",theme:"edugeo",desc:"Zone de REIMS 1974",server:"https://data.geopf.fr/wmts",bbox:[3.75309,49.035,4.50371,49.4434],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie REIMS 1974"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.ROISSY1973":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.ROISSY1973",key:"",theme:"edugeo",desc:"Zone de Roissy - Cartographie 1973",server:"https://data.geopf.fr/wmts",bbox:[2.25185,48.8707,2.75227,49.117],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Roissy 1973"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.ROISSY1978":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.ROISSY1978",key:"",theme:"edugeo",desc:"Zone de Roissy - Cartographie 1978",server:"https://data.geopf.fr/wmts",bbox:[2.25185,48.8707,2.75227,49.2805],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Roissy 1978"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.STRASBOURG1956":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.STRASBOURG1956",key:"",theme:"edugeo",desc:"Zone de STRASBOURG 1956",server:"https://data.geopf.fr/wmts",bbox:[7.25597,48.2081,8.13169,48.7884],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie STRASBOURG 1956"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.STRASBOURG1978":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.STRASBOURG1978",key:"",theme:"edugeo",desc:"Zone de STRASBOURG 1978",server:"https://data.geopf.fr/wmts",bbox:[7.25597,48.1246,8.00659,48.8707],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie STRASBOURG 1978"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.TOULON-HYERES1976":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.TOULON-HYERES1976",key:"",theme:"edugeo",desc:"Zone de TOULON HYERES 1976",server:"https://data.geopf.fr/wmts",bbox:[5.62963,42.8689,6.38025,43.2345],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie TOULON HYERES 1976"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.TOULOUSE1948":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.TOULOUSE1948",key:"",theme:"edugeo",desc:"Zone de TOULOUSE 1948",server:"https://data.geopf.fr/wmts",bbox:[1.12593,43.4165,1.75144,43.7789],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie TOULOUSE 1948"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1960":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1960",key:"",theme:"edugeo",desc:"Zone de Vannes Golfe du Morbihan - Cartographie 1960",server:"https://data.geopf.fr/wmts",bbox:[-3.37778,47.3676,-2.50206,47.8735],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Vannes Golfe du Morbihan 1960"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1971":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1971",key:"",theme:"edugeo",desc:"Zone de Vannes Golfe du Morbihan - Cartographie 1971",server:"https://data.geopf.fr/wmts",bbox:[-3.37778,47.3676,-2.50206,47.8735],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Vannes Golfe du Morbihan 1971"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERDUN_NORD_fronts_francais_20K":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERDUN_NORD_fronts_francais_20K",key:"",theme:"edugeo",desc:"Zone de Verdun nord : fronts français (21-26 février 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.29434,49.168,5.58034,49.3036],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun nord : fronts français (21-26 février 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERDUN_NORD_organisations_defensives_20K":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERDUN_NORD_organisations_defensives_20K",key:"",theme:"edugeo",desc:"Zone de Verdun nord : organisations défensives (21 février 1916)",server:"https://data.geopf.fr/wmts",bbox:[5.28694,49.1609,5.58493,49.3069],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun nord : organisations défensives (21 février 1916)"},"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERSAILLES1979":{layer:"GEOGRAPHICALGRIDSYSTEMS.EDUGEO.VERSAILLES1979",key:"",theme:"edugeo",desc:"Zone de Versailles - Cartographie 1979",server:"https://data.geopf.fr/wmts",bbox:[1.87654,48.5405,2.50206,49.035],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Versailles 1979"},"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR10":{layer:"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR10",key:"",theme:"cartes",desc:"Carte des environs de Paris au 1 : 10 000 établie entre 1818 et 1824.",server:"https://data.geopf.fr/wmts",bbox:[1.82682,48.3847,2.79738,49.5142],format:"image/jpeg",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte de l'état-major - environs de Paris (1818 - 1824)"},"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR40":{layer:"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR40",key:"",theme:"cartes",desc:"Carte française en couleurs du XIXè siècle en couleurs superposable aux cartes et données modernes.",server:"https://data.geopf.fr/wmts",bbox:[-6.08889,41.1844,10.961,51.2745],format:"image/jpeg",minZoom:6,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte de l'état-major (1820-1866)"},"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW",key:"",theme:"cartes",desc:"Carte Mondiale pour la mini-vue",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:1,maxZoom:8,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte Mondiale pour la mini-vue"},"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN50.1950":{layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN50.1950",key:"",theme:"cartes",desc:"SCAN50 produit par l'IGN en 1950",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:3,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"SCAN50_1950",tilematrix:"PM",title:"SCAN50 Historique de 1950"},"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2":{layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",key:"",theme:"cartes",desc:"Cartographie multi-échelles sur le territoire national, issue des bases de données vecteur de l’IGN, mis à jour régulièrement et réalisée selon un processus entièrement automatisé.",server:"https://data.geopf.fr/wmts",bbox:[-175,-85,175,85],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Plan IGN v2"},"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN":{layer:"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN",key:"",theme:"cartes",desc:"Carte des zones ayant une valeur de pente supérieure à 30°-35°-40°-45° d'après la BD ALTI au pas de 5m",server:"https://data.geopf.fr/wmts",bbox:[-63.1614,-21.5446,56.0018,51.0991],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte des pentes"},"GEOGRAPHICALGRIDSYSTEMS.SLOPES.PAC":{layer:"GEOGRAPHICALGRIDSYSTEMS.SLOPES.PAC",key:"",theme:"cartes",desc:"Carte des zones ayant une valeur de pente supérieure à 10% - source : RGEALTI 2017 au pas de 5m - disponible jusqu'au 1/17062 - métropole uniquement - mise à jour le 12/10/2017",server:"https://data.geopf.fr/wmts",bbox:[-63.1614,-21.5446,56.0018,51.0991],format:"image/png",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte des pentes pour l'agriculture sur la métropole"},"GEOGRAPHICALGRIDSYSTEMS.TERRIER_V1":{layer:"GEOGRAPHICALGRIDSYSTEMS.TERRIER_V1",key:"",theme:"cartes",desc:"Plan Terrier Corse V1 (XVIIIe siècle) - GEOGRAPHICALGRIDSYSTEMS.TERRIER_V1",server:"https://data.geopf.fr/wmts",bbox:[8.36284,41.2568,9.75281,43.1174],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Plan Terrier V1 (XVIIIe siècle)"},"GEOGRAPHICALGRIDSYSTEMS.TERRIER_V2":{layer:"GEOGRAPHICALGRIDSYSTEMS.TERRIER_V2",key:"",theme:"cartes",desc:"Plan Terrier, cartographie ancienne du XVIIIème siècle sur la Corse version est une version numérisée par les archives militaires du Ministère de la Défense",server:"https://data.geopf.fr/wmts",bbox:[8.36284,41.2568,9.75282,43.1174],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Plan Terrier V2 (XVIIIe siècle)"},"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_NORD_fronts_offensves_50K":{layer:"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_NORD_fronts_offensves_50K",key:"",theme:"edugeo",desc:"Zone de Verdun et ses environs : offensives (février 1916 à aout1917 )",server:"https://data.geopf.fr/wmts",bbox:[4.99018,49.0887,5.65437,49.4144],format:"image/png",minZoom:6,maxZoom:14,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun et ses environs : offensives (février 1916 à aout1917 )"},"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_SUD_NORD_com_group_80K":{layer:"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_SUD_NORD_com_group_80K",key:"",theme:"edugeo",desc:"Zone de Verdun et ses environs: voies de communication (novembre 1916)",server:"https://data.geopf.fr/wmts",bbox:[4.79205,48.9421,5.9969,49.5144],format:"image/png",minZoom:6,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun et ses environs: voies de communication (novembre 1916)"},"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_fronts_50K_21-26fevr1916":{layer:"GEOGRAPHICALGRIDSYSTEMS.VERDUN_ENVIRONS_fronts_50K_21-26fevr1916",key:"",theme:"edugeo",desc:"Zone de Verdun et ses environs : fronts français (21-26 février 1916)",server:"https://data.geopf.fr/wmts",bbox:[4.98696,49.0849,5.64305,49.3719],format:"image/png",minZoom:6,maxZoom:14,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Verdun et ses environs : fronts français (21-26 février 1916)"},"GEOGRAPHICALNAMES.NAMES":{layer:"GEOGRAPHICALNAMES.NAMES",key:"",theme:"topographie",desc:"Affichage des noms des villes, villages, lieux-dits ...",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Dénominations géographiques"},"HR.ORTHOIMAGERY.ORTHOPHOTOS":{layer:"HR.ORTHOIMAGERY.ORTHOPHOTOS",key:"",theme:"ortho",desc:"Le produit BD ORTHO® V3 est une collection de mosaïques d'orthophotographies numériques en couleurs ou en Infra Rouge couleurs, rectifiées dans la projection adaptée au territoire couvert. La BD ORTHO® V3 se compose d'images numériques (sans habillage ni surcharge) et d'indications de géoréférencement. Le contenu informationnel permet localement une utilisation jusqu'au 1 :2,000ième pour mettre en valeur le territoire, enrichir la visualisation des données et des projets.",server:"https://data.geopf.fr/wmts",bbox:[-180,-90,180,90],format:"image/jpeg",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Ortho 20 cm"},"HYDROGRAPHY.BCAE.2020":{layer:"HYDROGRAPHY.BCAE.2020",key:"",theme:"topographie",desc:"Le code rural et de la pêche maritime prévoit que les agriculteurs qui demandent des aides de la PAC implantent des bandes enherbées le long de certains cours d’eau au titre des bonnes conditions agricoles et environnementales (BCAE). Cette carte représente les cours d’eau concernés pour les départements listés ci-dessous. Pour les autres départements, veuillez-vous référer à l’arrêté du 24 avril 2015 relatif aux BCAE Cette carte est en vigueur du 1er janvier 2020 au 31 décembre 2020.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Cours d'eau BCAE 2020"},"HYDROGRAPHY.BCAE.2021":{layer:"HYDROGRAPHY.BCAE.2021",key:"",theme:"topographie",desc:"Identification des cours d'eau concernés par les règles des bonnes conditions agricoles et environnementales (BCAE) en 2021 pour les départements métropolitains. Le code rural et de la pêche maritime prévoit que les agriculteurs qui demandent des aides de la PAC implantent des bandes enherbées le long de certains cours d'eau au titre des bonnes conditions agricoles et environnementales. Cette carte est en vigueur du 1er janvier 2021 au 31 décembre 2021. Pour les départements non métropolitains, veuillez-vous référer aux arrêtés préfectoraux relatifs aux BCAE.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Cours d'eau BCAE 2021"},"HYDROGRAPHY.BCAE.2022":{layer:"HYDROGRAPHY.BCAE.2022",key:"",theme:"topographie",desc:"Le code rural et de la pêche maritime prévoit que les agriculteurs qui demandent des aides de la PAC implantent des bandes enherbées le long de certains cours d'eau au titre des bonnes conditions agricoles et environnementales. Cette carte est en vigueur du 1er janvier 2022 au 31 décembre 2022. Pour les départements non métropolitains, veuillez-vous référer aux arrêtés préfectoraux relatifs aux BCAE.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cours d'eau BCAE 2022"},"HYDROGRAPHY.BCAE.2024":{layer:"HYDROGRAPHY.BCAE.2024",key:"",theme:"topographie",desc:"Le code rural et de la pêche maritime prévoit que les agriculteurs qui demandent des aides de la PAC implantent des bandes enherbées le long de certains cours d’eau au titre des bonnes conditions agricoles et environnementales. Ce référentiel est en vigueur du 1er janvier 2024 au 31 décembre 2024.",server:"https://data.geopf.fr/wmts",bbox:[-5.1505,41.3252,9.5705,51.0991],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cours d'eau BCAE 2024"},"HYDROGRAPHY.BCAE.LATEST":{layer:"HYDROGRAPHY.BCAE.LATEST",key:"",theme:"topographie",desc:"Le code rural et de la pêche maritime prévoit que les agriculteurs qui demandent des aides de la PAC implantent des bandes enherbées le long de certains cours d'eau au titre des bonnes conditions agricoles et environnementales. Cette carte est en vigueur du 1er janvier 2024 au 31 décembre 2024. Pour les départements non métropolitains, veuillez-vous référer aux arrêtés préfectoraux relatifs aux BCAE.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cours d'eau BCAE dernière édition"},"HYDROGRAPHY.HYDROGRAPHY":{layer:"HYDROGRAPHY.HYDROGRAPHY",key:"",theme:"topographie",desc:"Affichage des lacs, réservoirs, rivières et cours d'eau en France.",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Hydrographie"},"INSEE.FILOSOFI.ENFANTS.0.17.ANS.SECRET":{layer:"INSEE.FILOSOFI.ENFANTS.0.17.ANS.SECRET",key:"",theme:"economie",desc:"Nombre d’individus âgés de 0 à 17 ans dans la population (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% des 0-17 ans (secret signalé)"},"INSEE.FILOSOFI.LOGEMENTS.SURFACE.MOYENNE.SECRET":{layer:"INSEE.FILOSOFI.LOGEMENTS.SURFACE.MOYENNE.SECRET",key:"",theme:"economie",desc:"Surface moyenne des logements (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"Surface moyenne des logements (secret signalé)"},"INSEE.FILOSOFI.NIVEAU.DE.VIE.SECRET":{layer:"INSEE.FILOSOFI.NIVEAU.DE.VIE.SECRET",key:"",theme:"economie",desc:"Niveau de vie des individus, retraité des valeurs extrêmes (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"Niveau de vie winsorisé des individus (secret signalé)"},"INSEE.FILOSOFI.PART.FAMILLES.MONOPARENTALES.SECRET":{layer:"INSEE.FILOSOFI.PART.FAMILLES.MONOPARENTALES.SECRET",key:"",theme:"economie",desc:"Part des familles monoparentales (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% familles monoparentales (secret signalé)"},"INSEE.FILOSOFI.PART.INDIVIDUS.25.39.ANS.SECRET":{layer:"INSEE.FILOSOFI.PART.INDIVIDUS.25.39.ANS.SECRET",key:"",theme:"economie",desc:"Nombre d’individus âgés de 25 à 39 ans dans la population (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% des 25-39 ans (secret signalé)"},"INSEE.FILOSOFI.PART.INDIVIDUS.40.54.ANS.SECRET":{layer:"INSEE.FILOSOFI.PART.INDIVIDUS.40.54.ANS.SECRET",key:"",theme:"economie",desc:"Nombre d’individus âgés de 40 à 54 ans dans la population (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% des 40-54 ans (secret signalé)"},"INSEE.FILOSOFI.PART.INDIVIDUS.55.64.ANS.SECRET":{layer:"INSEE.FILOSOFI.PART.INDIVIDUS.55.64.ANS.SECRET",key:"",theme:"economie",desc:"Nombre d’individus âgés de 55 à 64 ans dans la population (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% des 55-64 ans (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.APRES.1990.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.APRES.1990.SECRET",key:"",theme:"economie",desc:"Part des logements construits après 1990 (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements construits après 1990 (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.AVANT.1945.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.AVANT.1945.SECRET",key:"",theme:"economie",desc:"Part des logements construits avant 1945 (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements construits avant 1945 (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.COLLECTIFS.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.COLLECTIFS.SECRET",key:"",theme:"economie",desc:"Part des ménages habitant en logement collectif (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements collectifs (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.CONSTRUITS.1945.1970.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.CONSTRUITS.1945.1970.SECRET",key:"",theme:"economie",desc:"Part des logements construits entre 1945 et 1970 (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements construits entre 1945 et 1970 (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.CONSTRUITS.1970.1990.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.CONSTRUITS.1970.1990.SECRET",key:"",theme:"economie",desc:"Part des logements construits entre 1970 et 1990 (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements construits entre 1970 et 1990 (secret signalé)"},"INSEE.FILOSOFI.PART.LOGEMENTS.SOCIAUX.SECRET":{layer:"INSEE.FILOSOFI.PART.LOGEMENTS.SOCIAUX.SECRET",key:"",theme:"economie",desc:"Nombre de ménages habitant en logement social – voir définition- (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% de logements sociaux (secret signalé)"},"INSEE.FILOSOFI.PART.MENAGES.1.PERSONNE.SECRET":{layer:"INSEE.FILOSOFI.PART.MENAGES.1.PERSONNE.SECRET",key:"",theme:"economie",desc:"Part des ménages de 1 personne (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% ménages de 1 personne (secret signalé)"},"INSEE.FILOSOFI.PART.MENAGES.5.PERSONNES.OUPLUS.SECRET":{layer:"INSEE.FILOSOFI.PART.MENAGES.5.PERSONNES.OUPLUS.SECRET",key:"",theme:"economie",desc:"Part des ménages de 5 personnes ou plus (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% ménages de 5 personnes ou + (secret signalé)"},"INSEE.FILOSOFI.PART.MENAGES.MAISON.SECRET":{layer:"INSEE.FILOSOFI.PART.MENAGES.MAISON.SECRET",key:"",theme:"economie",desc:"Part des ménages vivant en maison (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% ménages en maison (secret signalé)"},"INSEE.FILOSOFI.PART.MENAGES.PAUVRES.SECRET":{layer:"INSEE.FILOSOFI.PART.MENAGES.PAUVRES.SECRET",key:"",theme:"economie",desc:"Part des ménages pauvres (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% ménages pauvres (secret signalé)"},"INSEE.FILOSOFI.PART.MENAGES.PROPRIETAIRES.SECRET":{layer:"INSEE.FILOSOFI.PART.MENAGES.PROPRIETAIRES.SECRET",key:"",theme:"economie",desc:"Part des ménages propriétaires (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% ménages propriétaires (secret signalé)"},"INSEE.FILOSOFI.PART.PLUS.65.ANS.SECRET":{layer:"INSEE.FILOSOFI.PART.PLUS.65.ANS.SECRET",key:"",theme:"economie",desc:"Nombre d’individus âgés de plus de 65 ans dans la population (les cases hachurées correspondent aux données secrétisées)",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"% des plus de 65 ans (secret signalé)"},"INSEE.FILOSOFI.POPULATION":{layer:"INSEE.FILOSOFI.POPULATION",key:"",theme:"economie",desc:"Nombre d'individus par km²",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"INSEE",tilematrix:"PM",title:"Densité de population"},ISOHYPSE:{layer:"ISOHYPSE",key:"",theme:"autre",desc:"Courbes de niveau",server:"https://data.geopf.fr/wmts",bbox:[-5.625,40.9799,9.84375,51.1793],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Courbes de niveau"},"LANDCOVER.CHA00":{layer:"LANDCOVER.CHA00",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 1990 et 2000 suivant la nomenclature CORINE Land Cover en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 1990-2000, a été réalisée à partir de CLC 1990 et de CLC 2000.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - Changements 1990-2000"},"LANDCOVER.CHA00_FR":{layer:"LANDCOVER.CHA00_FR",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 1990 et 2000 suivant la nomenclature CORINE Land Cover en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 1990-2000, a été réalisée à partir de CLC 1990 et de CLC 2000.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - Changements 1990-2000"},"LANDCOVER.CHA06":{layer:"LANDCOVER.CHA06",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2000 et 2006 suivant la nomenclature CORINE Land Cover en 44 postes pour la métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 2000-2006, a été réalisée à partir d'images satellitaires des années 2000 et 2006 pour la métropole, d'images satellitaires des périodes 1998-2003 et 2005-2008 pour les DOM et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - Changements 2000-2006"},"LANDCOVER.CHA06_DOM":{layer:"LANDCOVER.CHA06_DOM",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2000 et 2006 suivant la nomenclature CORINE Land Cover en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base des changements CORINE Land Cover DOM 2000-2006 a été réalisée à partir d'images satellitaires des périodes 1998-2003 et 2005-2008, et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - Changements 2000-2006"},"LANDCOVER.CHA06_FR":{layer:"LANDCOVER.CHA06_FR",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2000 et 2006 suivant la nomenclature CORINE Land Cover en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 2000-2006, a été réalisée à partir d'images satellitaires des années 2000 et 2006 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - Changements 2000-2006"},"LANDCOVER.CHA12":{layer:"LANDCOVER.CHA12",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2006 et 2012 suivant la nomenclature CORINE Land Cover en 44 postes pour la métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 2006-2012, a été réalisée à partir d'images satellitaires des années 2006 et 2012 pour la métropole, d'images satellitaires des périodes 2005-2008 et 2011-2012 pour les DOM et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - Changements 2006-2012"},"LANDCOVER.CHA12_DOM":{layer:"LANDCOVER.CHA12_DOM",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2006 et 212 suivant la nomenclature CORINE Land Cover en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base des changements CORINE Land Cover DOM 2006-2012 a été réalisée à partir d'images satellitaires des périodes 2005-2008 et 2011-2012, et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - Changements 2006-2012"},"LANDCOVER.CHA12_FR":{layer:"LANDCOVER.CHA12_FR",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2006 et 2012 suivant la nomenclature CORINE Land Cover en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 2006-2012, a été réalisée à partir d'images satellitaires des années 2006 et 2012 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - Changements 2006-2012"},"LANDCOVER.CHA18":{layer:"LANDCOVER.CHA18",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2012 et 2018 suivant la nomenclature CORINE Land Cover en 50 postes pour les DOM et 44 postes pour la Métropole. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base des changements CORINE Land Cover 2012-2018 a été réalisée à partir d'images satellitaires des périodes 2011-2012 et 2016-2017, et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"CORINE Land Cover - Changements 2012-2018"},"LANDCOVER.CHA18_DOM":{layer:"LANDCOVER.CHA18_DOM",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2012 et 2018 suivant la nomenclature CORINE Land Cover en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base des changements CORINE Land Cover DOM 2012-2018 a été réalisée à partir d'images satellitaires des périodes 2011-2012 et 2016-2017, et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - Changements 2012-2018"},"LANDCOVER.CHA18_FR":{layer:"LANDCOVER.CHA18_FR",key:"",theme:"clc",desc:"Inventaire biophysique du changement d'occupation des sols entre 2012 et 2018 suivant la nomenclature CORINE Land Cover en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base des changements CORINE Land Cover 2012-2018, a été réalisée à partir d'images satellitaires des années 2011-2012 et 2017 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - Changements 2012-2018"},"LANDCOVER.CLC00":{layer:"LANDCOVER.CLC00",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes pour la Métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000, dite CLC 2000, a été réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui pour la Métropole, de CORINE Land Cover DOM 2006 et de la base des changements 2000-2006 pour les DOM.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - 2000"},"LANDCOVER.CLC00R":{layer:"LANDCOVER.CLC00R",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000 révisée, dite CLC 2000 révisée, est une correction de CLC 2000 réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - 2000 révisée"},"LANDCOVER.CLC00R_FR":{layer:"LANDCOVER.CLC00R_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000 révisée, dite CLC 2000 révisée, est une correction de CLC 2000 réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2000 révisée"},"LANDCOVER.CLC00_DOM":{layer:"LANDCOVER.CLC00_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2000 a été réalisée à partir de CORINE Land Cover DOM 2006 et de la base des changements 2000-2006.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2000"},"LANDCOVER.CLC00_FR":{layer:"LANDCOVER.CLC00_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000, dite CLC 2000, a été réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2000"},"LANDCOVER.CLC06":{layer:"LANDCOVER.CLC06",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la Métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006, dite CLC 2006, a été réalisée à partir de CLC 2000 révisée et de la base des changements 2000-2006 pour la Métropole, d'images satellitaires prises entre 2005 et 2008 et de données d'appui pour les DOM.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - 2006"},"LANDCOVER.CLC06R":{layer:"LANDCOVER.CLC06R",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires de l'année 2006 pour la métropole, d'images satellitaires prises entre 2005 et 2008 pour les DOM et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - 2006 révisée"},"LANDCOVER.CLC06R_DOM":{layer:"LANDCOVER.CLC06R_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires prises entre 2005 et 2008 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2006 révisée"},"LANDCOVER.CLC06R_FR":{layer:"LANDCOVER.CLC06R_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires de l'année 2006 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2006 révisée"},"LANDCOVER.CLC06_DOM":{layer:"LANDCOVER.CLC06_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2006 a été réalisée à partir d'images satellitaires prises entre 2005 et 2008 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2006"},"LANDCOVER.CLC06_FR":{layer:"LANDCOVER.CLC06_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006, dite CLC 2006, a été réalisée à partir de CLC 2000 révisée et de la base des changements 2000-2006.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2006"},"LANDCOVER.CLC12":{layer:"LANDCOVER.CLC12",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 44 postes pour la Métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2012, dite CLC 2012, a été réalisée à partir de CLC 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - 2012"},"LANDCOVER.CLC12R":{layer:"LANDCOVER.CLC12R",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 50 postes pour les DOM et 44 postes pour la Métropole. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2012 révisée, dite CLC 2012 révisée, est une correction de CLC 2012 réalisée à partir d'images satellitaires prises entre 2011 et 2012 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"CORINE Land Cover - 2012 révisée"},"LANDCOVER.CLC12R_DOM":{layer:"LANDCOVER.CLC12R_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2012 révisée, dite CLC 2012 révisée, est une correction de CLC 2012 réalisée à partir d'images satellitaires prises entre 2011 et 2012 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2012 révisée"},"LANDCOVER.CLC12R_FR":{layer:"LANDCOVER.CLC12R_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2012 révisée, dite CLC 2012 révisée, est une correction de CLC 2012 réalisée à partir d'images satellitaires des années 2011-2012 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2012 révisée"},"LANDCOVER.CLC12_DOM":{layer:"LANDCOVER.CLC12_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2012 a été réalisée à partir de CORINE Land Cover DOM 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2012"},"LANDCOVER.CLC12_FR":{layer:"LANDCOVER.CLC12_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2012 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2012, dite CLC 2012, a été réalisée à partir de CLC 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2012"},"LANDCOVER.CLC18":{layer:"LANDCOVER.CLC18",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2018 en 50 postes pour les DOM et 44 postes pour la Métropole. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2018 a été réalisée à partir de CORINE Land Cover 2012 révisée et de la base des changements 2012-2018.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"CORINE Land Cover - 2018"},"LANDCOVER.CLC18_DOM":{layer:"LANDCOVER.CLC18_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2018 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2018 a été réalisée à partir de CORINE Land Cover DOM 2012 révisée et de la base des changements 2012-2018.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,47.1747],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"CORINE Land Cover - DOM - 2018"},"LANDCOVER.CLC18_FR":{layer:"LANDCOVER.CLC18_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2018 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2018, dite CLC 2018, a été réalisée à partir de CLC 2012 révisée et de la base des changements 2012-2018.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 2018"},"LANDCOVER.CLC90":{layer:"LANDCOVER.CLC90",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 1990 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 1990, dite CLC 1990, a été réalisée à partir d'images satellitaires de l'année 1990 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - 1990"},"LANDCOVER.CLC90_FR":{layer:"LANDCOVER.CLC90_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 1990 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 1990, dite CLC 1990, a été réalisée à partir d'images satellitaires de l'année 1990 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"CORINE Land Cover - France métropolitaine - 1990"},"LANDCOVER.EDUGEO.EVOL_SURFACE_FORESTIERE_1980-2011":{layer:"LANDCOVER.EDUGEO.EVOL_SURFACE_FORESTIERE_1980-2011",key:"",theme:"edugeo",desc:"Évolution annuelle des surfaces forestières entre les années 1980 et 2011",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Évolution des surfaces forestières (1980 et 2011)"},"LANDCOVER.EDUGEO.KLAUS":{layer:"LANDCOVER.EDUGEO.KLAUS",key:"",theme:"edugeo",desc:"Cartographie des dégâts de la tempête Klaus",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Tempête Klaus"},"LANDCOVER.EDUGEO.LGV_archeologie":{layer:"LANDCOVER.EDUGEO.LGV_archeologie",key:"",theme:"edugeo",desc:"Cartographie des principaux sites de fouille archéologique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Fouilles archéologiques le long de la LGV SEA."},"LANDCOVER.EDUGEO.LGV_faune":{layer:"LANDCOVER.EDUGEO.LGV_faune",key:"",theme:"edugeo",desc:"Cartographie des principaux sites d’intérêt faunistique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Faune le long de la LGV SEA."},"LANDCOVER.EDUGEO.LGV_flore":{layer:"LANDCOVER.EDUGEO.LGV_flore",key:"",theme:"edugeo",desc:"Cartographie des principaux sites d’intérêt floristique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Flore le long de la LGV SEA."},"LANDCOVER.EDUGEO.LGV_technique":{layer:"LANDCOVER.EDUGEO.LGV_technique",key:"",theme:"edugeo",desc:"Cartographie des caractéristiques techniques de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Caractéristiques techniques de la LGV SEA."},"LANDCOVER.EDUGEO.TAUX_BOISEMENT_2009-2013":{layer:"LANDCOVER.EDUGEO.TAUX_BOISEMENT_2009-2013",key:"",theme:"edugeo",desc:"Taux de boisement par département sur les années 2009-2013 (année moyenne 2011)",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Taux de boisement (année moyenne 2011)"},"LANDCOVER.FORESTAREAS":{layer:"LANDCOVER.FORESTAREAS",key:"",theme:"environnement",desc:"Cette cartographie représente des zones homogènes du point de vue des types de forêt ou de paysage sur la base de conditions physiques dominantes (climat, sol, relief).",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Régions forestières nationales"},"LANDCOVER.FORESTINVENTORY.V1":{layer:"LANDCOVER.FORESTINVENTORY.V1",key:"",theme:"environnement",desc:"La cartographie forestière est une base de données cartographique des formations végétales forestières et naturelles. Elle couvre l'ensemble du territoire de France métropolitaine. Elle est réalisée par interprétation de photographies aériennes infrarouges et affinée par des contrôles sur le terrain (le seuil minimal de surface cartographiée est de 2,25 ha).",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte forestière v1 (1987-2004)"},"LANDCOVER.FORESTINVENTORY.V2":{layer:"LANDCOVER.FORESTINVENTORY.V2",key:"",theme:"environnement",desc:"Localisation de 32 types de formations végétales sur le territoire. Carte en cours de réalisation depuis 2006.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte forestière (v2 : 2006-)"},"LANDCOVER.GRID.CLC00":{layer:"LANDCOVER.GRID.CLC00",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2000 en 44 postes pour la Métropole, 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2000 a été réalisée à partir de CORINE Land Cover DOM 2006 et de la base des changements 2000-2006 pour les DOM, et à partir d'images satellitaires de l'année 2000 et de données d'appui pour la Métropole.",server:"https://data.geopf.fr/wmts",bbox:[-61.9063,-21.4825,55.9362,51.1827],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"Raster CORINE Land Cover - 2000"},"LANDCOVER.GRID.CLC00R_FR":{layer:"LANDCOVER.GRID.CLC00R_FR",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2000 en 44 postes pour la Métropole. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2000 révisée, dite CLC 2000 révisée, est une correction de CLC 2000 réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-5.68494,41.1779,10.8556,51.1827],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - 2000 révisée"},"LANDCOVER.GRID.CLC00_DOM":{layer:"LANDCOVER.GRID.CLC00_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes sur la métropole et 50 sur les DOMs CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000, dite CLC 2000, a été réalisée à partir d'images satellitaires de l'année 2000 et de données d'appuis",server:"https://data.geopf.fr/wmts",bbox:[-61.9063,-21.4825,55.9362,16.6077],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"Raster CORINE Land Cover - DOM - 2000"},"LANDCOVER.GRID.CLC00_FR":{layer:"LANDCOVER.GRID.CLC00_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2000 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2000, dite CLC 2000, a été réalisée à partir d'images satellitaires de l'année 2000 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-5.68494,41.1779,10.8556,51.1827],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - France métropolitaine - 2000"},"LANDCOVER.GRID.CLC06":{layer:"LANDCOVER.GRID.CLC06",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la Métropole, 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2006 a été réalisée à partir d'images satellitaires prises entre 2005 et 2008 et de données d'appui pour les DOM, et à partir de CLC 2000 révisée et de la base des changements 2000-2006 pour la Métropole.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"Raster CORINE Land Cover - 2006"},"LANDCOVER.GRID.CLC06R":{layer:"LANDCOVER.GRID.CLC06R",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la Métropole, 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires prises entre 2005 et 2008 et de données d'appui pour les DOM, et à partir d'images satellitaires de l'année 2006 et de données d'appui pour la Métropole.",server:"https://data.geopf.fr/wmts",bbox:[-61.9063,-21.4825,55.9362,51.2963],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"Raster CORINE Land Cover - 2006 révisée"},"LANDCOVER.GRID.CLC06R_DOM":{layer:"LANDCOVER.GRID.CLC06R_DOM",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la Métropole et 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires de l'année 2006 pour la Métropole, d'images satellitaires prises entre 2005 et 2008 pour les DOM et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-61.9063,-21.4825,55.9362,16.6077],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"Raster CORINE Land Cover - DOM - 2006 - révisée"},"LANDCOVER.GRID.CLC06R_FR":{layer:"LANDCOVER.GRID.CLC06R_FR",key:"",theme:"clc",desc:"Inventaire biophysique de l'occupation des sols en 2006 en 44 postes pour la métropole . CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006 révisée, dite CLC 2006 révisée, est une correction de CLC 2006 réalisée à partir d'images satellitaires de l'année 2006 pour la métropole, d'images satellitaires prises entre 2005 et 2008 pour les DOM et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-5.91689,41.0278,11.0883,51.2963],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - France métropolitaine - 2006 révisée"},"LANDCOVER.GRID.CLC06_DOM":{layer:"LANDCOVER.GRID.CLC06_DOM",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2006 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de l'observation et des statistiques du ministère chargé de l'environnement. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2006 a été réalisée à partir de CORINE Land Cover DOM 2000 révisée et de la base des changements 200062006.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"Raster CORINE Land Cover - DOM - 2006"},"LANDCOVER.GRID.CLC06_FR":{layer:"LANDCOVER.GRID.CLC06_FR",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2006 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de l'observation et des statistiques du ministère chargé de l'environnement. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2006, dite CLC 2006, a été réalisée à partir de CLC 2000 révisée et de la base des changements 2000-2006.",server:"https://data.geopf.fr/wmts",bbox:[-5.68494,41.1779,10.8556,51.1827],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - France métropolitaine - 2006"},"LANDCOVER.GRID.CLC12":{layer:"LANDCOVER.GRID.CLC12",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2012 en 44 postes pour la Métropole, 50 postes pour les DOM. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 2012, dite CLC 2012, a été réalisée à partir de CORINE Land Cover 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover",tilematrix:"PM",title:"Raster CORINE Land Cover - 2012"},"LANDCOVER.GRID.CLC12_DOM":{layer:"LANDCOVER.GRID.CLC12_DOM",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2012 en 50 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de l'observation et des statistiques du ministère chargé de l'environnement. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover DOM 2012 a été réalisée à partir de CORINE Land Cover DOM 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - DOM",tilematrix:"PM",title:"Raster CORINE Land Cover - DOM - 2012"},"LANDCOVER.GRID.CLC12_FR":{layer:"LANDCOVER.GRID.CLC12_FR",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 2012 en 44 postes. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de l'observation et des statistiques du ministère chargé de l'environnement. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et plus généralement de l'aménagement de l'espace. La base de données CORINE Land Cover 2012, dite CLC 2012, a été réalisée à partir de CLC 2006 révisée et de la base des changements 2006-2012.",server:"https://data.geopf.fr/wmts",bbox:[-5.91689,41.0278,11.0883,51.2963],format:"image/png",minZoom:0,maxZoom:12,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - France métropolitaine - 2012"},"LANDCOVER.GRID.CLC90_FR":{layer:"LANDCOVER.GRID.CLC90_FR",key:"",theme:"clc",desc:"Raster au pas de 25m de l'inventaire biophysique de l'occupation des sols en 1990 en 44 postes pour la Métropole. CORINE Land Cover est une base de données d’occupation des sols produite dans le cadre du programme européen d’observation de la Terre Copernicus. Cet inventaire biophysique de l’occupation des terres fournit une information géographique de référence pour 39 États européens. La continuité du programme et la diffusion des données CORINE Land Cover sont pilotées par l'Agence européenne pour l'environnement. Le producteur pour la France est le Service de la donnée et des études statistiques du ministère chargé de l’écologie. L'utilisation de cette base de données permet des applications variées adaptées aux problématiques de l'environnement et à celles de l'aménagement du territoire : production cartographique, exploitation à des fins statistiques ou bien encore analyses géographiques en combinaison avec d'autres bases de données. Outil de connaissance et d'analyse, CORINE Land Cover apporte également une aide à la décision comme instrument de suivi, de surveillance et de gestion de l'environnement, des milieux naturels et de l'aménagement de l'espace. La base de données CORINE Land Cover 1990, dite CLC 1990, a été réalisée à partir d'images satellitaires de l'année 1990 et de données d'appui.",server:"https://data.geopf.fr/wmts",bbox:[-5.68494,41.1779,10.8556,51.1827],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - France métropolitaine",tilematrix:"PM",title:"Raster CORINE Land Cover - 1990"},"LANDCOVER.HR.DLT.CLC12":{layer:"LANDCOVER.HR.DLT.CLC12",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le type de forêt cartographie la distinction feuillus ou résineux majoritairement présents dans les pixels, avec un taux de couvert arboré de plus de 10%. Ce produit permet d’approcher le plus possible des forêts au sens de la définition de l’Organisation des Nations unies pour l'alimentation et l'agriculture (FAO). La surface minimale cartographiée est de 0,52 ha, ce qui correspond à un groupement de 13 pixels. Les valeurs cartographiées sont : - 0 : Zone non-arborée - 1 : Feuillus - 2 : Conifères - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - type de forêts",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du type de forêts - Résolution 20m - 2012"},"LANDCOVER.HR.DLT.CLC15":{layer:"LANDCOVER.HR.DLT.CLC15",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le type de forêt cartographie la distinction feuillus ou résineux majoritairement présents dans les pixels, avec un taux de couvert arboré de plus de 10%. Ce produit permet d’approcher le plus possible des forêts au sens de la définition de l’Organisation des Nations unies pour l'alimentation et l'agriculture (FAO). La surface minimale cartographiée est de 0,52 ha, ce qui correspond à un groupement de 13 pixels. Les valeurs cartographiées sont : - 0 : Zone non-arborée - 1 : Feuillus - 2 : Conifères - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - type de forêts",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du type de forêts - Résolution 20m - 2015"},"LANDCOVER.HR.GRA.CLC15":{layer:"LANDCOVER.HR.GRA.CLC15",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de la donnée et des études statistiques du ministère chargé de l’écologie a la responsabilité des vérifications et des améliorations de ces produits. Les valeurs cartographiées sont : - 0 : Zone non-herbeuse - 1 : Zone herbeuse et non-arborée - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - prairies",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution des prairies - Résolution 20m - 2015"},"LANDCOVER.HR.IMD.CLC12":{layer:"LANDCOVER.HR.IMD.CLC12",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le taux d’imperméabilisation des sols cartographie le pourcentage des sols imperméabilisés par pixels de 20 m de côté. Le revêtement des sols imperméabilisés, issu de l’artificialisation des terres, est maintenu en général sur de longues périodes. La surface minimale cartographiée est de 20 m x 20 m. Les valeurs cartographiées sont : - 0 : Zone non-imperméable - 1-100 : Taux d'imperméabilisation - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - taux d'imperméabilisation des sols",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du taux d'imperméabilisation des sols - Résolution 20m - 2012"},"LANDCOVER.HR.IMD.CLC15":{layer:"LANDCOVER.HR.IMD.CLC15",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le taux d’imperméabilisation des sols cartographie le pourcentage des sols imperméabilisés par pixels de 20 m de côté. Le revêtement des sols imperméabilisés, issu de l’artificialisation des terres, est maintenu en général sur de longues périodes. La surface minimale cartographiée est de 20 m x 20 m. Les valeurs cartographiées sont : - 0 : Zone non-imperméable - 1-100 : Taux d'imperméabilisation - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - taux d'imperméabilisation des sols",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du taux d'imperméabilisation des sols - Résolution 20m - 2015"},"LANDCOVER.HR.TCD.CLC12":{layer:"LANDCOVER.HR.TCD.CLC12",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le taux de couvert arboré cartographie le pourcentage de couverture arborée par pixels de 20 m de côté. Sont ainsi cartographiées les surfaces arborées en zones urbaines, agricoles ou forestières. La surface minimale cartographiée est de 20 m x 20 m. Les valeurs cartographiées sont : - 0 : Zone non-arborée - 1-100 : Taux de couvert arboré - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - taux de couvert arboré",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du taux de couvert arboré - Résolution 20m - 2012"},"LANDCOVER.HR.TCD.CLC15":{layer:"LANDCOVER.HR.TCD.CLC15",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Le taux de couvert arboré cartographie le pourcentage de couverture arborée par pixels de 20 m de côté. Sont ainsi cartographiées les surfaces arborées en zones urbaines, agricoles ou forestières. La surface minimale cartographiée est de 20 m x 20 m. Les valeurs cartographiées sont : - 0 : Zone non-arborée - 1-100 : Taux de couvert arboré - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - taux de couvert arboré",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution du taux de couvert arboré - Résolution 20m - 2015"},"LANDCOVER.HR.WAW.CLC15":{layer:"LANDCOVER.HR.WAW.CLC15",key:"",theme:"clc",desc:"Les couches haute résolution sont des couches thématiques d’occupation des sols, produites par le service Territoire du programme européen d'observation de la Terre Copernicus. Ce programme est coordonné par la Commission européenne et associe l’Agence spatiale européenne, l’Agence européenne pour l’environnement ainsi que les États membres. Ces données sont produites automatiquement à partir d’images satellite. Elles sont ensuite vérifiées puis améliorées manuellement. La production et la diffusion de ces couches haute résolution sont pilotées par l'Agence européenne pour l'environnement. Pour la France, le Service de l'observation et des statistiques du ministère chargé de l'environnement a la responsabilité des vérifications et des améliorations de ces produits. Les zones humides et surfaces en eaux permanentes cartographient la présence ou non de surfaces en eau permanentes et la présence ou non de zones humides. Ces surfaces sont identifiées à partir d’analyses d’images satellite prises à différentes saisons (de 4 à 5 images en moyenne) et différentes années. Sont ainsi cartographiées les surfaces en eau sur plusieurs dates de l’analyse. Les zones humides sont définies comme étant les zones où l'eau est le premier facteur d'influence de l'environnement et de la faune et de la flore associées. Elles surviennent là où la nappe phréatique affleure ou est proche de la surface du sol, ou quand la terre est recouverte d'une faible épaisseur d'eau. Les zones cartographiées sont recouvertes d'eau au moins une fois l'une des années observées ou présentent une humidité importante et constante. Elles sont situées dans des zones où la pente est inférieure à 10 %. Enfin, les zones cartographiées sont majoritairement couvertes d’hydrophytes ou de macrophytes. La surface minimale cartographiée est de 0,16 ha, ce qui correspond à un groupement de 4 pixels. Les valeurs cartographiées sont : - 0 : Zone non-humide - 1 : Surface en eau permanente - 2 : Surface en eau temporaire - 3 : Zone humide permanente - 4 : Zone humide temporaire - 254 : Inclassable (nuage, donnée satellite indisponible, ombre ou neige) - 255 : En dehors de la zone d'étude Ces données haute résolution peuvent être utilisées indépendamment ou en complément de CORINE Land Cover. En effet, CLC permet de cartographier des polygones homogènes d’occupation des sols tels que du tissu urbain discontinu et des zones industrielles ou commerciales. Les couches haute résolution permettent alors d’apporter une nouvelle information pour chacune de ces zones, en précisant leur degré d’imperméabilisation, leur taux de couvert arboré, etc.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:0,maxZoom:13,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"CORINE Land Cover - HR - zones humides et surfaces en eaux permanentes",tilematrix:"PM",title:"Raster CORINE Land Cover - Couche haute résolution des zones humides et surfaces en eaux permanentes - Résolution 20m - 2012"},"LANDCOVER.SYLVOECOREGIONS":{layer:"LANDCOVER.SYLVOECOREGIONS",key:"",theme:"environnement",desc:"Découpage de la France métropolitaine prenant en compte les facteurs biogéographiques déterminant la production forestière et la répartition des grands types d’habitat forestier.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Sylvoécorégions"},"LANDCOVER.SYLVOECOREGIONS.ALLUVIUM":{layer:"LANDCOVER.SYLVOECOREGIONS.ALLUVIUM",key:"",theme:"environnement",desc:"Affichage des cinq sylvoécorégions d’alluvions récentes correspondant aux cinq vallées des bassins des grands fleuves français et de leurs affluents, à enjeux importants.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Sylvoécorégions d'alluvions récentes"},"LANDUSE.AGRICULTURE.LATEST":{layer:"LANDUSE.AGRICULTURE.LATEST",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants Latest",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) Latest"},"LANDUSE.AGRICULTURE2007":{layer:"LANDUSE.AGRICULTURE2007",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2007.",server:"https://data.geopf.fr/wmts",bbox:[-63.2635,-21.419,56.0237,51.2203],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2007"},"LANDUSE.AGRICULTURE2008":{layer:"LANDUSE.AGRICULTURE2008",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2008.",server:"https://data.geopf.fr/wmts",bbox:[-63.2635,-21.419,56.0237,51.2203],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2008"},"LANDUSE.AGRICULTURE2009":{layer:"LANDUSE.AGRICULTURE2009",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2009.",server:"https://data.geopf.fr/wmts",bbox:[-63.2635,-21.419,56.0237,51.2203],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2009"},"LANDUSE.AGRICULTURE2010":{layer:"LANDUSE.AGRICULTURE2010",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de culture déclarées par les exploitants en 2010.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2010"},"LANDUSE.AGRICULTURE2011":{layer:"LANDUSE.AGRICULTURE2011",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de culture déclarées par les exploitants en 2011.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2011"},"LANDUSE.AGRICULTURE2012":{layer:"LANDUSE.AGRICULTURE2012",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de culture déclarées par les exploitants en 2012",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2012"},"LANDUSE.AGRICULTURE2013":{layer:"LANDUSE.AGRICULTURE2013",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2013",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2013"},"LANDUSE.AGRICULTURE2014":{layer:"LANDUSE.AGRICULTURE2014",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2014",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2014"},"LANDUSE.AGRICULTURE2015":{layer:"LANDUSE.AGRICULTURE2015",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2015.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2015"},"LANDUSE.AGRICULTURE2016":{layer:"LANDUSE.AGRICULTURE2016",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2016.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2016"},"LANDUSE.AGRICULTURE2017":{layer:"LANDUSE.AGRICULTURE2017",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2017.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2017"},"LANDUSE.AGRICULTURE2018":{layer:"LANDUSE.AGRICULTURE2018",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2018",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2018"},"LANDUSE.AGRICULTURE2019":{layer:"LANDUSE.AGRICULTURE2019",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2019",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2019"},"LANDUSE.AGRICULTURE2020":{layer:"LANDUSE.AGRICULTURE2020",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2020",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2020"},"LANDUSE.AGRICULTURE2021":{layer:"LANDUSE.AGRICULTURE2021",key:"",theme:"agriculture",desc:"Registre parcellaire graphique : zones de cultures déclarées par les exploitants en 2021",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique 2021"},"LGV_EDUGEO_ARCHEOLOGIE_PYR-PNG_FXX_WM_20170210":{layer:"LGV_EDUGEO_ARCHEOLOGIE_PYR-PNG_FXX_WM_20170210",key:"",theme:"edugeo",desc:"Cartographie des principaux sites de fouille archéologique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Fouilles archéologiques le long de la LGV SEA."},"LGV_EDUGEO_FAUNE_PYR-PNG_FXX_WM_20170215":{layer:"LGV_EDUGEO_FAUNE_PYR-PNG_FXX_WM_20170215",key:"",theme:"edugeo",desc:"Cartographie des principaux sites d’intérêt faunistique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Faune le long de la LGV SEA."},"LGV_EDUGEO_FLORE_PYR-PNG_FXX_WM_20170213":{layer:"LGV_EDUGEO_FLORE_PYR-PNG_FXX_WM_20170213",key:"",theme:"edugeo",desc:"Cartographie des principaux sites d’intérêt floristique le long de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Flore le long de la LGV SEA."},"LGV_EDUGEO_TECHNIQUE_PYR-PNG_FXX_WM_20170215":{layer:"LGV_EDUGEO_TECHNIQUE_PYR-PNG_FXX_WM_20170215",key:"",theme:"edugeo",desc:"Cartographie des caractéristiques techniques de la LGV SEA.",server:"https://data.geopf.fr/wmts",bbox:[-.898315,44.8631,.898315,47.4145],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Caractéristiques techniques de la LGV SEA."},"LIMITES_ADMINISTRATIVES_EXPRESS.LATEST":{layer:"LIMITES_ADMINISTRATIVES_EXPRESS.LATEST",key:"",theme:"administratif",desc:"Limites administratives mises à jour en continu, édition Juillet 2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Limites administratives mises à jour en continu."},LOT_CHASSE:{layer:"LOT_CHASSE",key:"",theme:"environnement",desc:"Lots de chasse",server:"https://data.geopf.fr/wmts",bbox:[-5.15053,41.3247,9.57115,51.0992],format:"application/x-protobuf",minZoom:14,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Lots de chasse"},"LSEP-CRUE_PYR-PNG_WLD_WM_EDUGEO_20130128":{layer:"LSEP-CRUE_PYR-PNG_WLD_WM_EDUGEO_20130128",key:"",theme:"edugeo",desc:"Carte des plus hautes eaux connues (PHEC) sur le bassin de la Seine : crue de la seine et de ses affluents en 1910, ainsi que d'autres crues à des dates postérieures sur d'autres cours d'eau.",server:"https://data.geopf.fr/wmts",bbox:[.419457,47.4163,5.43248,50.064],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Crues du bassin de la Seine - PHEC"},"NATURALRISKZONES.1910FLOODEDWATERSHEDS":{layer:"NATURALRISKZONES.1910FLOODEDWATERSHEDS",key:"",theme:"autre",desc:"Carte des plus hautes eaux connues (PHEC) sur le bassin de la Seine : crue de la seine et de ses affluents en 1910, ainsi que d'autres crues à des dates postérieures sur d'autres cours d'eau.",server:"https://data.geopf.fr/wmts",bbox:[.419457,47.4163,5.43248,50.064],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Crues du bassin de la Seine - PHEC"},"OCSGE.CONSTRUCTIONS":{layer:"OCSGE.CONSTRUCTIONS",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br>",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle - zones construites"},"OCSGE.CONSTRUCTIONS.2002":{layer:"OCSGE.CONSTRUCTIONS.2002",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2002",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2002 - zones contruites"},"OCSGE.CONSTRUCTIONS.2011":{layer:"OCSGE.CONSTRUCTIONS.2011",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2011",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2011 - zones contruites"},"OCSGE.CONSTRUCTIONS.2014":{layer:"OCSGE.CONSTRUCTIONS.2014",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2014",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2014 - zones contruites"},"OCSGE.CONSTRUCTIONS.2016":{layer:"OCSGE.CONSTRUCTIONS.2016",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2016",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2016 - zones contruites"},"OCSGE.CONSTRUCTIONS.2017":{layer:"OCSGE.CONSTRUCTIONS.2017",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG).</br>",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2017 - zones contruites"},"OCSGE.CONSTRUCTIONS.2019":{layer:"OCSGE.CONSTRUCTIONS.2019",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l’IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l’usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d’occupation des sols à grande échelle (CNIG). Source : IGN - 2019",server:"https://data.geopf.fr/wmts",bbox:[-.291052,43.3043,1.2122,44.0864],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2019 - zones contruites"},"OCSGE.COUVERTURE":{layer:"OCSGE.COUVERTURE",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle - couverture"},"OCSGE.COUVERTURE.2002":{layer:"OCSGE.COUVERTURE.2002",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2002",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle 2002 - couverture"},"OCSGE.COUVERTURE.2011":{layer:"OCSGE.COUVERTURE.2011",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2011",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2011 - couverture"},"OCSGE.COUVERTURE.2014":{layer:"OCSGE.COUVERTURE.2014",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2014",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2014 - couverture"},"OCSGE.COUVERTURE.2016":{layer:"OCSGE.COUVERTURE.2016",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2016",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2016 - couverture"},"OCSGE.COUVERTURE.2017":{layer:"OCSGE.COUVERTURE.2017",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2017",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2017 - couverture"},"OCSGE.COUVERTURE.2019":{layer:"OCSGE.COUVERTURE.2019",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG). Source : IGN - 2019",server:"https://data.geopf.fr/wmts",bbox:[-.291052,43.3043,1.2122,44.0864],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2019 - couverture"},"OCSGE.USAGE":{layer:"OCSGE.USAGE",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle - usage"},"OCSGE.USAGE.2002":{layer:"OCSGE.USAGE.2002",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2002",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle 2002 - usage"},"OCSGE.USAGE.2011":{layer:"OCSGE.USAGE.2011",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2011",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2011 - usage"},"OCSGE.USAGE.2014":{layer:"OCSGE.USAGE.2014",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2014",server:"https://data.geopf.fr/wmts",bbox:[-5.13902,41.366,9.55982,51.089],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Occupation du sol grande échelle 2014 - usage"},"OCSGE.USAGE.2016":{layer:"OCSGE.USAGE.2016",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br> Source : IGN - 2016",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2016 - usage"},"OCSGE.USAGE.2017":{layer:"OCSGE.USAGE.2017",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG).</br>",server:"https://data.geopf.fr/wmts",bbox:[-61.6644,14.2395,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2017 - usage"},"OCSGE.USAGE.2019":{layer:"OCSGE.USAGE.2019",key:"",theme:"ocsge",desc:"La composante Occupation du sol grande échelle retenue par l'IGN partitionne le territoire en deux vues, physionomique (la couverture) et fonctionnel (l'usage principal). La zone construite, calculée à partir de ces deux informations, délimite les espaces construits des espaces naturels, agricoles et forestiers. Les données respectent les préconisations nationales pour la production des bases de données d'occupation des sols à grande échelle (CNIG) Source : IGN - 2019",server:"https://data.geopf.fr/wmts",bbox:[-.291052,43.3043,1.2122,44.0864],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"nolegend",tilematrix:"PM",title:"Occupation du sol grande échelle 2019 - usage"},"OCSGE.VISU.2016":{layer:"OCSGE.VISU.2016",key:"",theme:"ocsge",desc:"Résultat IA aggloméré à l'ortho 2016",server:"https://data.geopf.fr/wmts",bbox:[-.318517,43.2815,1.22575,44.0543],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Visualisation OCSGE 2016"},"OCSGE.VISU.2019":{layer:"OCSGE.VISU.2019",key:"",theme:"ocsge",desc:"Résultat IA aggloméré à l'ortho 2019",server:"https://data.geopf.fr/wmts",bbox:[-.321664,43.2815,1.22575,44.1082],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Visualisation OCSGE 2019"},OCSGE_2016:{layer:"OCSGE_2016",key:"",theme:"ocsge",desc:"OCS GE 2016",server:"https://data.geopf.fr/wmts",bbox:[-.282898,43.3107,1.20369,44.0802],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"OCS GE 2016"},OCSGE_2019:{layer:"OCSGE_2019",key:"",theme:"ocsge",desc:"OCS GE 2019",server:"https://data.geopf.fr/wmts",bbox:[-.282898,43.3107,1.20369,44.0802],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"OCS GE 2019"},"ORTHO-EDUGEO_PYR-PNG_WLD_WM":{layer:"ORTHO-EDUGEO_PYR-PNG_WLD_WM",key:"",theme:"edugeo",desc:"Photographie - VANNES GOLFE DU MORBIHAN 1970",server:"https://data.geopf.fr/wmts",bbox:[-3.20264,47.4607,-2.62716,47.7138],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - VANNES GOLFE DU MORBIHAN 1970"},"ORTHO-EXPRESS-2020_PYR-JPG_WLD_WM_WMTS2":{layer:"ORTHO-EXPRESS-2020_PYR-JPG_WLD_WM_WMTS2",key:"",theme:"orthohisto",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2020"},"ORTHOIMAGERY.EDUGEO.AJACCIO1975":{layer:"ORTHOIMAGERY.EDUGEO.AJACCIO1975",key:"",theme:"edugeo",desc:"Photographie - Ajaccio 1975",server:"https://data.geopf.fr/wmts",bbox:[8.65713,41.8334,8.98239,42.0846],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - AJACCIO 1975"},"ORTHOIMAGERY.EDUGEO.AJACCIO1990":{layer:"ORTHOIMAGERY.EDUGEO.AJACCIO1990",key:"",theme:"edugeo",desc:"Photographie - Ajaccio 1990",server:"https://data.geopf.fr/wmts",bbox:[8.64462,41.7868,8.98239,42.0939],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - AJACCIO 1990"},"ORTHOIMAGERY.EDUGEO.ARCACHON2010":{layer:"ORTHOIMAGERY.EDUGEO.ARCACHON2010",key:"",theme:"edugeo",desc:"Zone d'ARCACHON - 2010",server:"https://data.geopf.fr/wmts",bbox:[-1.87654,44.2289,-.750618,45.0301],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT ARCACHON 2010"},"ORTHOIMAGERY.EDUGEO.ARRAS-LENS-BETHUNE2008":{layer:"ORTHOIMAGERY.EDUGEO.ARRAS-LENS-BETHUNE2008",key:"",theme:"edugeo",desc:"Zone de ARRAS LENS BETHUNE - 2008",server:"https://data.geopf.fr/wmts",bbox:[1.75144,49.929,3.25268,50.8068],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT ARRAS LENS BETHUNE 2008"},"ORTHOIMAGERY.EDUGEO.BELFORT-MONTBELLIARD1951":{layer:"ORTHOIMAGERY.EDUGEO.BELFORT-MONTBELLIARD1951",key:"",theme:"edugeo",desc:"Photographie - BELFORT MONTBELLIARD 1951",server:"https://data.geopf.fr/wmts",bbox:[6.69301,47.4607,6.96824,47.6801],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BELFORT MONTBELLIARD 1951"},"ORTHOIMAGERY.EDUGEO.BERRY-SUD1950":{layer:"ORTHOIMAGERY.EDUGEO.BERRY-SUD1950",key:"",theme:"edugeo",desc:"Photographie - BERRY SUD 1950",server:"https://data.geopf.fr/wmts",bbox:[1.23852,46.3669,1.48873,46.4531],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BERRY SUD 1950"},"ORTHOIMAGERY.EDUGEO.BERRY-SUD1970":{layer:"ORTHOIMAGERY.EDUGEO.BERRY-SUD1970",key:"",theme:"edugeo",desc:"Photographie - BERRY SUD 1970",server:"https://data.geopf.fr/wmts",bbox:[1.01333,46.6081,1.42617,46.7283],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BERRY SUD 1970"},"ORTHOIMAGERY.EDUGEO.BETHUNE1963":{layer:"ORTHOIMAGERY.EDUGEO.BETHUNE1963",key:"",theme:"edugeo",desc:"Photographie - BETHUNE 1963",server:"https://data.geopf.fr/wmts",bbox:[2.62716,50.3939,2.95243,50.5054],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BETHUNE 1963"},"ORTHOIMAGERY.EDUGEO.BETHUNE1964":{layer:"ORTHOIMAGERY.EDUGEO.BETHUNE1964",key:"",theme:"edugeo",desc:"Photographie - BETHUNE 1964",server:"https://data.geopf.fr/wmts",bbox:[2.83984,50.33,3.29021,50.4098],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BETHUNE 1964"},"ORTHOIMAGERY.EDUGEO.BETHUNE1988":{layer:"ORTHOIMAGERY.EDUGEO.BETHUNE1988",key:"",theme:"edugeo",desc:"Photographie - BETHUNE 1988",server:"https://data.geopf.fr/wmts",bbox:[2.5521,50.322,3.24017,50.4895],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BETHUNE 1988"},"ORTHOIMAGERY.EDUGEO.BIARRITZ1977":{layer:"ORTHOIMAGERY.EDUGEO.BIARRITZ1977",key:"",theme:"edugeo",desc:"Photographie de Biarritz 1977",server:"https://data.geopf.fr/wmts",bbox:[-1.8265,43.3165,-1.18848,43.7157],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Biarritz 1977"},"ORTHOIMAGERY.EDUGEO.BIARRTITZ1979":{layer:"ORTHOIMAGERY.EDUGEO.BIARRTITZ1979",key:"",theme:"edugeo",desc:"Photographie - Biarritz 1979",server:"https://data.geopf.fr/wmts",bbox:[-1.13844,43.6795,-.975803,43.7609],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BIARRTITZ 1979"},"ORTHOIMAGERY.EDUGEO.BORDEAUX2003":{layer:"ORTHOIMAGERY.EDUGEO.BORDEAUX2003",key:"",theme:"edugeo",desc:"Zone de Bordeaux 2003",server:"https://data.geopf.fr/wmts",bbox:[-1.12593,44.6754,.125103,45.5582],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT BORDEAUX 2003"},"ORTHOIMAGERY.EDUGEO.BOURG-ST-MAURICE1956":{layer:"ORTHOIMAGERY.EDUGEO.BOURG-ST-MAURICE1956",key:"",theme:"edugeo",desc:"Photographie - BOURG SAINT MAURICE 1956",server:"https://data.geopf.fr/wmts",bbox:[6.61795,45.4793,6.85564,45.6282],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - BOURG SAINT MAURICE 1956"},"ORTHOIMAGERY.EDUGEO.CAEN1991":{layer:"ORTHOIMAGERY.EDUGEO.CAEN1991",key:"",theme:"edugeo",desc:"Photographie - CAEN 1991",server:"https://data.geopf.fr/wmts",bbox:[-.975803,49.035,.0250206,49.4109],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - CAEN 1991"},"ORTHOIMAGERY.EDUGEO.CAP-D-AGDE1968":{layer:"ORTHOIMAGERY.EDUGEO.CAP-D-AGDE1968",key:"",theme:"edugeo",desc:"Photographie du Cap d'Agde 1968",server:"https://data.geopf.fr/wmts",bbox:[3.02749,43.1889,3.60297,43.3984],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Le Cap d'Agde 1968"},"ORTHOIMAGERY.EDUGEO.CAP-D-AGDE2008":{layer:"ORTHOIMAGERY.EDUGEO.CAP-D-AGDE2008",key:"",theme:"edugeo",desc:"Zone du Cap d'Agde - 2008",server:"https://data.geopf.fr/wmts",bbox:[3.12757,43.1433,3.75309,43.5073],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT Cap d'Agde 2008"},"ORTHOIMAGERY.EDUGEO.CAP-DAGE1981":{layer:"ORTHOIMAGERY.EDUGEO.CAP-DAGE1981",key:"",theme:"edugeo",desc:"Photographie du Cap d'Agde 1981",server:"https://data.geopf.fr/wmts",bbox:[3.01498,43.1889,3.66552,43.3984],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Le Cap d'Agde 1981"},"ORTHOIMAGERY.EDUGEO.CLERMONT-FERRAND1965":{layer:"ORTHOIMAGERY.EDUGEO.CLERMONT-FERRAND1965",key:"",theme:"edugeo",desc:"Photographie - CLERMONT FERRAND 1965",server:"https://data.geopf.fr/wmts",bbox:[2.82733,45.7156,3.29021,45.9596],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - CLERMONT FERRAND 1965"},"ORTHOIMAGERY.EDUGEO.CLERMONT-FERRAND1985":{layer:"ORTHOIMAGERY.EDUGEO.CLERMONT-FERRAND1985",key:"",theme:"edugeo",desc:"Photographie - CLERMONT FERRAND 1985",server:"https://data.geopf.fr/wmts",bbox:[2.88988,45.7069,3.2777,45.9423],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - CLERMONT FERRAND 1985"},"ORTHOIMAGERY.EDUGEO.CREIL-SUD-PICARDIE1975":{layer:"ORTHOIMAGERY.EDUGEO.CREIL-SUD-PICARDIE1975",key:"",theme:"edugeo",desc:"Photographie - CREIL SUD PICARDIE 1975",server:"https://data.geopf.fr/wmts",bbox:[2.25185,49.076,2.96494,49.5085],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - CREIL SUD PICARDIE 1975"},"ORTHOIMAGERY.EDUGEO.DIJON1971":{layer:"ORTHOIMAGERY.EDUGEO.DIJON1971",key:"",theme:"edugeo",desc:"Photographie de Dijon 1971",server:"https://data.geopf.fr/wmts",bbox:[4.87902,47.1893,5.24181,47.3676],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Dijon 1971"},"ORTHOIMAGERY.EDUGEO.GRENOBLE1966":{layer:"ORTHOIMAGERY.EDUGEO.GRENOBLE1966",key:"",theme:"edugeo",desc:"Photographie de Grenoble 1966",server:"https://data.geopf.fr/wmts",bbox:[5.61712,45.0655,5.94239,45.286],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Grenoble 1966"},"ORTHOIMAGERY.EDUGEO.GRENOBLE1989":{layer:"ORTHOIMAGERY.EDUGEO.GRENOBLE1989",key:"",theme:"edugeo",desc:"Photographie de Grenoble 1989",server:"https://data.geopf.fr/wmts",bbox:[5.54206,45.0566,5.96741,45.3387],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Grenoble 1989"},"ORTHOIMAGERY.EDUGEO.GUADELOUPE1984":{layer:"ORTHOIMAGERY.EDUGEO.GUADELOUPE1984",key:"",theme:"edugeo",desc:"Photographie - GUADELOUPE 1984",server:"https://data.geopf.fr/wmts",bbox:[-61.7633,15.9411,-61.4756,16.3376],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - GUADELOUPE 1984"},"ORTHOIMAGERY.EDUGEO.GUYANE1955":{layer:"ORTHOIMAGERY.EDUGEO.GUYANE1955",key:"",theme:"edugeo",desc:"Photographie - Guyane 1955",server:"https://data.geopf.fr/wmts",bbox:[-54.1321,5.384,-53.5065,5.79487],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - GUYANE 1955"},"ORTHOIMAGERY.EDUGEO.LA-REUNION1961":{layer:"ORTHOIMAGERY.EDUGEO.LA-REUNION1961",key:"",theme:"edugeo",desc:"Photographie - LA REUNION 1961",server:"https://data.geopf.fr/wmts",bbox:[55.258,-21.3906,55.5833,-20.8538],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LA REUNION 1961"},"ORTHOIMAGERY.EDUGEO.LA-REUNION1980":{layer:"ORTHOIMAGERY.EDUGEO.LA-REUNION1980",key:"",theme:"edugeo",desc:"Photographie - LA REUNION 1980",server:"https://data.geopf.fr/wmts",bbox:[55.1579,-21.4372,55.6583,-20.7836],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LA REUNION 1980"},"ORTHOIMAGERY.EDUGEO.LA-REUNION1989":{layer:"ORTHOIMAGERY.EDUGEO.LA-REUNION1989",key:"",theme:"edugeo",desc:"Photographie - LA REUNION 1989",server:"https://data.geopf.fr/wmts",bbox:[55.2079,-21.4022,55.7334,-20.8538],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LA REUNION 1989"},"ORTHOIMAGERY.EDUGEO.LA-REUNION2010":{layer:"ORTHOIMAGERY.EDUGEO.LA-REUNION2010",key:"",theme:"edugeo",desc:"Zone de la Réunion - 2010",server:"https://data.geopf.fr/wmts",bbox:[55.0453,-21.4954,55.921,-20.6783],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT Ls Réunion 2010"},"ORTHOIMAGERY.EDUGEO.LA-ROCHELLE-ROCHEFORT1973":{layer:"ORTHOIMAGERY.EDUGEO.LA-ROCHELLE-ROCHEFORT1973",key:"",theme:"edugeo",desc:"Photographie de La Rochelle Rochefort 1973",server:"https://data.geopf.fr/wmts",bbox:[-1.37613,46.0726,-1.03835,46.2286],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LA-ROCHELLE-ROCHEFORT 1973"},"ORTHOIMAGERY.EDUGEO.LE-HAVRE1955":{layer:"ORTHOIMAGERY.EDUGEO.LE-HAVRE1955",key:"",theme:"edugeo",desc:"Photographie du Havre 1955",server:"https://data.geopf.fr/wmts",bbox:[.0500412,49.4597,.387819,49.5409],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Le Havre 1955"},"ORTHOIMAGERY.EDUGEO.LE-HAVRE1964":{layer:"ORTHOIMAGERY.EDUGEO.LE-HAVRE1964",key:"",theme:"edugeo",desc:"Photographie du Havre 1964",server:"https://data.geopf.fr/wmts",bbox:[.0500412,49.4434,.375309,49.622],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Le Havre 1964"},"ORTHOIMAGERY.EDUGEO.LE-HAVRE2008":{layer:"ORTHOIMAGERY.EDUGEO.LE-HAVRE2008",key:"",theme:"edugeo",desc:"Zone du HAVRE - 2008",server:"https://data.geopf.fr/wmts",bbox:[-.375309,49.035,1.00082,49.8484],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT LE HAVRE 2008"},"ORTHOIMAGERY.EDUGEO.LIMOGES1974":{layer:"ORTHOIMAGERY.EDUGEO.LIMOGES1974",key:"",theme:"edugeo",desc:"Photographie de Limoges 1974",server:"https://data.geopf.fr/wmts",bbox:[1.00082,45.7069,1.42617,45.9596],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Limoges 1974"},"ORTHOIMAGERY.EDUGEO.LYON1965":{layer:"ORTHOIMAGERY.EDUGEO.LYON1965",key:"",theme:"edugeo",desc:"Photographie - LYON 1965",server:"https://data.geopf.fr/wmts",bbox:[4.71638,45.5494,5.07918,45.8987],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LYON 1965"},"ORTHOIMAGERY.EDUGEO.LYON1984":{layer:"ORTHOIMAGERY.EDUGEO.LYON1984",key:"",theme:"edugeo",desc:"Photographie - LYON 1984",server:"https://data.geopf.fr/wmts",bbox:[4.70387,45.7069,5.17926,45.8726],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LYON 1984"},"ORTHOIMAGERY.EDUGEO.LYON1988":{layer:"ORTHOIMAGERY.EDUGEO.LYON1988",key:"",theme:"edugeo",desc:"Photographie - LYON 1988",server:"https://data.geopf.fr/wmts",bbox:[4.62881,45.5319,5.12922,45.9161],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - LYON 1988"},"ORTHOIMAGERY.EDUGEO.LYON2008":{layer:"ORTHOIMAGERY.EDUGEO.LYON2008",key:"",theme:"edugeo",desc:"Zone de LYON - 2008",server:"https://data.geopf.fr/wmts",bbox:[4.50371,45.2067,5.75474,45.9944],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT LYON 2008"},"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1965":{layer:"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1965",key:"",theme:"edugeo",desc:"Photographie de Marne la Vallée 1965",server:"https://data.geopf.fr/wmts",bbox:[2.40198,48.846,2.93992,48.9858],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Marne La Vallée 1965"},"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1977":{layer:"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1977",key:"",theme:"edugeo",desc:"Photographie de Marne la Vallée 1977",server:"https://data.geopf.fr/wmts",bbox:[2.48955,48.8131,2.92741,48.9694],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Marne La Vallée 1977"},"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1987":{layer:"ORTHOIMAGERY.EDUGEO.MARNE-LA-VALLEE1987",key:"",theme:"edugeo",desc:"Photographie de Marne la Vallée 1987",server:"https://data.geopf.fr/wmts",bbox:[2.47704,48.8625,2.92741,48.9447],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Marne la Vallée 1987"},"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1969":{layer:"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1969",key:"",theme:"edugeo",desc:"Photographie MARSEILLE MARTIGUES1969",server:"https://data.geopf.fr/wmts",bbox:[5.20428,43.1798,5.69219,43.3984],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - MARSEILLE MARTIGUES 1969"},"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1980":{layer:"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1980",key:"",theme:"edugeo",desc:"Photographie MARSEILLE MARTIGUES1980",server:"https://data.geopf.fr/wmts",bbox:[4.67885,43.3165,5.29186,43.5708],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - MARSEILLE MARTIGUES 1980"},"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1987":{layer:"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1987",key:"",theme:"edugeo",desc:"Photographie MARSEILLE MARTIGUES1987",server:"https://data.geopf.fr/wmts",bbox:[4.65383,43.3165,5.1042,43.5708],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - MARSEILLE MARTIGUES 1987"},"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1988":{layer:"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES1988",key:"",theme:"edugeo",desc:"Photographie MARSEILLE MARTIGUES1988",server:"https://data.geopf.fr/wmts",bbox:[4.91655,43.3711,5.39194,43.5708],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - MARSEILLE MARTIGUES 1988"},"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES2010":{layer:"ORTHOIMAGERY.EDUGEO.MARSEILLE-MARTIGUES2010",key:"",theme:"edugeo",desc:"Zone de MARSEILLE-MARTIGUES - 2010",server:"https://data.geopf.fr/wmts",bbox:[5.25433,43.1433,5.75474,43.4165],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT MARSEILLE-MARTIGUES 2010"},"ORTHOIMAGERY.EDUGEO.MARTINIQUE1988":{layer:"ORTHOIMAGERY.EDUGEO.MARTINIQUE1988",key:"",theme:"edugeo",desc:"Photographie de la Martinique 1988",server:"https://data.geopf.fr/wmts",bbox:[-61.1378,14.3713,-60.8251,14.7104],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - La Martinique 1988"},"ORTHOIMAGERY.EDUGEO.METZ-NANCY1982":{layer:"ORTHOIMAGERY.EDUGEO.METZ-NANCY1982",key:"",theme:"edugeo",desc:"Photographie - METZ NANCY 1982",server:"https://data.geopf.fr/wmts",bbox:[5.9549,48.5902,6.43029,49.3376],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - METZ NANCY 1982"},"ORTHOIMAGERY.EDUGEO.NANTES1971":{layer:"ORTHOIMAGERY.EDUGEO.NANTES1971",key:"",theme:"edugeo",desc:"Photographie de Nantes 1971",server:"https://data.geopf.fr/wmts",bbox:[-2.27687,47.1042,-1.40115,47.3591],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Nantes 1971"},"ORTHOIMAGERY.EDUGEO.PARIS1949":{layer:"ORTHOIMAGERY.EDUGEO.PARIS1949",key:"",theme:"edugeo",desc:"Photographie - Paris 1949",server:"https://data.geopf.fr/wmts",bbox:[2.20181,48.7636,2.52708,48.9529],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Paris 1949"},"ORTHOIMAGERY.EDUGEO.PARIS1965":{layer:"ORTHOIMAGERY.EDUGEO.PARIS1965",key:"",theme:"edugeo",desc:"Photographie - Paris 1965",server:"https://data.geopf.fr/wmts",bbox:[2.02667,48.846,2.48955,48.9858],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Paris 1965"},"ORTHOIMAGERY.EDUGEO.PARIS2010SPOT":{layer:"ORTHOIMAGERY.EDUGEO.PARIS2010SPOT",key:"",theme:"edugeo",desc:"Zone de Paris - SPOT 2010",server:"https://data.geopf.fr/wmts",bbox:[1.87654,48.5405,3.00247,49.362],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT PARIS 2010"},"ORTHOIMAGERY.EDUGEO.REIMS1963":{layer:"ORTHOIMAGERY.EDUGEO.REIMS1963",key:"",theme:"edugeo",desc:"Photographie de Reims 1963",server:"https://data.geopf.fr/wmts",bbox:[3.95325,49.117,4.21597,49.2968],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Reims 1963"},"ORTHOIMAGERY.EDUGEO.REIMS1973":{layer:"ORTHOIMAGERY.EDUGEO.REIMS1973",key:"",theme:"edugeo",desc:"Photographie de Reims 1973",server:"https://data.geopf.fr/wmts",bbox:[3.95325,49.1252,4.22848,49.2886],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Reims 1973"},"ORTHOIMAGERY.EDUGEO.REIMS1988":{layer:"ORTHOIMAGERY.EDUGEO.REIMS1988",key:"",theme:"edugeo",desc:"Photographie de Reims 1988",server:"https://data.geopf.fr/wmts",bbox:[3.91572,49.1252,4.2535,49.2805],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Reims 1988"},"ORTHOIMAGERY.EDUGEO.REIMS2010":{layer:"ORTHOIMAGERY.EDUGEO.REIMS2010",key:"",theme:"edugeo",desc:"Zone de Paris - REIMS 2010",server:"https://data.geopf.fr/wmts",bbox:[3.50288,48.9529,4.75391,49.362],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT REIMS 2010"},"ORTHOIMAGERY.EDUGEO.ROISSY1965":{layer:"ORTHOIMAGERY.EDUGEO.ROISSY1965",key:"",theme:"edugeo",desc:"Photographie - ROISSY 1965",server:"https://data.geopf.fr/wmts",bbox:[2.35194,48.9036,2.70222,49.0432],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - ROISSY 1965"},"ORTHOIMAGERY.EDUGEO.ROISSY1987":{layer:"ORTHOIMAGERY.EDUGEO.ROISSY1987",key:"",theme:"edugeo",desc:"Photographie - ROISSY 1987",server:"https://data.geopf.fr/wmts",bbox:[2.45202,48.9447,2.65218,49.035],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - ROISSY 1987"},"ORTHOIMAGERY.EDUGEO.STRASBOURG1975":{layer:"ORTHOIMAGERY.EDUGEO.STRASBOURG1975",key:"",theme:"edugeo",desc:"Photographie de Strasbourg 1975",server:"https://data.geopf.fr/wmts",bbox:[7.31852,48.4078,7.93153,48.6563],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Strasbourg 1975"},"ORTHOIMAGERY.EDUGEO.STRASBOURG1985":{layer:"ORTHOIMAGERY.EDUGEO.STRASBOURG1985",key:"",theme:"edugeo",desc:"Photographie de Strasbourg 1985",server:"https://data.geopf.fr/wmts",bbox:[7.46865,48.3995,7.894,48.6232],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Strasbourg 1985"},"ORTHOIMAGERY.EDUGEO.STRASBOURG2010":{layer:"ORTHOIMAGERY.EDUGEO.STRASBOURG2010",key:"",theme:"edugeo",desc:"Zone de Paris - STRASBOURG 2010",server:"https://data.geopf.fr/wmts",bbox:[7.13087,48.0411,8.2568,48.8707],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT STRASBOURG 2010"},"ORTHOIMAGERY.EDUGEO.TOULON-HYERES1972":{layer:"ORTHOIMAGERY.EDUGEO.TOULON-HYERES1972",key:"",theme:"edugeo",desc:"Photographie de TOULON-HYERES 1972",server:"https://data.geopf.fr/wmts",bbox:[5.74223,42.9696,6.33021,43.2163],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - TOULON-HYERES 1972"},"ORTHOIMAGERY.EDUGEO.TOULOUSE1954":{layer:"ORTHOIMAGERY.EDUGEO.TOULOUSE1954",key:"",theme:"edugeo",desc:"Photographie de Toulouse 1954",server:"https://data.geopf.fr/wmts",bbox:[1.23852,43.5618,1.55128,43.7247],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie -Toulouse 1954"},"ORTHOIMAGERY.EDUGEO.VALEE-DU-DRAC2010":{layer:"ORTHOIMAGERY.EDUGEO.VALEE-DU-DRAC2010",key:"",theme:"edugeo",desc:"Zone de la Vallée du Drac - 2010",server:"https://data.geopf.fr/wmts",bbox:[5.12922,44.7643,6.25515,45.0301],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT Vallée du Drac 2010"},"ORTHOIMAGERY.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1970":{layer:"ORTHOIMAGERY.EDUGEO.VANNES-GOLFE-DU-MORBIHAN1970",key:"",theme:"edugeo",desc:"Photographie - VANNES GOLFE DU MORBIHAN 1970",server:"https://data.geopf.fr/wmts",bbox:[-3.20264,47.4607,-2.62716,47.7138],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - VANNES GOLFE DU MORBIHAN 1970"},"ORTHOIMAGERY.EDUGEO.VERSAILLES1965":{layer:"ORTHOIMAGERY.EDUGEO.VERSAILLES1965",key:"",theme:"edugeo",desc:"Photographie - Versailles 1965",server:"https://data.geopf.fr/wmts",bbox:[1.98914,48.6067,2.32692,48.8789],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Versailles 1965"},"ORTHOIMAGERY.EDUGEO.VERSAILLES1989":{layer:"ORTHOIMAGERY.EDUGEO.VERSAILLES1989",key:"",theme:"edugeo",desc:"Photographie de Versailles 1989",server:"https://data.geopf.fr/wmts",bbox:[1.87654,48.6315,2.33943,48.8789],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographie - Versailles 1989"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2012":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2012",key:"",theme:"satellite",desc:"Agrégation des images Pléiades de l'année 2012.",server:"https://data.geopf.fr/wmts",bbox:[-53.2686,-21.3539,55.5544,50.6037],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2012"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2013":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2013",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2013",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2013"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2014":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2014",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2014",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2014"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2015":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2015",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2015",server:"https://data.geopf.fr/wmts",bbox:[-178.196,-37.8942,77.6156,51.0283],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2015"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2016":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2016",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2016",server:"https://data.geopf.fr/wmts",bbox:[-54.1373,-21.32,55.8441,50.6549],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2016"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2017":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2017",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2017",server:"https://data.geopf.fr/wmts",bbox:[-63.1796,-21.4013,55.8465,51.1117],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2017"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2018":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2018",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2018",server:"https://data.geopf.fr/wmts",bbox:[-63.1702,-21.4094,55.8649,51.0841],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2018"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2019":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2019",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2019",server:"https://data.geopf.fr/wmts",bbox:[-63.1702,-21.4094,55.8649,51.1117],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2019"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2020":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2020",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2020",server:"https://data.geopf.fr/wmts",bbox:[-63.1724,-13.0169,45.3136,51.1117],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2020"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2021":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2021",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2021",server:"https://data.geopf.fr/wmts",bbox:[-61.8234,-21.4013,55.8464,51.13],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2021"},"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2022":{layer:"ORTHOIMAGERY.ORTHO-SAT.PLEIADES.2022",key:"",theme:"satellite",desc:"Agrégation des images Pleiades de l'année 2022",server:"https://data.geopf.fr/wmts",bbox:[-67.7132,-21.3733,55.7216,69.3108],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PLEIADES - 2022"},"ORTHOIMAGERY.ORTHO-SAT.RAPIDEYE.2010":{layer:"ORTHOIMAGERY.ORTHO-SAT.RAPIDEYE.2010",key:"",theme:"satellite",desc:"￼Image satellitaire de la France métropolitaine effectuée en 2010 par les satellites de télédétection RapidEye dans le cadre du projet EQUIPEX GEOSUD.",server:"https://data.geopf.fr/wmts",bbox:[-5.80725,41.2014,10.961,50.9218],format:"image/jpeg",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"RAPIDEYE 2010"},"ORTHOIMAGERY.ORTHO-SAT.RAPIDEYE.2011":{layer:"ORTHOIMAGERY.ORTHO-SAT.RAPIDEYE.2011",key:"",theme:"satellite",desc:"Image satellitaire de la France métropolitaine effectuée en 2011 par les satellites de télédétection RapidEye dans le cadre du projet EQUIPEX GEOSUD.",server:"https://data.geopf.fr/wmts",bbox:[-5.80725,41.0227,10.961,51.1752],format:"image/jpeg",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"RAPIDEYE - 2011"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2013":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2013",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2013",server:"https://data.geopf.fr/wmts",bbox:[.563585,44.8809,4.29191,50.3879],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Millésime Spot 2013"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2014":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2014",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2014. <br/><br/> <b>Financeurs de la couverture SPOT 6-7 : <br/>CNES, IGN, GEOSUD</b>",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2014"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2015":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2015",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2015. <br/><br/> <b>Financeurs de la télémesure SPOT 6-7 : <br/>CIRAD, CNES, CNRS, IGN, IRD, Irstea, GEOSUD</b>",server:"https://data.geopf.fr/wmts",bbox:[-61.8141,-21.4104,55.856,51.106],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2015"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2016":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2016",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2016. <br/><br/> <b>Financeurs de la télémesure SPOT 6-7 : <br/>CIRAD, CNES, CNRS, IGN, IRD, Irstea, GEOSUD</b>",server:"https://data.geopf.fr/wmts",bbox:[-61.85,-21.4104,55.8562,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2016"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2017":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2017",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2017",server:"https://data.geopf.fr/wmts",bbox:[-61.8534,-21.4104,55.8562,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2017"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2018":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2018",key:"",theme:"satellite",desc:"Agrégation des images Spot de l'année 2018",server:"https://data.geopf.fr/wmts",bbox:[-5.57103,41.2593,10.7394,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2018"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2019":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2019",key:"",theme:"satellite",desc:"Agrégation des images SPOT 2019",server:"https://data.geopf.fr/wmts",bbox:[-5.57103,41.2593,10.7394,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2019"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2020":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2020",key:"",theme:"satellite",desc:"Agrégation des images SPOT 2020",server:"https://data.geopf.fr/wmts",bbox:[-5.57103,41.2593,10.7394,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2020"},"ORTHOIMAGERY.ORTHO-SAT.SPOT.2021":{layer:"ORTHOIMAGERY.ORTHO-SAT.SPOT.2021",key:"",theme:"satellite",desc:"Agrégation des images SPOT 2021",server:"https://data.geopf.fr/wmts",bbox:[-5.57103,41.2593,10.7394,51.1123],format:"image/jpeg",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT 6-7 - 2021"},"ORTHOIMAGERY.ORTHOPHOS.RESTRICTEDAREAS":{layer:"ORTHOIMAGERY.ORTHOPHOS.RESTRICTEDAREAS",key:"",theme:"ortho",desc:"Zones interdites à la captation aérienne des données (ZICAD) fixées par voie d'arrêté (arrêté du 02-01-2023 fixant la liste des zones interdites à la prise de vue aérienne par appareil photographique, cinématographique ou tout autre capteur). Édition 02-01-2023",server:"https://data.geopf.fr/wmts",bbox:[-178.309,-22.9723,168.298,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Zones interdites à la captation aérienne des données"},"ORTHOIMAGERY.ORTHOPHOTOS":{layer:"ORTHOIMAGERY.ORTHOPHOTOS",key:"",theme:"ortho",desc:"Photographies aériennes",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/jpeg",minZoom:0,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Photographies aériennes"},"ORTHOIMAGERY.ORTHOPHOTOS.1950-1965":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.1950-1965",key:"",theme:"ortho",desc:"Couverture en photographies aériennes de la France des années 50, telle qu'elle se présentait avant les grands aménagements des années 60. Cette couverture a été réalisée à partir des photographies aériennes historiques numérisées par l'IGN. Elle est disponible sur la France métropolitaine, les départements et régions d'Outre-Mer (la Guyane n'est que partiellement couverte) et les collectivités d'Outre-Mer sauf la Polynésie française. Les photographies sont orthorectifiées, c'est-à-dire corrigées des déformations dues à la prise de vue et au relief du terrain, et assemblées pour fournir une visualisation continue superposable avec le Référentiel à Grande Echelle (RGE®) ou les cartes.",server:"https://data.geopf.fr/wmts",bbox:[-67.7214,-21.4013,55.8464,51.0945],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"Photographies aériennes historiques 1950-1965"},"ORTHOIMAGERY.ORTHOPHOTOS.1965-1980":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.1965-1980",key:"",theme:"ortho",desc:"Couverture en photographies aériennes de la France des années 1965 à 1980. Cette couverture a été réalisée à partir des photographies aériennes historiques numérisées par l'IGN. Elle est disponible sur la France métropolitaine, les départements et régions d'Outre-Mer (la Guyane n'est que partiellement couverte) et les collectivités d'Outre-Mer sauf la Polynésie française. Les photographies sont orthorectifiées, c'est-à-dire corrigées des déformations dues à la prise de vue et au relief du terrain, et assemblées pour fournir une visualisation continue superposable avec le Référentiel à Grande Echelle (RGE®) ou les cartes.",server:"https://data.geopf.fr/wmts",bbox:[-2.27523,47.0831,2.61963,49.0193],format:"image/png",minZoom:3,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"BDOrtho Historique 1965-1980"},"ORTHOIMAGERY.ORTHOPHOTOS.1980-1995":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.1980-1995",key:"",theme:"ortho",desc:"Couverture en photographies aériennes de la France des années 11980 à 1995. Cette couverture a été réalisée à partir des photographies aériennes historiques numérisées par l'IGN. Elle est disponible sur la France métropolitaine, les départements et régions d'Outre-Mer (la Guyane n'est que partiellement couverte) et les collectivités d'Outre-Mer sauf la Polynésie française. Les photographies sont orthorectifiées, c'est-à-dire corrigées des déformations dues à la prise de vue et au relief du terrain, et assemblées pour fournir une visualisation continue superposable avec le Référentiel à Grande Echelle (RGE®) ou les cartes.",server:"https://data.geopf.fr/wmts",bbox:[-2.37153,41.3125,9.67536,49.7785],format:"image/png",minZoom:3,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"Ortho Historique 1980-1995"},"ORTHOIMAGERY.ORTHOPHOTOS.BDORTHO":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.BDORTHO",key:"",theme:"ortho",desc:"Le produit BD ORTHO® est une collection de mosaïques d'orthophotographies numériques en couleurs ou en Infra Rouge couleurs, rectifiées dans la projection adaptée au territoire couvert.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Ortho 50 cm"},"ORTHOIMAGERY.ORTHOPHOTOS.COAST2000":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.COAST2000",key:"",theme:"ortho",desc:"Donnée issue du Référentiel géographique du littoral. Zone de couverture de l'orthophotographie : côte de la mer du Nord, de la Manche et de l'Atlantique.",server:"https://data.geopf.fr/wmts",bbox:[-5.21565,43.301,2.60783,51.1233],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Ortholittorale 2000"},"ORTHOIMAGERY.ORTHOPHOTOS.GENEVE":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.GENEVE",key:"",theme:"ortho",desc:"Photographie aérienne du canton de Genève.",server:"https://data.geopf.fr/wmts",bbox:[5.95007,46.1241,6.31198,46.3658],format:"image/png",minZoom:6,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Suisse - photographies aériennes du canton de Genève (SITG)"},"ORTHOIMAGERY.ORTHOPHOTOS.ILESDUNORD":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ILESDUNORD",key:"",theme:"ortho",desc:"Ce flux regroupe des données ortho-rectifiées issues des prises de vue aériennes de Saint Martin (2017) et Saint Barthélémy (2016).",server:"https://data.geopf.fr/wmts",bbox:[-63.1986,17.8626,-62.7828,18.1701],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Données ortho-réctifiées antérieures au passage d'Irma"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC",key:"",theme:"ortho",desc:"BDORTHO en infrarouge fausses couleurs",server:"https://data.geopf.fr/wmts",bbox:[-62.9717,-21.4013,55.8464,51.1124],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2018":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2018",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express IRC 2018"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2019":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2019",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express IRC 2019"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2020":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2020",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express IRC 2020"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2021":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC-EXPRESS.2021",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express IRC 2021"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2012":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2012",key:"",theme:"ortho",desc:"BDORTHO 2012 en infrarouge fausses couleurs",server:"https://data.geopf.fr/wmts",bbox:[6.6094,43.4465,7.74363,44.377],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2012 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2013":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2013",key:"",theme:"ortho",desc:"BDORTHO 2013 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-3.74871,42.5538,7.17132,50.3767],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2013 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2014":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2014",key:"",theme:"ortho",desc:"BDORTHO 2014 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-2.37153,43.1508,7.22637,49.6341],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2014 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2015":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2015",key:"",theme:"ortho",desc:"BDORTHO 2015 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-5.20863,42.3163,8.25674,51.0945],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2015 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2016":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2016",key:"",theme:"ortho",desc:"BDORTHO 2016 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-3.74871,41.3215,9.66314,50.1839],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2016 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2017":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2017",key:"",theme:"ortho",desc:"BDORTHO 2017 en infrarouge fausses couleurs",server:"https://data.geopf.fr/wmts",bbox:[-.185295,42.9454,7.74363,46.4137],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2017 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2018":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2018",key:"",theme:"ortho",desc:"BDORTHO 2018 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-63.1702,2.10403,8.25765,51.1124],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2018 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2019":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2019",key:"",theme:"ortho",desc:"BDORTHO 2019 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-3.74871,41.3125,9.66314,50.1928],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2019 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2020":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.IRC.2020",key:"",theme:"ortho",desc:"BDORTHO 2020 en infrarouge fausses couleurs.",server:"https://data.geopf.fr/wmts",bbox:[-2.68142,42.9454,7.74363,49.4512],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDORTHO 2020 en infrarouge fausses couleurs"},"ORTHOIMAGERY.ORTHOPHOTOS.NCL":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.NCL",key:"",theme:"ortho",desc:"La BDORTHO-NC est une orthophotographie du territoire de Nouvelle-Calédonie réalisée par la DITTT pour le compte du Gouvernement de Nouvelle-Calédonie.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"inspire_common:DEFAULT",tilematrix:"PM",title:"BDORTHO-NC V2"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2020":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2020",key:"",theme:"agriculture",desc:"ortho ASP PAC 2020",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ORTHO-ASP_PAC2020"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2021":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2021",key:"",theme:"agriculture",desc:"orthos ASP PAC 2021",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ORTHO-ASP_PAC2021"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2022":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-ASP_PAC2022",key:"",theme:"agriculture",desc:"orthos ASP PAC 2022",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ORTHO-ASP_PAC2022"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2017":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2017",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2017"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2018":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2018",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2018"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2019":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2019",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2019"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2020":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2020",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2020"},"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2021":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.ORTHO-EXPRESS.2021",key:"",theme:"ortho",desc:"L’Ortho Express est une mosaïque d’ortho‐images numériques. Elle se différencie des autres produits orthophotographiques de l’IGN par le fait que, par souci de minimiser les délais de sa production, elle résulte d’un traitement massivement automatisé . L’Ortho Express vise en premier lieu à répondre à une exigence sur les délais de production. Il s’agit donc d’un produit dont les caractéristiques techniques sont contraintes par cette exigence forte.",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ortho-express 2021"},"ORTHOIMAGERY.ORTHOPHOTOS.PRE.IRMA":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.PRE.IRMA",key:"",theme:"ortho",desc:"Ce flux regroupe des données ortho-rectifiées issues des prises de vue aériennes de Saint Martin (2017) et Saint Barthélémy (2016).",server:"https://data.geopf.fr/wmts",bbox:[-63.1986,17.8626,-62.7828,18.1701],format:"image/png",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Données ortho-réctifiées antérieures au passage d'Irma"},"ORTHOIMAGERY.ORTHOPHOTOS.RAPIDEYE":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.RAPIDEYE",key:"",theme:"satellite",desc:"Image satellitaire de la France métropolitaine effectuée en 2011 par les satellites de télédétection RapidEye dans le cadre du projet EQUIPEX GEOSUD.",server:"https://data.geopf.fr/wmts",bbox:[-5.80725,41.0227,10.961,51.1752],format:"image/jpeg",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"GEOSUD / RapidEye (2011)"},"ORTHOIMAGERY.ORTHOPHOTOS.SOCLE-ASP.2018":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.SOCLE-ASP.2018",key:"",theme:"ortho",desc:"bdortho-asp et ortho-socle 2018",server:"https://data.geopf.fr/wmts",bbox:[-179.5,-75,179.5,75],format:"image/jpeg",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"bdortho-asp ortho-socle 2018"},"ORTHOIMAGERY.ORTHOPHOTOS.SPOT5":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.SPOT5",key:"",theme:"satellite",desc:"Cette couche est formée d'images prises par le satellite SPOT 5 en 2009 et 2010 depuis une altitude de 800 km. La résolution des images initiales est de 2,5 mètres/pixel, ce qui permet d'identifier l'existence de bâtiments, routes et chemins, et sa précision est homogène avec celle du référentiel à Grande Echelle. Le satellite SPOT 5 est exploité depuis 2002 par le Centre national d'études spatiales (CNES) et les images sont distribuées par la société Spot Image (Astrium GEO-Information Services). L'expertise de l'IGN menée à la demande du CNES a permis d'affiner les performances géométriques du capteur SPOT5, dans l'intérêt de tous les utilisateurs. La couche \" SPOT 5 \" visible sur Géoportail est issue de la co-édition Reference3D® entre Spot Image et l'IGN. Aucune légende n'est associée à cette couche. La radiométrie des images est traitée par des couleurs naturelles.",server:"https://data.geopf.fr/wmts",bbox:[-2.10938,41.9023,5.09766,46.0732],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Spot 5"},"ORTHOIMAGERY.ORTHOPHOTOS.URGENCE.ALEX":{layer:"ORTHOIMAGERY.ORTHOPHOTOS.URGENCE.ALEX",key:"",theme:"ortho",desc:"Orthophotographie réalisée suite au passage de la tempête Alex dans les Alpes Maritimes",server:"https://data.geopf.fr/wmts",bbox:[7.07917,43.8095,7.64199,44.1903],format:"image/jpeg",minZoom:6,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Orthophotographie d’urgence Alex"},"ORTHOIMAGERY.ORTHOPHOTOS2000":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2000",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2000.",server:"https://data.geopf.fr/wmts",bbox:[-61.2472,14.372,7.13497,49.0193],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2000"},"ORTHOIMAGERY.ORTHOPHOTOS2000-2005":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2000-2005",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires pour les années 2000 à 2005",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2000-2005"},"ORTHOIMAGERY.ORTHOPHOTOS2001":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2001",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2001.",server:"https://data.geopf.fr/wmts",bbox:[-61.2472,4.47153,7.23234,50.3765],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2001"},"ORTHOIMAGERY.ORTHOPHOTOS2002":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2002",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2002",server:"https://data.geopf.fr/wmts",bbox:[-61.2472,4.49867,9.68861,50.3765],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2002"},"ORTHOIMAGERY.ORTHOPHOTOS2003":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2003",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2003.",server:"https://data.geopf.fr/wmts",bbox:[-61.2472,-21.4013,55.8561,50.3765],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2003"},"ORTHOIMAGERY.ORTHOPHOTOS2004":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2004",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2004.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2004"},"ORTHOIMAGERY.ORTHOPHOTOS2005":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2005",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2005.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2005"},"ORTHOIMAGERY.ORTHOPHOTOS2006":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2006",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2006.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2006"},"ORTHOIMAGERY.ORTHOPHOTOS2006-2010":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2006-2010",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin des années 2006 à 2010",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2006-2010"},"ORTHOIMAGERY.ORTHOPHOTOS2007":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2007",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2007.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2007"},"ORTHOIMAGERY.ORTHOPHOTOS2008":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2008",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2008.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2008"},"ORTHOIMAGERY.ORTHOPHOTOS2009":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2009",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2009.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2009"},"ORTHOIMAGERY.ORTHOPHOTOS2010":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2010",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2010.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2010"},"ORTHOIMAGERY.ORTHOPHOTOS2011":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2011",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2011.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2011"},"ORTHOIMAGERY.ORTHOPHOTOS2011-2015":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2011-2015",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin des années 2011 à 2015",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.0945],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2011-2015"},"ORTHOIMAGERY.ORTHOPHOTOS2012":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2012",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2012.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2012"},"ORTHOIMAGERY.ORTHOPHOTOS2013":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2013",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2013.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.091],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2013"},"ORTHOIMAGERY.ORTHOPHOTOS2014":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2014",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2014.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.0945],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2014"},"ORTHOIMAGERY.ORTHOPHOTOS2015":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2015",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2015.",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.0945],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2015"},"ORTHOIMAGERY.ORTHOPHOTOS2016":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2016",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2016 (travail en cours).",server:"https://data.geopf.fr/wmts",bbox:[-178.187,-21.4013,55.8561,51.0945],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2016"},"ORTHOIMAGERY.ORTHOPHOTOS2017":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2017",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2017.",server:"https://data.geopf.fr/wmts",bbox:[-63.1607,-21.4013,55.8464,50.3856],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2017"},"ORTHOIMAGERY.ORTHOPHOTOS2018":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2018",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2018.",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/jpeg",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2018"},"ORTHOIMAGERY.ORTHOPHOTOS2019":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2019",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2019",server:"https://data.geopf.fr/wmts",bbox:[-3.74871,41.3125,9.66314,50.1928],format:"image/jpeg",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2019"},"ORTHOIMAGERY.ORTHOPHOTOS2020":{layer:"ORTHOIMAGERY.ORTHOPHOTOS2020",key:"",theme:"orthohisto",desc:"Prises de vues aériennes des territoires disponibles à la fin de l'année 2020",server:"https://data.geopf.fr/wmts",bbox:[-2.68142,42.9454,7.74363,49.4512],format:"image/jpeg",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes 2020"},"OSM.POI":{layer:"OSM.POI",key:"",theme:"autre",desc:"Données points d'intérêts OSM décembre 2023",server:"https://data.geopf.fr/wmts",bbox:[-8.32304,35.2703,14.2547,53.345],format:"application/x-protobuf",minZoom:14,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Points d'intérêts OSM"},PCI:{layer:"PCI",key:"",theme:"autre",desc:"Plan cadastral informatisé vecteur tuilé de la DGFIP",server:"https://data.geopf.fr/wmts",bbox:[-63.1618,-21.4,55.8469,51.0992],format:"application/x-protobuf",minZoom:5,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"PCI vecteur"},"PCRS.LAMB93":{layer:"PCRS.LAMB93",key:"",theme:"autre",desc:"Données du Plan Corps de Rue Simplifié",server:"https://data.geopf.fr/wmts",bbox:[-5,40,10,52],format:"image/jpeg",minZoom:6,maxZoom:22,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"PCRS"},"PLAN.IGN":{layer:"PLAN.IGN",key:"",theme:"autre",desc:"Plan IGN personnalisable",server:"https://data.geopf.fr/wmts",bbox:[-63.2812,-21.5355,55.9424,51.1238],format:"application/x-protobuf",minZoom:0,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Plan IGN"},POI_OSM:{layer:"POI_OSM",key:"",theme:"autre",desc:"Points d'intérêts issu de la base OSM.",server:"https://data.geopf.fr/wmts",bbox:[-6.67969,35.1172,11.9531,53.3781],format:"application/x-protobuf",minZoom:10,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"POI OSM"},"PRAIRIES.SENSIBLES.BCAE":{layer:"PRAIRIES.SENSIBLES.BCAE",key:"",theme:"agriculture",desc:"Préservation des prairies et pâturages permanents en zone Natura 2000 - Couche pour la nouvelle PAC produite par l’Observatoire du développement rural (ODR) en lien avec l’INRAE.",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"nolegend",tilematrix:"PM",title:"Préservation des prairies et pâturages permanents en zone Natura 2000"},"PROTECTEDAREAS.APB":{layer:"PROTECTEDAREAS.APB",key:"",theme:"environnement",desc:"Conservation de l'habitat d'espèces protégées. Outil réglementaires de niveau départemental.Mise à jour 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.APB",tilematrix:"PM",title:"Biotopes d'espèces protégées"},"PROTECTEDAREAS.APG":{layer:"PROTECTEDAREAS.APG",key:"",theme:"environnement",desc:"Sites d'intérêt géologique faisant l'objet d’une interdiction de destruction, d'altération ou de dégradation du site, ainsi que de prélèvement, de destruction ou de dégradation de fossiles, minéraux et concrétions présents sur ces sites appelés « aires de protection de géotope».",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Arrêtés de protection de géotope"},"PROTECTEDAREAS.APHN":{layer:"PROTECTEDAREAS.APHN",key:"",theme:"environnement",desc:"Dispositif visant à protéger un habitat naturel (récif corallien, tourbière, prairie, etc.) en tant que tel, sans qu'il soit besoin d'établir qu'il constitue par ailleurs un habitat d'espèces protégées. Mise à jour 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-53.6279,82.645,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Arrêtés de protection d’habitats naturels"},"PROTECTEDAREAS.APLG":{layer:"PROTECTEDAREAS.APLG",key:"",theme:"environnement",desc:"L'arrêté préfectoral fixant la liste départementale de sites d'intérêt géologique est un outil règlementaire qui vise à protéger, par des mesures générales, les sites géologiques qui sont mentionnés en son sein. Il s'agit d'un des deux outils mis en place par le décret du 28 décembre 2015 codifié aux articles R.411-17-1 et 17-2 du code de l'environnement et précisé par la Note du 1er décembre 2016 relative à la protection des sites d'intérêt géologique",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-53.6279,82.645,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"nolegend",tilematrix:"PM",title:"Arrêtés listes de sites d'intérêt géologique"},"PROTECTEDAREAS.BIOS":{layer:"PROTECTEDAREAS.BIOS",key:"",theme:"environnement",desc:"Réserves naturelles reconnues par le Programme sur l'Homme et la Biosphère créé par l'Unesco. 09-2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.BIOS",tilematrix:"PM",title:"Réserves de biosphère"},"PROTECTEDAREAS.GP":{layer:"PROTECTEDAREAS.GP",key:"",theme:"environnement",desc:"Les géoparcs mondiaux UNESCO sont des espaces géographiques unifiés, où les sites et paysages de portée géologique internationale sont gérés selon un concept global de protection, d’éducation et de développement durable",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Géoparcs"},"PROTECTEDAREAS.INPG":{layer:"PROTECTEDAREAS.INPG",key:"",theme:"environnement",desc:"L'Inventaire National du Patrimoine Géologique (INPG) est un programme initié en 2007 de connaissance géologique du territoire métropolitain et outre-mer, dans lequel chaque site géologique naturel est renseigné sur une application web dédiée (InvenTerre) de façon textuelle avec une évaluation patrimoniale et une cartographie associées.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-53.6279,82.645,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Inventaire National du Patrimoine Géologique (INPG)"},"PROTECTEDAREAS.MNHN.CDL.PARCELS":{layer:"PROTECTEDAREAS.MNHN.CDL.PARCELS",key:"",theme:"parcellaire",desc:"Les sites du conservatoire du littoral ont pour vocation la sauvegarde des espaces côtiers et lacustres. Leur accès au public est encouragé mais reste défini dans des limites compatibles avec la vulnérabilité de chaque site",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"PROTECTEDAREAS.MNHN.CDL.PARCELS",tilematrix:"PM",title:"Conservatoire du littoral - sites sous responsabilité du conservatoire"},"PROTECTEDAREAS.MNHN.CDL.PERIMETER":{layer:"PROTECTEDAREAS.MNHN.CDL.PERIMETER",key:"",theme:"environnement",desc:"Les sites du conservatoire du littoral ont pour vocation la sauvegarde des espaces côtiers et lacustres. Leur accès au public est encouragé mais reste défini dans des limites compatibles avec la vulnérabilité de chaque site.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Conservatoire du littoral : Les périmètres autorisés"},"PROTECTEDAREAS.MNHN.CONSERVATOIRES":{layer:"PROTECTEDAREAS.MNHN.CONSERVATOIRES",key:"",theme:"environnement",desc:"Les conservatoires d'espaces naturels organisent la maîtrise foncière de terrains en vue d'assurer la protection des espèces qui y résident. 05-2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Terrains des conservatoires d'espaces naturels"},"PROTECTEDAREAS.MNHN.RN.PERIMETER":{layer:"PROTECTEDAREAS.MNHN.RN.PERIMETER",key:"",theme:"environnement",desc:"Un périmètre de protection peut être institué en périphérie d’une réserve naturelle. Il concerne des espaces qui n’ont pas été classés en réserve et qui constituent une zone « tampon » autour de l’espace classé. Ils améliorent les échanges écologiques entre la réserve et sa périphérie. 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-53.6279,82.645,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"périmètres de protection de réserves naturelles"},"PROTECTEDAREAS.PN":{layer:"PROTECTEDAREAS.PN",key:"",theme:"environnement",desc:"Les parcs nationaux sont de vastes espaces protégés terrestres ou marins dont le patrimoine naturel est exceptionnel, et dont le but est à la fois de protéger des processus écologiques à large échelle et de fournir des possibilités de découverte de la nature. Mise à jour 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.PN",tilematrix:"PM",title:"Parcs nationaux"},"PROTECTEDAREAS.PNM":{layer:"PROTECTEDAREAS.PNM",key:"",theme:"environnement",desc:'Zones maritimes identifiées pour leur biodiversité ou par les activités humaines faisant l\'objet de protection. </br><a href="https://data.geopf.fr/annexes/ressources/fiches/mnhn/actualite_donnees_mnhn.pdf" alt="Date des données" target="_blank">Date des données</a>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Parcs naturels marins"},"PROTECTEDAREAS.PNR":{layer:"PROTECTEDAREAS.PNR",key:"",theme:"environnement",desc:"Les parcs naturels régionaux ont pour but de valoriser de vastes espaces de fort intérêt culturel et naturel, et de veiller au développement durable de ces territoires dont le caractère rural est souvent très affirmé. 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.PNR",tilematrix:"PM",title:"Parcs naturels régionaux"},"PROTECTEDAREAS.PRSF":{layer:"PROTECTEDAREAS.PRSF",key:"",theme:"environnement",desc:"Les Points de Rencontre de Secours en Forêt (PRSF) sont supposées connus des services de secours. Ils permettent de faciliter la localisation d'un blessé par les services de secours.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"POINT RENCONTRE SECOURS FORET",tilematrix:"PM",title:"Points de Rencontre de Secours en Forêt (PRSF)"},"PROTECTEDAREAS.RAMSAR":{layer:"PROTECTEDAREAS.RAMSAR",key:"",theme:"environnement",desc:"Un site Ramsar est un espace désigné en application de la Convention relative aux zones humides d'importance internationale, particulièrement comme habitats des oiseaux d'eau, dont le traité a été signé en 1971 sur les bords de la mer Caspienne (Iran). 16-11-2021",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.RAMSAR",tilematrix:"PM",title:"Zones humides d'importance internationale"},"PROTECTEDAREAS.RB":{layer:"PROTECTEDAREAS.RB",key:"",theme:"environnement",desc:'Une réserve biologique est un espace protégé en milieu forestier ou en milieu associé à la forêt (landes, mares, tourbières, dunes). Ce statut s\'applique aux forêts gérées par l\'Office National des Forêts et a pour but la protection d\'habitats remarquables ou représentatifs. <br/><a href="https://data.geopf.fr/annexes/ressources/fiches/mnhn/actualite_donnees_mnhn.pdf" alt="Date des données" target="_blank">Date des données</a>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Réserves biologiques"},"PROTECTEDAREAS.RIPN":{layer:"PROTECTEDAREAS.RIPN",key:"",theme:"environnement",desc:"Au sein d'un cœur de parc national, il peut être institué une « réserve intégrale » afin d'assurer, dans un but scientifique, une protection plus grande de certains éléments de la faune et de la flore. 05-2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Réserves Intégrales de Parcs Nationaux"},"PROTECTEDAREAS.RN":{layer:"PROTECTEDAREAS.RN",key:"",theme:"environnement",desc:"Les réserves naturelles sont des espaces protégés terrestres ou marins dont le patrimoine naturel est exceptionnel, tant sur le plan de la biodiversité que parfois sur celui de la géodiversité. 04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-53.6279,82.645,51.3121],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.RN",tilematrix:"PM",title:"Réserves naturelles nationales"},"PROTECTEDAREAS.RNC":{layer:"PROTECTEDAREAS.RNC",key:"",theme:"environnement",desc:'Les réserves naturelles sont des espaces protégés terrestres ou marins dont le patrimoine naturel est exceptionnel, tant sur le plan de la biodiversité que parfois sur celui de la géodiversité. </br><a href="https://data.geopf.fr/annexes/ressources/fiches/mnhn/actualite_donnees_mnhn.pdf" alt="Date des données" target="_blank">Date des données</a>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"PROTECTEDAREAS.RNC",tilematrix:"PM",title:"Réserves Naturelles de Corse"},"PROTECTEDAREAS.RNCF":{layer:"PROTECTEDAREAS.RNCF",key:"",theme:"environnement",desc:"Les réserves nationales de chasse et de faune sauvage sont des espaces protégés terrestres ou marins dont la gestion est principalement assurée par l'Office National de la Chasse et de la Faune Sauvage.09-2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Réserves nationales de chasse et de faune sauvage"},"PROTECTEDAREAS.SIC":{layer:"PROTECTEDAREAS.SIC",key:"",theme:"environnement",desc:"Le réseau Natura 2000 s'inscrit au coeur de la politique de conservation de la nature de l'Union européenne et est un élément clé de l'objectif visant à enrayer l'érosion de la biodiversité.04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.SIC",tilematrix:"PM",title:"Sites Natura 2000 au titre de la Directive Habitats"},"PROTECTEDAREAS.UNESCO":{layer:"PROTECTEDAREAS.UNESCO",key:"",theme:"environnement",desc:'Un bien naturel ou mixte (naturel et culturel) inscrit au patrimoine mondial de l\'UNESCO est un espace qui, du fait de sa valeur patrimoniale exceptionnelle, est considéré comme héritage commun de l\'humanité. </br><a href="https://data.geopf.fr/annexes/ressources/fiches/mnhn/actualite_donnees_mnhn.pdf" alt="Date des données" target="_blank">Date des données</a>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Sites inscrits au patrimoine mondial de l’UNESCO (biens naturels ou mixtes)"},"PROTECTEDAREAS.ZNIEFF1":{layer:"PROTECTEDAREAS.ZNIEFF1",key:"",theme:"environnement",desc:"Inventaire des espaces naturels abritant la nature remarquable.09-2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.ZNIEFF1",tilematrix:"PM",title:"Zones écologiques de nature remarquable (ZNIEFF1)"},"PROTECTEDAREAS.ZNIEFF1.SEA":{layer:"PROTECTEDAREAS.ZNIEFF1.SEA",key:"",theme:"environnement",desc:"Espaces marin homogènes d’un point de vue écologique abritant au moins une espèce ou un habitat rare ou menacé, d’intérêt local ou régional, national ou communautaire. Espaces marin d’intérêt fonctionnel pour le fonctionnement écologique local.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Zones naturelles d’intérêt écologique faunistique et floristique (ZNIEFF) marine type I"},"PROTECTEDAREAS.ZNIEFF2":{layer:"PROTECTEDAREAS.ZNIEFF2",key:"",theme:"environnement",desc:'Inventaire des espaces fonctionnels indispensables à la nature remarquable.</br><a href="https://data.geopf.fr/annexes/ressources/fiches/mnhn/actualite_donnees_mnhn.pdf" alt="Date des données" target="_blank">Date des données</a>',server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.ZNIEFF2",tilematrix:"PM",title:"Zones fonctionnelles de nature remarquable (ZNIEFF2)"},"PROTECTEDAREAS.ZNIEFF2.SEA":{layer:"PROTECTEDAREAS.ZNIEFF2.SEA",key:"",theme:"environnement",desc:"Grands ensembles naturels ou peu modifiés marin offrant des potentialités biologiques importantes.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Zones naturelles d’intérêt écologique faunistique et floristique (ZNIEFF) marine type II"},"PROTECTEDAREAS.ZPS":{layer:"PROTECTEDAREAS.ZPS",key:"",theme:"environnement",desc:"Le réseau Natura 2000 s'inscrit au coeur de la politique de conservation de la nature de l'Union européenne et est un élément clé de l'objectif visant à enrayer l'érosion de la biodiversité.04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDAREAS.ZPS",tilematrix:"PM",title:"Sites NATURA 2000 au titre de la Directive Oiseaux"},"PROTECTEDSITES.MNHN.RESERVES-REGIONALES":{layer:"PROTECTEDSITES.MNHN.RESERVES-REGIONALES",key:"",theme:"environnement",desc:"Les réserves naturelles régionales sont gérées prioritairement à des fins de conservation de la nature. Elles sont placées sous la responsabilité exclusive des conseils régionaux.04-2023",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"PROTECTEDSITES.MNHN.RESERVES-REGIONALES",tilematrix:"PM",title:"Réserves naturelles régionales"},"PVA_IGN_zone-marais-de-Virvee_1945":{layer:"PVA_IGN_zone-marais-de-Virvee_1945",key:"",theme:"edugeo",desc:"zone de marais de Virvée, prise de vue IGN de 1945",server:"https://data.geopf.fr/wmts",bbox:[-.473697,44.9109,-.353311,44.9958],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"PVA IGN : zone de marais de Virvée, 1945"},"PVA_IGN_zone-marais-de-Virvee_1956":{layer:"PVA_IGN_zone-marais-de-Virvee_1956",key:"",theme:"edugeo",desc:"zone de marais de Virvée, prise de vue IGN de 1956",server:"https://data.geopf.fr/wmts",bbox:[-.459808,44.943,-.400713,44.9831],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"PVA IGN : zone de marais de Virvée, 1956"},"PVA_IGN_zone-marais-de-Virvee_1976":{layer:"PVA_IGN_zone-marais-de-Virvee_1976",key:"",theme:"edugeo",desc:"Zone de marais de Virvée, prise de vue IGN de 1976",server:"https://data.geopf.fr/wmts",bbox:[-.462614,44.9412,-.421769,44.9695],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"PVA IGN : zone de marais de Virvée, 1976"},"PVA_IGN_zone-marais-de-Virvee_1984":{layer:"PVA_IGN_zone-marais-de-Virvee_1984",key:"",theme:"edugeo",desc:"Zone de marais de Virvée, prise de vue IGN de 1984",server:"https://data.geopf.fr/wmts",bbox:[-.479737,44.9204,-.403842,44.9712],format:"image/png",minZoom:0,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"BDORTHOHISTORIQUE",tilematrix:"PM",title:"PVA IGN : zone de marais de Virvée, 1984"},"RAPIDEYE_PYR-JPEG_WLD_WM_2010":{layer:"RAPIDEYE_PYR-JPEG_WLD_WM_2010",key:"",theme:"satellite",desc:"Image satellitaire de la France métropolitaine effectuée en 2010 par les satellites de télédétection RapidEye dans le cadre du projet EQUIPEX GEOSUD.",server:"https://data.geopf.fr/wmts",bbox:[-5.80725,41.2014,10.961,50.9218],format:"image/jpeg",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"GEOSUD / RapidEye (2010)"},"RAPIDEYE_PYR-JPEG_WLD_WM_2011":{layer:"RAPIDEYE_PYR-JPEG_WLD_WM_2011",key:"",theme:"satellite",desc:"Image satellitaire de la France métropolitaine effectuée en 2011 par les satellites de télédétection RapidEye dans le cadre du projet EQUIPEX GEOSUD.",server:"https://data.geopf.fr/wmts",bbox:[-5.80725,41.0227,10.961,51.1752],format:"image/jpeg",minZoom:0,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"GEOSUD / RapidEye (2011)"},"RPG2012_PYR-PNG_WLD_EDUGEO_20170126":{layer:"RPG2012_PYR-PNG_WLD_EDUGEO_20170126",key:"",theme:"edugeo",desc:"Registre parcellaire graphique : zones de culture déclarées par les exploitants en 2012",server:"https://data.geopf.fr/wmts",bbox:[-5.15047,41.3252,9.57054,51.0991],format:"image/png",minZoom:0,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Registre parcellaire graphique (RPG) 2012"},RPG_2020:{layer:"RPG_2020",key:"",theme:"autre",desc:"RPG 2020",server:"https://data.geopf.fr/wmts",bbox:[-5.15053,41.3247,9.57115,51.0992],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"RPG 2020"},RUE_FEMININE:{layer:"RUE_FEMININE",key:"",theme:"autre",desc:"Représentation au niveau national des odonymes (allée, rue, bvd, place…) féminins, réalisée à l’occasion de la Journée internationale des droits des femmes du 8 mars 2022",server:"https://data.geopf.fr/wmts",bbox:[-63.3726,-21.4761,55.9259,51.3122],format:"application/x-protobuf",minZoom:14,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Odonymes féminins"},"SCAN-EDUGEO_PYR-PNG_FXX_WM":{layer:"SCAN-EDUGEO_PYR-PNG_FXX_WM",key:"",theme:"edugeo",desc:"Zone de Le Havre - Cartographie 1979",server:"https://data.geopf.fr/wmts",bbox:[-.125103,49.2805,.625515,49.6868],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Cartographie Le Havre 1979"},"SCAN1000_PYR-JPEG_WLD_WM_WMTS_3D":{layer:"SCAN1000_PYR-JPEG_WLD_WM_WMTS_3D",key:"",theme:"cartes",desc:"Le produit SCAN 1000® version 2 est une collection d'images numériques en couleurs, obtenues par rastérisation des données vecteur de la carte nationale France (901) à l'échelle 1 :1,000,000ième. Le produit couvre l'ensemble du territoire français métropolitain et la Corse.",server:"https://data.geopf.fr/wmts",bbox:[-6.42088,40.2891,13.55,51.444],format:"image/jpeg",minZoom:0,maxZoom:10,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte SCAN 1000"},"SCANREG_PYR-JPEG_WLD_WM_WMTS_3D":{layer:"SCANREG_PYR-JPEG_WLD_WM_WMTS_3D",key:"",theme:"cartes",desc:"Le produit SCAN Régional® version 2 est une collection d'images cartographiques numériques en couleur, obtenues par rastérisation des données vecteur de la série « Cartes régionales » éditées par l'IGN. Ces images couvrent l'ensemble du territoire français métropolitain.",server:"https://data.geopf.fr/wmts",bbox:[-63.1702,17.9892,-62.9905,18.1429],format:"image/png",minZoom:0,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Carte SCANREG"},"SECUROUTE.TE.1TE":{layer:"SECUROUTE.TE.1TE",key:"",theme:"transport",desc:"Tronçons routiers 1TE",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:4,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"RESEAU ROUTIER 1TE",tilematrix:"PM",title:"Tronçons routiers 1TE"},"SECUROUTE.TE.2TE48":{layer:"SECUROUTE.TE.2TE48",key:"",theme:"transport",desc:"Tronçons routiers 2TE48",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"RESEAU ROUTIER 2TE48",tilematrix:"PM",title:"Tronçons routiers 2TE48"},"SECUROUTE.TE.ALL":{layer:"SECUROUTE.TE.ALL",key:"",theme:"transport",desc:"Tous les franchissements",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"TOUS LES FRANCHISSEMENTS",tilematrix:"PM",title:"Tous les franchissements"},"SECUROUTE.TE.OA":{layer:"SECUROUTE.TE.OA",key:"",theme:"transport",desc:"Franchissements ouvrage d'art",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"AUTRES FRANCHISSEMENTS",tilematrix:"PM",title:"Franchissements ouvrage d'art"},"SECUROUTE.TE.PN":{layer:"SECUROUTE.TE.PN",key:"",theme:"transport",desc:"Franchissements passage à niveau",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"FRANCHISSEMENTS PASSAGE A NIVEAU",tilematrix:"PM",title:"Franchissements passage à niveau"},"SECUROUTE.TE.PND":{layer:"SECUROUTE.TE.PND",key:"",theme:"transport",desc:"Franchissements passage à niveau difficile",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"FRANCHISSEMENTS PASSAGE A NIVEAU DIFFICILE",tilematrix:"PM",title:"Franchissements passage à niveau difficile"},"SECUROUTE.TE.TE120":{layer:"SECUROUTE.TE.TE120",key:"",theme:"transport",desc:"Tronçons routiers TE120",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"RESEAU ROUTIER TE120",tilematrix:"PM",title:"Tronçons routiers TE120"},"SECUROUTE.TE.TE72":{layer:"SECUROUTE.TE.TE72",key:"",theme:"transport",desc:"Tronçons routiers TE72",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"RESEAU ROUTIER TE72",tilematrix:"PM",title:"Tronçons routiers TE72"},"SECUROUTE.TE.TE94":{layer:"SECUROUTE.TE.TE94",key:"",theme:"transport",desc:"Tronçons routiers TE94",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:17,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"RESEAU ROUTIER TE94",tilematrix:"PM",title:"Tronçons routiers TE94"},"SPOT-EDUGEO_PYR-PNG_WLD_WM":{layer:"SPOT-EDUGEO_PYR-PNG_WLD_WM",key:"",theme:"edugeo",desc:"Zone de Bordeaux 2003",server:"https://data.geopf.fr/wmts",bbox:[-1.12593,44.6754,.125103,45.5582],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT BORDEAUX 2003"},"SPOT5_PYR-JPEG_WLD_WM":{layer:"SPOT5_PYR-JPEG_WLD_WM",key:"",theme:"satellite",desc:"Cette couche est formée d'images prises par le satellite SPOT 5 en 2009 et 2010 depuis une altitude de 800 km. La résolution des images initiales est de 2,5 mètres/pixel, ce qui permet d'identifier l'existence de bâtiments, routes et chemins, et sa précision est homogène avec celle du référentiel à Grande Echelle. Le satellite SPOT 5 est exploité depuis 2002 par le Centre national d'études spatiales (CNES) et les images sont distribuées par la société Spot Image (Astrium GEO-Information Services). L'expertise de l'IGN menée à la demande du CNES a permis d'affiner les performances géométriques du capteur SPOT5, dans l'intérêt de tous les utilisateurs. La couche \" SPOT 5 \" visible sur Géoportail est issue de la co-édition Reference3D® entre Spot Image et l'IGN. Aucune légende n'est associée à cette couche. La radiométrie des images est traitée par des couleurs naturelles.",server:"https://data.geopf.fr/wmts",bbox:[-2.10938,41.9023,5.09766,46.0732],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"SPOT 5 sud-ouest 2009-2010"},TEST_PBE_LE_HAVRE:{layer:"TEST_PBE_LE_HAVRE",key:"",theme:"autre",desc:"TEST_PBE_LE_HAVRE",server:"https://data.geopf.fr/wmts",bbox:[-180,-89,180,89],format:"image/png",minZoom:6,maxZoom:16,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"TEST_PBE_LE_HAVRE"},"THR.ORTHOIMAGERY.ORTHOPHOTOS":{layer:"THR.ORTHOIMAGERY.ORTHOPHOTOS",key:"",theme:"ortho",desc:"Orthophotographies aériennes d'une résolution de 10cm à 5cm selon disponibilité.",server:"https://data.geopf.fr/wmts",bbox:[.0354912,43.1533,6.02353,49.6969],format:"image/jpeg",minZoom:6,maxZoom:20,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Photographies aériennes très haute résolution"},"TRANSPORTNETWORK.COMMONTRANSPORTELEMENTS.MARKERPOST":{layer:"TRANSPORTNETWORK.COMMONTRANSPORTELEMENTS.MARKERPOST",key:"",theme:"topographie",desc:"Ensemble des points de repère situés sur les routes départementales, nationales ou infrastructures autoroutières concédées de France métropolitaine.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:10,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Points de repère routiers (PR)"},"TRANSPORTNETWORK.COMMONTRANSPORTELEMENTS.MARKERPOST_VISU":{layer:"TRANSPORTNETWORK.COMMONTRANSPORTELEMENTS.MARKERPOST_VISU",key:"",theme:"topographie",desc:"Ensemble des points de repère situés sur les routes départementales, nationales ou infrastructures autoroutières concédées de France métropolitaine. Echelles du 1/8.000.000 au 1/8.000",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Points de repère routiers (PR)"},"TRANSPORTNETWORKS.RAILWAYS":{layer:"TRANSPORTNETWORKS.RAILWAYS",key:"",theme:"topographie",desc:"Carte du réseau ferroviaire",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Réseau ferroviaire"},"TRANSPORTNETWORKS.ROADS":{layer:"TRANSPORTNETWORKS.ROADS",key:"",theme:"topographie",desc:"Affichage du réseau routier français et européen.",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Routes"},"TRANSPORTNETWORKS.ROADS.DIRECTION":{layer:"TRANSPORTNETWORKS.ROADS.DIRECTION",key:"",theme:"transport",desc:"Affichage des sens de circulation du réseau routier",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:15,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Sens de circulation"},"TRANSPORTNETWORKS.RUNWAYS":{layer:"TRANSPORTNETWORKS.RUNWAYS",key:"",theme:"topographie",desc:"Localisation des aéroports, aérodromes et héliports, des pistes, bâtiments et équipements dédiés.",server:"https://data.geopf.fr/wmts",bbox:[-63.9692,-21.4969,55.9644,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Aéroports"},"TRANSPORTS.DRONES.RESTRICTIONS":{layer:"TRANSPORTS.DRONES.RESTRICTIONS",key:"",theme:"transport",desc:"Représentation des zones soumises à interdictions ou à restrictions pour l’usage, à titre de loisir, d’aéronefs télépilotés (ou drones), sur le territoire métropolitain, à jour au 07-2020 Elle intègre partiellement les interdictions s'appuyant sur des données non publiées à l'AIP et ne couvre pas les interdictions temporaires. Cette carte est basée sur l’arrêté « espace » du 09/11/2017. La représentation des zones soumises à interdictions ou à restrictions n’engage pas la responsabilité des producteurs de la donnée. Le contour des agglomérations est fourni à titre purement indicatif. Consultez les interdictions temporaires sur https://www.sia.aviation-civile.gouv.fr/.",server:"https://data.geopf.fr/wmts",bbox:[-9.88147,40.576,11.6781,51.4428],format:"image/png",minZoom:3,maxZoom:15,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!0,style:"normal",tilematrix:"PM",title:"Restrictions UAS catégorie Ouverte et Aéromodélisme"},TRANSPORT_EXCEPTIONNEL:{layer:"TRANSPORT_EXCEPTIONNEL",key:"",theme:"autre",desc:"Réseaux routiers pouvant être empruntés par les transports exceptionnels (TE).",server:"https://data.geopf.fr/wmts",bbox:[-5.15053,41.3247,9.57115,51.0992],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Transports exceptionnels"},"UTILITYANDGOVERNMENTALSERVICES.ALL":{layer:"UTILITYANDGOVERNMENTALSERVICES.ALL",key:"",theme:"topographie",desc:"Affichage des lignes électriques.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,71.5841],format:"image/png",minZoom:6,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"Lignes électriques"},bdtopo_cote_d_azur:{layer:"bdtopo_cote_d_azur",key:"",theme:"autre",desc:"test petite zone génération bdtopo",server:"https://data.geopf.fr/wmts",bbox:[-63.1533,-21.3897,55.8368,51.3127],format:"application/x-protobuf",minZoom:2,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"BDTOPO personnalisable cote d'azur"},d029_1_brest_2021:{layer:"d029_1_brest_2021",key:"",theme:"autre",desc:"Flux pyramide CoSIA (latest)",server:"https://data.geopf.fr/wmts",bbox:[-4.6728,48.3139,-4.29803,48.5488],format:"application/x-protobuf",minZoom:6,maxZoom:19,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"CoSIA - latest"},"hedge.hedge":{layer:"hedge.hedge",key:"",theme:"topographie",desc:"Couche nationale de référence des haies linéaires en France métropolitaine.",server:"https://data.geopf.fr/wmts",bbox:[-63.3725,-21.4756,55.9259,51.3121],format:"image/png",minZoom:7,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"haies linéraires"},ludi_2266__joincache_pyramide_1:{layer:"ludi_2266__joincache_pyramide_1",key:"",theme:"autre",desc:"Exemple de flux à visualiser",server:"https://data.geopf.fr/wmts",bbox:[-4.82,42.18,8.71,51.14],format:"image/jpeg",minZoom:5,maxZoom:18,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"ludi_2266 -- Joincache -- pyramide1"},test_jpe:{layer:"test_jpe",key:"",theme:"autre",desc:"test_jpe",server:"https://data.geopf.fr/wmts",bbox:[2.47085,42.9983,3.246,43.3851],format:"image/jpeg",minZoom:6,maxZoom:22,originators:{Geoservices:{attribution:"Géoservices",href:"https://geoservices.ign.fr/"}},queryable:!1,style:"normal",tilematrix:"PM",title:"test_jpe"}}}),n("5TDW7",function(e,r){t(e.exports,"default",()=>h);var i=s("6vpLi"),a=s("2tVQX");s("eXEIX");var n=s("dKl6q"),o=s("3HxCM"),l=s("cHblF");class u extends i.default{constructor(){super()}}u.prototype.read=function(){return!1},u.prototype.write=function(){return!1},u.prototype.readOptions=function(e,t){if((t=t||{}).id&&e.set("id",t.id),t.type&&e.set("type",t.type),t.name&&e.set("name",t.name),(t.name||t.title)&&e.set("title",t.title||t.name),void 0!==t.visibility&&e.setVisible(t.visibility),void 0!==t.opacity&&e.setOpacity(parseFloat(t.opacity)),t.description&&e.set("desc",t.description),t.logo&&e.set("logo",t.logo),t.theme&&e.set("theme",t.theme),t.exportable&&e.set("exportable",!0),e.getSource()&&(t.attributions?(e.getSource().setAttributions(t.attributions),e.set("attributions",t.attributions)):t.copyright&&e.getSource().setAttributions(t.copyright)),e.selectable&&e.selectable(t.selectable),t.multiSelect&&e.set("multiSelect",t.multiSelect),e.setPopupContent&&e.setPopupContent(t.popupContent),t.popupHoverSelect&&e.set("popupHoverSelect",t.popupHoverSelect),t.grayscale&&e.grayscale(!0),t.blendMode&&e.setBlendMode(t.blendMode),t.minZoom&&e.setMinZoom(t.minZoom),t.maxZoom&&e.setMaxZoom(t.maxZoom),e.setDeclutter&&e.setDeclutter(t.declutter),e.setIgnStyle&&e.setIgnStyle(t.style||{}),e.setConditionStyle&&t.conditionStyle){let r=[];t.conditionStyle.forEach(e=>{r.push({title:e.title,condition:e.condition,symbol:e.symbol?new l.default(e.symbol):null})}),e.setConditionStyle(r)}e.setMode&&(t.cluster||"cluster"===t.mode?e.setMode("cluster",{distance:t.clusterDistance||t.radiusCluster||40,maxZoomCluster:parseInt(t.maxZoomCluster),minSizeCluster:parseInt(t.minSizeCluster),maxSizeCluster:parseInt(t.maxSizeCluster),clusterType:t.clusterType,clusterColor:t.clusterColor,displayClusterPopup:t.displayClusterPopup}):t.mode&&e.setMode(t.mode||"vector")),e.setCrop(t.crop),t.extent&&e.setExtent(t.extent),t.legend&&(e._legend=new o.default({size:[28,20],margin:6,layer:e}),new n.default(e._legend,t.legend))},u.prototype.writeOptions=function(e,t){if((t=t||{}).id=e.get("id"),t.type=e.get("type"),t.name=e.get("name")||"",t.title=e.get("title")||"",t.visibility=e.getVisible(),t.opacity=e.getOpacity(),t.description=e.get("desc")||e.get("description"),t.logo=e.get("logo"),t.theme=e.get("theme"),e.get("exportable")&&(t.exportable=!0),e.get("attributions")&&(t.attributions=e.get("attributions")),"Geoportail"===e.get("type")||"WMS"===e.get("type")&&e.get("wmsparam").source.attributions&&e.get("wmsparam").source.attributions.length||"WMTS"===e.get("type")&&e.get("wmtsparam").source.attributions.length||!e.getSource()||!e.getSource().getAttributions())t.copyright="";else try{t.copyright=e.getSource().getAttributions()({extent:[-1/0,-1/0,1/0,1/0]}).join(" ")}catch(e){t.copyright=""}if(e.selectable&&(t.selectable=e.selectable()),t.multiSelect=e.get("multiSelect"),e.getPopupContent&&(t.popupContent=e.getPopupContent(),t.popupHoverSelect=e.get("popupHoverSelect")),t.grayscale=e.get("grayscale")||!1,t.blendMode=e.get("blendMode")||"",t.minZoom=e.getMinZoom(),t.maxZoom=e.getMaxZoom(),e.getDeclutter&&(t.declutter=e.getDeclutter()),e.getIgnStyle&&(t.style=e.getIgnStyle()),e.getConditionStyle&&(t.conditionStyle=[],e.getConditionStyle().forEach(e=>{t.conditionStyle.push({title:e.title,condition:e.condition,symbol:e.symbol?e.symbol.stringify():null})})),e.getMode&&(t.mode=e.getMode(),"cluster"===e.getMode()&&(t.cluster=!0,t.clusterDistance=t.radiusCluster=e.get("clusterDistance"),t.maxZoomCluster=e.get("maxZoomCluster"),t.minSizeCluster=e.get("minSizeCluster"),t.maxSizeCluster=e.get("maxSizeCluster"),t.clusterType=e.get("clusterType"),t.clusterColor=e.get("clusterColor"),t.displayClusterPopup=e.get("displayClusterPopup"))),t.crop=e.getCrop(),t.crop.coordinates&&(t.crop.coordinates=(0,a.default)(t.crop.coordinates)),t.extent=e.getExtent(),e._legend){let r=new n.default;t.legend=r.write(e._legend)}return t};var h=u}),n("2tVQX",function(e,r){t(e.exports,"default",()=>i);var i=function e(t,r){return r=r||1e3,"number"==typeof t[0]?(t[0]=Math.round(t[0]*r)/r,t[1]=Math.round(t[1]*r)/r):t.forEach(t=>e(t,r)),t}}),n("dKl6q",function(e,r){t(e.exports,"default",()=>m);var i=s("6vpLi"),a=s("juLo9"),n=s("j2K3b"),o=s("hvEnP"),l=s("cgPpQ"),u=s("gIJof"),h=s("cWXYt"),c=s("hwcfb"),d=s("3HxCM"),p=s("8X5J1");class f extends i.default{constructor(e,t,r,i){super(),e&&this.read(e,t,r,i)}}f.prototype.read=function(e,t,r,i){t&&(!r&&(e.getItems().clear(),e.setTitle(t.title||t.legendtitle||""),e.set("lineHeight",t.lineHeight),t.type&&e.set("type",t.type)),t.items&&t.items.forEach(t=>{if("Layer"===t.type){if(i){let r=i.find(e=>e.get("id")===t.id);r&&r._legend&&e.addItem(r._legend)}}else if("Image"===t.type)e.addItem(new p.default({src:t.src}));else{let r;(r=/Titre/.test(t.type)?void 0:new a.default(/Point/.test(t.type)?new n.default([0,0]):/LineString/.test(t.type)?new o.default([0,0]):new l.default([[0,0]])))&&(r.setIgnStyle(t.style),r.setStyle((0,h.getStyleFn)())),e.addItem({title:t.name,feature:r})}}),(0,u.default)(()=>{e.refresh()}))},f.prototype.write=function(e){let t={legendtitle:e.getTitle(),lineHeight:e.get("lineHeight"),legendWidth:300};return t.legendParam={width:300,lineHeight:t.lineHeight},e.get("type")&&(t.type=e.get("type")),t.items=[],e.getItems().forEach(e=>{if(e instanceof d.default)e._layer&&t.items.push({type:"Layer",id:e._layer.get("id")});else if(e instanceof p.default)t.items.push({type:"Image",src:e.get("src")});else{let r={name:e.get("title"),type:"Titre"},i=e.get("feature");i&&(r.type=i.getGeometry().getType(),"function"!=typeof i.getStyle()?r.style=(0,c.default)(i):r.style=i.getIgnStyle()),t.items.push(r)}}),t};var m=f}),n("8X5J1",function(e,r){t(e.exports,"default",()=>n);var i=s("3xROf");class a extends i.default{constructor(e){let t=(e=e||{}).src;delete e.src,super(e),this.getImage().onerror=()=>{this.dispatchEvent({type:"error"}),"function"==typeof e.onerror&&e.onerror()},this.getImage().crossOrigin="anonymous",this.getImage().src=e.src=t,this.set("src",t)}}var n=a}),n("6v9hi",function(e,r){t(e.exports,"default",()=>o);var i=s("6gELa"),a=s("5TDW7");class n extends a.default{constructor(){super()}}n.prototype.read=function(e){if("Edugeo"===e.type){switch(e.layer){case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD":case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.ROUTIER":case"GEOGRAPHICALGRIDSYSTEMS.PLANIGN":e.layer="GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.NIVEAUXGRIS":e.layer="GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",e.grayscale=!0}try{let t=new i.default({layer:e.layer,preload:10});return this.readOptions(t,e),t}catch(e){return console.error(e.message),!1}}},n.prototype.write=function(e){if("Edugeo"!==e.get("type"))return!1;var t=this.writeOptions(e);return t.layer=e.get("layer"),t.key=e.get("key"),t};var o=n}),n("lMv07",function(e,r){t(e.exports,"default",()=>f),t(e.exports,"roundCoords",()=>s("2tVQX").default);var i=s("5TDW7"),a=s("jPVWI"),n=s("20LS2"),o=s("iGyOD"),l=s("5mw1t"),u=s("2tVQX"),h=s("23ytq"),c=s("86esn");let d={};Object.keys(c.ignStyleDef).forEach(e=>{let t=c.ignStyleDef[e].short;t?d[t]?console.error("DUPLICATE style: ",e,"-",d[t],"("+t+")"):d[t]=e:console.error("MISSING style: ",e)});class p extends i.default{constructor(){super()}}p.prototype.read=function(e){if("Vector"!==e.type)return;let t=new n.default,r=new a.default({source:t});return this.readOptions(r,e),this.readFeatures(r,e)},p.prototype.readFeatures=function(e,t){let r=e.getSource(),i=[];return t.data?(i=new l.default().readFeaturesFromObject(t.data),t.data.style.forEach((e,t)=>{let r={};Object.keys(e).forEach(t=>r[d[t]]=e[t]),i[t].setIgnStyle(r)}),t.data.popupContent.forEach((e,t)=>i[t].setPopupContent(e))):t.features.forEach(e=>{let t=new o.default((0,h.ol_geom_createFromType)(e.type,e.coords));t.setProperties(e.attributes),t.setIgnStyle(e.style),t.setPopupContent(e.popupcontent),i.push(t)}),r.addFeatures(i),e.setAttributes(t.attributes),e},p.prototype.write=function(e,t){if("Vector"!==e.get("type"))return null;let r=this.writeOptions(e,{dessin:!0,attributes:Object.values(e.getAttributes())});return this.writeFeatures(e,r,t)},p.prototype.writeFeatures=function(e,t,r){let i=e.getSource().getFeatures();if(r)t.features=[],i.forEach(e=>{let r={type:e.getGeometry().getType(),coords:(0,u.default)(e.getGeometry().getCoordinates()),attributes:e.getProperties(),style:e.getIgnStyle(),popupcontent:e.getPopupContent()};delete r.attributes[e.getGeometryName()],t.features.push(r)});else{let e=new l.default({deleteNullProperties:!1,decimals:3,layout:"XYZM"});t.data=e.writeFeaturesObject(i),t.data.style=[],t.data.popupContent=[],i.forEach(e=>{let r=e.getIgnStyle(),i={};Object.keys(r).forEach(e=>{c.ignStyleDef[e]&&(i[c.ignStyleDef[e].short]=r[e])}),t.data.style.push(i),e.getPopupContent().active?t.data.popupContent.push(e.getPopupContent()):t.data.popupContent.push({})})}return t};var f=p}),n("5mw1t",function(e,r){t(e.exports,"default",()=>n);var i=s("kPMpK"),a=class extends i.default{constructor(e){super(e=e||{}),this._hash={},this._count=0,this._extended=e.extended,"function"==typeof e.whiteList?this._whiteList=e.whiteList:e.whiteList&&e.whiteList.indexOf?this._whiteList=function(t){return e.whiteList.indexOf(t)>-1}:this._whiteList=function(){return!0},"function"==typeof e.blackList?this._blackList=e.blackList:e.blackList&&e.blackList.indexOf?this._blackList=function(t){return e.blackList.indexOf(t)>-1}:this._blackList=function(){return!1},this._deleteNull=!1!==e.deleteNullProperties&&[null,void 0,""];var t=2;e.dataProjection&&"EPSG:4326"!==e.dataProjection||(t=7),isNaN(parseInt(e.decimals))||(t=parseInt(e.decimals)),this._decimals=t,this.setLayout(e.layout||"XY")}setLayout(e){switch(e){case"XYZ":case"XYZM":this._layout=e;break;default:this._layout="XY"}}getLayout(){return this._layout}encodeNumber(e,t){(isNaN(Number(e))||null===e||!isFinite(e))&&(e=0),t||0===t||(t=this._decimals),(e=Math.round(e*Math.pow(10,t)))<0?e=-2*e-1:e*=2;for(var r,i="",a=e;r=a%this._size,i=this._radix.charAt(r)+i,0!=(a=Math.floor(a/this._size)););return i}decodeNumber(e,t){t||0===t||(t=this._decimals);var r=0;e.split("").forEach((function(e){r=r*this._size+this._radix.indexOf(e)}).bind(this));var i=Math.floor(r/2);return i!==r/2&&(i=-1-i),i/Math.pow(10,t)}encodeCoordinates(e,t){var r,i,a;if("number"==typeof e[0])return i=this.encodeNumber(e[0],t)+","+this.encodeNumber(e[1],t),"Z"==this._layout[2]&&e.length>2&&(i+=","+this.encodeNumber(e[2],2)),"M"==this._layout[3]&&e.length>3&&(i+=","+this.encodeNumber(e[3],0)),i;if(!e.length||!e[0])return this.encodeCoordinates([0,0],t);if("number"==typeof e[0][0]){var s=[0,0,0,0],n=[],o="Z"==this._layout[2]&&e[0].length>2,l="M"==this._layout[3]&&e[0].length>3;for(r=0;r<e.length;r++){a=[Math.round(e[r][0]*Math.pow(10,t)),Math.round(e[r][1]*Math.pow(10,t))],o&&(a[2]=e[r][2]),l&&(a[3]=e[r][3]),e[r]=a;var u=e[r][0]-s[0],h=e[r][1]-s[1];(0==r||0!==u||0!==h)&&(i=this.encodeNumber(u,0)+","+this.encodeNumber(h,0)+(o?","+this.encodeNumber(e[r][2]-s[2],2):"")+(l?","+this.encodeNumber(e[r][3]-s[3],0):""),n.push(i),s=e[r])}return n.length<2&&e.length>1&&(i="A,A"+(o?",A":"")+(l?",A":""),n.push(i)),n.join(";")}for(r=0;r<e.length;r++)e[r]=this.encodeCoordinates(e[r],t);return e}decodeCoordinates(e,t){if("string"==typeof e){if(!((e=e.split(";")).length>1))return e=e[0].split(","),i=[this.decodeNumber(e[0],t),this.decodeNumber(e[1],t)],e.length>2&&(i[2]=this.decodeNumber(e[2],2)),e.length>3&&(i[3]=this.decodeNumber(e[3],0)),i;var r,i,a=Math.pow(10,t),s=[0,0,0,0];return e.forEach((function(r,i){e[i]=r.split(","),e[i][0]=Math.round((this.decodeNumber(e[i][0],t)+s[0])*a)/a,e[i][1]=Math.round((this.decodeNumber(e[i][1],t)+s[1])*a)/a,e[i].length>2&&(e[i][2]=Math.round((this.decodeNumber(e[i][2],2)+s[2])*a)/a),e[i].length>3&&(e[i][3]=Math.round((this.decodeNumber(e[i][3],0)+s[3])*a)/a),s=e[i]}).bind(this)),e}if(!e.length)return[0,0];var n=[];for(r=0;r<e.length;r++)n[r]=this.decodeCoordinates(e[r],t);return n}writeFeaturesObject(e,t){t=t||{},this._count=0,this._hash={};var r=(0,i.default).prototype.writeFeaturesObject.call(this,e,t);r.decimals=this._decimals,r.hashProperties=[],Object.keys(this._hash).forEach((function(e){r.hashProperties.push(e)}).bind(this)),this._count=0,this._hash={};var a=r.features;return delete r.features,r.features=a,r}writeFeatureObject(e,t){var r,a=(0,i.default).prototype.writeFeatureObject.call(this,e,t);if("Feature"!==a.type)throw"GeoJSONX doesn't support "+a.type+".";var s=[];if("Point"===a.geometry.type)s.push(this.encodeCoordinates(a.geometry.coordinates,this._decimals));else if("MultiPoint"===a.geometry.type){var n=[];a.geometry.coordinates.forEach((function(e){n.push(this.encodeCoordinates(e,this._decimals))}).bind(this)),s.push([this._type[a.geometry.type],n.join(";")])}else{if(!this._type[a.geometry.type])throw"GeoJSONX doesn't support "+a.geometry.type+".";s.push([this._type[a.geometry.type],this.encodeCoordinates(a.geometry.coordinates,this._decimals)])}var o=[];for(r in a.properties)!(!this._whiteList(r)||this._blackList(r))&&(!this._hash.hasOwnProperty(r)&&(this._hash[r]=this._count,this._count++),(!this._deleteNull||0>this._deleteNull.indexOf(a.properties[r]))&&o.push(this._hash[r],a.properties[r]));if((o.length||this._extended)&&s.push(o),this._extended){var l=!1;for(r in o={},a)/^type$|^geometry$|^properties$/.test(r)||(o[r]=a[r],l=!0);l&&s.push(o)}return s}writeGeometryObject(e,t){var r=(0,i.default).prototype.writeGeometryObject.call(this,e,t);return"Point"===r.type?this.encodeCoordinates(r.coordinates,this._decimals):[this._type[r.type],this.encodeCoordinates(r.coordinates,this._decimals)]}readFeaturesFromObject(e,t){if(this._hashProperties=e.hashProperties||[],(t=t||{}).decimals=parseInt(e.decimals),!t.decimals&&0!==t.decimals)throw"Bad file format...";return(0,i.default).prototype.readFeaturesFromObject.call(this,e,t)}readFeatureFromObject(e,t){var r={type:"Feature"};if("string"==typeof e[0])r.geometry={type:"Point",coordinates:this.decodeCoordinates(e[0],"number"==typeof t.decimals?t.decimals:this.decimals)};else if(r.geometry={type:this._toType[e[0][0]]},"MultiPoint"===r.geometry.type){var a=r.geometry.coordinates=[];e[0][1].split(";").forEach((function(e){e=e.split(","),a.push([this.decodeNumber(e[0],t.decimals),this.decodeNumber(e[1],t.decimals)])}).bind(this))}else r.geometry.coordinates=this.decodeCoordinates(e[0][1],"number"==typeof t.decimals?t.decimals:this.decimals);if(this._hashProperties&&e[1]){r.properties={};for(var s=e[1],n=0;n<s.length;n+=2)r.properties[this._hashProperties[s[n]]]=s[n+1]}else r.properties=e[1];if(e[2])for(var o in e[2])r[o]=e[2][o];return(0,i.default).prototype.readFeatureFromObject.call(this,r,t)}};a.prototype._radix="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ !#$%&'()*-.:<=>?@[]^_`{|}~",a.prototype._size=a.prototype._radix.length,a.prototype._type={Point:0,LineString:1,Polygon:2,MultiPoint:3,MultiLineString:4,MultiPolygon:5,GeometryCollection:null},a.prototype._toType=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"];var n=a}),n("eZiYk",function(e,r){t(e.exports,"default",()=>l);var i=s("dMe05"),a=s("2RsmU"),n=s("5TDW7");class o extends n.default{constructor(){super()}}o.prototype.read=function(e){if("GeoImage"!==e.type)return!1;var t=new a.default({url:e.url,imageCenter:e.imageCenter,imageRotate:e.imageRotate,imageScale:e.imageScale,imageMask:e.imageMask,crossOrigin:e.crossOrigin}),r=new i.default({source:t});return this.readOptions(r,e),r},o.prototype.write=function(e){return"GeoImage"===e.get("type")&&this.writeOptions(e,{url:e.getSource().getGeoImage().src,imageCenter:e.getSource().getCenter(),imageRotate:e.getSource().getRotation(),imageScale:e.getSource().getScale(),imageMask:e.getSource().getMask(),crossOrigin:e.getSource().getGeoImage().crossOrigin})};var l=o}),n("2RsmU",function(e,r){t(e.exports,"default",()=>o);var i=s("9brqU"),a=s("cgPpQ"),n=s("jZquI"),o=class extends i.default{constructor(e){var t={attributions:e.attributions,logo:e.logo,projection:e.projection};t.canvasFunction=function(e,t,r,i){return this.calculateImage(e,t,r,i)},super(t),this._image=e.image?e.image:new Image,this._image.crossOrigin=e.crossOrigin,this._image.onload=(function(){this.setCrop(this.crop),this.changed()}).bind(this),e.image||(this._image.src=e.url),this.center=e.imageCenter,this.setScale(e.imageScale),this.rotate=e.imageRotate?e.imageRotate:0,this.crop=e.imageCrop,this.mask=e.imageMask,this.setCrop(this.crop),this.on("change",(function(){this.set("extent",this.calculateExtent())}).bind(this))}calculateImage(e,t,r,i){if(this.center){var a=document.createElement("canvas");a.width=i[0],a.height=i[1];var s=a.getContext("2d");if(!this._imageSize)return a;if(this.mask){s.beginPath();var n=p(this.mask[0]);s.moveTo(n[0],n[1]);for(var o=1;o<this.mask.length;o++)n=p(this.mask[o]),s.lineTo(n[0],n[1]);s.clip()}var l=p(this.center),u=(this._image.naturalWidth/2-this.crop[0])*this.scale[0]/t*r,h=(this._image.naturalHeight/2-this.crop[1])*this.scale[1]/t*r,c=this._imageSize[0]*this.scale[0]/t*r,d=this._imageSize[1]*this.scale[1]/t*r;return s.translate(l[0],l[1]),this.rotate&&s.rotate(this.rotate),s.drawImage(this._image,this.crop[0],this.crop[1],this._imageSize[0],this._imageSize[1],-u,-h,c,d),a}function p(t){return[(t[0]-e[0])/(e[2]-e[0])*i[0],(t[1]-e[3])/(e[1]-e[3])*i[1]]}}getCenter(){return this.center}setCenter(e){this.center=e,this.changed()}getScale(){return this.scale}setScale(e){switch(typeof e){case"number":e=[e,e];break;case"object":if(2!=e.length)return;break;default:return}this.scale=e,this.changed()}getRotation(){return this.rotate}setRotation(e){this.rotate=e,this.changed()}getGeoImage(){return this._image}getCrop(){return this.crop}setMask(e){this.mask=e,this.changed()}getMask(){return this.mask}setCrop(e){if(!this._image.naturalWidth){this.crop=e;return}if(e){switch(typeof e){case"number":e=[e,e,this._image.naturalWidth-e,this._image.naturalHeight-e];break;case"object":if(4!=e.length)return;break;default:return}e=(0,n.boundingExtent)([[e[0],e[1]],[e[2],e[3]]]),this.crop=[Math.max(0,e[0]),Math.max(0,e[1]),Math.min(this._image.naturalWidth,e[2]),Math.min(this._image.naturalHeight,e[3])]}else this.crop=[0,0,this._image.naturalWidth,this._image.naturalHeight];this.crop[2]<=this.crop[0]&&(this.crop[2]=this.crop[0]+1),this.crop[3]<=this.crop[1]&&(this.crop[3]=this.crop[1]+1),this._imageSize=[this.crop[2]-this.crop[0],this.crop[3]-this.crop[1]],this.changed()}getExtent(e){var t=this.get("extent");if(t||(t=this.calculateExtent()),e)for(var r=0;r<e.length;r++)e[r]=t[r];return t}calculateExtent(e){if(!1!==e&&this.getMask())t=new a.default([this.getMask()]);else{var t,r=this.getCenter(),i=this.getScale(),s=this.getGeoImage().width*i[0],o=this.getGeoImage().height*i[1],l=(0,n.boundingExtent)([[r[0]-s/2,r[1]-o/2],[r[0]+s/2,r[1]+o/2]]);(t=(0,a.fromExtent)(l)).rotate(-this.getRotation(),r)}return t.getExtent()}}}),n("9brqU",function(e,r){t(e.exports,"default",()=>l);var i=s("34ffr"),a=s("jZquI"),n=s("3i1Ma");class o extends n.default{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvasFunction_=e.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==e.ratio?e.ratio:1.5}getImageInternal(e,t,r,s){t=this.findNearestResolution(t);let n=this.canvas_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==t&&n.getPixelRatio()==r&&(0,a.containsExtent)(n.getExtent(),e))return n;e=e.slice(),(0,a.scaleFromCenter)(e,this.ratio_);let o=[(0,a.getWidth)(e)/t*r,(0,a.getHeight)(e)/t*r],l=this.canvasFunction_.call(this,e,t,r,o,s);return l&&(n=new i.default(e,t,r,l)),this.canvas_=n,this.renderedRevision_=this.getRevision(),n}}var l=o}),n("cBppj",function(e,r){t(e.exports,"default",()=>p);var i=s("5TDW7"),a=s("20LS2"),n=s("iGyOD"),o=s("bXE6B"),l=s("5mw1t"),u=s("5MXCy"),h=s("23ytq");s("lMv07");var c=s("2tVQX");class d extends i.default{constructor(){super()}}d.prototype.read=function(e){if("Statistique"!==e.type)return;let t=[];if(e.url)try{fetch(e.url).then(e=>e.text()).then(t=>{i.set("url",e.url);let a=new(0,u.default)().readFeatures(t,{featureProjection:"EPSG:3857"});a&&(r.addFeatures(a),i.setStatistic(i.getStatistic()))}).catch(()=>{})}catch(e){return}else e.data?t=new l.default().readFeaturesFromObject(e.data):e.features.forEach(e=>{let r=new n.default((0,h.ol_geom_createFromType)(e.type,e.coords));r.setProperties(e.attributes),t.push(r)});let r=new a.default;r.addFeatures(t);let i=new o.default({source:r});return void 0===e.selectable&&(e.selectable=!1),this.readOptions(i,e),i.setStatistic(e.stat),e.popupContent&&i.setPopupContent(e.popupContent),i},d.prototype.write=function(e,t){if(!(e instanceof o.default))return!1;var r=this.writeOptions(e,{type:"Statistique"});if(r.stat=e.getStatistic(),1===r.stat.cols.length&&r.stat.cols.push(r.stat.cols[0]),r.popupContent=e.getPopupContent(),e.get("url"))r.url=e.get("url");else{let i=e.getSource().getFeatures();if(t)r.features=[],i.forEach(e=>{let t={type:e.getGeometry().getType(),coords:(0,c.default)(e.getGeometry().getCoordinates()),attributes:e.getProperties()};delete t.attributes[e.getGeometryName()],r.features.push(t)});else{let e=new l.default({decimals:3});r.data=e.writeFeaturesObject(i)}}return r};var p=d}),n("5MXCy",function(e,r){t(e.exports,"default",()=>g);var i=s("iceob"),a=s("kPMpK"),n=s("aVfgG"),o=s("5bIDX"),l=s("6b5au"),u=s("5mw1t"),h=s("29jcm"),c=s("6xHMs"),d=s("6zjoU"),p=s("9z1G1");class f extends p.default{constructor(e){super(e)}}function m(e,t){if(!e||!e.length)return!1;if(t>0){for(let r=0;r<e.length;r++)if(!m(e[r],t-1))return!1}else if(e.length<2)return!1;return!0}f.formatConstructors=[i.default,u.default,h.default,a.default,n.default,o.default,l.default,c.default,d.default],f.prototype.readFeatures=function(e,t){for(var r=0;r<f.formatConstructors.length;++r){var i=f.formatConstructors[r];try{var a=new i(t).readFeatures(e,t);let r=[];if(a.forEach((e,t)=>{try{let i=e.getGeometry().getCoordinates();switch(e.getGeometry().getType()){case"Point":m(i,0)||r.push(t);break;case"MultiPoint":case"LineString":m(i,1)||r.push(t);break;case"MultiLineString":case"Polygon":m(i,2)||r.push(t);break;case"MultiPolygon":m(i,3)||r.push(t);break;default:console.log(t)}}catch(e){r.push(t)}}),r.reverse().forEach(e=>a.splice(e,1)),a&&a.length>0)return a}catch(e){}}return[]};var g=f}),n("iceob",function(e,r){t(e.exports,"default",()=>X);var i=s("iGyOD"),a=s("hvEnP"),n=s("7TB1l"),o=s("j2K3b"),l=s("gzr8q"),u=s("fbciu"),h=s("9z1G1"),c=s("ZEJBL"),d=s("5kLwh");let p=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],f={rte:Z,trk:V,wpt:Y},m=(0,u.makeStructureNS)(p,{rte:(0,u.makeArrayPusher)(Z),trk:(0,u.makeArrayPusher)(V),wpt:(0,u.makeArrayPusher)(Y)}),g=(0,u.makeStructureNS)(p,{text:(0,u.makeObjectPropertySetter)(d.readString,"linkText"),type:(0,u.makeObjectPropertySetter)(d.readString,"linkType")}),y=(0,u.makeStructureNS)(p,{name:(0,u.makeObjectPropertySetter)(d.readString),email:function(e,t){let r=t[t.length-1],i=e.getAttribute("id"),a=e.getAttribute("domain");null!==i&&null!==a&&(r.email=`${i}@${a}`)},link:U}),v=(0,u.makeStructureNS)(p,{name:(0,u.makeObjectPropertySetter)(d.readString),desc:(0,u.makeObjectPropertySetter)(d.readString),author:(0,u.makeObjectPropertySetter)(function(e,t){let r=(0,u.pushParseAndPop)({},y,e,t);if(r)return r}),copyright:(0,u.makeObjectPropertySetter)(function(e,t){let r=(0,u.pushParseAndPop)({},_,e,t);if(r){let t=e.getAttribute("author");return null!==t&&(r.author=t),r}}),link:U,time:(0,u.makeObjectPropertySetter)(d.readDateTime),keywords:(0,u.makeObjectPropertySetter)(d.readString),bounds:function(e,t){let r=t[t.length-1],i=e.getAttribute("minlat"),a=e.getAttribute("minlon"),s=e.getAttribute("maxlat"),n=e.getAttribute("maxlon");null!==a&&null!==i&&null!==n&&null!==s&&(r.bounds=[[parseFloat(a),parseFloat(i)],[parseFloat(n),parseFloat(s)]])},extensions:H}),_=(0,u.makeStructureNS)(p,{year:(0,u.makeObjectPropertySetter)(d.readPositiveInteger),license:(0,u.makeObjectPropertySetter)(d.readString)}),x=(0,u.makeStructureNS)(p,{rte:(0,u.makeChildAppender)(function(e,t,r){let i=r[0],a=t.getProperties(),s={node:e};s.properties=a;let n=t.getGeometry();if("LineString"==n.getType()){let e=(0,h.transformGeometryWithOptions)(n,!0,i);s.geometryLayout=e.getLayout(),a.rtept=e.getCoordinates()}let o=I[r[r.length-1].node.namespaceURI],l=(0,u.makeSequence)(a,o);(0,u.pushSerializeAndPop)(s,L,u.OBJECT_PROPERTY_NODE_FACTORY,l,r,o)}),trk:(0,u.makeChildAppender)(function(e,t,r){let i=r[0],a=t.getProperties(),s={node:e};s.properties=a;let n=t.getGeometry();if("MultiLineString"==n.getType()){let e=(0,h.transformGeometryWithOptions)(n,!0,i);a.trkseg=e.getLineStrings()}let o=M[r[r.length-1].node.namespaceURI],l=(0,u.makeSequence)(a,o);(0,u.pushSerializeAndPop)(s,k,u.OBJECT_PROPERTY_NODE_FACTORY,l,r,o)}),wpt:(0,u.makeChildAppender)(function(e,t,r){let i=r[0],a=r[r.length-1];a.properties=t.getProperties();let s=t.getGeometry();if("Point"==s.getType()){let t=(0,h.transformGeometryWithOptions)(s,!0,i);a.geometryLayout=t.getLayout(),$(e,t.getCoordinates(),r)}})});class b extends c.default{constructor(e){super(),e=e||{},this.dataProjection=(0,l.get)("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){let r=e[t];if(this.readExtensions_){let e=r.get("extensionsNode_")||null;this.readExtensions_(r,e)}r.set("extensionsNode_",void 0)}}readMetadata(e){return e?"string"==typeof e?this.readMetadataFromDocument((0,u.parse)(e)):(0,u.isDocument)(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){let e=this.readMetadataFromNode(t);if(e)return e}return null}readMetadataFromNode(e){if(!p.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(p.includes(t.namespaceURI)&&"metadata"===t.localName)return(0,u.pushParseAndPop)({},v,t,[]);return null}readFeatureFromNode(e,t){if(!p.includes(e.namespaceURI))return null;let r=f[e.localName];if(!r)return null;let i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!p.includes(e.namespaceURI))return[];if("gpx"==e.localName){let r=(0,u.pushParseAndPop)([],m,e,[this.getReadOptions(e,t)]);if(r)return this.handleReadExtensions_(r),r}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);let r=(0,u.createElementNS)("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",u.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(u.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),(0,u.pushSerializeAndPop)({node:r},x,q,e,[t]),r}}let S=(0,u.makeStructureNS)(p,{name:(0,u.makeObjectPropertySetter)(d.readString),cmt:(0,u.makeObjectPropertySetter)(d.readString),desc:(0,u.makeObjectPropertySetter)(d.readString),src:(0,u.makeObjectPropertySetter)(d.readString),link:U,number:(0,u.makeObjectPropertySetter)(d.readPositiveInteger),extensions:H,type:(0,u.makeObjectPropertySetter)(d.readString),rtept:function(e,t){let r=(0,u.pushParseAndPop)({},w,e,t);if(r){let i=t[t.length-1];j(i.flatCoordinates,i.layoutOptions,e,r)}}}),w=(0,u.makeStructureNS)(p,{ele:(0,u.makeObjectPropertySetter)(d.readDecimal),time:(0,u.makeObjectPropertySetter)(d.readDateTime)}),E=(0,u.makeStructureNS)(p,{name:(0,u.makeObjectPropertySetter)(d.readString),cmt:(0,u.makeObjectPropertySetter)(d.readString),desc:(0,u.makeObjectPropertySetter)(d.readString),src:(0,u.makeObjectPropertySetter)(d.readString),link:U,number:(0,u.makeObjectPropertySetter)(d.readPositiveInteger),type:(0,u.makeObjectPropertySetter)(d.readString),extensions:H,trkseg:function(e,t){let r=t[t.length-1];(0,u.parseNode)(A,e,t);let i=r.flatCoordinates;r.ends.push(i.length)}}),A=(0,u.makeStructureNS)(p,{trkpt:function(e,t){let r=(0,u.pushParseAndPop)({},T,e,t);if(r){let i=t[t.length-1];j(i.flatCoordinates,i.layoutOptions,e,r)}}}),T=(0,u.makeStructureNS)(p,{ele:(0,u.makeObjectPropertySetter)(d.readDecimal),time:(0,u.makeObjectPropertySetter)(d.readDateTime)}),C=(0,u.makeStructureNS)(p,{ele:(0,u.makeObjectPropertySetter)(d.readDecimal),time:(0,u.makeObjectPropertySetter)(d.readDateTime),magvar:(0,u.makeObjectPropertySetter)(d.readDecimal),geoidheight:(0,u.makeObjectPropertySetter)(d.readDecimal),name:(0,u.makeObjectPropertySetter)(d.readString),cmt:(0,u.makeObjectPropertySetter)(d.readString),desc:(0,u.makeObjectPropertySetter)(d.readString),src:(0,u.makeObjectPropertySetter)(d.readString),link:U,sym:(0,u.makeObjectPropertySetter)(d.readString),type:(0,u.makeObjectPropertySetter)(d.readString),fix:(0,u.makeObjectPropertySetter)(d.readString),sat:(0,u.makeObjectPropertySetter)(d.readPositiveInteger),hdop:(0,u.makeObjectPropertySetter)(d.readDecimal),vdop:(0,u.makeObjectPropertySetter)(d.readDecimal),pdop:(0,u.makeObjectPropertySetter)(d.readDecimal),ageofdgpsdata:(0,u.makeObjectPropertySetter)(d.readDecimal),dgpsid:(0,u.makeObjectPropertySetter)(d.readPositiveInteger),extensions:H}),P=["text","type"],R=(0,u.makeStructureNS)(p,{text:(0,u.makeChildAppender)(d.writeStringTextNode),type:(0,u.makeChildAppender)(d.writeStringTextNode)}),I=(0,u.makeStructureNS)(p,["name","cmt","desc","src","link","number","type","rtept"]),L=(0,u.makeStructureNS)(p,{name:(0,u.makeChildAppender)(d.writeStringTextNode),cmt:(0,u.makeChildAppender)(d.writeStringTextNode),desc:(0,u.makeChildAppender)(d.writeStringTextNode),src:(0,u.makeChildAppender)(d.writeStringTextNode),link:(0,u.makeChildAppender)(W),number:(0,u.makeChildAppender)(d.writeNonNegativeIntegerTextNode),type:(0,u.makeChildAppender)(d.writeStringTextNode),rtept:(0,u.makeArraySerializer)((0,u.makeChildAppender)($))}),O=(0,u.makeStructureNS)(p,["ele","time"]),M=(0,u.makeStructureNS)(p,["name","cmt","desc","src","link","number","type","trkseg"]),k=(0,u.makeStructureNS)(p,{name:(0,u.makeChildAppender)(d.writeStringTextNode),cmt:(0,u.makeChildAppender)(d.writeStringTextNode),desc:(0,u.makeChildAppender)(d.writeStringTextNode),src:(0,u.makeChildAppender)(d.writeStringTextNode),link:(0,u.makeChildAppender)(W),number:(0,u.makeChildAppender)(d.writeNonNegativeIntegerTextNode),type:(0,u.makeChildAppender)(d.writeStringTextNode),trkseg:(0,u.makeArraySerializer)((0,u.makeChildAppender)(function(e,t,r){let i={node:e};i.geometryLayout=t.getLayout(),i.properties={},(0,u.pushSerializeAndPop)(i,D,N,t.getCoordinates(),r)}))}),N=(0,u.makeSimpleNodeFactory)("trkpt"),D=(0,u.makeStructureNS)(p,{trkpt:(0,u.makeChildAppender)($)}),F=(0,u.makeStructureNS)(p,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),G=(0,u.makeStructureNS)(p,{ele:(0,u.makeChildAppender)(d.writeDecimalTextNode),time:(0,u.makeChildAppender)(d.writeDateTimeTextNode),magvar:(0,u.makeChildAppender)(d.writeDecimalTextNode),geoidheight:(0,u.makeChildAppender)(d.writeDecimalTextNode),name:(0,u.makeChildAppender)(d.writeStringTextNode),cmt:(0,u.makeChildAppender)(d.writeStringTextNode),desc:(0,u.makeChildAppender)(d.writeStringTextNode),src:(0,u.makeChildAppender)(d.writeStringTextNode),link:(0,u.makeChildAppender)(W),sym:(0,u.makeChildAppender)(d.writeStringTextNode),type:(0,u.makeChildAppender)(d.writeStringTextNode),fix:(0,u.makeChildAppender)(d.writeStringTextNode),sat:(0,u.makeChildAppender)(d.writeNonNegativeIntegerTextNode),hdop:(0,u.makeChildAppender)(d.writeDecimalTextNode),vdop:(0,u.makeChildAppender)(d.writeDecimalTextNode),pdop:(0,u.makeChildAppender)(d.writeDecimalTextNode),ageofdgpsdata:(0,u.makeChildAppender)(d.writeDecimalTextNode),dgpsid:(0,u.makeChildAppender)(d.writeNonNegativeIntegerTextNode)}),z={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function q(e,t,r){let i=e.getGeometry();if(i){let e=z[i.getType()];if(e){let r=t[t.length-1].node;return(0,u.createElementNS)(r.namespaceURI,e)}}}function j(e,t,r,i){return e.push(parseFloat(r.getAttribute("lon")),parseFloat(r.getAttribute("lat"))),"ele"in i?(e.push(i.ele),delete i.ele,t.hasZ=!0):e.push(0),"time"in i?(e.push(i.time),delete i.time,t.hasM=!0):e.push(0),e}function B(e,t,r){let i="XY",a=2;if(e.hasZ&&e.hasM?(i="XYZM",a=4):e.hasZ?(i="XYZ",a=3):e.hasM&&(i="XYM",a=3),4!==a){for(let r=0,i=t.length/4;r<i;r++)t[r*a]=t[4*r],t[r*a+1]=t[4*r+1],e.hasZ&&(t[r*a+2]=t[4*r+2]),e.hasM&&(t[r*a+2]=t[4*r+3]);if(t.length=t.length/4*a,r)for(let e=0,t=r.length;e<t;e++)r[e]=r[e]/4*a}return i}function U(e,t){let r=t[t.length-1],i=e.getAttribute("href");null!==i&&(r.link=i),(0,u.parseNode)(g,e,t)}function H(e,t){t[t.length-1].extensionsNode_=e}function Z(e,t){let r=t[0],s=(0,u.pushParseAndPop)({flatCoordinates:[],layoutOptions:{}},S,e,t);if(!s)return;let n=s.flatCoordinates;delete s.flatCoordinates;let o=s.layoutOptions;delete s.layoutOptions;let l=B(o,n),c=new a.default(n,l);(0,h.transformGeometryWithOptions)(c,!1,r);let d=new i.default(c);return d.setProperties(s,!0),d}function V(e,t){let r=t[0],a=(0,u.pushParseAndPop)({flatCoordinates:[],ends:[],layoutOptions:{}},E,e,t);if(!a)return;let s=a.flatCoordinates;delete a.flatCoordinates;let o=a.ends;delete a.ends;let l=a.layoutOptions;delete a.layoutOptions;let c=B(l,s,o),d=new n.default(s,c,o);(0,h.transformGeometryWithOptions)(d,!1,r);let p=new i.default(d);return p.setProperties(a,!0),p}function Y(e,t){let r=t[0],a=(0,u.pushParseAndPop)({},C,e,t);if(!a)return;let s={},n=j([],s,e,a),l=B(s,n),c=new o.default(n,l);(0,h.transformGeometryWithOptions)(c,!1,r);let d=new i.default(c);return d.setProperties(a,!0),d}function W(e,t,r){e.setAttribute("href",t);let i=r[r.length-1].properties,a=[i.linkText,i.linkType];(0,u.pushSerializeAndPop)({node:e},R,u.OBJECT_PROPERTY_NODE_FACTORY,a,r,P)}function $(e,t,r){let i=r[r.length-1],a=i.node.namespaceURI,s=i.properties;switch(e.setAttributeNS(null,"lat",String(t[1])),e.setAttributeNS(null,"lon",String(t[0])),i.geometryLayout){case"XYZM":0!==t[3]&&(s.time=t[3]);case"XYZ":0!==t[2]&&(s.ele=t[2]);break;case"XYM":0!==t[2]&&(s.time=t[2])}let n="rtept"==e.nodeName?O[a]:F[a],o=(0,u.makeSequence)(s,n);(0,u.pushSerializeAndPop)({node:e,properties:s},G,u.OBJECT_PROPERTY_NODE_FACTORY,o,r,n)}var X=b}),n("ZEJBL",function(e,r){t(e.exports,"default",()=>u);var i=s("kBSVF"),a=s("9z1G1"),n=s("lVQul"),o=s("fbciu");class l extends a.default{constructor(){super(),this.xmlSerializer_=(0,o.getXMLSerializer)()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if("string"==typeof e){let r=(0,o.parse)(e);return this.readFeatureFromDocument(r,t)}return(0,o.isDocument)(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){let r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if("string"==typeof e){let r=(0,o.parse)(e);return this.readFeaturesFromDocument(r,t)}return(0,o.isDocument)(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){let r=[];for(let a=e.firstChild;a;a=a.nextSibling)a.nodeType==Node.ELEMENT_NODE&&(0,i.extend)(r,this.readFeaturesFromNode(a,t));return r}readFeaturesFromNode(e,t){return(0,n.abstract)()}readGeometry(e,t){if(!e)return null;if("string"==typeof e){let r=(0,o.parse)(e);return this.readGeometryFromDocument(r,t)}return(0,o.isDocument)(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if("string"==typeof e){let t=(0,o.parse)(e);return this.readProjectionFromDocument(t)}return(0,o.isDocument)(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){let r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){let r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){let r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}var u=l}),n("aVfgG",function(e,r){t(e.exports,"default",()=>m);var i=s("iGyOD"),a=s("hvEnP"),n=s("gzr8q"),o=s("9z1G1"),l=s("jEnSw");let u=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,h=/^H.([A-Z]{3}).*?:(.*)/,c=/^HFDTE(\d{2})(\d{2})(\d{2})/,d=/^HFDTEDATE:(\d{2})(\d{2})(\d{2}),(\d{2})/,p=/\r\n|\r|\n/;class f extends l.default{constructor(e){super(),e=e||{},this.dataProjection=(0,n.get)("EPSG:4326"),this.altitudeMode_=e.altitudeMode?e.altitudeMode:"none",this.lad_=!1,this.lod_=!1,this.ladStart_=0,this.ladStop_=0,this.lodStart_=0,this.lodStop_=0}readFeatureFromText(e,t){let r,s;let n=this.altitudeMode_,l=e.split(p),f={},m=[],g=2e3,y=0,v=1,_=-1;for(r=0,s=l.length;r<s;++r){let e;let t=l[r];if("B"==t.charAt(0)){if(e=u.exec(t)){let r=parseInt(e[1],10),i=parseInt(e[2],10),a=parseInt(e[3],10),s=parseInt(e[4],10)+parseInt(e[5],10)/6e4;this.lad_&&(s+=parseInt(t.slice(this.ladStart_,this.ladStop_),10)/6e4/10**(this.ladStop_-this.ladStart_)),"S"==e[6]&&(s=-s);let o=parseInt(e[7],10)+parseInt(e[8],10)/6e4;if(this.lod_&&(o+=parseInt(t.slice(this.lodStart_,this.lodStop_),10)/6e4/10**(this.lodStop_-this.lodStart_)),"W"==e[9]&&(o=-o),m.push(o,s),"none"!=n){let t;t="gps"==n?parseInt(e[11],10):"barometric"==n?parseInt(e[12],10):0,m.push(t)}let l=Date.UTC(g,y,v,r,i,a);l<_&&(l=Date.UTC(g,y,v+1,r,i,a)),m.push(l/1e3),_=l}}else if("H"==t.charAt(0))(e=d.exec(t))?(v=parseInt(e[1],10),y=parseInt(e[2],10)-1,g=2e3+parseInt(e[3],10)):(e=c.exec(t))?(v=parseInt(e[1],10),y=parseInt(e[2],10)-1,g=2e3+parseInt(e[3],10)):(e=h.exec(t))&&(f[e[1]]=e[2].trim());else if("I"==t.charAt(0)){let e=parseInt(t.slice(1,3),10);for(let r=0;r<e;r++){let e=t.slice(7+7*r,10+7*r);if("LAD"===e||"LOD"===e){let i=parseInt(t.slice(3+7*r,5+7*r),10)-1,a=parseInt(t.slice(5+7*r,7+7*r),10);"LAD"===e?(this.lad_=!0,this.ladStart_=i,this.ladStop_=a):"LOD"===e&&(this.lod_=!0,this.lodStart_=i,this.lodStop_=a)}}}}if(0===m.length)return null;let x=new a.default(m,"none"==n?"XYM":"XYZM"),b=new i.default((0,o.transformGeometryWithOptions)(x,!1,t));return b.setProperties(f,!0),b}readFeaturesFromText(e,t){let r=this.readFeatureFromText(e,t);return r?[r]:[]}}var m=f}),n("jEnSw",function(e,r){t(e.exports,"default",()=>l);var i=s("9z1G1"),a=s("lVQul");class n extends i.default{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(o(e),this.adaptOptions(t))}readFeatureFromText(e,t){return(0,a.abstract)()}readFeatures(e,t){return this.readFeaturesFromText(o(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return(0,a.abstract)()}readGeometry(e,t){return this.readGeometryFromText(o(e),this.adaptOptions(t))}readGeometryFromText(e,t){return(0,a.abstract)()}readProjection(e){return this.readProjectionFromText(o(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return(0,a.abstract)()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return(0,a.abstract)()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return(0,a.abstract)()}}function o(e){return"string"==typeof e?e:""}var l=n}),n("5bIDX",function(e,r){let i,a,n,o,l,u,h,c,d;t(e.exports,"default",()=>tm);var p=s("iGyOD"),f=s("50PZ9"),m=s("kBSVF"),g=s("lqNjm"),y=s("6pyIt"),v=s("hvEnP"),_=s("7TB1l"),x=s("ljDIj"),b=s("dEQmT"),S=s("j2K3b"),w=s("cgPpQ"),E=s("a6roo"),A=s("gzr8q"),T=s("2zf1Y"),C=s("ayeEa"),P=s("d5AAH"),R=s("l9IGS"),I=s("kuKBR"),L=s("fbciu"),O=s("9z1G1"),M=s("ZEJBL"),k=s("5kLwh");let N=["http://www.google.com/kml/ext/2.2"],D=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],F={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},G=(0,L.makeStructureNS)(D,{ExtendedData:eL,Region:eO,MultiGeometry:(0,L.makeObjectPropertySetter)(eS,"geometry"),LineString:(0,L.makeObjectPropertySetter)(e_,"geometry"),LinearRing:(0,L.makeObjectPropertySetter)(ex,"geometry"),Point:(0,L.makeObjectPropertySetter)(ew,"geometry"),Polygon:(0,L.makeObjectPropertySetter)(eA,"geometry"),Style:(0,L.makeObjectPropertySetter)(eC),StyleMap:function(e,t){let r=es.call(this,e,t);if(!r)return;let i=t[t.length-1];if(Array.isArray(r))i.Style=r;else if("string"==typeof r)i.styleUrl=r;else throw Error("`styleMapValue` has an unknown type")},address:(0,L.makeObjectPropertySetter)(k.readString),description:(0,L.makeObjectPropertySetter)(k.readString),name:(0,L.makeObjectPropertySetter)(k.readString),open:(0,L.makeObjectPropertySetter)(k.readBoolean),phoneNumber:(0,L.makeObjectPropertySetter)(k.readString),styleUrl:(0,L.makeObjectPropertySetter)(er),visibility:(0,L.makeObjectPropertySetter)(k.readBoolean)},(0,L.makeStructureNS)(N,{MultiTrack:(0,L.makeObjectPropertySetter)(function(e,t){let r=(0,L.pushParseAndPop)([],ed,e,t);if(r)return new _.default(r)},"geometry"),Track:(0,L.makeObjectPropertySetter)(ef,"geometry")})),z=(0,L.makeStructureNS)(D,{ExtendedData:eL,Region:eO,Link:function(e,t){(0,L.parseNode)(q,e,t)},address:(0,L.makeObjectPropertySetter)(k.readString),description:(0,L.makeObjectPropertySetter)(k.readString),name:(0,L.makeObjectPropertySetter)(k.readString),open:(0,L.makeObjectPropertySetter)(k.readBoolean),phoneNumber:(0,L.makeObjectPropertySetter)(k.readString),visibility:(0,L.makeObjectPropertySetter)(k.readBoolean)}),q=(0,L.makeStructureNS)(D,{href:(0,L.makeObjectPropertySetter)(et)}),j=(0,L.makeStructureNS)(D,{Altitude:(0,L.makeObjectPropertySetter)(k.readDecimal),Longitude:(0,L.makeObjectPropertySetter)(k.readDecimal),Latitude:(0,L.makeObjectPropertySetter)(k.readDecimal),Tilt:(0,L.makeObjectPropertySetter)(k.readDecimal),AltitudeMode:(0,L.makeObjectPropertySetter)(k.readString),Heading:(0,L.makeObjectPropertySetter)(k.readDecimal),Roll:(0,L.makeObjectPropertySetter)(k.readDecimal)}),B=(0,L.makeStructureNS)(D,{LatLonAltBox:function(e,t){let r=(0,L.pushParseAndPop)({},eN,e,t);if(!r)return;let i=t[t.length-1],a=[parseFloat(r.west),parseFloat(r.south),parseFloat(r.east),parseFloat(r.north)];i.extent=a,i.altitudeMode=r.altitudeMode,i.minAltitude=parseFloat(r.minAltitude),i.maxAltitude=parseFloat(r.maxAltitude)},Lod:function(e,t){let r=(0,L.pushParseAndPop)({},eD,e,t);if(!r)return;let i=t[t.length-1];i.minLodPixels=parseFloat(r.minLodPixels),i.maxLodPixels=parseFloat(r.maxLodPixels),i.minFadeExtent=parseFloat(r.minFadeExtent),i.maxFadeExtent=parseFloat(r.maxFadeExtent)}}),U=(0,L.makeStructureNS)(D,["Document","Placemark"]),H=(0,L.makeStructureNS)(D,{Document:(0,L.makeChildAppender)(function(e,t,r){(0,L.pushSerializeAndPop)({node:e},ej,eB,t,r,void 0,this)}),Placemark:(0,L.makeChildAppender)(tr)}),Z=null,V=null,Y=null,W=null,$=null;function X(e){return 32/Math.min(e[0],e[1])}function K(e){return e}class J extends M.default{constructor(e){super(),e=e||{},$||(i=[255,255,255,1],Z=new T.default({color:i}),a=[20,2],n="pixels",o="pixels",l=[64,64],u="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",V=new C.default({anchor:a,anchorOrigin:"bottom-left",anchorXUnits:n,anchorYUnits:o,crossOrigin:"anonymous",rotation:0,scale:X(l),size:l,src:u}),h="NO_IMAGE",Y=new P.default({color:i,width:1}),c=new P.default({color:[51,51,51,1],width:2}),W=new I.default({font:"bold 16px Helvetica",fill:Z,stroke:c,scale:.8}),$=[new R.default({fill:Z,image:V,text:W,stroke:Y,zIndex:0})]),this.dataProjection=(0,A.get)("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:$,this.extractStyles_=void 0===e.extractStyles||e.extractStyles,this.writeStyles_=void 0===e.writeStyles||e.writeStyles,this.sharedStyles_={},this.showPointNames_=void 0===e.showPointNames||e.showPointNames,this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:K,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){let r=(0,L.makeStructureNS)(D,{Document:(0,L.makeArrayExtender)(this.readDocumentOrFolder_,this),Folder:(0,L.makeArrayExtender)(this.readDocumentOrFolder_,this),Placemark:(0,L.makeArrayPusher)(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=(0,L.pushParseAndPop)([],r,e,t,this);if(i)return i}readPlacemark_(e,t){let r=(0,L.pushParseAndPop)({geometry:null},G,e,t,this);if(!r)return;let i=new p.default,a=e.getAttribute("id");null!==a&&i.setId(a);let s=t[0],n=r.geometry;if(n&&(0,O.transformGeometryWithOptions)(n,!1,s),i.setGeometry(n),delete r.geometry,this.extractStyles_){var o,l,u,h,f;let e=(o=r.Style,l=r.styleUrl,u=this.defaultStyle_,h=this.sharedStyles_,f=this.showPointNames_,function(e,t){let r=f,i="",a=[];if(r){let t=e.getGeometry();if(t){if(t instanceof y.default)r=(a=t.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"Point"===t||"MultiPoint"===t})).length>0;else{let e=t.getType();r="Point"===e||"MultiPoint"===e}}}r&&(i=e.get("name"),(r=r&&!!i)&&/&[^&]+;/.test(i)&&(d||(d=document.createElement("textarea")),d.innerHTML=i,i=d.value));let s=u;if(o?s=o:l&&(s=function e(t,r,i){return Array.isArray(t)?t:"string"==typeof t?e(i[t],r,i):r}(l,u,h)),r){let e=function(e,t){let r=[0,0],i="start",a=e.getImage();if(a){let e=a.getSize();if(e&&2==e.length){let t=a.getScaleArray(),s=a.getAnchor();r[0]=t[0]*(e[0]-s[0]),r[1]=t[1]*(e[1]/2-s[1]),i="left"}}let s=e.getText();return s?((s=s.clone()).setFont(s.getFont()||W.getFont()),s.setScale(s.getScale()||W.getScale()),s.setFill(s.getFill()||W.getFill()),s.setStroke(s.getStroke()||c)):s=W.clone(),s.setText(t),s.setOffsetX(r[0]),s.setOffsetY(r[1]),s.setTextAlign(i),new R.default({image:a,text:s})}(s[0],i);return a.length>0?(e.setGeometry(new y.default(a)),[e,new R.default({geometry:s[0].getGeometry(),image:null,fill:s[0].getFill(),stroke:s[0].getStroke(),text:null})].concat(s.slice(1))):e}return s});i.setStyle(e)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){let r=e.getAttribute("id");if(null!==r){let i=eC.call(this,e,t);if(i){let t;let a=e.baseURI;a&&"about:blank"!=a||(a=window.location.href),t=a?new URL("#"+r,a).href:"#"+r,this.sharedStyles_[t]=i}}}readSharedStyleMap_(e,t){let r;let i=e.getAttribute("id");if(null===i)return;let a=es.call(this,e,t);if(!a)return;let s=e.baseURI;s&&"about:blank"!=s||(s=window.location.href),r=s?new URL("#"+i,s).href:"#"+i,this.sharedStyles_[r]=a}readFeatureFromNode(e,t){return D.includes(e.namespaceURI)&&this.readPlacemark_(e,[this.getReadOptions(e,t)])||null}readFeaturesFromNode(e,t){let r;if(!D.includes(e.namespaceURI))return[];let i=e.localName;if("Document"==i||"Folder"==i)return(r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]))?r:[];if("Placemark"==i){let r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r?[r]:[]}if("kml"==i){r=[];for(let i=e.firstElementChild;i;i=i.nextElementSibling){let e=this.readFeaturesFromNode(i,t);e&&(0,m.extend)(r,e)}return r}return[]}readName(e){if(e){if("string"==typeof e){let t=(0,L.parse)(e);return this.readNameFromDocument(t)}return(0,L.isDocument)(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){let e=this.readNameFromNode(t);if(e)return e}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(D.includes(t.namespaceURI)&&"name"==t.localName)return(0,k.readString)(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){let e=t.localName;if(D.includes(t.namespaceURI)&&("Document"==e||"Folder"==e||"Placemark"==e||"kml"==e)){let e=this.readNameFromNode(t);if(e)return e}}}readNetworkLinks(e){let t=[];if("string"==typeof e){let r=(0,L.parse)(e);(0,m.extend)(t,this.readNetworkLinksFromDocument(r))}else(0,L.isDocument)(e)?(0,m.extend)(t,this.readNetworkLinksFromDocument(e)):(0,m.extend)(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){let t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,m.extend)(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){let t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(D.includes(r.namespaceURI)&&"NetworkLink"==r.localName){let e=(0,L.pushParseAndPop)({},z,r,[]);t.push(e)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){let e=r.localName;D.includes(r.namespaceURI)&&("Document"==e||"Folder"==e||"kml"==e)&&(0,m.extend)(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){let t=[];if("string"==typeof e){let r=(0,L.parse)(e);(0,m.extend)(t,this.readRegionFromDocument(r))}else(0,L.isDocument)(e)?(0,m.extend)(t,this.readRegionFromDocument(e)):(0,m.extend)(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){let t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,m.extend)(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){let t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(D.includes(r.namespaceURI)&&"Region"==r.localName){let e=(0,L.pushParseAndPop)({},B,r,[]);t.push(e)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){let e=r.localName;D.includes(r.namespaceURI)&&("Document"==e||"Folder"==e||"kml"==e)&&(0,m.extend)(t,this.readRegionFromNode(r))}return t}readCamera(e){let t=[];if("string"==typeof e){let r=(0,L.parse)(e);(0,m.extend)(t,this.readCameraFromDocument(r))}else(0,L.isDocument)(e)?(0,m.extend)(t,this.readCameraFromDocument(e)):(0,m.extend)(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){let t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&(0,m.extend)(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){let t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(D.includes(r.namespaceURI)&&"Camera"===r.localName){let e=(0,L.pushParseAndPop)({},j,r,[]);t.push(e)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){let e=r.localName;D.includes(r.namespaceURI)&&("Document"===e||"Folder"===e||"Placemark"===e||"kml"===e)&&(0,m.extend)(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);let r=(0,L.createElementNS)(D[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",N[0]),r.setAttributeNS(i,"xmlns:xsi",L.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(L.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");let a={};e.length>1?a.Document=e:1==e.length&&(a.Placemark=e[0]);let s=U[r.namespaceURI],n=(0,L.makeSequence)(a,s);return(0,L.pushSerializeAndPop)({node:r},H,L.OBJECT_PROPERTY_NODE_FACTORY,n,[t],s,this),r}}function Q(e){let t=(0,L.getAllTextContent)(e,!1),r=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(r){let e=r[1];return[parseInt(e.substr(6,2),16),parseInt(e.substr(4,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(0,2),16)/255]}}function ee(e){let t,r=(0,L.getAllTextContent)(e,!1),i=[];r=r.replace(/\s*,\s*/g,",");let a=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;for(;t=a.exec(r);){let e=parseFloat(t[1]),a=parseFloat(t[2]),s=t[3]?parseFloat(t[3]):0;i.push(e,a,s),r=r.substr(t[0].length)}if(""===r)return i}function et(e){let t=(0,L.getAllTextContent)(e,!1).trim(),r=e.baseURI;return(r&&"about:blank"!=r||(r=window.location.href),r)?new URL(t,r).href:t}function er(e){let t=(0,L.getAllTextContent)(e,!1).trim().replace(/^(?!.*#)/,"#"),r=e.baseURI;return(r&&"about:blank"!=r||(r=window.location.href),r)?new URL(t,r).href:t}function ei(e){return(0,k.readDecimal)(e)}let ea=(0,L.makeStructureNS)(D,{Pair:function(e,t){let r=(0,L.pushParseAndPop)({},eM,e,t,this);if(!r)return;let i=r.key;if(i&&"normal"==i){let e=r.styleUrl;e&&(t[t.length-1]=e);let i=r.Style;i&&(t[t.length-1]=i)}}});function es(e,t){return(0,L.pushParseAndPop)(void 0,ea,e,t,this)}let en=(0,L.makeStructureNS)(D,{Icon:(0,L.makeObjectPropertySetter)(function(e,t){return(0,L.pushParseAndPop)({},em,e,t)||null}),color:(0,L.makeObjectPropertySetter)(Q),heading:(0,L.makeObjectPropertySetter)(k.readDecimal),hotSpot:(0,L.makeObjectPropertySetter)(function(e){let t=e.getAttribute("xunits"),r=e.getAttribute("yunits");return{x:parseFloat(e.getAttribute("x")),xunits:F[t],y:parseFloat(e.getAttribute("y")),yunits:F[r],origin:"insetPixels"!==t?"insetPixels"!==r?"bottom-left":"top-left":"insetPixels"!==r?"bottom-right":"top-right"}}),scale:(0,L.makeObjectPropertySetter)(ei)}),eo=(0,L.makeStructureNS)(D,{color:(0,L.makeObjectPropertySetter)(Q),scale:(0,L.makeObjectPropertySetter)(ei)}),el=(0,L.makeStructureNS)(D,{color:(0,L.makeObjectPropertySetter)(Q),width:(0,L.makeObjectPropertySetter)(k.readDecimal)}),eu=(0,L.makeStructureNS)(D,{color:(0,L.makeObjectPropertySetter)(Q),fill:(0,L.makeObjectPropertySetter)(k.readBoolean),outline:(0,L.makeObjectPropertySetter)(k.readBoolean)}),eh=(0,L.makeStructureNS)(D,{coordinates:(0,L.makeReplacer)(ee)});function ec(e,t){return(0,L.pushParseAndPop)(null,eh,e,t)}let ed=(0,L.makeStructureNS)(N,{Track:(0,L.makeArrayPusher)(ef)}),ep=(0,L.makeStructureNS)(D,{when:function(e,t){let r=t[t.length-1].whens,i=Date.parse((0,L.getAllTextContent)(e,!1));r.push(isNaN(i)?0:i)}},(0,L.makeStructureNS)(N,{coord:function(e,t){let r=t[t.length-1].coordinates,i=(0,L.getAllTextContent)(e,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){let e=parseFloat(a[1]),t=parseFloat(a[2]),i=parseFloat(a[3]);r.push([e,t,i])}else r.push([])}}));function ef(e,t){let r=(0,L.pushParseAndPop)({coordinates:[],whens:[]},ep,e,t);if(!r)return;let i=[],a=r.coordinates,s=r.whens;for(let e=0,t=Math.min(a.length,s.length);e<t;++e)3==a[e].length&&i.push(a[e][0],a[e][1],a[e][2],s[e]);return new v.default(i,"XYZM")}let em=(0,L.makeStructureNS)(D,{href:(0,L.makeObjectPropertySetter)(et)},(0,L.makeStructureNS)(N,{x:(0,L.makeObjectPropertySetter)(k.readDecimal),y:(0,L.makeObjectPropertySetter)(k.readDecimal),w:(0,L.makeObjectPropertySetter)(k.readDecimal),h:(0,L.makeObjectPropertySetter)(k.readDecimal)})),eg=(0,L.makeStructureNS)(D,{coordinates:(0,L.makeReplacer)(ee)});function ey(e,t){return(0,L.pushParseAndPop)(null,eg,e,t)}let ev=(0,L.makeStructureNS)(D,{extrude:(0,L.makeObjectPropertySetter)(k.readBoolean),tessellate:(0,L.makeObjectPropertySetter)(k.readBoolean),altitudeMode:(0,L.makeObjectPropertySetter)(k.readString)});function e_(e,t){let r=(0,L.pushParseAndPop)({},ev,e,t),i=ey(e,t);if(i){let e=new v.default(i,"XYZ");return e.setProperties(r,!0),e}}function ex(e,t){let r=(0,L.pushParseAndPop)({},ev,e,t),i=ey(e,t);if(i){let e=new w.default(i,"XYZ",[i.length]);return e.setProperties(r,!0),e}}let eb=(0,L.makeStructureNS)(D,{LineString:(0,L.makeArrayPusher)(e_),LinearRing:(0,L.makeArrayPusher)(ex),MultiGeometry:(0,L.makeArrayPusher)(eS),Point:(0,L.makeArrayPusher)(ew),Polygon:(0,L.makeArrayPusher)(eA)});function eS(e,t){let r,i;let a=(0,L.pushParseAndPop)([],eb,e,t);if(!a)return null;if(0===a.length)return new y.default(a);let s=!0,n=a[0].getType();for(let e=1,t=a.length;e<t;++e)if((i=a[e]).getType()!=n){s=!1;break}if(s){let e,t;if("Point"==n){let s=a[0];e=s.getLayout(),t=s.getFlatCoordinates();for(let e=1,r=a.length;e<r;++e)i=a[e],(0,m.extend)(t,i.getFlatCoordinates());eP(r=new x.default(t,e),a)}else if("LineString"==n)eP(r=new _.default(a),a);else if("Polygon"==n)eP(r=new b.default(a),a);else if("GeometryCollection"==n||n.startsWith("Multi"))r=new y.default(a);else throw Error("Unknown geometry type found")}else r=new y.default(a);return r}function ew(e,t){let r=(0,L.pushParseAndPop)({},ev,e,t),i=ey(e,t);if(i){let e=new S.default(i,"XYZ");return e.setProperties(r,!0),e}}let eE=(0,L.makeStructureNS)(D,{innerBoundaryIs:function(e,t){let r=(0,L.pushParseAndPop)([],eF,e,t);r.length>0&&t[t.length-1].push(...r)},outerBoundaryIs:function(e,t){let r=(0,L.pushParseAndPop)(void 0,eG,e,t);r&&(t[t.length-1][0]=r)}});function eA(e,t){let r=(0,L.pushParseAndPop)({},ev,e,t),i=(0,L.pushParseAndPop)([null],eE,e,t);if(i&&i[0]){let e=i[0],t=[e.length];for(let r=1,a=i.length;r<a;++r)(0,m.extend)(e,i[r]),t.push(e.length);let a=new w.default(e,"XYZ",t);return a.setProperties(r,!0),a}}let eT=(0,L.makeStructureNS)(D,{IconStyle:function(e,t){let r,i,s,c,d,p,m;let g=(0,L.pushParseAndPop)({},en,e,t);if(!g)return;let y=t[t.length-1],v="Icon"in g?g.Icon:{},_=!("Icon"in g)||Object.keys(v).length>0,x=v.href;x?r=x:_&&(r=u);let b="bottom-left",S=g.hotSpot;S?(i=[S.x,S.y],s=S.xunits,c=S.yunits,b=S.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(r)&&(r.includes("pushpin")?(i=a,s=n,c=o):r.includes("arrow-reverse")?(i=[54,42],s=n,c=o):r.includes("paddle")&&(i=[32,1],s=n,c=o));let w=v.x,A=v.y;void 0!==w&&void 0!==A&&(d=[w,A]);let T=v.w,P=v.h;void 0!==T&&void 0!==P&&(p=[T,P]);let R=g.heading;void 0!==R&&(m=(0,E.toRadians)(R));let I=g.scale,O=g.color;if(_){r==u&&(p=l);let e=new C.default({anchor:i,anchorOrigin:b,anchorXUnits:s,anchorYUnits:c,crossOrigin:this.crossOrigin_,offset:d,offsetOrigin:"bottom-left",rotation:m,scale:I,size:p,src:this.iconUrlFunction_(r),color:O}),t=e.getScaleArray()[0],a=e.getSize();if(null===a){let r=e.getImageState();if(r===f.default.IDLE||r===f.default.LOADING){let i=function(){let r=e.getImageState();if(!(r===f.default.IDLE||r===f.default.LOADING)){let r=e.getSize();if(r&&2==r.length){let i=X(r);e.setScale(t*i)}e.unlistenImageChange(i)}};e.listenImageChange(i),r===f.default.IDLE&&e.load()}}else if(2==a.length){let r=X(a);e.setScale(t*r)}y.imageStyle=e}else y.imageStyle=h},LabelStyle:function(e,t){let r=(0,L.pushParseAndPop)({},eo,e,t);if(!r)return;let a=t[t.length-1],s=new I.default({fill:new T.default({color:"color"in r?r.color:i}),scale:r.scale});a.textStyle=s},LineStyle:function(e,t){let r=(0,L.pushParseAndPop)({},el,e,t);if(!r)return;let a=t[t.length-1],s=new P.default({color:"color"in r?r.color:i,width:"width"in r?r.width:1});a.strokeStyle=s},PolyStyle:function(e,t){let r=(0,L.pushParseAndPop)({},eu,e,t);if(!r)return;let a=t[t.length-1],s=new T.default({color:"color"in r?r.color:i});a.fillStyle=s;let n=r.fill;void 0!==n&&(a.fill=n);let o=r.outline;void 0!==o&&(a.outline=o)}});function eC(e,t){let r;let i=(0,L.pushParseAndPop)({},eT,e,t,this);if(!i)return null;let a="fillStyle"in i?i.fillStyle:Z,s=i.fill;void 0===s||s||(a=null),"imageStyle"in i?i.imageStyle!=h&&(r=i.imageStyle):r=V;let n="textStyle"in i?i.textStyle:W,o="strokeStyle"in i?i.strokeStyle:Y,l=i.outline;return void 0===l||l?[new R.default({fill:a,image:r,stroke:o,text:n,zIndex:void 0})]:[new R.default({geometry:function(e){let t=e.getGeometry(),r=t.getType();return"GeometryCollection"===r?new y.default(t.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"Polygon"!==t&&"MultiPolygon"!==t})):"Polygon"!==r&&"MultiPolygon"!==r?t:void 0},fill:a,image:r,stroke:o,text:n,zIndex:void 0}),new R.default({geometry:function(e){let t=e.getGeometry(),r=t.getType();return"GeometryCollection"===r?new y.default(t.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"Polygon"===t||"MultiPolygon"===t})):"Polygon"===r||"MultiPolygon"===r?t:void 0},fill:a,stroke:null,zIndex:void 0})]}function eP(e,t){let r,i,a;let s=t.length,n=Array(t.length),o=Array(t.length),l=Array(t.length);r=!1,i=!1,a=!1;for(let e=0;e<s;++e){let s=t[e];n[e]=s.get("extrude"),o[e]=s.get("tessellate"),l[e]=s.get("altitudeMode"),r=r||void 0!==n[e],i=i||void 0!==o[e],a=a||l[e]}r&&e.set("extrude",n),i&&e.set("tessellate",o),a&&e.set("altitudeMode",l)}let eR=(0,L.makeStructureNS)(D,{displayName:(0,L.makeObjectPropertySetter)(k.readString),value:(0,L.makeObjectPropertySetter)(k.readString)}),eI=(0,L.makeStructureNS)(D,{Data:function(e,t){let r=e.getAttribute("name");(0,L.parseNode)(eR,e,t);let i=t[t.length-1];r&&i.displayName?i[r]={value:i.value,displayName:i.displayName,toString:function(){return i.value}}:null!==r?i[r]=i.value:null!==i.displayName&&(i[i.displayName]=i.value),delete i.value},SchemaData:function(e,t){(0,L.parseNode)(ek,e,t)}});function eL(e,t){(0,L.parseNode)(eI,e,t)}function eO(e,t){(0,L.parseNode)(B,e,t)}let eM=(0,L.makeStructureNS)(D,{Style:(0,L.makeObjectPropertySetter)(eC),key:(0,L.makeObjectPropertySetter)(k.readString),styleUrl:(0,L.makeObjectPropertySetter)(er)}),ek=(0,L.makeStructureNS)(D,{SimpleData:function(e,t){let r=e.getAttribute("name");if(null!==r){let i=(0,k.readString)(e);t[t.length-1][r]=i}}}),eN=(0,L.makeStructureNS)(D,{altitudeMode:(0,L.makeObjectPropertySetter)(k.readString),minAltitude:(0,L.makeObjectPropertySetter)(k.readDecimal),maxAltitude:(0,L.makeObjectPropertySetter)(k.readDecimal),north:(0,L.makeObjectPropertySetter)(k.readDecimal),south:(0,L.makeObjectPropertySetter)(k.readDecimal),east:(0,L.makeObjectPropertySetter)(k.readDecimal),west:(0,L.makeObjectPropertySetter)(k.readDecimal)}),eD=(0,L.makeStructureNS)(D,{minLodPixels:(0,L.makeObjectPropertySetter)(k.readDecimal),maxLodPixels:(0,L.makeObjectPropertySetter)(k.readDecimal),minFadeExtent:(0,L.makeObjectPropertySetter)(k.readDecimal),maxFadeExtent:(0,L.makeObjectPropertySetter)(k.readDecimal)}),eF=(0,L.makeStructureNS)(D,{LinearRing:(0,L.makeArrayPusher)(ec)}),eG=(0,L.makeStructureNS)(D,{LinearRing:(0,L.makeReplacer)(ec)});function ez(e,t){let r=(0,g.asArray)(t),i=[255*(4==r.length?r[3]:1),r[2],r[1],r[0]];for(let e=0;e<4;++e){let t=Math.floor(i[e]).toString(16);i[e]=1==t.length?"0"+t:t}(0,k.writeStringTextNode)(e,i.join(""))}let eq=(0,L.makeStructureNS)(D,{Data:(0,L.makeChildAppender)(function(e,t,r){e.setAttribute("name",t.name);let i={node:e},a=t.value;"object"==typeof a?(null!==a&&a.displayName&&(0,L.pushSerializeAndPop)(i,eq,L.OBJECT_PROPERTY_NODE_FACTORY,[a.displayName],r,["displayName"]),null!==a&&a.value&&(0,L.pushSerializeAndPop)(i,eq,L.OBJECT_PROPERTY_NODE_FACTORY,[a.value],r,["value"])):(0,L.pushSerializeAndPop)(i,eq,L.OBJECT_PROPERTY_NODE_FACTORY,[a],r,["value"])}),value:(0,L.makeChildAppender)(function(e,t){(0,k.writeStringTextNode)(e,t)}),displayName:(0,L.makeChildAppender)(function(e,t){(0,k.writeCDATASection)(e,t)})}),ej=(0,L.makeStructureNS)(D,{Placemark:(0,L.makeChildAppender)(tr)}),eB=function(e,t,r){let i=t[t.length-1].node;return(0,L.createElementNS)(i.namespaceURI,"Placemark")},eU=(0,L.makeSimpleNodeFactory)("Data"),eH=(0,L.makeStructureNS)(D,["href"],(0,L.makeStructureNS)(N,["x","y","w","h"])),eZ=(0,L.makeStructureNS)(D,{href:(0,L.makeChildAppender)(k.writeStringTextNode)},(0,L.makeStructureNS)(N,{x:(0,L.makeChildAppender)(k.writeDecimalTextNode),y:(0,L.makeChildAppender)(k.writeDecimalTextNode),w:(0,L.makeChildAppender)(k.writeDecimalTextNode),h:(0,L.makeChildAppender)(k.writeDecimalTextNode)})),eV=function(e,t,r){return(0,L.createElementNS)(N[0],"gx:"+r)},eY=(0,L.makeStructureNS)(D,["scale","heading","Icon","color","hotSpot"]),eW=(0,L.makeStructureNS)(D,{Icon:(0,L.makeChildAppender)(function(e,t,r){let i={node:e},a=eH[r[r.length-1].node.namespaceURI],s=(0,L.makeSequence)(t,a);(0,L.pushSerializeAndPop)(i,eZ,L.OBJECT_PROPERTY_NODE_FACTORY,s,r,a),a=eH[N[0]],s=(0,L.makeSequence)(t,a),(0,L.pushSerializeAndPop)(i,eZ,eV,s,r,a)}),color:(0,L.makeChildAppender)(ez),heading:(0,L.makeChildAppender)(k.writeDecimalTextNode),hotSpot:(0,L.makeChildAppender)(function(e,t){e.setAttribute("x",String(t.x)),e.setAttribute("y",String(t.y)),e.setAttribute("xunits",t.xunits),e.setAttribute("yunits",t.yunits)}),scale:(0,L.makeChildAppender)(td)}),e$=(0,L.makeStructureNS)(D,["color","scale"]),eX=(0,L.makeStructureNS)(D,{color:(0,L.makeChildAppender)(ez),scale:(0,L.makeChildAppender)(td)}),eK=(0,L.makeStructureNS)(D,["color","width"]),eJ=(0,L.makeStructureNS)(D,{color:(0,L.makeChildAppender)(ez),width:(0,L.makeChildAppender)(k.writeDecimalTextNode)}),eQ={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},e0=function(e,t,r){if(e){let r=t[t.length-1].node;return(0,L.createElementNS)(r.namespaceURI,eQ[e.getType()])}},e1=(0,L.makeSimpleNodeFactory)("Point"),e2=(0,L.makeSimpleNodeFactory)("LineString"),e5=(0,L.makeSimpleNodeFactory)("LinearRing"),e3=(0,L.makeSimpleNodeFactory)("Polygon"),e4=(0,L.makeStructureNS)(D,{LineString:(0,L.makeChildAppender)(ts),Point:(0,L.makeChildAppender)(ts),Polygon:(0,L.makeChildAppender)(th),GeometryCollection:(0,L.makeChildAppender)(e6)});function e6(e,t,r){let i;let a=t.getType(),s=[];if("GeometryCollection"===a)t.getGeometriesArrayRecursive().forEach(function(e){let t=e.getType();if("MultiPoint"===t)s=s.concat(e.getPoints());else if("MultiLineString"===t)s=s.concat(e.getLineStrings());else if("MultiPolygon"===t)s=s.concat(e.getPolygons());else if("Point"===t||"LineString"===t||"Polygon"===t)s.push(e);else throw Error("Unknown geometry type")}),i=e0;else if("MultiPoint"===a)s=t.getPoints(),i=e1;else if("MultiLineString"===a)s=t.getLineStrings(),i=e2;else if("MultiPolygon"===a)s=t.getPolygons(),i=e3;else throw Error("Unknown geometry type");(0,L.pushSerializeAndPop)({node:e},e4,i,s,r)}let e8=(0,L.makeStructureNS)(D,{LinearRing:(0,L.makeChildAppender)(ts)});function e7(e,t,r){(0,L.pushSerializeAndPop)({node:e},e8,e5,[t],r)}let e9=(0,L.makeStructureNS)(D,{ExtendedData:(0,L.makeChildAppender)(function(e,t,r){let i={node:e},a=t.names,s=t.values,n=a.length;for(let e=0;e<n;e++)(0,L.pushSerializeAndPop)(i,eq,eU,[{name:a[e],value:s[e]}],r)}),MultiGeometry:(0,L.makeChildAppender)(e6),LineString:(0,L.makeChildAppender)(ts),LinearRing:(0,L.makeChildAppender)(ts),Point:(0,L.makeChildAppender)(ts),Polygon:(0,L.makeChildAppender)(th),Style:(0,L.makeChildAppender)(function(e,t,r){let i={};if(t.pointStyles.length){let e=t.pointStyles[0].getText();e&&(i.LabelStyle=e);let r=t.pointStyles[0].getImage();r&&"function"==typeof r.getSrc&&(i.IconStyle=r)}if(t.lineStyles.length){let e=t.lineStyles[0].getStroke();e&&(i.LineStyle=e)}if(t.polyStyles.length){let e=t.polyStyles[0].getStroke();e&&!i.LineStyle&&(i.LineStyle=e),i.PolyStyle=t.polyStyles[0]}let a=tp[r[r.length-1].node.namespaceURI],s=(0,L.makeSequence)(i,a);(0,L.pushSerializeAndPop)({node:e},tf,L.OBJECT_PROPERTY_NODE_FACTORY,s,r,a)}),address:(0,L.makeChildAppender)(k.writeStringTextNode),description:(0,L.makeChildAppender)(k.writeStringTextNode),name:(0,L.makeChildAppender)(k.writeStringTextNode),open:(0,L.makeChildAppender)(k.writeBooleanTextNode),phoneNumber:(0,L.makeChildAppender)(k.writeStringTextNode),styleUrl:(0,L.makeChildAppender)(k.writeStringTextNode),visibility:(0,L.makeChildAppender)(k.writeBooleanTextNode)}),te=(0,L.makeStructureNS)(D,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),tt=(0,L.makeSimpleNodeFactory)("ExtendedData");function tr(e,t,r){let i={node:e};t.getId()&&e.setAttribute("id",t.getId());let a=t.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[t.getGeometryName()]=1;let n=Object.keys(a||{}).sort().filter(function(e){return!s[e]}),o=t.getStyleFunction();if(o){let e=o(t,0);if(e){let r=Array.isArray(e)?e:[e],i=r;if(t.getGeometry()&&(i=r.filter(function(e){let r=e.getGeometryFunction()(t);if(r){let e=r.getType();return"GeometryCollection"===e?r.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"Point"===t||"MultiPoint"===t}).length:"Point"===e||"MultiPoint"===e}})),this.writeStyles_){let e=r,s=r;t.getGeometry()&&(e=r.filter(function(e){let r=e.getGeometryFunction()(t);if(r){let e=r.getType();return"GeometryCollection"===e?r.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"LineString"===t||"MultiLineString"===t}).length:"LineString"===e||"MultiLineString"===e}}),s=r.filter(function(e){let r=e.getGeometryFunction()(t);if(r){let e=r.getType();return"GeometryCollection"===e?r.getGeometriesArrayRecursive().filter(function(e){let t=e.getType();return"Polygon"===t||"MultiPolygon"===t}).length:"Polygon"===e||"MultiPolygon"===e}})),a.Style={pointStyles:i,lineStyles:e,polyStyles:s}}if(i.length&&void 0===a.name){let e=i[0].getText();e&&(a.name=e.getText())}}}let l=te[r[r.length-1].node.namespaceURI],u=(0,L.makeSequence)(a,l);if((0,L.pushSerializeAndPop)(i,e9,L.OBJECT_PROPERTY_NODE_FACTORY,u,r,l),n.length>0){let e=(0,L.makeSequence)(a,n);(0,L.pushSerializeAndPop)(i,e9,tt,[{names:n,values:e}],r)}let h=r[0],c=t.getGeometry();c&&(c=(0,O.transformGeometryWithOptions)(c,!0,h)),(0,L.pushSerializeAndPop)(i,e9,e0,[c],r)}let ti=(0,L.makeStructureNS)(D,["extrude","tessellate","altitudeMode","coordinates"]),ta=(0,L.makeStructureNS)(D,{extrude:(0,L.makeChildAppender)(k.writeBooleanTextNode),tessellate:(0,L.makeChildAppender)(k.writeBooleanTextNode),altitudeMode:(0,L.makeChildAppender)(k.writeStringTextNode),coordinates:(0,L.makeChildAppender)(function(e,t,r){let i;let a=r[r.length-1],s=a.layout,n=a.stride;if("XY"==s||"XYM"==s)i=2;else if("XYZ"==s||"XYZM"==s)i=3;else throw Error("Invalid geometry layout");let o=t.length,l="";if(o>0){l+=t[0];for(let e=1;e<i;++e)l+=","+t[e];for(let e=n;e<o;e+=n){l+=" "+t[e];for(let r=1;r<i;++r)l+=","+t[e+r]}}(0,k.writeStringTextNode)(e,l)})});function ts(e,t,r){let i=t.getFlatCoordinates(),a={node:e};a.layout=t.getLayout(),a.stride=t.getStride();let s=t.getProperties();s.coordinates=i;let n=ti[r[r.length-1].node.namespaceURI],o=(0,L.makeSequence)(s,n);(0,L.pushSerializeAndPop)(a,ta,L.OBJECT_PROPERTY_NODE_FACTORY,o,r,n)}let tn=(0,L.makeStructureNS)(D,["color","fill","outline"]),to=(0,L.makeStructureNS)(D,{outerBoundaryIs:(0,L.makeChildAppender)(e7),innerBoundaryIs:(0,L.makeChildAppender)(e7)}),tl=(0,L.makeSimpleNodeFactory)("innerBoundaryIs"),tu=(0,L.makeSimpleNodeFactory)("outerBoundaryIs");function th(e,t,r){let i=t.getLinearRings(),a=i.shift(),s={node:e};(0,L.pushSerializeAndPop)(s,to,tl,i,r),(0,L.pushSerializeAndPop)(s,to,tu,[a],r)}let tc=(0,L.makeStructureNS)(D,{color:(0,L.makeChildAppender)(ez),fill:(0,L.makeChildAppender)(k.writeBooleanTextNode),outline:(0,L.makeChildAppender)(k.writeBooleanTextNode)});function td(e,t){(0,k.writeDecimalTextNode)(e,Math.round(1e6*t)/1e6)}let tp=(0,L.makeStructureNS)(D,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),tf=(0,L.makeStructureNS)(D,{IconStyle:(0,L.makeChildAppender)(function(e,t,r){let i={},a=t.getSrc(),s=t.getSize(),n=t.getImageSize(),o={href:a};if(s){o.w=s[0],o.h=s[1];let e=t.getAnchor(),r=t.getOrigin();if(r&&n&&0!==r[0]&&r[1]!==s[1]&&(o.x=r[0],o.y=n[1]-(r[1]+s[1])),e&&(e[0]!==s[0]/2||e[1]!==s[1]/2)){let t={x:e[0],xunits:"pixels",y:s[1]-e[1],yunits:"pixels"};i.hotSpot=t}}i.Icon=o;let u=t.getScaleArray()[0],h=s;null===h&&(h=l),2==h.length&&(u/=X(h)),1!==u&&(i.scale=u);let c=t.getRotation();0!==c&&(i.heading=c);let d=t.getColor();d&&(i.color=d);let p=eY[r[r.length-1].node.namespaceURI],f=(0,L.makeSequence)(i,p);(0,L.pushSerializeAndPop)({node:e},eW,L.OBJECT_PROPERTY_NODE_FACTORY,f,r,p)}),LabelStyle:(0,L.makeChildAppender)(function(e,t,r){let i={},a=t.getFill();a&&(i.color=a.getColor());let s=t.getScale();s&&1!==s&&(i.scale=s);let n=e$[r[r.length-1].node.namespaceURI],o=(0,L.makeSequence)(i,n);(0,L.pushSerializeAndPop)({node:e},eX,L.OBJECT_PROPERTY_NODE_FACTORY,o,r,n)}),LineStyle:(0,L.makeChildAppender)(function(e,t,r){let i={color:t.getColor(),width:Number(t.getWidth())||1},a=eK[r[r.length-1].node.namespaceURI],s=(0,L.makeSequence)(i,a);(0,L.pushSerializeAndPop)({node:e},eJ,L.OBJECT_PROPERTY_NODE_FACTORY,s,r,a)}),PolyStyle:(0,L.makeChildAppender)(function(e,t,r){let i=t.getFill(),a=t.getStroke(),s={color:i?i.getColor():void 0,fill:!!i&&void 0,outline:!!a&&void 0},n=tn[r[r.length-1].node.namespaceURI],o=(0,L.makeSequence)(s,n);(0,L.pushSerializeAndPop)({node:e},tc,L.OBJECT_PROPERTY_NODE_FACTORY,o,r,n)})});var tm=J}),n("6b5au",function(e,r){t(e.exports,"default",()=>_);var i=s("iGyOD"),a=s("hvEnP"),n=s("7TB1l"),o=s("ljDIj"),l=s("dEQmT"),u=s("j2K3b"),h=s("cgPpQ"),c=s("gzr8q"),d=s("9z1G1"),p=s("k8QYM");class f extends p.default{constructor(e){super(),e=e||{},this.layerName_=e.layerName,this.layers_=e.layers?e.layers:null,this.dataProjection=(0,c.get)(e.dataProjection?e.dataProjection:"EPSG:4326")}readFeaturesFromObject(e,t){if("Topology"==e.type){let r;let i,a=null,s=null;e.transform&&(a=(i=e.transform).scale,s=i.translate);let n=e.arcs;i&&function(e,t,r){for(let i=0,a=e.length;i<a;++i)(function(e,t,r){let i=0,a=0;for(let s=0,n=e.length;s<n;++s){let n=e[s];i+=n[0],a+=n[1],n[0]=i,n[1]=a,v(n,t,r)}})(e[i],t,r)}(n,a,s);let o=[],l=e.objects,u=this.layerName_;for(let e in l)(!this.layers_||this.layers_.includes(e))&&("GeometryCollection"===l[e].type?(r=l[e],o.push.apply(o,function(e,t,r,i,a,s,n){let o=e.geometries,l=[];for(let e=0,u=o.length;e<u;++e)l[e]=y(o[e],t,r,i,a,s,n);return l}(r,n,a,s,u,e,t))):(r=l[e],o.push(y(r,n,a,s,u,e,t))));return o}return[]}readProjectionFromObject(e){return this.dataProjection}}let m={Point:function(e,t,r){let i=e.coordinates;return t&&r&&v(i,t,r),new u.default(i)},LineString:function(e,t){let r=g(e.arcs,t);return new a.default(r)},Polygon:function(e,t){let r=[];for(let i=0,a=e.arcs.length;i<a;++i)r[i]=g(e.arcs[i],t);return new h.default(r)},MultiPoint:function(e,t,r){let i=e.coordinates;if(t&&r)for(let e=0,a=i.length;e<a;++e)v(i[e],t,r);return new o.default(i)},MultiLineString:function(e,t){let r=[];for(let i=0,a=e.arcs.length;i<a;++i)r[i]=g(e.arcs[i],t);return new n.default(r)},MultiPolygon:function(e,t){let r=[];for(let i=0,a=e.arcs.length;i<a;++i){let a=e.arcs[i],s=[];for(let e=0,r=a.length;e<r;++e)s[e]=g(a[e],t);r[i]=s}return new l.default(r)}};function g(e,t){let r;let i=[];for(let a=0,s=e.length;a<s;++a)if(r=e[a],a>0&&i.pop(),r>=0){let e=t[r];for(let t=0,r=e.length;t<r;++t)i.push(e[t].slice(0))}else{let e=t[~r];for(let t=e.length-1;t>=0;--t)i.push(e[t].slice(0))}return i}function y(e,t,r,a,s,n,o){let l=null,u=e.type;if(u){let i=m[u];l="Point"===u||"MultiPoint"===u?i(e,r,a):i(e,t),l=(0,d.transformGeometryWithOptions)(l,!1,o)}let h=new i.default({geometry:l});void 0!==e.id&&h.setId(e.id);let c=e.properties;return s&&(c||(c={}),c[s]=n),c&&h.setProperties(c,!0),h}function v(e,t,r){e[0]=e[0]*t[0]+r[0],e[1]=e[1]*t[1]+r[1]}var _=f}),n("29jcm",function(e,r){t(e.exports,"default",()=>l);var i=s("5mw1t"),a=s("kFndz"),n=s("j2K3b"),o=s("hvEnP"),l=class extends i.default{constructor(e){super(e=e||{}),this._lineFormat=new a.default({factor:Math.pow(10,e.decimals||6)})}encodeCoordinates(e){if("number"==typeof e[0])return t=new n.default(e),this._lineFormat.writeGeometry(t);if(!e.length||!e[0])return this.encodeCoordinates([0,0]);if("number"==typeof e[0][0])return t=new o.default(e),this._lineFormat.writeGeometry(t);for(var t,r=[],i=0;i<e.length;i++)r[i]=this.encodeCoordinates(e[i]);return r}decodeCoordinates(e){if("string"==typeof e)return(r=this._lineFormat.readGeometry(e)).getCoordinates()[0];if(!e.length)return null;var t,r,i="string"==typeof e[0],a=[];if(i)for(t=0;t<e.length;t++)r=this._lineFormat.readGeometry(e[t]),a[t]=r.getCoordinates();else for(t=0;t<e.length;t++)a[t]=this.decodeCoordinates(e[t]);return a}}}),n("kFndz",function(e,r){t(e.exports,"default",()=>p);var i=s("iGyOD"),a=s("hvEnP"),n=s("63y7W"),o=s("97NX0"),l=s("iTdJV"),u=s("gzr8q"),h=s("9z1G1"),c=s("jEnSw");class d extends c.default{constructor(e){super(),e=e||{},this.dataProjection=(0,u.get)("EPSG:4326"),this.factor_=e.factor?e.factor:1e5,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY"}readFeatureFromText(e,t){let r=this.readGeometryFromText(e,t);return new i.default(r)}readFeaturesFromText(e,t){return[this.readFeatureFromText(e,t)]}readGeometryFromText(e,t){let r=(0,n.getStrideForLayout)(this.geometryLayout_),i=function(e,t,r){let i;r=r||1e5;let a=Array(t);for(i=0;i<t;++i)a[i]=0;let s=function(e,t){t=t||1e5;let r=function(e){let t=function(e){let t=[],r=0,i=0;for(let a=0,s=e.length;a<s;++a){let s=e.charCodeAt(a)-63;r|=(31&s)<<i,s<32?(t.push(r),r=0,i=0):i+=5}return t}(e);for(let e=0,r=t.length;e<r;++e){let r=t[e];t[e]=1&r?~(r>>1):r>>1}return t}(e);for(let e=0,i=r.length;e<i;++e)r[e]/=t;return r}(e,r);for(let e=0,r=s.length;e<r;)for(i=0;i<t;++i,++e)a[i]+=s[e],s[e]=a[i];return s}(e,r,this.factor_);(0,o.flipXY)(i,0,i.length,r,i);let s=(0,l.inflateCoordinates)(i,0,i.length,r),u=new a.default(s,this.geometryLayout_);return(0,h.transformGeometryWithOptions)(u,!1,this.adaptOptions(t))}writeFeatureText(e,t){let r=e.getGeometry();if(r)return this.writeGeometryText(r,t);throw Error("Expected `feature` to have a geometry")}writeFeaturesText(e,t){return this.writeFeatureText(e[0],t)}writeGeometryText(e,t){let r=(e=(0,h.transformGeometryWithOptions)(e,!0,this.adaptOptions(t))).getFlatCoordinates(),i=e.getStride();return(0,o.flipXY)(r,0,r.length,i,r),function(e,t,r){let i;r=r||1e5;let a=Array(t);for(i=0;i<t;++i)a[i]=0;for(let r=0,s=e.length;r<s;)for(i=0;i<t;++i,++r){let t=e[r],s=t-a[i];a[i]=t,e[r]=s}return function(e,t){t=t||1e5;for(let r=0,i=e.length;r<i;++r)e[r]=Math.round(e[r]*t);return function(e){for(let t=0,r=e.length;t<r;++t){let r=e[t];e[t]=r<0?~(r<<1):r<<1}return function(e){let t="";for(let r=0,i=e.length;r<i;++r)t+=function(e){let t="";for(;e>=32;)t+=String.fromCharCode((32|31&e)+63),e>>=5;return t+String.fromCharCode(e+63)}(e[r]);return t}(e)}(e)}(e,r)}(r,i,this.factor_)}}var p=d}),n("97NX0",function(e,r){t(e.exports,"flipXY",()=>i);function i(e,t,r,i,a,s){void 0!==a?s=void 0!==s?s:0:(a=[],s=0);let n=t;for(;n<r;){let t=e[n++];a[s++]=e[n++],a[s++]=t;for(let t=2;t<i;++t)a[s++]=e[n++]}return a.length=s,a}}),n("6xHMs",function(e,r){t(e.exports,"default",()=>l);var i=s("fnScq"),a=s("iGyOD"),n=s("j2K3b"),o=s("cgPpQ"),l=class extends i.default{constructor(e){super(e=e||{})}readFeature(e,t){t=t||{};for(var r,i=e.children,s=new a.default,l=0;r=i[l];l++)s.set(r.tagName,r.innerHTML);var u,h,c=[];if(s.get("geo:long"))h=new n.default([parseFloat(s.get("geo:long")),parseFloat(s.get("geo:lat"))]),s.unset("geo:long"),s.unset("geo:lat");else if(s.get("georss:point"))c=s.get("georss:point").trim().split(" "),h=new n.default([parseFloat(c[1]),parseFloat(c[0])]),s.unset("georss:point");else if(s.get("georss:polygon")){u=s.get("georss:polygon").trim().split(" ");for(var d=0;d<u.length;d+=2)c.push([parseFloat(u[d+1]),parseFloat(u[d])]);h=new o.default([c]),s.unset("georss:polygon")}else if(s.get("georss:where"))return console.warn("[GeoRSS] GML format not implemented"),s.unset("georss:where"),null;else return console.warn("[GeoRSS] unknown geometry"),null;return(t.featureProjection||this.get("featureProjection"))&&h.transform(t.dataProjection||this.get("dataProjection")||"EPSG:4326",t.featureProjection||this.get("featureProjection")),s.setGeometry(h),s}readFeatures(e,t){if("string"==typeof e){var r=new DOMParser().parseFromString(e,"text/xml");i=r.getElementsByTagName(this.getDocumentItemsTagName(r))}else if(e instanceof Document)i=e.getElementsByTagName(this.getDocumentItemsTagName(e));else{if(!(e instanceof Node))return[];i=e}for(var i,a,s=[],n=0;a=i[n];n++){var o=this.readFeature(a,t);o&&s.push(o)}return s}getDocumentItemsTagName(e){return"feed"===e.documentElement.tagName?"entry":"item"}}}),n("6zjoU",function(r,i){t(r.exports,"default",()=>p);var a=s("fnScq"),n=s("iGyOD"),o=s("j2K3b"),l=s("5up1I"),u=s("3by3c");class h extends a.default{constructor(e){super(e=e||{})}readFeatures(t,r){let i=[],a=e(u).parse(t,{header:!0});if(a.meta.fields&&a.meta.fields.length){let e=d(/^lon$|^long$|^longitude$|^ln$|^x$/i,a.meta.fields),t=d(/^lat$|^latitude$|^lt$|^y$/i,a.meta.fields),s=function(e){for(let t in e)if(/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON) ?\(/.test(e[t]))return t}(a.data[0]);(s||e&&t)&&a.data.forEach(a=>{let l=e&&t?new o.default([a[e],a[t]]):!!a[s]&&c.readGeometry(a[s]);if(l&&(l.transform("EPSG:4326",r.featureProjection),l.getFirstCoordinate().length)){let e=new n.default(l);Object.keys(a).forEach(t=>{e.set(t,a[t],!0)}),i.push(e)}})}return i}}let c=new l.default;function d(e,t){return t.find(t=>{if(e.test(t))return t})}var p=h}),n("5up1I",function(e,r){t(e.exports,"default",()=>T);var i=s("iGyOD"),a=s("6pyIt"),n=s("hvEnP"),o=s("7TB1l"),l=s("ljDIj"),u=s("dEQmT"),h=s("j2K3b"),c=s("cgPpQ"),d=s("9z1G1"),p=s("jEnSw");let f={POINT:h.default,LINESTRING:n.default,POLYGON:c.default,MULTIPOINT:l.default,MULTILINESTRING:o.default,MULTIPOLYGON:u.default},m="EMPTY",g={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},y={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class v{constructor(e){this.wkt=e,this.index_=-1}isAlpha_(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumeric_(e,t){return t=void 0!==t&&t,e>="0"&&e<="9"||"."==e&&!t}isWhiteSpace_(e){return" "==e||"	"==e||"\r"==e||"\n"==e}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){let e;let t=this.nextChar_(),r=this.index_,i=t;if("("==t)e=g.LEFT_PAREN;else if(","==t)e=g.COMMA;else if(")"==t)e=g.RIGHT_PAREN;else if(this.isNumeric_(t)||"-"==t)e=g.NUMBER,i=this.readNumber_();else if(this.isAlpha_(t))e=g.TEXT,i=this.readText_();else if(this.isWhiteSpace_(t))return this.nextToken();else if(""===t)e=g.EOF;else throw Error("Unexpected character: "+t);return{position:r,value:i,type:e}}readNumber_(){let e;let t=this.index_,r=!1,i=!1;do"."==e?r=!0:("e"==e||"E"==e)&&(i=!0),e=this.nextChar_();while(this.isNumeric_(e,r)||!i&&("e"==e||"E"==e)||i&&("-"==e||"+"==e))return parseFloat(this.wkt.substring(t,this.index_--))}readText_(){let e;let t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e))return this.wkt.substring(t,this.index_--).toUpperCase()}}class _{constructor(e){this.lexer_=e,this.token_={position:0,type:g.START},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(e){return this.token_.type==e}match(e){let t=this.isTokenType(e);return t&&this.consume_(),t}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let e="XY",t=this.token_;if(this.isTokenType(g.TEXT)){let r=t.value;"Z"===r?e="XYZ":"M"===r?e="XYM":"ZM"===r&&(e="XYZM"),"XY"!==e&&this.consume_()}return e}parseGeometryCollectionText_(){if(this.match(g.LEFT_PAREN)){let e=[];do e.push(this.parseGeometry_());while(this.match(g.COMMA))if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(g.LEFT_PAREN)){let e=this.parsePoint_();if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(g.LEFT_PAREN)){let e=this.parsePointList_();if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(g.LEFT_PAREN)){let e=this.parseLineStringTextList_();if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(g.LEFT_PAREN)){let e;if(e=this.token_.type==g.LEFT_PAREN?this.parsePointTextList_():this.parsePointList_(),this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(g.LEFT_PAREN)){let e=this.parseLineStringTextList_();if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(g.LEFT_PAREN)){let e=this.parsePolygonTextList_();if(this.match(g.RIGHT_PAREN))return e}throw Error(this.formatErrorMessage_())}parsePoint_(){let e=[],t=this.layout_.length;for(let r=0;r<t;++r){let t=this.token_;if(this.match(g.NUMBER))e.push(t.value);else break}if(e.length==t)return e;throw Error(this.formatErrorMessage_())}parsePointList_(){let e=[this.parsePoint_()];for(;this.match(g.COMMA);)e.push(this.parsePoint_());return e}parsePointTextList_(){let e=[this.parsePointText_()];for(;this.match(g.COMMA);)e.push(this.parsePointText_());return e}parseLineStringTextList_(){let e=[this.parseLineStringText_()];for(;this.match(g.COMMA);)e.push(this.parseLineStringText_());return e}parsePolygonTextList_(){let e=[this.parsePolygonText_()];for(;this.match(g.COMMA);)e.push(this.parsePolygonText_());return e}isEmptyGeometry_(){let e=this.isTokenType(g.TEXT)&&this.token_.value==m;return e&&this.consume_(),e}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){let e=this.token_;if(this.match(g.TEXT)){let t;let r=e.value;this.layout_=this.parseGeometryLayout_();let i=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==r){if(i)return new a.default([]);let e=this.parseGeometryCollectionText_();return new a.default(e)}let s=f[r];if(!s)throw Error("Invalid geometry type: "+r);if(i)t="POINT"==r?[NaN,NaN]:[];else switch(r){case"POINT":t=this.parsePointText_();break;case"LINESTRING":t=this.parseLineStringText_();break;case"POLYGON":t=this.parsePolygonText_();break;case"MULTIPOINT":t=this.parseMultiPointText_();break;case"MULTILINESTRING":t=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":t=this.parseMultiPolygonText_()}return new s(t,this.layout_)}throw Error(this.formatErrorMessage_())}}class x extends p.default{constructor(e){super(),e=e||{},this.splitCollection_=void 0!==e.splitCollection&&e.splitCollection}parse_(e){return new _(new v(e)).parse()}readFeatureFromText(e,t){let r=this.readGeometryFromText(e,t),a=new i.default;return a.setGeometry(r),a}readFeaturesFromText(e,t){let r=[],a=this.readGeometryFromText(e,t);r=this.splitCollection_&&"GeometryCollection"==a.getType()?a.getGeometriesArray():[a];let s=[];for(let e=0,t=r.length;e<t;++e){let t=new i.default;t.setGeometry(r[e]),s.push(t)}return s}readGeometryFromText(e,t){let r=this.parse_(e);return(0,d.transformGeometryWithOptions)(r,!1,t)}writeFeatureText(e,t){let r=e.getGeometry();return r?this.writeGeometryText(r,t):""}writeFeaturesText(e,t){if(1==e.length)return this.writeFeatureText(e[0],t);let r=[];for(let t=0,i=e.length;t<i;++t)r.push(e[t].getGeometry());let i=new a.default(r);return this.writeGeometryText(i,t)}writeGeometryText(e,t){return A((0,d.transformGeometryWithOptions)(e,!0,t))}}function b(e){let t=e.getCoordinates();return 0===t.length?"":t.join(" ")}function S(e){let t=e.getCoordinates(),r=[];for(let e=0,i=t.length;e<i;++e)r.push(t[e].join(" "));return r.join(",")}function w(e){let t=[],r=e.getLinearRings();for(let e=0,i=r.length;e<i;++e)t.push("("+S(r[e])+")");return t.join(",")}let E={Point:b,LineString:S,Polygon:w,MultiPoint:function(e){let t=[],r=e.getPoints();for(let e=0,i=r.length;e<i;++e)t.push("("+b(r[e])+")");return t.join(",")},MultiLineString:function(e){let t=[],r=e.getLineStrings();for(let e=0,i=r.length;e<i;++e)t.push("("+S(r[e])+")");return t.join(",")},MultiPolygon:function(e){let t=[],r=e.getPolygons();for(let e=0,i=r.length;e<i;++e)t.push("("+w(r[e])+")");return t.join(",")},GeometryCollection:function(e){let t=[],r=e.getGeometries();for(let e=0,i=r.length;e<i;++e)t.push(A(r[e]));return t.join(",")}};function A(e){let t=e.getType(),r=(0,E[t])(e),i=y[t];if("function"==typeof e.getFlatCoordinates){let t=function(e){let t=e.getLayout(),r="";return("XYZ"===t||"XYZM"===t)&&(r+="Z"),("XYM"===t||"XYZM"===t)&&(r+="M"),r}(e);t.length>0&&(i+=" "+t)}return 0===r.length?i+" "+m:i+"("+r+")"}var T=x}),n("cLiWE",function(e,r){t(e.exports,"default",()=>l);var i=s("eEuqc"),a=s("3SMVV"),n=s("5TDW7");class o extends n.default{constructor(){super()}}o.prototype.read=function(e){if("WMS"!==e.type)return!1;e.wmsparam.source.url=(e.wmsparam.source.url||"").replace(/service=wms&?/i,"");let t=new i.default({extent:e.wmsparam.layer.extent,queryable:!!e.wmsparam.layer.queryable,minResolution:e.wmsparam.layer.minResolution,maxResolution:e.wmsparam.layer.maxResolution,source:new a.default(e.wmsparam.source)});return t.set("wmsparam",e.wmsparam),this.readOptions(t,e),t.get("title")||t.set("title",e.wmsparam.layer.title),t},o.prototype.write=function(e){if("WMS"!==e.get("type"))return null;var t=this.writeOptions(e,{wms:!0});return t.wmsparam=e.get("wmsparam")||e.WMSParams,t};var l=o}),n("3SMVV",function(e,r){t(e.exports,"default",()=>f);var i=s("jZquI"),a=s("a6roo"),n=s("gzr8q"),o=s("gpSXC"),l=s("7f9mA"),u=s("9YraL"),h=s("9AVh1"),c=s("42VYg"),d=s("9IqLY");class p extends c.default{constructor(e){let t=Object.assign({},(e=e||{}).params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.gutter_=void 0!==e.gutter?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=void 0===e.hidpi||e.hidpi,this.tmpExtent_=(0,i.createEmpty)(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,a){let s=(0,n.get)(r),l=this.getProjection()||s,u=this.getTileGrid();u||(u=this.getTileGridForProjection(l));let h=(0,n.transform)(e,s,l),c=(0,o.calculateSourceResolution)(l,s,e,t),p=u.getZForResolution(c,this.zDirection),f=u.getResolution(p),m=u.getTileCoordForCoordAndZ(h,p);if(u.getResolutions().length<=m[0])return;let g=u.getTileCoordExtent(m,this.tmpExtent_),y=this.gutter_;0!==y&&(g=(0,i.buffer)(g,f*y,g));let v={QUERY_LAYERS:this.params_.LAYERS};Object.assign(v,(0,d.getRequestParams)(this.params_,"GetFeatureInfo"),a);let _=Math.floor((h[0]-g[0])/f),x=Math.floor((g[3]-h[1])/f);return v[this.v13_?"I":"X"]=_,v[this.v13_?"J":"Y"]=x,this.getRequestUrl_(m,g,1,l||s,v)}getLegendUrl(e,t){if(void 0===this.urls[0])return;let r={SERVICE:"WMS",VERSION:d.DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){let e=this.params_.LAYERS;if(!(!Array.isArray(e)||1===e.length))return;r.LAYER=e}if(void 0!==e){let t=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=e*t/28e-5}return Object.assign(r,t),(0,h.appendParams)(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){let n;let o=this.urls;if(o){if(1==o.length)n=o[0];else{let t=(0,a.modulo)((0,u.hash)(e),o.length);n=o[t]}return(0,d.getImageSrc)(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,n,s,this.serverType_)}}getTilePixelRatio(e){return this.hidpi_&&void 0!==this.serverType_?e:1}getKeyForParams_(){let e=0,t=[];for(let r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){let e=this.params_.VERSION||d.DEFAULT_VERSION;this.v13_=(0,l.compareVersions)(e,"1.3")>=0}tileUrlFunction(e,t,r){let a=this.getTileGrid();if(a||(a=this.getTileGridForProjection(r)),a.getResolutions().length<=e[0])return;1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);let s=a.getResolution(e[0]),n=a.getTileCoordExtent(e,this.tmpExtent_),o=this.gutter_;0!==o&&(n=(0,i.buffer)(n,s*o,n));let l=Object.assign({},(0,d.getRequestParams)(this.params_,"GetMap"));return this.getRequestUrl_(e,n,t,r,l)}}var f=p}),n("9IqLY",function(e,r){t(e.exports,"DEFAULT_VERSION",()=>u),t(e.exports,"getImageSrc",()=>h),t(e.exports,"getRequestParams",()=>c),s("kUxvm");var i=s("jZquI"),a=s("a6roo");s("gzr8q");var n=s("7f9mA"),o=s("9AVh1");s("3i1Ma");var l=s("fqTWj");let u="1.3.0";function h(e,t,r,s,u,h,c){h=Object.assign({REQUEST:"GetMap"},h);let d=t/r,p=[(0,a.round)((0,i.getWidth)(e)/d,l.DECIMALS),(0,a.round)((0,i.getHeight)(e)/d,l.DECIMALS)];if(1!=r)switch(c){case"geoserver":let f=90*r+.5|0;"FORMAT_OPTIONS"in h?h.FORMAT_OPTIONS+=";dpi:"+f:h.FORMAT_OPTIONS="dpi:"+f;break;case"mapserver":h.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":h.DPI=90*r;break;default:throw Error("Unknown `serverType` configured")}return function(e,t,r,i,a){a.WIDTH=r[0],a.HEIGHT=r[1];let s=i.getAxisOrientation(),l=(0,n.compareVersions)(a.VERSION,"1.3")>=0;a[l?"CRS":"SRS"]=i.getCode();let u=l&&s.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return a.BBOX=u.join(","),(0,o.appendParams)(e,a)}(u,e,p,s,h)}function c(e,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:u,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},e)}}),n("5UlEr",function(e,r){t(e.exports,"default",()=>u);var i=s("eEuqc"),a=s("gAUZM"),n=s("5TDW7"),o=s("9PI6P");class l extends n.default{constructor(){super()}}l.prototype.read=function(e){if("WMTS"!==e.type)return null;let t=e.wmtsparam;t.source.tileGrid=(0,o.default).prototype.getTileGrid(t.source.matrixSet,t.source.minZoom,t.source.maxZoom);let r=new i.default({extent:t.layer.extent,minResolution:t.layer.minResolution,maxResolution:t.layer.maxResolution,source:new a.default(t.source)});return delete t.source.tileGrid,r.set("wmtsparam",t),this.readOptions(r,e),r.get("title")||r.set("title",t.layer.title),r},l.prototype.write=function(e){if("WMTS"!==e.get("type"))return null;var t=this.writeOptions(e,{});return t.wmtsparam=e.get("wmtsparam")||e.wmtsparams,t};var u=l}),n("9PI6P",function(e,r){t(e.exports,"default",()=>p);var i=s("i28LF"),a=s("4QhZh"),n=s("sxATa"),o=s("kUWI9"),l=s("eEuqc"),u=s("gAUZM"),h=s("gzr8q"),c=s("jZquI"),d=class extends i.default{constructor(e){(e=e||{}).title=e.title||"WMTS",super(e),this.getDialog().set("className",this.getDialog().get("className")+" ol-wmtscapabilities")}_getParser(){var e=new o.default;return{read:(function(t){var r=e.read(t);r.Capability={Layer:r.Contents},r.Capability.Layer.Attribution={Title:r.ServiceProvider.ProviderName};var i=[];return r.Contents.Layer.forEach(function(e){e.Format&&/jpeg|png/.test(e.Format[0])&&i.push(e)}),r.Contents.Layer=i,r}).bind(this)}}getRequestParam(e){return{SERVICE:"WMTS",REQUEST:"GetCapabilities",VERSION:e.version||"1.0.0"}}_getTG(e,t,r,i){for(var a=[],s=[],n=(0,c.getWidth)((0,h.get)("EPSG:3857").getExtent())/256,o=0;o<=(r||20);o++){var l=i?e+":"+o:o;a[o]=l,s[o]=n/Math.pow(2,o)}return{origin:[-20037508,20037508],resolutions:s,matrixIds:a,minZoom:t||0}}getTileGrid(e,t,r,i){return new n.default(this._getTG(e,t,r,i))}isSupportedSet(e){return!!/^PM_.*/.test(e.TileMatrixSet)||this.supportedSets.indexOf(e.TileMatrixSet)>=0}getOptionsFromCap(e,t){var r,i=e.WGS84BoundingBox;i&&(i=(0,h.transformExtent)(i,"EPSG:4326",this.getMap().getView().getProjection()));var s=1/0,n=-1/0;if(e.TileMatrixSetLink.forEach((function(t){this.isSupportedSet(t)&&(r=t,e.TileMatrixSet=t.TileMatrixSet)}).bind(this)),!r){this.showError({type:"TileMatrix"});return}if(r.TileMatrixSetLimits){var o=r.TileMatrixSetLimits[0].TileMatrix.split(":").length>1;r.TileMatrixSetLimits.forEach(function(e){var t=e.TileMatrix.split(":").pop();s=Math.min(s,parseInt(t)),n=Math.max(n,parseInt(t))})}else s=0,n=20;var l=new a.default;l.setZoom(s);var u={title:e.Title,extent:i,abstract:e.Abstract,maxResolution:l.getResolution()},c={url:t.url,layer:e.Identifier,matrixSet:e.TileMatrixSet,format:e.Format[0]||"image/jpeg",projection:"EPSG:3857",tilePrefix:o,minZoom:s,maxZoom:n,style:e.Style?e.Style[0].Identifier:"normal",attributions:e.Attribution.Title,crossOrigin:this.get("cors")?"anonymous":null,wrapX:!1!==this.get("wrapX")};if(this._fillForm({title:u.title,layers:c.layer,style:c.style,format:c.format,minZoom:s,maxZoom:n,extent:i?i.join(","):"",projection:c.projection,attribution:c.attributions||"",version:"1.0.0"}),this.get("trace")){c.tileGrid="TILEGRID";var d=JSON.stringify([c],null,"	").replace(/\\"/g,'"');d=d.replace('"TILEGRID"',"new ol_tilegrid_WMTS("+JSON.stringify(this._getTG(c.matrixSet,c.minZoom,c.maxZoom,c.tilePrefix),null,"	").replace(/\n/g,"\n		")+")"),delete c.tileGrid,u.source="SOURCE";var p="new ol.layer.Tile ("+JSON.stringify(u,null,"	")+")";console.log(p=p.replace(/\\"/g,'"').replace('"SOURCE"',"new ol.source.WMTS("+d+")").replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/"tileGrid": {/g,'"tileGrid": new ol.tilegrid.WMTS({').replace(/},\n(\t*)"style"/g,'}),\n$1"style"').replace("([\n	","(").replace("}\n])","})")),delete u.source}var f=void 0;return e.Style&&e.Style[0]&&e.Style[0].LegendURL&&e.Style[0].LegendURL[0]&&(f=[e.Style[0].LegendURL[0].href]),{layer:u,source:c,data:{title:e.Title,abstract:e.Abstract,legend:f}}}_getFormOptions(){var e=this._currentOptions||{};e.layer||(e.layer={}),e.source||(e.source={}),e.data||(e.data={});var t=parseInt(this._elements.formMinZoom.value)||0,r=parseInt(this._elements.formMaxZoom.value)||20,i=[];this._elements.formExtent.value&&this._elements.formExtent.value.split(",").forEach(function(e){i.push(parseFloat(e))}),4!==i.length&&(i=void 0);var s=[];this._elements.formAttribution.value&&s.push(this._elements.formAttribution.value);var n=new a.default({projection:this.getMap().getView().getProjection()});return n.setZoom(t),{layer:{title:this._elements.formTitle.value,extent:i,abstract:e.layer.abstract||"",maxResolution:n.getResolution()},source:{url:this._elements.input.value,layer:this._elements.formLayer.value,matrixSet:e.source.matrixSet||"PM",format:this._elements.formFormat.options[this._elements.formFormat.selectedIndex].value,projection:"EPSG:3857",minZoom:t,maxZoom:r,style:this._elements.formStyle.value||"normal",attributions:s,crossOrigin:this._elements.formCrossOrigin.checked?"anonymous":null,wrapX:!1!==this.get("wrapX")},data:{title:this._elements.formTitle.value,abstract:e.data.abstract,legend:e.data.legend}}}getLayerFromOptions(e){if(e){e.source.tileGrid=this.getTileGrid(e.source.matrixSet,e.source.minZoom,e.source.maxZoom,e.source.tilePrefix),e.layer.source=new u.default(e.source);var t=new l.default(e.layer);return delete e.layer.source,delete e.source.tileGrid,t}}};i.default.prototype.supportedSets=["PM","3857","EPSG:3857","EPSG:900913","webmercator","GoogleMapsCompatible"];var p=d}),n("i28LF",function(e,r){t(e.exports,"default",()=>f);var i=s("4QhZh"),a=s("3SMVV"),n=s("eEuqc"),o=s("gzr8q"),l=s("8P7EG"),u=s("iQyfo"),h=s("fkmMz"),c=s("QtBcx"),d=s("6od7S");s("2NQly");var p=class extends c.default{constructor(e){var t=Object.assign({},e=e||{});t.target===document.body&&delete t.target,t.target?(t.className=((t.className||"")+" ol-wmscapabilities ol-hidden").trim(),delete t.target):(t.className=((t.className||"")+" ol-wmscapabilities").trim(),t.handleClick=function(){r.showDialog()}),super(t);var r=this;this._proxy=e.proxy,this.set("srs",e.srs||[]),this.set("cors",e.cors),this.set("trace",e.trace),this.set("title",e.title),this.set("loadLabel",e.loadLabel),this.set("optional",e.optional),this.createDialog(e),this._elements.formVersion.value="1.0.0";var i=this._getParser();this._ajax=new h.default({dataType:"text",auth:e.authentication}),this._ajax.on("success",(function(e){var t;try{t=i.read(e.response)}catch(e){this.showError({type:"load",error:e})}t&&(t.Capability.Layer.Layer?(t.url=e.options.url,this.showCapabilities(t)):this.showError({type:"noLayer"})),this.dispatchEvent({type:"capabilities",capabilities:t}),"function"==typeof e.options.callback&&e.options.callback(t)}).bind(this)),this._ajax.on("error",(function(e){this.showError({type:"load",error:e}),this.dispatchEvent({type:"capabilities"}),e.options.callback}).bind(this)),this._ajax.on("loadstart",(function(){this._elements.element.classList.add("ol-searching")}).bind(this)),this._ajax.on("loadend",(function(){this._elements.element.classList.remove("ol-searching")}).bind(this)),e.onselect&&this.on("load",function(t){e.onselect(t.layer,t.options)})}_getParser(){return new l.default}createDialog(e){var t=e.target;t&&t!==document.body||(this._dialog=new d.default({className:"ol-wmscapabilities",closeBox:!0,closeOnSubmit:!1,target:e.target}),this._dialog.on("button",(function(e){"submit"===e.button&&this.getCapabilities(e.inputs.url.value)}).bind(this)),t=null);var r=(0,u.default).create("DIV",{className:("ol-wmscapabilities "+(e.className||"")).trim(),parent:t});this._elements={element:t||r};var i=(0,u.default).create("DIV",{className:"ol-url",parent:r}),a=this._elements.input=(0,u.default).create("INPUT",{className:"url",type:"text",tabIndex:1,placeholder:e.placeholder||"service url...",autocorrect:"off",autocapitalize:"off",parent:i});if(a.addEventListener("keyup",(function(t){13===t.keyCode&&this.getCapabilities(a.value,e)}).bind(this)),e.services){var s=(0,u.default).create("SELECT",{className:"url",on:{change:(function(t){var r=t.target.options[t.target.selectedIndex].value;this.getCapabilities(r,e),t.target.selectedIndex=0}).bind(this)},parent:i});for(var n in(0,u.default).create("OPTION",{html:" ",parent:s}),e.services)(0,u.default).create("OPTION",{html:n,value:e.services[n],parent:s})}(0,u.default).create("BUTTON",{click:(function(){this.getCapabilities(a.value,e)}).bind(this),html:e.searchLabel||"search",parent:i}),this._elements.error=(0,u.default).create("DIV",{className:"ol-error",parent:i});var o=this._elements.result=(0,u.default).create("DIV",{className:"ol-result",parent:r}),l=(0,u.default).create("DIV",{className:"ol-preview",html:e.previewLabel||"preview",parent:o});this._elements.preview=(0,u.default).create("IMG",{parent:l}),this._img=new Image,this._img.crossOrigin="Anonymous",this._img.addEventListener("error",(function(){l.className="ol-preview tainted",this._elements.formCrossOrigin.checked=!1}).bind(this)),this._img.addEventListener("load",(function(){l.className="ol-preview ok",this._elements.formCrossOrigin.checked=!0}).bind(this)),this._elements.select=(0,u.default).create("DIV",{className:"ol-select-list",tabIndex:2,parent:o}),this._elements.data=(0,u.default).create("DIV",{className:"ol-data",parent:o}),this._elements.buttons=(0,u.default).create("DIV",{className:"ol-buttons",parent:o}),this._elements.legend=(0,u.default).create("IMG",{className:"ol-legend",parent:o});var h=this._elements.form=(0,u.default).create("UL",{className:"ol-wmsform",parent:r}),c=(function(e,t,r){var i=(0,u.default).create("LI",{parent:h});if((0,u.default).create("LABEL",{html:this.labels[e],parent:i}),"boolean"==typeof t)this._elements[e]=(0,u.default).create("INPUT",{type:"checkbox",checked:t,parent:i});else if(t instanceof Array){var a=this._elements[e]=(0,u.default).create("SELECT",{parent:i});t.forEach((function(e){(0,u.default).create("OPTION",{html:e,value:e,parent:a})}).bind(this))}else this._elements[e]=(0,u.default).create("INPUT",{value:void 0===t?"":t,placeholder:r||"",type:"number"==typeof t?"number":"text",parent:i});return i}).bind(this);c("formTitle"),c("formLayer","","layer1,layer2,...");var p=c("formMap");p.setAttribute("data-param","map"),(p=c("formStyle")).setAttribute("data-param","style"),c("formFormat",["image/png","image/jpeg"]),c("formMinZoom",0),c("formMaxZoom",20),(p=c("formExtent","","xmin,ymin,xmax,ymax")).setAttribute("data-param","extent");var f=p.querySelector("input");return(0,u.default).create("BUTTON",{title:this.labels.mapExtent,click:(function(){f.value=this.getMap().getView().calculateExtent(this.getMap().getSize()).join(",")}).bind(this),parent:p}),(p=c("formProjection","")).setAttribute("data-param","proj"),c("formCrossOrigin",!1),(p=c("formVersion","1.3.0")).setAttribute("data-param","version"),c("formAttribution",""),(0,u.default).create("BUTTON",{html:this.get("loadLabel")||"Load",click:(function(){var e=this._getFormOptions(),t=this.getLayerFromOptions(e);this.dispatchEvent({type:"load",layer:t,options:e}),this._dialog.hide()}).bind(this),parent:h}),r}getLayerFromOptions(e){e.layer.source=new a.default(e.source);var t=new n.default(e.layer);return delete e.layer.source,t}setMap(e){super.setMap(e),this._dialog&&this._dialog.setMap(e)}getDialog(){return this._dialog}showDialog(e,t){this.showError(),this._elements.formProjection.value||(this._elements.formProjection.value=this.getMap().getView().getProjection().getCode()),this._dialog&&this._dialog.show({title:void 0===this.get("title")?"WMS":this.get("title"),content:this._elements.element}),this.getCapabilities(e,t);var r=this._elements.select.querySelector(".selected");r&&(this._elements.select.scrollTop=r.offsetTop-20)}testUrl(e){return!!RegExp("^(https?:\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=\\/-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}getRequestParam(e){return{SERVICE:"WMS",REQUEST:"GetCapabilities",VERSION:e.version||"1.3.0"}}getCapabilities(e,t){if(e){if(!this.testUrl(e)){this.showError({type:"badUrl"});return}t=t||{};var r=(e=e.split("?"))[1];e=e[0],this._elements.formMap.value="",this._elements.formLayer.value="",this._elements.formStyle.value="",this._elements.formTitle.value="",this._elements.formProjection.value=this.getMap().getView().getProjection().getCode(),this._elements.formFormat.selectedIndex=0;var i=t.map||"",a={};r&&(r=r.replace(/^\?/,"").split("&")).forEach((function(e){if((e=e.split("="))[1]=decodeURIComponent(e[1]||""),/^map$/i.test(e[0])&&(i=e[1],this._elements.formMap.value=i),/^layers$/i.test(e[0])&&(this._elements.formLayer.value=e[1],this._elements.formTitle.value=e[1].split(",")[0]),/^style$/i.test(e[0])&&(this._elements.formStyle.value=e[1]),/^crs$/i.test(e[0])&&(this._elements.formProjection.value=e[1]),/^format$/i.test(e[0])){for(var t,r=0;t=this._elements.formFormat.options[r];r++)if(t.value===e[1]){this._elements.formFormat.selectedIndex=r;break}}this.get("optional")&&this.get("optional").split(",").forEach((function(t){t===e[0]&&(a[t]=e[1])}).bind(this))}).bind(this)),this._optional=a;var s=this.getRequestParam(t),n=[];for(var o in i&&(s.MAP=i,n.push("map="+i)),a)s[o]=a[o],n.push(o+"="+a[o]);var l=this._elements.input.value=(e||"")+(n?"?"+n.join("&"):"");if(this.clearForm(),this._proxy){var u="";for(var h in s)u+=(u?"&":"")+h+"="+s[h];this._ajax.send(this._proxy,{url:u},{url:l,timeout:t.timeout||1e4,callback:t.onload,abort:!1})}else this._ajax.send(e,s,{url:l,timeout:t.timeout||1e4,callback:t.onload,abort:!1})}}showError(e){e?this._elements.error.innerHTML=this.error[e.type]||"ERROR ("+e.type+")":this._elements.error.innerHTML="",e&&"load"===e.type?this._elements.form.classList.add("visible"):this._elements.form.classList.remove("visible")}clearForm(){this._elements.result.classList.remove("ol-visible"),this.showError(),this._elements.select.innerHTML="",this._elements.data.innerHTML="",this._elements.preview.src="",this._elements.legend.src="",this._elements.legend.classList.remove("visible")}showCapabilities(e){this._elements.result.classList.add("ol-visible");var t=[],r=(function(i,a){a=a||0,i.Layer.forEach((function(s){s.Attribution||(s.Attribution=i.Attribution),s.EX_GeographicBoundingBox||(s.EX_GeographicBoundingBox=i.EX_GeographicBoundingBox);var n=(0,u.default).create("DIV",{className:(s.Layer?"ol-title ":"")+"level-"+a,html:s.Name||s.Title,click:(function(){this._elements.buttons.innerHTML="",this._elements.data.innerHTML="",this._elements.legend.src=this._elements.preview.src="",this._elements.element.classList.remove("ol-form"),this.showError();var r=this.getOptionsFromCap(s,e),i=this.getLayerFromOptions(r);if(this._currentOptions=r,t.forEach(function(e){e.classList.remove("selected")}),n.classList.add("selected"),i){(0,u.default).create("BUTTON",{html:this.get("loadLabel")||"Load",className:"ol-load",click:(function(){this.dispatchEvent({type:"load",layer:i,options:r}),this._dialog&&this._dialog.hide()}).bind(this),parent:this._elements.buttons}),(0,u.default).create("BUTTON",{className:"ol-wmsform",click:(function(){this._elements.element.classList.toggle("ol-form")}).bind(this),parent:this._elements.buttons});var a=this.getMap().getView().getResolution(),o=this.getMap().getView().getCenter();this._elements.preview.src=i.getPreview(o,a,this.getMap().getView().getProjection()),this._img.src=this._elements.preview.src,(0,u.default).create("p",{className:"ol-title",html:r.data.title,parent:this._elements.data}),(0,u.default).create("p",{html:r.data.abstract,parent:this._elements.data}),r.data.legend&&r.data.legend.length?(this._elements.legend.src=r.data.legend[0],this._elements.legend.classList.add("visible")):(this._elements.legend.src="",this._elements.legend.classList.remove("visible"))}}).bind(this),parent:this._elements.select});t.push(n),s.Layer&&r(s,a+1)}).bind(this))}).bind(this);this._elements.select.innerHTML="",r(e.Capability.Layer)}getLayerResolution(e,t,r){var i="min"===e?"MinScaleDenominator":"MaxScaleDenominator";if(void 0!==t[i])return t[i]/(72/2.54*100);if(!t.Layer)return"min"===e?0:156543.03392804097;r="min"===e?156543.03392804097:0;for(var a=0;a<t.Layer.length;a++){var s=this.getLayerResolution(e,t.Layer[a],r);void 0!==s&&(r=Math[e](r,s))}return r}getOptionsFromCap(e,t){var r,a,s=t.Capability.Request.GetMap.Format,n=[/png/,/jpeg/,/gif/];for(a=0;a<3;a++){for(var l=0;l<s.length;l++)if(n[a].test(s[l])){r=s[l];break}if(r)break}r||(r=s[0]);var u=this.getMap().getView().getProjection().getCode();this.showError();var h=!1;e.CRS?e.CRS.indexOf(u)>=0?h=!0:e.CRS.indexOf("EPSG:4326")>=0?(u="EPSG:4326",h=!0):this.get("srs").forEach(function(t){e.CRS.indexOf(t)>=0&&(u=t,h=!0)}):h=!1,!h&&(this.showError({type:"srs"}),this.get("trace")&&console.log("BAD srs: ",e.CRS));var c=e.EX_GeographicBoundingBox;c&&(c=(0,o.transformExtent)(c,"EPSG:4326",this.getMap().getView().getProjection()));var d=[];e.Attribution&&e.Attribution.Title&&d.push('<a href="'+encodeURI(e.Attribution.OnlineResource)+'">&copy; '+e.Attribution.Title.replace(/</g,"&lt;")+"</a>");var p={title:e.Title,extent:c,queryable:e.queryable,abstract:e.Abstract,minResolution:this.getLayerResolution("min",e),maxResolution:this.getLayerResolution("max",e)||156543.03392804097},f={url:(t.Capability.Request.GetMap.DCPType[0].HTTP.Get.OnlineResource||"").replace(/service=wms&?/i,""),projection:u,attributions:d,crossOrigin:this.get("cors")?"anonymous":null,params:{LAYERS:e.Name,FORMAT:r,VERSION:t.version||"1.3.0"}};Object.keys(this._optional).forEach(e=>f.params[e]=this._optional[e]);var m=new i.default({projection:this.getMap().getView().getProjection()});m.setResolution(p.minResolution);var g=Math.round(m.getZoom());m.setResolution(p.maxResolution);var y=Math.round(m.getZoom());if(this._fillForm({title:p.title,layers:f.params.LAYERS,format:f.params.FORMAT,minZoom:y,maxZoom:g,extent:c?c.join(","):"",projection:f.projection,attribution:f.attributions[0]||"",version:f.params.VERSION}),this.get("trace")){var v=JSON.stringify([f],null,"	").replace(/\\"/g,'"');p.source="SOURCE";var _="new ol.layer.Tile ("+JSON.stringify(p,null,"	")+")";console.log(_=_.replace(/\\"/g,'"').replace('"SOURCE"',"new ol.source.TileWMS("+v+")").replace(/\\t/g,"	").replace(/\\n/g,"\n").replace("([\n	","(").replace("}\n])","})")),delete p.source}var x=[];return e.Style&&e.Style.forEach(function(e){e.LegendURL&&x.push(e.LegendURL[0].OnlineResource)}),{layer:p,source:f,data:{title:e.Title,abstract:e.Abstract,logo:e.Attribution&&e.Attribution.LogoURL?e.Attribution.LogoURL.OnlineResource:void 0,keyword:e.KeywordList,legend:x,opaque:e.opaque,queryable:e.queryable}}}_getFormOptions(){var e=parseInt(this._elements.formMinZoom.value),t=parseInt(this._elements.formMaxZoom.value),r=new i.default({projection:this.getMap().getView().getProjection()});r.setZoom(e);var a=r.getResolution();r.setZoom(t);var s=r.getResolution(),n=[];this._elements.formExtent.value&&this._elements.formExtent.value.split(",").forEach(function(e){n.push(parseFloat(e))}),4!==n.length&&(n=void 0);var o=[];this._elements.formAttribution.value&&o.push(this._elements.formAttribution.value);var l={layer:{title:this._elements.formTitle.value,extent:n,maxResolution:a,minResolution:s},source:{url:this._elements.input.value,crossOrigin:this._elements.formCrossOrigin.checked?"anonymous":null,projection:this._elements.formProjection.value,attributions:o,params:{FORMAT:this._elements.formFormat.options[this._elements.formFormat.selectedIndex].value,LAYERS:this._elements.formLayer.value,VERSION:this._elements.formVersion.value}},data:{title:this._elements.formTitle.value}};return Object.keys(this._optional).forEach(e=>l.source.params[e]=this._optional[e]),this._elements.formMap.value&&(l.source.params.MAP=this._elements.formMap.value),l}_fillForm(e){var t,r;for(r=0,this._elements.formTitle.value=e.title,this._elements.formLayer.value=e.layers,this._elements.formStyle.value=e.style;t=this._elements.formFormat.options[r];r++)if(t.value===e.format){this._elements.formFormat.selectedIndex=r;break}this._elements.formExtent.value=e.extent||"",this._elements.formMaxZoom.value=e.maxZoom,this._elements.formMinZoom.value=e.minZoom,this._elements.formProjection.value=e.projection,this._elements.formAttribution.value=e.attribution,this._elements.formVersion.value=e.version}loadLayer(e,t,r){this.getCapabilities(e,{onload:(function(e){e?e.Capability.Layer.Layer.forEach((function(i){if(i.Name===t||i.Identifier===t){var a=this.getOptionsFromCap(i,e),s=this.getLayerFromOptions(a);this.dispatchEvent({type:"load",layer:s,options:a}),"function"==typeof r&&r({layer:s,options:a})}}).bind(this)):this.dispatchEvent({type:"load",error:!0})}).bind(this)})}};p.prototype.error={load:"Can't retrieve service capabilities, try to add it manually...",badUrl:"The input value is not a valid url...",TileMatrix:"No TileMatrixSet supported...",noLayer:"No layer available for this service...",srs:"The service projection looks different from that of your map, it may not display correctly..."},p.prototype.labels={formTitle:"Title:",formLayer:"Layers:",formMap:"Map:",formStyle:"Style:",formFormat:"Format:",formMinZoom:"Min zoom level:",formMaxZoom:"Max zoom level:",formExtent:"Extent:",mapExtent:"use map extent...",formProjection:"Projection:",formCrossOrigin:"CrossOrigin:",formVersion:"Version:",formAttribution:"Attribution:"};var f=p}),n("8P7EG",function(e,r){t(e.exports,"default",()=>j);var i=s("7f9mA"),a=s("fbciu"),n=s("dfksr"),o=s("3VMq2"),l=s("5kLwh");let u=[null,"http://www.opengis.net/wms"];function h(e){return(0,i.compareVersions)(e[0].version,"1.3")>=0}let c=(0,a.makeStructureNS)(u,{Service:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},h(t)?v:y,e,t)}),Capability:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},h(t)?f:p,e,t)})}),d={Request:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},P,e,t)}),Exception:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)([],S,e,t)}),Layer:(0,a.makeObjectPropertySetter)(function(e,t){let r=(0,a.pushParseAndPop)({},h(t)?A:E,e,t);return void 0===r.Layer?Object.assign(r,D(e,t)):r})},p=(0,a.makeStructureNS)(u,{...d,UserDefinedSymbolization:(0,a.makeObjectPropertySetter)(function(e,t){return{SupportSLD:!!(0,l.readBooleanString)(e.getAttribute("UserDefinedSymbolization")),UserLayer:!!(0,l.readBooleanString)(e.getAttribute("UserLayer")),UserStyle:!!(0,l.readBooleanString)(e.getAttribute("UserStyle")),RemoteWFS:!!(0,l.readBooleanString)(e.getAttribute("RemoteWFS"))}})}),f=(0,a.makeStructureNS)(u,d);class m extends n.default{constructor(){super(),this.version=void 0}readFromNode(e){return this.version=e.getAttribute("version").trim(),(0,a.pushParseAndPop)({version:this.version},c,e,[])||null}}let g={Name:(0,a.makeObjectPropertySetter)(l.readString),Title:(0,a.makeObjectPropertySetter)(l.readString),Abstract:(0,a.makeObjectPropertySetter)(l.readString),KeywordList:(0,a.makeObjectPropertySetter)(q),OnlineResource:(0,a.makeObjectPropertySetter)(o.readHref),ContactInformation:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},_,e,t)}),Fees:(0,a.makeObjectPropertySetter)(l.readString),AccessConstraints:(0,a.makeObjectPropertySetter)(l.readString)},y=(0,a.makeStructureNS)(u,g),v=(0,a.makeStructureNS)(u,{...g,LayerLimit:(0,a.makeObjectPropertySetter)(l.readPositiveInteger),MaxWidth:(0,a.makeObjectPropertySetter)(l.readPositiveInteger),MaxHeight:(0,a.makeObjectPropertySetter)(l.readPositiveInteger)}),_=(0,a.makeStructureNS)(u,{ContactPersonPrimary:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},x,e,t)}),ContactPosition:(0,a.makeObjectPropertySetter)(l.readString),ContactAddress:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},b,e,t)}),ContactVoiceTelephone:(0,a.makeObjectPropertySetter)(l.readString),ContactFacsimileTelephone:(0,a.makeObjectPropertySetter)(l.readString),ContactElectronicMailAddress:(0,a.makeObjectPropertySetter)(l.readString)}),x=(0,a.makeStructureNS)(u,{ContactPerson:(0,a.makeObjectPropertySetter)(l.readString),ContactOrganization:(0,a.makeObjectPropertySetter)(l.readString)}),b=(0,a.makeStructureNS)(u,{AddressType:(0,a.makeObjectPropertySetter)(l.readString),Address:(0,a.makeObjectPropertySetter)(l.readString),City:(0,a.makeObjectPropertySetter)(l.readString),StateOrProvince:(0,a.makeObjectPropertySetter)(l.readString),PostCode:(0,a.makeObjectPropertySetter)(l.readString),Country:(0,a.makeObjectPropertySetter)(l.readString)}),S=(0,a.makeStructureNS)(u,{Format:(0,a.makeArrayPusher)(l.readString)}),w={Name:(0,a.makeObjectPropertySetter)(l.readString),Title:(0,a.makeObjectPropertySetter)(l.readString),Abstract:(0,a.makeObjectPropertySetter)(l.readString),KeywordList:(0,a.makeObjectPropertySetter)(q),BoundingBox:(0,a.makeObjectPropertyPusher)(N),Dimension:(0,a.makeObjectPropertyPusher)(function(e,t){let r={name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol")};return h(t)&&Object.assign(r,{default:e.getAttribute("default"),multipleValues:(0,l.readBooleanString)(e.getAttribute("multipleValues")),nearestValue:(0,l.readBooleanString)(e.getAttribute("nearestValue")),current:(0,l.readBooleanString)(e.getAttribute("current")),values:(0,l.readString)(e)}),r}),Attribution:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},T,e,t)}),AuthorityURL:(0,a.makeObjectPropertyPusher)(function(e,t){let r=F(e,t);if(r)return r.name=e.getAttribute("name"),r}),Identifier:(0,a.makeObjectPropertyPusher)(l.readString),MetadataURL:(0,a.makeObjectPropertyPusher)(function(e,t){let r=F(e,t);if(r)return r.type=e.getAttribute("type"),r}),DataURL:(0,a.makeObjectPropertyPusher)(F),FeatureListURL:(0,a.makeObjectPropertyPusher)(F),Style:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},O,e,t)}),Layer:(0,a.makeObjectPropertyPusher)(D)},E=(0,a.makeStructureNS)(u,{...w,SRS:(0,a.makeObjectPropertyPusher)(l.readString),Extent:(0,a.makeObjectPropertySetter)(function(e,t){return{name:e.getAttribute("name"),default:e.getAttribute("default"),nearestValue:(0,l.readBooleanString)(e.getAttribute("nearestValue"))}}),ScaleHint:(0,a.makeObjectPropertyPusher)(function(e,t){return{min:(0,l.readDecimalString)(e.getAttribute("min")),max:(0,l.readDecimalString)(e.getAttribute("max"))}}),LatLonBoundingBox:(0,a.makeObjectPropertySetter)((e,t)=>N(e,t,!1)),Layer:(0,a.makeObjectPropertyPusher)(D)}),A=(0,a.makeStructureNS)(u,{...w,CRS:(0,a.makeObjectPropertyPusher)(l.readString),EX_GeographicBoundingBox:(0,a.makeObjectPropertySetter)(function(e,t){let r=(0,a.pushParseAndPop)({},C,e,t);if(!r)return;let i=r.westBoundLongitude,s=r.southBoundLatitude,n=r.eastBoundLongitude,o=r.northBoundLatitude;if(void 0!==i&&void 0!==s&&void 0!==n&&void 0!==o)return[i,s,n,o]}),MinScaleDenominator:(0,a.makeObjectPropertySetter)(l.readDecimal),MaxScaleDenominator:(0,a.makeObjectPropertySetter)(l.readDecimal),Layer:(0,a.makeObjectPropertyPusher)(D)}),T=(0,a.makeStructureNS)(u,{Title:(0,a.makeObjectPropertySetter)(l.readString),OnlineResource:(0,a.makeObjectPropertySetter)(o.readHref),LogoURL:(0,a.makeObjectPropertySetter)(z)}),C=(0,a.makeStructureNS)(u,{westBoundLongitude:(0,a.makeObjectPropertySetter)(l.readDecimal),eastBoundLongitude:(0,a.makeObjectPropertySetter)(l.readDecimal),southBoundLatitude:(0,a.makeObjectPropertySetter)(l.readDecimal),northBoundLatitude:(0,a.makeObjectPropertySetter)(l.readDecimal)}),P=(0,a.makeStructureNS)(u,{GetCapabilities:(0,a.makeObjectPropertySetter)(G),GetMap:(0,a.makeObjectPropertySetter)(G),GetFeatureInfo:(0,a.makeObjectPropertySetter)(G)}),R=(0,a.makeStructureNS)(u,{Format:(0,a.makeObjectPropertyPusher)(l.readString),DCPType:(0,a.makeObjectPropertyPusher)(function(e,t){return(0,a.pushParseAndPop)({},I,e,t)})}),I=(0,a.makeStructureNS)(u,{HTTP:(0,a.makeObjectPropertySetter)(function(e,t){return(0,a.pushParseAndPop)({},L,e,t)})}),L=(0,a.makeStructureNS)(u,{Get:(0,a.makeObjectPropertySetter)(F),Post:(0,a.makeObjectPropertySetter)(F)}),O=(0,a.makeStructureNS)(u,{Name:(0,a.makeObjectPropertySetter)(l.readString),Title:(0,a.makeObjectPropertySetter)(l.readString),Abstract:(0,a.makeObjectPropertySetter)(l.readString),LegendURL:(0,a.makeObjectPropertyPusher)(z),StyleSheetURL:(0,a.makeObjectPropertySetter)(F),StyleURL:(0,a.makeObjectPropertySetter)(F)}),M=(0,a.makeStructureNS)(u,{Format:(0,a.makeObjectPropertySetter)(l.readString),OnlineResource:(0,a.makeObjectPropertySetter)(o.readHref)}),k=(0,a.makeStructureNS)(u,{Keyword:(0,a.makeArrayPusher)(l.readString)});function N(e,t,r=!0){let i={extent:[(0,l.readDecimalString)(e.getAttribute("minx")),(0,l.readDecimalString)(e.getAttribute("miny")),(0,l.readDecimalString)(e.getAttribute("maxx")),(0,l.readDecimalString)(e.getAttribute("maxy"))],res:[(0,l.readDecimalString)(e.getAttribute("resx")),(0,l.readDecimalString)(e.getAttribute("resy"))]};return r&&(h(t)?i.crs=e.getAttribute("CRS"):i.srs=e.getAttribute("SRS")),i}function D(e,t){let r=h(t),i=t[t.length-1],s=(0,a.pushParseAndPop)({},r?A:E,e,t);if(!s)return;let n=(0,l.readBooleanString)(e.getAttribute("queryable"));void 0===n&&(n=i.queryable),s.queryable=void 0!==n&&n;let o=(0,l.readNonNegativeIntegerString)(e.getAttribute("cascaded"));void 0===o&&(o=i.cascaded),s.cascaded=o;let u=(0,l.readBooleanString)(e.getAttribute("opaque"));void 0===u&&(u=i.opaque),s.opaque=void 0!==u&&u;let c=(0,l.readBooleanString)(e.getAttribute("noSubsets"));void 0===c&&(c=i.noSubsets),s.noSubsets=void 0!==c&&c;let d=(0,l.readDecimalString)(e.getAttribute("fixedWidth"));d||(d=i.fixedWidth),s.fixedWidth=d;let p=(0,l.readDecimalString)(e.getAttribute("fixedHeight"));p||(p=i.fixedHeight),s.fixedHeight=p;let f=["Style","AuthorityURL"];r?f.push("CRS"):f.push("SRS","Dimension"),f.forEach(function(e){if(e in i){let t=s[e]||[];s[e]=t.concat(i[e])}});let m=["BoundingBox","Attribution"];return r?m.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):m.push("LatLonBoundingBox","ScaleHint","Extent"),m.forEach(function(e){if(!(e in s)){let t=i[e];s[e]=t}}),s}function F(e,t){return(0,a.pushParseAndPop)({},M,e,t)}function G(e,t){return(0,a.pushParseAndPop)({},R,e,t)}function z(e,t){let r=F(e,t);if(r){let t=[(0,l.readNonNegativeIntegerString)(e.getAttribute("width")),(0,l.readNonNegativeIntegerString)(e.getAttribute("height"))];return r.size=t,r}}function q(e,t){return(0,a.pushParseAndPop)([],k,e,t)}var j=m}),n("2NQly",function(e,t){var r=s("205E0"),i=s("cpPSZ"),a=s("3SMVV"),n=s("2K2IB"),o=s("jZquI"),l=s("gzr8q"),u=s("3VGVQ");r.default.prototype.getPreview=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAk6QAAJOkBUCTn+AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVHic7ZpPiE1RHMc/780MBhkik79JSUlIUbOxI+wkI2yRhYSUlJLNpJF/xcpiJBmZGBZsNM1CkmhKITGkGbH0/BuPmXnP4rxbb/TOn3fvOffeec6nfqvb/b7f93fveeec37ng8Xg8Ho/nf6Uu4d+fDswFssCvhHOJhaXAMeApMAQUyyIPPAdOAiuTStAVy4EHjDWsix5gdRLJ2mY34ulWYz6IEeA4kIk9awtkgTOEM/5vdAKT4k0/Ou3YMR/ELcbRm9AKFLBbgCJwNE4TYZkJfMG++SIwDCyLz0o4bI17WdyJz0r1TAZ+oDcxCBwAFgIzEIuhvcBbg3sLwOK4DFXLFvQGniCGSSUagS4DjUPOHESkA3XiOWCORqMR6Nfo9DjI3QqPUSd+ylBnv0Zn0GrWFvmIOvGNhjqrNDp/EAutyFgRKUM2tgO+Gur81FxvAKYZaimxXYBvmuuLDHWWaK4X0RfJCNsF6NdcbzXU2a65PohYFKWOc+jn8PUajbWIXaBKp9NB7lZYh34OzwFbFfd/NtDYYSth27urLGIm0M31AL3APWAAmIooymaDnPIl/Vz4NN1yHrd7gcvxWQnHAuA3bsyPop8hUsE13BSgK04TUViBeFo2zedJ8S6wElexW4D2eNOPTjNi6WvD/DtEr8E6tk6GGoAmxFY2iFHE9NZiQf8gogiB9gTEH23izAZuE77vHyU+ANucO1QwD3hD/MbLowAcdm20EmkwXx4n3NodS9rMB2HabYpEWs0HcRqHp0fNwAvJD+eBTZr7p6BvmQVxUaEzEbiruNfJekH15L8jtrEm7JJolEcOmKXRqQOuKDQuY7HZY8s8iNfzkSLxIuI43FTrkkLnOlBfRW4VsWk+oAX5weknxFAxJQNckGgVgZuIRVoomoGXEmGTMa+iQ6K7M4SW7k24QYgiuDQPYinbhugiF4H3RGtzZYCzyIvQXfpNI1ybLyeLpf5+iTbkRbiP2EcocTHm4+YI8iI8RFHwWjAfsA95Q+YZFU6wasl8wB7kReijtNbIILa0vcg/PRlGfPQwHmlCviDqAzaA+OREtzqr1ejOIDorxlNEjTGUBV4nnUWCvAJxGDlA8q9j3DEArAn2zvXAfOwfl6eVAmJrPpJ0Ih6Px+PxeJLjLwPul3vj5d0eAAAAAElFTkSuQmCC"},i.default.prototype.getPreview=function(e,t){e||(e=[21020,6355964]),t||(t=150);var r=this.getTileGrid().getTileCoordForCoordAndResolution(e,t);return this.getTileUrlFunction().call(this,r,this.getProjection())},a.default.prototype.getPreview=function(e,t){e||(e=[21020,6355964]),t||(t=150);var r=this.getTileUrlFunction();if(r){var i=(this.getTileGrid()||this.getTileGridForProjection(this.getProjection())).getTileCoordForCoordAndResolution(e,t);return r.call(this,i,1,this.getProjection())}return(this.getGetFeatureInfoUrl?this.getGetFeatureInfoUrl(e,t,this.getProjection()||"EPSG:3857",{}):this.getFeatureInfoUrl(e,t,this.getProjection()||"EPSG:3857",{})).replace(/getfeatureinfo/i,"GetMap")},n.default.prototype.getPreview=function(e,t,r){if(this.get("preview"))return[this.get("preview")];if(t||(t=150),t<this.getMinResolution()||t>this.getMaxResolution()){var i=this.getMinResolution(),a=this.getMaxResolution();for(a>1e5&&(a=156543),i<.15&&(i=.15),t=a;a>i;)i*=2,a/=2,t=i}var s=this.getExtent();if(e||(e=[21020,6355964]),s&&!(0,o.containsCoordinate)(s,e)&&(e=[(s[0]+s[2])/2,(s[1]+s[3])/2]),r&&(e=(0,l.transform)(e,r,this.getSource().getProjection())),this.getSource&&this.getSource())try{return[this.getSource().getPreview(e,t)]}catch(e){}return[]},u.default.prototype.getPreview=function(e,t){if(this.get("preview"))return[this.get("preview")];var r=[];if(this.getLayers)for(var i=this.getLayers().getArray(),a=0;a<i.length;a++)r=r.concat(i[a].getPreview(e,t));return r}}),n("DXhxE",function(e,r){t(e.exports,"default",()=>n);var i=s("6vpLi");class a extends i.default{constructor(e,t){super(),e&&this.read(e,t)}}a.prototype.read=function(e,t){t=t||{},e.setProjection(t.proj||"EPSG:4326"),e.set("unit",t.unit||"dms")},a.prototype.write=function(e){return{valeur:e.getProjection().getCode(),unite:e.get("units")}};var n=a}),n("iKsmi",function(e,r){t(e.exports,"default",()=>o);var i=s("6vpLi"),a=s("dKl6q");class n extends i.default{constructor(e,t,r,i){super(),e&&this.read(e,t,r,i)}}n.prototype.read=function(e,t,r,i){new a.default(e.getLegend(),t,r,i),r||e.collapse(!t.collapsed)},n.prototype.write=function(e){let t=new(0,a.default)().write(e.getLegend());return t.legendVisible=!e.isCollapsed(),t};var o=n}),n("1RZpL",function(e,r){t(e.exports,"upgradeCarte",()=>n);var i=s("5y4py"),a=s("gH2ps");function n(e){(0,i.carteV4)(e),(0,a.carteGPF)(e)}}),n("5y4py",function(e,r){t(e.exports,"carteV4",()=>l),t(e.exports,"storyV4",()=>u);var i=s("bzSwf"),a=s("lqNjm"),n=s("bqoF2");function o(e){return!!("string"==typeof e?parseInt(e):e)}function l(e){if(console.log(JSON.parse(JSON.stringify(e))),e.version>4)return;e.version=4.01,e.param.title=e.param.titre;let t=e.param.controlParams;e.controls={zoom:o(t.zoomBtn),scaleLine:o(t.scaleLine),searchBar:o(t.pSearchBar),layerSwitcher:o(t.selectLayer),locate:o(t.geoloc),profil:o(t.profil),printDlg:o(t.printDlg)},o(t.coords)?e.controls.mousePosition={proj:e.param.proj.valeur,unit:"ds"===e.param.proj.unite?"dms":"dec"}:e.controls.mousePosition=!1,e.legende||(e.legende={}),e.controls.legend={title:e.legende.title||e.legende.legendtitle,visible:t.legend||!1,collapsed:e.legende.legendVisible||!1,width:e.legende.legendWidth||300,lineHeight:e.legende.lineHeight||55,items:e.legende.items||e.legende.legend||[]},["titre","status","controlParams","proj"].forEach(t=>delete e.param[t]),delete e.legende;let r=[];e.symbolLib&&Object.keys(e.symbolLib).forEach(t=>r.push(e.symbolLib[t])),e.symbolLib=r,e.layers.forEach((t,r)=>{t.wms&&"Plan IGN niveaux de gris"===t.name&&(e.layers[r]={description:n.default.capabilities["GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2"].desc,layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.NIVEAUXGRIS",name:t.name,opacity:t.opacity,titre:t.titre,type:"Geoportail",visibility:t.visibility})}),console.log("CARTE:",e)}function u(e){if(!(e.version>4)){var t;if(console.log(JSON.parse(JSON.stringify(e))),e.version=4.01,e.type=e.modele.type,e.param={title:e.infos.title,subTitle:e.infos.subTitle,logo:e.infos.logo,showTitle:e.infos.visibility,description:e.infos.description,lon:e.cartes.lon,lat:e.cartes.lat,rot:e.cartes.rot,zoom:e.cartes.zoom,synchronize:e.cartes.synchronize},e.layout={theme:(t=e.modele.theme,i.layout[t]?t:({custom:"custom",gris:"gray",vert:"green",brun:"braun",bleu:"blue",violet:"purple"})[t]||"blue"),photo:e.photo,colors:[],css:e.modele.css||"",voletPosition:e.volet?e.volet.position.replace("gauche","left").replace("droite","right"):"right",voletWidth:parseInt(e.volet?e.volet.width:0)||250,compare:e.compare?e.compare.pos:""},e.modele.bColor&&e.layout.colors.push((0,a.asArray)(e.modele.bColor)),e.modele.fColor&&e.layout.colors.push((0,a.asArray)(e.modele.fColor)),e.compare?(e.cartes=[{title:e.compare.map1_titre,id:e.compare.map1,layers:e.compare.layer1},{title:e.compare.map2_titre,id:e.compare.map2,layers:e.compare.layer2}],e.param.lon=e.compare.lon,e.param.lat=e.compare.lat,e.param.zoom=e.compare.zoom):e.cartes=[{title:e.cartes.name,id:e.cartes.idUniqueIFrame}],e.etapes&&(e.steps=[],e.etapes.sort.forEach(t=>{e.steps.push(e.etapes[t])}),e.animStep=e.etapes.anim),e.tools=e.ifrTools,e.controls={zoom:o(e.controls.zoom),scaleLine:o(e.controls.scale),rotation:o(e.controls.rotation),searchBar:o(e.controls.search),layerSwitcher:o(e.controls.lswitcher),switcherModel:e.controls.switcherModel,locate:o(e.controls.geoloc),profil:o(e.controls.profil),printDlg:o(e.ifrTools.print),mousePosition:o(e.controls.coordinates),legend:e.controls.legende?e.controls.legende[0]:o(e.controls.legende)},e.bulle&&(e.bulle.type=(e.bulle.type||"default").replace("mainPopup","").trim()),e.popup={popup:e.bulle||{type:"default"},tips:e.tooltips},"onglet"===e.type){e.cartes=[];let t=e.onglets;e.tabs=[],t.sort.forEach(r=>{e.tabs.push({id:t[r].map,title:t[r].title,showTitle:t[r].showTitle,description:t[r].content})})}["modele","infos","volet","etapes","ifrTools","photo","bulle","tooltips","onglets"].forEach(t=>{delete e[t]})}}}),n("bzSwf",function(r,i){t(r.exports,"layout",()=>h),t(r.exports,"default",()=>c);var a=s("lqNjm"),n=s("4JxMN"),o=s("8SYbd");s("aWz1H");var l=s("DW21e");let u={'[data-role="storymap"] select':{color:"COLOR","background-color":"BGCOLOR"},'[data-role="storymap"]':{color:"COLOR","background-color":"BGCOLOR"},'[data-role="storymap"] .tabs:before':{color:"BGCOLOR"},'[data-role="storymap"] .tabs .header > div':{color:"COLOR","background-color":"BGCOLOR"},'[data-role="storymap"] .tabs .header > div.selected':{color:"BGCOLOR","background-color":"COLOR"},'[data-role="storymap"] .volet':{color:"VOLETCOLOR","background-color":"BGVOLETCOLOR"},'[data-role="storymap"] .volet button.popup-prev:focus-visible, [data-role="storymap"] .volet button.popup-next:focus-visible':{color:"BGVOLETCOLOR","background-color":"VOLETCOLOR"},'[data-role="storymap"] .ol-popup button.popup-prev, [data-role="storymap"] .ol-popup button.popup-next':{color:"currentColor"},'[data-role="storymap"] .ol-popup button.popup-prev:focus-visible, [data-role="storymap"] .ol-popup button.popup-next:focus-visible':{color:"BGCOLOR","background-color":"COLOR"},'[data-role="storymap"] .volet .pages button:hover, [data-role="storymap"] .volet .pages button:focus, [data-role="storymap"] .volet .pages button.active':{color:"BGVOLETCOLOR","background-color":"VOLETCOLOR","border-color":"VOLETCOLOR"},'[data-role="storymap"] .volet .content .toc li:hover, [data-role="storymap"] .tools > div:hover':{color:"BGVOLETCOLOR","background-color":"VOLETCOLOR"},'[data-role="storymap"] .tools > .select':{color:"BGVOLETCOLOR","background-color":"VOLETCOLOR"},'[data-role="storymap"] .title > img':{color:"BGCOLOR"},'[data-role="storymap"] .map button':{color:"COLOR","background-color":"BGCOLOR_08"},'[data-role="storymap"] .map button:focus, [data-role="storymap"] .map button:hover':{"background-color":"BGCOLOR"},'[data-role="storymap"] .ol-layerswitcher':{color:"DARKCOLOR"},'[data-role="storymap"] .ol-search li.copy':{"background-color":"DARKCOLOR",opacity:".65"},'.ol-ext-print-dialog button[type="submit"], .ol-ext-print-dialog .ol-saveas select, .ol-ext-print-dialog .ol-savelegend select':{"background-color":"DARKCOLOR",opacity:".65"},".carte-info-dialog .permalink, .ol-ext-dialog.mapInfo > form .ol-buttons input:hover":{"background-color":"LIGHTCOLOR"},".ol-control.ol-bar .ol-toggle.ol-active > button, .ol-control.ol-bar .ol-toggle.ol-active button:hover":{color:"DARKCOLOR","background-color":"LIGHTCOLOR"},".ol-control.ol-bar .ol-option-bar:before":{"border-color":"transparent transparent DARKCOLOR"},".ol-control.ol-bar .ol-control.ol-text-button div:hover, .ol-control.ol-bar .ol-control.ol-text-button > div":{color:"DARKCOLOR","background-color":"LIGHTCOLOR"},'[data-role="storymap"] .map, .ol-ext-dialog.mapInfo':{color:"DARKCOLOR"},".ol-ext-dialog.mapInfo a":{color:"DARKCOLOR"}},h={default:[[255,255,255],[33,33,33]],gray:[[255,255,255],[102,102,102],[32,32,32],[210,210,210]],green:[[153,207,192],[255,255,255],null,null,[57,121,103],[206,232,227]],braun:[[54,44,42],[226,192,179],null,null,[54,44,42],[249,242,240]],blue:[[255,255,255],[51,102,153],(0,n.darkenColor)([51,102,153]),[185,198,210]],purple:[[144,104,190],[110,211,207],null,null,[144,104,190]]};var c=function(t){if("string"==typeof t&&(t=h[t]),!t)return(0,n.default)("*",null),[[33,33,33],[255,255,255]];let r=t[0],i=t[1];if(!i){i=e(o)(r).brighten(2).rgb();var s=(0,l.toHSL)(i)[2]-(0,l.toHSL)(r)[2];(0,l.toHSL)(r)[2]>40&&s<40&&(i=e(o)(r).darken(2).rgb()),(0,l.toHSL)(r)[2]<40&&s<40&&(i=e(o)(r).brighten(3).rgb())}let c=t[2]||e(o)(r).darken(2).rgb(),d=t[3]||e(o)(r).set("hsl.l",.8).set("hsl.s",.05).rgb(),p=t[4]||i,f=Math.min(60,255-Math.max(r[0],r[1],r[2])),m=t[5]||[Math.min(255,r[0]+f),Math.min(255,r[1]+f),Math.min(255,r[2]+f)];for(let e in u){let t=Object.assign({},u[e]),s=[5,8,10];for(let e in t)s.forEach(s=>{r[3]=s/10;let n=RegExp("BGCOLOR"+(10===s?"":"_0"+s),"g");t[e]=t[e].replace(n,(0,a.asString)(r)),c[3]=s/10,n=RegExp("DARKCOLOR"+(10===s?"":"_0"+s),"g"),t[e]=t[e].replace(n,(0,a.asString)(c)),d[3]=s/10,n=RegExp("LIGHTCOLOR"+(10===s?"":"_0"+s),"g"),t[e]=t[e].replace(n,(0,a.asString)(d)),m[3]=s/10,n=RegExp("BGVOLETCOLOR"+(10===s?"":"_0"+s),"g"),t[e]=t[e].replace(n,(0,a.asString)(m)),p[3]=s/10,n=RegExp("VOLETCOLOR"+(10===s?"":"_0"+s),"g"),t[e]=t[e].replace(n,(0,a.asString)(p)),i[3]=s/10,n=RegExp("COLOR"+(10===s?"":"_0"+s),"g"),t[e]=t[e].replace(n,(0,a.asString)(i))});(0,n.default)(e,t)}return t}}),n("4JxMN",function(e,r){t(e.exports,"darkenColor",()=>o),t(e.exports,"default",()=>l);var i=document.createElement("style");i.setAttribute("type","text/css"),document.body?document.body.appendChild(i):document.head.appendChild(i);let a=[];function s(e,t){for(var r=0;r<a.length;r++)if(a[r].selector===e&&a[r].property===t)return r;return -1}function n(){var e="\n";a.forEach(function(t){e+=t.selector+" {"+t.property+":"+t.value+"; }\n"}),i.innerHTML=e}function o(e,t){return void 0===t&&(t=Math.min(e[0],e[1],e[2])),function(e,t){void 0===t&&(t=Math.min(128,255-Math.max(e[0],e[1],e[2])));let r=[];for(let i=0;i<3;i++)r[i]=Math.max(0,Math.min(255,e[i]+(t||5)));return r}(e,-(t||5))}window.getR=function(){return a};var l=function(e,t,r){var i=t;if("*"===e&&null===t)a=[],n();else if(void 0===t){var o={};return a.forEach(function(t){t.selector===e&&(o[t.property]=t.value)}),o}else if("string"==typeof t){if(void 0===r){var l=s(e,t);return l<0?null:a[l].value}(i={})[t]=r}for(var u in i)!function(e,t,r){var i=s(e,t);i>=0&&a.splice(i,1),r&&a.push({selector:e,property:t,value:r})}(e,u,i[u]);n()}}),n("DW21e",function(e,r){t(e.exports,"toHSL",()=>a),t(e.exports,"toHSV",()=>n),t(e.exports,"fromHSV",()=>o),t(e.exports,"toHexa",()=>l);var i=s("lqNjm"),a=function(e,t){void 0===t&&(t=100),Array.isArray(e)||(e=(0,i.asArray)(e));var r,a,s=e[0]/255,n=e[1]/255,o=e[2]/255,l=Math.max(s,n,o),u=Math.min(s,n,o),h=(l+u)/2;if(l===u)r=a=0;else{var c=l-u;switch(a=h>.5?c/(2-l-u):c/(l+u),l){case s:r=(n-o)/c+(n<o?6:0);break;case n:r=(o-s)/c+2;break;case o:r=(s-n)/c+4}}var d=[Math.round(60*r*t)/t,Math.round(100*a*t)/t,Math.round(100*h*t)/t];return e.length>3&&(d[3]=e[3]),d},n=function(e,t){void 0===t&&(t=100),Array.isArray(e)||(e=(0,i.asArray)(e));var r,a=e[0]/255,s=e[1]/255,n=e[2]/255,o=Math.max(a,s,n),l=Math.min(a,s,n),u=o-l;if(o==l)r=0;else switch(o){case a:r=(s-n)/u+(s<n?6:0);break;case s:r=(n-a)/u+2;break;case n:r=(a-s)/u+4}var h=[Math.round(60*r*t)/t,Math.round(100*(0==o?0:u/o)*t)/t,Math.round(100*o*t)/t];return e.length>3&&(h[3]=e[3]),h},o=function(e,t){void 0===t&&(t=1e3);var r,i,a,s=e[0]/360,n=e[1]/100,o=e[2]/100,l=Math.floor(6*s),u=6*s-l,h=o*(1-n),c=o*(1-u*n),d=o*(1-(1-u)*n);switch(l%6){case 0:r=o,i=d,a=h;break;case 1:r=c,i=o,a=h;break;case 2:r=h,i=o,a=d;break;case 3:r=h,i=c,a=o;break;case 4:r=d,i=h,a=o;break;case 5:r=o,i=h,a=c}var p=[Math.round(255*r*t)/t,Math.round(255*i*t)/t,Math.round(255*a*t)/t];return e.length>3&&(p[3]=e[3]),p},l=function(e){return"#"+(16777216+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1)}}),n("gH2ps",function(e,r){t(e.exports,"carteGPF",()=>i);function i(e){e.layers.forEach(e=>{switch(e.type){case"WMTS":e.wmtsparam.source.url=e.wmtsparam.source.url.replace(/^https:\/\/wxs.ign.fr\/([^\/]*)\/geoportail\/wmts/,"https://data.geopf.fr/wmts"),e.wmtsparam.data.legend&&e.wmtsparam.data.legend.length&&e.wmtsparam.data.legend[0].replace&&(e.wmtsparam.data.legend[0]=e.wmtsparam.data.legend[0].replace(/^https:\/\/wxs.ign.fr\/static\/legends/,"https://data.geopf.fr/annexes/ressources/legendes"));break;case"WMS":e.wmsparam.source.url=e.wmsparam.source.url.replace(/^https:\/\/wxs.ign.fr\/[^\/]*\/geoportail\/([r|v])\/wms/,"https://data.geopf.fr/wms-$1/wms"),e.wmsparam.legend&&e.wmsparam.legend.length&&e.wmsparam.legend[0].url&&e.wmsparam.legend[0].url.replace&&(e.wmsparam.legend[0]=e.wmsparam.legend[0].url.replace(/^https:\/\/wxs.ign.fr\/static\/legends/,"https://data.geopf.fr/annexes/ressources/legendes"));break;case"WFS":e.url&&e.url.replace&&(e.url=e.url.replace(/^https:\/\/wxs.ign.fr\/([^\/]*)\/geoportail\/wfs/,"https://data.geopf.fr/wfs/ows"));break;case"MVT":e.url&&e.url.replace&&(e.url=e.url.replace(/^https:\/\/wxs.ign.fr\/static/,"https://data.geopf.fr/annexes/ressources").replace(/\/essentiels/,""))}e.legend&&e.legend.items.forEach(e=>{e.src&&(e.src=e.src.replace(/^https:\/\/wxs.ign.fr\/static\/legends/,"https://data.geopf.fr/annexes/ressources/legendes"))})})}}),n("2x3of",function(e,r){t(e.exports,"default",()=>u);var i=s("5MXCy"),a=s("jPVWI"),n=s("20LS2"),o=s("5TDW7");class l extends o.default{constructor(){super()}}l.prototype.read=function(e){if("file"!==e.type)return!1;let t=new a.default({source:new n.default});return this.readOptions(t,e),t.set("url",e.url),t.set("extractStyles",e.extractStyles),fetch(e.url).then(e=>e.text()).then(r=>{let a=new i.default().readFeatures(r,{featureProjection:"EPSG:3857",extractStyles:e.extractStyles});a.length?(t.getSource().dispatchEvent("featuresloadstart"),t.getSource().addFeatures(a),t.getSource().dispatchEvent("featuresloadend")):t.getSource().dispatchEvent("featuresloaderror")}).catch(()=>{t.getSource().dispatchEvent("featuresloaderror")}),t},l.prototype.write=function(e){return"file"!==e.get("type")?null:this.writeOptions(e,{url:e.get("url"),extractStyles:!!e.get("extractStyles")})};var u=l}),n("c614M",function(e,r){t(e.exports,"default",()=>o);var i=s("4mOxN"),a=s("lMv07");class n extends a.default{constructor(){super()}}n.prototype.read=function(e){if("report"!==e.type)return!1;let t=new i.default(e);return this.readOptions(t,e),this.readFeatures(t,e)},n.prototype.write=function(e){if("report"!==e.get("type"))return null;let t=this.writeOptions(e,{communities:e.get("communities"),status:e.get("status"),date:e.get("date"),maxFeatures:e.get("maxFeatures")});return this.writeFeatures(e,t)};var o=n}),n("4mOxN",function(e,r){t(e.exports,"default",()=>h);var i=s("jPVWI"),a=s("iGyOD"),n=s("j2K3b"),o=s("20LS2");class l extends i.default{constructor(e){super({title:e.title||"Signalements",communities:e.communities,status:e.status,date:e.date,maxFeatures:e.maxFeatures||1e3,source:new o.default}),this.set("type","report")}getUrl(e,t){let r=this.getProperties(),i="https://espacecollaboratif.ign.fr/gcms/api/reports?limit=100&sort=updating_date:DESC";return r.communities&&(i+="&communities="+r.communities),r.status.forEach(e=>{i+="&status[]="+e}),e&&(i+="&page="+e),t&&(i+="&updating_date="+t),i}reload(e){this.getSource().clear(),this.set("date",new Date().toISOString().split("T").shift()),function e(t,r,i){let a=t.getSource(),s=t.getProperties();i=i||1;let n=t.getUrl(i);fetch(n).then(e=>e.json()).then(n=>{let o=a.getFeatures().length,l=[];n.forEach(e=>{if(s.maxFeatures<=l.length+o)return;let t=u(e);l.push(t)});let h={type:"reading",nb:a.getFeatures().length+l.length,max:s.maxFeatures,finish:!(n.length&&s.maxFeatures>100*i)};r&&!1===r(h)&&(h.finish=!0),h.finish||(e(t,r,i+1),a.dispatchEvent(h)),a.addFeatures(l)})}(this,e)}update(e){(function e(t,r,i,a){a=a||[],i=i||1;let s=t.getUrl(i,t.get("date"));fetch(s).then(e=>e.json()).then(s=>{if(s.length)s.forEach(e=>{let t=u(e);a.unshift(t)}),e(t,r,++i,a),r&&r({type:"updating",nb:a.length,finish:!1});else{let e=t.getProperties(),i=t.getSource(),s={};if(i.getFeatures().forEach(e=>{s[e.get("id")]=e}),a.forEach(r=>{let a=s[r.get("id")];a&&i.removeFeature(a),(!e.status.length||e.status.indexOf(r.get("status"))>-1)&&(i.addFeature(r),s[r.get("id")]=r),t.set("date",new Date().toISOString().split("T").shift())}),r){let e={type:"updating",finish:!0};i.dispatchEvent(e),r(e)}}})})(this,e)}}function u(e){let t=e.geometry.replace(/POINT\(|\)/g,"").split(" ").map(e=>Number(e)),r=new a.default(new(0,n.default)(t).transform("EPSG:4326","EPSG:3857"));return["id","comment","author","community","status","validator","opening_date","updating_date","closing_date","input_device"].forEach(t=>{r.set(t,e[t])}),e.attachments.forEach(e=>{/jpg|gif|png/i.test(e.filename)&&r.set("img",e.uri)}),e.commune&&(r.set("commune",e.commune.title),r.set("insee",e.commune.name)),e.departement&&(r.set("departement",e.departement.title),r.set("id_dep",e.departement.name)),e.attributes.forEach(e=>{r.set("theme",e.theme),(Array.isArray(e.attributes)?e.attributes:[e.attributes]).forEach(e=>{for(let t in e)r.set(t,e[t])})}),r}var h=l}),n("l1YgS",function(e,r){t(e.exports,"default",()=>l);var i=s("eEuqc"),a=s("8MDYc"),n=s("5TDW7");class o extends n.default{constructor(){super()}}o.prototype.read=function(e){if("XYZ"!==e.type)return null;let t=new i.default({source:new a.default({url:e.url,minZoom:e.sourceMinZoom,maxZoom:e.sourceMaxZoom,crossOrigin:e.crossOrigin})});return t.getSource().set("minZoom",e.sourceMinZoom),t.getSource().set("maxZoom",e.sourceMaxZoom),this.readOptions(t,e),t},o.prototype.write=function(e){return"XYZ"!==e.get("type")?null:this.writeOptions(e,{url:e.getSource().getUrls()[0],sourceMinZoom:e.getSource().get("minZoom"),sourceMaxZoom:e.getSource().get("maxZoom"),crossOrigin:e.getSource().crossOrigin})};var l=o}),n("8MDYc",function(e,r){t(e.exports,"default",()=>o);var i=s("5NhYx"),a=s("42VYg");class n extends a.default{constructor(e){let t=void 0!==(e=e||{}).projection?e.projection:"EPSG:3857";super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:void 0!==e.tileGrid?e.tileGrid:(0,i.createXYZ)({extent:(0,i.extentFromProjection)(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize}),tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=void 0!==e.gutter?e.gutter:0}getGutter(){return this.gutter_}}var o=n}),n("eRyYI",function(e,r){t(e.exports,"default",()=>l);var i=s("37u5y"),a=s("5TDW7"),n=s("jPVWI");class o extends a.default{constructor(){super()}}o.prototype.read=function(e){if("WFS"!==e.type)return null;let t=new n.default({source:new i.default({url:e.url,typeName:e.typeName,tileZoom:e.tileZoom,outputFormat:e.format,version:e.version||"2.0.0"})});return t.setMinZoom(e.tileZoom),t.getSource().set("url",e.url),t.getSource().set("version",e.version),t.getSource().set("format",e.format),t.getSource().set("typeName",e.typeName),t.getSource().set("tileZoom",e.tileZoom),this.readOptions(t,e),t},o.prototype.write=function(e){if("WFS"!==e.get("type"))return null;let t=e.getSource();return this.writeOptions(e,{url:t.get("url"),typeName:t.get("typeName"),format:t.get("format"),version:t.get("version"),tileZoom:t.get("tileZoom")})};var l=o}),n("37u5y",function(e,r){t(e.exports,"default",()=>u);var i=s("20LS2"),a=s("gmEQj"),n=s("5NhYx"),o=s("kPMpK"),l=s("fkmMz"),u=class extends i.default{constructor(e){(e=e||{}).featureLimit||(e.featureLimit=1/0);var t=e.tileZoom||14,r={strategy:(0,a.tile)((0,n.createXYZ)({minZoom:t,maxZoom:t,tileSize:512}))},i=new o.default,s=new URL(e.url),l=s.search.replace(/^\?/,"").split("&");s=s.origin+s.pathname;var u=/^service$|^request$|^version$|^typename$|^outputFormat$|^maxFeatures$|^bbox$|^srsname$/i;l.forEach(function(e){var t=e.split("=")[0];u.test(t)||(s+=(/\?/.test(s)?"&":"?")+e)}),s=s+(/\?/.test(s)?"&":"?")+"service=WFS&request=GetFeature&version="+(e.version||"1.1.0")+"&typename="+(e.typeName||"")+"&outputFormat="+(e.outputFormat||"application/json"),e.maxFeatures&&(s+="&maxFeatures="+e.maxFeatures+"&count="+e.maxFeatures);var h={loading:0,loaded:0};r.loader=function(t,r,a){h.loading===h.loaded&&(h.loading=h.loaded=0,this.getFeatures().length>e.maxFeatures&&(this.clear(),this.refresh())),h.loading++,this.dispatchEvent({type:"tileloadstart",loading:h.loading,loaded:h.loaded}),this._loadTile(this._url,t,a,i,h)},super(r),this._url=s,this.set("pagination",e.pagination)}_loadTile(e,t,r,i,a){var s=e+"&srsname="+r.getCode()+"&bbox="+t.join(",")+","+r.getCode();this.get("pagination")&&!/&startIndex/.test(e)&&(s+="&startIndex=0"),(0,l.default).get({url:s,success:(function(s){if(a.loaded++,s.error)this.dispatchEvent({type:"tileloaderror",error:s,loading:a.loading,loaded:a.loaded});else{var n=i.readFeatures(s,{featureProjection:r});n.length>0&&this.addFeatures(n);let o=s.numberReturned||0;/&startIndex/.test(e)&&(o+=parseInt(e.replace(/.*&startIndex=(\d*).*/,"$1")),e=e.replace(/&startIndex=(\d*)/,"")),o<s.totalFeatures?this.get("pagination")?(e+="&startIndex="+o,a.loaded--,this._loadTile(e,t,r,i,a)):(this.dispatchEvent({type:"overload",total:s.totalFeatures,returned:s.numberReturned}),this.dispatchEvent({type:"tileloadend",loading:a.loading,loaded:a.loaded})):this.dispatchEvent({type:"tileloadend",loading:a.loading,loaded:a.loaded})}}).bind(this),error:(function(e){a.loaded++,this.dispatchEvent({type:"tileloaderror",error:e,loading:a.loading,loaded:a.loaded})}).bind(this)})}}}),n("4Esdr",function(e,r){t(e.exports,"default",()=>l);var i=s("5TDW7"),a=s("1NiL5");s("bOnvE");var n=s("91mNM");class o extends i.default{constructor(){super()}}o.prototype.read=function(e){let t,r;if("MVT"!==e.type)return null;try{e.mbstyle&&(t=JSON.parse(e.mbstyle))}catch(e){}if(t&&Object.keys(t.sources).length>1)(r=new n.default({title:e.title,mapLibreOptions:{style:t},attributions:e.copyright})).set("style",e.mbstyle);else if(r=new a.default({title:e.title,url:e.url,attributions:e.copyright}),e.mbstyle)try{r.set("style",e.mbstyle);let i=t;r.applyStyle(i)}catch(e){}return this.readOptions(r,e),r},o.prototype.write=function(e){return"MVT"!==e.get("type")?null:this.writeOptions(e,{title:e.get("title"),url:e.get("styleUrl"),mbstyle:e.get("style")})};var l=o}),n("bOnvE",function(e,r){t(e.exports,"MapLibreLayer",()=>s("91mNM").default),s("91mNM"),s("7mWsz"),s("kol5K")}),n("91mNM",function(e,r){t(e.exports,"default",()=>c);var i=s("de0To"),a=s("2K2IB"),n=s("iTTi2"),o=s("ejLRd"),l=s("205E0"),u=s("7mWsz"),h=s("kol5K");class c extends a.default{mapLibreMap;loaded=!1;olListenersKeys=[];constructor(e){super({source:new l.default({attributions:()=>(0,h.default)(this.mapLibreMap)}),...e})}disposeInternal(){(0,o.unByKey)(this.olListenersKeys),this.loaded=!1,this.mapLibreMap&&(this.mapLibreMap.triggerRepaint=()=>{},this.mapLibreMap.remove()),super.disposeInternal()}setMapInternal(e){super.setMapInternal(e),e?this.loadMapLibreMap():this.dispose()}loadMapLibreMap(){this.loaded=!1;let e=this.getMapInternal();if(e&&this.olListenersKeys.push(e.on("change:target",this.loadMapLibreMap.bind(this))),!e?.getTargetElement())return;if(!this.getVisible()){this.olListenersKeys.push(this.once("change:visible",this.loadMapLibreMap.bind(this)));return}let t=document.createElement("div");t.style.position="absolute",t.style.width="100%",t.style.height="100%";let r=this.get("mapLibreOptions");this.mapLibreMap=new i.Map(Object.assign({},r,{container:t,attributionControl:!1,interactive:!1,trackResize:!1})),this.mapLibreMap.on("sourcedata",()=>{this.getSource()?.refresh()}),this.mapLibreMap.once("load",()=>{this.loaded=!0,this.dispatchEvent(new n.default("load"))})}createRenderer(){return new u.default(this)}}}),n("de0To",function(e,t){e.exports,e.exports=function(){var e={},t={};function r(r,i,a){if(t[r]=a,"index"===r){var s="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",n={};return t.shared(n),t.index(e,n),"undefined"!=typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([s],{type:"text/javascript"}))),e}}return r("shared",["exports"],function(e){let t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v;function _(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})}function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e,t){this.x=e,this.y=t}"function"==typeof SuppressedError&&SuppressedError,b.prototype={clone:function(){return new b(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),i=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),i=Math.sin(e),a=t.y+i*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-i*(this.y-t.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},b.convert=function(e){return e instanceof b?e:Array.isArray(e)?new b(e[0],e[1]):e};var S,w,E,A,T=x(b);function C(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=i}C.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,i=0;i<8;i++){var a=this.sampleCurveX(r)-e;if(Math.abs(a)<t)return r;var s=this.sampleCurveDerivativeX(r);if(1e-6>Math.abs(s))break;r-=a/s}var n=0,o=1;for(r=e,i=0;i<20&&!(Math.abs((a=this.sampleCurveX(r))-e)<t);i++)e>a?n=r:o=r,r=.5*(o-n)+n;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var P=x(C);function R(){return null==t&&(t="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),t}function I(){if(null==r&&(r=!1,R())){let e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let t=0;t<25;t++){let r=4*t;e.fillStyle=`rgb(${r},${r+1},${r+2})`,e.fillRect(t%5,Math.floor(t/5),1,1)}let t=e.getImageData(0,0,5,5).data;for(let e=0;e<100;e++)if(e%4!=3&&t[e]!==e){r=!0;break}}}return r||!1}function L(e,t,r,i){let a=new P(e,t,r,i);return e=>a.solve(e)}let O=L(.25,.1,.25,1);function M(e,t,r){return Math.min(r,Math.max(t,e))}function k(e,t,r){let i=r-t,a=((e-t)%i+i)%i+t;return a===t?r:a}function N(e,...t){for(let r of t)for(let t in r)e[t]=r[t];return e}let D=1;function F(e,t,r){let i={};for(let r in e)i[r]=t.call(this,e[r],r,e);return i}function G(e,t,r){let i={};for(let r in e)t.call(this,e[r],r,e)&&(i[r]=e[r]);return i}function z(e){return Array.isArray(e)?e.map(z):"object"==typeof e&&e?F(e,z):e}let q={};function j(e){q[e]||("undefined"!=typeof console&&console.warn(e),q[e]=!0)}function B(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function U(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let H=null;function Z(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}let V="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Y(e,t,r,i,a){return _(this,void 0,void 0,function*(){if("undefined"==typeof VideoFrame)throw Error("VideoFrame not supported");let s=new VideoFrame(e,{timestamp:0});try{let n=null==s?void 0:s.format;if(!n||!n.startsWith("BGR")&&!n.startsWith("RGB"))throw Error(`Unrecognized format ${n}`);let o=n.startsWith("BGR"),l=new Uint8ClampedArray(i*a*4);if(yield s.copyTo(l,function(e,t,r,i,a){let s=4*Math.max(-t,0),n=(Math.max(0,r)-r)*i*4+s,o=Math.max(0,t),l=Math.max(0,r);return{rect:{x:o,y:l,width:Math.min(e.width,t+i)-o,height:Math.min(e.height,r+a)-l},layout:[{offset:n,stride:4*i}]}}(e,t,r,i,a)),o)for(let e=0;e<l.length;e+=4){let t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{s.close()}})}let W="AbortError";function $(){return Error(W)}let X={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function K(e){return X.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}let J="global-dispatcher";class Q extends Error{constructor(e,t,r,i){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=i}}let ee=()=>U(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,et=function(e,t){var r;if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){let r=K(e.url);if(r)return r(e,t);if(U(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:J},t)}if(!(/^file:/.test(r=e.url)||/^file:/.test(ee())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,t){return _(this,void 0,void 0,function*(){let r;let i=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:ee(),signal:t.signal});"json"!==e.type||i.headers.has("Accept")||i.headers.set("Accept","application/json");let a=yield fetch(i);if(!a.ok){let t=yield a.blob();throw new Q(a.status,a.statusText,e.url,t)}r="arrayBuffer"===e.type||"image"===e.type?a.arrayBuffer():"json"===e.type?a.json():a.text();let s=yield r;if(t.signal.aborted)throw $();return{data:s,cacheControl:a.headers.get("Cache-Control"),expires:a.headers.get("Expires")}})}(e,t);if(U(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:J},t)}return new Promise((r,i)=>{var a;let s=new XMLHttpRequest;for(let t in s.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(s.responseType="arraybuffer"),e.headers)s.setRequestHeader(t,e.headers[t]);"json"===e.type&&(s.responseType="text",(null===(a=e.headers)||void 0===a?void 0:a.Accept)||s.setRequestHeader("Accept","application/json")),s.withCredentials="include"===e.credentials,s.onerror=()=>{i(Error(s.statusText))},s.onload=()=>{if(!t.signal.aborted){if((s.status>=200&&s.status<300||0===s.status)&&null!==s.response){let t=s.response;if("json"===e.type)try{t=JSON.parse(s.response)}catch(e){return void i(e)}r({data:t,cacheControl:s.getResponseHeader("Cache-Control"),expires:s.getResponseHeader("Expires")})}else{let t=new Blob([s.response],{type:s.getResponseHeader("Content-Type")});i(new Q(s.status,s.statusText,e.url,t))}}},t.signal.addEventListener("abort",()=>{s.abort(),i($())}),s.send(e.body)})};function er(e){if(!e||0>=e.indexOf("://")||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;let t=new URL(e),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function ei(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function ea(e,t,r){if(r&&r[e]){let i=r[e].indexOf(t);-1!==i&&r[e].splice(i,1)}}class es{constructor(e,t={}){N(this,t),this.type=e}}class en extends es{constructor(e,t={}){super("error",N({error:e},t))}}class eo{on(e,t){return this._listeners=this._listeners||{},ei(e,t,this._listeners),this}off(e,t){return ea(e,t,this._listeners),ea(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},ei(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t))}fire(e,t){"string"==typeof e&&(e=new es(e,t||{}));let r=e.type;if(this.listens(r)){for(let t of(e.target=this,this._listeners&&this._listeners[r]?this._listeners[r].slice():[]))t.call(this,e);for(let t of this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[])ea(r,t,this._oneTimeListeners),t.call(this,e);let t=this._eventedParent;t&&(N(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),t.fire(e))}else e instanceof en&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var el={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let eu=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function eh(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!eh(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t||Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(!eh(e[r],t[r]))return!1;return!0}return e===t}function ec(e,t){e.push(t)}function ed(e,t,r){ec(r,{command:"addSource",args:[e,t[e]]})}function ep(e,t,r){ec(t,{command:"removeSource",args:[e]}),r[e]=!0}function ef(e,t,r,i,a,s){for(let n in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,n)&&(eh(e[n],t[n])||r.push({command:s,args:[i,n,t[n],a]}));for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&!Object.prototype.hasOwnProperty.call(e,n)&&(eh(e[n],t[n])||r.push({command:s,args:[i,n,t[n],a]}))}function em(e){return e.id}function eg(e,t){return e[t.id]=t,e}class ey{constructor(e,t,r,i){this.message=(e?`${e}: `:"")+r,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)}}function ev(e,...t){for(let r of t)for(let t in r)e[t]=r[t];return e}class e_ extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class ex{constructor(e,t=[]){for(let[r,i]of(this.parent=e,this.bindings={},t))this.bindings[r]=i}concat(e){return new ex(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let eb={kind:"null"},eS={kind:"number"},ew={kind:"string"},eE={kind:"boolean"},eA={kind:"color"},eT={kind:"object"},eC={kind:"value"},eP={kind:"collator"},eR={kind:"formatted"},eI={kind:"padding"},eL={kind:"resolvedImage"},eO={kind:"variableAnchorOffsetCollection"};function eM(e,t){return{kind:"array",itemType:e,N:t}}function ek(e){if("array"===e.kind){let t=ek(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}let eN=[eb,eS,ew,eE,eA,eR,eT,eM(eC),eI,eL,eO];function eD(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!eD(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind){for(let e of eN)if(!eD(e,t))return null}}return`Expected ${ek(e)} but found ${ek(t)} instead.`}function eF(e,t){return t.some(t=>t.kind===e.kind)}function eG(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}function ez(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}let eq=4/29,ej=6/29,eB=6/29*3*(6/29),eU=6/29*(6/29)*(6/29),eH=Math.PI/180,eZ=180/Math.PI;function eV(e){return(e%=360)<0&&(e+=360),e}function eY([e,t,r,i]){let a,s;let n=e$((.2225045*(e=eW(e))+.7168786*(t=eW(t))+.0606169*(r=eW(r)))/1);e===t&&t===r?a=s=n:(a=e$((.4360747*e+.3850649*t+.1430804*r)/.96422),s=e$((.0139322*e+.0971045*t+.7141733*r)/.82521));let o=116*n-16;return[o<0?0:o,500*(a-n),200*(n-s),i]}function eW(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function e$(e){return e>eU?Math.pow(e,1/3):e/eB+eq}function eX([e,t,r,i]){let a=(e+16)/116,s=isNaN(t)?a:a+t/500,n=isNaN(r)?a:a-r/200;return a=1*eJ(a),[eK(3.1338561*(s=.96422*eJ(s))-1.6168667*a-.4906146*(n=.82521*eJ(n))),eK(-.9787684*s+1.9161415*a+.033454*n),eK(.0719453*s-.2289914*a+1.4052427*n),i]}function eK(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function eJ(e){return e>ej?e*e*e:eB*(e-eq)}function eQ(e){return parseInt(e.padEnd(2,e),16)/255}function e0(e,t){return e1(t?e/100:e,0,1)}function e1(e,t,r){return Math.min(Math.max(t,e),r)}function e2(e){return!e.some(Number.isNaN)}let e5={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class e3{constructor(e,t,r,i=1,a=!0){this.r=e,this.g=t,this.b=r,this.a=i,a||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,t,r,i]))}static parse(e){if(e instanceof e3)return e;if("string"!=typeof e)return;let t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];let t=e5[e];if(t){let[e,r,i]=t;return[e/255,r/255,i/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){let t=e.length<6?1:2,r=1;return[eQ(e.slice(r,r+=t)),eQ(e.slice(r,r+=t)),eQ(e.slice(r,r+=t)),eQ(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){let t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){let[e,r,i,a,s,n,o,l,u,h,c,d]=t,p=[a||" ",o||" ",h].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){let e=[i,n,u].join(""),t="%%%"===e?100:""===e?255:0;if(t){let e=[e1(+r/t,0,1),e1(+s/t,0,1),e1(+l/t,0,1),c?e0(+c,d):1];if(e2(e))return e}}return}}let r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){let[e,t,i,a,s,n,o,l,u]=r,h=[i||" ",s||" ",o].join("");if("  "===h||"  /"===h||",,"===h||",,,"===h){let e=[+t,e1(+a,0,100),e1(+n,0,100),l?e0(+l,u):1];if(e2(e))return function([e,t,r,i]){function a(i){let a=(i+e/30)%12,s=t*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return e=eV(e),t/=100,r/=100,[a(0),a(8),a(4),i]}(e)}}}(e);return t?new e3(...t,!1):void 0}get rgb(){let{r:e,g:t,b:r,a:i}=this,a=i||1/0;return this.overwriteGetter("rgb",[e/a,t/a,r/a,i])}get hcl(){return this.overwriteGetter("hcl",function(e){let[t,r,i,a]=eY(e),s=Math.sqrt(r*r+i*i);return[Math.round(1e4*s)?eV(Math.atan2(i,r)*eZ):NaN,s,t,a]}(this.rgb))}get lab(){return this.overwriteGetter("lab",eY(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,i]=this.rgb;return`rgba(${[e,t,r].map(e=>Math.round(255*e)).join(",")},${i})`}}e3.black=new e3(0,0,0,1),e3.white=new e3(1,1,1,1),e3.transparent=new e3(0,0,0,0),e3.red=new e3(1,0,0,1);class e4{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class e6{constructor(e,t,r,i,a){this.text=e,this.image=t,this.scale=r,this.fontStack=i,this.textColor=a}}class e8{constructor(e){this.sections=e}static fromString(e){return new e8([new e6(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof e8?e:e8.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class e7{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof e7)return e;if("number"==typeof e)return new e7([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new e7(e)}}toString(){return JSON.stringify(this.values)}}let e9=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class te{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof te)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){let r=e[t],i=e[t+1];if("string"!=typeof r||!e9.has(r)||!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new te(e)}}toString(){return JSON.stringify(this.values)}}class tt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new tt({name:e,available:!1}):null}}function tr(e,t,r,i){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[e,t,r,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[e,t,r,i]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ti(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof e3||e instanceof e4||e instanceof e8||e instanceof e7||e instanceof te||e instanceof tt)return!0;if(Array.isArray(e)){for(let t of e)if(!ti(t))return!1;return!0}if("object"==typeof e){for(let t in e)if(!ti(e[t]))return!1;return!0}return!1}function ta(e){if(null===e)return eb;if("string"==typeof e)return ew;if("boolean"==typeof e)return eE;if("number"==typeof e)return eS;if(e instanceof e3)return eA;if(e instanceof e4)return eP;if(e instanceof e8)return eR;if(e instanceof e7)return eI;if(e instanceof te)return eO;if(e instanceof tt)return eL;if(Array.isArray(e)){let t;let r=e.length;for(let r of e){let e=ta(r);if(t){if(t===e)continue;t=eC;break}t=e}return eM(t||eC,r)}return eT}function ts(e){let t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof e3||e instanceof e8||e instanceof e7||e instanceof te||e instanceof tt?e.toString():JSON.stringify(e)}class tn{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ti(e[1]))return t.error("invalid value");let r=e[1],i=ta(r),a=t.expectedType;return"array"===i.kind&&0===i.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(i=a),new tn(i,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class to{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let tl={string:ew,number:eS,boolean:eE,object:eT};class tu{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,i=1,a=e[0];if("array"===a){let a,s;if(e.length>2){let r=e[1];if("string"!=typeof r||!(r in tl)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);a=tl[r],i++}else a=eC;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);s=e[2],i++}r=eM(a,s)}else{if(!tl[a])throw Error(`Types doesn't contain name = ${a}`);r=tl[a]}let s=[];for(;i<e.length;i++){let r=t.parse(e[i],i,eC);if(!r)return null;s.push(r)}return new tu(r,s)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(!eD(this.type,ta(r)))return r;if(t===this.args.length-1)throw new to(`Expected value to be of type ${ek(this.type)}, but found ${ek(ta(r))} instead.`)}throw Error()}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let th={"to-boolean":eE,"to-color":eA,"to-number":eS,"to-string":ew};class tc{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[0];if(!th[r])throw Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");let i=th[r],a=[];for(let r=1;r<e.length;r++){let i=t.parse(e[r],r,eC);if(!i)return null;a.push(i)}return new tc(i,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let i of this.args){if(t=i.evaluate(e),r=null,t instanceof e3)return t;if("string"==typeof t){let r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:tr(t[0],t[1],t[2],t[3])))return new e3(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new to(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let i=e7.parse(t);if(i)return i}throw new to(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let i=te.parse(t);if(i)return i}throw new to(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(let r of this.args){if(null===(t=r.evaluate(e)))return 0;let i=Number(t);if(!isNaN(i))return i}throw new to(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return e8.fromString(ts(this.args[0].evaluate(e)));case"resolvedImage":return tt.fromString(ts(this.args[0].evaluate(e)));default:return ts(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let td=["Unknown","Point","LineString","Polygon"];class tp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?td[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=e3.parse(e)),t}}class tf{constructor(e,t,r=[],i,a=new ex,s=[]){this.registry=e,this.path=r,this.key=r.map(e=>`[${e}]`).join(""),this.scope=a,this.errors=s,this.expectedType=i,this._isConstant=t}parse(e,t,r,i,a={}){return t?this.concat(t,r,i)._parse(e,a):this._parse(e,a)}_parse(e,t){function r(e,t,r){return"assert"===r?new tu(t,[e]):"coerce"===r?new tc(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let a=this.registry[i];if(a){let i=a.parse(e,this);if(!i)return null;if(this.expectedType){let e=this.expectedType,a=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==a.kind){if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==a.kind&&"string"!==a.kind){if("padding"!==e.kind||"value"!==a.kind&&"number"!==a.kind&&"array"!==a.kind){if("variableAnchorOffsetCollection"!==e.kind||"value"!==a.kind&&"array"!==a.kind){if(this.checkSubtype(e,a))return null}else i=r(i,e,t.typeAnnotation||"coerce")}else i=r(i,e,t.typeAnnotation||"coerce")}else i=r(i,e,t.typeAnnotation||"coerce")}else i=r(i,e,t.typeAnnotation||"assert")}if(!(i instanceof tn)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){let e=new tp;try{i=new tn(i.type,i.evaluate(e))}catch(e){return this.error(e.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){let i="number"==typeof e?this.path.concat(e):this.path,a=r?this.scope.concat(r):this.scope;return new tf(this.registry,this._isConstant,i,t||null,a,this.errors)}error(e,...t){let r=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new e_(r,e))}checkSubtype(e,t){let r=eD(e,t);return r&&this.error(r),r}}class tm{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let r=[];for(let i=1;i<e.length-1;i+=2){let a=e[i];if("string"!=typeof a)return t.error(`Expected string, but found ${typeof a} instead.`,i);if(/[^a-zA-Z0-9_]/.test(a))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);let s=t.parse(e[i+1],i+1);if(!s)return null;r.push([a,s])}let i=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return i?new tm(r,i):null}outputDefined(){return this.result.outputDefined()}}class tg{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");let r=e[1];return t.scope.has(r)?new tg(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class ty{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,eS),i=t.parse(e[2],2,eM(t.expectedType||eC));return r&&i?new ty(i.type.itemType,r,i):null}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new to(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new to(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new to(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class tv{constructor(e,t){this.type=eE,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,eC),i=t.parse(e[2],2,eC);return r&&i?eF(r.type,[eE,ew,eS,eb,eC])?new tv(r,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ek(r.type)} instead`):null}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!eG(t,["boolean","string","number","null"]))throw new to(`Expected first argument to be of type boolean, string, number or null, but found ${ek(ta(t))} instead.`);if(!eG(r,["string","array"]))throw new to(`Expected second argument to be of type array or string, but found ${ek(ta(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class t_{constructor(e,t,r){this.type=eS,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,eC),i=t.parse(e[2],2,eC);if(!r||!i)return null;if(!eF(r.type,[eE,ew,eS,eb,eC]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ek(r.type)} instead`);if(4===e.length){let a=t.parse(e[3],3,eS);return a?new t_(r,i,a):null}return new t_(r,i)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!eG(t,["boolean","string","number","null"]))throw new to(`Expected first argument to be of type boolean, string, number or null, but found ${ek(ta(t))} instead.`);if(!eG(r,["string","array"]))throw new to(`Expected second argument to be of type array or string, but found ${ek(ta(r))} instead.`);if(this.fromIndex){let i=this.fromIndex.evaluate(e);return r.indexOf(t,i)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class tx{constructor(e,t,r,i,a,s){this.inputType=e,this.type=t,this.input=r,this.cases=i,this.outputs=a,this.otherwise=s}static parse(e,t){let r,i;if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);let a={},s=[];for(let n=2;n<e.length-1;n+=2){let o=e[n],l=e[n+1];Array.isArray(o)||(o=[o]);let u=t.concat(n);if(0===o.length)return u.error("Expected at least one branch label.");for(let e of o){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ta(e)))return null}else r=ta(e);if(void 0!==a[String(e)])return u.error("Branch labels must be unique.");a[String(e)]=s.length}let h=t.parse(l,n,i);if(!h)return null;i=i||h.type,s.push(h)}let n=t.parse(e[1],1,eC);if(!n)return null;let o=t.parse(e[e.length-1],e.length-1,i);return o?"value"!==n.type.kind&&t.concat(1).checkSubtype(r,n.type)?null:new tx(r,i,n,a,s,o):null}evaluate(e){let t=this.input.evaluate(e);return(ta(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class tb{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){let r;if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=t.parse(e[a],a,eE);if(!s)return null;let n=t.parse(e[a+1],a+1,r);if(!n)return null;i.push([s,n]),r=r||n.type}let a=t.parse(e[e.length-1],e.length-1,r);if(!a)return null;if(!r)throw Error("Can't infer output type");return new tb(r,i,a)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class tS{constructor(e,t,r,i){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,eC),i=t.parse(e[2],2,eS);if(!r||!i)return null;if(!eF(r.type,[eM(eC),ew,eC]))return t.error(`Expected first argument to be of type array or string, but found ${ek(r.type)} instead`);if(4===e.length){let a=t.parse(e[3],3,eS);return a?new tS(r.type,r,i,a):null}return new tS(r.type,r,i)}evaluate(e){let t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!eG(t,["string","array"]))throw new to(`Expected first argument to be of type array or string, but found ${ek(ta(t))} instead.`);if(this.endIndex){let i=this.endIndex.evaluate(e);return t.slice(r,i)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function tw(e,t){let r=e.length-1,i,a,s=0,n=r,o=0;for(;s<=n;)if(i=e[o=Math.floor((s+n)/2)],a=e[o+1],i<=t){if(o===r||t<a)return o;s=o+1}else{if(!(i>t))throw new to("Input is not a number.");n=o-1}return 0}class tE{constructor(e,t,r){for(let[i,a]of(this.type=e,this.input=t,this.labels=[],this.outputs=[],r))this.labels.push(i),this.outputs.push(a)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");let r=t.parse(e[1],1,eS);if(!r)return null;let i=[],a=null;t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let r=1;r<e.length;r+=2){let s=1===r?-1/0:e[r],n=e[r+1],o=r,l=r+1;if("number"!=typeof s)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(i.length&&i[i.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);let u=t.parse(n,l,a);if(!u)return null;a=a||u.type,i.push([s,u])}return new tE(a,r,i)}evaluate(e){let t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let a=t.length;return i>=t[a-1]?r[a-1].evaluate(e):r[tw(t,i)].evaluate(e)}eachChild(e){for(let t of(e(this.input),this.outputs))e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function tA(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=i}tA.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,i=0;i<8;i++){var a=this.sampleCurveX(r)-e;if(Math.abs(a)<t)return r;var s=this.sampleCurveDerivativeX(r);if(1e-6>Math.abs(s))break;r-=a/s}var n=0,o=1;for(r=e,i=0;i<20&&!(Math.abs((a=this.sampleCurveX(r))-e)<t);i++)e>a?n=r:o=r,r=.5*(o-n)+n;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var tT=tA&&tA.__esModule&&Object.prototype.hasOwnProperty.call(tA,"default")?tA.default:tA;function tC(e,t,r){return e.map((e,i)=>e+r*(t[i]-e))}let tP={number:function(e,t,r){return e+r*(t-e)},color:function(e,t,r,i="rgb"){switch(i){case"rgb":{let[i,a,s,n]=tC(e.rgb,t.rgb,r);return new e3(i,a,s,n,!1)}case"hcl":{let i,a;let[s,n,o,l]=e.hcl,[u,h,c,d]=t.hcl;if(isNaN(s)||isNaN(u))isNaN(s)?isNaN(u)?i=NaN:(i=u,1!==o&&0!==o||(a=h)):(i=s,1!==c&&0!==c||(a=n));else{let e=u-s;u>s&&e>180?e-=360:u<s&&s-u>180&&(e+=360),i=s+r*e}let[p,f,m,g]=function([e,t,r,i]){return eX([r,Math.cos(e=isNaN(e)?0:e*eH)*t,Math.sin(e)*t,i])}([i,null!=a?a:n+r*(h-n),o+r*(c-o),l+r*(d-l)]);return new e3(p,f,m,g,!1)}case"lab":{let[i,a,s,n]=eX(tC(e.lab,t.lab,r));return new e3(i,a,s,n,!1)}}},array:tC,padding:function(e,t,r){return new e7(tC(e.values,t.values,r))},variableAnchorOffsetCollection:function(e,t,r){let i=e.values,a=t.values;if(i.length!==a.length)throw new to(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);let s=[];for(let e=0;e<i.length;e+=2){if(i[e]!==a[e])throw new to(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${i[e]}, to[${e}]: ${a[e]}`);s.push(i[e]);let[t,n]=i[e+1],[o,l]=a[e+1];s.push([t+r*(o-t),n+r*(l-n)])}return new te(s)}};class tR{constructor(e,t,r,i,a){for(let[s,n]of(this.type=e,this.operator=t,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[],a))this.labels.push(s),this.outputs.push(n)}static interpolationFactor(e,t,r,i){let a=0;if("exponential"===e.name)a=tI(t,e.base,r,i);else if("linear"===e.name)a=tI(t,1,r,i);else if("cubic-bezier"===e.name){let s=e.controlPoints;a=new tT(s[0],s[1],s[2],s[3]).solve(tI(t,1,r,i))}return a}static parse(e,t){let[r,i,a,...s]=e;if(!Array.isArray(i)||0===i.length)return t.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){let e=i[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:e}}else{if("cubic-bezier"!==i[0])return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);{let e=i.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(a=t.parse(a,2,eS)))return null;let n=[],o=null;"interpolate-hcl"===r||"interpolate-lab"===r?o=eA:t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let e=0;e<s.length;e+=2){let r=s[e],i=s[e+1],a=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',a);let u=t.parse(i,l,o);if(!u)return null;o=o||u.type,n.push([r,u])}return ez(o,eS)||ez(o,eA)||ez(o,eI)||ez(o,eO)||ez(o,eM(eS))?new tR(o,r,i,a,n):t.error(`Type ${ek(o)} is not interpolatable.`)}evaluate(e){let t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let a=t.length;if(i>=t[a-1])return r[a-1].evaluate(e);let s=tw(t,i),n=tR.interpolationFactor(this.interpolation,i,t[s],t[s+1]),o=r[s].evaluate(e),l=r[s+1].evaluate(e);switch(this.operator){case"interpolate":return tP[this.type.kind](o,l,n);case"interpolate-hcl":return tP.color(o,l,n,"hcl");case"interpolate-lab":return tP.color(o,l,n,"lab")}}eachChild(e){for(let t of(e(this.input),this.outputs))e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function tI(e,t,r,i){let a=i-r,s=e-r;return 0===a?0:1===t?s/a:(Math.pow(t,s)-1)/(Math.pow(t,a)-1)}class tL{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null,i=t.expectedType;i&&"value"!==i.kind&&(r=i);let a=[];for(let i of e.slice(1)){let e=t.parse(i,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,a.push(e)}if(!r)throw Error("No output type");return new tL(i&&a.some(e=>eD(i,e.type))?eC:r,a)}evaluate(e){let t,r=null,i=0;for(let a of this.args)if(i++,(r=a.evaluate(e))&&r instanceof tt&&!r.available&&(t||(t=r.name),r=null,i===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function tO(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function tM(e,t,r,i){return 0===i.compare(t,r)}function tk(e,t,r){let i="=="!==e&&"!="!==e;return class a{constructor(e,t,r){this.type=eE,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");let r=e[0],s=t.parse(e[1],1,eC);if(!s)return null;if(!tO(r,s.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${ek(s.type)}'.`);let n=t.parse(e[2],2,eC);if(!n)return null;if(!tO(r,n.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${ek(n.type)}'.`);if(s.type.kind!==n.type.kind&&"value"!==s.type.kind&&"value"!==n.type.kind)return t.error(`Cannot compare types '${ek(s.type)}' and '${ek(n.type)}'.`);i&&("value"===s.type.kind&&"value"!==n.type.kind?s=new tu(n.type,[s]):"value"!==s.type.kind&&"value"===n.type.kind&&(n=new tu(s.type,[n])));let o=null;if(4===e.length){if("string"!==s.type.kind&&"string"!==n.type.kind&&"value"!==s.type.kind&&"value"!==n.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(o=t.parse(e[3],3,eP)))return null}return new a(s,n,o)}evaluate(a){let s=this.lhs.evaluate(a),n=this.rhs.evaluate(a);if(i&&this.hasUntypedArgument){let t=ta(s),r=ta(n);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new to(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){let e=ta(s),r=ta(n);if("string"!==e.kind||"string"!==r.kind)return t(a,s,n)}return this.collator?r(a,s,n,this.collator.evaluate(a)):t(a,s,n)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}let tN=tk("==",function(e,t,r){return t===r},tM),tD=tk("!=",function(e,t,r){return t!==r},function(e,t,r,i){return!tM(0,t,r,i)}),tF=tk("<",function(e,t,r){return t<r},function(e,t,r,i){return 0>i.compare(t,r)}),tG=tk(">",function(e,t,r){return t>r},function(e,t,r,i){return i.compare(t,r)>0}),tz=tk("<=",function(e,t,r){return t<=r},function(e,t,r,i){return 0>=i.compare(t,r)}),tq=tk(">=",function(e,t,r){return t>=r},function(e,t,r,i){return i.compare(t,r)>=0});class tj{constructor(e,t,r){this.type=eP,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");let r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");let i=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,eE);if(!i)return null;let a=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,eE);if(!a)return null;let s=null;return!r.locale||(s=t.parse(r.locale,1,ew))?new tj(i,a,s):null}evaluate(e){return new e4(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class tB{constructor(e,t,r,i,a){this.type=ew,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=a}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");let r=t.parse(e[1],1,eS);if(!r)return null;let i=e[2];if("object"!=typeof i||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let a=null;if(i.locale&&!(a=t.parse(i.locale,1,ew)))return null;let s=null;if(i.currency&&!(s=t.parse(i.currency,1,ew)))return null;let n=null;if(i["min-fraction-digits"]&&!(n=t.parse(i["min-fraction-digits"],1,eS)))return null;let o=null;return!i["max-fraction-digits"]||(o=t.parse(i["max-fraction-digits"],1,eS))?new tB(r,a,s,n,o):null}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class tU{constructor(e){this.type=eR,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");let i=[],a=!1;for(let r=1;r<=e.length-1;++r){let s=e[r];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;let e=null;if(s["font-scale"]&&!(e=t.parse(s["font-scale"],1,eS)))return null;let r=null;if(s["text-font"]&&!(r=t.parse(s["text-font"],1,eM(ew))))return null;let n=null;if(s["text-color"]&&!(n=t.parse(s["text-color"],1,eA)))return null;let o=i[i.length-1];o.scale=e,o.font=r,o.textColor=n}else{let s=t.parse(e[r],1,eC);if(!s)return null;let n=s.type.kind;if("string"!==n&&"value"!==n&&"null"!==n&&"resolvedImage"!==n)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:s,scale:null,font:null,textColor:null})}}return new tU(i)}evaluate(e){return new e8(this.sections.map(t=>{let r=t.content.evaluate(e);return ta(r)===eL?new e6("",r,null,null,null):new e6(ts(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}class tH{constructor(e){this.type=eL,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");let r=t.parse(e[1],1,ew);return r?new tH(r):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=tt.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class tZ{constructor(e){this.type=eS,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${ek(r.type)} instead.`):new tZ(r):null}evaluate(e){let t=this.input.evaluate(e);if("string"==typeof t||Array.isArray(t))return t.length;throw new to(`Expected value to be of type string or array, but found ${ek(ta(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}function tV(e,t){let r=Math.pow(2,t.z);return[(e[0]/8192+t.x)/r*360-180,360/Math.PI*Math.atan(Math.exp((180-(e[1]/8192+t.y)/r*360)*Math.PI/180))-90]}function tY(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function tW(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function t$(e,t,r,i){var a,s;return 0!=(a=[i[0]-r[0],i[1]-r[1]])[0]*(s=[t[0]-e[0],t[1]-e[1]])[1]-a[1]*s[0]&&!(!tJ(e,t,r,i)||!tJ(r,i,e,t))}function tX(e,t,r=!1){var i,a;let s=!1;for(let n of t)for(let t=0;t<n.length-1;t++){if(function(e,t,r){let i=e[0]-t[0],a=e[1]-t[1],s=e[0]-r[0],n=e[1]-r[1];return i*n-s*a==0&&i*s<=0&&a*n<=0}(e,n[t],n[t+1]))return r;(i=n[t])[1]>e[1]!=(a=n[t+1])[1]>e[1]&&e[0]<(a[0]-i[0])*(e[1]-i[1])/(a[1]-i[1])+i[0]&&(s=!s)}return s}function tK(e,t){for(let r of e)if(!tX(r,t))return!1;for(let r=0;r<e.length-1;++r)if(function(e,t,r){for(let i of r)for(let r=0;r<i.length-1;++r)if(t$(e,t,i[r],i[r+1]))return!0;return!1}(e[r],e[r+1],t))return!1;return!0}function tJ(e,t,r,i){let a=i[0]-r[0],s=i[1]-r[1],n=(e[0]-r[0])*s-a*(e[1]-r[1]),o=(t[0]-r[0])*s-a*(t[1]-r[1]);return n>0&&o<0||n<0&&o>0}function tQ(e,t,r){let i=[];for(let a=0;a<e.length;a++){let s=[];for(let i=0;i<e[a].length;i++){let n=function(e,t){let r=(180+e[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,a=Math.pow(2,t.z);return[Math.round(r*a*8192),Math.round(i*a*8192)]}(e[a][i],r);tY(t,n),s.push(n)}i.push(s)}return i}function t0(e,t,r){let i=[];for(let a=0;a<e.length;a++){let s=tQ(e[a],t,r);i.push(s)}return i}function t1(e,t,r,i){if(e[0]<r[0]||e[0]>r[2]){let t=.5*i,a=e[0]-r[0]>t?-i:r[0]-e[0]>t?i:0;0===a&&(a=e[0]-r[2]>t?-i:r[2]-e[0]>t?i:0),e[0]+=a}tY(t,e)}function t2(e,t,r,i){let a=8192*Math.pow(2,i.z),s=[8192*i.x,8192*i.y],n=[];for(let i of e)for(let e of i){let i=[e.x+s[0],e.y+s[1]];t1(i,t,r,a),n.push(i)}return n}function t5(e,t,r,i){let a=8192*Math.pow(2,i.z),s=[8192*i.x,8192*i.y],n=[];for(let r of e){let e=[];for(let i of r){let r=[i.x+s[0],i.y+s[1]];tY(t,r),e.push(r)}n.push(e)}if(t[2]-t[0]<=a/2)for(let e of(t[0]=t[1]=1/0,t[2]=t[3]=-1/0,n))for(let i of e)t1(i,t,r,a);return n}class t3{constructor(e,t){this.type=eE,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ti(e[1])){let t=e[1];if("FeatureCollection"===t.type){let e=[];for(let r of t.features){let{type:t,coordinates:i}=r.geometry;"Polygon"===t&&e.push(i),"MultiPolygon"===t&&e.push(...i)}if(e.length)return new t3(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){let e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new t3(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new t3(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){let s=tQ(t.coordinates,i,a),n=t2(e.geometry(),r,i,a);if(!tW(r,i))return!1;for(let e of n)if(!tX(e,s))return!1}if("MultiPolygon"===t.type){let s=t0(t.coordinates,i,a),n=t2(e.geometry(),r,i,a);if(!tW(r,i))return!1;for(let e of n)if(!function(e,t){for(let r of t)if(tX(e,r))return!0;return!1}(e,s))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){let s=tQ(t.coordinates,i,a),n=t5(e.geometry(),r,i,a);if(!tW(r,i))return!1;for(let e of n)if(!tK(e,s))return!1}if("MultiPolygon"===t.type){let s=t0(t.coordinates,i,a),n=t5(e.geometry(),r,i,a);if(!tW(r,i))return!1;for(let e of n)if(!function(e,t){for(let r of t)if(tK(e,r))return!0;return!1}(e,s))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let t4=class{constructor(e=[],t=t6){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let a=e-1>>1,s=t[a];if(r(i,s)>=0)break;t[e]=s,e=a}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,a=t[e];for(;e<i;){let i=1+(e<<1),s=t[i],n=i+1;if(n<this.length&&0>r(t[n],s)&&(i=n,s=t[n]),r(s,a)>=0)break;t[e]=s,e=i}t[e]=a}};function t6(e,t){return e<t?-1:e>t?1:0}function t8(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function t7(e,t){return e<t?-1:e>t?1:0}function t9(e,t){let r,i;if(e.length<=1)return[e];let a=[];for(let t of e){let e=function(e){let t=0;for(let r,i,a=0,s=e.length,n=s-1;a<s;n=a++)r=e[a],t+=((i=e[n]).x-r.x)*(r.y+i.y);return t}(t);0!==e&&(t.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(r&&a.push(r),r=[t]):r.push(t))}if(r&&a.push(r),t>1)for(let e=0;e<a.length;e++){var s;a[e].length<=t||(function e(t,r,i,a,s){for(;a>i;){if(a-i>600){var n=a-i+1,o=r-i+1,l=Math.log(n),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(n-u)/n)*(o-n/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-o*u/n+h)),Math.min(a,Math.floor(r+(n-o)*u/n+h)),s)}var c=t[r],d=i,p=a;for(t8(t,i,r),s(t[a],c)>0&&t8(t,i,a);d<p;){for(t8(t,d,p),d++,p--;0>s(t[d],c);)d++;for(;s(t[p],c)>0;)p--}0===s(t[i],c)?t8(t,i,p):t8(t,++p,a),p<=r&&(i=p+1),r<=p&&(a=p-1)}}(s=a[e],t,1,a[e].length-1||s.length-1,re||t7),a[e]=a[e].slice(0,t))}return a}function re(e,t){return t.area-e.area}let rt=1/298.257223563*(2-1/298.257223563),rr=Math.PI/180;class ri{constructor(e){let t=6378.137*rr*1e3,r=Math.cos(e*rr),i=1/(1-rt*(1-r*r)),a=Math.sqrt(i);this.kx=t*a*r,this.ky=t*a*i*(1-rt)}distance(e,t){let r=this.wrap(e[0]-t[0])*this.kx,i=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+i*i)}pointOnLine(e,t){let r,i,a,s,n=1/0;for(let o=0;o<e.length-1;o++){let l=e[o][0],u=e[o][1],h=this.wrap(e[o+1][0]-l)*this.kx,c=(e[o+1][1]-u)*this.ky,d=0;0===h&&0===c||((d=(this.wrap(t[0]-l)*this.kx*h+(t[1]-u)*this.ky*c)/(h*h+c*c))>1?(l=e[o+1][0],u=e[o+1][1]):d>0&&(l+=h/this.kx*d,u+=c/this.ky*d));let p=(h=this.wrap(t[0]-l)*this.kx)*h+(c=(t[1]-u)*this.ky)*c;p<n&&(n=p,r=l,i=u,a=o,s=d)}return{point:[r,i],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function ra(e,t){return t[0]-e[0]}function rs(e){return e[1]-e[0]+1}function rn(e,t){return e[1]>=e[0]&&e[1]<t}function ro(e,t){if(e[0]>e[1])return[null,null];let r=rs(e);if(t){if(2===r)return[e,null];let t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];let i=Math.floor(r/2)-1;return[[e[0],e[0]+i],[e[0]+i+1,e[1]]]}function rl(e,t){if(!rn(t,e.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let i=t[0];i<=t[1];++i)tY(r,e[i]);return r}function ru(e){let t=[1/0,1/0,-1/0,-1/0];for(let r of e)for(let e of r)tY(t,e);return t}function rh(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function rc(e,t,r){if(!rh(e)||!rh(t))return NaN;let i=0,a=0;return e[2]<t[0]&&(i=t[0]-e[2]),e[0]>t[2]&&(i=e[0]-t[2]),e[1]>t[3]&&(a=e[1]-t[3]),e[3]<t[1]&&(a=t[1]-e[3]),r.distance([0,0],[i,a])}function rd(e,t,r){let i=r.pointOnLine(t,e);return r.distance(e,i.point)}function rp(e,t,r,i,a){return Math.min(Math.min(rd(e,[r,i],a),rd(t,[r,i],a)),Math.min(rd(r,[e,t],a),rd(i,[e,t],a)))}function rf(e,t){for(let r of e)for(let e of r)if(tX(e,t,!0))return!0;return!1}function rm(e,t,r,i,a,s){if(!s)return;let n=rc(rl(i,s),a,r);n<t&&e.push([n,s,[0,0]])}function rg(e,t,r,i,a,s,n){if(!s||!n)return;let o=rc(rl(i,s),rl(a,n),r);o<t&&e.push([o,s,n])}function ry(e,t,r,i,a=1/0){let s=Math.min(i.distance(e[0],r[0][0]),a);if(0===s)return s;let n=new t4([[0,[0,e.length-1],[0,0]]],ra),o=ru(r);for(;n.length>0;){let a=n.pop();if(a[0]>=s)continue;let l=a[1],u=t?50:100;if(rs(l)<=u){if(!rn(l,e.length))return NaN;if(t){let t=function(e,t,r,i){if(!rn(t,e.length))return NaN;for(let i=t[0];i<=t[1];++i)if(tX(e[i],r,!0))return 0;let a=1/0;for(let s=t[0];s<t[1];++s){let t=e[s],n=e[s+1];for(let e of r)for(let r=0,s=e.length,o=s-1;r<s;o=r++){let s=e[o],l=e[r];if(t$(t,n,s,l))return 0;a=Math.min(a,rp(t,n,s,l,i))}}return a}(e,l,r,i);if(isNaN(t)||0===t)return t;s=Math.min(s,t)}else for(let t=l[0];t<=l[1];++t)if(0===(s=Math.min(s,function(e,t,r){if(tX(e,t,!0))return 0;let i=1/0;for(let a of t){let t=a[0],s=a[a.length-1];if(t!==s&&0===(i=Math.min(i,rd(e,[s,t],r))))break;let n=r.pointOnLine(a,e);if(0===(i=Math.min(i,r.distance(e,n.point))))break}return i}(e[t],r,i))))return 0}else{let r=ro(l,t);rm(n,s,i,e,o,r[0]),rm(n,s,i,e,o,r[1])}}return s}function rv(e,t,r,i,a,s=1/0){let n=Math.min(s,a.distance(e[0],r[0]));if(0===n)return n;let o=new t4([[0,[0,e.length-1],[0,r.length-1]]],ra);for(;o.length>0;){let s=o.pop();if(s[0]>=n)continue;let l=s[1],u=s[2],h=t?50:100,c=i?50:100;if(rs(l)<=h&&rs(u)<=c){if(!rn(l,e.length)&&rn(u,r.length))return NaN;if(t&&i)n=Math.min(n,function(e,t,r,i,a){if(!rn(t,e.length)||!rn(i,r.length))return 1/0;let s=1/0;for(let n=t[0];n<t[1];++n){let t=e[n],o=e[n+1];for(let e=i[0];e<i[1];++e){let i=r[e],n=r[e+1];if(t$(t,o,i,n))return 0;s=Math.min(s,rp(t,o,i,n,a))}}return s}(e,l,r,u,a));else if(t&&!i){let t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(0===(n=Math.min(n,rd(r[e],t,a))))return n}else if(!t&&i){let t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(0===(n=Math.min(n,rd(e[r],t,a))))return n}else n=Math.min(n,function(e,t,r,i,a){if(!rn(t,e.length)||!rn(i,r.length))return NaN;let s=1/0;for(let n=t[0];n<=t[1];++n)for(let t=i[0];t<=i[1];++t)if(0===(s=Math.min(s,a.distance(e[n],r[t]))))return s;return s}(e,l,r,u,a))}else{let s=ro(l,t),h=ro(u,i);rg(o,n,a,e,r,s[0],h[0]),rg(o,n,a,e,r,s[0],h[1]),rg(o,n,a,e,r,s[1],h[0]),rg(o,n,a,e,r,s[1],h[1])}}return n}function r_(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class rx{constructor(e,t){this.type=eS,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ti(e[1])){let t=e[1];if("FeatureCollection"===t.type)return new rx(t,t.features.map(e=>r_(e.geometry)).flat());if("Feature"===t.type)return new rx(t,r_(t.geometry));if("type"in t&&"coordinates"in t)return new rx(t,r_(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){let r=e.geometry(),i=r.flat().map(t=>tV([t.x,t.y],e.canonical));if(0===r.length)return NaN;let a=new ri(i[0][1]),s=1/0;for(let e of t){switch(e.type){case"Point":s=Math.min(s,rv(i,!1,[e.coordinates],!1,a,s));break;case"LineString":s=Math.min(s,rv(i,!1,e.coordinates,!0,a,s));break;case"Polygon":s=Math.min(s,ry(i,!1,e.coordinates,a,s))}if(0===s)break}return s}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){let r=e.geometry(),i=r.flat().map(t=>tV([t.x,t.y],e.canonical));if(0===r.length)return NaN;let a=new ri(i[0][1]),s=1/0;for(let e of t){switch(e.type){case"Point":s=Math.min(s,rv(i,!0,[e.coordinates],!1,a,s));break;case"LineString":s=Math.min(s,rv(i,!0,e.coordinates,!0,a,s));break;case"Polygon":s=Math.min(s,ry(i,!0,e.coordinates,a,s))}if(0===s)break}return s}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){let r=e.geometry();if(0===r.length||0===r[0].length)return NaN;let i=t9(r,0).map(t=>t.map(t=>t.map(t=>tV([t.x,t.y],e.canonical)))),a=new ri(i[0][0][0][1]),s=1/0;for(let e of t)for(let t of i){switch(e.type){case"Point":s=Math.min(s,ry([e.coordinates],!1,t,a,s));break;case"LineString":s=Math.min(s,ry(e.coordinates,!0,t,a,s));break;case"Polygon":s=Math.min(s,function(e,t,r,i=1/0){let a=ru(e),s=ru(t);if(i!==1/0&&rc(a,s,r)>=i)return i;if(tW(a,s)){if(rf(e,t))return 0}else if(rf(t,e))return 0;let n=1/0;for(let i of e)for(let e=0,a=i.length,s=a-1;e<a;s=e++){let a=i[s],o=i[e];for(let e of t)for(let t=0,i=e.length,s=i-1;t<i;s=t++){let i=e[s],l=e[t];if(t$(a,o,i,l))return 0;n=Math.min(n,rp(a,o,i,l,r))}}return n}(t,e.coordinates,a,s))}if(0===s)return s}return s}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}let rb={"==":tN,"!=":tD,">":tG,"<":tF,">=":tq,"<=":tz,array:tu,at:ty,boolean:tu,case:tb,coalesce:tL,collator:tj,format:tU,image:tH,in:tv,"index-of":t_,interpolate:tR,"interpolate-hcl":tR,"interpolate-lab":tR,length:tZ,let:tm,literal:tn,match:tx,number:tu,"number-format":tB,object:tu,slice:tS,step:tE,string:tu,"to-boolean":tc,"to-color":tc,"to-number":tc,"to-string":tc,var:tg,within:t3,distance:rx};class rS{constructor(e,t,r,i){this.name=e,this.type=t,this._evaluate=r,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let r=e[0],i=rS.definitions[r];if(!i)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);let a=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,n=s.filter(([t])=>!Array.isArray(t)||t.length===e.length-1),o=null;for(let[i,s]of n){o=new tf(t.registry,rT,t.path,null,t.scope);let n=[],l=!1;for(let t=1;t<e.length;t++){let r=e[t],a=Array.isArray(i)?i[t-1]:i.type,s=o.parse(r,1+n.length,a);if(!s){l=!0;break}n.push(s)}if(!l){if(Array.isArray(i)&&i.length!==n.length)o.error(`Expected ${i.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){let t=Array.isArray(i)?i[e]:i.type,r=n[e];o.concat(e+1).checkSubtype(t,r.type)}if(0===o.errors.length)return new rS(r,a,s,n)}}}if(1===n.length)t.errors.push(...o.errors);else{let r=(n.length?n:s).map(([e])=>Array.isArray(e)?`(${e.map(ek).join(", ")})`:`(${ek(e.type)}...)`).join(" | "),i=[];for(let r=1;r<e.length;r++){let a=t.parse(e[r],1+i.length);if(!a)return null;i.push(ek(a.type))}t.error(`Expected arguments of type ${r}, but found (${i.join(", ")}) instead.`)}return null}static register(e,t){for(let r in rS.definitions=t,t)e[r]=rS}}function rw(e,[t,r,i,a]){t=t.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);let s=a?a.evaluate(e):1,n=tr(t,r,i,s);if(n)throw new to(n);return new e3(t/255,r/255,i/255,s,!1)}function rE(e,t){let r=t[e];return void 0===r?null:r}function rA(e){return{type:e}}function rT(e){if(e instanceof tg)return rT(e.boundExpression);if(e instanceof rS&&"error"===e.name||e instanceof tj||e instanceof t3||e instanceof rx)return!1;let t=e instanceof tc||e instanceof tu,r=!0;return e.eachChild(e=>{r=t?r&&rT(e):r&&e instanceof tn}),!!r&&rC(e)&&rR(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function rC(e){if(e instanceof rS&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof t3||e instanceof rx)return!1;let t=!0;return e.eachChild(e=>{t&&!rC(e)&&(t=!1)}),t}function rP(e){if(e instanceof rS&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!rP(e)&&(t=!1)}),t}function rR(e,t){if(e instanceof rS&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(e=>{r&&!rR(e,t)&&(r=!1)}),r}function rI(e){return{result:"success",value:e}}function rL(e){return{result:"error",value:e}}function rO(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function rM(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function rk(e){return!!e.expression&&e.expression.interpolated}function rN(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function rD(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function rF(e){return e}function rG(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function rz(e,t,r,i,a){return rG(typeof r===a?i[r]:void 0,e.default,t.default)}function rq(e,t,r){if("number"!==rN(r))return rG(e.default,t.default);let i=e.stops.length;if(1===i||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];let a=tw(e.stops.map(e=>e[0]),r);return e.stops[a][1]}function rj(e,t,r){let i=void 0!==e.base?e.base:1;if("number"!==rN(r))return rG(e.default,t.default);let a=e.stops.length;if(1===a||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[a-1][0])return e.stops[a-1][1];let s=tw(e.stops.map(e=>e[0]),r),n=function(e,t,r,i){let a=i-r,s=e-r;return 0===a?0:1===t?s/a:(Math.pow(t,s)-1)/(Math.pow(t,a)-1)}(r,i,e.stops[s][0],e.stops[s+1][0]),o=e.stops[s][1],l=e.stops[s+1][1],u=tP[t.type]||rF;return"function"==typeof o.evaluate?{evaluate(...t){let r=o.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==i)return u(r,i,n,e.colorSpace)}}:u(o,l,n,e.colorSpace)}function rB(e,t,r){switch(t.type){case"color":r=e3.parse(r);break;case"formatted":r=e8.fromString(r.toString());break;case"resolvedImage":r=tt.fromString(r.toString());break;case"padding":r=e7.parse(r);break;default:rN(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return rG(r,e.default,t.default)}rS.register(rb,{error:[{kind:"error"},[ew],(e,[t])=>{throw new to(t.evaluate(e))}],typeof:[ew,[eC],(e,[t])=>ek(ta(t.evaluate(e)))],"to-rgba":[eM(eS,4),[eA],(e,[t])=>{let[r,i,a,s]=t.evaluate(e).rgb;return[255*r,255*i,255*a,s]}],rgb:[eA,[eS,eS,eS],rw],rgba:[eA,[eS,eS,eS,eS],rw],has:{type:eE,overloads:[[[ew],(e,[t])=>t.evaluate(e) in e.properties()],[[ew,eT],(e,[t,r])=>t.evaluate(e) in r.evaluate(e)]]},get:{type:eC,overloads:[[[ew],(e,[t])=>rE(t.evaluate(e),e.properties())],[[ew,eT],(e,[t,r])=>rE(t.evaluate(e),r.evaluate(e))]]},"feature-state":[eC,[ew],(e,[t])=>rE(t.evaluate(e),e.featureState||{})],properties:[eT,[],e=>e.properties()],"geometry-type":[ew,[],e=>e.geometryType()],id:[eC,[],e=>e.id()],zoom:[eS,[],e=>e.globals.zoom],"heatmap-density":[eS,[],e=>e.globals.heatmapDensity||0],"line-progress":[eS,[],e=>e.globals.lineProgress||0],accumulated:[eC,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[eS,rA(eS),(e,t)=>{let r=0;for(let i of t)r+=i.evaluate(e);return r}],"*":[eS,rA(eS),(e,t)=>{let r=1;for(let i of t)r*=i.evaluate(e);return r}],"-":{type:eS,overloads:[[[eS,eS],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[eS],(e,[t])=>-t.evaluate(e)]]},"/":[eS,[eS,eS],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[eS,[eS,eS],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[eS,[],()=>Math.LN2],pi:[eS,[],()=>Math.PI],e:[eS,[],()=>Math.E],"^":[eS,[eS,eS],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[eS,[eS],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[eS,[eS],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[eS,[eS],(e,[t])=>Math.log(t.evaluate(e))],log2:[eS,[eS],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[eS,[eS],(e,[t])=>Math.sin(t.evaluate(e))],cos:[eS,[eS],(e,[t])=>Math.cos(t.evaluate(e))],tan:[eS,[eS],(e,[t])=>Math.tan(t.evaluate(e))],asin:[eS,[eS],(e,[t])=>Math.asin(t.evaluate(e))],acos:[eS,[eS],(e,[t])=>Math.acos(t.evaluate(e))],atan:[eS,[eS],(e,[t])=>Math.atan(t.evaluate(e))],min:[eS,rA(eS),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[eS,rA(eS),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[eS,[eS],(e,[t])=>Math.abs(t.evaluate(e))],round:[eS,[eS],(e,[t])=>{let r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[eS,[eS],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[eS,[eS],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[eE,[ew,eC],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[eE,[eC],(e,[t])=>e.id()===t.value],"filter-type-==":[eE,[ew],(e,[t])=>e.geometryType()===t.value],"filter-<":[eE,[ew,eC],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i<a}],"filter-id-<":[eE,[eC],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<i}],"filter->":[eE,[ew,eC],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i>a}],"filter-id->":[eE,[eC],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>i}],"filter-<=":[eE,[ew,eC],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[eE,[eC],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<=i}],"filter->=":[eE,[ew,eC],(e,[t,r])=>{let i=e.properties()[t.value],a=r.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[eE,[eC],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>=i}],"filter-has":[eE,[eC],(e,[t])=>t.value in e.properties()],"filter-has-id":[eE,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[eE,[eM(ew)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[eE,[eM(eC)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[eE,[ew,eM(eC)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[eE,[ew,eM(eC)],(e,[t,r])=>(function(e,t,r,i){for(;r<=i;){let a=r+i>>1;if(t[a]===e)return!0;t[a]>e?i=a-1:r=a+1}return!1})(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:eE,overloads:[[[eE,eE],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[rA(eE),(e,t)=>{for(let r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:eE,overloads:[[[eE,eE],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[rA(eE),(e,t)=>{for(let r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[eE,[eE],(e,[t])=>!t.evaluate(e)],"is-supported-script":[eE,[ew],(e,[t])=>{let r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[ew,[ew],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[ew,[ew],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[ew,rA(eC),(e,t)=>t.map(t=>ts(t.evaluate(e))).join("")],"resolved-locale":[ew,[eP],(e,[t])=>t.evaluate(e).resolvedLocale()]});class rU{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new tp,this._defaultValue=t?"color"===t.type&&rD(t.default)?new e3(0,0,0,0):"color"===t.type?e3.parse(t.default)||null:"padding"===t.type?e7.parse(t.default)||null:"variableAnchorOffsetCollection"===t.type?te.parse(t.default)||null:void 0===t.default?null:t.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,i,a,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s||null;try{let e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new to(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function rH(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in rb}function rZ(e,t){let r=new tf(rb,rT,[],t?function(e){let t={color:eA,string:ew,number:eS,enum:ew,boolean:eE,formatted:eR,padding:eI,resolvedImage:eL,variableAnchorOffsetCollection:eO};return"array"===e.type?eM(t[e.value]||eC,e.length):t[e.type]}(t):void 0),i=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?rI(new rU(i,t)):rL(r.errors)}class rV{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!rP(t.expression)}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,a,s)}evaluate(e,t,r,i,a,s){return this._styleExpression.evaluate(e,t,r,i,a,s)}}class rY{constructor(e,t,r,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!rP(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,r,i,a,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,a,s)}evaluate(e,t,r,i,a,s){return this._styleExpression.evaluate(e,t,r,i,a,s)}interpolationFactor(e,t,r){return this.interpolationType?tR.interpolationFactor(this.interpolationType,e,t,r):0}}function rW(e,t){let r=rZ(e,t);if("error"===r.result)return r;let i=r.value.expression,a=rC(i);if(!a&&!rO(t))return rL([new e_("","data expressions not supported")]);let s=rR(i,["zoom"]);if(!s&&!rM(t))return rL([new e_("","zoom expressions not supported")]);let n=function e(t){let r=null;if(t instanceof tm)r=e(t.result);else if(t instanceof tL){for(let i of t.args)if(r=e(i))break}else(t instanceof tE||t instanceof tR)&&t.input instanceof rS&&"zoom"===t.input.name&&(r=t);return r instanceof e_||t.eachChild(t=>{let i=e(t);i instanceof e_?r=i:!r&&i?r=new e_("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&i&&r!==i&&(r=new e_("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}(i);return n||s?n instanceof e_?rL([n]):n instanceof tR&&!rk(t)?rL([new e_("",'"interpolate" expressions cannot be used with this property')]):rI(n?new rY(a?"camera":"composite",r.value,n.labels,n instanceof tR?n.interpolation:void 0):new rV(a?"constant":"source",r.value)):rL([new e_("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class r${constructor(e,t){this._parameters=e,this._specification=t,ev(this,function e(t,r){var i;let a,s,n;let o="color"===r.type,l=t.stops&&"object"==typeof t.stops[0][0],u=l||!(l||void 0!==t.property),h=t.type||(rk(r)?"exponential":"interval");if(o||"padding"===r.type){let e=o?e3.parse:e7.parse;(t=ev({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],e(t[1])])),t.default=e(t.default?t.default:r.default)}if(t.colorSpace&&"rgb"!==(i=t.colorSpace)&&"hcl"!==i&&"lab"!==i)throw Error(`Unknown color space: "${t.colorSpace}"`);if("exponential"===h)a=rj;else if("interval"===h)a=rq;else if("categorical"===h){for(let e of(a=rz,s=Object.create(null),t.stops))s[e[0]]=e[1];n=typeof t.stops[0][0]}else{if("identity"!==h)throw Error(`Unknown function type "${h}"`);a=rB}if(l){let i={},a=[];for(let e=0;e<t.stops.length;e++){let r=t.stops[e],s=r[0].zoom;void 0===i[s]&&(i[s]={zoom:s,type:t.type,property:t.property,default:t.default,stops:[]},a.push(s)),i[s].stops.push([r[0].value,r[1]])}let s=[];for(let t of a)s.push([i[t].zoom,e(i[t],r)]);let n={name:"linear"};return{kind:"composite",interpolationType:n,interpolationFactor:tR.interpolationFactor.bind(void 0,n),zoomStops:s.map(e=>e[0]),evaluate:({zoom:e},i)=>rj({stops:s,base:t.base},r,e).evaluate(e,i)}}if(u){let e="exponential"===h?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:e,interpolationFactor:tR.interpolationFactor.bind(void 0,e),zoomStops:t.stops.map(e=>e[0]),evaluate:({zoom:e})=>a(t,r,e,s,n)}}return{kind:"source",evaluate(e,i){let o=i&&i.properties?i.properties[t.property]:void 0;return void 0===o?rG(t.default,r.default):a(t,r,o,s,n)}}}(this._parameters,this._specification))}static deserialize(e){return new r$(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function rX(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(let t of e.slice(1))if(!rX(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}let rK={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rJ(e){if(null==e)return{filter:()=>!0,needGeometry:!1};rX(e)||(e=function e(t){if(!t)return!0;let r=t[0];return t.length<=1?"any"!==r:"=="===r?r0(t[1],t[2],"=="):"!="===r?r5(r0(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?r0(t[1],t[2],r):"any"===r?["any"].concat(t.slice(1).map(e)):"all"===r?["all"].concat(t.slice(1).map(e)):"none"===r?["all"].concat(t.slice(1).map(e).map(r5)):"in"===r?r1(t[1],t.slice(2)):"!in"===r?r5(r1(t[1],t.slice(2))):"has"===r?r2(t[1]):"!has"!==r||r5(r2(t[1]))}(e));let t=rZ(e,rK);if("error"===t.result)throw Error(t.value.map(e=>`${e.key}: ${e.message}`).join(", "));return{filter:(e,r,i)=>t.value.evaluate(e,r,{},i),needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)}}function rQ(e,t){return e<t?-1:e>t?1:0}function r0(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function r1(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(rQ)]]:["filter-in-small",e,["literal",t]]}}function r2(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function r5(e){return["!",e]}function r3(e){let t=e.value;return t?[new ey(e.key,t,"constants have been deprecated as of v8")]:[]}function r4(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function r6(e){if(Array.isArray(e))return e.map(r6);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){let t={};for(let r in e)t[r]=r6(e[r]);return t}return r4(e)}function r8(e){let t=e.key,r=e.value,i=e.valueSpec||{},a=e.objectElementValidators||{},s=e.style,n=e.styleSpec,o=e.validateSpec,l=[],u=rN(r);if("object"!==u)return[new ey(t,r,`object expected, ${u} found`)];for(let e in r){let u;let h=e.split(".")[0],c=i[h]||i["*"];if(a[h])u=a[h];else if(i[h])u=o;else if(a["*"])u=a["*"];else{if(!i["*"]){l.push(new ey(t,r[e],`unknown property "${e}"`));continue}u=o}l=l.concat(u({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:c,style:s,styleSpec:n,object:r,objectKey:e,validateSpec:o},r))}for(let e in i)a[e]||i[e].required&&void 0===i[e].default&&void 0===r[e]&&l.push(new ey(t,r,`missing required property "${e}"`));return l}function r7(e){let t=e.value,r=e.valueSpec,i=e.style,a=e.styleSpec,s=e.key,n=e.arrayElementValidator||e.validateSpec;if("array"!==rN(t))return[new ey(s,t,`array expected, ${rN(t)} found`)];if(r.length&&t.length!==r.length)return[new ey(s,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new ey(s,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let o={type:r.value,values:r.values};a.$version<7&&(o.function=r.function),"object"===rN(r.value)&&(o=r.value);let l=[];for(let r=0;r<t.length;r++)l=l.concat(n({array:t,arrayIndex:r,value:t[r],valueSpec:o,validateSpec:e.validateSpec,style:i,styleSpec:a,key:`${s}[${r}]`}));return l}function r9(e){let t=e.key,r=e.value,i=e.valueSpec,a=rN(r);return"number"===a&&r!=r&&(a="NaN"),"number"!==a?[new ey(t,r,`number expected, ${a} found`)]:"minimum"in i&&r<i.minimum?[new ey(t,r,`${r} is less than the minimum value ${i.minimum}`)]:"maximum"in i&&r>i.maximum?[new ey(t,r,`${r} is greater than the maximum value ${i.maximum}`)]:[]}function ie(e){let t=e.valueSpec,r=r4(e.value.type),i,a,s,n={},o="categorical"!==r&&void 0===e.value.property,l="array"===rN(e.value.stops)&&"array"===rN(e.value.stops[0])&&"object"===rN(e.value.stops[0][0]),u=r8({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new ey(e.key,e.value,'identity function may not have a "stops" property')];let t=[],i=e.value;return t=t.concat(r7({key:e.key,value:i,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===rN(i)&&0===i.length&&t.push(new ey(e.key,i,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&o&&u.push(new ey(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||u.push(new ey(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!rk(e.valueSpec)&&u.push(new ey(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(o||rO(e.valueSpec)?o&&!rM(e.valueSpec)&&u.push(new ey(e.key,e.value,"zoom functions not supported")):u.push(new ey(e.key,e.value,"property functions not supported"))),("categorical"===r||l)&&void 0===e.value.property&&u.push(new ey(e.key,e.value,'"property" property is required')),u;function h(e){let r=[],i=e.value,o=e.key;if("array"!==rN(i))return[new ey(o,i,`array expected, ${rN(i)} found`)];if(2!==i.length)return[new ey(o,i,`array length 2 expected, length ${i.length} found`)];if(l){if("object"!==rN(i[0]))return[new ey(o,i,`object expected, ${rN(i[0])} found`)];if(void 0===i[0].zoom)return[new ey(o,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new ey(o,i,"object stop key must have value")];if(s&&s>r4(i[0].zoom))return[new ey(o,i[0].zoom,"stop zoom values must appear in ascending order")];r4(i[0].zoom)!==s&&(s=r4(i[0].zoom),a=void 0,n={}),r=r.concat(r8({key:`${o}[0]`,value:i[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:r9,value:c}}))}else r=r.concat(c({key:`${o}[0]`,value:i[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},i));return rH(r6(i[1]))?r.concat([new ey(`${o}[1]`,i[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${o}[1]`,value:i[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function c(e,s){let o=rN(e.value),l=r4(e.value),u=null!==e.value?e.value:s;if(i){if(o!==i)return[new ey(e.key,u,`${o} stop domain type must match previous stop domain type ${i}`)]}else i=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new ey(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==r){let i=`number expected, ${o} found`;return rO(t)&&void 0===r&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ey(e.key,u,i)]}return"categorical"!==r||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===o&&void 0!==a&&l<a?[new ey(e.key,u,"stop domain values must appear in ascending order")]:(a=l,"categorical"===r&&l in n?[new ey(e.key,u,"stop domain values must be unique")]:(n[l]=!0,[])):[new ey(e.key,u,`integer expected, found ${l}`)]}}function it(e){let t=("property"===e.expressionContext?rW:rZ)(r6(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new ey(`${e.key}${t.key}`,e.value,t.message));let r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new ey(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!rP(r))return[new ey(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!rP(r))return[new ey(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!rR(r,["zoom","feature-state"]))return[new ey(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!rC(r))return[new ey(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ir(e){let t=e.key,r=e.value,i=e.valueSpec,a=[];return Array.isArray(i.values)?-1===i.values.indexOf(r4(r))&&a.push(new ey(t,r,`expected one of [${i.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(i.values).indexOf(r4(r))&&a.push(new ey(t,r,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(r)} found`)),a}function ii(e){return rX(r6(e.value))?it(ev({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){let r=t.value,i=t.key;if("array"!==rN(r))return[new ey(i,r,`array expected, ${rN(r)} found`)];let a=t.styleSpec,s,n=[];if(r.length<1)return[new ey(i,r,"filter array must have at least 1 element")];switch(n=n.concat(ir({key:`${i}[0]`,value:r[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),r4(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===r4(r[1])&&n.push(new ey(i,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&n.push(new ey(i,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&"string"!==(s=rN(r[1]))&&n.push(new ey(`${i}[1]`,r[1],`string expected, ${s} found`));for(let e=2;e<r.length;e++)s=rN(r[e]),"$type"===r4(r[1])?n=n.concat(ir({key:`${i}[${e}]`,value:r[e],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==s&&"number"!==s&&"boolean"!==s&&n.push(new ey(`${i}[${e}]`,r[e],`string, number, or boolean expected, ${s} found`));break;case"any":case"all":case"none":for(let a=1;a<r.length;a++)n=n.concat(e({key:`${i}[${a}]`,value:r[a],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":s=rN(r[1]),2!==r.length?n.push(new ey(i,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==s&&n.push(new ey(`${i}[1]`,r[1],`string expected, ${s} found`))}return n}(e)}function ia(e,t){let r;let i=e.key,a=e.validateSpec,s=e.style,n=e.styleSpec,o=e.value,l=e.objectKey,u=n[`${t}_${e.layerType}`];if(!u)return[];let h=l.match(/^(.*)-transition$/);if("paint"===t&&h&&u[h[1]]&&u[h[1]].transition)return a({key:i,value:o,valueSpec:n.transition,style:s,styleSpec:n});let c=e.valueSpec||u[l];if(!c)return[new ey(i,o,`unknown property "${l}"`)];if("string"===rN(o)&&rO(c)&&!c.tokens&&(r=/^{([^}]+)}$/.exec(o)))return[new ey(i,o,`"${l}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(r[1])} }\`.`)];let d=[];return"symbol"===e.layerType&&("text-field"===l&&s&&!s.glyphs&&d.push(new ey(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&rD(r6(o))&&"identity"===r4(o.type)&&d.push(new ey(i,o,'"text-font" does not support identity functions'))),d.concat(a({key:e.key,value:o,valueSpec:c,style:s,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:l}))}function is(e){return ia(e,"paint")}function io(e){return ia(e,"layout")}function il(e){let t=[],r=e.value,i=e.key,a=e.style,s=e.styleSpec;r.type||r.ref||t.push(new ey(i,r,'either "type" or "ref" is required'));let n=r4(r.type),o=r4(r.ref);if(r.id){let s=r4(r.id);for(let n=0;n<e.arrayIndex;n++){let e=a.layers[n];r4(e.id)===s&&t.push(new ey(i,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in r&&t.push(new ey(i,r[e],`"${e}" is prohibited for ref layers`))}),a.layers.forEach(t=>{r4(t.id)===o&&(e=t)}),e?e.ref?t.push(new ey(i,r.ref,"ref cannot reference another ref layer")):n=r4(e.type):t.push(new ey(i,r.ref,`ref layer "${o}" not found`))}else if("background"!==n){if(r.source){let e=a.sources&&a.sources[r.source],s=e&&r4(e.type);e?"vector"===s&&"raster"===n?t.push(new ey(i,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==s&&"hillshade"===n?t.push(new ey(i,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===s&&"raster"!==n?t.push(new ey(i,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==s||r["source-layer"]?"raster-dem"===s&&"hillshade"!==n?t.push(new ey(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===n&&r.paint&&r.paint["line-gradient"]&&("geojson"!==s||!e.lineMetrics)&&t.push(new ey(i,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ey(i,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new ey(i,r.source,`source "${r.source}" not found`))}else t.push(new ey(i,r,'missing required property "source"'))}return t=t.concat(r8({key:i,value:r,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${i}.type`,value:r.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:ii,layout:e=>r8({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>io(ev({layerType:n},e))}}),paint:e=>r8({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>is(ev({layerType:n},e))}})}}))}function iu(e){let t=e.value,r=e.key,i=rN(t);return"string"!==i?[new ey(r,t,`string expected, ${i} found`)]:[]}let ih={promoteId:function({key:e,value:t}){if("string"===rN(t))return iu({key:e,value:t});{let r=[];for(let i in t)r.push(...iu({key:`${e}.${i}`,value:t[i]}));return r}}};function ic(e){let t;let r=e.value,i=e.key,a=e.styleSpec,s=e.style,n=e.validateSpec;if(!r.type)return[new ey(i,r,'"type" is required')];let o=r4(r.type);switch(o){case"vector":case"raster":return r8({key:i,value:r,valueSpec:a[`source_${o.replace("-","_")}`],style:e.style,styleSpec:a,objectElementValidators:ih,validateSpec:n});case"raster-dem":return function(e){var t;let r=null!==(t=e.sourceName)&&void 0!==t?t:"",i=e.value,a=e.styleSpec,s=a.source_raster_dem,n=e.style,o=[],l=rN(i);if(void 0===i)return o;if("object"!==l)return o.push(new ey("source_raster_dem",i,`object expected, ${l} found`)),o;let u="custom"===r4(i.encoding),h=["redFactor","greenFactor","blueFactor","baseShift"],c=e.value.encoding?`"${e.value.encoding}"`:"Default";for(let t in i)!u&&h.includes(t)?o.push(new ey(t,i[t],`In "${r}": "${t}" is only valid when "encoding" is set to "custom". ${c} encoding found`)):s[t]?o=o.concat(e.validateSpec({key:t,value:i[t],valueSpec:s[t],validateSpec:e.validateSpec,style:n,styleSpec:a})):o.push(new ey(t,i[t],`unknown property "${t}"`));return o}({sourceName:i,value:r,style:e.style,styleSpec:a,validateSpec:n});case"geojson":if(t=r8({key:i,value:r,valueSpec:a.source_geojson,style:s,styleSpec:a,validateSpec:n,objectElementValidators:ih}),r.cluster)for(let e in r.clusterProperties){let[a,s]=r.clusterProperties[e],o="string"==typeof a?[a,["accumulated"],["get",e]]:a;t.push(...it({key:`${i}.${e}.map`,value:s,validateSpec:n,expressionContext:"cluster-map"})),t.push(...it({key:`${i}.${e}.reduce`,value:o,validateSpec:n,expressionContext:"cluster-reduce"}))}return t;case"video":return r8({key:i,value:r,valueSpec:a.source_video,style:s,validateSpec:n,styleSpec:a});case"image":return r8({key:i,value:r,valueSpec:a.source_image,style:s,validateSpec:n,styleSpec:a});case"canvas":return[new ey(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ir({key:`${i}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:s,validateSpec:n,styleSpec:a})}}function id(e){let t=e.value,r=e.styleSpec,i=r.light,a=e.style,s=[],n=rN(t);if(void 0===t)return s;if("object"!==n)return s.concat([new ey("light",t,`object expected, ${n} found`)]);for(let n in t){let o=n.match(/^(.*)-transition$/);s=s.concat(o&&i[o[1]]&&i[o[1]].transition?e.validateSpec({key:n,value:t[n],valueSpec:r.transition,validateSpec:e.validateSpec,style:a,styleSpec:r}):i[n]?e.validateSpec({key:n,value:t[n],valueSpec:i[n],validateSpec:e.validateSpec,style:a,styleSpec:r}):[new ey(n,t[n],`unknown property "${n}"`)])}return s}function ip(e){let t=e.value,r=e.styleSpec,i=r.sky,a=e.style,s=rN(t);if(void 0===t)return[];if("object"!==s)return[new ey("sky",t,`object expected, ${s} found`)];let n=[];for(let s in t)n=n.concat(i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:a,styleSpec:r}):[new ey(s,t[s],`unknown property "${s}"`)]);return n}function im(e){let t=e.value,r=e.styleSpec,i=r.terrain,a=e.style,s=[],n=rN(t);if(void 0===t)return s;if("object"!==n)return s.concat([new ey("terrain",t,`object expected, ${n} found`)]);for(let n in t)s=s.concat(i[n]?e.validateSpec({key:n,value:t[n],valueSpec:i[n],validateSpec:e.validateSpec,style:a,styleSpec:r}):[new ey(n,t[n],`unknown property "${n}"`)]);return s}function ig(e){let t=[],r=e.value,i=e.key;if(Array.isArray(r)){let a=[],s=[];for(let n in r)r[n].id&&a.includes(r[n].id)&&t.push(new ey(i,r,`all the sprites' ids must be unique, but ${r[n].id} is duplicated`)),a.push(r[n].id),r[n].url&&s.includes(r[n].url)&&t.push(new ey(i,r,`all the sprites' URLs must be unique, but ${r[n].url} is duplicated`)),s.push(r[n].url),t=t.concat(r8({key:`${i}[${n}]`,value:r[n],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return iu({key:i,value:r})}let iy={"*":()=>[],array:r7,boolean:function(e){let t=e.value,r=e.key,i=rN(t);return"boolean"!==i?[new ey(r,t,`boolean expected, ${i} found`)]:[]},number:r9,color:function(e){let t=e.key,r=e.value,i=rN(r);return"string"!==i?[new ey(t,r,`color expected, ${i} found`)]:e3.parse(String(r))?[]:[new ey(t,r,`color expected, "${r}" found`)]},constants:r3,enum:ir,filter:ii,function:ie,layer:il,object:r8,source:ic,light:id,sky:ip,terrain:im,projection:function(e){let t=e.value,r=e.styleSpec,i=r.projection,a=e.style,s=rN(t);if(void 0===t)return[];if("object"!==s)return[new ey("projection",t,`object expected, ${s} found`)];let n=[];for(let s in t)n=n.concat(i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:a,styleSpec:r}):[new ey(s,t[s],`unknown property "${s}"`)]);return n},string:iu,formatted:function(e){return 0===iu(e).length?[]:it(e)},resolvedImage:function(e){return 0===iu(e).length?[]:it(e)},padding:function(e){let t=e.key,r=e.value;if("array"===rN(r)){if(r.length<1||r.length>4)return[new ey(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let i={type:"number"},a=[];for(let s=0;s<r.length;s++)a=a.concat(e.validateSpec({key:`${t}[${s}]`,value:r[s],validateSpec:e.validateSpec,valueSpec:i}));return a}return r9({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(e){let t=e.key,r=e.value,i=rN(r),a=e.styleSpec;if("array"!==i||r.length<1||r.length%2!=0)return[new ey(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let s=[];for(let i=0;i<r.length;i+=2)s=(s=s.concat(ir({key:`${t}[${i}]`,value:r[i],valueSpec:a.layout_symbol["text-anchor"]}))).concat(r7({key:`${t}[${i+1}]`,value:r[i+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:a}));return s},sprite:ig};function iv(e){let t=e.value,r=e.valueSpec,i=e.styleSpec;return e.validateSpec=iv,r.expression&&rD(r4(t))?ie(e):r.expression&&rH(r6(t))?it(e):r.type&&iy[r.type]?iy[r.type](e):r8(ev({},e,{valueSpec:r.type?i[r.type]:r}))}function i_(e){let t=e.value,r=e.key,i=iu(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new ey(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new ey(r,t,'"glyphs" url must include a "{range}" token'))),i}function ix(e,t=el){let r=[];return r=r.concat(iv({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:iv,objectElementValidators:{glyphs:i_,"*":()=>[]}})),e.constants&&(r=r.concat(r3({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:iv}))),iS(r)}function ib(e){return function(t){return e({...t,validateSpec:iv})}}function iS(e){return[].concat(e).sort((e,t)=>e.line-t.line)}function iw(e){return function(...t){return iS(e.apply(this,t))}}ix.source=iw(ib(ic)),ix.sprite=iw(ib(ig)),ix.glyphs=iw(ib(i_)),ix.light=iw(ib(id)),ix.sky=iw(ib(ip)),ix.terrain=iw(ib(im)),ix.layer=iw(ib(il)),ix.filter=iw(ib(ii)),ix.paintProperty=iw(ib(is)),ix.layoutProperty=iw(ib(io));let iE=ix.light,iA=ix.sky,iT=ix.paintProperty,iC=ix.layoutProperty;function iP(e,t){let r=!1;if(t&&t.length)for(let i of t)e.fire(new en(Error(i.message))),r=!0;return r}class iR{constructor(e,t,r){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let a=new Int32Array(this.arrayBuffer);e=a[0],this.d=(t=a[1])+2*(r=a[2]);for(let e=0;e<this.d*this.d;e++){let t=a[3+e],r=a[3+e+1];i.push(t===r?null:a.subarray(t,r))}let s=a[3+i.length+1];this.keys=a.subarray(a[3+i.length],s),this.bboxes=a.subarray(s),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;let a=r/t*e;this.min=-a,this.max=e+a}insert(e,t,r,i,a){this._forEachCell(t,r,i,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(a)}_insertReadonly(){throw Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,i,a,s){this.cells[a].push(s)}query(e,t,r,i,a){let s=this.min,n=this.max;if(e<=s&&t<=s&&n<=r&&n<=i&&!a)return Array.prototype.slice.call(this.keys);{let s=[];return this._forEachCell(e,t,r,i,this._queryCell,s,{},a),s}}_queryCell(e,t,r,i,a,s,n,o){let l=this.cells[a];if(null!==l){let a=this.keys,u=this.bboxes;for(let h=0;h<l.length;h++){let c=l[h];if(void 0===n[c]){let l=4*c;(o?o(u[l+0],u[l+1],u[l+2],u[l+3]):e<=u[l+2]&&t<=u[l+3]&&r>=u[l+0]&&i>=u[l+1])?(n[c]=!0,s.push(a[c])):n[c]=!1}}}}_forEachCell(e,t,r,i,a,s,n,o){let l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),h=this._convertToCellCoord(r),c=this._convertToCellCoord(i);for(let d=l;d<=h;d++)for(let l=u;l<=c;l++){let u=this.d*l+d;if((!o||o(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&a.call(this,e,t,r,i,u,s,n,o))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,t=3+this.cells.length+1+1,r=0;for(let e=0;e<this.cells.length;e++)r+=this.cells[e].length;let i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let a=t;for(let t=0;t<e.length;t++){let r=e[t];i[3+t]=a,i.set(r,a),a+=r.length}return i[3+e.length]=a,i.set(this.keys,a),a+=this.keys.length,i[3+e.length+1]=a,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer}static serialize(e,t){let r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new iR(e.buffer)}}let iI={};function iL(e,t,r={}){if(iI[e])throw Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),iI[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(let e in iL("Object",Object),iL("TransferableGridIndex",iR),iL("Color",e3),iL("Error",Error),iL("AJAXError",Q),iL("ResolvedImage",tt),iL("StylePropertyFunction",r$),iL("StyleExpression",rU,{omit:["_evaluator"]}),iL("ZoomDependentExpression",rY),iL("ZoomConstantExpression",rV),iL("CompoundExpression",rS,{omit:["_evaluate"]}),rb)rb[e]._classRegistryKey||iL(`Expression_${e}`,rb[e]);function iO(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function iM(e){return e.$name||e.constructor._classRegistryKey}function ik(e){return!function(e){if(null===e||"object"!=typeof e)return!1;let t=iM(e);return!(!t||"Object"===t)}(e)&&(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||iO(e)||Z(e)||ArrayBuffer.isView(e)||e instanceof ImageData)}function iN(e,t){if(ik(e))return(iO(e)||Z(e))&&t&&t.push(e),ArrayBuffer.isView(e)&&t&&t.push(e.buffer),e instanceof ImageData&&t&&t.push(e.data.buffer),e;if(Array.isArray(e)){let r=[];for(let i of e)r.push(iN(i,t));return r}if("object"!=typeof e)throw Error("can't serialize object of type "+typeof e);let r=iM(e);if(!r)throw Error(`can't serialize object of unregistered class ${e.constructor.name}`);if(!iI[r])throw Error(`${r} is not registered.`);let{klass:i}=iI[r],a=i.serialize?i.serialize(e,t):{};if(i.serialize){if(t&&a===t[t.length-1])throw Error("statically serialized object won't survive transfer of $name property")}else{for(let i in e){if(!e.hasOwnProperty(i)||iI[r].omit.indexOf(i)>=0)continue;let s=e[i];a[i]=iI[r].shallow.indexOf(i)>=0?s:iN(s,t)}e instanceof Error&&(a.message=e.message)}if(a.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(a.$name=r),a}function iD(e){if(ik(e))return e;if(Array.isArray(e))return e.map(iD);if("object"!=typeof e)throw Error("can't deserialize object of type "+typeof e);let t=iM(e)||"Object";if(!iI[t])throw Error(`can't deserialize unregistered class ${t}`);let{klass:r}=iI[t];if(!r)throw Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);let i=Object.create(r.prototype);for(let r of Object.keys(e)){if("$name"===r)continue;let a=e[r];i[r]=iI[t].shallow.indexOf(r)>=0?a:iD(a)}return i}class iF{constructor(){this.first=!0}update(e,t){let r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}let iG={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function iz(e){for(let t of e)if(iq(t.charCodeAt(0)))return!0;return!1}function iq(e){return!(746!==e&&747!==e&&(e<4352||!(iG["Bopomofo Extended"](e)||iG.Bopomofo(e)||iG["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||iG["CJK Compatibility Ideographs"](e)||iG["CJK Compatibility"](e)||iG["CJK Radicals Supplement"](e)||iG["CJK Strokes"](e)||!(!iG["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||iG["CJK Unified Ideographs Extension A"](e)||iG["CJK Unified Ideographs"](e)||iG["Enclosed CJK Letters and Months"](e)||iG["Hangul Compatibility Jamo"](e)||iG["Hangul Jamo Extended-A"](e)||iG["Hangul Jamo Extended-B"](e)||iG["Hangul Jamo"](e)||iG["Hangul Syllables"](e)||iG.Hiragana(e)||iG["Ideographic Description Characters"](e)||iG.Kanbun(e)||iG["Kangxi Radicals"](e)||iG["Katakana Phonetic Extensions"](e)||iG.Katakana(e)&&12540!==e||!(!iG["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!iG["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||iG["Unified Canadian Aboriginal Syllabics"](e)||iG["Unified Canadian Aboriginal Syllabics Extended"](e)||iG["Vertical Forms"](e)||iG["Yijing Hexagram Symbols"](e)||iG["Yi Syllables"](e)||iG["Yi Radicals"](e))))}function ij(e){return!(iq(e)||iG["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||iG["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||iG["Letterlike Symbols"](e)||iG["Number Forms"](e)||iG["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||iG["Control Pictures"](e)&&9251!==e||iG["Optical Character Recognition"](e)||iG["Enclosed Alphanumerics"](e)||iG["Geometric Shapes"](e)||iG["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||iG["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||iG["CJK Symbols and Punctuation"](e)||iG.Katakana(e)||iG["Private Use Area"](e)||iG["CJK Compatibility Forms"](e)||iG["Small Form Variants"](e)||iG["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}function iB(e){return e>=1424&&e<=2303||iG["Arabic Presentation Forms-A"](e)||iG["Arabic Presentation Forms-B"](e)}let iU=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class iH{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new iF,this.transition={})}isSupportedScript(e){return function(e,t){for(let i of e){var r;if(r=i.charCodeAt(0),!t&&iB(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||iG.Khmer(r))return!1}return!0}(e,"loaded"===iU.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}class iZ{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(rD(e))return new r$(e,t);if(rH(e)){let r=rW(e,t);if("error"===r.result)throw Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));return r.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=e3.parse(e):"padding"===t.type&&("number"==typeof e||Array.isArray(e))?r=e7.parse(e):"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(r=te.parse(e)),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class iV{constructor(e){this.property=e,this.value=new iZ(e,void 0)}transitioned(e,t){return new iW(this.property,this.value,t,N({},e.transition,this.transition),e.now)}untransitioned(){return new iW(this.property,this.value,null,{},0)}}class iY{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return z(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new iV(this._values[e].property)),this._values[e].value=new iZ(this._values[e].property,null===t?void 0:z(t))}getTransition(e){return z(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new iV(this._values[e].property)),this._values[e].transition=z(t)||void 0}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);void 0!==r&&(e[t]=r);let i=this.getTransition(t);void 0!==i&&(e[`${t}-transition`]=i)}return e}transitioned(e,t){let r=new i$(this._properties);for(let i of Object.keys(this._values))r._values[i]=this._values[i].transitioned(e,t._values[i]);return r}untransitioned(){let e=new i$(this._properties);for(let t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class iW{constructor(e,t,r,i,a){this.property=e,this.value=t,this.begin=a+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){let i=e.now||0,a=this.value.possiblyEvaluate(e,t,r),s=this.prior;if(s){if(i>this.end||this.value.isDataDriven())return this.prior=null,a;if(i<this.begin)return s.possiblyEvaluate(e,t,r);{let n=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(e,t,r),a,function(e){if(e<=0)return 0;if(e>=1)return 1;let t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(n))}}return a}}class i${constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){let i=new iJ(this._properties);for(let a of Object.keys(this._values))i._values[a]=this._values[a].possiblyEvaluate(e,t,r);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class iX{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return z(this._values[e].value)}setValue(e,t){this._values[e]=new iZ(this._values[e].property,null===t?void 0:z(t))}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){let i=new iJ(this._properties);for(let a of Object.keys(this._values))i._values[a]=this._values[a].possiblyEvaluate(e,t,r);return i}}class iK{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,i){return this.property.evaluate(this.value,this.parameters,e,t,r,i)}}class iJ{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class iQ{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){let i=tP[this.specification.type];return i?i(e,t,r):e}}class i0{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,i){return new iK(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,i)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new iK(this,{kind:"constant",value:void 0},e.parameters);let i=tP[this.specification.type];return i?new iK(this,{kind:"constant",value:i(e.value.value,t.value.value,r)},e.parameters):e}evaluate(e,t,r,i,a,s){return"constant"===e.kind?e.value:e.evaluate(t,r,i,a,s)}}class i1 extends i0{possiblyEvaluate(e,t,r,i){if(void 0===e.value)return new iK(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){let a=e.expression.evaluate(t,null,{},r,i),s="resolvedImage"===e.property.specification.type&&"string"!=typeof a?a.name:a;return new iK(this,{kind:"constant",value:this._calculate(s,s,s,t)},t)}return"camera"===e.expression.kind?new iK(this,{kind:"constant",value:this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t)},t):new iK(this,e.expression,t)}evaluate(e,t,r,i,a,s){if("source"===e.kind){let n=e.evaluate(t,r,i,a,s);return this._calculate(n,n,n,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,i),e.evaluate({zoom:Math.floor(t.zoom)},r,i),e.evaluate({zoom:Math.floor(t.zoom)+1},r,i),t):e.value}_calculate(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class i2{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,i){if(void 0!==e.value){if("constant"===e.expression.kind){let a=e.expression.evaluate(t,null,{},r,i);return this._calculate(a,a,a,t)}return this._calculate(e.expression.evaluate(new iH(Math.floor(t.zoom-1),t)),e.expression.evaluate(new iH(Math.floor(t.zoom),t)),e.expression.evaluate(new iH(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class i5{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,i){return!!e.expression.evaluate(t,null,{},r,i)}interpolate(){return!1}}class i3{constructor(e){for(let t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){let r=e[t];r.specification.overridable&&this.overridableProperties.push(t);let i=this.defaultPropertyValues[t]=new iZ(r,void 0),a=this.defaultTransitionablePropertyValues[t]=new iV(r);this.defaultTransitioningPropertyValues[t]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=i.possiblyEvaluate({})}}}iL("DataDrivenProperty",i0),iL("DataConstantProperty",iQ),iL("CrossFadedDataDrivenProperty",i1),iL("CrossFadedProperty",i2),iL("ColorRampProperty",i5);let i4="-transition";class i6 extends eo{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new iX(t.layout)),t.paint)){for(let r in this._transitionablePaint=new iY(t.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(let t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new iJ(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){null!=t&&this._validate(iC,`layers.${this.id}.layout.${e}`,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(i4)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(iT,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(e.endsWith(i4))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{let r=this._transitionablePaint._values[e],i="cross-faded-data-driven"===r.property.specification["property-type"],a=r.value.isDataDriven(),s=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);let n=this._transitionablePaint._values[e].value;return n.isDataDriven()||a||i||this._handleOverridablePaintPropertyUpdate(e,s,n)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),G(e,(e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length))}_validate(e,t,r,i,a={}){return(!a||!1!==a.validate)&&iP(this,e.call(ix,{key:t,layerType:this.type,objectKey:r,value:i,styleSpec:el,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let t=this.paint.get(e);if(t instanceof iK&&rO(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}let i8={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class i7{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class i9{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ae(e,t=1){let r=0,i=0;return{members:e.map(e=>{let a=i8[e.type].BYTES_PER_ELEMENT,s=r=at(r,Math.max(t,a)),n=e.components||1;return i=Math.max(i,a),r+=a*n,{name:e.name,type:e.type,components:n,offset:s}}),size:at(r,Math.max(i,t)),alignment:t}}function at(e,t){return Math.ceil(e/t)*t}class ar extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.int16[i+0]=t,this.int16[i+1]=r,e}}ar.prototype.bytesPerElement=4,iL("StructArrayLayout2i4",ar);class ai extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let a=3*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=i,e}}ai.prototype.bytesPerElement=6,iL("StructArrayLayout3i6",ai);class aa extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i)}emplace(e,t,r,i,a){let s=4*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=i,this.int16[s+3]=a,e}}aa.prototype.bytesPerElement=8,iL("StructArrayLayout4i8",aa);class as extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i,a,s)}emplace(e,t,r,i,a,s,n){let o=6*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=i,this.int16[o+3]=a,this.int16[o+4]=s,this.int16[o+5]=n,e}}as.prototype.bytesPerElement=12,iL("StructArrayLayout2i4i12",as);class an extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i,a,s)}emplace(e,t,r,i,a,s,n){let o=4*e,l=8*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.uint8[l+4]=i,this.uint8[l+5]=a,this.uint8[l+6]=s,this.uint8[l+7]=n,e}}an.prototype.bytesPerElement=8,iL("StructArrayLayout2i4ub8",an);class ao extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.float32[i+0]=t,this.float32[i+1]=r,e}}ao.prototype.bytesPerElement=8,iL("StructArrayLayout2f8",ao);class al extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s,n,o,l,u){let h=this.length;return this.resize(h+1),this.emplace(h,e,t,r,i,a,s,n,o,l,u)}emplace(e,t,r,i,a,s,n,o,l,u,h){let c=10*e;return this.uint16[c+0]=t,this.uint16[c+1]=r,this.uint16[c+2]=i,this.uint16[c+3]=a,this.uint16[c+4]=s,this.uint16[c+5]=n,this.uint16[c+6]=o,this.uint16[c+7]=l,this.uint16[c+8]=u,this.uint16[c+9]=h,e}}al.prototype.bytesPerElement=20,iL("StructArrayLayout10ui20",al);class au extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s,n,o,l,u,h,c){let d=this.length;return this.resize(d+1),this.emplace(d,e,t,r,i,a,s,n,o,l,u,h,c)}emplace(e,t,r,i,a,s,n,o,l,u,h,c,d){let p=12*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=i,this.int16[p+3]=a,this.uint16[p+4]=s,this.uint16[p+5]=n,this.uint16[p+6]=o,this.uint16[p+7]=l,this.int16[p+8]=u,this.int16[p+9]=h,this.int16[p+10]=c,this.int16[p+11]=d,e}}au.prototype.bytesPerElement=24,iL("StructArrayLayout4i4ui4i24",au);class ah extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let a=3*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=i,e}}ah.prototype.bytesPerElement=12,iL("StructArrayLayout3f12",ah);class ac extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}ac.prototype.bytesPerElement=4,iL("StructArrayLayout1ul4",ac);class ad extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s,n,o,l){let u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,i,a,s,n,o,l)}emplace(e,t,r,i,a,s,n,o,l,u){let h=10*e;return this.int16[h+0]=t,this.int16[h+1]=r,this.int16[h+2]=i,this.int16[h+3]=a,this.int16[h+4]=s,this.int16[h+5]=n,this.uint32[5*e+3]=o,this.uint16[h+8]=l,this.uint16[h+9]=u,e}}ad.prototype.bytesPerElement=20,iL("StructArrayLayout6i1ul2ui20",ad);class ap extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i,a,s)}emplace(e,t,r,i,a,s,n){let o=6*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=i,this.int16[o+3]=a,this.int16[o+4]=s,this.int16[o+5]=n,e}}ap.prototype.bytesPerElement=12,iL("StructArrayLayout2i2i2i12",ap);class af extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,i,a)}emplace(e,t,r,i,a,s){let n=4*e,o=8*e;return this.float32[n+0]=t,this.float32[n+1]=r,this.float32[n+2]=i,this.int16[o+6]=a,this.int16[o+7]=s,e}}af.prototype.bytesPerElement=16,iL("StructArrayLayout2f1f2i16",af);class am extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i,a,s)}emplace(e,t,r,i,a,s,n){let o=16*e,l=4*e,u=8*e;return this.uint8[o+0]=t,this.uint8[o+1]=r,this.float32[l+1]=i,this.float32[l+2]=a,this.int16[u+6]=s,this.int16[u+7]=n,e}}am.prototype.bytesPerElement=16,iL("StructArrayLayout2ub2f2i16",am);class ag extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let a=3*e;return this.uint16[a+0]=t,this.uint16[a+1]=r,this.uint16[a+2]=i,e}}ag.prototype.bytesPerElement=6,iL("StructArrayLayout3ui6",ag);class ay extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g){let y=this.length;return this.resize(y+1),this.emplace(y,e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g)}emplace(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y){let v=24*e,_=12*e,x=48*e;return this.int16[v+0]=t,this.int16[v+1]=r,this.uint16[v+2]=i,this.uint16[v+3]=a,this.uint32[_+2]=s,this.uint32[_+3]=n,this.uint32[_+4]=o,this.uint16[v+10]=l,this.uint16[v+11]=u,this.uint16[v+12]=h,this.float32[_+7]=c,this.float32[_+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[_+10]=g,this.int16[v+22]=y,e}}ay.prototype.bytesPerElement=48,iL("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ay);class av extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C){let P=this.length;return this.resize(P+1),this.emplace(P,e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C)}emplace(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C,P){let R=32*e,I=16*e;return this.int16[R+0]=t,this.int16[R+1]=r,this.int16[R+2]=i,this.int16[R+3]=a,this.int16[R+4]=s,this.int16[R+5]=n,this.int16[R+6]=o,this.int16[R+7]=l,this.uint16[R+8]=u,this.uint16[R+9]=h,this.uint16[R+10]=c,this.uint16[R+11]=d,this.uint16[R+12]=p,this.uint16[R+13]=f,this.uint16[R+14]=m,this.uint16[R+15]=g,this.uint16[R+16]=y,this.uint16[R+17]=v,this.uint16[R+18]=_,this.uint16[R+19]=x,this.uint16[R+20]=b,this.uint16[R+21]=S,this.uint16[R+22]=w,this.uint32[I+12]=E,this.float32[I+13]=A,this.float32[I+14]=T,this.uint16[R+30]=C,this.uint16[R+31]=P,e}}av.prototype.bytesPerElement=64,iL("StructArrayLayout8i15ui1ul2f2ui64",av);class a_ extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}a_.prototype.bytesPerElement=4,iL("StructArrayLayout1f4",a_);class ax extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let a=3*e;return this.uint16[6*e+0]=t,this.float32[a+1]=r,this.float32[a+2]=i,e}}ax.prototype.bytesPerElement=12,iL("StructArrayLayout1ui2f12",ax);class ab extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let a=4*e;return this.uint32[2*e+0]=t,this.uint16[a+2]=r,this.uint16[a+3]=i,e}}ab.prototype.bytesPerElement=8,iL("StructArrayLayout1ul2ui8",ab);class aS extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,e}}aS.prototype.bytesPerElement=4,iL("StructArrayLayout2ui4",aS);class aw extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}aw.prototype.bytesPerElement=2,iL("StructArrayLayout1ui2",aw);class aE extends i9{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i)}emplace(e,t,r,i,a){let s=4*e;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=i,this.float32[s+3]=a,e}}aE.prototype.bytesPerElement=16,iL("StructArrayLayout4f16",aE);class aA extends i7{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new T(this.anchorPointX,this.anchorPointY)}}aA.prototype.size=20;class aT extends ad{get(e){return new aA(this,e)}}iL("CollisionBoxArray",aT);class aC extends i7{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}aC.prototype.size=48;class aP extends ay{get(e){return new aC(this,e)}}iL("PlacedSymbolArray",aP);class aR extends i7{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}aR.prototype.size=64;class aI extends av{get(e){return new aR(this,e)}}iL("SymbolInstanceArray",aI);class aL extends a_{getoffsetX(e){return this.float32[1*e+0]}}iL("GlyphOffsetArray",aL);class aO extends ai{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}iL("SymbolLineVertexArray",aO);class aM extends i7{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}aM.prototype.size=12;class ak extends ax{get(e){return new aM(this,e)}}iL("TextAnchorOffsetArray",ak);class aN extends i7{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}aN.prototype.size=8;class aD extends ab{get(e){return new aN(this,e)}}iL("FeatureIndexArray",aD);class aF extends ar{}class aG extends ar{}class az extends ar{}class aq extends as{}class aj extends an{}class aB extends ao{}class aU extends al{}class aH extends au{}class aZ extends ah{}class aV extends ac{}class aY extends ap{}class aW extends am{}class a$ extends ag{}class aX extends aS{}let{members:aK}=ae([{name:"a_pos",components:2,type:"Int16"}],4);class aJ{constructor(e=[]){this.segments=e}prepareSegment(e,t,r,i){let a=this.segments[this.segments.length-1];return e>aJ.MAX_VERTEX_ARRAY_LENGTH&&j(`Max vertices per segment is ${aJ.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!a||a.vertexLength+e>aJ.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==i)&&(a={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==i&&(a.sortKey=i),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,i){return new aJ([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])}}function aQ(e,t){return 256*(e=M(Math.floor(e),0,255))+M(Math.floor(t),0,255)}aJ.MAX_VERTEX_ARRAY_LENGTH=65535,iL("SegmentVector",aJ);let a0=ae([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var a1={exports:{}},a2={exports:{}};a2.exports=function(e,t){var r,i,a,s,n,o;for(i=e.length-(r=3&e.length),a=t,o=0;o<i;)n=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24,++o,a=27492+(65535&(s=5*(65535&(a=(a^=n=(65535&(n=(n=(65535&n)*3432918353+(((n>>>16)*3432918353&65535)<<16)&4294967295)<<15|n>>>17))*461845907+(((n>>>16)*461845907&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(n=0,r){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:a^=n=(65535&(n=(n=(65535&(n^=255&e.charCodeAt(o)))*3432918353+(((n>>>16)*3432918353&65535)<<16)&4294967295)<<15|n>>>17))*461845907+(((n>>>16)*461845907&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0};var a5=a2.exports,a3={exports:{}};a3.exports=function(e,t){for(var r,i=e.length,a=t^i,s=0;i>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(r>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++s;switch(i){case 3:a^=(255&e.charCodeAt(s+2))<<16;case 2:a^=(255&e.charCodeAt(s+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(s)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0};var a4=a3.exports;a1.exports=a5,a1.exports.murmur3=a5,a1.exports.murmur2=a4;var a6=x(a1.exports);class a8{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,i){this.ids.push(a7(e)),this.positions.push(t,r,i)}getPositions(e){if(!this.indexed)throw Error("Trying to get index, but feature positions are not indexed");let t=a7(e),r=0,i=this.ids.length-1;for(;r<i;){let e=r+i>>1;this.ids[e]>=t?i=e:r=e+1}let a=[];for(;this.ids[r]===t;)a.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return a}static serialize(e,t){let r=new Float64Array(e.ids),i=new Uint32Array(e.positions);return function e(t,r,i,a){for(;i<a;){let s=t[i+a>>1],n=i-1,o=a+1;for(;;){do n++;while(t[n]<s)do o--;while(t[o]>s)if(n>=o)break;a9(t,n,o),a9(r,3*n,3*o),a9(r,3*n+1,3*o+1),a9(r,3*n+2,3*o+2)}o-i<a-o?(e(t,r,i,o),i=o+1):(e(t,r,o+1,a),a=o)}}(r,i,0,r.length-1),t&&t.push(r.buffer,i.buffer),{ids:r,positions:i}}static deserialize(e){let t=new a8;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function a7(e){let t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:a6(String(e))}function a9(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}iL("FeaturePositionMap",a8);class se{constructor(e,t){this.gl=e.gl,this.location=t}}class st extends se{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class sr extends se{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class si extends se{constructor(e,t){super(e,t),this.current=e3.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}let sa=new Float32Array(16);function ss(e){return[aQ(255*e.r,255*e.g),aQ(255*e.b,255*e.a)]}class sn{constructor(e,t,r){this.value=e,this.uniformNames=t.map(e=>`u_${e}`),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new si(e,t):new st(e,t)}}class so{constructor(e,t){this.uniformNames=t.map(e=>`u_${e}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,i){let a="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)?new sr(e,t):new st(e,t)}}class sl{constructor(e,t,r,i){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,t,r,i,a){let s=this.paintVertexArray.length,n=this.expression.evaluate(new iH(0),t,{},i,[],a);this.paintVertexArray.resize(e),this._setPaintValue(s,e,n)}updatePaintArray(e,t,r,i){let a=this.expression.evaluate({zoom:0},r,i);this._setPaintValue(e,t,a)}_setPaintValue(e,t,r){if("color"===this.type){let i=ss(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class su{constructor(e,t,r,i,a,s){this.expression=e,this.uniformNames=t.map(e=>`u_${e}_t`),this.type=r,this.useIntegerZoom=i,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,t,r,i,a){let s=this.expression.evaluate(new iH(this.zoom),t,{},i,[],a),n=this.expression.evaluate(new iH(this.zoom+1),t,{},i,[],a),o=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(o,e,s,n)}updatePaintArray(e,t,r,i){let a=this.expression.evaluate({zoom:this.zoom},r,i),s=this.expression.evaluate({zoom:this.zoom+1},r,i);this._setPaintValue(e,t,a,s)}_setPaintValue(e,t,r,i){if("color"===this.type){let a=ss(r),s=ss(i);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,a[0],a[1],s[0],s[1])}else{for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,r,i);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){let r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,i=M(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,t,r){return new st(e,t)}}class sh{constructor(e,t,r,i,a,s){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=i,this.layerId=s,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,t,r){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,i,a){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],a)}_setPaintValues(e,t,r,i){if(!i||!r)return;let{min:a,mid:s,max:n}=r,o=i[a],l=i[s],u=i[n];if(o&&l&&u)for(let r=e;r<t;r++)this.zoomInPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],l.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,a0.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,a0.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class sc{constructor(e,t,r){this.binders={},this._buffers=[];let i=[];for(let s in e.paint._values){var a;if(!r(s))continue;let n=e.paint.get(s);if(!(n instanceof iK&&rO(n.property.specification)))continue;let o=(a=e.type,({"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]})[s]||[s.replace(`${a}-`,"").replace(/-/g,"_")]),l=n.value,u=n.property.specification.type,h=n.property.useIntegerZoom,c=n.property.specification["property-type"],d="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===l.kind)this.binders[s]=d?new so(l.value,o):new sn(l.value,o,u),i.push(`/u_${s}`);else if("source"===l.kind||d){let r=sp(s,u,"source");this.binders[s]=d?new sh(l,u,h,t,r,e.id):new sl(l,o,u,r),i.push(`/a_${s}`)}else{let e=sp(s,u,"composite");this.binders[s]=new su(l,o,u,h,t,e),i.push(`/z_${s}`)}}this.cacheKey=i.sort().join("")}getMaxValue(e){let t=this.binders[e];return t instanceof sl||t instanceof su?t.maxValue:0}populatePaintArrays(e,t,r,i,a){for(let s in this.binders){let n=this.binders[s];(n instanceof sl||n instanceof su||n instanceof sh)&&n.populatePaintArray(e,t,r,i,a)}}setConstantPatternPositions(e,t){for(let r in this.binders){let i=this.binders[r];i instanceof so&&i.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,i,a){let s=!1;for(let n in e)for(let o of t.getPositions(n)){let t=r.feature(o.index);for(let r in this.binders){let l=this.binders[r];if((l instanceof sl||l instanceof su||l instanceof sh)&&!0===l.expression.isStateDependent){let u=i.paint.get(r);l.expression=u.value,l.updatePaintArray(o.start,o.end,t,e[n],a),s=!0}}}return s}defines(){let e=[];for(let t in this.binders){let r=this.binders[t];(r instanceof sn||r instanceof so)&&e.push(...r.uniformNames.map(e=>`#define HAS_UNIFORM_${e}`))}return e}getBinderAttributes(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof sl||r instanceof su)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof sh)for(let t=0;t<a0.members.length;t++)e.push(a0.members[t].name)}return e}getBinderUniforms(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof sn||r instanceof so||r instanceof su)for(let t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){let r=[];for(let i in this.binders){let a=this.binders[i];if(a instanceof sn||a instanceof so||a instanceof su){for(let s of a.uniformNames)if(t[s]){let n=a.getBinding(e,t[s],s);r.push({name:s,property:i,binding:n})}}}return r}setUniforms(e,t,r,i){for(let{name:e,property:a,binding:s}of t)this.binders[a].setUniform(s,i,r.get(a),e)}updatePaintBuffers(e){for(let t in this._buffers=[],this.binders){let r=this.binders[t];if(e&&r instanceof sh){let t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof sl||r instanceof su)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(let t in this.binders){let r=this.binders[t];(r instanceof sl||r instanceof su||r instanceof sh)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let t=this.binders[e];(t instanceof sl||t instanceof su||t instanceof sh)&&t.destroy()}}}class sd{constructor(e,t,r=()=>!0){for(let i of(this.programConfigurations={},e))this.programConfigurations[i.id]=new sc(i,t,r);this.needsUpload=!1,this._featureMap=new a8,this._bufferOffset=0}populatePaintArrays(e,t,r,i,a,s){for(let r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,i,a,s);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,i){for(let a of r)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}}function sp(e,t,r){let i={"line-pattern":{source:aU,composite:aU},"fill-pattern":{source:aU,composite:aU},"fill-extrusion-pattern":{source:aU,composite:aU}}[e];return i&&i[r]||({color:{source:ao,composite:aE},number:{source:a_,composite:ao}})[t][r]}iL("ConstantBinder",sn),iL("CrossFadedConstantBinder",so),iL("SourceExpressionBinder",sl),iL("CrossFadedCompositeBinder",sh),iL("CompositeExpressionBinder",su),iL("ProgramConfiguration",sc,{omit:["_buffers"]}),iL("ProgramConfigurationSet",sd);let sf=-16383-1;function sm(e){let t=8192/e.extent,r=e.loadGeometry();for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<i.length;e++){let r=i[e],a=Math.round(r.x*t),s=Math.round(r.y*t);r.x=M(a,sf,16383),r.y=M(s,sf,16383),(a<r.x||a>r.x+1||s<r.y||s>r.y+1)&&j("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function sg(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?sm(e):[]}}function sy(e,t,r,i,a){e.emplaceBack(2*t+(i+1)/2,2*r+(a+1)/2)}class sv{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new aG,this.indexArray=new a$,this.segments=new aJ,this.programConfigurations=new sd(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){let i=this.layers[0],a=[],s=null,n=!1;for(let{feature:t,id:o,index:l,sourceLayerIndex:u}of("circle"===i.type&&(n=!(s=i.layout.get("circle-sort-key")).isConstant()),e)){let e=this.layers[0]._featureFilter.needGeometry,i=sg(t,e);if(!this.layers[0]._featureFilter.filter(new iH(this.zoom),i,r))continue;let h=n?s.evaluate(i,{},r):void 0,c={id:o,properties:t.properties,type:t.type,sourceLayerIndex:u,index:l,geometry:e?i.geometry:sm(t),patterns:{},sortKey:h};a.push(c)}for(let i of(n&&a.sort((e,t)=>e.sortKey-t.sortKey),a)){let{geometry:a,index:s,sourceLayerIndex:n}=i,o=e[s].feature;this.addFeature(i,a,s,r),t.featureIndex.insert(o,a,s,n,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,aK),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,i){for(let r of t)for(let t of r){let r=t.x,i=t.y;if(r<0||r>=8192||i<0||i>=8192)continue;let a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),s=a.vertexLength;sy(this.layoutVertexArray,r,i,-1,-1),sy(this.layoutVertexArray,r,i,1,-1),sy(this.layoutVertexArray,r,i,1,1),sy(this.layoutVertexArray,r,i,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+3,s+2),a.vertexLength+=4,a.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},i)}}function s_(e,t){for(let r=0;r<e.length;r++)if(sA(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(sA(e,t[r]))return!0;return!!sb(e,t)}function sx(e,t){if(1===e.length)return sE(t,e[0]);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<i.length;t++)if(sA(e,i[t]))return!0}for(let r=0;r<e.length;r++)if(sE(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(sb(e,t[r]))return!0;return!1}function sb(e,t){if(0===e.length||0===t.length)return!1;for(let a=0;a<e.length-1;a++){let s=e[a],n=e[a+1];for(let e=0;e<t.length-1;e++){var r,i;if(B(s,r=t[e],i=t[e+1])!==B(n,r,i)&&B(s,n,r)!==B(s,n,i))return!0}}return!1}function sS(e,t,r){let i=r*r;if(1===t.length)return e.distSqr(t[0])<i;for(let r=1;r<t.length;r++)if(sw(e,t[r-1],t[r])<i)return!0;return!1}function sw(e,t,r){let i=t.distSqr(r);if(0===i)return e.distSqr(t);let a=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/i;return e.distSqr(a<0?t:a>1?r:r.sub(t)._mult(a)._add(t))}function sE(e,t){let r,i,a,s=!1;for(let n=0;n<e.length;n++){r=e[n];for(let e=0,n=r.length-1;e<r.length;n=e++)i=r[e],a=r[n],i.y>t.y!=a.y>t.y&&t.x<(a.x-i.x)*(t.y-i.y)/(a.y-i.y)+i.x&&(s=!s)}return s}function sA(e,t){let r=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){let s=e[i],n=e[a];s.y>t.y!=n.y>t.y&&t.x<(n.x-s.x)*(t.y-s.y)/(n.y-s.y)+s.x&&(r=!r)}return r}function sT(e,t,r){let i=t.paint.get(e).value;return"constant"===i.kind?i.value:r.programConfigurations.get(t.id).getMaxValue(e)}function sC(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function sP(e,t,r,i,a){if(!t[0]&&!t[1])return e;let s=T.convert(t)._mult(a);"viewport"===r&&s._rotate(-i);let n=[];for(let t=0;t<e.length;t++)n.push(e[t].sub(s));return n}iL("CircleBucket",sv,{omit:["layers"]});var sR={get paint(){return n=n||new i3({"circle-radius":new i0(el.paint_circle["circle-radius"]),"circle-color":new i0(el.paint_circle["circle-color"]),"circle-blur":new i0(el.paint_circle["circle-blur"]),"circle-opacity":new i0(el.paint_circle["circle-opacity"]),"circle-translate":new iQ(el.paint_circle["circle-translate"]),"circle-translate-anchor":new iQ(el.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new iQ(el.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new iQ(el.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new i0(el.paint_circle["circle-stroke-width"]),"circle-stroke-color":new i0(el.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new i0(el.paint_circle["circle-stroke-opacity"])})},get layout(){return s=s||new i3({"circle-sort-key":new i0(el.layout_circle["circle-sort-key"])})}},sI="undefined"!=typeof Float32Array?Float32Array:Array;function sL(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function sO(e,t,r){var i=t[0],a=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],h=t[7],c=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=t[15],_=r[0],x=r[1],b=r[2],S=r[3];return e[0]=_*i+x*o+b*c+S*m,e[1]=_*a+x*l+b*d+S*g,e[2]=_*s+x*u+b*p+S*y,e[3]=_*n+x*h+b*f+S*v,e[4]=(_=r[4])*i+(x=r[5])*o+(b=r[6])*c+(S=r[7])*m,e[5]=_*a+x*l+b*d+S*g,e[6]=_*s+x*u+b*p+S*y,e[7]=_*n+x*h+b*f+S*v,e[8]=(_=r[8])*i+(x=r[9])*o+(b=r[10])*c+(S=r[11])*m,e[9]=_*a+x*l+b*d+S*g,e[10]=_*s+x*u+b*p+S*y,e[11]=_*n+x*h+b*f+S*v,e[12]=(_=r[12])*i+(x=r[13])*o+(b=r[14])*c+(S=r[15])*m,e[13]=_*a+x*l+b*d+S*g,e[14]=_*s+x*u+b*p+S*y,e[15]=_*n+x*h+b*f+S*v,e}function sM(e,t,r){var i=t[0],a=t[1],s=t[2],n=t[3];return e[0]=r[0]*i+r[4]*a+r[8]*s+r[12]*n,e[1]=r[1]*i+r[5]*a+r[9]*s+r[13]*n,e[2]=r[2]*i+r[6]*a+r[10]*s+r[14]*n,e[3]=r[3]*i+r[7]*a+r[11]*s+r[15]*n,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),A=new sI(4),sI!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[3]=0);class sk extends i6{constructor(e){super(e,sR)}createBucket(e){return new sv(e)}queryRadius(e){return sT("circle-radius",this,e)+sT("circle-stroke-width",this,e)+sC(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,i,a,s,n,o){var l;let u=sP(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,n),h=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),d=c?u:u.map(e=>sN(e,o)),p=c?h*n:h;for(let e of i)for(let t of e){let e=c?t:sN(t,o),r=p,i=sM([],[t.x,t.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?r*=i[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(r*=s.cameraToCenterDistance/i[3]),l=r,sA(d,e)||sS(e,d,l))return!0}return!1}}function sN(e,t){let r=sM([],[e.x,e.y,0,1],t);return new T(r[0]/r[3],r[1]/r[3])}class sD extends sv{}iL("HeatmapBucket",sD,{omit:["layers"]});var sF={get paint(){return o=o||new i3({"heatmap-radius":new i0(el.paint_heatmap["heatmap-radius"]),"heatmap-weight":new i0(el.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new iQ(el.paint_heatmap["heatmap-intensity"]),"heatmap-color":new i5(el.paint_heatmap["heatmap-color"]),"heatmap-opacity":new iQ(el.paint_heatmap["heatmap-opacity"])})}};function sG(e,{width:t,height:r},i,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==t*r*i)throw RangeError(`mismatched image size. expected: ${a.length} but got: ${t*r*i}`)}else a=new Uint8Array(t*r*i);return e.width=t,e.height=r,e.data=a,e}function sz(e,{width:t,height:r},i){if(t===e.width&&r===e.height)return;let a=sG({},{width:t,height:r},i);sq(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},i),e.width=t,e.height=r,e.data=a.data}function sq(e,t,r,i,a,s){if(0===a.width||0===a.height)return t;if(a.width>e.width||a.height>e.height||r.x>e.width-a.width||r.y>e.height-a.height)throw RangeError("out of range source coordinates for image copy");if(a.width>t.width||a.height>t.height||i.x>t.width-a.width||i.y>t.height-a.height)throw RangeError("out of range destination coordinates for image copy");let n=e.data,o=t.data;if(n===o)throw Error("srcData equals dstData, so image is already copied");for(let l=0;l<a.height;l++){let u=((r.y+l)*e.width+r.x)*s,h=((i.y+l)*t.width+i.x)*s;for(let e=0;e<a.width*s;e++)o[h+e]=n[u+e]}return t}class sj{constructor(e,t){sG(this,e,1,t)}resize(e){sz(this,e,1)}clone(){return new sj({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,i,a){sq(e,t,r,i,a,1)}}class sB{constructor(e,t){sG(this,e,4,t)}resize(e){sz(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new sB({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,i,a){sq(e,t,r,i,a,4)}}function sU(e){let t={},r=e.resolution||256,i=e.clips?e.clips.length:1,a=e.image||new sB({width:r,height:i});if(Math.log(r)/Math.LN2%1!=0)throw Error(`width is not a power of 2 - ${r}`);let s=(r,i,s)=>{t[e.evaluationKey]=s;let n=e.expression.evaluate(t);a.data[r+i+0]=Math.floor(255*n.r/n.a),a.data[r+i+1]=Math.floor(255*n.g/n.a),a.data[r+i+2]=Math.floor(255*n.b/n.a),a.data[r+i+3]=Math.floor(255*n.a)};if(e.clips)for(let t=0,a=0;t<i;++t,a+=4*r)for(let i=0,n=0;i<r;i++,n+=4){let o=i/(r-1),{start:l,end:u}=e.clips[t];s(a,n,l*(1-o)+u*o)}else for(let e=0,t=0;e<r;e++,t+=4)s(0,t,e/(r-1));return a}iL("AlphaImage",sj),iL("RGBAImage",sB);class sH extends i6{createBucket(e){return new sD(e)}constructor(e){super(e,sF),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sU({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}var sZ={get paint(){return l=l||new i3({"hillshade-illumination-direction":new iQ(el.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new iQ(el.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new iQ(el.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new iQ(el.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new iQ(el.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new iQ(el.paint_hillshade["hillshade-accent-color"])})}};class sV extends i6{constructor(e){super(e,sZ)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}let{members:sY}=ae([{name:"a_pos",components:2,type:"Int16"}],4);var sW={exports:{}};function s$(e,t,r){r=r||2;var i,a,s,n,o,l,u,h=t&&t.length,c=h?t[0]*r:e.length,d=sX(e,0,c,r,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(e,t,r,i){var a,s,n,o=[];for(a=0,s=t.length;a<s;a++)(n=sX(e,t[a]*i,a<s-1?t[a+1]*i:e.length,i,!1))===n.next&&(n.steiner=!0),o.push(function(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(n));for(o.sort(sJ),a=0;a<o.length;a++)r=function(e,t){var r=function(e,t){var r,i,a,s=t,n=e.x,o=e.y,l=-1/0;do{if(o<=s.y&&o>=s.next.y&&s.next.y!==s.y){var u=s.x+(o-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(u<=n&&u>l&&(l=u,a=s.x<s.next.x?s:s.next,u===n))return a}s=s.next}while(s!==t)if(!a)return null;var h,c=a,d=a.x,p=a.y,f=1/0;s=a;do n>=s.x&&s.x>=d&&n!==s.x&&s0(o<p?n:l,o,d,p,o<p?l:n,o,s.x,s.y)&&(h=Math.abs(o-s.y)/(n-s.x),s6(s,e)&&(h<f||h===f&&(s.x>a.x||s.x===a.x&&(r=a,i=s,0>s1(r.prev,r,i.prev)&&0>s1(i.next,r,r.next))))&&(a=s,f=h)),s=s.next;while(s!==c)return a}(e,t);if(!r)return t;var i=s8(r,e);return sK(i,i.next),sK(r,r.next)}(o[a],r);return r}(e,t,d,r)),e.length>80*r){i=s=e[0],a=n=e[1];for(var f=r;f<c;f+=r)(o=e[f])<i&&(i=o),(l=e[f+1])<a&&(a=l),o>s&&(s=o),l>n&&(n=l);u=0!==(u=Math.max(s-i,n-a))?32767/u:0}return function e(t,r,i,a,s,n,o){if(t){!o&&n&&function(e,t,r,i){var a=e;do 0===a.z&&(a.z=sQ(a.x,a.y,t,r,i)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e)a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,r,i,a,s,n,o,l,u=1;do{for(r=e,e=null,s=null,n=0;r;){for(n++,i=r,o=0,t=0;t<u&&(o++,i=i.nextZ);t++);for(l=u;o>0||l>0&&i;)0!==o&&(0===l||!i||r.z<=i.z)?(a=r,r=r.nextZ,o--):(a=i,i=i.nextZ,l--),s?s.nextZ=a:e=a,a.prevZ=s,s=a;r=i}s.nextZ=null,u*=2}while(n>1)}(a)}(t,a,s,n);for(var l,u,h=t;t.prev!==t.next;)if(l=t.prev,u=t.next,n?function(e,t,r,i){var a=e.prev,s=e.next;if(s1(a,e,s)>=0)return!1;for(var n=a.x,o=e.x,l=s.x,u=a.y,h=e.y,c=s.y,d=n<o?n<l?n:l:o<l?o:l,p=u<h?u<c?u:c:h<c?h:c,f=n>o?n>l?n:l:o>l?o:l,m=u>h?u>c?u:c:h>c?h:c,g=sQ(d,p,t,r,i),y=sQ(f,m,t,r,i),v=e.prevZ,_=e.nextZ;v&&v.z>=g&&_&&_.z<=y;){if(v.x>=d&&v.x<=f&&v.y>=p&&v.y<=m&&v!==a&&v!==s&&s0(n,u,o,h,l,c,v.x,v.y)&&s1(v.prev,v,v.next)>=0||(v=v.prevZ,_.x>=d&&_.x<=f&&_.y>=p&&_.y<=m&&_!==a&&_!==s&&s0(n,u,o,h,l,c,_.x,_.y)&&s1(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;v&&v.z>=g;){if(v.x>=d&&v.x<=f&&v.y>=p&&v.y<=m&&v!==a&&v!==s&&s0(n,u,o,h,l,c,v.x,v.y)&&s1(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;_&&_.z<=y;){if(_.x>=d&&_.x<=f&&_.y>=p&&_.y<=m&&_!==a&&_!==s&&s0(n,u,o,h,l,c,_.x,_.y)&&s1(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}(t,a,s,n):function(e){var t=e.prev,r=e.next;if(s1(t,e,r)>=0)return!1;for(var i=t.x,a=e.x,s=r.x,n=t.y,o=e.y,l=r.y,u=i<a?i<s?i:s:a<s?a:s,h=n<o?n<l?n:l:o<l?o:l,c=i>a?i>s?i:s:a>s?a:s,d=n>o?n>l?n:l:o>l?o:l,p=r.next;p!==t;){if(p.x>=u&&p.x<=c&&p.y>=h&&p.y<=d&&s0(i,n,a,o,s,l,p.x,p.y)&&s1(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}(t))r.push(l.i/i|0),r.push(t.i/i|0),r.push(u.i/i|0),s9(t),t=u.next,h=u.next;else if((t=u)===h){o?1===o?e(t=function(e,t,r){var i=e;do{var a=i.prev,s=i.next.next;!s2(a,s)&&s5(a,i,i.next,s)&&s6(a,s)&&s6(s,a)&&(t.push(a.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),s9(i),s9(i.next),i=e=s),i=i.next}while(i!==e)return sK(i)}(sK(t),r,i),r,i,a,s,n,2):2===o&&function(t,r,i,a,s,n){var o=t;do{for(var l,u,h=o.next.next;h!==o.prev;){if(o.i!==h.i&&(l=o,u=h,l.next.i!==u.i&&l.prev.i!==u.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&s5(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(l,u)&&(s6(l,u)&&s6(u,l)&&function(e,t){var r=e,i=!1,a=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&a<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e)return i}(l,u)&&(s1(l.prev,l,u.prev)||s1(l,u.prev,u))||s2(l,u)&&s1(l.prev,l,l.next)>0&&s1(u.prev,u,u.next)>0))){var c=s8(o,h);return o=sK(o,o.next),c=sK(c,c.next),e(o,r,i,a,s,n,0),void e(c,r,i,a,s,n,0)}h=h.next}o=o.next}while(o!==t)}(t,r,i,a,s,n):e(sK(t),r,i,a,s,n,1);break}}}(d,p,r,i,a,u,0),p}function sX(e,t,r,i,a){var s,n;if(a===nt(e,t,r,i)>0)for(s=t;s<r;s+=i)n=s7(s,e[s],e[s+1],n);else for(s=r-i;s>=t;s-=i)n=s7(s,e[s],e[s+1],n);return n&&s2(n,n.next)&&(s9(n),n=n.next),n}function sK(e,t){if(!e)return e;t||(t=e);var r,i=e;do if(r=!1,i.steiner||!s2(i,i.next)&&0!==s1(i.prev,i,i.next))i=i.next;else{if(s9(i),(i=t=i.prev)===i.next)break;r=!0}while(r||i!==t)return t}function sJ(e,t){return e.x-t.x}function sQ(e,t,r,i,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*a|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*a|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function s0(e,t,r,i,a,s,n,o){return(a-n)*(t-o)>=(e-n)*(s-o)&&(e-n)*(i-o)>=(r-n)*(t-o)&&(r-n)*(s-o)>=(a-n)*(i-o)}function s1(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function s2(e,t){return e.x===t.x&&e.y===t.y}function s5(e,t,r,i){var a=s4(s1(e,t,r)),s=s4(s1(e,t,i)),n=s4(s1(r,i,e)),o=s4(s1(r,i,t));return a!==s&&n!==o||!(0!==a||!s3(e,r,t))||!(0!==s||!s3(e,i,t))||!(0!==n||!s3(r,e,i))||!(0!==o||!s3(r,t,i))}function s3(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function s4(e){return e>0?1:e<0?-1:0}function s6(e,t){return 0>s1(e.prev,e,e.next)?s1(e,t,e.next)>=0&&s1(e,e.prev,t)>=0:0>s1(e,t,e.prev)||0>s1(e,e.next,t)}function s8(e,t){var r=new ne(e.i,e.x,e.y),i=new ne(t.i,t.x,t.y),a=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function s7(e,t,r,i){var a=new ne(e,t,r);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function s9(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ne(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nt(e,t,r,i){for(var a=0,s=t,n=r-i;s<r;s+=i)a+=(e[n]-e[s])*(e[s+1]+e[n+1]),n=s;return a}sW.exports=s$,sW.exports.default=s$,s$.deviation=function(e,t,r,i){var a=t&&t.length,s=Math.abs(nt(e,0,a?t[0]*r:e.length,r));if(a)for(var n=0,o=t.length;n<o;n++)s-=Math.abs(nt(e,t[n]*r,n<o-1?t[n+1]*r:e.length,r));var l=0;for(n=0;n<i.length;n+=3){var u=i[n]*r,h=i[n+1]*r,c=i[n+2]*r;l+=Math.abs((e[u]-e[c])*(e[h+1]-e[u+1])-(e[u]-e[h])*(e[c+1]-e[u+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},s$.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,a=0;a<e.length;a++){for(var s=0;s<e[a].length;s++)for(var n=0;n<t;n++)r.vertices.push(e[a][s][n]);a>0&&r.holes.push(i+=e[a-1].length)}return r};var nr=x(sW.exports);function ni(e,t,r){let i=r.patternDependencies,a=!1;for(let r of t){let t=r.paint.get(`${e}-pattern`);t.isConstant()||(a=!0);let s=t.constantOr(null);s&&(a=!0,i[s.to]=!0,i[s.from]=!0)}return a}function na(e,t,r,i,a){let s=a.patternDependencies;for(let n of t){let t=n.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:i-1},r,{},a.availableImages),o=t.evaluate({zoom:i},r,{},a.availableImages),l=t.evaluate({zoom:i+1},r,{},a.availableImages);e=e&&e.name?e.name:e,o=o&&o.name?o.name:o,l=l&&l.name?l.name:l,s[e]=!0,s[o]=!0,s[l]=!0,r.patterns[n.id]={min:e,mid:o,max:l}}}return r}class ns{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new az,this.indexArray=new a$,this.indexArray2=new aX,this.programConfigurations=new sd(e.layers,e.zoom),this.segments=new aJ,this.segments2=new aJ,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){this.hasPattern=ni("fill",this.layers,t);let i=this.layers[0].layout.get("fill-sort-key"),a=!i.isConstant(),s=[];for(let{feature:n,id:o,index:l,sourceLayerIndex:u}of e){let e=this.layers[0]._featureFilter.needGeometry,h=sg(n,e);if(!this.layers[0]._featureFilter.filter(new iH(this.zoom),h,r))continue;let c=a?i.evaluate(h,{},r,t.availableImages):void 0,d={id:o,properties:n.properties,type:n.type,sourceLayerIndex:u,index:l,geometry:e?h.geometry:sm(n),patterns:{},sortKey:c};s.push(d)}for(let i of(a&&s.sort((e,t)=>e.sortKey-t.sortKey),s)){let{geometry:a,index:s,sourceLayerIndex:n}=i;if(this.hasPattern){let e=na("fill",this.layers,i,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(i,a,s,r,{});t.featureIndex.insert(e[s].feature,a,s,n,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sY),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,i,a){for(let e of t9(t,500)){let t=0;for(let r of e)t+=r.length;let r=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),i=r.vertexLength,a=[],s=[];for(let t of e){if(0===t.length)continue;t!==e[0]&&s.push(a.length/2);let r=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),i=r.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(i+t.length-1,i),a.push(t[0].x),a.push(t[0].y);for(let e=1;e<t.length;e++)this.layoutVertexArray.emplaceBack(t[e].x,t[e].y),this.indexArray2.emplaceBack(i+e-1,i+e),a.push(t[e].x),a.push(t[e].y);r.vertexLength+=t.length,r.primitiveLength+=t.length}let n=nr(a,s);for(let e=0;e<n.length;e+=3)this.indexArray.emplaceBack(i+n[e],i+n[e+1],i+n[e+2]);r.vertexLength+=t,r.primitiveLength+=n.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,i)}}iL("FillBucket",ns,{omit:["layers","patternFeatures"]});var nn={get paint(){return h=h||new i3({"fill-antialias":new iQ(el.paint_fill["fill-antialias"]),"fill-opacity":new i0(el.paint_fill["fill-opacity"]),"fill-color":new i0(el.paint_fill["fill-color"]),"fill-outline-color":new i0(el.paint_fill["fill-outline-color"]),"fill-translate":new iQ(el.paint_fill["fill-translate"]),"fill-translate-anchor":new iQ(el.paint_fill["fill-translate-anchor"]),"fill-pattern":new i1(el.paint_fill["fill-pattern"])})},get layout(){return u=u||new i3({"fill-sort-key":new i0(el.layout_fill["fill-sort-key"])})}};class no extends i6{constructor(e){super(e,nn)}recalculate(e,t){super.recalculate(e,t);let r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new ns(e)}queryRadius(){return sC(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,i,a,s,n){return sx(sP(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,n),i)}isTileClipped(){return!0}}let nl=ae([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),nu=ae([{name:"a_centroid",components:2,type:"Int16"}],4),{members:nh}=nl;var nc={};function nd(e,t,r,i,a){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=a,e.readFields(np,this,t)}function np(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var i=t._keys[e.readVarint()],a=t._values[e.readVarint()];t.properties[i]=a}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function nf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(nm,this,t),this.length=this._features.length}function nm(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var i=e.readVarint()>>3;t=1===i?e.readString():2===i?e.readFloat():3===i?e.readDouble():4===i?e.readVarint64():5===i?e.readVarint():6===i?e.readSVarint():7===i?e.readBoolean():null}return t}(r))}function ng(e,t,r){if(3===e){var i=new nf(r,r.readVarint()+r.pos);i.length&&(t[i.name]=i)}}nd.types=["Unknown","Point","LineString","Polygon"],nd.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,i=1,a=0,s=0,n=0,o=[];e.pos<r;){if(a<=0){var l=e.readVarint();i=7&l,a=l>>3}if(a--,1===i||2===i)s+=e.readSVarint(),n+=e.readSVarint(),1===i&&(t&&o.push(t),t=[]),t.push(new b(s,n));else{if(7!==i)throw Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&o.push(t),o},nd.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,i=0,a=0,s=0,n=1/0,o=-1/0,l=1/0,u=-1/0;e.pos<t;){if(i<=0){var h=e.readVarint();r=7&h,i=h>>3}if(i--,1===r||2===r)(a+=e.readSVarint())<n&&(n=a),a>o&&(o=a),(s+=e.readSVarint())<l&&(l=s),s>u&&(u=s);else if(7!==r)throw Error("unknown command "+r)}return[n,l,o,u]},nd.prototype.toGeoJSON=function(e,t,r){var i,a,s=this.extent*Math.pow(2,r),n=this.extent*e,o=this.extent*t,l=this.loadGeometry(),u=nd.types[this.type];function h(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+n)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+o)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var c=[];for(i=0;i<l.length;i++)c[i]=l[i][0];h(l=c);break;case 2:for(i=0;i<l.length;i++)h(l[i]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var r,i,a=[],s=0;s<t;s++){var n=function(e){for(var t,r,i=0,a=0,s=e.length,n=s-1;a<s;n=a++)i+=((r=e[n]).x-(t=e[a]).x)*(t.y+r.y);return i}(e[s]);0!==n&&(void 0===i&&(i=n<0),i===n<0?(r&&a.push(r),r=[e[s]]):r.push(e[s]))}return r&&a.push(r),a}(l),i=0;i<l.length;i++)for(a=0;a<l[i].length;a++)h(l[i][a])}1===l.length?l=l[0]:u="Multi"+u;var d={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d},nf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new nd(this._pbf,t,this.extent,this._keys,this._values)},nc.VectorTile=function(e,t){this.layers=e.readFields(ng,{},t)},nc.VectorTileFeature=nd,nc.VectorTileLayer=nf;let ny=nc.VectorTileFeature.types;function nv(e,t,r,i,a,s,n,o){e.emplaceBack(t,r,2*Math.floor(8192*i)+n,16384*a,16384*s,Math.round(o))}class n_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new aq,this.centroidVertexArray=new aF,this.indexArray=new a$,this.programConfigurations=new sd(e.layers,e.zoom),this.segments=new aJ,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){for(let{feature:i,id:a,index:s,sourceLayerIndex:n}of(this.features=[],this.hasPattern=ni("fill-extrusion",this.layers,t),e)){let e=this.layers[0]._featureFilter.needGeometry,o=sg(i,e);if(!this.layers[0]._featureFilter.filter(new iH(this.zoom),o,r))continue;let l={id:a,sourceLayerIndex:n,index:s,geometry:e?o.geometry:sm(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(na("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,s,r,{}),t.featureIndex.insert(i,l.geometry,s,n,this.index,!0)}}addFeatures(e,t,r){for(let e of this.features){let{geometry:i}=e;this.addFeature(e,i,e.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nh),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,nu.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,i,a){for(let r of t9(t,500)){let t={x:0,y:0,vertexCount:0},i=0;for(let e of r)i+=e.length;let a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let e of r){var s;if(0===e.length||(s=e).every(e=>e.x<0)||s.every(e=>e.x>8192)||s.every(e=>e.y<0)||s.every(e=>e.y>8192))continue;let r=0;for(let i=0;i<e.length;i++){let s=e[i];if(i>=1){let n=e[i-1];if((s.x!==n.x||!(s.x<0)&&!(s.x>8192))&&(s.y!==n.y||!(s.y<0)&&!(s.y>8192))){a.vertexLength+4>aJ.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let e=s.sub(n)._perp()._unit(),i=n.dist(s);r+i>32768&&(r=0),nv(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,0,r),nv(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,1,r),t.x+=2*s.x,t.y+=2*s.y,t.vertexCount+=2,r+=i,nv(this.layoutVertexArray,n.x,n.y,e.x,e.y,0,0,r),nv(this.layoutVertexArray,n.x,n.y,e.x,e.y,0,1,r),t.x+=2*n.x,t.y+=2*n.y,t.vertexCount+=2;let o=a.vertexLength;this.indexArray.emplaceBack(o,o+2,o+1),this.indexArray.emplaceBack(o+1,o+2,o+3),a.vertexLength+=4,a.primitiveLength+=2}}}}if(a.vertexLength+i>aJ.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray)),"Polygon"!==ny[e.type])continue;let n=[],o=[],l=a.vertexLength;for(let e of r)if(0!==e.length){e!==r[0]&&o.push(n.length/2);for(let r=0;r<e.length;r++){let i=e[r];nv(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),t.x+=i.x,t.y+=i.y,t.vertexCount+=1,n.push(i.x),n.push(i.y)}}let u=nr(n,o);for(let e=0;e<u.length;e+=3)this.indexArray.emplaceBack(l+u[e],l+u[e+2],l+u[e+1]);a.primitiveLength+=u.length/3,a.vertexLength+=i;for(let e=0;e<t.vertexCount;e++){let e=Math.floor(t.x/t.vertexCount),r=Math.floor(t.y/t.vertexCount);this.centroidVertexArray.emplaceBack(e,r)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,i)}}iL("FillExtrusionBucket",n_,{omit:["layers","features"]});var nx={get paint(){return c=c||new i3({"fill-extrusion-opacity":new iQ(el["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new i0(el["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new iQ(el["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new iQ(el["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new i1(el["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new i0(el["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new i0(el["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new iQ(el["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class nb extends i6{constructor(e){super(e,nx)}createBucket(e){return new n_(e)}queryRadius(){return sC(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,i,a,s,n,o){let l=sP(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,n),u=this.paint.get("fill-extrusion-height").evaluate(t,r),h=this.paint.get("fill-extrusion-base").evaluate(t,r),c=function(e,t,r,i){let a=[];for(let r of e){let e=[r.x,r.y,0,1];sM(e,e,t),a.push(new T(e[0]/e[3],e[1]/e[3]))}return a}(l,o),d=function(e,t,r,i){let a=[],s=[],n=i[8]*t,o=i[9]*t,l=i[10]*t,u=i[11]*t,h=i[8]*r,c=i[9]*r,d=i[10]*r,p=i[11]*r;for(let t of e){let e=[],r=[];for(let a of t){let t=a.x,s=a.y,f=i[0]*t+i[4]*s+i[12],m=i[1]*t+i[5]*s+i[13],g=i[2]*t+i[6]*s+i[14],y=i[3]*t+i[7]*s+i[15],v=g+l,_=y+u,x=f+h,b=m+c,S=g+d,w=y+p,E=new T((f+n)/_,(m+o)/_);E.z=v/_,e.push(E);let A=new T(x/w,b/w);A.z=S/w,r.push(A)}a.push(e),s.push(r)}return[a,s]}(i,h,u,o);return function(e,t,r){let i=1/0;sx(r,t)&&(i=nw(r,t[0]));for(let a=0;a<t.length;a++){let s=t[a],n=e[a];for(let e=0;e<s.length-1;e++){let t=s[e],a=[t,s[e+1],n[e+1],n[e],t];s_(r,a)&&(i=Math.min(i,nw(r,a)))}}return i!==1/0&&i}(d[0],d[1],c)}}function nS(e,t){return e.x*t.x+e.y*t.y}function nw(e,t){if(1===e.length){let r,i=0,a=t[i++];for(;!r||a.equals(r);)if(!(r=t[i++]))return 1/0;for(;i<t.length;i++){let s=t[i],n=e[0],o=r.sub(a),l=s.sub(a),u=n.sub(a),h=nS(o,o),c=nS(o,l),d=nS(l,l),p=nS(u,o),f=nS(u,l),m=h*d-c*c,g=(d*p-c*f)/m,y=(h*f-c*p)/m,v=a.z*(1-g-y)+r.z*g+s.z*y;if(isFinite(v))return v}return 1/0}{let e=1/0;for(let r of t)e=Math.min(e,r.z);return e}}let{members:nE}=ae([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:nA}=ae([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),nT=nc.VectorTileFeature.types,nC=Math.cos(Math.PI/180*37.5);class nP{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(e=>{this.gradients[e.id]={}}),this.layoutVertexArray=new aj,this.layoutVertexArray2=new aB,this.indexArray=new a$,this.programConfigurations=new sd(e.layers,e.zoom),this.segments=new aJ,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){this.hasPattern=ni("line",this.layers,t);let i=this.layers[0].layout.get("line-sort-key"),a=!i.isConstant(),s=[];for(let{feature:t,id:n,index:o,sourceLayerIndex:l}of e){let e=this.layers[0]._featureFilter.needGeometry,u=sg(t,e);if(!this.layers[0]._featureFilter.filter(new iH(this.zoom),u,r))continue;let h=a?i.evaluate(u,{},r):void 0,c={id:n,properties:t.properties,type:t.type,sourceLayerIndex:l,index:o,geometry:e?u.geometry:sm(t),patterns:{},sortKey:h};s.push(c)}for(let i of(a&&s.sort((e,t)=>e.sortKey-t.sortKey),s)){let{geometry:a,index:s,sourceLayerIndex:n}=i;if(this.hasPattern){let e=na("line",this.layers,i,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(i,a,s,r,{});t.featureIndex.insert(e[s].feature,a,s,n,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,nA)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nE),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,i,a){let s=this.layers[0].layout,n=s.get("line-join").evaluate(e,{}),o=s.get("line-cap"),l=s.get("line-miter-limit"),u=s.get("line-round-limit");for(let r of(this.lineClips=this.lineFeatureClips(e),t))this.addLine(r,e,n,o,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,i)}addLine(e,t,r,i,a,s){let n,o,l,u,h;if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let c="Polygon"===nT[t.type],d=e.length;for(;d>=2&&e[d-1].equals(e[d-2]);)d--;let p=0;for(;p<d-1&&e[p].equals(e[p+1]);)p++;if(d<(c?3:2))return;"bevel"===r&&(a=1.05);let f=this.overscaling<=16?122880/(512*this.overscaling):0,m=this.segments.prepareSegment(10*d,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,c&&(n=e[d-2],h=e[p].sub(n)._unit()._perp());for(let t=p;t<d;t++){if((l=t===d-1?c?e[p+1]:void 0:e[t+1])&&e[t].equals(l))continue;h&&(u=h),n&&(o=n),n=e[t],h=l?l.sub(n)._unit()._perp():u;let g=(u=u||h).add(h);0===g.x&&0===g.y||g._unit();let y=u.x*h.x+u.y*h.y,v=g.x*h.x+g.y*h.y,_=0!==v?1/v:1/0,x=2*Math.sqrt(2-2*v),b=v<nC&&o&&l,S=u.x*h.y-u.y*h.x>0;if(b&&t>p){let e=n.dist(o);if(e>2*f){let t=n.sub(n.sub(o)._mult(f/e)._round());this.updateDistance(o,t),this.addCurrentVertex(t,u,0,0,m),o=t}}let w=o&&l,E=w?r:c?"butt":i;if(w&&"round"===E&&(_<s?E="miter":_<=2&&(E="fakeround")),"miter"===E&&_>a&&(E="bevel"),"bevel"===E&&(_>2&&(E="flipbevel"),_<a&&(E="miter")),o&&this.updateDistance(o,n),"miter"===E)g._mult(_),this.addCurrentVertex(n,g,0,0,m);else if("flipbevel"===E){if(_>100)g=h.mult(-1);else{let e=_*u.add(h).mag()/u.sub(h).mag();g._perp()._mult(e*(S?-1:1))}this.addCurrentVertex(n,g,0,0,m),this.addCurrentVertex(n,g.mult(-1),0,0,m)}else if("bevel"===E||"fakeround"===E){let e=-Math.sqrt(_*_-1),t=S?e:0,r=S?0:e;if(o&&this.addCurrentVertex(n,u,t,r,m),"fakeround"===E){let e=Math.round(180*x/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){let e=r-.5;r+=r*e*(r-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}let i=h.sub(u)._mult(r)._add(u)._unit()._mult(S?-1:1);this.addHalfVertex(n,i.x,i.y,!1,S,0,m)}}l&&this.addCurrentVertex(n,h,-t,-r,m)}else if("butt"===E)this.addCurrentVertex(n,g,0,0,m);else if("square"===E){let e=o?1:-1;this.addCurrentVertex(n,g,e,e,m)}else"round"===E&&(o&&(this.addCurrentVertex(n,u,0,0,m),this.addCurrentVertex(n,u,1,1,m,!0)),l&&(this.addCurrentVertex(n,h,-1,-1,m,!0),this.addCurrentVertex(n,h,0,0,m)));if(b&&t<d-1){let e=n.dist(l);if(e>2*f){let t=n.add(l.sub(n)._mult(f/e)._round());this.updateDistance(n,t),this.addCurrentVertex(t,h,0,0,m),n=t}}}}addCurrentVertex(e,t,r,i,a,s=!1){let n=t.y*i-t.x,o=-t.y-t.x*i;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,s,!1,r,a),this.addHalfVertex(e,n,o,s,!0,-i,a),this.distance>16384&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,i,a,s))}addHalfVertex({x:e,y:t},r,i,a,s,n,o){let l=.5*(this.lineClips?32767*this.scaledDistance:this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(t<<1)+(s?1:0),Math.round(63*r)+128,Math.round(63*i)+128,1+(0===n?0:n<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let u=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),o.primitiveLength++),s?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}iL("LineBucket",nP,{omit:["layers","patternFeatures"]});var nR={get paint(){return p=p||new i3({"line-opacity":new i0(el.paint_line["line-opacity"]),"line-color":new i0(el.paint_line["line-color"]),"line-translate":new iQ(el.paint_line["line-translate"]),"line-translate-anchor":new iQ(el.paint_line["line-translate-anchor"]),"line-width":new i0(el.paint_line["line-width"]),"line-gap-width":new i0(el.paint_line["line-gap-width"]),"line-offset":new i0(el.paint_line["line-offset"]),"line-blur":new i0(el.paint_line["line-blur"]),"line-dasharray":new i2(el.paint_line["line-dasharray"]),"line-pattern":new i1(el.paint_line["line-pattern"]),"line-gradient":new i5(el.paint_line["line-gradient"])})},get layout(){return d=d||new i3({"line-cap":new iQ(el.layout_line["line-cap"]),"line-join":new i0(el.layout_line["line-join"]),"line-miter-limit":new iQ(el.layout_line["line-miter-limit"]),"line-round-limit":new iQ(el.layout_line["line-round-limit"]),"line-sort-key":new i0(el.layout_line["line-sort-key"])})}};class nI extends i0{possiblyEvaluate(e,t){return t=new iH(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,i){return t=N({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,i)}}class nL extends i6{constructor(e){super(e,nR),this.gradientVersion=0,f||((f=new nI(nR.paint.properties["line-width"].specification)).useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){let e=this.gradientExpression();this.stepInterpolant=void 0!==e._styleExpression&&e._styleExpression.expression instanceof tE,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=f.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new nP(e)}queryRadius(e){var t,r;return t=sT("line-width",this,e),((r=sT("line-gap-width",this,e))>0?r+2*t:t)/2+Math.abs(sT("line-offset",this,e))+sC(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,i,a,s,n){var o,l;let u=sP(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,n),h=n/2*(o=this.paint.get("line-width").evaluate(t,r),(l=this.paint.get("line-gap-width").evaluate(t,r))>0?l+2*o:o),c=this.paint.get("line-offset").evaluate(t,r);return c&&(i=function(e,t){let r=[];for(let i=0;i<e.length;i++){let a=e[i],s=[];for(let e=0;e<a.length;e++){let r=a[e-1],i=a[e],n=a[e+1],o=0===e?new T(0,0):i.sub(r)._unit()._perp(),l=e===a.length-1?new T(0,0):n.sub(i)._unit()._perp(),u=o._add(l)._unit(),h=u.x*l.x+u.y*l.y;0!==h&&u._mult(1/h),s.push(u._mult(t)._add(i))}r.push(s)}return r}(i,c*n)),function(e,t,r){for(let i=0;i<t.length;i++){let a=t[i];if(e.length>=3){for(let t=0;t<a.length;t++)if(sA(e,a[t]))return!0}if(function(e,t,r){if(e.length>1){if(sb(e,t))return!0;for(let i=0;i<t.length;i++)if(sS(t[i],e,r))return!0}for(let i=0;i<e.length;i++)if(sS(e[i],t,r))return!0;return!1}(e,a,r))return!0}return!1}(u,i,h)}isTileClipped(){return!0}}let nO=ae([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nM=ae([{name:"a_projected_pos",components:3,type:"Float32"}],4);ae([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let nk=ae([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ae([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let nN=ae([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nD=ae([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ae([{name:"triangle",components:3,type:"Uint16"}]),ae([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ae([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ae([{type:"Float32",name:"offsetX"}]),ae([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ae([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let nF={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var nG=function(e,t,r,i,a){var s,n,o=8*a-i-1,l=(1<<o)-1,u=l>>1,h=-7,c=r?a-1:0,d=r?-1:1,p=e[t+c];for(c+=d,s=p&(1<<-h)-1,p>>=-h,h+=o;h>0;s=256*s+e[t+c],c+=d,h-=8);for(n=s&(1<<-h)-1,s>>=-h,h+=i;h>0;n=256*n+e[t+c],c+=d,h-=8);if(0===s)s=1-u;else{if(s===l)return n?NaN:1/0*(p?-1:1);n+=Math.pow(2,i),s-=u}return(p?-1:1)*n*Math.pow(2,s-i)},nz=function(e,t,r,i,a,s){var n,o,l,u=8*s-a-1,h=(1<<u)-1,c=h>>1,d=23===a?5960464477539062e-23:0,p=i?0:s-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(o=isNaN(t)?1:0,n=h):(n=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-n))<1&&(n--,l*=2),(t+=n+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(n++,l/=2),n+c>=h?(o=0,n=h):n+c>=1?(o=(t*l-1)*Math.pow(2,a),n+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,a),n=0));a>=8;e[r+p]=255&o,p+=f,o/=256,a-=8);for(n=n<<a|o,u+=a;u>0;e[r+p]=255&n,p+=f,n/=256,u-=8);e[r+p-f]|=128*m};function nq(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}nq.Varint=0,nq.Fixed64=1,nq.Bytes=2,nq.Fixed32=5;var nj="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function nB(e){return e.type===nq.Bytes?e.readVarint()+e.pos:e.pos+1}function nU(e,t,r){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(i);for(var a=r.pos-1;a>=e;a--)r.buf[a+i]=r.buf[a]}function nH(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function nZ(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function nV(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function nY(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function nW(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function n$(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function nX(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nK(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function nJ(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function nQ(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function n0(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function n1(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}nq.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),a=i>>3,s=this.pos;this.type=7&i,e(a,t,this),this.pos===s&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=nQ(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=n1(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=nQ(this.buf,this.pos)+4294967296*nQ(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=nQ(this.buf,this.pos)+4294967296*n1(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=nG(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=nG(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,i=this.buf;return t=127&(r=i[this.pos++]),r<128?t:(t|=(127&(r=i[this.pos++]))<<7,r<128?t:(t|=(127&(r=i[this.pos++]))<<14,r<128?t:(t|=(127&(r=i[this.pos++]))<<21,r<128?t:function(e,t,r){var i,a,s,n=r.buf;if(a=(112&(s=n[r.pos++]))>>4,s<128||(a|=(127&(s=n[r.pos++]))<<3,s<128)||(a|=(127&(s=n[r.pos++]))<<10,s<128)||(a|=(127&(s=n[r.pos++]))<<17,s<128)||(a|=(127&(s=n[r.pos++]))<<24,s<128)||(a|=(1&(s=n[r.pos++]))<<31,s<128))return i=a,t?4294967296*i+(e>>>0):4294967296*(i>>>0)+(e>>>0);throw Error("Expected varint not more than 10 bytes")}(t|=(15&(r=i[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?-((e+1)/2):e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e,t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&nj?(e=this.buf,nj.decode(e.subarray(r,t))):function(e,t,r){for(var i="",a=t;a<r;){var s,n,o,l=e[a],u=null,h=l>239?4:l>223?3:l>191?2:1;if(a+h>r)break;1===h?l<128&&(u=l):2===h?128==(192&(s=e[a+1]))&&(u=(31&l)<<6|63&s)<=127&&(u=null):3===h?(n=e[a+2],128==(192&(s=e[a+1]))&&128==(192&n)&&((u=(15&l)<<12|(63&s)<<6|63&n)<=2047||u>=55296&&u<=57343)&&(u=null)):4===h&&(n=e[a+2],o=e[a+3],128==(192&(s=e[a+1]))&&128==(192&n)&&128==(192&o)&&((u=(15&l)<<18|(63&s)<<12|(63&n)<<6|63&o)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,h=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),a+=h}return i}(this.buf,r,t)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==nq.Bytes)return e.push(this.readVarint(t));var r=nB(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==nq.Bytes)return e.push(this.readSVarint());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==nq.Bytes)return e.push(this.readBoolean());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==nq.Bytes)return e.push(this.readFloat());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==nq.Bytes)return e.push(this.readDouble());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==nq.Bytes)return e.push(this.readFixed32());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==nq.Bytes)return e.push(this.readSFixed32());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==nq.Bytes)return e.push(this.readFixed64());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==nq.Bytes)return e.push(this.readSFixed64());var t=nB(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===nq.Varint)for(;this.buf[this.pos++]>127;);else if(t===nq.Bytes)this.pos=this.readVarint()+this.pos;else if(t===nq.Fixed32)this.pos+=4;else{if(t!==nq.Fixed64)throw Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),n0(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),n0(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),n0(this.buf,-1&e,this.pos),n0(this.buf,Math.floor(23283064365386963e-26*e),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),n0(this.buf,-1&e,this.pos),n0(this.buf,Math.floor(23283064365386963e-26*e),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,i,a,s,n;if(e>=0?(r=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,i=i+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw Error("Given varint doesn't fit into 10 bytes");t.realloc(10),a=r,t.buf[t.pos++]=127&a|128,a>>>=7,t.buf[t.pos++]=127&a|128,a>>>=7,t.buf[t.pos++]=127&a|128,a>>>=7,t.buf[t.pos++]=127&a|128,t.buf[t.pos]=127&(a>>>=7),n=(7&(s=i))<<4,t.buf[t.pos++]|=n|((s>>>=3)?128:0),s&&(t.buf[t.pos++]=127&s|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=127&s|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=127&s|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=127&s|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=127&s)))))}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?-(2*e)-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var i,a,s=0;s<t.length;s++){if((i=t.charCodeAt(s))>55295&&i<57344){if(!a){i>56319||s+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=i;continue}if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=i;continue}i=a-55296<<10|i-56320|65536,a=null}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=63&i|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&nU(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),nz(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),nz(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var i=this.pos-r;i>=128&&nU(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,r){this.writeTag(e,nq.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,nH,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,nZ,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,nW,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,nV,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,nY,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,n$,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,nX,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,nK,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,nJ,t)},writeBytesField:function(e,t){this.writeTag(e,nq.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,nq.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,nq.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,nq.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,nq.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,nq.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,nq.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,nq.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,nq.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,nq.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var n2=x(nq);function n5(e,t,r){1===e&&r.readMessage(n3,t)}function n3(e,t,r){if(3===e){let{id:e,bitmap:i,width:a,height:s,left:n,top:o,advance:l}=r.readMessage(n4,{});t.push({id:e,bitmap:new sj({width:a+6,height:s+6},i),metrics:{width:a,height:s,left:n,top:o,advance:l}})}}function n4(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function n6(e){let t=0,r=0;for(let i of e)t+=i.w*i.h,r=Math.max(r,i.w);e.sort((e,t)=>t.h-e.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],a=0,s=0;for(let t of e)for(let e=i.length-1;e>=0;e--){let r=i[e];if(!(t.w>r.w||t.h>r.h)){if(t.x=r.x,t.y=r.y,s=Math.max(s,t.y+t.h),a=Math.max(a,t.x+t.w),t.w===r.w&&t.h===r.h){let t=i.pop();e<i.length&&(i[e]=t)}else t.h===r.h?(r.x+=t.w,r.w-=t.w):(t.w===r.w||i.push({x:r.x+t.w,y:r.y,w:r.w-t.w,h:t.h}),r.y+=t.h,r.h-=t.h);break}}return{w:a,h:s,fill:t/(a*s)||0}}class n8{constructor(e,{pixelRatio:t,version:r,stretchX:i,stretchY:a,content:s,textFitWidth:n,textFitHeight:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=i,this.stretchY=a,this.content=s,this.version=r,this.textFitWidth=n,this.textFitHeight=o}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class n7{constructor(e,t){let r={},i={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,r,a),this.addImages(t,i,a);let{w:s,h:n}=n6(a),o=new sB({width:s||1,height:n||1});for(let t in e){let i=e[t],a=r[t].paddedRect;sB.copy(i.data,o,{x:0,y:0},{x:a.x+1,y:a.y+1},i.data)}for(let e in t){let r=t[e],a=i[e].paddedRect,s=a.x+1,n=a.y+1,l=r.data.width,u=r.data.height;sB.copy(r.data,o,{x:0,y:0},{x:s,y:n},r.data),sB.copy(r.data,o,{x:0,y:u-1},{x:s,y:n-1},{width:l,height:1}),sB.copy(r.data,o,{x:0,y:0},{x:s,y:n+u},{width:l,height:1}),sB.copy(r.data,o,{x:l-1,y:0},{x:s-1,y:n},{width:1,height:u}),sB.copy(r.data,o,{x:0,y:0},{x:s+l,y:n},{width:1,height:u})}this.image=o,this.iconPositions=r,this.patternPositions=i}addImages(e,t,r){for(let i in e){let a=e[i],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};r.push(s),t[i]=new n8(s,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,t){for(let r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t||e.version===t.version)return;e.version=t.version;let[i,a]=e.tl;r.update(t.data,void 0,{x:i,y:a})}}iL("ImagePosition",n8),iL("ImageAtlas",n7),e.ai=void 0,(S=e.ai||(e.ai={}))[S.none=0]="none",S[S.horizontal=1]="horizontal",S[S.vertical=2]="vertical",S[S.horizontalOnly=3]="horizontalOnly";class n9{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){let r=new n9;return r.scale=e||1,r.fontStack=t,r}static forImage(e){let t=new n9;return t.imageName=e,t}}class oe{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){let r=new oe;for(let i=0;i<e.sections.length;i++){let a=e.sections[i];a.image?r.addImageSection(a):r.addTextSection(a,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let r=0;r<e.length;r++){let i=e.charCodeAt(r+1)||null,a=e.charCodeAt(r-1)||null;t+=i&&ij(i)&&!nF[e[r+1]]||a&&ij(a)&&!nF[e[r-1]]||!nF[e[r]]?e[r]:nF[e[r]]}return t}(this.text)}trim(){let e=0;for(let t=0;t<this.text.length&&or[this.text.charCodeAt(t)];t++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&or[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){let r=new oe;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,t)=>Math.max(e,this.sections[t].scale),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(n9.forText(e.scale,e.fontStack||t));let r=this.sections.length-1;for(let t=0;t<e.text.length;++t)this.sectionIndex.push(r)}addImageSection(e){let t=e.image?e.image.name:"";if(0===t.length)return void j("Can't add FormattedSection with an empty image.");let r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(n9.forImage(t)),this.sectionIndex.push(this.sections.length-1)):j("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ot(t,r,i,a,s,n,o,l,u,h,c,d,p,f,m){let g;let y=oe.fromFeature(t,s);d===e.ai.vertical&&y.verticalizePunctuation();let{processBidirectionalText:v,processStyledBidirectionalText:_}=iU;if(v&&1===y.sections.length)for(let e of(g=[],v(y.toString(),ol(y,h,n,r,a,f)))){let t=new oe;t.text=e,t.sections=y.sections;for(let r=0;r<e.length;r++)t.sectionIndex.push(0);g.push(t)}else if(_)for(let e of(g=[],_(y.text,y.sectionIndex,ol(y,h,n,r,a,f)))){let t=new oe;t.text=e[0],t.sectionIndex=e[1],t.sections=y.sections,g.push(t)}else g=function(e,t){let r=[],i=e.text,a=0;for(let i of t)r.push(e.substring(a,i)),a=i;return a<i.length&&r.push(e.substring(a,i.length)),r}(y,ol(y,h,n,r,a,f));let x=[],b={positionedLines:x,text:y.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(t,r,i,a,s,n,o,l,u,h,c,d){let p=0,f=-17,m=0,g=0,y="right"===l?1:"left"===l?0:.5,v=0;for(let o of s){o.trim();let s=o.getMaxScale(),l=(s-1)*24,_={positionedGlyphs:[],lineOffset:0};t.positionedLines[v]=_;let x=_.positionedGlyphs,b=0;if(!o.length()){f+=n,++v;continue}for(let n=0;n<o.length();n++){let m=o.getSection(n),g=o.getSectionIndex(n),y=o.getCharCode(n),v=0,_=null,S=null,w=null,E=24,A=!(u===e.ai.horizontal||!c&&!iq(y)||c&&(or[y]||iG.Arabic(y)||iG["Arabic Supplement"](y)||iG["Arabic Extended-A"](y)||iG["Arabic Presentation Forms-A"](y)||iG["Arabic Presentation Forms-B"](y)));if(m.imageName){let e=a[m.imageName];if(!e)continue;w=m.imageName,t.iconsInText=t.iconsInText||!0,S=e.paddedRect;let r=e.displaySize;m.scale=24*m.scale/d,_={width:r[0],height:r[1],left:1,top:-3,advance:A?r[1]:r[0]},v=l+(24-r[1]*m.scale),E=_.advance;let i=A?r[0]*m.scale-24*s:r[1]*m.scale-24*s;i>0&&i>b&&(b=i)}else{let e=i[m.fontStack],t=e&&e[y];if(t&&t.rect)S=t.rect,_=t.metrics;else{let e=r[m.fontStack],t=e&&e[y];if(!t)continue;_=t.metrics}v=(s-m.scale)*24}A?(t.verticalizable=!0,x.push({glyph:y,imageName:w,x:p,y:f+v,vertical:A,scale:m.scale,fontStack:m.fontStack,sectionIndex:g,metrics:_,rect:S}),p+=E*m.scale+h):(x.push({glyph:y,imageName:w,x:p,y:f+v,vertical:A,scale:m.scale,fontStack:m.fontStack,sectionIndex:g,metrics:_,rect:S}),p+=_.advance*m.scale+h)}0!==x.length&&(m=Math.max(p-h,m),function(e,t,r,i,a){if(!i&&!a)return;let s=e[r],n=(e[r].x+s.metrics.advance*s.scale)*i;for(let t=0;t<=r;t++)e[t].x-=n,e[t].y+=a}(x,0,x.length-1,y,b)),p=0;let S=n*s+b;_.lineOffset=Math.max(b,l),f+=S,g=Math.max(S,g),++v}let _=f- -17,{horizontalAlign:x,verticalAlign:b}=ou(o);(function(e,t,r,i,a,s,n,o,l){let u=(t-r)*a,h=0;for(let t of(h=s!==n?-o*i- -17:(-i*l+.5)*n,e))for(let e of t.positionedGlyphs)e.x+=u,e.y+=h})(t.positionedLines,y,x,b,m,g,n,_,s.length),t.top+=-b*_,t.bottom=t.top+_,t.left+=-x*m,t.right=t.left+m}(b,r,i,a,g,o,l,u,d,h,p,m),!function(e){for(let t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&b}let or={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oi={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},oa={40:!0};function os(e,t,r,i,a,s){if(t.imageName){let e=i[t.imageName];return e?e.displaySize[0]*t.scale*24/s+a:0}{let i=r[t.fontStack],s=i&&i[e];return s?s.metrics.advance*t.scale+a:0}}function on(e,t,r,i){let a=Math.pow(e-t,2);return i?e<t?a/2:2*a:a+Math.abs(r)*r}function oo(e,t,r,i,a,s){let n=null,o=on(t,r,a,s);for(let e of i){let i=on(t-e.x,r,a,s)+e.badness;i<=o&&(n=e,o=i)}return{index:e,x:t,priorBreak:n,badness:o}}function ol(e,t,r,i,a,s){if(!e)return[];let n=[],o=function(e,t,r,i,a,s){let n=0;for(let r=0;r<e.length();r++){let o=e.getSection(r);n+=os(e.getCharCode(r),o,i,a,t,s)}return n/Math.max(1,Math.ceil(n/r))}(e,t,r,i,a,s),l=e.text.indexOf("​")>=0,u=0;for(let r=0;r<e.length();r++){let h=e.getSection(r),c=e.getCharCode(r);if(or[c]||(u+=os(c,h,i,a,t,s)),r<e.length()-1){let t=!(c<11904||!(iG["Bopomofo Extended"](c)||iG.Bopomofo(c)||iG["CJK Compatibility Forms"](c)||iG["CJK Compatibility Ideographs"](c)||iG["CJK Compatibility"](c)||iG["CJK Radicals Supplement"](c)||iG["CJK Strokes"](c)||iG["CJK Symbols and Punctuation"](c)||iG["CJK Unified Ideographs Extension A"](c)||iG["CJK Unified Ideographs"](c)||iG["Enclosed CJK Letters and Months"](c)||iG["Halfwidth and Fullwidth Forms"](c)||iG.Hiragana(c)||iG["Ideographic Description Characters"](c)||iG["Kangxi Radicals"](c)||iG["Katakana Phonetic Extensions"](c)||iG.Katakana(c)||iG["Vertical Forms"](c)||iG["Yi Radicals"](c)||iG["Yi Syllables"](c)));(oi[c]||t||h.imageName||r!==e.length()-2&&oa[e.getCharCode(r+1)])&&n.push(oo(r+1,u,o,n,function(e,t,r){let i=0;return 10===e&&(i-=1e4),r&&(i+=150),40!==e&&65288!==e||(i+=50),41!==t&&65289!==t||(i+=50),i}(c,e.getCharCode(r+1),t&&l),!1))}}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(oo(e.length(),u,o,n,0,!0))}function ou(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function oh(e){var t,r;let i=e.left,a=e.top,s=e.right-i,n=e.bottom-a,o=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(r=e.image.textFitHeight)&&void 0!==r?r:"stretchOrShrink",u=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===o&&s/n<u||"proportional"===o){let e=Math.ceil(n*u);i*=e/s,s=e}}else if("proportional"===o&&"stretchOnly"===l&&0!==u&&s/n>u){let e=Math.ceil(s/u);a*=e/n,n=e}return{x1:i,y1:a,x2:i+s,y2:a+n}}function oc(e,t,r,i,a,s){let n,o,l,u,h;let c=e.image;if(c.content){let e=c.content,t=c.pixelRatio||1;n=[e[0]/t,e[1]/t,c.displaySize[0]-e[2]/t,c.displaySize[1]-e[3]/t]}let d=t.left*s,p=t.right*s;"width"===r||"both"===r?(h=a[0]+d-i[3],l=a[0]+p+i[1]):l=(h=a[0]+(d+p-c.displaySize[0])/2)+c.displaySize[0];let f=t.top*s,m=t.bottom*s;return"height"===r||"both"===r?(o=a[1]+f-i[0],u=a[1]+m+i[2]):u=(o=a[1]+(f+m-c.displaySize[1])/2)+c.displaySize[1],{image:c,top:o,right:l,bottom:u,left:h,collisionPadding:n}}function od(e,t){let{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new iH(e+1))};if("source"===r.kind)return{kind:"source"};{let{zoomStops:t,interpolationType:i}=r,a=0;for(;a<t.length&&t[a]<=e;)a++;let s=a=Math.max(0,a-1);for(;s<t.length&&t[s]<e+1;)s++;s=Math.min(t.length-1,s);let n=t[a],o=t[s];return"composite"===r.kind?{kind:"composite",minZoom:n,maxZoom:o,interpolationType:i}:{kind:"camera",minZoom:n,maxZoom:o,minSize:r.evaluate(new iH(n)),maxSize:r.evaluate(new iH(o)),interpolationType:i}}}function op(e,t,r){let i="never",a=e.get(t);return a?i=a:e.get(r)&&(i="always"),i}let of=nc.VectorTileFeature.types,om=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function og(e,t,r,i,a,s,n,o,l,u,h,c,d){let p=o?Math.min(32640,Math.round(o[0])):0,f=o?Math.min(32640,Math.round(o[1])):0;e.emplaceBack(t,r,Math.round(32*i),Math.round(32*a),s,n,(p<<1)+(l?1:0),f,16*u,16*h,256*c,256*d)}function oy(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}class ov{constructor(e){this.layoutVertexArray=new aH,this.indexArray=new a$,this.programConfigurations=e,this.segments=new aJ,this.dynamicLayoutVertexArray=new aZ,this.opacityVertexArray=new aV,this.hasVisibleVertices=!1,this.placedSymbolArray=new aP}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,i){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nO.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,nM.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,om,!0),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}iL("SymbolBuffers",ov);class o_{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new aJ,this.collisionVertexArray=new aW}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,nk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}iL("CollisionBuffers",o_);class ox{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(e=>e.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sL([]),this.placementViewportMatrix=sL([]);let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=od(this.zoom,r["text-size"]),this.iconSizeData=od(this.zoom,r["icon-size"]);let i=this.layers[0].layout,a=i.get("symbol-sort-key"),s=i.get("symbol-z-order");this.canOverlap="never"!==op(i,"text-overlap","text-allow-overlap")||"never"!==op(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==s&&!a.isConstant(),this.sortFeaturesByY=("viewport-y"===s||"auto"===s&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(t=>e.ai[t])),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.sourceID=t.sourceID}createArrays(){this.text=new ov(new sd(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ov(new sd(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new aL,this.lineVertexArray=new aO,this.symbolInstances=new aI,this.textAnchorOffsets=new ak}calculateGlyphDependencies(e,t,r,i,a){for(let s=0;s<e.length;s++)if(t[e.charCodeAt(s)]=!0,(r||i)&&a){let r=nF[e.charAt(s)];r&&(t[r.charCodeAt(0)]=!0)}}populate(t,r,i){let a=this.layers[0],s=a.layout,n=s.get("text-font"),o=s.get("text-field"),l=s.get("icon-image"),u=("constant"!==o.value.kind||o.value.value instanceof e8&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==n.value.kind||n.value.value.length>0),h="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,c=s.get("symbol-sort-key");if(this.features=[],!u&&!h)return;let d=r.iconDependencies,p=r.glyphDependencies,f=r.availableImages,m=new iH(this.zoom);for(let{feature:r,id:o,index:l,sourceLayerIndex:g}of t){let t,y;let v=a._featureFilter.needGeometry,_=sg(r,v);if(!a._featureFilter.filter(m,_,i))continue;if(v||(_.geometry=sm(r)),u){let e=a.getValueAndResolveTokens("text-field",_,i,f),r=e8.factory(e),s=this.hasRTLText=this.hasRTLText||function(e){for(let t of e.sections)if(function(e){for(let t of e)if(iB(t.charCodeAt(0)))return!0;return!1}(t.text))return!0;return!1}(r);(!s||"unavailable"===iU.getRTLTextPluginStatus()||s&&iU.isParsed())&&(t=function(e,t,r){return e.sections.forEach(e=>{e.text=function(e,t,r){let i=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===i?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),iU.applyArabicShaping&&(e=iU.applyArabicShaping(e)),e}(e.text,t,r)}),e}(r,a,_))}if(h){let e=a.getValueAndResolveTokens("icon-image",_,i,f);y=e instanceof tt?e:tt.fromString(e)}if(!t&&!y)continue;let x=this.sortFeaturesByKey?c.evaluate(_,{},i):void 0;if(this.features.push({id:o,text:t,icon:y,index:l,sourceLayerIndex:g,geometry:_.geometry,properties:r.properties,type:of[r.type],sortKey:x}),y&&(d[y.name]=!0),t){let r=n.evaluate(_,{},i).join(","),a="viewport"!==s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");for(let i of(this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ai.vertical)>=0,t.sections))if(i.image)d[i.image.name]=!0;else{let e=iz(t.toString()),s=i.fontStack||r,n=p[s]=p[s]||{};this.calculateGlyphDependencies(i.text,n,a,this.allowVerticalPlacement,e)}}}"line"===s.get("symbol-placement")&&(this.features=function(e){let t={},r={},i=[],a=0;function s(t){i.push(e[t]),a++}function n(e,t,a){let s=r[e];return delete r[e],r[t]=s,i[s].geometry[0].pop(),i[s].geometry[0]=i[s].geometry[0].concat(a[0]),s}function o(e,r,a){let s=t[r];return delete t[r],t[e]=s,i[s].geometry[0].shift(),i[s].geometry[0]=a[0].concat(i[s].geometry[0]),s}function l(e,t,r){let i=r?t[0][t[0].length-1]:t[0][0];return`${e}:${i.x}:${i.y}`}for(let u=0;u<e.length;u++){let h=e[u],c=h.geometry,d=h.text?h.text.toString():null;if(!d){s(u);continue}let p=l(d,c),f=l(d,c,!0);if(p in r&&f in t&&r[p]!==t[f]){let e=o(p,f,c),a=n(p,f,i[e].geometry);delete t[p],delete r[f],r[l(d,i[a].geometry,!0)]=a,i[e].geometry=null}else p in r?n(p,f,c):f in t?o(p,f,c):(s(u),t[p]=a-1,r[f]=a-1)}return i.filter(e=>e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((e,t)=>e.sortKey-t.sortKey)}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){let r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),a={};for(let i=e.segment+1;i<t.length;i++)a[i]={x:t[i].x,y:t[i].y,tileUnitDistanceFromAnchor:r},i<t.length-1&&(r+=t[i+1].dist(t[i]));for(let r=e.segment||0;r>=0;r--)a[r]={x:t[r].x,y:t[r].y,tileUnitDistanceFromAnchor:i},r>0&&(i+=t[r-1].dist(t[r]));for(let e=0;e<t.length;e++){let t=a[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,i,a,s,n,o,l,u,h,c,d){let p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*r.length,f,p,this.canOverlap?n.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,v=this.allowVerticalPlacement&&o===e.ai.vertical?Math.PI/2:0,_=n.text&&n.text.sections;for(let e=0;e<r.length;e++){let{tl:a,tr:s,bl:o,br:u,tex:h,pixelOffsetTL:c,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:x,glyphOffset:b,isSDF:S,sectionIndex:w}=r[e],E=m.vertexLength,A=b[1];og(f,l.x,l.y,a.x,A+a.y,h.x,h.y,i,S,c.x,c.y,y,x),og(f,l.x,l.y,s.x,A+s.y,h.x+h.w,h.y,i,S,g.x,c.y,y,x),og(f,l.x,l.y,o.x,A+o.y,h.x,h.y+h.h,i,S,c.x,g.y,y,x),og(f,l.x,l.y,u.x,A+u.y,h.x+h.w,h.y+h.h,i,S,g.x,g.y,y,x),oy(t.dynamicLayoutVertexArray,l,v),p.emplaceBack(E,E+1,E+2),p.emplaceBack(E+1,E+2,E+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),e!==r.length-1&&w===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,n,n.index,{},d,_&&_[w])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,u,h,l.segment,i?i[0]:0,i?i[1]:0,a[0],a[1],o,0,!1,0,c)}_addCollisionDebugVertex(e,t,r,i,a,s){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,i,a,Math.round(s.x),Math.round(s.y))}addCollisionDebugVertices(e,t,r,i,a,s,n){let o=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),l=o.vertexLength,u=a.layoutVertexArray,h=a.collisionVertexArray,c=n.anchorX,d=n.anchorY;this._addCollisionDebugVertex(u,h,s,c,d,new T(e,t)),this._addCollisionDebugVertex(u,h,s,c,d,new T(r,t)),this._addCollisionDebugVertex(u,h,s,c,d,new T(r,i)),this._addCollisionDebugVertex(u,h,s,c,d,new T(e,i)),o.vertexLength+=4;let p=a.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),o.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,i){for(let a=e;a<t;a++){let e=this.collisionBoxArray.get(a);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,i?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new o_(aY,nN.members,aX),this.iconCollisionBox=new o_(aY,nN.members,aX);for(let e=0;e<this.symbolInstances.length;e++){let t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,i,a,s,n,o,l){let u={};for(let i=t;i<r;i++){let t=e.get(i);u.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.textFeatureIndex=t.featureIndex;break}for(let t=i;t<a;t++){let r=e.get(t);u.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalTextFeatureIndex=r.featureIndex;break}for(let t=s;t<n;t++){let r=e.get(t);u.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.iconFeatureIndex=r.featureIndex;break}for(let t=o;t<l;t++){let r=e.get(t);u.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalIconFeatureIndex=r.featureIndex;break}return u}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){let r=e.placedSymbolArray.get(t),i=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<i;t+=4)e.indexArray.emplaceBack(t,t+1,t+2),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;let t=Math.sin(e),r=Math.cos(e),i=[],a=[],s=[];for(let e=0;e<this.symbolInstances.length;++e){s.push(e);let n=this.symbolInstances.get(e);i.push(0|Math.round(t*n.anchorX+r*n.anchorY)),a.push(n.featureIndex)}return s.sort((e,t)=>i[e]-i[t]||a[t]-a[e]),s}addToSortKeyRanges(e,t){let r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){for(let t of(this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[],this.symbolInstanceIndexes)){let e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}iL("SymbolBucket",ox,{omit:["layers","collisionBoxArray","features","compareText"]}),ox.MAX_GLYPHS=65535,ox.addDynamicAttributes=oy;var ob={get paint(){return g=g||new i3({"icon-opacity":new i0(el.paint_symbol["icon-opacity"]),"icon-color":new i0(el.paint_symbol["icon-color"]),"icon-halo-color":new i0(el.paint_symbol["icon-halo-color"]),"icon-halo-width":new i0(el.paint_symbol["icon-halo-width"]),"icon-halo-blur":new i0(el.paint_symbol["icon-halo-blur"]),"icon-translate":new iQ(el.paint_symbol["icon-translate"]),"icon-translate-anchor":new iQ(el.paint_symbol["icon-translate-anchor"]),"text-opacity":new i0(el.paint_symbol["text-opacity"]),"text-color":new i0(el.paint_symbol["text-color"],{runtimeType:eA,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new i0(el.paint_symbol["text-halo-color"]),"text-halo-width":new i0(el.paint_symbol["text-halo-width"]),"text-halo-blur":new i0(el.paint_symbol["text-halo-blur"]),"text-translate":new iQ(el.paint_symbol["text-translate"]),"text-translate-anchor":new iQ(el.paint_symbol["text-translate-anchor"])})},get layout(){return m=m||new i3({"symbol-placement":new iQ(el.layout_symbol["symbol-placement"]),"symbol-spacing":new iQ(el.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new iQ(el.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new i0(el.layout_symbol["symbol-sort-key"]),"symbol-z-order":new iQ(el.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new iQ(el.layout_symbol["icon-allow-overlap"]),"icon-overlap":new iQ(el.layout_symbol["icon-overlap"]),"icon-ignore-placement":new iQ(el.layout_symbol["icon-ignore-placement"]),"icon-optional":new iQ(el.layout_symbol["icon-optional"]),"icon-rotation-alignment":new iQ(el.layout_symbol["icon-rotation-alignment"]),"icon-size":new i0(el.layout_symbol["icon-size"]),"icon-text-fit":new iQ(el.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new iQ(el.layout_symbol["icon-text-fit-padding"]),"icon-image":new i0(el.layout_symbol["icon-image"]),"icon-rotate":new i0(el.layout_symbol["icon-rotate"]),"icon-padding":new i0(el.layout_symbol["icon-padding"]),"icon-keep-upright":new iQ(el.layout_symbol["icon-keep-upright"]),"icon-offset":new i0(el.layout_symbol["icon-offset"]),"icon-anchor":new i0(el.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new iQ(el.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new iQ(el.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new iQ(el.layout_symbol["text-rotation-alignment"]),"text-field":new i0(el.layout_symbol["text-field"]),"text-font":new i0(el.layout_symbol["text-font"]),"text-size":new i0(el.layout_symbol["text-size"]),"text-max-width":new i0(el.layout_symbol["text-max-width"]),"text-line-height":new iQ(el.layout_symbol["text-line-height"]),"text-letter-spacing":new i0(el.layout_symbol["text-letter-spacing"]),"text-justify":new i0(el.layout_symbol["text-justify"]),"text-radial-offset":new i0(el.layout_symbol["text-radial-offset"]),"text-variable-anchor":new iQ(el.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new i0(el.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new i0(el.layout_symbol["text-anchor"]),"text-max-angle":new iQ(el.layout_symbol["text-max-angle"]),"text-writing-mode":new iQ(el.layout_symbol["text-writing-mode"]),"text-rotate":new i0(el.layout_symbol["text-rotate"]),"text-padding":new iQ(el.layout_symbol["text-padding"]),"text-keep-upright":new iQ(el.layout_symbol["text-keep-upright"]),"text-transform":new i0(el.layout_symbol["text-transform"]),"text-offset":new i0(el.layout_symbol["text-offset"]),"text-allow-overlap":new iQ(el.layout_symbol["text-allow-overlap"]),"text-overlap":new iQ(el.layout_symbol["text-overlap"]),"text-ignore-placement":new iQ(el.layout_symbol["text-ignore-placement"]),"text-optional":new iQ(el.layout_symbol["text-optional"])})}};class oS{constructor(e){if(void 0===e.property.overrides)throw Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:eb,this.defaultValue=e}evaluate(e){if(e.formattedSection){let t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}iL("FormatSectionOverride",oS,{omit:["defaultValue"]});class ow extends i6{constructor(e){super(e,ob)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){let e=this.layout.get("text-writing-mode");if(e){let t=[];for(let r of e)0>t.indexOf(r)&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,i){var a;let s=this.layout.get(e).evaluate(t,{},r,i),n=this._unevaluatedLayout._values[e];return n.isDataDriven()||rH(n.value)||!s?s:(a=t.properties,s.replace(/{([^{}]+)}/g,(e,t)=>a&&t in a?String(a[t]):""))}createBucket(e){return new ox(e)}queryRadius(){return 0}queryIntersectsFeature(){throw Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of ob.paint.overridableProperties){if(!ow.hasPaintOverride(this.layout,e))continue;let t=this.paint.get(e),r=new rU(new oS(t),t.property.specification),i=null;i="constant"===t.value.kind||"source"===t.value.kind?new rV("source",r):new rY("composite",r,t.value.zoomStops),this.paint._values[e]=new iK(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&ow.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){let r=e.get("text-field"),i=ob.paint.properties[t],a=!1,s=e=>{for(let t of e)if(i.overrides&&i.overrides.hasOverride(t))return void(a=!0)};if("constant"===r.value.kind&&r.value.value instanceof e8)s(r.value.value.sections);else if("source"===r.value.kind){let e=t=>{a||(t instanceof tn&&ta(t.value)===eR?s(t.value.sections):t instanceof tU?s(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return a}}var oE={get paint(){return y=y||new i3({"background-color":new iQ(el.paint_background["background-color"]),"background-pattern":new i2(el.paint_background["background-pattern"]),"background-opacity":new iQ(el.paint_background["background-opacity"])})}};class oA extends i6{constructor(e){super(e,oE)}}var oT={get paint(){return v=v||new i3({"raster-opacity":new iQ(el.paint_raster["raster-opacity"]),"raster-hue-rotate":new iQ(el.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new iQ(el.paint_raster["raster-brightness-min"]),"raster-brightness-max":new iQ(el.paint_raster["raster-brightness-max"]),"raster-saturation":new iQ(el.paint_raster["raster-saturation"]),"raster-contrast":new iQ(el.paint_raster["raster-contrast"]),"raster-resampling":new iQ(el.paint_raster["raster-resampling"]),"raster-fade-duration":new iQ(el.paint_raster["raster-fade-duration"])})}};class oC extends i6{constructor(e){super(e,oT)}}class oP extends i6{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw Error("Custom layers cannot be serialized")}}class oR{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}class oI{constructor(e,t){if(isNaN(e)||isNaN(t))throw Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new oI(k(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let t=Math.PI/180,r=this.lat*t,i=e.lat*t;return 6371008.8*Math.acos(Math.min(Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((e.lng-this.lng)*t),1))}static convert(e){if(e instanceof oI)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new oI(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new oI(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let oL=2*Math.PI*6371008.8;function oO(e){return oL*Math.cos(e*Math.PI/180)}function oM(e){return(180+e)/360}function ok(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function oN(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class oD{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){let r=oI.convert(e);return new oD(oM(r.lng),ok(r.lat),t/oO(r.lat))}toLngLat(){return new oI(360*this.x-180,oN(this.y))}toAltitude(){return this.z*oO(oN(this.y))}meterInMercatorCoordinateUnits(){return 1/oL*(1/Math.cos(oN(this.y)*Math.PI/180))}}function oF(e,t,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}class oG{constructor(e,t,r){if(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=oj(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){var i,a,s,n,o;let l=(a=this.y,s=this.z,n=oF(256*(i=this.x),256*(a=Math.pow(2,s)-a-1),s),o=oF(256*(i+1),256*(a+1),s),n[0]+","+n[1]+","+o[0]+","+o[1]),u=function(e,t,r){let i,a="";for(let s=e;s>0;s--)a+=(t&(i=1<<s-1)?1:0)+(r&i?2:0);return a}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,l)}isChildOf(e){let t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){let t=Math.pow(2,this.z);return new T((e.x*t-this.x)*8192,(e.y*t-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}}class oz{constructor(e,t){this.wrap=e,this.canonical=t,this.key=oj(e,t.z,t.z,t.x,t.y)}}class oq{constructor(e,t,r,i,a){if(e<r)throw Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new oG(r,+i,+a),this.key=oj(t,e,r,i,a)}clone(){return new oq(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let t=this.canonical.z-e;return e>this.canonical.z?new oq(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new oq(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-e;return e>this.canonical.z?oj(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):oj(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new oq(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let t=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new oq(t,this.wrap,t,r,i),new oq(t,this.wrap,t,r+1,i),new oq(t,this.wrap,t,r,i+1),new oq(t,this.wrap,t,r+1,i+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new oq(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new oq(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new oz(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new oD(e.x-this.wrap,e.y))}}function oj(e,t,r,i,a){(e*=2)<0&&(e=-1*e-1);let s=1<<r;return(s*s*e+s*a+i).toString(36)+r.toString(36)+t.toString(36)}iL("CanonicalTileID",oG),iL("OverscaledTileID",oq,{omit:["posMatrix"]});class oB{constructor(e,t,r,i=1,a=1,s=1,n=0){if(this.uid=e,t.height!==t.width)throw RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))return void j(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;let o=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=a,this.blueFactor=s,this.baseShift=n;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let e=0;e<o;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(o,e)]=this.data[this._idx(o-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,o)]=this.data[this._idx(e,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<o;e++)for(let t=0;t<o;t++){let r=this.get(e,t);r>this.max&&(this.max=r),r<this.min&&(this.min=r)}}get(e,t){let r=new Uint8Array(this.data.buffer),i=4*this._idx(e,t);return this.unpack(r[i],r[i+1],r[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}getPixels(){return new sB({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw Error("dem dimension mismatch");let i=t*this.dim,a=t*this.dim+this.dim,s=r*this.dim,n=r*this.dim+this.dim;switch(t){case -1:i=a-1;break;case 1:a=i+1}switch(r){case -1:s=n-1;break;case 1:n=s+1}let o=-t*this.dim,l=-r*this.dim;for(let t=s;t<n;t++)for(let r=i;r<a;r++)this.data[this._idx(r,t)]=e.data[this._idx(r+o,t+l)]}}iL("DEMData",oB);class oU{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){let r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class oH{constructor(e,t,r,i,a){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=i,this.properties=e.properties,this.id=a}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class oZ{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new iR(8192,16,0),this.grid3D=new iR(8192,16,0),this.featureIndexArray=new aD,this.promoteId=t}insert(e,t,r,i,a,s){let n=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,a);let o=s?this.grid3D:this.grid;for(let e=0;e<t.length;e++){let r=t[e],i=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){let t=r[e];i[0]=Math.min(i[0],t.x),i[1]=Math.min(i[1],t.y),i[2]=Math.max(i[2],t.x),i[3]=Math.max(i[3],t.y)}i[0]<8192&&i[1]<8192&&i[2]>=0&&i[3]>=0&&o.insert(n,i[0],i[1],i[2],i[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new nc.VectorTile(new n2(this.rawTileData)).layers,this.sourceLayerCoder=new oU(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,i){let a;this.loadVTLayers();let s=e.params||{},n=8192/e.tileSize/e.scale,o=rJ(s.filter),l=e.queryGeometry,u=e.queryPadding*n,h=oY(l),c=this.grid.query(h.minX-u,h.minY-u,h.maxX+u,h.maxY+u),d=oY(e.cameraQueryGeometry);for(let t of this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,(t,r,i,a)=>(function(e,t,r,i,a){for(let s of e)if(t<=s.x&&r<=s.y&&i>=s.x&&a>=s.y)return!0;let s=[new T(t,r),new T(t,a),new T(i,a),new T(i,r)];if(e.length>2){for(let t of s)if(sA(e,t))return!0}for(let t=0;t<e.length-1;t++)if(function(e,t,r){let i=r[0],a=r[2];if(e.x<i.x&&t.x<i.x||e.x>a.x&&t.x>a.x||e.y<i.y&&t.y<i.y||e.y>a.y&&t.y>a.y)return!1;let s=B(e,t,r[0]);return s!==B(e,t,r[1])||s!==B(e,t,r[2])||s!==B(e,t,r[3])}(e[t],e[t+1],s))return!0;return!1})(e.cameraQueryGeometry,t-u,r-u,i+u,a+u)))c.push(t);c.sort(oW);let p={};for(let u=0;u<c.length;u++){let h=c[u];if(h===a)continue;a=h;let d=this.featureIndexArray.get(h),f=null;this.loadMatchingFeature(p,d.bucketIndex,d.sourceLayerIndex,d.featureIndex,o,s.layers,s.availableImages,t,r,i,(t,r,i)=>(f||(f=sm(t)),r.queryIntersectsFeature(l,t,i,f,this.z,e.transform,n,e.pixelPosMatrix)))}return p}loadMatchingFeature(e,t,r,i,a,s,n,o,l,u,h){let c=this.bucketLayerIDs[t];if(s&&!function(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(s,c))return;let d=this.sourceLayerCoder.decode(r),p=this.vtLayers[d].feature(i);if(a.needGeometry){let e=sg(p,!0);if(!a.filter(new iH(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!a.filter(new iH(this.tileID.overscaledZ),p))return;let f=this.getId(p,d);for(let t=0;t<c.length;t++){let r=c[t];if(s&&0>s.indexOf(r))continue;let a=o[r];if(!a)continue;let d={};f&&u&&(d=u.getState(a.sourceLayer||"_geojsonTileLayer",f));let m=N({},l[r]);m.paint=oV(m.paint,a.paint,p,d,n),m.layout=oV(m.layout,a.layout,p,d,n);let g=!h||h(p,a,d);if(!g)continue;let y=new oH(p,this.z,this.x,this.y,f);y.layer=m;let v=e[r];void 0===v&&(v=e[r]=[]),v.push({featureIndex:i,feature:y,intersectionZ:g})}}lookupSymbolFeatures(e,t,r,i,a,s,n,o){let l={};this.loadVTLayers();let u=rJ(a);for(let a of e)this.loadMatchingFeature(l,r,i,a,u,s,n,o,t);return l}hasLayer(e){for(let t of this.bucketLayerIDs)for(let r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r}}function oV(e,t,r,i,a){return F(e,(e,s)=>{let n=t instanceof iJ?t.get(s):null;return n&&n.evaluate?n.evaluate(r,i,a):n})}function oY(e){let t=1/0,r=1/0,i=-1/0,a=-1/0;for(let s of e)t=Math.min(t,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),a=Math.max(a,s.y);return{minX:t,minY:r,maxX:i,maxY:a}}function oW(e,t){return t-e}function o$(e,t,r,i,a){let s=[];for(let n=0;n<e.length;n++){let o;let l=e[n];for(let e=0;e<l.length-1;e++){let n=l[e],u=l[e+1];n.x<t&&u.x<t||(n.x<t?n=new T(t,n.y+(t-n.x)/(u.x-n.x)*(u.y-n.y))._round():u.x<t&&(u=new T(t,n.y+(t-n.x)/(u.x-n.x)*(u.y-n.y))._round()),n.y<r&&u.y<r||(n.y<r?n=new T(n.x+(r-n.y)/(u.y-n.y)*(u.x-n.x),r)._round():u.y<r&&(u=new T(n.x+(r-n.y)/(u.y-n.y)*(u.x-n.x),r)._round()),n.x>=i&&u.x>=i||(n.x>=i?n=new T(i,n.y+(i-n.x)/(u.x-n.x)*(u.y-n.y))._round():u.x>=i&&(u=new T(i,n.y+(i-n.x)/(u.x-n.x)*(u.y-n.y))._round()),n.y>=a&&u.y>=a||(n.y>=a?n=new T(n.x+(a-n.y)/(u.y-n.y)*(u.x-n.x),a)._round():u.y>=a&&(u=new T(n.x+(a-n.y)/(u.y-n.y)*(u.x-n.x),a)._round()),o&&n.equals(o[o.length-1])||(o=[n],s.push(o)),o.push(u)))))}}return s}iL("FeatureIndex",oZ,{omit:["rawTileData","sourceLayerCoder"]});class oX extends T{constructor(e,t,r,i){super(e,t),this.angle=r,void 0!==i&&(this.segment=i)}clone(){return new oX(this.x,this.y,this.angle,this.segment)}}function oK(e,t,r,i,a){if(void 0===t.segment||0===r)return!0;let s=t,n=t.segment+1,o=0;for(;o>-r/2;){if(--n<0)return!1;o-=e[n].dist(s),s=e[n]}o+=e[n].dist(e[n+1]),n++;let l=[],u=0;for(;o<r/2;){let t=e[n],r=e[n+1];if(!r)return!1;let s=e[n-1].angleTo(t)-t.angleTo(r);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:s}),u+=s;o-l[0].distance>i;)u-=l.shift().angleDelta;if(u>a)return!1;n++,o+=t.dist(r)}return!0}function oJ(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function oQ(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function o0(e,t,r,i){let a=[],s=e.image,n=s.pixelRatio,o=s.paddedRect.w-2,l=s.paddedRect.h-2,u={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom},h=s.stretchX||[[0,o]],c=s.stretchY||[[0,l]],d=(e,t)=>e+t[1]-t[0],p=h.reduce(d,0),f=c.reduce(d,0),m=o-p,g=l-f,y=0,v=p,_=0,x=f,b=0,S=m,w=0,E=g;if(s.content&&i){let t=s.content,r=t[2]-t[0],i=t[3]-t[1];(s.textFitWidth||s.textFitHeight)&&(u=oh(e)),y=o1(h,0,t[0]),_=o1(c,0,t[1]),v=o1(h,t[0],t[2]),x=o1(c,t[1],t[3]),b=t[0]-y,w=t[1]-_,S=r-v,E=i-x}let A=u.x1,C=u.y1,P=u.x2-A,R=u.y2-C,I=(e,i,a,o)=>{var l,u,h,c;let d=(e.stretch-y)/v*P+A,m=(l=e.fixed-b,l-S*e.stretch/p),g=(i.stretch-_)/x*R+C,I=(u=i.fixed-w,u-E*i.stretch/f),L=(a.stretch-y)/v*P+A,O=(h=a.fixed-b,h-S*a.stretch/p),M=(o.stretch-_)/x*R+C,k=(c=o.fixed-w,c-E*o.stretch/f),N=new T(d,g),D=new T(L,g),F=new T(L,M),G=new T(d,M),z=new T(m/n,I/n),q=new T(O/n,k/n),j=t*Math.PI/180;if(j){let e=Math.sin(j),t=Math.cos(j),r=[t,-e,e,t];N._matMult(r),D._matMult(r),G._matMult(r),F._matMult(r)}let B=e.stretch+e.fixed,U=i.stretch+i.fixed;return{tl:N,tr:D,bl:G,br:F,tex:{x:s.paddedRect.x+1+B,y:s.paddedRect.y+1+U,w:a.stretch+a.fixed-B,h:o.stretch+o.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:q,minFontScaleX:S/n/P,minFontScaleY:E/n/R,isSDF:r}};if(i&&(s.stretchX||s.stretchY)){let e=o2(h,m,p),t=o2(c,g,f);for(let r=0;r<e.length-1;r++){let i=e[r],s=e[r+1];for(let e=0;e<t.length-1;e++)a.push(I(i,t[e],s,t[e+1]))}}else a.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:o+1},{fixed:0,stretch:l+1}));return a}function o1(e,t,r){let i=0;for(let a of e)i+=Math.max(t,Math.min(r,a[1]))-Math.max(t,Math.min(r,a[0]));return i}function o2(e,t,r){let i=[{fixed:-1,stretch:0}];for(let[t,r]of e){let e=i[i.length-1];i.push({fixed:t-e.stretch,stretch:e.stretch}),i.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return i.push({fixed:t+1,stretch:r}),i}iL("Anchor",oX);class o5{constructor(e,t,r,i,a,s,n,o,l,u){var h;if(this.boxStartIndex=e.length,l){let e=s.top,t=s.bottom,r=s.collisionPadding;r&&(e-=r[1],t+=r[3]);let i=t-e;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{let l=(null===(h=s.image)||void 0===h?void 0:h.content)&&(s.image.textFitWidth||s.image.textFitHeight)?oh(s):{x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};l.y1=l.y1*n-o[0],l.y2=l.y2*n+o[2],l.x1=l.x1*n-o[3],l.x2=l.x2*n+o[1];let c=s.collisionPadding;if(c&&(l.x1-=c[0]*n,l.y1-=c[1]*n,l.x2+=c[2]*n,l.y2+=c[3]*n),u){let e=new T(l.x1,l.y1),t=new T(l.x2,l.y1),r=new T(l.x1,l.y2),i=new T(l.x2,l.y2),a=u*Math.PI/180;e._rotate(a),t._rotate(a),r._rotate(a),i._rotate(a),l.x1=Math.min(e.x,t.x,r.x,i.x),l.x2=Math.max(e.x,t.x,r.x,i.x),l.y1=Math.min(e.y,t.y,r.y,i.y),l.y2=Math.max(e.y,t.y,r.y,i.y)}e.emplaceBack(t.x,t.y,l.x1,l.y1,l.x2,l.y2,r,i,a)}this.boxEndIndex=e.length}}class o3{constructor(e=[],t=o4){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let a=e-1>>1,s=t[a];if(r(i,s)>=0)break;t[e]=s,e=a}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,a=t[e];for(;e<i;){let i=1+(e<<1),s=t[i],n=i+1;if(n<this.length&&0>r(t[n],s)&&(i=n,s=t[n]),r(s,a)>=0)break;t[e]=s,e=i}t[e]=a}}function o4(e,t){return e<t?-1:e>t?1:0}function o6(e,t){return t.max-e.max}function o8(e,t,r,i){this.p=new T(e,t),this.h=r,this.d=function(e,t){let r=!1,i=1/0;for(let a=0;a<t.length;a++){let s=t[a];for(let t=0,a=s.length,n=a-1;t<a;n=t++){let a=s[t],o=s[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(r=!r),i=Math.min(i,sw(e,a,o))}}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}e.ar=void 0,(w=e.ar||(e.ar={}))[w.center=1]="center",w[w.left=2]="left",w[w.right=3]="right",w[w.top=4]="top",w[w.bottom=5]="bottom",w[w["top-left"]=6]="top-left",w[w["top-right"]=7]="top-right",w[w["bottom-left"]=8]="bottom-left",w[w["bottom-right"]=9]="bottom-right";let o7=Number.POSITIVE_INFINITY;function o9(e,t){return t[1]!==o7?function(e,t,r){let i=0,a=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":a=r-7;break;case"bottom-right":case"bottom-left":case"bottom":a=-r+7}switch(e){case"top-right":case"bottom-right":case"right":i=-t;break;case"top-left":case"bottom-left":case"left":i=t}return[i,a]}(e,t[0],t[1]):function(e,t){let r=0,i=0;t<0&&(t=0);let a=t/Math.SQRT2;switch(e){case"top-right":case"top-left":i=a-7;break;case"bottom-right":case"bottom-left":i=-a+7;break;case"bottom":i=-t+7;break;case"top":i=t-7}switch(e){case"top-right":case"bottom-right":r=-a;break;case"top-left":case"bottom-left":r=a;break;case"left":r=t;break;case"right":r=-t}return[r,i]}(e,t[0])}function le(e,t,r){var i;let a=e.layout,s=null===(i=a.get("text-variable-anchor-offset"))||void 0===i?void 0:i.evaluate(t,{},r);if(s){let e=s.values,t=[];for(let r=0;r<e.length;r+=2){let i=t[r]=e[r],a=e[r+1].map(e=>24*e);i.startsWith("top")?a[1]-=7:i.startsWith("bottom")&&(a[1]+=7),t[r+1]=a}return new te(t)}let n=a.get("text-variable-anchor");if(n){let i;i=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[24*a.get("text-radial-offset").evaluate(t,{},r),o7]:a.get("text-offset").evaluate(t,{},r).map(e=>24*e);let s=[];for(let e of n)s.push(e,o9(e,i));return new te(s)}return null}function lt(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lr(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f){let m=function(e,t,r,i,a,s,n,o){let l=i.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,u=[];for(let e of t.positionedLines)for(let i of e.positionedGlyphs){if(!i.rect)continue;let s=i.rect||{},h=4,c=!0,d=1,p=0,f=(a||o)&&i.vertical,m=i.metrics.advance*i.scale/2;if(o&&t.verticalizable&&(p=e.lineOffset/2-(i.imageName?-(24-i.metrics.width*i.scale)/2:(i.scale-1)*24)),i.imageName){let e=n[i.imageName];c=e.sdf,h=1/(d=e.pixelRatio)}let g=a?[i.x+m,i.y]:[0,0],y=a?[0,0]:[i.x+m+r[0],i.y+r[1]-p],v=[0,0];f&&(v=y,y=[0,0]);let _=i.metrics.isDoubleResolution?2:1,x=(i.metrics.left-h)*i.scale-m+y[0],b=(-i.metrics.top-h)*i.scale+y[1],S=x+s.w/_*i.scale/d,w=b+s.h/_*i.scale/d,E=new T(x,b),A=new T(S,b),C=new T(x,w),P=new T(S,w);if(f){let e=new T(-m,m- -17),t=-Math.PI/2,r=12-m,a=new T(22-r,-(i.imageName?r:0)),s=new T(...v);E._rotateAround(t,e)._add(a)._add(s),A._rotateAround(t,e)._add(a)._add(s),C._rotateAround(t,e)._add(a)._add(s),P._rotateAround(t,e)._add(a)._add(s)}if(l){let e=Math.sin(l),t=Math.cos(l),r=[t,-e,e,t];E._matMult(r),A._matMult(r),C._matMult(r),P._matMult(r)}let R=new T(0,0),I=new T(0,0);u.push({tl:E,tr:A,bl:C,br:P,tex:s,writingMode:t.writingMode,glyphOffset:g,sectionIndex:i.sectionIndex,isSDF:c,pixelOffsetTL:R,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}return u}(0,r,o,a,s,n,i,e.allowVerticalPlacement),g=e.textSizeData,y=null;for(let r of("source"===g.kind?(y=[128*a.layout.get("text-size").evaluate(n,{})])[0]>32640&&j(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`):"composite"===g.kind&&((y=[128*p.compositeTextSizes[0].evaluate(n,{},f),128*p.compositeTextSizes[1].evaluate(n,{},f)])[0]>32640||y[1]>32640)&&j(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`),e.addSymbols(e.text,m,y,o,s,n,u,t,l.lineStartIndex,l.lineLength,d,f),h))c[r]=e.text.placedSymbolArray.length-1;return 4*m.length}function li(e){for(let t in e)return e[t];return null}let la=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ls{static from(e){if(!(e instanceof ArrayBuffer))throw Error("Data must be an instance of ArrayBuffer.");let[t,r]=new Uint8Array(e,0,2);if(219!==t)throw Error("Data does not appear to be in a KDBush format.");let i=r>>4;if(1!==i)throw Error(`Got v${i} data when expected v1.`);let a=la[15&r];if(!a)throw Error("Unrecognized array type.");let[s]=new Uint16Array(e,2,1),[n]=new Uint32Array(e,4,1);return new ls(n,s,a,e)}constructor(e,t=64,r=Float64Array,i){if(isNaN(e)||e<0)throw Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=la.indexOf(this.ArrayType),s=2*e*this.ArrayType.BYTES_PER_ELEMENT,n=e*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-n%8)%8;if(a<0)throw Error(`Unexpected typed array class: ${r}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+n+o,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+s+n+o),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+n+o,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){let e=this._pos>>1;if(e!==this.numItems)throw Error(`Added ${e} items when expected ${this.numItems}.`);return function e(t,r,i,a,s,n){if(s-a<=i)return;let o=a+s>>1;(function e(t,r,i,a,s,n){for(;s>a;){if(s-a>600){let o=s-a+1,l=i-a+1,u=Math.log(o),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(o-h)/o)*(l-o/2<0?-1:1);e(t,r,i,Math.max(a,Math.floor(i-l*h/o+c)),Math.min(s,Math.floor(i+(o-l)*h/o+c)),n)}let o=r[2*i+n],l=a,u=s;for(ln(t,r,a,i),r[2*s+n]>o&&ln(t,r,a,s);l<u;){for(ln(t,r,l,u),l++,u--;r[2*l+n]<o;)l++;for(;r[2*u+n]>o;)u--}r[2*a+n]===o?ln(t,r,a,u):ln(t,r,++u,s),u<=i&&(a=u+1),i<=u&&(s=u-1)}})(t,r,o,a,s,n),e(t,r,i,a,o-1,1-n),e(t,r,i,o+1,s,1-n)}(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,i){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:a,coords:s,nodeSize:n}=this,o=[0,a.length-1,0],l=[];for(;o.length;){let u=o.pop()||0,h=o.pop()||0,c=o.pop()||0;if(h-c<=n){for(let n=c;n<=h;n++){let o=s[2*n],u=s[2*n+1];o>=e&&o<=r&&u>=t&&u<=i&&l.push(a[n])}continue}let d=c+h>>1,p=s[2*d],f=s[2*d+1];p>=e&&p<=r&&f>=t&&f<=i&&l.push(a[d]),(0===u?e<=p:t<=f)&&(o.push(c),o.push(d-1),o.push(1-u)),(0===u?r>=p:i>=f)&&(o.push(d+1),o.push(h),o.push(1-u))}return l}within(e,t,r){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:i,coords:a,nodeSize:s}=this,n=[0,i.length-1,0],o=[],l=r*r;for(;n.length;){let u=n.pop()||0,h=n.pop()||0,c=n.pop()||0;if(h-c<=s){for(let r=c;r<=h;r++)ll(a[2*r],a[2*r+1],e,t)<=l&&o.push(i[r]);continue}let d=c+h>>1,p=a[2*d],f=a[2*d+1];ll(p,f,e,t)<=l&&o.push(i[d]),(0===u?e-r<=p:t-r<=f)&&(n.push(c),n.push(d-1),n.push(1-u)),(0===u?e+r>=p:t+r>=f)&&(n.push(d+1),n.push(h),n.push(1-u))}return o}}function ln(e,t,r,i){lo(e,r,i),lo(t,2*r,2*i),lo(t,2*r+1,2*i+1)}function lo(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function ll(e,t,r,i){let a=e-r,s=t-i;return a*a+s*s}e.bf=void 0,(E=e.bf||(e.bf={})).create="create",E.load="load",E.fullLoad="fullLoad";let lu=null,lh=[],lc=1e3/60,ld="loadTime",lp="fullLoadTime";e.$=class extends aa{},e.A=sI,e.B=iA,e.C=function(e){if(null==H){let t=e.navigator?e.navigator.userAgent:null;H=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return H},e.D=iQ,e.E=eo,e.F=class{constructor(e,t){var r,i,a;this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new oR(()=>this.process()),this.subscription=(r=this.target,i="message",a=e=>this.receive(e),r.addEventListener(i,a,!1),{unsubscribe:()=>{r.removeEventListener(i,a,!1)}}),this.globalScope=U(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise((r,i)=>{let a=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[a]={resolve:r,reject:i},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let t={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)},{once:!0});let s=[],n=Object.assign(Object.assign({},e),{id:a,sourceMapId:this.mapId,origin:location.origin,data:iN(e.data,s)});this.target.postMessage(n,{transfer:s})})}receive(e){let t=e.data,r=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[r];let e=this.abortControllers[r];return delete this.abortControllers[r],void(e&&e.abort())}if(U(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(0===this.taskQueue.length)return;let e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,t){return _(this,void 0,void 0,function*(){if("<response>"===t.type){let r=this.resolveRejects[e];if(delete this.resolveRejects[e],!r)return;return void(t.error?r.reject(iD(t.error)):r.resolve(iD(t.data)))}if(!this.messageHandlers[t.type])return void this.completeTask(e,Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let r=iD(t.data),i=new AbortController;this.abortControllers[e]=i;try{let a=yield this.messageHandlers[t.type](t.sourceMapId,r,i);this.completeTask(e,null,a)}catch(t){this.completeTask(e,t)}})}completeTask(e,t,r){let i=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?iN(t):null,data:iN(r,i)};this.target.postMessage(a,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.G=J,e.H=function(){var e=new sI(16);return sI!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.I=n8,e.J=function(e,t,r){var i,a,s,n,o,l,u,h,c,d,p,f,m=r[0],g=r[1],y=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(a=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],h=t[7],c=t[8],d=t[9],p=t[10],f=t[11],e[0]=i=t[0],e[1]=a,e[2]=s,e[3]=n,e[4]=o,e[5]=l,e[6]=u,e[7]=h,e[8]=c,e[9]=d,e[10]=p,e[11]=f,e[12]=i*m+o*g+c*y+t[12],e[13]=a*m+l*g+d*y+t[13],e[14]=s*m+u*g+p*y+t[14],e[15]=n*m+h*g+f*y+t[15]),e},e.K=function(e,t,r){var i=r[0],a=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.L=sO,e.M=function(e,t){let r={};for(let i=0;i<t.length;i++){let a=t[i];a in e&&(r[a]=e[a])}return r},e.N=oI,e.O=oM,e.P=T,e.Q=ok,e.R=sB,e.S=oq,e.T=iY,e.U=R,e.V=I,e.W=Y,e.X=8192,e.Y=ae,e.Z=oD,e._=_,e.a=X,e.a$=function(e,t){var r=e[0],i=e[1],a=e[2],s=e[3],n=e[4],o=e[5],l=e[6],u=e[7],h=e[8],c=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=t[0],_=t[1],x=t[2],b=t[3],S=t[4],w=t[5],E=t[6],A=t[7],T=t[8],C=t[9],P=t[10],R=t[11],I=t[12],L=t[13],O=t[14],M=t[15];return Math.abs(r-v)<=1e-6*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(i-_)<=1e-6*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-x)<=1e-6*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-b)<=1e-6*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(n-S)<=1e-6*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(o-w)<=1e-6*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(l-E)<=1e-6*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-A)<=1e-6*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-T)<=1e-6*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(c-C)<=1e-6*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-P)<=1e-6*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-R)<=1e-6*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(f-I)<=1e-6*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-L)<=1e-6*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(g-O)<=1e-6*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(y-M)<=1e-6*Math.max(1,Math.abs(y),Math.abs(M))},e.a0=aJ,e.a1=oG,e.a2=ey,e.a3=e=>{let t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{for(let i of(t.onloadstart=()=>{r(t)},e)){let e=window.document.createElement("source");er(i)||(t.crossOrigin="Anonymous"),e.src=i,t.appendChild(e)}})},e.a4=function(){return D++},e.a5=aT,e.a6=ox,e.a7=rJ,e.a8=sg,e.a9=iH,e.aA=function(e){e=e.slice();let t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=function(e,t){let r={};for(let t in e)"ref"!==t&&(r[t]=e[t]);return eu.forEach(e=>{e in t&&(r[e]=t[e])}),r}(e[r],t[e[r].ref]));return e},e.aB=function(e){if("custom"===e.type)return new oP(e);switch(e.type){case"background":return new oA(e);case"circle":return new sk(e);case"fill":return new no(e);case"fill-extrusion":return new nb(e);case"heatmap":return new sH(e);case"hillshade":return new sV(e);case"line":return new nL(e);case"raster":return new oC(e);case"symbol":return new ow(e)}},e.aC=z,e.aD=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let r=[];try{if(!eh(e.version,t.version))return[{command:"setStyle",args:[t]}];eh(e.center,t.center)||r.push({command:"setCenter",args:[t.center]}),eh(e.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),eh(e.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),eh(e.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),eh(e.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),eh(e.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),eh(e.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),eh(e.light,t.light)||r.push({command:"setLight",args:[t.light]}),eh(e.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),eh(e.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),eh(e.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});let i={},a=[];!function(e,t,r,i){let a;for(a in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,a)&&(Object.prototype.hasOwnProperty.call(t,a)||ep(a,r,i));for(a in t){var s,n;Object.prototype.hasOwnProperty.call(t,a)&&(Object.prototype.hasOwnProperty.call(e,a)?eh(e[a],t[a])||("geojson"===e[a].type&&"geojson"===t[a].type&&function(e,t,r){let i;for(i in e[r])if(Object.prototype.hasOwnProperty.call(e[r],i)&&"data"!==i&&!eh(e[r][i],t[r][i]))return!1;for(i in t[r])if(Object.prototype.hasOwnProperty.call(t[r],i)&&"data"!==i&&!eh(e[r][i],t[r][i]))return!1;return!0}(e,t,a)?ec(r,{command:"setGeoJSONSourceData",args:[a,t[a].data]}):(s=a,n=t,ep(s,r,i),ed(s,n,r))):ed(a,t,r))}}(e.sources,t.sources,a,i);let s=[];e.layers&&e.layers.forEach(e=>{"source"in e&&i[e.source]?r.push({command:"removeLayer",args:[e.id]}):s.push(e)}),r=r.concat(a),function(e,t,r){let i,a,s,n,o;t=t||[];let l=(e=e||[]).map(em),u=t.map(em),h=e.reduce(eg,{}),c=t.reduce(eg,{}),d=l.slice(),p=Object.create(null);for(let e=0,t=0;e<l.length;e++)i=l[e],Object.prototype.hasOwnProperty.call(c,i)?t++:(ec(r,{command:"removeLayer",args:[i]}),d.splice(d.indexOf(i,t),1));for(let e=0,t=0;e<u.length;e++)i=u[u.length-1-e],d[d.length-1-e]!==i&&(Object.prototype.hasOwnProperty.call(h,i)?(ec(r,{command:"removeLayer",args:[i]}),d.splice(d.lastIndexOf(i,d.length-t),1)):t++,n=d[d.length-e],ec(r,{command:"addLayer",args:[c[i],n]}),d.splice(d.length-e,0,i),p[i]=!0);for(let e=0;e<u.length;e++)if(a=h[i=u[e]],s=c[i],!p[i]&&!eh(a,s)){if(eh(a.source,s.source)&&eh(a["source-layer"],s["source-layer"])&&eh(a.type,s.type)){for(o in ef(a.layout,s.layout,r,i,null,"setLayoutProperty"),ef(a.paint,s.paint,r,i,null,"setPaintProperty"),eh(a.filter,s.filter)||ec(r,{command:"setFilter",args:[i,s.filter]}),eh(a.minzoom,s.minzoom)&&eh(a.maxzoom,s.maxzoom)||ec(r,{command:"setLayerZoomRange",args:[i,s.minzoom,s.maxzoom]}),a)Object.prototype.hasOwnProperty.call(a,o)&&"layout"!==o&&"paint"!==o&&"filter"!==o&&"metadata"!==o&&"minzoom"!==o&&"maxzoom"!==o&&(0===o.indexOf("paint.")?ef(a[o],s[o],r,i,o.slice(6),"setPaintProperty"):eh(a[o],s[o])||ec(r,{command:"setLayerProperty",args:[i,o,s[o]]}));for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&!Object.prototype.hasOwnProperty.call(a,o)&&"layout"!==o&&"paint"!==o&&"filter"!==o&&"metadata"!==o&&"minzoom"!==o&&"maxzoom"!==o&&(0===o.indexOf("paint.")?ef(a[o],s[o],r,i,o.slice(6),"setPaintProperty"):eh(a[o],s[o])||ec(r,{command:"setLayerProperty",args:[i,o,s[o]]}))}else ec(r,{command:"removeLayer",args:[i]}),n=d[d.lastIndexOf(i)+1],ec(r,{command:"addLayer",args:[s,n]})}}(s,t.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:"setStyle",args:[t]}]}return r},e.aE=function(e){let t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.aF=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(!e(t[i],r[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r||Object.keys(t).length!==Object.keys(r).length)return!1;for(let i in t)if(!e(t[i],r[i]))return!1;return!0}return t===r},e.aG=F,e.aH=G,e.aI=class extends se{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.aJ=st,e.aK=class extends se{constructor(e,t){super(e,t),this.current=sa}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.aL=sr,e.aM=si,e.aN=e3,e.aO=class extends se{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.aP=class extends se{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.aQ=function(e,t,r,i,a,s,n){var o=1/(t-r),l=1/(i-a),u=1/(s-n);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*o,e[13]=(a+i)*l,e[14]=(n+s)*u,e[15]=1,e},e.aR=sO,e.aS=class extends af{},e.aT=nD,e.aU=class extends ag{},e.aV=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.aW=sU,e.aX=aF,e.aY=a$,e.aZ=class extends aw{},e.a_=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.aa=oH,e.ab=function(e){let t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(e,r,i,a)=>{let s=i||a;return t[r]=!s||s.toLowerCase(),""}),t["max-age"]){let e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.ac=function(e,t){let r=[];for(let i in e)i in t||r.push(i);return r},e.ad=M,e.ae=function(e,t,r){var i=Math.sin(r),a=Math.cos(r),s=t[0],n=t[1],o=t[2],l=t[3],u=t[4],h=t[5],c=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*a+u*i,e[1]=n*a+h*i,e[2]=o*a+c*i,e[3]=l*a+d*i,e[4]=u*a-s*i,e[5]=h*a-n*i,e[6]=c*a-o*i,e[7]=d*a-l*i,e},e.af=function(e){var t=new sI(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.ag=sM,e.ah=function(e,t){let r=0,i=0;if("constant"===e.kind)i=e.layoutSize;else if("source"!==e.kind){let{interpolationType:a,minZoom:s,maxZoom:n}=e,o=a?M(tR.interpolationFactor(a,t,s,n),0,1):0;"camera"===e.kind?i=tP.number(e.minSize,e.maxSize,o):r=o}return{uSizeT:r,uSize:i}},e.aj=function(e,{uSize:t,uSizeT:r},{lowerSize:i,upperSize:a}){return"source"===e.kind?i/128:"composite"===e.kind?tP.number(i/128,a/128,r):t},e.ak=oy,e.al=function(e,t,r,i){let a=t.y-e.y,s=t.x-e.x,n=i.y-r.y,o=i.x-r.x,l=n*s-o*a;if(0===l)return null;let u=(o*(e.y-r.y)-n*(e.x-r.x))/l;return new T(e.x+u*s,e.y+u*a)},e.am=o$,e.an=s_,e.ao=sL,e.ap=function(e){let t=1/0,r=1/0,i=-1/0,a=-1/0;for(let s of e)t=Math.min(t,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),a=Math.max(a,s.y);return[t,r,i,a]},e.aq=24,e.as=op,e.at=function(e,t){var r=t[0],i=t[1],a=t[2],s=t[3],n=t[4],o=t[5],l=t[6],u=t[7],h=t[8],c=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],v=r*o-i*n,_=r*l-a*n,x=r*u-s*n,b=i*l-a*o,S=i*u-s*o,w=a*u-s*l,E=h*m-c*f,A=h*g-d*f,T=h*y-p*f,C=c*g-d*m,P=c*y-p*m,R=d*y-p*g,I=v*R-_*P+x*C+b*T-S*A+w*E;return I?(e[0]=(o*R-l*P+u*C)*(I=1/I),e[1]=(a*P-i*R-s*C)*I,e[2]=(m*w-g*S+y*b)*I,e[3]=(d*S-c*w-p*b)*I,e[4]=(l*T-n*R-u*A)*I,e[5]=(r*R-a*T+s*A)*I,e[6]=(g*x-f*w-y*_)*I,e[7]=(h*w-d*x+p*_)*I,e[8]=(n*P-o*T+u*E)*I,e[9]=(i*T-r*P-s*E)*I,e[10]=(f*S-m*x+y*v)*I,e[11]=(c*x-h*S-p*v)*I,e[12]=(o*A-n*C-l*E)*I,e[13]=(r*C-i*A+a*E)*I,e[14]=(m*_-f*b-g*v)*I,e[15]=(h*b-c*_+d*v)*I,e):null},e.au=lt,e.av=ou,e.aw=ls,e.ax=function(){let e={},t=el.$version;for(let r in el.$root){let i=el.$root[r];if(i.required){let a=null;null!=(a="version"===r?t:"array"===i.type?[]:{})&&(e[r]=a)}}return e},e.ay=iF,e.az=ee,e.b=Z,e.b0=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.b1=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.b2=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.b3=k,e.b4=oz,e.b5=function(e,t){return e/oO(t)},e.b6=function(e,t,r,i,a){var s,n=1/Math.tan(t/2);return e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(e[10]=(a+i)*(s=1/(i-a)),e[14]=2*a*i*s):(e[10]=-1,e[14]=-2*i),e},e.b7=function(e,t,r){var i=Math.sin(r),a=Math.cos(r),s=t[4],n=t[5],o=t[6],l=t[7],u=t[8],h=t[9],c=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*a+u*i,e[5]=n*a+h*i,e[6]=o*a+c*i,e[7]=l*a+d*i,e[8]=u*a-s*i,e[9]=h*a-n*i,e[10]=c*a-o*i,e[11]=d*a-l*i,e},e.b8=L,e.b9=O,e.bA=function(e){return e.message===W},e.bB=rZ,e.bC=iU,e.ba=function(e){return e*Math.PI/180},e.bb=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.bc=class extends ai{},e.bd=6371008.8,e.be={mark(e){performance.mark(e)},frame(e){null!=lu&&lh.push(e-lu),lu=e},clearMetrics(){for(let t in lu=null,lh=[],performance.clearMeasures(ld),performance.clearMeasures(lp),e.bf)performance.clearMarks(e.bf[t])},getPerformanceMetrics(){performance.measure(ld,e.bf.create,e.bf.load),performance.measure(lp,e.bf.create,e.bf.fullLoad);let t=performance.getEntriesByName(ld)[0].duration,r=performance.getEntriesByName(lp)[0].duration,i=lh.length,a=1/(lh.reduce((e,t)=>e+t,0)/i/1e3),s=lh.filter(e=>e>lc).reduce((e,t)=>e+(t-lc)/lc,0);return{loadTime:t,fullLoadTime:r,fps:a,percentDroppedFrames:s/(i+s)*100,totalFrames:i}}},e.bg=Q,e.bh=function(e,t){X.REGISTERED_PROTOCOLS[e]=t},e.bi=function(e){delete X.REGISTERED_PROTOCOLS[e]},e.bj=function(e,t){let r={};for(let i=0;i<e.length;i++){let a=t&&t[e[i].id]||function(e){let t="";for(let r of eu)t+=`/${function e(t){let r=typeof t;if("number"===r||"boolean"===r||"string"===r||null==t)return JSON.stringify(t);if(Array.isArray(t)){let r="[";for(let i of t)r+=`${e(i)},`;return`${r}]`}let i=Object.keys(t).sort(),a="{";for(let r=0;r<i.length;r++)a+=`${JSON.stringify(i[r])}:${e(t[i[r]])},`;return`${a}}`}(e[r])}`;return t}(e[i]);t&&(t[e[i].id]=a);let s=r[a];s||(s=r[a]=[]),s.push(e[i])}let i=[];for(let e in r)i.push(r[e]);return i},e.bk=iL,e.bl=oU,e.bm=oZ,e.bn=n7,e.bo=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=8192/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;let r=t.bucket.layers[0],i=r.layout,a=r._unevaluatedLayout._values,s={layoutIconSize:a["icon-size"].possiblyEvaluate(new iH(t.bucket.zoom+1),t.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new iH(t.bucket.zoom+1),t.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new iH(18))};if("composite"===t.bucket.textSizeData.kind){let{minZoom:e,maxZoom:r}=t.bucket.textSizeData;s.compositeTextSizes=[a["text-size"].possiblyEvaluate(new iH(e),t.canonical),a["text-size"].possiblyEvaluate(new iH(r),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){let{minZoom:e,maxZoom:r}=t.bucket.iconSizeData;s.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new iH(e),t.canonical),a["icon-size"].possiblyEvaluate(new iH(r),t.canonical)]}let n=24*i.get("text-line-height"),o="viewport"!==i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),l=i.get("text-keep-upright"),u=i.get("text-size");for(let a of t.bucket.features){let h=i.get("text-font").evaluate(a,{},t.canonical).join(","),c=u.evaluate(a,{},t.canonical),d=s.layoutTextSize.evaluate(a,{},t.canonical),p=s.layoutIconSize.evaluate(a,{},t.canonical),f={horizontal:{},vertical:void 0},m=a.text,g,y=[0,0];if(m){let s=m.toString(),u=24*i.get("text-letter-spacing").evaluate(a,{},t.canonical),p=!function(e){for(let r of e){var t;if(t=r.charCodeAt(0),iG.Arabic(t)||iG["Arabic Supplement"](t)||iG["Arabic Extended-A"](t)||iG["Arabic Presentation Forms-A"](t)||iG["Arabic Presentation Forms-B"](t))return!1}return!0}(s)?0:u,g=i.get("text-anchor").evaluate(a,{},t.canonical),v=le(r,a,t.canonical);if(!v){let e=i.get("text-radial-offset").evaluate(a,{},t.canonical);y=e?o9(g,[24*e,o7]):i.get("text-offset").evaluate(a,{},t.canonical).map(e=>24*e)}let _=o?"center":i.get("text-justify").evaluate(a,{},t.canonical),x="point"===i.get("symbol-placement")?24*i.get("text-max-width").evaluate(a,{},t.canonical):1/0,b=()=>{t.bucket.allowVerticalPlacement&&iz(s)&&(f.vertical=ot(m,t.glyphMap,t.glyphPositions,t.imagePositions,h,x,n,g,"left",p,y,e.ai.vertical,!0,d,c))};if(!o&&v){let r=new Set;if("auto"===_)for(let e=0;e<v.values.length;e+=2)r.add(lt(v.values[e]));else r.add(_);let i=!1;for(let a of r)if(!f.horizontal[a]){if(i)f.horizontal[a]=f.horizontal[0];else{let r=ot(m,t.glyphMap,t.glyphPositions,t.imagePositions,h,x,n,"center",a,p,y,e.ai.horizontal,!1,d,c);r&&(f.horizontal[a]=r,i=1===r.positionedLines.length)}}b()}else{"auto"===_&&(_=lt(g));let r=ot(m,t.glyphMap,t.glyphPositions,t.imagePositions,h,x,n,g,_,p,y,e.ai.horizontal,!1,d,c);r&&(f.horizontal[_]=r),b(),iz(s)&&o&&l&&(f.vertical=ot(m,t.glyphMap,t.glyphPositions,t.imagePositions,h,x,n,g,_,p,y,e.ai.vertical,!1,d,c))}}let v=!1;if(a.icon&&a.icon.name){let e=t.imageMap[a.icon.name];e&&(g=function(e,t,r){let{horizontalAlign:i,verticalAlign:a}=ou(r),s=t[0]-e.displaySize[0]*i,n=t[1]-e.displaySize[1]*a;return{image:e,top:n,bottom:n+e.displaySize[1],left:s,right:s+e.displaySize[0]}}(t.imagePositions[a.icon.name],i.get("icon-offset").evaluate(a,{},t.canonical),i.get("icon-anchor").evaluate(a,{},t.canonical)),v=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=v:t.bucket.sdfIcons!==v&&j("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==i.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}let _=li(f.horizontal)||f.vertical;t.bucket.iconsInText=!!_&&_.iconsInText,(_||g)&&function(t,r,i,a,s,n,o,l,u,h,c){let d,p=n.textMaxSize.evaluate(r,{});void 0===p&&(p=o);let f=t.layers[0].layout,m=f.get("icon-offset").evaluate(r,{},c),g=li(i.horizontal),y=o/24,v=t.tilePixelRatio*y,_=t.tilePixelRatio*p/24,x=t.tilePixelRatio*l,b=t.tilePixelRatio*f.get("symbol-spacing"),S=f.get("text-padding")*t.tilePixelRatio,w=function(e,t,r,i=1){let a=e.get("icon-padding").evaluate(t,{},r),s=a&&a.values;return[s[0]*i,s[1]*i,s[2]*i,s[3]*i]}(f,r,c,t.tilePixelRatio),E=f.get("text-max-angle")/180*Math.PI,A="viewport"!==f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),C="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),P=f.get("symbol-placement"),R=b/2,I=f.get("icon-text-fit");a&&"none"!==I&&(t.allowVerticalPlacement&&i.vertical&&(d=oc(a,i.vertical,I,f.get("icon-text-fit-padding"),m,y)),g&&(a=oc(a,g,I,f.get("icon-text-fit-padding"),m,y)));let L=(l,p)=>{p.x<0||p.x>=8192||p.y<0||p.y>=8192||function(t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A){let T=t.addToLineVertexArray(r,i),C,P,R,I,L=0,O=0,M=0,k=0,N=-1,D=-1,F={},G=a6("");if(t.allowVerticalPlacement&&a.vertical){let e=l.layout.get("text-rotate").evaluate(b,{},E)+90;R=new o5(u,r,h,c,d,a.vertical,p,f,m,e),o&&(I=new o5(u,r,h,c,d,o,y,v,m,e))}if(s){let i=l.layout.get("icon-rotate").evaluate(b,{}),a="none"!==l.layout.get("icon-text-fit"),n=o0(s,i,w,a),p=o?o0(o,i,w,a):void 0;P=new o5(u,r,h,c,d,s,y,v,!1,i),L=4*n.length;let f=t.iconSizeData,m=null;"source"===f.kind?(m=[128*l.layout.get("icon-size").evaluate(b,{})])[0]>32640&&j(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`):"composite"===f.kind&&((m=[128*S.compositeIconSizes[0].evaluate(b,{},E),128*S.compositeIconSizes[1].evaluate(b,{},E)])[0]>32640||m[1]>32640)&&j(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`),t.addSymbols(t.icon,n,m,x,_,b,e.ai.none,r,T.lineStartIndex,T.lineLength,-1,E),N=t.icon.placedSymbolArray.length-1,p&&(O=4*p.length,t.addSymbols(t.icon,p,m,x,_,b,e.ai.vertical,r,T.lineStartIndex,T.lineLength,-1,E),D=t.icon.placedSymbolArray.length-1)}let z=Object.keys(a.horizontal);for(let i of z){let s=a.horizontal[i];!C&&(G=a6(s.text),C=new o5(u,r,h,c,d,s,p,f,m,l.layout.get("text-rotate").evaluate(b,{},E)));let o=1===s.positionedLines.length;if(M+=lr(t,r,s,n,l,m,b,g,T,a.vertical?e.ai.horizontal:e.ai.horizontalOnly,o?z:[i],F,N,S,E),o)break}a.vertical&&(k+=lr(t,r,a.vertical,n,l,m,b,g,T,e.ai.vertical,["vertical"],F,D,S,E));let q=C?C.boxStartIndex:t.collisionBoxArray.length,B=C?C.boxEndIndex:t.collisionBoxArray.length,U=R?R.boxStartIndex:t.collisionBoxArray.length,H=R?R.boxEndIndex:t.collisionBoxArray.length,Z=P?P.boxStartIndex:t.collisionBoxArray.length,V=P?P.boxEndIndex:t.collisionBoxArray.length,Y=I?I.boxStartIndex:t.collisionBoxArray.length,W=I?I.boxEndIndex:t.collisionBoxArray.length,$=-1,X=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;$=X(C,-1),$=X(R,$),$=X(P,$);let K=($=X(I,$))>-1?1:0;K&&($*=A/24),t.glyphOffsetArray.length>=ox.MAX_GLYPHS&&j("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey);let J=le(l,b,E),[Q,ee]=function(t,r){let i=t.length,a=null==r?void 0:r.values;if((null==a?void 0:a.length)>0)for(let r=0;r<a.length;r+=2){let i=a[r+1];t.emplaceBack(e.ar[a[r]],i[0],i[1])}return[i,t.length]}(t.textAnchorOffsets,J);t.symbolInstances.emplaceBack(r.x,r.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,N,D,G,q,B,U,H,Z,V,Y,W,h,M,k,L,O,K,0,p,$,Q,ee)}(t,p,l,i,a,s,d,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,v,[S,S,S,S],A,u,x,w,C,m,r,n,h,c,o)};if("line"===P)for(let e of o$(r.geometry,0,0,8192,8192))for(let r of function(e,t,r,i,a,s,n,o,l){let u=i?.6*s*n:0,h=oQ(i,a),c=h*n,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-c<t/4&&(t=c+t/4),function e(t,r,i,a,s,n,o,l,u){let h=n/2,c=oJ(t),d=0,p=r-i,f=[];for(let e=0;e<t.length-1;e++){let r=t[e],o=t[e+1],l=r.dist(o),m=o.angleTo(r);for(;p+i<d+l;){let g=((p+=i)-d)/l,y=tP.number(r.x,o.x,g),v=tP.number(r.y,o.y,g);if(y>=0&&y<u&&v>=0&&v<u&&p-h>=0&&p+h<=c){let r=new oX(y,v,m,e);r._round(),a&&!oK(t,r,n,a,s)||f.push(r)}}d+=l}return l||f.length||o||(f=e(t,d/2,i,a,s,n,o,!0,u)),f}(e,d?t/2*o%t:(h/2+2*s)*n*o%t,t,u,r,c,d,!1,l)}(e,b,E,i.vertical||g,a,24,_,t.overscaling,8192))g&&function(e,t,r,i){let a=e.compareText;if(t in a){let e=a[t];for(let t=e.length-1;t>=0;t--)if(i.dist(e[t])<r)return!0}else a[t]=[];return a[t].push(i),!1}(t,g.text,R,r)||L(e,r);else if("line-center"===P){for(let e of r.geometry)if(e.length>1){let t=function(e,t,r,i,a,s){let n=r?.6*24*s:0,o=oQ(r,i)*s,l=0,u=oJ(e)/2;for(let r=0;r<e.length-1;r++){let i=e[r],a=e[r+1],s=i.dist(a);if(l+s>u){let h=(u-l)/s,c=new oX(tP.number(i.x,a.x,h),tP.number(i.y,a.y,h),a.angleTo(i),r);return c._round(),!n||oK(e,c,o,n,t)?c:void 0}l+=s}}(e,E,i.vertical||g,a,0,_);t&&L(e,t)}}else if("Polygon"===r.type)for(let e of t9(r.geometry,0)){let t=function(e,t=1,r=!1){let i=1/0,a=1/0,s=-1/0,n=-1/0,o=e[0];for(let e=0;e<o.length;e++){let t=o[e];(!e||t.x<i)&&(i=t.x),(!e||t.y<a)&&(a=t.y),(!e||t.x>s)&&(s=t.x),(!e||t.y>n)&&(n=t.y)}let l=Math.min(s-i,n-a),u=l/2,h=new o3([],o6);if(0===l)return new T(i,a);for(let t=i;t<s;t+=l)for(let r=a;r<n;r+=l)h.push(new o8(t+u,r+u,u,e));let c=function(e){let t=0,r=0,i=0,a=e[0];for(let e=0,s=a.length,n=s-1;e<s;n=e++){let s=a[e],o=a[n],l=s.x*o.y-o.x*s.y;r+=(s.x+o.x)*l,i+=(s.y+o.y)*l,t+=3*l}return new o8(r/t,i/t,0,e)}(e),d=h.length;for(;h.length;){let i=h.pop();(i.d>c.d||!c.d)&&(c=i,r&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,d)),i.max-c.d<=t||(u=i.h/2,h.push(new o8(i.p.x-u,i.p.y-u,u,e)),h.push(new o8(i.p.x+u,i.p.y-u,u,e)),h.push(new o8(i.p.x-u,i.p.y+u,u,e)),h.push(new o8(i.p.x+u,i.p.y+u,u,e)),d+=4)}return r&&(console.log(`num probes: ${d}`),console.log(`best distance: ${c.d}`)),c.p}(e,16);L(e[0],new oX(t.x,t.y,0))}else if("LineString"===r.type)for(let e of r.geometry)L(e,new oX(e[0].x,e[0].y,0));else if("Point"===r.type)for(let e of r.geometry)for(let t of e)L([t],new oX(t.x,t.y,0))}(t.bucket,a,f,g,t.imageMap,s,d,p,y,v,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.bp=nP,e.bq=ns,e.br=n_,e.bs=nc,e.bt=n2,e.bu=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.bv=function(e,t,r,s,n){return _(this,void 0,void 0,function*(){if(I())try{return yield Y(e,t,r,s,n)}catch(e){}return function(e,t,r,s,n){let o=e.width,l=e.height;i&&a||(a=(i=new OffscreenCanvas(o,l)).getContext("2d",{willReadFrequently:!0})),i.width=o,i.height=l,a.drawImage(e,0,0,o,l);let u=a.getImageData(t,r,s,n);return a.clearRect(0,0,o,l),u.data}(e,t,r,s,n)})},e.bw=oB,e.bx=x,e.by=b,e.bz=nq,e.c=$,e.d=e=>_(void 0,void 0,void 0,function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));let t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(e){throw Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),e.e=N,e.f=e=>new Promise((t,r)=>{let i=new Image;i.onload=()=>{t(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame(()=>{i.src=V})},i.onerror=()=>r(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let a=new Blob([new Uint8Array(e)],{type:"image/png"});i.src=e.byteLength?URL.createObjectURL(a):V}),e.g=K,e.h=(e,t)=>et(N(e,{type:"json"}),t),e.i=U,e.j=en,e.k=es,e.l=(e,t)=>et(N(e,{type:"arrayBuffer"}),t),e.m=et,e.n=function(e){return new n2(e).readFields(n5,[])},e.o=sj,e.p=n6,e.q=i3,e.r=iE,e.s=er,e.t=iP,e.u=iG,e.v=el,e.w=j,e.x=ix,e.y=function([e,t,r]){return t+=90,{x:e*Math.cos(t*=Math.PI/180)*Math.sin(r*=Math.PI/180),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}},e.z=tP}),r("worker",["./shared"],function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,r){for(let r of t){this._layerConfigs[r.id]=r;let t=this._layers[r.id]=e.aB(r);t._featureFilter=e.a7(t.filter),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(let e of r)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];for(let t of(this.familiesBySource={},e.bj(Object.values(this._layerConfigs),this.keyCache))){let e=t.map(e=>this._layers[e.id]),r=e[0];if("none"===r.visibility)continue;let i=r.source||"",a=this.familiesBySource[i];a||(a=this.familiesBySource[i]={});let s=r.sourceLayer||"_geojsonTileLayer",n=a[s];n||(n=a[s]=[]),n.push(e)}}}class r{constructor(t){let r={},i=[];for(let e in t){let a=t[e],s=r[e]={};for(let e in a){let t=a[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;let r={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};i.push(r),s[e]={rect:r,metrics:t.metrics}}}let{w:a,h:s}=e.p(i),n=new e.o({width:a||1,height:s||1});for(let i in t){let a=t[i];for(let t in a){let s=a[+t];if(!s||0===s.bitmap.width||0===s.bitmap.height)continue;let o=r[i][t].rect;e.o.copy(s.bitmap,n,{x:0,y:0},{x:o.x+1,y:o.y+1},s.bitmap)}}this.image=n,this.positions=r}}e.bk("GlyphAtlas",r);class i{constructor(t){this.tileID=new e.S(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,i,s,n){return e._(this,void 0,void 0,function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.a5;let o=new e.bl(Object.keys(t.layers).sort()),l=new e.bm(this.tileID,this.promoteId);l.bucketLayerIDs=[];let u={},h={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:s},c=i.familiesBySource[this.source];for(let r in c){let i=t.layers[r];if(!i)continue;1===i.version&&e.w(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let n=o.encode(r),d=[];for(let e=0;e<i.length;e++){let t=i.feature(e),a=l.getId(t,r);d.push({feature:t,id:a,index:e,sourceLayerIndex:n})}for(let t of c[r]){let r=t[0];r.source!==this.source&&e.w(`layer.source = ${r.source} does not equal this.source = ${this.source}`),r.minzoom&&this.zoom<Math.floor(r.minzoom)||r.maxzoom&&this.zoom>=r.maxzoom||"none"!==r.visibility&&(a(t,this.zoom,s),(u[r.id]=r.createBucket({index:l.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:n,sourceID:this.source})).populate(d,h,this.tileID.canonical),l.bucketLayerIDs.push(t.map(e=>e.id)))}}let d=e.aG(h.glyphDependencies,e=>Object.keys(e).map(Number));this.inFlightDependencies.forEach(e=>null==e?void 0:e.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(d).length){let e=new AbortController;this.inFlightDependencies.push(e),p=n.sendAsync({type:"GG",data:{stacks:d,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}let f=Object.keys(h.iconDependencies),m=Promise.resolve({});if(f.length){let e=new AbortController;this.inFlightDependencies.push(e),m=n.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},e)}let g=Object.keys(h.patternDependencies),y=Promise.resolve({});if(g.length){let e=new AbortController;this.inFlightDependencies.push(e),y=n.sendAsync({type:"GI",data:{icons:g,source:this.source,tileID:this.tileID,type:"patterns"}},e)}let[v,_,x]=yield Promise.all([p,m,y]),b=new r(v),S=new e.bn(_,x);for(let t in u){let r=u[t];r instanceof e.a6?(a(r.layers,this.zoom,s),e.bo({bucket:r,glyphMap:v,glyphPositions:b.positions,imageMap:_,imagePositions:S.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):r.hasPattern&&(r instanceof e.bp||r instanceof e.bq||r instanceof e.br)&&(a(r.layers,this.zoom,s),r.addFeatures(h,this.tileID.canonical,S.patternPositions))}return this.status="done",{buckets:Object.values(u).filter(e=>!e.isEmpty()),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:S,glyphMap:this.returnDependencies?v:null,iconMap:this.returnDependencies?_:null,glyphPositions:this.returnDependencies?b.positions:null}})}}function a(t,r,i){let a=new e.a9(r);for(let e of t)e.recalculate(a,i)}class s{constructor(e,t,r){this.actor=e,this.layerIndex=t,this.availableImages=r,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(t,r){return e._(this,void 0,void 0,function*(){let i=yield e.l(t.request,r);try{return{vectorTile:new e.bs.VectorTile(new e.bt(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires}}catch(a){let e=new Uint8Array(i.data),r=`Unable to parse the tile at ${t.request.url}, `;throw Error(r+=31===e[0]&&139===e[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${a.message}`)}})}loadTile(t){return e._(this,void 0,void 0,function*(){let r=t.uid,a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bu(t.request),s=new i(t);this.loading[r]=s;let n=new AbortController;s.abort=n;try{let i=yield this.loadVectorTile(t,n);if(delete this.loading[r],!i)return null;let o=i.rawData,l={};i.expires&&(l.expires=i.expires),i.cacheControl&&(l.cacheControl=i.cacheControl);let u={};if(a){let e=a.finish();e&&(u.resourceTiming=JSON.parse(JSON.stringify(e)))}s.vectorTile=i.vectorTile;let h=s.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=s,this.fetching[r]={rawTileData:o,cacheControl:l,resourceTiming:u};try{let t=yield h;return e.e({rawTileData:o.slice(0)},t,l,u)}finally{delete this.fetching[r]}}catch(e){throw delete this.loading[r],s.status="done",this.loaded[r]=s,e}})}reloadTile(t){return e._(this,void 0,void 0,function*(){let r=t.uid;if(!this.loaded||!this.loaded[r])throw Error("Should not be trying to reload a tile that was never loaded or has been removed");let i=this.loaded[r];if(i.showCollisionBoxes=t.showCollisionBoxes,"parsing"===i.status){let t;let a=yield i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);if(this.fetching[r]){let{rawTileData:i,cacheControl:s,resourceTiming:n}=this.fetching[r];delete this.fetching[r],t=e.e({rawTileData:i.slice(0)},a,s,n)}else t=a;return t}if("done"===i.status&&i.vectorTile)return i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(t){return e._(this,void 0,void 0,function*(){let e=this.loading,r=t.uid;e&&e[r]&&e[r].abort&&(e[r].abort.abort(),delete e[r])})}removeTile(t){return e._(this,void 0,void 0,function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]})}}class n{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,function*(){let{uid:r,encoding:i,rawImageData:a,redFactor:s,greenFactor:n,blueFactor:o,baseShift:l}=t,u=a.width+2,h=a.height+2,c=e.b(a)?new e.R({width:u,height:h},(yield e.bv(a,-1,-1,u,h))):a,d=new e.bw(r,c,i,s,n,o,l);return this.loaded=this.loaded||{},this.loaded[r]=d,d})}removeTile(e){let t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}}function o(e,t){if(0!==e.length){l(e[0],t);for(var r=1;r<e.length;r++)l(e[r],!t)}}function l(e,t){for(var r=0,i=0,a=0,s=e.length,n=s-1;a<s;n=a++){var o=(e[a][0]-e[n][0])*(e[n][1]+e[a][1]),l=r+o;i+=Math.abs(r)>=Math.abs(o)?r-l+o:o-l+r,r=l}r+i>=0!=!!t&&e.reverse()}var u,h=e.bx(function e(t,r){var i,a=t&&t.type;if("FeatureCollection"===a)for(i=0;i<t.features.length;i++)e(t.features[i],r);else if("GeometryCollection"===a)for(i=0;i<t.geometries.length;i++)e(t.geometries[i],r);else if("Feature"===a)e(t.geometry,r);else if("Polygon"===a)o(t.coordinates,r);else if("MultiPolygon"===a)for(i=0;i<t.coordinates.length;i++)o(t.coordinates[i],r);return t});let c=e.bs.VectorTileFeature.prototype.toGeoJSON;var d={exports:{}},p=e.by,f=e.bs.VectorTileFeature;function m(e,t){this.options=t||{},this.features=e,this.length=e.length}function g(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}m.prototype.feature=function(e){return new g(this.features[e],this.options.extent)},g.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],i=[],a=0;a<r.length;a++)i.push(new p(r[a][0],r[a][1]));this.geometry.push(i)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,i=1/0,a=-1/0,s=0;s<e.length;s++)for(var n=e[s],o=0;o<n.length;o++){var l=n[o];t=Math.min(t,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),a=Math.max(a,l.y)}return[t,i,r,a]},g.prototype.toGeoJSON=f.prototype.toGeoJSON;var y=e.bz;function v(e){var t=new y;return function(e,t){for(var r in e.layers)t.writeMessage(3,_,e.layers[r])}(e,t),t.finish()}function _(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r,i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)i.feature=e.feature(r),t.writeMessage(2,x,i);var a=i.keys;for(r=0;r<a.length;r++)t.writeStringField(3,a[r]);var s=i.values;for(r=0;r<s.length;r++)t.writeMessage(4,w,s[r])}function x(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,b,e),t.writeVarintField(3,r.type),t.writeMessage(4,S,r)}function b(e,t){var r=e.feature,i=e.keys,a=e.values,s=e.keycache,n=e.valuecache;for(var o in r.properties){var l=r.properties[o],u=s[o];if(null!==l){void 0===u&&(i.push(o),s[o]=u=i.length-1),t.writeVarint(u);var h=typeof l;"string"!==h&&"boolean"!==h&&"number"!==h&&(l=JSON.stringify(l));var c=h+":"+l,d=n[c];void 0===d&&(a.push(l),n[c]=d=a.length-1),t.writeVarint(d)}}}function S(e,t){for(var r=e.loadGeometry(),i=e.type,a=0,s=0,n=r.length,o=0;o<n;o++){var l=r[o],u=1;1===i&&(u=l.length),t.writeVarint((u<<3)+1);for(var h=3===i?l.length-1:l.length,c=0;c<h;c++){1===c&&1!==i&&t.writeVarint((h-1<<3)+2);var d=l[c].x-a,p=l[c].y-s;t.writeVarint(d<<1^d>>31),t.writeVarint(p<<1^p>>31),a+=d,s+=p}3===i&&t.writeVarint(15)}}function w(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}d.exports=v,d.exports.fromVectorTileJs=v,d.exports.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var i in e)r[i]=new m(e[i].features,t),r[i].name=i,r[i].version=t.version,r[i].extent=t.extent;return v({layers:r})},d.exports.GeoJSONWrapper=m;var E=e.bx(d.exports);let A={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},T=Math.fround||(u=new Float32Array(1),e=>(u[0]=+e,u[0]));class C{constructor(e){this.options=Object.assign(Object.create(A),e),this.trees=Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:t,minZoom:r,maxZoom:i}=this.options;t&&console.time("total time");let a=`prepare ${e.length} points`;t&&console.time(a),this.points=e;let s=[];for(let t=0;t<e.length;t++){let r=e[t];if(!r.geometry)continue;let[i,a]=r.geometry.coordinates,n=T(I(i)),o=T(L(a));s.push(n,o,1/0,t,-1,1),this.options.reduce&&s.push(0)}let n=this.trees[i+1]=this._createTree(s);t&&console.timeEnd(a);for(let e=i;e>=r;e--){let r=+Date.now();n=this.trees[e]=this._createTree(this._cluster(n,e)),t&&console.log("z%d: %d clusters in %dms",e,n.numItems,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),a=180===e[2]?180:((e[2]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,a=180;else if(r>a){let e=this.getClusters([r,i,180,s],t),n=this.getClusters([-180,i,a,s],t);return e.concat(n)}let n=this.trees[this._limitZoom(t)],o=n.range(I(r),L(s),I(a),L(i)),l=n.data,u=[];for(let e of o){let t=this.stride*e;u.push(l[t+5]>1?P(l,t,this.clusterProps):this.points[l[t+3]])}return u}getChildren(e){let t=this._getOriginId(e),r=this._getOriginZoom(e),i="No cluster with the specified id.",a=this.trees[r];if(!a)throw Error(i);let s=a.data;if(t*this.stride>=s.length)throw Error(i);let n=this.options.radius/(this.options.extent*Math.pow(2,r-1)),o=a.within(s[t*this.stride],s[t*this.stride+1],n),l=[];for(let t of o){let r=t*this.stride;s[r+4]===e&&l.push(s[r+5]>1?P(s,r,this.clusterProps):this.points[s[r+3]])}if(0===l.length)throw Error(i);return l}getLeaves(e,t,r){let i=[];return this._appendLeaves(i,e,t=t||10,r=r||0,0),i}getTile(e,t,r){let i=this.trees[this._limitZoom(e)],a=Math.pow(2,e),{extent:s,radius:n}=this.options,o=n/s,l=(r-o)/a,u=(r+1+o)/a,h={features:[]};return this._addTileFeatures(i.range((t-o)/a,l,(t+1+o)/a,u),i.data,t,r,a,h),0===t&&this._addTileFeatures(i.range(1-o/a,l,1,u),i.data,a,r,a,h),t===a-1&&this._addTileFeatures(i.range(0,l,o/a,u),i.data,-1,r,a,h),h.features.length?h:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){let r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,i,a){for(let s of this.getChildren(t)){let t=s.properties;if(t&&t.cluster?a+t.point_count<=i?a+=t.point_count:a=this._appendLeaves(e,t.cluster_id,r,i,a):a<i?a++:e.push(s),e.length===r)break}return a}_createTree(t){let r=new e.aw(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)r.add(t[e],t[e+1]);return r.finish(),r.data=t,r}_addTileFeatures(e,t,r,i,a,s){for(let n of e){let e,o,l,u;let h=n*this.stride,c=t[h+5]>1;if(c)e=R(t,h,this.clusterProps),o=t[h],l=t[h+1];else{let r=this.points[t[h+3]];e=r.properties;let[i,a]=r.geometry.coordinates;o=I(i),l=L(a)}let d={type:1,geometry:[[Math.round(this.options.extent*(o*a-r)),Math.round(this.options.extent*(l*a-i))]],tags:e};void 0!==(u=c||this.options.generateId?t[h+3]:this.points[t[h+3]].id)&&(d.id=u),s.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){let{radius:r,extent:i,reduce:a,minPoints:s}=this.options,n=r/(i*Math.pow(2,t)),o=e.data,l=[],u=this.stride;for(let r=0;r<o.length;r+=u){if(o[r+2]<=t)continue;o[r+2]=t;let i=o[r],h=o[r+1],c=e.within(o[r],o[r+1],n),d=o[r+5],p=d;for(let e of c){let r=e*u;o[r+2]>t&&(p+=o[r+5])}if(p>d&&p>=s){let e,s=i*d,n=h*d,f=-1,m=((r/u|0)<<5)+(t+1)+this.points.length;for(let i of c){let l=i*u;if(o[l+2]<=t)continue;o[l+2]=t;let h=o[l+5];s+=o[l]*h,n+=o[l+1]*h,o[l+4]=m,a&&(e||(e=this._map(o,r,!0),f=this.clusterProps.length,this.clusterProps.push(e)),a(e,this._map(o,l)))}o[r+4]=m,l.push(s/p,n/p,1/0,m,-1,p),a&&l.push(f)}else{for(let e=0;e<u;e++)l.push(o[r+e]);if(p>1)for(let e of c){let r=e*u;if(!(o[r+2]<=t)){o[r+2]=t;for(let e=0;e<u;e++)l.push(o[r+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){let i=this.clusterProps[e[t+6]];return r?Object.assign({},i):i}let i=this.points[e[t+3]].properties,a=this.options.map(i);return r&&a===i?Object.assign({},a):a}}function P(e,t,r){return{type:"Feature",id:e[t+3],properties:R(e,t,r),geometry:{type:"Point",coordinates:[360*(e[t]-.5),360*Math.atan(Math.exp((180-360*e[t+1])*Math.PI/180))/Math.PI-90]}}}function R(e,t,r){let i=e[t+5],a=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,s=e[t+6];return Object.assign(-1===s?{}:Object.assign({},r[s]),{cluster:!0,cluster_id:e[t+3],point_count:i,point_count_abbreviated:a})}function I(e){return e/360+.5}function L(e){let t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function O(e,t,r,i){let a={id:null==e?null:e,type:t,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)M(a,r);else if("Polygon"===t)M(a,r[0]);else if("MultiLineString"===t)for(let e of r)M(a,e);else if("MultiPolygon"===t)for(let e of r)M(a,e[0]);return a}function M(e,t){for(let r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function k(e,t,r,i){if(!t.geometry)return;let a=t.geometry.coordinates;if(a&&0===a.length)return;let s=t.geometry.type,n=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),o=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===s)N(a,o);else if("MultiPoint"===s)for(let e of a)N(e,o);else if("LineString"===s)D(a,o,n,!1);else if("MultiLineString"===s){if(r.lineMetrics){for(let r of a)D(r,o=[],n,!1),e.push(O(l,"LineString",o,t.properties));return}F(a,o,n,!1)}else if("Polygon"===s)F(a,o,n,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(let a of t.geometry.geometries)k(e,{id:l,geometry:a,properties:t.properties},r,i);return}throw Error("Input data is not a valid GeoJSON object.")}for(let e of a){let t=[];F(e,t,n,!0),o.push(t)}}e.push(O(l,s,o,t.properties))}function N(e,t){t.push(e[0]/360+.5,G(e[1]),0)}function D(e,t,r,i){let a,s,n=0;for(let r=0;r<e.length;r++){let o=e[r][0]/360+.5,l=G(e[r][1]);t.push(o,l,0),r>0&&(n+=i?(a*l-o*s)/2:Math.sqrt(Math.pow(o-a,2)+Math.pow(l-s,2))),a=o,s=l}let o=t.length-3;t[2]=1,function e(t,r,i,a){let s=a,n=r+(i-r>>1),o,l=i-r,u=t[r],h=t[r+1],c=t[i],d=t[i+1];for(let e=r+3;e<i;e+=3){let r=function(e,t,r,i,a,s){let n=a-r,o=s-i;if(0!==n||0!==o){let l=((e-r)*n+(t-i)*o)/(n*n+o*o);l>1?(r=a,i=s):l>0&&(r+=n*l,i+=o*l)}return(n=e-r)*n+(o=t-i)*o}(t[e],t[e+1],u,h,c,d);if(r>s)o=e,s=r;else if(r===s){let t=Math.abs(e-n);t<l&&(o=e,l=t)}}s>a&&(o-r>3&&e(t,r,o,a),t[o+2]=s,i-o>3&&e(t,o,i,a))}(t,0,o,r),t[o+2]=1,t.size=Math.abs(n),t.start=0,t.end=t.size}function F(e,t,r,i){for(let a=0;a<e.length;a++){let s=[];D(e[a],s,r,i),t.push(s)}}function G(e){let t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function z(e,t,r,i,a,s,n,o){if(i/=t,s>=(r/=t)&&n<i)return e;if(n<r||s>=i)return null;let l=[];for(let t of e){let e=t.geometry,s=t.type,n=0===a?t.minX:t.minY,u=0===a?t.maxX:t.maxY;if(n>=r&&u<i){l.push(t);continue}if(u<r||n>=i)continue;let h=[];if("Point"===s||"MultiPoint"===s)(function(e,t,r,i,a){for(let s=0;s<e.length;s+=3){let n=e[s+a];n>=r&&n<=i&&U(t,e[s],e[s+1],e[s+2])}})(e,h,r,i,a);else if("LineString"===s)q(e,h,r,i,a,!1,o.lineMetrics);else if("MultiLineString"===s)B(e,h,r,i,a,!1);else if("Polygon"===s)B(e,h,r,i,a,!0);else if("MultiPolygon"===s)for(let t of e){let e=[];B(t,e,r,i,a,!0),e.length&&h.push(e)}if(h.length){if(o.lineMetrics&&"LineString"===s){for(let e of h)l.push(O(t.id,s,e,t.tags));continue}"LineString"!==s&&"MultiLineString"!==s||(1===h.length?(s="LineString",h=h[0]):s="MultiLineString"),"Point"!==s&&"MultiPoint"!==s||(s=3===h.length?"Point":"MultiPoint"),l.push(O(t.id,s,h,t.tags))}}return l.length?l:null}function q(e,t,r,i,a,s,n){let o=j(e),l=0===a?H:Z,u,h,c=e.start;for(let d=0;d<e.length-3;d+=3){let p=e[d],f=e[d+1],m=e[d+2],g=e[d+3],y=e[d+4],v=0===a?p:f,_=0===a?g:y,x=!1;n&&(u=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),v<r?_>r&&(h=l(o,p,f,g,y,r),n&&(o.start=c+u*h)):v>i?_<i&&(h=l(o,p,f,g,y,i),n&&(o.start=c+u*h)):U(o,p,f,m),_<r&&v>=r&&(h=l(o,p,f,g,y,r),x=!0),_>i&&v<=i&&(h=l(o,p,f,g,y,i),x=!0),!s&&x&&(n&&(o.end=c+u*h),t.push(o),o=j(e)),n&&(c+=u)}let d=e.length-3,p=e[d],f=e[d+1],m=0===a?p:f;m>=r&&m<=i&&U(o,p,f,e[d+2]),d=o.length-3,s&&d>=3&&(o[d]!==o[0]||o[d+1]!==o[1])&&U(o,o[0],o[1],o[2]),o.length&&t.push(o)}function j(e){let t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function B(e,t,r,i,a,s){for(let n of e)q(n,t,r,i,a,s,!1)}function U(e,t,r,i){e.push(t,r,i)}function H(e,t,r,i,a,s){let n=(s-t)/(i-t);return U(e,s,r+(a-r)*n,1),n}function Z(e,t,r,i,a,s){let n=(s-r)/(a-r);return U(e,t+(i-t)*n,s,1),n}function V(e,t){let r=[];for(let i=0;i<e.length;i++){let a;let s=e[i],n=s.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)a=Y(s.geometry,t);else if("MultiLineString"===n||"Polygon"===n)for(let e of(a=[],s.geometry))a.push(Y(e,t));else if("MultiPolygon"===n)for(let e of(a=[],s.geometry)){let r=[];for(let i of e)r.push(Y(i,t));a.push(r)}r.push(O(s.id,n,a,s.tags))}return r}function Y(e,t){let r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(let i=0;i<e.length;i+=3)r.push(e[i]+t,e[i+1],e[i+2]);return r}function W(e,t){if(e.transformed)return e;let r=1<<e.z,i=e.x,a=e.y;for(let s of e.features){let e=s.geometry,n=s.type;if(s.geometry=[],1===n)for(let n=0;n<e.length;n+=2)s.geometry.push($(e[n],e[n+1],t,r,i,a));else for(let n=0;n<e.length;n++){let o=[];for(let s=0;s<e[n].length;s+=2)o.push($(e[n][s],e[n][s+1],t,r,i,a));s.geometry.push(o)}}return e.transformed=!0,e}function $(e,t,r,i,a,s){return[Math.round(r*(e*i-a)),Math.round(r*(t*i-s))]}function X(e,t,r,i,a,s){let n=i*i;if(i>0&&t.size<(a?n:i))return void(r.numPoints+=t.length/3);let o=[];for(let e=0;e<t.length;e+=3)(0===i||t[e+2]>n)&&(r.numSimplified++,o.push(t[e],t[e+1])),r.numPoints++;a&&function(e,t){let r=0;for(let t=0,i=e.length,a=i-2;t<i;a=t,t+=2)r+=(e[t]-e[a])*(e[t+1]+e[a+1]);if(r>0===t)for(let t=0,r=e.length;t<r/2;t+=2){let i=e[t],a=e[t+1];e[t]=e[r-2-t],e[t+1]=e[r-1-t],e[r-2-t]=i,e[r-1-t]=a}}(o,s),e.push(o)}let K={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class J{constructor(e,t){let r=(t=this.options=function(e,t){for(let r in t)e[r]=t[r];return e}(Object.create(K),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw Error("promoteId and generateId cannot be used together.");let i=function(e,t){let r=[];if("FeatureCollection"===e.type)for(let i=0;i<e.features.length;i++)k(r,e.features[i],t,i);else k(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(e,t){let r=t.buffer/t.extent,i=e,a=z(e,1,-1-r,r,0,-1,2,t),s=z(e,1,1-r,2+r,0,-1,2,t);return(a||s)&&(i=z(e,1,-r,1+r,0,-1,2,t)||[],a&&(i=V(a,1).concat(i)),s&&(i=i.concat(V(s,-1)))),i}(i,t)).length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,r,i,a,s,n){let o=[e,t,r,i],l=this.options,u=l.debug;for(;o.length;){i=o.pop(),r=o.pop(),t=o.pop(),e=o.pop();let h=1<<t,c=Q(t,r,i),d=this.tiles[c];if(!d&&(u>1&&console.time("creation"),d=this.tiles[c]=function(e,t,r,i,a){let s=t===a.maxZoom?0:a.tolerance/((1<<t)*a.extent),n={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:r,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let t of e)(function(e,t,r,i){let a=t.geometry,s=t.type,n=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===s||"MultiPoint"===s)for(let t=0;t<a.length;t+=3)n.push(a[t],a[t+1]),e.numPoints++,e.numSimplified++;else if("LineString"===s)X(n,a,e,r,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(let t=0;t<a.length;t++)X(n,a[t],e,r,"Polygon"===s,0===t);else if("MultiPolygon"===s)for(let t=0;t<a.length;t++){let i=a[t];for(let t=0;t<i.length;t++)X(n,i[t],e,r,!0,0===t)}if(n.length){let r=t.tags||null;if("LineString"===s&&i.lineMetrics){for(let e in r={},t.tags)r[e]=t.tags[e];r.mapbox_clip_start=a.start/a.size,r.mapbox_clip_end=a.end/a.size}let o={geometry:n,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:r};null!==t.id&&(o.id=t.id),e.features.push(o)}})(n,t,s,a);return n}(e,t,r,i,l),this.tileCoords.push({z:t,x:r,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));let e=`z${t}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}if(d.source=e,null==a){if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===a)continue;if(null!=a){let e=a-t;if(r!==s>>e||i!==n>>e)continue}}if(d.source=null,0===e.length)continue;u>1&&console.time("clipping");let p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p,y=null,v=null,_=null,x=null,b=z(e,h,r-p,r+m,0,d.minX,d.maxX,l),S=z(e,h,r+f,r+g,0,d.minX,d.maxX,l);e=null,b&&(y=z(b,h,i-p,i+m,1,d.minY,d.maxY,l),v=z(b,h,i+f,i+g,1,d.minY,d.maxY,l),b=null),S&&(_=z(S,h,i-p,i+m,1,d.minY,d.maxY,l),x=z(S,h,i+f,i+g,1,d.minY,d.maxY,l),S=null),u>1&&console.timeEnd("clipping"),o.push(y||[],t+1,2*r,2*i),o.push(v||[],t+1,2*r,2*i+1),o.push(_||[],t+1,2*r+1,2*i),o.push(x||[],t+1,2*r+1,2*i+1)}}getTile(e,t,r){e=+e,t=+t,r=+r;let{extent:i,debug:a}=this.options;if(e<0||e>24)return null;let s=1<<e,n=Q(e,t=t+s&s-1,r);if(this.tiles[n])return W(this.tiles[n],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);let o,l=e,u=t,h=r;for(;!o&&l>0;)l--,u>>=1,h>>=1,o=this.tiles[Q(l,u,h)];return o&&o.source?(a>1&&(console.log("found parent tile z%d-%d-%d",l,u,h),console.time("drilling down")),this.splitTile(o.source,l,u,h,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[n]?W(this.tiles[n],i):null):null}}function Q(e,t,r){return 32*((1<<e)*r+t)+e}function ee(e,t){return t?e.properties[t]:e.id}function et(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=ee(e,t);if("FeatureCollection"===e.type){let r=new Set;for(let i of e.features){let e=ee(i,t);if(null==e||r.has(e))return!1;r.add(e)}return!0}return!1}function er(e,t){let r=new Map;if(null==e);else if("Feature"===e.type)r.set(ee(e,t),e);else for(let i of e.features)r.set(ee(i,t),i);return r}class ei extends s{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(t,r){return e._(this,void 0,void 0,function*(){let r=t.tileID.canonical;if(!this._geoJSONIndex)throw Error("Unable to parse the data into a cluster or geojson");let i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return null;let a=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.X,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.X,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){let t=[];for(let r of this._feature.geometry)t.push([new e.P(r[0],r[1])]);return t}{let t=[];for(let r of this._feature.geometry){let i=[];for(let t of r)i.push(new e.P(t[0],t[1]));t.push(i)}return t}}toGeoJSON(e,t,r){return c.call(this,e,t,r)}}(this._features[t])}}(i.features),s=E(a);return 0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}})}loadData(t){return e._(this,void 0,void 0,function*(){var r,i;null===(r=this._pendingRequest)||void 0===r||r.abort();let a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bu(t.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest),this._geoJSONIndex=t.cluster?new C(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;let i={},a={},s={accumulated:null,zoom:0},n={properties:null},o=Object.keys(r);for(let t of o){let[s,n]=r[t],o=e.bB(n),l=e.bB("string"==typeof s?[s,["accumulated"],["get",t]]:s);i[t]=o.value,a[t]=l.value}return t.map=e=>{n.properties=e;let t={};for(let e of o)t[e]=i[e].evaluate(s,n);return t},t.reduce=(e,t)=>{for(let r of(n.properties=t,o))s.accumulated=e[r],e[r]=a[r].evaluate(s,n)},t}(t)).load((yield this._pendingData).features):(i=yield this._pendingData,new J(i,t.geojsonVtOptions)),this.loaded={};let r={};if(a){let e=a.finish();e&&(r.resourceTiming={},r.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}return r}catch(t){if(delete this._pendingRequest,e.bA(t))return{abandoned:!0};throw t}})}getData(){return e._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(e){let t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,r){return e._(this,void 0,void 0,function*(){let i=yield this.loadGeoJSON(t,r);if(delete this._pendingRequest,"object"!=typeof i)throw Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(h(i,!0),t.filter){let r=e.bB(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));i={type:"FeatureCollection",features:i.features.filter(e=>r.value.evaluate({zoom:0},e))}}return i})}loadGeoJSON(t,r){return e._(this,void 0,void 0,function*(){let{promoteId:i}=t;if(t.request){let a=yield e.h(t.request,r);return this._dataUpdateable=et(a.data,i)?er(a.data,i):void 0,a.data}if("string"==typeof t.data)try{let e=JSON.parse(t.data);return this._dataUpdateable=et(e,i)?er(e,i):void 0,e}catch(e){throw Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`)}if(!t.dataDiff)throw Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw Error(`Cannot update existing geojson data in ${t.source}`);return function(e,t,r){var i,a,s,n;if(t.removeAll&&e.clear(),t.remove)for(let r of t.remove)e.delete(r);if(t.add)for(let i of t.add){let t=ee(i,r);null!=t&&e.set(t,i)}if(t.update)for(let r of t.update){let t=e.get(r.id);if(null==t)continue;let o=!r.removeAllProperties&&((null===(i=r.removeProperties)||void 0===i?void 0:i.length)>0||(null===(a=r.addOrUpdateProperties)||void 0===a?void 0:a.length)>0);if((r.newGeometry||r.removeAllProperties||o)&&(t=Object.assign({},t),e.set(r.id,t),o&&(t.properties=Object.assign({},t.properties))),r.newGeometry&&(t.geometry=r.newGeometry),r.removeAllProperties)t.properties={};else if((null===(s=r.removeProperties)||void 0===s?void 0:s.length)>0)for(let e of r.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null===(n=r.addOrUpdateProperties)||void 0===n?void 0:n.length)>0)for(let{key:e,value:i}of r.addOrUpdateProperties)t.properties[e]=i}}(this._dataUpdateable,t.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(t){return e._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}class ea{constructor(t){this.self=t,this.actor=new e.F(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.bh,this.self.removeProtocol=e.bi,this.self.registerRTLTextPlugin=t=>{if(e.bC.isParsed())throw Error("RTL text plugin already registered.");e.bC.setMethods(t)},this.actor.registerMessageHandler("LDT",(e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t)),this.actor.registerMessageHandler("RDT",(t,r)=>e._(this,void 0,void 0,function*(){this._getDEMWorkerSource(t,r.source).removeTile(r)})),this.actor.registerMessageHandler("GCEZ",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterExpansionZoom(r)})),this.actor.registerMessageHandler("GCC",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterChildren(r)})),this.actor.registerMessageHandler("GCL",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterLeaves(r)})),this.actor.registerMessageHandler("LD",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t)),this.actor.registerMessageHandler("GD",(e,t)=>this._getWorkerSource(e,t.type,t.source).getData()),this.actor.registerMessageHandler("LT",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t)),this.actor.registerMessageHandler("RT",(e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t)),this.actor.registerMessageHandler("AT",(e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t)),this.actor.registerMessageHandler("RMT",(e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t)),this.actor.registerMessageHandler("RS",(t,r)=>e._(this,void 0,void 0,function*(){if(!this.workerSources[t]||!this.workerSources[t][r.type]||!this.workerSources[t][r.type][r.source])return;let e=this.workerSources[t][r.type][r.source];delete this.workerSources[t][r.type][r.source],void 0!==e.removeSource&&e.removeSource(r)})),this.actor.registerMessageHandler("RM",t=>e._(this,void 0,void 0,function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t]})),this.actor.registerMessageHandler("SR",(t,r)=>e._(this,void 0,void 0,function*(){this.referrer=r})),this.actor.registerMessageHandler("SRPS",(e,t)=>this._syncRTLPluginState(e,t)),this.actor.registerMessageHandler("IS",(t,r)=>e._(this,void 0,void 0,function*(){this.self.importScripts(r)})),this.actor.registerMessageHandler("SI",(e,t)=>this._setImages(e,t)),this.actor.registerMessageHandler("UL",(t,r)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).update(r.layers,r.removedIds)})),this.actor.registerMessageHandler("SL",(t,r)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).replace(r)}))}_setImages(t,r){return e._(this,void 0,void 0,function*(){for(let e in this.availableImages[t]=r,this.workerSources[t]){let i=this.workerSources[t][e];for(let e in i)i[e].availableImages=r}})}_syncRTLPluginState(t,r){return e._(this,void 0,void 0,function*(){if(e.bC.isParsed())return e.bC.getState();if("loading"!==r.pluginStatus)return e.bC.setState(r),r;let t=r.pluginURL;if(this.self.importScripts(t),e.bC.isParsed()){let r={pluginStatus:"loaded",pluginURL:t};return e.bC.setState(r),r}throw e.bC.setState({pluginStatus:"error",pluginURL:""}),Error(`RTL Text Plugin failed to import scripts from ${t}`)})}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new t),r}_getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){let i={sendAsync:(t,r)=>(t.targetMapId=e,this.actor.sendAsync(t,r))};switch(t){case"vector":this.workerSources[e][t][r]=new s(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][r]=new ei(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][r]=new this.externalWorkerSourceTypes[t](i,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][r]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new n),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new ea(self)),ea}),r("index",["exports","./shared"],function(e,t){let r,i,a,s,n,o,l;var u,h="4.5.0";let c={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:e=>new Promise((r,i)=>{let a=requestAnimationFrame(r);e.signal.addEventListener("abort",()=>{cancelAnimationFrame(a),i(t.c())})}),getImageData(e,t=0){return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){let t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height),r},resolveURL:e=>(r||(r=document.createElement("a")),r.href=e,r.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==i&&(i=matchMedia("(prefers-reduced-motion: reduce)")),i.matches)}};class d{static testProp(e){if(!d.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in d.docStyle)return e[t];return e[0]}static create(e,t,r){let i=window.document.createElement(e);return void 0!==t&&(i.className=t),r&&r.appendChild(i),i}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){d.docStyle&&d.selectProp&&(d.userSelect=d.docStyle[d.selectProp],d.docStyle[d.selectProp]="none")}static enableDrag(){d.docStyle&&d.selectProp&&(d.docStyle[d.selectProp]=d.userSelect)}static setTransform(e,t){e.style[d.transformProp]=t}static addEventListener(e,t,r,i={}){e.addEventListener(t,r,"passive"in i?i:i.capture)}static removeEventListener(e,t,r,i={}){e.removeEventListener(t,r,"passive"in i?i:i.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",d.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",d.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",d.suppressClickInternal,!0)},0)}static getScale(e){let t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,r,i){let a=r.boundingClientRect;return new t.P((i.clientX-a.left)/r.x-e.clientLeft,(i.clientY-a.top)/r.y-e.clientTop)}static mousePos(e,t){let r=d.getScale(e);return d.getPoint(e,r,t)}static touchPos(e,t){let r=[],i=d.getScale(e);for(let a=0;a<t.length;a++)r.push(d.getPoint(e,i,t[a]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}d.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,d.selectProp=d.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),d.transformProp=d.testProp(["transform","WebkitTransform"]);let p={supported:!1,testSupport:function(e){!g&&m&&(y?v(e):f=e)}},f,m,g=!1,y=!1;function v(e){let t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,m),e.isContextLost())return;p.supported=!0}catch(e){}e.deleteTexture(t),g=!0}"undefined"!=typeof document&&((m=document.createElement("img")).onload=()=>{f&&v(f),f=null,y=!0},m.onerror=()=>{g=!0,f=null},m.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let r,i,a,s;e.resetRequestQueue=()=>{r=[],i=0,a=0,s={}},e.addThrottleControl=e=>{let t=a++;return s[t]=e,t},e.removeThrottleControl=e=>{delete s[e],o()},e.getImage=(e,i,a=!0)=>new Promise((s,n)=>{p.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),r.push({abortController:i,requestParameters:e,supportImageRefresh:a,state:"queued",onError:e=>{n(e)},onSuccess:e=>{s(e)}}),o()});let n=e=>t._(this,void 0,void 0,function*(){var r;e.state="running";let{requestParameters:a,supportImageRefresh:s,onError:n,onSuccess:u,abortController:h}=e,c=!1===s&&!t.i(self)&&!t.g(a.url)&&(!a.headers||Object.keys(a.headers).reduce((e,t)=>e&&"accept"===t,!0));i++;let d=c?l(a,h):t.m(a,h);try{let i=yield d;delete e.abortController,e.state="completed",i.data instanceof HTMLImageElement||t.b(i.data)?u(i):i.data&&u({data:yield(r=i.data,"function"==typeof createImageBitmap?t.d(r):t.f(r)),cacheControl:i.cacheControl,expires:i.expires})}catch(t){delete e.abortController,n(t)}finally{i--,o()}}),o=()=>{let e=(()=>{for(let e of Object.keys(s))if(s[e]())return!0;return!1})()?t.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=i;t<e&&r.length>0;t++){let e=r.shift();e.abortController.signal.aborted?t--:n(e)}},l=(e,r)=>new Promise((i,a)=>{let s=new Image,n=e.url,o=e.credentials;o&&"include"===o?s.crossOrigin="use-credentials":(o&&"same-origin"===o||!t.s(n))&&(s.crossOrigin="anonymous"),r.signal.addEventListener("abort",()=>{s.src="",a(t.c())}),s.fetchPriority="high",s.onload=()=>{s.onerror=s.onload=null,i({data:s})},s.onerror=()=>{s.onerror=s.onload=null,r.signal.aborted||a(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},s.src=n})}(b||(b={})),b.resetRequestQueue();class _{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function x(e){var r=new t.A(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}var b,S,w=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e};S=new t.A(3),t.A!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0);var E=function(e){var t=e[0],r=e[1];return t*t+r*r};function A(e){let t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){let r=[];for(let{id:i,url:a}of e){let e=`${i}${a}`;-1===r.indexOf(e)&&(r.push(e),t.push({id:i,url:a}))}}return t}function T(e,t,r){let i=e.split("?");return i[0]+=`${t}${r}`,i.join("?")}u=new t.A(2),t.A!=Float32Array&&(u[0]=0,u[1]=0);class C{constructor(e,t,r,i){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,i)}update(e,r,i){let{width:a,height:s}=e,n=!(this.size&&this.size[0]===a&&this.size[1]===s||i),{context:o}=this,{gl:l}=o;if(this.useMipmap=!!(r&&r.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||!1!==r.premultiply)),n)this.size=[a,s],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,a,s,0,this.format,l.UNSIGNED_BYTE,e.data);else{let{x:r,y:n}=i||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texSubImage2D(l.TEXTURE_2D,0,r,n,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,r,n,a,s,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,r){let{context:i}=this,{gl:a}=i;a.bindTexture(a.TEXTURE_2D,this.texture),r!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class P extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){let r=this.images[e];if(r&&!r.data&&r.spriteData){let e=r.spriteData;r.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),r.spriteData=null}return r}addImage(e,t){if(this.images[e])throw Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,r){let i=!0,a=r.data||r.spriteData;return this._validateStretch(r.stretchX,a&&a.width)||(this.fire(new t.j(Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(r.stretchY,a&&a.height)||(this.fire(new t.j(Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(r.content,r)||(this.fire(new t.j(Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(e,t){if(!e)return!0;let r=0;for(let i of e){if(i[0]<r||i[1]<i[0]||t<i[1])return!1;r=i[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;let r=t.spriteData,i=r&&r.width||t.data.width,a=r&&r.height||t.data.height;return!(e[0]<0||i<e[0]||e[1]<0||a<e[1]||e[2]<0||i<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){let i=this.getImage(e);if(r&&(i.data.width!==t.data.width||i.data.height!==t.data.height))throw Error(`size mismatch between old image (${i.data.width}x${i.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=i.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){let t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,r)=>{let i=!0;if(!this.isLoaded())for(let t of e)this.images[t]||(i=!1);this.isLoaded()||i?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){let r={};for(let i of e){let e=this.getImage(i);e||(this.fire(new t.k("styleimagemissing",{id:i})),e=this.getImage(i)),e?r[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:!!(e.userImage&&e.userImage.render)}:t.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){let{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){let r=this.patterns[e],i=this.getImage(e);if(!i)return null;if(r&&r.position.version===i.version)return r.position;if(r)r.position.version=i.version;else{let r={w:i.data.width+2,h:i.data.height+2,x:0,y:0},a=new t.I(r,i);this.patterns[e]={bin:r,position:a}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new C(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let t in this.patterns)e.push(this.patterns[t].bin);let{w:r,h:i}=t.p(e),a=this.atlasImage;for(let e in a.resize({width:r||1,height:i||1}),this.patterns){let{bin:r}=this.patterns[e],i=r.x+1,s=r.y+1,n=this.getImage(e).data,o=n.width,l=n.height;t.R.copy(n,a,{x:0,y:0},{x:i,y:s},{width:o,height:l}),t.R.copy(n,a,{x:0,y:l-1},{x:i,y:s-1},{width:o,height:1}),t.R.copy(n,a,{x:0,y:0},{x:i,y:s+l},{width:o,height:1}),t.R.copy(n,a,{x:o-1,y:0},{x:i-1,y:s},{width:1,height:l}),t.R.copy(n,a,{x:0,y:0},{x:i+o,y:s},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;let e=this.getImage(r);e||t.w(`Image with ID: "${r}" was not found`),function(e){let{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}(e)&&this.updateImage(r,e)}}}function R(e,t,r,i,a,s,n,o,l){for(let u=t;u<t+i;u++)I(e,r*s+u,s,a,n,o,l);for(let u=r;u<r+a;u++)I(e,u*s+t,1,i,n,o,l)}function I(e,t,r,i,a,s,n){s[0]=0,n[0]=-1e20,n[1]=1e20,a[0]=e[t];for(let o=1,l=0,u=0;o<i;o++){a[o]=e[t+o*r];let i=o*o;do{let e=s[l];u=(a[o]-a[e]+i-e*e)/(o-e)/2}while(u<=n[l]&&--l>-1)s[++l]=o,n[l]=u,n[l+1]=1e20}for(let o=0,l=0;o<i;o++){for(;n[l+1]<o;)l++;let i=s[l],u=o-i;e[t+o*r]=a[i]+u*u}}class L{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,function*(){let t=[];for(let r in e)for(let i of e[r])t.push(this._getAndCacheGlyphsPromise(r,i));let r=yield Promise.all(t),i={};for(let{stack:e,id:t,glyph:a}of r)i[e]||(i[e]={}),i[e][t]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics};return i})}_getAndCacheGlyphsPromise(e,r){return t._(this,void 0,void 0,function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let i=t.glyphs[r];if(void 0!==i)return{stack:e,id:r,glyph:i};if(i=this._tinySDF(t,e,r))return t.glyphs[r]=i,{stack:e,id:r,glyph:i};let a=Math.floor(r/256);if(256*a>65535)throw Error("glyphs > 65535 not supported");if(t.ranges[a])return{stack:e,id:r,glyph:i};if(!this.url)throw Error("glyphsUrl is not set");if(!t.requests[a]){let r=L.loadGlyphRange(e,a,this.url,this.requestManager);t.requests[a]=r}let s=yield t.requests[a];for(let e in s)this._doesCharSupportLocalGlyph(+e)||(t.glyphs[+e]=s[+e]);return t.ranges[a]=!0,{stack:e,id:r,glyph:s[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(t.u["CJK Unified Ideographs"](e)||t.u["Hangul Syllables"](e)||t.u.Hiragana(e)||t.u.Katakana(e))}_tinySDF(e,r,i){let a=this.localIdeographFontFamily;if(!a||!this._doesCharSupportLocalGlyph(i))return;let s=e.tinySDF;if(!s){let t="400";/bold/i.test(r)?t="900":/medium/i.test(r)?t="500":/light/i.test(r)&&(t="200"),s=e.tinySDF=new L.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:a,fontWeight:t})}let n=s.draw(String.fromCharCode(i));return{id:i,bitmap:new t.o({width:n.width||60,height:n.height||60},n.data),metrics:{width:n.glyphWidth/2||24,height:n.glyphHeight/2||24,left:n.glyphLeft/2+.5||0,top:n.glyphTop/2-27.5||-8,advance:n.glyphAdvance/2||24,isDoubleResolution:!0}}}}L.loadGlyphRange=function(e,r,i,a){return t._(this,void 0,void 0,function*(){let s=256*r,n=s+255,o=a.transformRequest(i.replace("{fontstack}",e).replace("{range}",`${s}-${n}`),"Glyphs"),l=yield t.l(o,new AbortController);if(!l||!l.data)throw Error(`Could not load glyph range. range: ${r}, ${s}-${n}`);let u={};for(let e of t.n(l.data))u[e.id]=e;return u})},L.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:i=.25,fontFamily:a="sans-serif",fontWeight:s="normal",fontStyle:n="normal"}={}){this.buffer=t,this.cutoff=i,this.radius=r;let o=this.size=e+4*t,l=this._createCanvas(o),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${n} ${s} ${e}px ${a}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Uint16Array(o)}_createCanvas(e){let t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){let{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:a,actualBoundingBoxRight:s}=this.ctx.measureText(e),n=Math.ceil(r),o=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-a))),l=Math.min(this.size-this.buffer,n+Math.ceil(i)),u=o+2*this.buffer,h=l+2*this.buffer,c=Math.max(u*h,0),d=new Uint8ClampedArray(c),p={data:d,width:u,height:h,glyphWidth:o,glyphHeight:l,glyphTop:n,glyphLeft:0,glyphAdvance:t};if(0===o||0===l)return p;let{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,o,l),f.fillText(e,m,m+n);let v=f.getImageData(m,m,o,l);y.fill(1e20,0,c),g.fill(0,0,c);for(let e=0;e<l;e++)for(let t=0;t<o;t++){let r=v.data[4*(e*o+t)+3]/255;if(0===r)continue;let i=(e+m)*u+t+m;if(1===r)y[i]=0,g[i]=1e20;else{let e=.5-r;y[i]=e>0?e*e:0,g[i]=e<0?e*e:0}}R(y,0,0,u,h,u,this.f,this.v,this.z),R(g,m,m,o,l,u,this.f,this.v,this.z);for(let e=0;e<c;e++){let t=Math.sqrt(y[e])-Math.sqrt(g[e]);d[e]=Math.round(255-255*(t/this.radius+this.cutoff))}return p}};class O{constructor(){this.specification=t.v.light.position}possiblyEvaluate(e,r){return t.y(e.expression.evaluate(r))}interpolate(e,r,i){return{x:t.z.number(e.x,r.x,i),y:t.z.number(e.y,r.y,i),z:t.z.number(e.z,r.z,i)}}}class M extends t.E{constructor(e){super(),a=a||new t.q({anchor:new t.D(t.v.light.anchor),position:new O,color:new t.D(t.v.light.color),intensity:new t.D(t.v.light.intensity)}),this._transitionable=new t.T(a),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(t.r,e,r))for(let t in e){let r=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),r):this._transitionable.setValue(t,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i){return(!i||!1!==i.validate)&&t.t(this,e.call(t.x,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.v}))}}let k=new t.q({"sky-color":new t.D(t.v.sky["sky-color"]),"horizon-color":new t.D(t.v.sky["horizon-color"]),"fog-color":new t.D(t.v.sky["fog-color"]),"fog-ground-blend":new t.D(t.v.sky["fog-ground-blend"]),"horizon-fog-blend":new t.D(t.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new t.D(t.v.sky["sky-horizon-blend"]),"atmosphere-blend":new t.D(t.v.sky["atmosphere-blend"])});class N extends t.E{constructor(e){super(),this._transitionable=new t.T(k),this.setSky(e),this._transitioning=this._transitionable.untransitioned()}setSky(e,r={}){if(!this._validate(t.B,e,r))for(let t in e){let r=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),r):this._transitionable.setValue(t,r)}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i={}){return!1!==(null==i?void 0:i.validate)&&t.t(this,e.call(t.x,t.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class D{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){let r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){let i=[],a=e.length%2==1?-e[e.length-1]*r:0,s=e[0]*r,n=!0;i.push({left:a,right:s,isDash:n,zeroLength:0===e[0]});let o=e[0];for(let t=1;t<e.length;t++){n=!n;let l=e[t];a=o*r,o+=l,s=o*r,i.push({left:a,right:s,isDash:n,zeroLength:0===l})}return i}addRoundDash(e,t,r){let i=t/2;for(let t=-r;t<=r;t++){let a=this.width*(this.nextRow+r+t),s=0,n=e[0];for(let o=0;o<this.width;o++){let l;o/n.right>1&&(n=e[++s]);let u=Math.min(Math.abs(o-n.left),Math.abs(o-n.right)),h=t/r*(i+1);if(n.isDash){let e=i-Math.abs(h);l=Math.sqrt(u*u+e*e)}else l=i-Math.sqrt(u*u+h*h);this.data[a+o]=Math.max(0,Math.min(255,l+128))}}}addRegularDash(e){for(let t=e.length-1;t>=0;--t){let r=e[t],i=e[t+1];r.zeroLength?e.splice(t,1):i&&i.isDash===r.isDash&&(i.left=r.left,e.splice(t,1))}let t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);let i=this.width*this.nextRow,a=0,s=e[0];for(let t=0;t<this.width;t++){t/s.right>1&&(s=e[++a]);let r=Math.min(Math.abs(t-s.left),Math.abs(t-s.right));this.data[i+t]=Math.max(0,Math.min(255,(s.isDash?r:-r)+128))}}addDash(e,r){let i=r?7:0,a=2*i+1;if(this.nextRow+a>this.height)return t.w("LineAtlas out of space"),null;let s=0;for(let t=0;t<e.length;t++)s+=e[t];if(0!==s){let t=this.width/s,a=this.getDashRanges(e,this.width,t);r?this.addRoundDash(a,t,i):this.addRegularDash(a)}let n={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:s};return this.nextRow+=a,this.dirty=!0,n}bind(e){let t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}let F="maplibre_preloaded_worker_pool";class G{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<G.workerCount;)this.workers.push(new Worker(t.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(e=>{e.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[F]}numActive(){return Object.keys(this.active).length}}let z=Math.floor(c.hardwareConcurrency/2);function q(){return s||(s=new G),s}G.workerCount=t.C(globalThis)?Math.max(Math.min(z,3),1):1;class j{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;let i=this.workerPool.acquire(r);for(let e=0;e<i.length;e++){let a=new t.F(i[e],r);a.name=`Worker ${e}`,this.actors.push(a)}if(!this.actors.length)throw Error("No actors found")}broadcast(e,t){let r=[];for(let i of this.actors)r.push(i.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(e=>{e.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(let r of this.actors)r.registerMessageHandler(e,t)}}function B(){return n||(n=new j(q(),t.G)).registerMessageHandler("GR",(e,r,i)=>t.m(r,i)),n}function U(e,t){let r=e.tileID,i=t.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}function H(e,r,i){return t._(this,void 0,void 0,function*(){let a=e;if(e.url?a=(yield t.h(r.transformRequest(e.url,"Source"),i)).data:yield c.frameAsync(i),!a)return null;let s=t.M(t.e(a,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in a&&a.vector_layers&&(s.vectorLayerIds=a.vector_layers.map(e=>e.id)),s})}class Z{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.N?new t.N(e.lng,e.lat):t.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.N?new t.N(e.lng,e.lat):t.N.convert(e),this}extend(e){let r,i;let a=this._sw,s=this._ne;if(e instanceof t.N)r=e,i=e;else{if(!(e instanceof Z))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Z.convert(e)):this.extend(t.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.N.convert(e)):this;if(r=e._sw,i=e._ne,!r||!i)return this}return a||s?(a.lng=Math.min(r.lng,a.lng),a.lat=Math.min(r.lat,a.lat),s.lng=Math.max(i.lng,s.lng),s.lat=Math.max(i.lat,s.lat)):(this._sw=new t.N(r.lng,r.lat),this._ne=new t.N(i.lng,i.lat)),this}getCenter(){return new t.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.N(this.getWest(),this.getNorth())}getSouthEast(){return new t.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:r,lat:i}=t.N.convert(e),a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&a}static convert(e){return e instanceof Z?e:e?new Z(e):e}static fromLngLat(e,r=0){let i=360*r/40075017,a=i/Math.cos(Math.PI/180*e.lat);return new Z(new t.N(e.lng-a,e.lat-i),new t.N(e.lng+a,e.lat+i))}}class V{constructor(e,t,r){this.bounds=Z.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){let r=Math.pow(2,e.z),i=Math.floor(t.O(this.bounds.getWest())*r),a=Math.floor(t.Q(this.bounds.getNorth())*r),s=Math.ceil(t.O(this.bounds.getEast())*r),n=Math.ceil(t.Q(this.bounds.getSouth())*r);return e.x>=i&&e.x<s&&e.y>=a&&e.y<n}}class Y extends t.E{constructor(e,r,i,a){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.M(r,["url","scheme","tileSize","promoteId"])),this._options=t.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a)}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield H(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new V(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,function*(){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let i="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise((t,r)=>{e.reloadPromise={resolve:t,reject:r}})}else e.actor=this.dispatcher.getActor(),i="LT";e.abortController=new AbortController;try{let t=yield e.actor.sendAsync({type:i,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(t){if(delete e.abortController,e.aborted)return;if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){let t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class W extends t.E{constructor(e,r,i,a){super(),this.id=e,this.dispatcher=i,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},r),t.e(this,t.M(r,["url","scheme","tileSize"]))}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield H(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(t.e(this,e),e.bounds&&(this.tileBounds=new V(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,function*(){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let r=yield b.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let t=this.map.painter.context,i=t.gl,a=r.data;e.texture=this.map.painter.getTileTexture(a.width),e.texture?e.texture.update(a,{useMipmap:!0}):(e.texture=new C(t,a,i.RGBA,{useMipmap:!0}),e.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),t.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class $ extends W{constructor(e,r,i,a){super(e,r,i,a),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return t._(this,void 0,void 0,function*(){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let r=yield b.getImage(i,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){let i=r.data;this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let a=t.b(i)&&t.U()?i:yield this.readImageNow(i),s={type:this.type,uid:e.uid,source:this.id,rawImageData:a,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();let t=yield e.actor.sendAsync({type:"LDT",data:s});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}readImageNow(e){return t._(this,void 0,void 0,function*(){if("undefined"!=typeof VideoFrame&&t.V()){let r=e.width+2,i=e.height+2;try{return new t.R({width:r,height:i},(yield t.W(e,-1,-1,r,i)))}catch(e){}}return c.getImageData(e,1)})}_getNeighboringTiles(e){let r=e.canonical,i=Math.pow(2,r.z),a=(r.x-1+i)%i,s=0===r.x?e.wrap-1:e.wrap,n=(r.x+1+i)%i,o=r.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.S(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},l[new t.S(e.overscaledZ,o,r.z,n,r.y).key]={backfilled:!1},r.y>0&&(l[new t.S(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1},l[new t.S(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.S(e.overscaledZ,o,r.z,n,r.y-1).key]={backfilled:!1}),r.y+1<i&&(l[new t.S(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1},l[new t.S(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.S(e.overscaledZ,o,r.z,n,r.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class X extends t.E{constructor(e,r,i,a){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(a),this._data=r.data,this._options=t.e({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;let s=t.X/this.tileSize;this.workerOptions=t.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*s,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*s,extent:t.X,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.X,radius:(r.clusterRadius||50)*s,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return t._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return t._(this,void 0,void 0,function*(){let e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}_updateWorkerData(e){return t._(this,void 0,void 0,function*(){let r=t.e({type:this.type},this.workerOptions);e?r.dataDiff=e:"string"==typeof this._data?(r.request=this.map._requestManager.transformRequest(c.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.k("dataloading",{dataType:"source"}));try{let e=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||e.abandoned)return void this.fire(new t.k("dataabort",{dataType:"source"}));let i=null;e.resourceTiming&&e.resourceTiming[this.id]&&(i=e.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&t.e(a,{resourceTiming:i}),this.fire(new t.k("data",Object.assign(Object.assign({},a),{sourceDataType:"metadata"}))),this.fire(new t.k("data",Object.assign(Object.assign({},a),{sourceDataType:"content"})))}catch(e){if(this._pendingLoads--,this._removed)return void this.fire(new t.k("dataabort",{dataType:"source"}));this.fire(new t.j(e))}})}loaded(){return 0===this._pendingLoads}loadTile(e){return t._(this,void 0,void 0,function*(){let t=e.actor?"RT":"LT";e.actor=this.actor;let r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let i=yield this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(i,this.map.painter,"RT"===t)})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var K=t.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class J extends t.E{constructor(e,t,r,i){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=t}load(e){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let t=yield b.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new t.j(e))}})}loaded(){return this._loaded}updateImage(e){return e.url&&(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null})),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let r=e.map(t.Z.fromLngLat);this.tileID=function(e){let r=1/0,i=1/0,a=-1/0,s=-1/0;for(let t of e)r=Math.min(r,t.x),i=Math.min(i,t.y),a=Math.max(a,t.x),s=Math.max(s,t.y);let n=Math.max(0,Math.floor(-Math.log(Math.max(a-r,s-i))/Math.LN2)),o=Math.pow(2,n);return new t.a1(n,Math.floor((r+a)/2*o),Math.floor((i+s)/2*o))}(r),this.minzoom=this.maxzoom=this.tileID.z;let i=r.map(e=>this.tileID.getTilePoint(e)._round());return this._boundsArray=new t.$,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.X,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.X),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.X,t.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new C(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let e in this.tiles){let t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Q extends J{constructor(e,t,r,i){super(e,t,r,i),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1;let e=this.options;for(let t of(this.urls=[],e.urls))this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{let e=yield t.a3(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(e){this.fire(new t.j(e))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.j(new t.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new C(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let e in this.tiles){let t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ee extends J{constructor(e,r,i,a){super(e,r,i,a),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some(e=>!Array.isArray(e)||2!==e.length||e.some(e=>"number"!=typeof e))||this.fire(new t.j(new t.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.j(new t.a2(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.j(new t.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.j(new t.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.j(new t.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){return t._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.j(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;let r=this.map.painter.context,i=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new C(r,this.canvas,i.RGBA,{premultiply:!0});let a=!1;for(let e in this.tiles){let t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,a=!0)}a&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}let et={},er=e=>{switch(e){case"geojson":return X;case"image":return J;case"raster":return W;case"raster-dem":return $;case"vector":return Y;case"video":return Q;case"canvas":return ee}return et[e]},ei="RTLPluginLoaded";class ea extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=B()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(e=>{throw this.status="error",e})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,function*(e,t=!1){if(this.url)throw Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=c.resolveURL(e),!this.url)throw Error(`requested url ${e} is invalid`);if("unavailable"===this.status){if(!t)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()})}_requestImport(){return t._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.k(ei))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let es=null;function en(){return es||(es=new ea),es}class eo{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.a4(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(let a in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){let r={};if(!t)return r;for(let i of e){let e=i.layerIds.map(e=>t.getLayer(e)).filter(Boolean);if(0!==e.length)for(let t of(i.layers=e,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(t=>e.filter(e=>e.id===t)[0])),e))r[t.id]=i}return r}(e.buckets,r.style),this.hasSymbolBuckets=!1,this.buckets){let e=this.buckets[a];if(e instanceof t.a6){if(this.hasSymbolBuckets=!0,!i)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let e in this.buckets){let r=this.buckets[e];if(r instanceof t.a6&&r.hasRTLText){this.hasRTLText=!0,en().lazyLoad();break}}for(let e in this.queryPadding=0,this.buckets){let t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.a5}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let t in this.buckets){let r=this.buckets[t];r.uploadPending()&&r.upload(e)}let t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new C(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new C(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,i,a,s,n,o,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:a,scale:s,tileSize:this.tileSize,pixelPosMatrix:u,transform:o,params:n,queryPadding:this.queryPadding*l},e,t,r):{}}querySourceFeatures(e,r){let i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;let a=i.loadVTLayers(),s=r&&r.sourceLayer?r.sourceLayer:"",n=a._geojsonTileLayer||a[s];if(!n)return;let o=t.a7(r&&r.filter),{z:l,x:u,y:h}=this.tileID.canonical,c={z:l,x:u,y:h};for(let r=0;r<n.length;r++){let a=n.feature(r);if(o.needGeometry){let e=t.a8(a,!0);if(!o.filter(new t.a9(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!o.filter(new t.a9(this.tileID.overscaledZ),a))continue;let d=i.getId(a,s),p=new t.aa(a,l,u,h,d);p.tile=c,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let r=this.expirationTime;if(e.cacheControl){let r=t.ab(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let e=Date.now(),t=!1;if(this.expirationTime>e)t=!1;else if(r){if(this.expirationTime<r)t=!0;else{let i=this.expirationTime-r;i?this.expirationTime=e+Math.max(i,3e4):t=!0}}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),2147483647)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;let r=this.latestFeatureIndex.loadVTLayers();for(let i in this.buckets){if(!t.style.hasLayer(i))continue;let a=this.buckets[i],s=a.layers[0].sourceLayer||"_geojsonTileLayer",n=r[s],o=e[s];if(!n||!o||0===Object.keys(o).length)continue;a.update(o,n,this.imageAtlas&&this.imageAtlas.patternPositions||{});let l=t&&t.style&&t.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(a)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=c.now()+e}setDependencies(e,t){let r={};for(let e of t)r[e]=!0;this.dependencies[e]=r}hasDependency(e,t){for(let r of e){let e=this.dependencies[r];if(e){for(let r of t)if(e[r])return!0}}return!1}}class el{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(let e in this.data)for(let t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){let i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);let a={value:t,timeout:void 0};if(void 0!==r&&(a.timeout=setTimeout(()=>{this.remove(e,a)},r)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){let e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){let t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;let r=e.wrapped().key,i=void 0===t?0:this.data[r].indexOf(t),a=this.data[r][i];return this.data[r].splice(i,1),a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){let t=[];for(let r in this.data)for(let i of this.data[r])e(i.value)||t.push(i);for(let e of t)this.remove(e.value.tileID,e)}}class eu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,i){let a=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][a]=this.stateChanges[e][a]||{},t.e(this.stateChanges[e][a],i),null===this.deletedStates[e])for(let t in this.deletedStates[e]={},this.state[e])t!==a&&(this.deletedStates[e][t]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][a])for(let t in this.deletedStates[e][a]={},this.state[e][a])i[t]||(this.deletedStates[e][a][t]=null);else for(let t in i)this.deletedStates[e]&&this.deletedStates[e][a]&&null===this.deletedStates[e][a][t]&&delete this.deletedStates[e][a][t]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;let i=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][i]&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][r]=null);else if(void 0!==t){if(this.stateChanges[e]&&this.stateChanges[e][i])for(r in this.deletedStates[e][i]={},this.stateChanges[e][i])this.deletedStates[e][i][r]=null;else this.deletedStates[e][i]=null}else this.deletedStates[e]=null}getState(e,r){let i=String(r),a=t.e({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){let t=this.deletedStates[e][r];if(null===t)return{};for(let e in t)delete a[e]}return a}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,r){let i={};for(let e in this.stateChanges){this.state[e]=this.state[e]||{};let r={};for(let i in this.stateChanges[e])this.state[e][i]||(this.state[e][i]={}),t.e(this.state[e][i],this.stateChanges[e][i]),r[i]=this.state[e][i];i[e]=r}for(let e in this.deletedStates){this.state[e]=this.state[e]||{};let r={};if(null===this.deletedStates[e])for(let t in this.state[e])r[t]={},this.state[e][t]={};else for(let t in this.deletedStates[e]){if(null===this.deletedStates[e][t])this.state[e][t]={};else for(let r of Object.keys(this.deletedStates[e][t]))delete this.state[e][t][r];r[t]=this.state[e][t]}i[e]=i[e]||{},t.e(i[e],r)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(let t in e)e[t].setFeatureState(i,r)}}class eh extends t.E{constructor(e,t,r){super(),this.id=e,this.dispatcher=r,this.on("data",e=>this._dataHandler(e)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((e,t,r,i)=>{let a=new(er(t.type))(e,t,r,i);if(a.id!==e)throw Error(`Expected Source id to be ${e} instead of ${a.id}`);return a})(e,t,r,this),this._tiles={},this._cache=new el(0,e=>this._unloadTile(e)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new eu,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let e in this._tiles){let t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,i){return t._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,i)}catch(r){e.state="errored",404!==r.status?this._source.fire(new t.j(r,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){for(let t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){let r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(ec).map(e=>e.key)}getRenderableIds(e){let r=[];for(let t in this._tiles)this._isIdRenderable(t,e)&&r.push(this._tiles[t]);return e?r.sort((e,r)=>{let i=e.tileID,a=r.tileID,s=new t.P(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),n=new t.P(a.canonical.x,a.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-a.overscaledZ||n.y-s.y||n.x-s.x}).map(e=>e.tileID.key):r.map(e=>e.tileID).sort(ec).map(e=>e.key)}hasRenderableParent(e){let t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else for(let e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}_reloadTile(e,r){return t._(this,void 0,void 0,function*(){let t=this._tiles[e];t&&("loading"!==t.state&&(t.state=r),yield this._loadTile(t,e,r))})}_tileLoaded(e,r,i){e.timeAdded=c.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let t=this.getRenderableIds();for(let i=0;i<t.length;i++){let a=t[i];if(e.neighboringTiles&&e.neighboringTiles[a]){let t=this.getTileByID(a);r(e,t),r(t,e)}}function r(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x,i=t.tileID.canonical.y-e.tileID.canonical.y,a=Math.pow(2,e.tileID.canonical.z),s=t.tileID.key;0===r&&0===i||Math.abs(i)>1||(Math.abs(r)>1&&(1===Math.abs(r+a)?r+=a:1===Math.abs(r-a)&&(r-=a)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,i),e.neighboringTiles&&e.neighboringTiles[s]&&(e.neighboringTiles[s].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,i){for(let a in this._tiles){let s=this._tiles[a];if(i[a]||!s.hasData()||s.tileID.overscaledZ<=t||s.tileID.overscaledZ>r)continue;let n=s.tileID;for(;s&&s.tileID.overscaledZ>t+1;){let e=s.tileID.scaledTo(s.tileID.overscaledZ-1);(s=this._tiles[e.key])&&s.hasData()&&(n=e)}let o=n;for(;o.overscaledZ>t;)if(e[(o=o.scaledTo(o.overscaledZ-1)).key]){i[n.key]=n;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){let r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){let t=e.scaledTo(r),i=this._getLoadedTile(t);if(i)return i}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){let t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let r=Math.floor((Math.ceil(e.width/this._source.tileSize)+1)*(Math.ceil(e.height/this._source.tileSize)+1)*(null===this._maxTileCacheZoomLevels?t.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)}handleWrapJump(e){let t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){let e={};for(let r in this._tiles){let i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),e[i.tileID.key]=i}for(let t in this._tiles=e,this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(let e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}}_updateCoveredAndRetainedTiles(e,t,r,i,a,s){let n={},o={},l=Object.keys(e),u=c.now();for(let r of l){let i=e[r],a=this._tiles[r];if(!a||0!==a.fadeEndTime&&a.fadeEndTime<=u)continue;let s=this.findLoadedParent(i,t),l=this.findLoadedSibling(i),h=s||l||null;h&&(this._addTile(h.tileID),n[h.tileID.key]=h.tileID),o[r]=i}for(let t in this._retainLoadedChildren(o,i,r,e),n)e[t]||(this._coveredTiles[t]=!0,e[t]=n[t]);if(s){let t={},r={};for(let e of a)this._tiles[e.key].hasData()?t[e.key]=e:r[e.key]=e;for(let i in r){let a=r[i].children(this._source.maxzoom);this._tiles[a[0].key]&&this._tiles[a[1].key]&&this._tiles[a[2].key]&&this._tiles[a[3].key]&&(t[a[0].key]=e[a[0].key]=a[0],t[a[1].key]=e[a[1].key]=a[1],t[a[2].key]=e[a[2].key]=a[2],t[a[3].key]=e[a[3].key]=a[3],delete r[i])}for(let i in r){let a=r[i],s=this.findLoadedParent(a,this._source.minzoom),n=this.findLoadedSibling(a),o=s||n||null;if(o)for(let r in t[o.tileID.key]=e[o.tileID.key]=o.tileID,t)t[r].isChildOf(o.tileID)&&delete t[r]}for(let e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}update(e,r){let i;if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(e=>new t.S(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)):(i=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r}),this._source.hasTile&&(i=i.filter(e=>this._source.hasTile(e)))):i=[];let a=e.coveringZoomLevel(this._source),s=Math.max(a-eh.maxOverzooming,this._source.minzoom),n=Math.max(a+eh.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let e={};for(let t of i)if(t.canonical.z>this._source.minzoom){let r=t.scaledTo(t.canonical.z-1);e[r.key]=r;let i=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[i.key]=i}i=i.concat(Object.values(e))}let o=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,o&&this.fire(new t.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let l=this._updateRetainedTiles(i,a);for(let e in ed(this._source.type)&&this._updateCoveredAndRetainedTiles(l,s,n,a,i,r),l)this._tiles[e].clearFadeHold();for(let e of t.ac(this._tiles,l)){let t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var r;let i={},a={},s=Math.max(t-eh.maxOverzooming,this._source.minzoom),n=Math.max(t+eh.maxUnderzooming,this._source.minzoom),o={};for(let r of e){let e=this._addTile(r);i[r.key]=r,e.hasData()||t<this._source.maxzoom&&(o[r.key]=r)}for(let l of(this._retainLoadedChildren(o,t,n,i),e)){let e=this._tiles[l.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){let e=l.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){i[e.key]=e;continue}}else{let e=l.children(this._source.maxzoom);if(i[e[0].key]&&i[e[1].key]&&i[e[2].key]&&i[e[3].key])continue}let n=e.wasRequested();for(let t=l.overscaledZ-1;t>=s;--t){let s=l.scaledTo(t);if(a[s.key])break;if(a[s.key]=!0,(e=this.getTile(s))||!n||(e=this._addTile(s)),e){let t=e.hasData();if((t||!(null===(r=this.map)||void 0===r?void 0:r.cancelPendingTileRequestsWhileZooming)||n)&&(i[s.key]=s),n=e.wasRequested(),t)break}}}return i}_updateLoadedParentTileCache(){for(let e in this._loadedParentTiles={},this._tiles){let t=[],r,i=this._tiles[e].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){r=this._loadedParentTiles[i.key];break}t.push(i.key);let e=i.scaledTo(i.overscaledZ-1);if(r=this._getLoadedTile(e))break;i=e}for(let e of t)this._loadedParentTiles[e]=r}}_updateLoadedSiblingTileCache(){for(let e in this._loadedSiblingTiles={},this._tiles){let t=this._tiles[e].tileID,r=this._getLoadedTile(t);this._loadedSiblingTiles[t.key]=r}}_addTile(e){let r=this._tiles[e.key];if(r)return r;(r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));let i=r;return r||(r=new eo(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,i||this._source.fire(new t.k("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},r))}_removeTile(e){let t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){let t=e.sourceDataType;"source"===e.dataType&&"metadata"===t&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===t&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){for(let e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,i){let a=[],s=this.transform;if(!s)return a;let n=i?s.getCameraQueryGeometry(e):e,o=e.map(e=>s.pointCoordinate(e,this.terrain)),l=n.map(e=>s.pointCoordinate(e,this.terrain)),u=this.getIds(),h=1/0,c=1/0,d=-1/0,p=-1/0;for(let e of l)h=Math.min(h,e.x),c=Math.min(c,e.y),d=Math.max(d,e.x),p=Math.max(p,e.y);for(let e=0;e<u.length;e++){let i=this._tiles[u[e]];if(i.holdingForFade())continue;let n=i.tileID,f=Math.pow(2,s.zoom-i.tileID.overscaledZ),m=r*i.queryPadding*t.X/i.tileSize/f,g=[n.getTilePoint(new t.Z(h,c)),n.getTilePoint(new t.Z(d,p))];if(g[0].x-m<t.X&&g[0].y-m<t.X&&g[1].x+m>=0&&g[1].y+m>=0){let e=o.map(e=>n.getTilePoint(e)),t=l.map(e=>n.getTilePoint(e));a.push({tile:i,tileID:n,queryGeometry:e,cameraQueryGeometry:t,scale:f})}}return a}getVisibleCoordinates(e){let t=this.getRenderableIds(e).map(e=>this._tiles[e].tileID);for(let e of t)e.posMatrix=this.transform.calculatePosMatrix(e.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(ed(this._source.type)){let e=c.now();for(let t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}removeFeatureState(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,r){let i=this._tiles[e];i&&i.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(let r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(e,t))}}function ec(e,t){let r=Math.abs(2*e.wrap)-+(e.wrap<0),i=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||i-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function ed(e){return"raster"===e||"image"===e||"video"===e}eh.maxOverzooming=10,eh.maxUnderzooming=3;class ep{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let e=1;e<this.points.length;e++)this._distances[e]=this._distances[e-1]+this.points[e].dist(this.points[e-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.ad(e,0,1);let r=1,i=this._distances[r],a=e*this.paddedLength+this.padding;for(;i<a&&r<this._distances.length;)i=this._distances[++r];let s=r-1,n=this._distances[s],o=i-n,l=o>0?(a-n)/o:0;return this.points[s].mult(1-l).add(this.points[r].mult(l))}}function ef(e,t){let r=!0;return"always"===e||"never"!==e&&"never"!==t||(r=!1),r}class em{constructor(e,t,r){let i=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let e=0;e<this.xCellCount*this.yCellCount;e++)i.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,i,a){this._forEachCell(t,r,i,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(a)}insertCircle(e,t,r,i){this._forEachCell(t-i,r-i,t+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(i)}_insertBoxCell(e,t,r,i,a,s){this.boxCells[a].push(s)}_insertCircleCell(e,t,r,i,a,s){this.circleCells[a].push(s)}_query(e,t,r,i,a,s,n){if(r<0||e>this.width||i<0||t>this.height)return[];let o=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=i){if(a)return[{key:null,x1:e,y1:t,x2:r,y2:i}];for(let e=0;e<this.boxKeys.length;e++)o.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){let t=this.circles[3*e],r=this.circles[3*e+1],i=this.circles[3*e+2];o.push({key:this.circleKeys[e],x1:t-i,y1:r-i,x2:t+i,y2:r+i})}}else this._forEachCell(e,t,r,i,this._queryCell,o,{hitTest:a,overlapMode:s,seenUids:{box:{},circle:{}}},n);return o}query(e,t,r,i){return this._query(e,t,r,i,!1,null)}hitTest(e,t,r,i,a,s){return this._query(e,t,r,i,!0,a,s).length>0}hitTestCircle(e,t,r,i,a){let s=e-r,n=e+r,o=t-r,l=t+r;if(n<0||s>this.width||l<0||o>this.height)return!1;let u=[];return this._forEachCell(s,o,n,l,this._queryCellCircle,u,{hitTest:!0,overlapMode:i,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},a),u.length>0}_queryCell(e,t,r,i,a,s,n,o){let{seenUids:l,hitTest:u,overlapMode:h}=n,c=this.boxCells[a];if(null!==c){let a=this.bboxes;for(let n of c)if(!l.box[n]){l.box[n]=!0;let c=4*n,d=this.boxKeys[n];if(e<=a[c+2]&&t<=a[c+3]&&r>=a[c+0]&&i>=a[c+1]&&(!o||o(d))&&(!u||!ef(h,d.overlapMode))&&(s.push({key:d,x1:a[c],y1:a[c+1],x2:a[c+2],y2:a[c+3]}),u))return!0}}let d=this.circleCells[a];if(null!==d){let a=this.circles;for(let n of d)if(!l.circle[n]){l.circle[n]=!0;let c=3*n,d=this.circleKeys[n];if(this._circleAndRectCollide(a[c],a[c+1],a[c+2],e,t,r,i)&&(!o||o(d))&&(!u||!ef(h,d.overlapMode))){let e=a[c],t=a[c+1],r=a[c+2];if(s.push({key:d,x1:e-r,y1:t-r,x2:e+r,y2:t+r}),u)return!0}}}return!1}_queryCellCircle(e,t,r,i,a,s,n,o){let{circle:l,seenUids:u,overlapMode:h}=n,c=this.boxCells[a];if(null!==c){let e=this.bboxes;for(let t of c)if(!u.box[t]){u.box[t]=!0;let r=4*t,i=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!o||o(i))&&!ef(h,i.overlapMode))return s.push(!0),!0}}let d=this.circleCells[a];if(null!==d){let e=this.circles;for(let t of d)if(!u.circle[t]){u.circle[t]=!0;let r=3*t,i=this.circleKeys[t];if(this._circlesCollide(e[r],e[r+1],e[r+2],l.x,l.y,l.radius)&&(!o||o(i))&&!ef(h,i.overlapMode))return s.push(!0),!0}}}_forEachCell(e,t,r,i,a,s,n,o){let l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),h=this._convertToXCellCoord(r),c=this._convertToYCellCoord(i);for(let d=l;d<=h;d++)for(let l=u;l<=c;l++)if(a.call(this,e,t,r,i,this.xCellCount*l+d,s,n,o))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,i,a,s){let n=i-e,o=a-t,l=r+s;return l*l>n*n+o*o}_circleAndRectCollide(e,t,r,i,a,s,n){let o=(s-i)/2,l=Math.abs(e-(i+o));if(l>o+r)return!1;let u=(n-a)/2,h=Math.abs(t-(a+u));if(h>u+r)return!1;if(l<=o||h<=u)return!0;let c=l-o,d=h-u;return c*c+d*d<=r*r}}function eg(e,r,i,a,s){let n=t.H();return r?(t.K(n,n,[1/s,1/s,1]),i||t.ae(n,n,a.angle)):t.L(n,a.labelPlaneMatrix,e),n}function ey(e,r,i,a,s){if(r){let r=t.af(e);return t.K(r,r,[s,s,1]),i||t.ae(r,r,-a.angle),r}return a.glCoordMatrix}function ev(e,r,i){let a;i?(a=[e.x,e.y,i(e.x,e.y),1],t.ag(a,a,r)):function(e,t,r){let i=t[0],a=t[1];e[0]=r[0]*i+r[4]*a+r[12],e[1]=r[1]*i+r[5]*a+r[13],e[3]=r[3]*i+r[7]*a+r[15]}(a=[e.x,e.y,0,1],a,r);let s=a[3];return{point:new t.P(a[0]/s,a[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}function e_(e,t,r,i,a,s,n,o){let l=s.glyphStartIndex+s.numGlyphs,u=s.lineStartIndex,h=s.lineStartIndex+s.lineLength,c=t.getoffsetX(s.glyphStartIndex),d=t.getoffsetX(l-1),p=eT(e*c,r,i,a,s.segment,u,h,o,n);if(!p)return null;let f=eT(e*d,r,i,a,s.segment,u,h,o,n);return f?o.projectionCache.anyProjectionOccluded?null:{first:p,last:f}:null}function ex(e,r,i,a){return e===t.ai.horizontal&&Math.abs(i.y-r.y)>Math.abs(i.x-r.x)*a?{useVertical:!0}:(e===t.ai.vertical?r.y<i.y:r.x>i.x)?{needsFlipping:!0}:null}function eb(e,r,i,a,s,n,o,l,u,h,c){let d;let p=i/24,f=r.lineOffsetX*p,m=r.lineOffsetY*p;if(r.numGlyphs>1){let t=r.glyphStartIndex+r.numGlyphs,i=r.lineStartIndex,n=r.lineStartIndex+r.lineLength,u=e_(p,l,f,m,a,r,c,e);if(!u)return{notEnoughRoom:!0};let g=ev(u.first.point,o,e.getElevation).point,y=ev(u.last.point,o,e.getElevation).point;if(s&&!a){let e=ex(r.writingMode,g,y,h);if(e)return e}d=[u.first];for(let s=r.glyphStartIndex+1;s<t-1;s++)d.push(eT(p*l.getoffsetX(s),f,m,a,r.segment,i,n,e,c));d.push(u.last)}else{if(s&&!a){let i=ev(e.tileAnchorPoint,n,e.getElevation).point,a=r.lineStartIndex+r.segment+1,s=new t.P(e.lineVertexArray.getx(a),e.lineVertexArray.gety(a)),o=ev(s,n,e.getElevation),l=o.signedDistanceFromCamera>0?o.point:eS(e.tileAnchorPoint,s,i,1,n,e),u=ex(r.writingMode,i,l,h);if(u)return u}let i=eT(p*l.getoffsetX(r.glyphStartIndex),f,m,a,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,e,c);if(!i||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};d=[i]}for(let e of d)t.ak(u,e.point,e.angle);return{}}function eS(e,t,r,i,a,s){let n=e.add(e.sub(t)._unit()),o=void 0!==a?ev(n,a,s.getElevation).point:eE(n.x,n.y,s).point,l=r.sub(o);return r.add(l._mult(i/l.mag()))}function ew(e,r,i){var a;let s=r.projectionCache;if(s.projections[e])return s.projections[e];let n=new t.P(r.lineVertexArray.getx(e),r.lineVertexArray.gety(e)),o=eE(n.x,n.y,r);if(o.signedDistanceFromCamera>0)return s.projections[e]=o.point,s.anyProjectionOccluded=s.anyProjectionOccluded||o.isOccluded,o.point;let l=e-i.direction;return a=0===i.distanceFromAnchor?r.tileAnchorPoint:new t.P(r.lineVertexArray.getx(l),r.lineVertexArray.gety(l)),eS(a,n,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,void 0,r)}function eE(e,r,i){let a;let s=e+i.translation[0],n=r+i.translation[1];return!i.pitchWithMap&&i.projection.useSpecialProjectionForSymbols?((a=i.projection.projectTileCoordinates(s,n,i.unwrappedTileID,i.getElevation)).point.x=(.5*a.point.x+.5)*i.width,a.point.y=(-(.5*a.point.y)+.5)*i.height):(a=ev(new t.P(s,n),i.labelPlaneMatrix,i.getElevation)).isOccluded=!1,a}function eA(e,t,r){return e._unit()._perp()._mult(t*r)}function eT(e,r,i,a,s,n,o,l,u){let h;let c=a?e-r:e+r,d=c>0?1:-1,p=0;a&&(d*=-1,p=Math.PI),d<0&&(p+=Math.PI);let f,m=d>0?n+s:n+s+1;l.projectionCache.cachedAnchorPoint?f=l.projectionCache.cachedAnchorPoint:(f=eE(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,l.projectionCache.cachedAnchorPoint=f);let g,y,v=f,_=f,x=0,b=0,S=Math.abs(c),w=[];for(;x+b<=S;){if((m+=d)<n||m>=o)return null;x+=b,_=v,y=g;let e={absOffsetX:S,direction:d,distanceFromAnchor:x,previousVertex:_};if(v=ew(m,l,e),0===i)w.push(_),h=v.sub(_);else{let r;let a=v.sub(_);r=0===a.mag()?eA(ew(m+d,l,e).sub(v),i,d):eA(a,i,d),y||(y=_.add(r)),g=function(e,r,i,a,s,n,o,l,u){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];let h=i.add(r);if(e+u.direction<a||e+u.direction>=s)return l.projectionCache.offsets[e]=h,h;let c=ew(e+u.direction,l,u),d=eA(c.sub(i),o,u.direction),p=i.add(d),f=c.add(d);return l.projectionCache.offsets[e]=t.al(n,h,p,f)||h,l.projectionCache.offsets[e]}(m,r,v,n,o,y,i,l,e),w.push(y),h=g.sub(y)}b=h.mag()}let E=h._mult((S-x)/b)._add(y||_),A=p+Math.atan2(v.y-_.y,v.x-_.x);return w.push(E),{point:E,angle:u?A:0,path:w}}let eC=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function eP(e,t){for(let r=0;r<e;r++){let e=t.length;t.resize(e+4),t.float32.set(eC,3*e)}}class eR{constructor(e,t,r=new em(e.width+200,e.height+200,25),i=new em(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=t,this.grid=r,this.ignoredGrid=i,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,i,a,s,n,o,l,u,h){let c=e.anchorPointX+o[0],d=e.anchorPointY+o[1],p=this.projectAndGetPerspectiveRatio(i,c,d,a,u),f=this._projectCollisionBox(e,r,i,a,s,n,o,p,u,h),[m,g,y,v]=f.box;return this.mapProjection.useSpecialProjectionForSymbols&&(s?f.allPointsOccluded:this.mapProjection.isOccluded(c,d,a))||p.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(m,g,y,v)||"always"!==t&&this.grid.hitTest(m,g,y,v,t,l)?{box:[m,g,y,v],placeable:!1,offscreen:!1}:{box:[m,g,y,v],placeable:!0,offscreen:this.isOffscreen(m,g,y,v)}}placeCollisionCircles(e,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g){let y=[],v=new t.P(r.anchorX,r.anchorY),_=this.getPerspectiveRatio(n,v.x,v.y,o,g),x=(c?s/_:s*_)/t.aq,b={getElevation:g,labelPlaneMatrix:l,lineVertexArray:i,pitchWithMap:c,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:v,unwrappedTileID:o,width:this.transform.width,height:this.transform.height,translation:m},S=e_(x,a,r.lineOffsetX*x,r.lineOffsetY*x,!1,r,!1,b),w=!1,E=!1,A=!0;if(S){let r=.5*p*_+f,i=new t.P(-100,-100),a=new t.P(this.screenRightBoundary,this.screenBottomBoundary),s=new ep,n=S.first,o=S.last,l=[];for(let e=n.path.length-1;e>=1;e--)l.push(n.path[e]);for(let e=1;e<o.path.length;e++)l.push(o.path[e]);let c=2.5*r;if(u){let e=this.projectPathToScreenSpace(l,b,u);l=e.some(e=>e.signedDistanceFromCamera<=0)?[]:e.map(e=>e.point)}let m=[];if(l.length>0){let e=l[0].clone(),r=l[0].clone();for(let t=1;t<l.length;t++)e.x=Math.min(e.x,l[t].x),e.y=Math.min(e.y,l[t].y),r.x=Math.max(r.x,l[t].x),r.y=Math.max(r.y,l[t].y);m=e.x>=i.x&&r.x<=a.x&&e.y>=i.y&&r.y<=a.y?[l]:r.x<i.x||e.x>a.x||r.y<i.y||e.y>a.y?[]:t.am([l],i.x,i.y,a.x,a.y)}for(let t of m){s.reset(t,.25*r);let i=0;i=s.length<=.5*r?1:Math.ceil(s.paddedLength/c)+1;for(let t=0;t<i;t++){let a=t/Math.max(i-1,1),n=s.lerp(a),o=n.x+100,l=n.y+100;y.push(o,l,r,0);let u=o-r,c=l-r,p=o+r,f=l+r;if(A=A&&this.isOffscreen(u,c,p,f),E=E||this.isInsideGrid(u,c,p,f),"always"!==e&&this.grid.hitTestCircle(o,l,r,e,d)&&(w=!0,!h))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!h&&w||!E||_<this.perspectiveRatioCutoff?[]:y,offscreen:A,collisionDetected:w}}projectPathToScreenSpace(e,t,r){return e.map(e=>ev(e,r,t.getElevation))}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};let r=[],i=1/0,a=1/0,s=-1/0,n=-1/0;for(let o of e){let e=new t.P(o.x+100,o.y+100);i=Math.min(i,e.x),a=Math.min(a,e.y),s=Math.max(s,e.x),n=Math.max(n,e.y),r.push(e)}let o=this.grid.query(i,a,s,n).concat(this.ignoredGrid.query(i,a,s,n)),l={},u={};for(let e of o){let i=e.key;if(void 0===l[i.bucketInstanceId]&&(l[i.bucketInstanceId]={}),l[i.bucketInstanceId][i.featureIndex])continue;let a=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.an(r,a)&&(l[i.bucketInstanceId][i.featureIndex]=!0,void 0===u[i.bucketInstanceId]&&(u[i.bucketInstanceId]=[]),u[i.bucketInstanceId].push(i.featureIndex))}return u}insertCollisionBox(e,t,r,i,a,s){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:a,collisionGroupID:s,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,i,a,s){let n=r?this.ignoredGrid:this.grid,o={bucketInstanceId:i,featureIndex:a,collisionGroupID:s,overlapMode:t};for(let t=0;t<e.length;t+=4)n.insertCircle(o,e[t],e[t+1],e[t+2])}projectAndGetPerspectiveRatio(e,r,i,a,s){let n=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(r,i,a,s):ev(new t.P(r,i),e,s);return{point:new t.P((n.point.x+1)/2*this.transform.width+100,(1-n.point.y)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/n.signedDistanceFromCamera*.5,isOccluded:n.isOccluded,signedDistanceFromCamera:n.signedDistanceFromCamera}}getPerspectiveRatio(e,r,i,a,s){let n=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(r,i,a,s):ev(new t.P(r,i),e,s);return .5+this.transform.cameraToCenterDistance/n.signedDistanceFromCamera*.5}isOffscreen(e,t,r,i){return r<100||e>=this.screenRightBoundary||i<100||t>this.screenBottomBoundary}isInsideGrid(e,t,r,i){return r>=0&&e<this.gridRightBoundary&&i>=0&&t<this.gridBottomBoundary}getViewportMatrix(){let e=t.ao([]);return t.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,i,a,s,n,o,l,u,h){let c=r*l.perspectiveRatio,d=new t.P(1,0),p=new t.P(0,1),f=new t.P(e.anchorPointX+o[0],e.anchorPointY+o[1]);if(n&&!s){let e=this.projectAndGetPerspectiveRatio(i,f.x+1,f.y,a,u).point.sub(l.point).unit(),r=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0),s=Math.sin(r),n=Math.cos(r);d=new t.P(n,s),p=new t.P(-s,n)}else if(!n&&s){let e=-this.transform.angle,r=Math.sin(e),i=Math.cos(e);d=new t.P(i,r),p=new t.P(-r,i)}let m=l.point,g=c;s&&(m=f,g=Math.pow(2,-(this.transform.zoom-Math.floor(this.transform.zoom)))*this.mapProjection.getPitchedTextCorrection(this.transform,f,a),h||(g*=t.ad(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),h&&(m=m.add(d.mult(h.x*g)).add(p.mult(h.y*g)));let y=e.x1*g,v=e.x2*g,_=(y+v)/2,x=e.y1*g,b=e.y2*g,S=(x+b)/2,w=[];for(let{offsetX:e,offsetY:r}of[{offsetX:y,offsetY:x},{offsetX:_,offsetY:x},{offsetX:v,offsetY:x},{offsetX:v,offsetY:S},{offsetX:v,offsetY:b},{offsetX:_,offsetY:b},{offsetX:y,offsetY:b},{offsetX:y,offsetY:S}])w.push(new t.P(m.x+d.x*e+p.x*r,m.y+d.y*e+p.y*r));let E=!1;if(s){let e=w.map(e=>this.projectAndGetPerspectiveRatio(i,e.x,e.y,a,u));E=e.some(e=>!e.isOccluded),w=e.map(e=>e.point)}else E=!0;return{box:t.ap(w),allPointsOccluded:!E}}}function eI(e,r,i){return t.X/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ))*r}class eL{constructor(e,t,r,i){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):i&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class eO{constructor(e,t,r,i,a){this.text=new eL(e?e.text:null,t,r,a),this.icon=new eL(e?e.icon:null,t,i,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class eM{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class ek{constructor(){this.invProjMatrix=t.H(),this.viewportMatrix=t.H(),this.circles=[]}}class eN{constructor(e,t,r,i,a){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=a}}class eD{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function eF(e,r,i,a,s){let{horizontalAlign:n,verticalAlign:o}=t.av(e);return new t.P(-(n-.5)*r+a[0]*s,-(o-.5)*i+a[1]*s)}class eG{constructor(e,t,r,i,a,s){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new eR(this.transform,t),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new eD(a),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=s,s&&(s.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){let t=this.terrain;return t?(r,i)=>t.getElevation(e,r,i):null}getBucketParts(e,r,i,a){let s=i.getBucket(r),n=i.latestFeatureIndex;if(!s||!n||r.id!==s.layerIds[0])return;let o=i.collisionBoxArray,l=s.layers[0].layout,u=s.layers[0].paint,h=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/t.X,d=i.tileID.toUnwrapped(),p=this.transform.calculatePosMatrix(d),f="map"===l.get("text-pitch-alignment"),m="map"===l.get("text-rotation-alignment"),g=eI(i,1,this.transform.zoom),y=this.collisionIndex.mapProjection.translatePosition(this.transform,i,u.get("text-translate"),u.get("text-translate-anchor")),v=this.collisionIndex.mapProjection.translatePosition(this.transform,i,u.get("icon-translate"),u.get("icon-translate-anchor")),_=eg(p,f,m,this.transform,g),x=null;if(f){let e=ey(p,f,m,this.transform,g);x=t.L([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[s.bucketInstanceId]=new eN(s.bucketInstanceId,n,s.sourceLayerIndex,s.index,i.tileID);let b={bucket:s,layout:l,translationText:y,translationIcon:v,posMatrix:p,unwrappedTileID:d,textLabelPlaneMatrix:_,labelToScreenMatrix:x,scale:h,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:t.ah(s.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(a)for(let t of s.sortKeyRanges){let{sortKey:r,symbolInstanceStart:i,symbolInstanceEnd:a}=t;e.push({sortKey:r,symbolInstanceStart:i,symbolInstanceEnd:a,parameters:b})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:b})}attemptAnchorPlacement(e,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_){let x=t.ar[e.textAnchor],b=[e.textOffset0,e.textOffset1],S=eF(x,i,a,b,s),w=this.collisionIndex.placeCollisionBox(r,d,l,u,h,o,n,g,c.predicate,_,S);if((!v||this.collisionIndex.placeCollisionBox(v,d,l,u,h,o,n,y,c.predicate,_,S).placeable)&&w.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(e=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:b,width:i,height:a,anchor:x,textBoxScale:s,prevAnchor:e},this.markUsedJustification(f,x,p,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,p),this.placedOrientations[p.crossTileID]=m),{shift:S,placedGlyphBoxes:w}}}placeLayerBucketPart(e,r,i){let{bucket:a,layout:s,translationText:n,translationIcon:o,posMatrix:l,unwrappedTileID:u,textLabelPlaneMatrix:h,labelToScreenMatrix:c,textPixelRatio:d,holdingForFade:p,collisionBoxArray:f,partiallyEvaluatedTextSize:m,collisionGroup:g}=e.parameters,y=s.get("text-optional"),v=s.get("icon-optional"),_=t.as(s,"text-overlap","text-allow-overlap"),x="always"===_,b=t.as(s,"icon-overlap","icon-allow-overlap"),S="always"===b,w="map"===s.get("text-rotation-alignment"),E="map"===s.get("text-pitch-alignment"),A="none"!==s.get("icon-text-fit"),T="viewport-y"===s.get("symbol-z-order"),C=x&&(S||!a.hasIconData()||v),P=S&&(x||!a.hasTextData()||y);!a.collisionArrays&&f&&a.deserializeCollisionBoxes(f);let R=this._getTerrainElevationFunc(this.retainedQueryData[a.bucketInstanceId].tileID),I=(e,f,S)=>{var T,I;if(r[e.crossTileID])return;if(p)return void(this.placements[e.crossTileID]=new eM(!1,!1,!1));let L=!1,O=!1,M=!0,k=null,N={box:null,placeable:!1,offscreen:null},D={box:null,placeable:!1,offscreen:null},F=null,G=null,z=null,q=0,j=0,B=0;f.textFeatureIndex?q=f.textFeatureIndex:e.useRuntimeCollisionCircles&&(q=e.featureIndex),f.verticalTextFeatureIndex&&(j=f.verticalTextFeatureIndex);let U=f.textBox;if(U){let r=r=>{let i=t.ai.horizontal;if(a.allowVerticalPlacement&&!r&&this.prevPlacement){let t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,i=t,this.markUsedOrientation(a,i,e))}return i},s=(r,i)=>{if(a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&f.verticalTextBox){for(let e of a.writingModes)if(e===t.ai.vertical?D=N=i():N=r(),N&&N.placeable)break}else N=r()},h=e.textAnchorOffsetStartIndex,c=e.textAnchorOffsetEndIndex;if(c===h){let i=(t,r)=>{let i=this.collisionIndex.placeCollisionBox(t,_,d,l,u,E,w,n,g.predicate,R);return i&&i.placeable&&(this.markUsedOrientation(a,r,e),this.placedOrientations[e.crossTileID]=r),i};s(()=>i(U,t.ai.horizontal),()=>{let r=f.verticalTextBox;return a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&r?i(r,t.ai.vertical):{box:null,offscreen:null}}),r(N&&N.placeable)}else{let p=t.ar[null===(I=null===(T=this.prevPlacement)||void 0===T?void 0:T.variableOffsets[e.crossTileID])||void 0===I?void 0:I.anchor],m=(r,s,f)=>{let m=r.x2-r.x1,y=r.y2-r.y1,v=e.textBoxScale,x=A&&"never"===b?s:null,S=null,T="never"===_?1:2,C="never";p&&T++;for(let t=0;t<T;t++){for(let t=h;t<c;t++){let i=a.textAnchorOffsets.get(t);if(p&&i.textAnchor!==p)continue;let s=this.attemptAnchorPlacement(i,r,m,y,v,w,E,d,l,u,g,C,e,a,f,n,o,x,R);if(s&&(S=s.placedGlyphBoxes)&&S.placeable)return L=!0,k=s.shift,S}p?p=null:C=_}return i&&!S&&(S={box:this.collisionIndex.placeCollisionBox(U,"always",d,l,u,E,w,n,g.predicate,R,new t.P(0,0)).box,offscreen:!1,placeable:!1}),S};s(()=>m(U,f.iconBox,t.ai.horizontal),()=>{let r=f.verticalTextBox;return a.allowVerticalPlacement&&(!N||!N.placeable)&&e.numVerticalGlyphVertices>0&&r?m(r,f.verticalIconBox,t.ai.vertical):{box:null,occluded:!0,offscreen:null}}),N&&(L=N.placeable,M=N.offscreen);let y=r(N&&N.placeable);if(!L&&this.prevPlacement){let t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(a,t.anchor,e,y))}}}if(L=(F=N)&&F.placeable,M=F&&F.offscreen,e.useRuntimeCollisionCircles){let r=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),o=t.aj(a.textSizeData,m,r),d=s.get("text-padding");(G=this.collisionIndex.placeCollisionCircles(_,r,a.lineVertexArray,a.glyphOffsetArray,o,l,u,h,c,i,E,g.predicate,e.collisionCircleDiameter,d,n,R)).circles.length&&G.collisionDetected&&!i&&t.w("Collisions detected, but collision boxes are not shown"),L=x||G.circles.length>0&&!G.collisionDetected,M=M&&G.offscreen}if(f.iconFeatureIndex&&(B=f.iconFeatureIndex),f.iconBox){let e=e=>this.collisionIndex.placeCollisionBox(e,b,d,l,u,E,w,o,g.predicate,R,A&&k?k:void 0);O=D&&D.placeable&&f.verticalIconBox?(z=e(f.verticalIconBox)).placeable:(z=e(f.iconBox)).placeable,M=M&&z.offscreen}let H=y||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,Z=v||0===e.numIconVertices;H||Z?Z?H||(O=O&&L):L=O&&L:O=L=O&&L;let V=O&&z.placeable;if(L&&F.placeable&&this.collisionIndex.insertCollisionBox(F.box,_,s.get("text-ignore-placement"),a.bucketInstanceId,D&&D.placeable&&j?j:q,g.ID),V&&this.collisionIndex.insertCollisionBox(z.box,b,s.get("icon-ignore-placement"),a.bucketInstanceId,B,g.ID),G&&L&&this.collisionIndex.insertCollisionCircles(G.circles,_,s.get("text-ignore-placement"),a.bucketInstanceId,q,g.ID),i&&this.storeCollisionData(a.bucketInstanceId,S,f,F,z,G),0===e.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");if(0===a.bucketInstanceId)throw Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new eM(L||C,O||P,M||a.justReloaded),r[e.crossTileID]=!0};if(T){if(0!==e.symbolInstanceStart)throw Error("bucket.bucketInstanceId should be 0");let t=a.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){let r=t[e];I(a.symbolInstances.get(r),a.collisionArrays[r],r)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)I(a.symbolInstances.get(t),a.collisionArrays[t],t);if(i&&a.bucketInstanceId in this.collisionCircleArrays){let e=this.collisionCircleArrays[a.bucketInstanceId];t.at(e.invProjMatrix,l),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1}storeCollisionData(e,t,r,i,a,s){if(r.textBox||r.iconBox){let s,n;this.collisionBoxArrays.has(e)?s=this.collisionBoxArrays.get(e):(s=new Map,this.collisionBoxArrays.set(e,s)),s.has(t)?n=s.get(t):(n={text:null,icon:null},s.set(t,n)),r.textBox&&(n.text=i.box),r.iconBox&&(n.icon=a.box)}if(s){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new ek);for(let e=0;e<s.circles.length;e+=4)t.circles.push(s.circles[e+0]),t.circles.push(s.circles[e+1]),t.circles.push(s.circles[e+2]),t.circles.push(s.collisionDetected?1:0)}}markUsedJustification(e,r,i,a){let s;for(let n of(s=a===t.ai.vertical?i.verticalPlacedTextSymbolIndex:({left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex})[t.au(r)],[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex]))n>=0&&(e.text.placedSymbolArray.get(n).crossTileID=s>=0&&n!==s?0:i.crossTileID)}markUsedOrientation(e,r,i){let a=r===t.ai.horizontal||r===t.ai.horizontalOnly?r:0,s=r===t.ai.vertical?r:0;for(let t of[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex])e.text.placedSymbolArray.get(t).placedOrientation=a;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=s)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;let i=t?t.symbolFadeChange(e):1,a=t?t.opacities:{},s=t?t.variableOffsets:{},n=t?t.placedOrientations:{};for(let e in this.placements){let t=this.placements[e],s=a[e];s?(this.opacities[e]=new eO(s,i,t.text,t.icon),r=r||t.text!==s.text.placed||t.icon!==s.icon.placed):(this.opacities[e]=new eO(null,i,t.text,t.icon,t.skipFade),r=r||t.text||t.icon)}for(let e in a){let t=a[e];if(!this.opacities[e]){let a=new eO(t,i,!1,!1);a.isHidden()||(this.opacities[e]=a,r=r||t.text.placed||t.icon.placed)}}for(let e in s)this.variableOffsets[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.variableOffsets[e]=s[e]);for(let e in n)this.placedOrientations[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.placedOrientations[e]=n[e]);if(t&&void 0===t.lastPlacementChangeTime)throw Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){let r={};for(let i of t){let t=i.getBucket(e);t&&i.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,i.tileID,r,i.collisionBoxArray)}}updateBucketOpacities(e,r,i,a){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let s=e.layers[0],n=s.layout,o=new eO(null,0,!1,!1,!0),l=n.get("text-allow-overlap"),u=n.get("icon-allow-overlap"),h=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),c="map"===n.get("text-rotation-alignment"),d="map"===n.get("text-pitch-alignment"),p="none"!==n.get("icon-text-fit"),f=new eO(null,0,l&&(u||!e.hasIconData()||n.get("icon-optional")),u&&(l||!e.hasTextData()||n.get("text-optional")),!0);!e.collisionArrays&&a&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(a);let m=(e,t,r)=>{for(let i=0;i<t/4;i++)e.opacityVertexArray.emplaceBack(r);e.hasVisibleVertices=e.hasVisibleVertices||r!==ej},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let r=0;r<e.symbolInstances.length;r++){let a=e.symbolInstances.get(r),{numHorizontalGlyphVertices:s,numVerticalGlyphVertices:n,crossTileID:l}=a,u=this.opacities[l];i[l]?u=o:u||(u=f,this.opacities[l]=u),i[l]=!0;let y=a.numIconVertices>0,v=this.placedOrientations[a.crossTileID],_=v===t.ai.vertical,x=v===t.ai.horizontal||v===t.ai.horizontalOnly;if(s>0||n>0){let t=eq(u.text);m(e.text,s,_?ej:t),m(e.text,n,x?ej:t);let r=u.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=r||_?1:0)}),a.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=r||x?1:0);let i=this.variableOffsets[a.crossTileID];i&&this.markUsedJustification(e,i.anchor,a,v);let o=this.placedOrientations[a.crossTileID];o&&(this.markUsedJustification(e,"left",a,o),this.markUsedOrientation(e,o,a))}if(y){let t=eq(u.icon),r=!(p&&a.verticalPlacedIconSymbolIndex&&_);a.placedIconSymbolIndex>=0&&(m(e.icon,a.numIconVertices,r?t:ej),e.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=u.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,a.numVerticalIconVertices,r?ej:t),e.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=u.icon.isHidden())}let b=g&&g.has(r)?g.get(r):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let i=e.collisionArrays[r];if(i){let r=new t.P(0,0);if(i.textBox||i.verticalTextBox){let t=!0;if(h){let e=this.variableOffsets[l];e?(r=eF(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),c&&r._rotate(d?this.transform.angle:-this.transform.angle)):t=!1}if(i.textBox||i.verticalTextBox){let a;i.textBox&&(a=_),i.verticalTextBox&&(a=x),ez(e.textCollisionBox.collisionVertexArray,u.text.placed,!t||a,b.text,r.x,r.y)}}if(i.iconBox||i.verticalIconBox){let t;let a=!!(!x&&i.verticalIconBox);i.iconBox&&(t=a),i.verticalIconBox&&(t=!a),ez(e.iconCollisionBox.collisionVertexArray,u.icon.placed,t,b.icon,p?r.x:0,p?r.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){let t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){let r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function ez(e,t,r,i,a,s){i&&0!==i.length||(i=[0,0,0,0]);let n=i[0]-100,o=i[1]-100,l=i[2]-100,u=i[3]-100;e.emplaceBack(t?1:0,r?1:0,a||0,s||0,n,o),e.emplaceBack(t?1:0,r?1:0,a||0,s||0,l,o),e.emplaceBack(t?1:0,r?1:0,a||0,s||0,l,u),e.emplaceBack(t?1:0,r?1:0,a||0,s||0,n,u)}function eq(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;let t=e.placed?1:0,r=Math.floor(127*e.opacity);return 33554432*r+16777216*t+131072*r+65536*t+512*r+256*t+2*r+t}let ej=0;function eB(){return{isOccluded:(e,t,r)=>!1,getPitchedTextCorrection:(e,t,r)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(e,t,r,i){throw Error("Not implemented.")},translatePosition:(e,t,r,i)=>(function(e,t,r,i,a=!1){if(!r[0]&&!r[1])return[0,0];let s=a?"map"===i?e.angle:0:"viewport"===i?-e.angle:0;if(s){let e=Math.sin(s),t=Math.cos(s);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}return[a?r[0]:eI(t,r[0],e.zoom),a?r[1]:eI(t,r[1],e.zoom)]})(e,t,r,i),getCircleRadiusCorrection:e=>1}}class eU{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,i,a){let s=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(s,i,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,a())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((e,t)=>e.sortKey-t.sortKey));this._currentPartIndex<s.length;)if(t.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,a())return!0;return!1}}class eH{constructor(e,t,r,i,a,s,n,o){this.placement=new eG(e,eB(),t,s,n,o),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){let i=c.now(),a=()=>!this._forceFullPlacement&&c.now()-i>2;for(;this._currentPlacementIndex>=0;){let i=t[e[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===i.type&&(!i.minzoom||i.minzoom<=s)&&(!i.maxzoom||i.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new eU(i)),this._inProgressLayer.continuePlacement(r[i.source],this.placement,this._showCollisionBoxes,i,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}let eZ=512/t.X/2;class eV{constructor(e,r,i){this.tileID=e,this.bucketInstanceId=i,this._symbolsByKey={};let a=new Map;for(let e=0;e<r.length;e++){let t=r.get(e),i=t.key,s=a.get(i);s?s.push(t):a.set(i,[t])}for(let[e,r]of a){let i={positions:r.map(e=>({x:Math.floor(e.anchorX*eZ),y:Math.floor(e.anchorY*eZ)})),crossTileIDs:r.map(e=>e.crossTileID)};if(i.positions.length>128){let e=new t.aw(i.positions.length,16,Uint16Array);for(let{x:t,y:r}of i.positions)e.add(t,r);e.finish(),delete i.positions,i.index=e}this._symbolsByKey[e]=i}}getScaledCoordinates(e,r){let{x:i,y:a,z:s}=this.tileID.canonical,{x:n,y:o,z:l}=r.canonical,u=eZ/Math.pow(2,l-s),h=(o*t.X+e.anchorY)*u,c=a*t.X*eZ;return{x:Math.floor((n*t.X+e.anchorX)*u-i*t.X*eZ),y:Math.floor(h-c)}}findMatches(e,t,r){let i=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let a=0;a<e.length;a++){let s=e.get(a);if(s.crossTileID)continue;let n=this._symbolsByKey[s.key];if(!n)continue;let o=this.getScaledCoordinates(s,t);if(n.index)for(let e of n.index.range(o.x-i,o.y-i,o.x+i,o.y+i).sort()){let t=n.crossTileIDs[e];if(!r[t]){r[t]=!0,s.crossTileID=t;break}}else if(n.positions)for(let e=0;e<n.positions.length;e++){let t=n.positions[e],a=n.crossTileIDs[e];if(Math.abs(t.x-o.x)<=i&&Math.abs(t.y-o.y)<=i&&!r[a]){r[a]=!0,s.crossTileID=a;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class eY{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class eW{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let t=Math.round((e-this.lng)/360);if(0!==t)for(let e in this.indexes){let r=this.indexes[e],i={};for(let e in r){let a=r[e];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),i[a.tileID.key]=a}this.indexes[e]=i}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let e=0;e<t.symbolInstances.length;e++)t.symbolInstances.get(e).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let i=this.usedCrossTileIDs[e.overscaledZ];for(let r in this.indexes){let a=this.indexes[r];if(Number(r)>e.overscaledZ)for(let r in a){let s=a[r];s.tileID.isChildOf(e)&&s.findMatches(t.symbolInstances,e,i)}else{let s=a[e.scaledTo(Number(r)).key];s&&s.findMatches(t.symbolInstances,e,i)}}for(let e=0;e<t.symbolInstances.length;e++){let a=t.symbolInstances.get(e);a.crossTileID||(a.crossTileID=r.generate(),i[a.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new eV(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(let r of t.getCrossTileIDsLists())for(let t of r)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(let r in this.indexes){let i=this.indexes[r];for(let a in i)e[i[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[a]),delete i[a],t=!0)}return t}}class e${constructor(){this.layerIndexes={},this.crossTileIDs=new eY,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let i=this.layerIndexes[e.id];void 0===i&&(i=this.layerIndexes[e.id]=new eW);let a=!1,s={};for(let n of(i.handleWrapJump(r),t)){let t=n.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(n.tileID,t,this.crossTileIDs)&&(a=!0),s[t.bucketInstanceId]=!0)}return i.removeStaleBuckets(s)&&(a=!0),a}pruneUnusedLayers(e){let t={};for(let r in e.forEach(e=>{t[e]=!0}),this.layerIndexes)t[r]||delete this.layerIndexes[r]}}let eX=(e,r)=>t.t(e,r&&r.filter(e=>"source.canvas"!==e.identifier)),eK=t.ax();class eJ extends t.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(let e in this.sourceCaches){let t=this.sourceCaches[e].getSource().type;"vector"!==t&&"geojson"!==t||this.sourceCaches[e].reload()}},this.map=e,this.dispatcher=new j(q(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(e,t)=>this.getGlyphs(e,t)),this.dispatcher.registerMessageHandler("GI",(e,t)=>this.getImages(e,t)),this.imageManager=new P,this.imageManager.setEventedParent(this),this.glyphManager=new L(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new e$,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",t.az()),en().on(ei,this._rtlPluginLoaded),this.on("data",e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;let t=this.sourceCaches[e.sourceId];if(!t)return;let r=t.getSource();if(r&&r.vectorLayerIds)for(let e in this._layers){let t=this._layers[e];t.source===r.id&&this._validateLayer(t)}})}loadURL(e,r={},i){this.fire(new t.k("dataloading",{dataType:"style"})),r.validate="boolean"!=typeof r.validate||r.validate;let a=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,t.h(a,this._loadStyleRequest).then(e=>{this._loadStyleRequest=null,this._load(e.data,r,i)}).catch(e=>{this._loadStyleRequest=null,e&&this.fire(new t.j(e))})}loadJSON(e,r={},i){this.fire(new t.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,c.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=!1!==r.validate,this._load(e,r,i)}).catch(()=>{})}loadEmpty(){this.fire(new t.k("dataloading",{dataType:"style"})),this._load(eK,{validate:!1})}_load(e,r,i){var a;let s=r.transformStyle?r.transformStyle(i,e):e;if(!r.validate||!eX(this,t.x(s))){for(let e in this._loaded=!0,this.stylesheet=s,s.sources)this.addSource(e,s.sources[e],{validate:!1});s.sprite?this._loadSprite(s.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(s.glyphs),this._createLayers(),this.light=new M(this.stylesheet.light),this.sky=new N(this.stylesheet.sky),this.map.setTerrain(null!==(a=this.stylesheet.terrain)&&void 0!==a?a:null),this.fire(new t.k("data",{dataType:"style"})),this.fire(new t.k("style.load"))}}_createLayers(){let e=t.aA(this.stylesheet.layers);for(let r of(this.dispatcher.broadcast("SL",e),this._order=e.map(e=>e.id),this._layers={},this._serializedLayers=null,e)){let e=t.aB(r);e.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=e}}_loadSprite(e,r=!1,i){let a;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(e,r,i,a){return t._(this,void 0,void 0,function*(){let s=A(e),n=i>1?"@2x":"",o={},l={};for(let{id:e,url:i}of s){let s=r.transformRequest(T(i,n,".json"),"SpriteJSON");o[e]=t.h(s,a);let u=r.transformRequest(T(i,n,".png"),"SpriteImage");l[e]=b.getImage(u,a)}return yield Promise.all([...Object.values(o),...Object.values(l)]),function(e,r){return t._(this,void 0,void 0,function*(){let t={};for(let i in e){t[i]={};let a=c.getImageCanvasContext((yield r[i]).data),s=(yield e[i]).data;for(let e in s){let{width:r,height:n,x:o,y:l,sdf:u,pixelRatio:h,stretchX:c,stretchY:d,content:p,textFitWidth:f,textFitHeight:m}=s[e];t[i][e]={data:null,pixelRatio:h,sdf:u,stretchX:c,stretchY:d,content:p,textFitWidth:f,textFitHeight:m,spriteData:{width:r,height:n,x:o,y:l,context:a}}}}return t})}(o,l)})})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(e=>{if(this._spriteRequest=null,e)for(let t in e){for(let r of(this._spritesImagesIds[t]=[],this._spritesImagesIds[t]?this._spritesImagesIds[t].filter(t=>!(t in e)):[]))this.imageManager.removeImage(r),this._changedImages[r]=!0;for(let i in e[t]){let a="default"===t?i:`${t}:${i}`;this._spritesImagesIds[t].push(a),a in this.imageManager.images?this.imageManager.updateImage(a,e[t][i],!1):this.imageManager.addImage(a,e[t][i]),r&&(this._changedImages[a]=!0)}}}).catch(e=>{this._spriteRequest=null,a=e,this.fire(new t.j(a))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"})),i&&i(a)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}_validateLayer(e){let r=this.sourceCaches[e.source];if(!r)return;let i=e.sourceLayer;if(!i)return;let a=r.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(i))&&this.fire(new t.j(Error(`Source layer "${i}" does not exist on source "${a.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let t=this._serializedAllLayers();if(!e||0===e.length)return Object.values(t);let r=[];for(let i of e)t[i]&&r.push(t[i]);return r}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;for(let t of(e=this._serializedLayers={},Object.keys(this._layers))){let r=this._layers[t];"custom"!==r.type&&(e[t]=r.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw Error("Style is not done loading.")}update(e){if(!this._loaded)return;let r=this._changed;if(r){let t=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(let e in(t.length||r.length)&&this._updateWorkerLayers(t,r),this._updatedSources){let t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw Error(`Invalid action ${t}`);this._clearSource(e)}}for(let t in this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs(),this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}let i={};for(let e in this.sourceCaches){let t=this.sourceCaches[e];i[e]=t.used,t.used=!1}for(let t of this._order){let r=this._layers[t];r.recalculate(e,this._availableImages),!r.isHidden(e.zoom)&&r.source&&(this.sourceCaches[r.source].used=!0)}for(let e in i){let r=this.sourceCaches[e];!!i[e]!=!!r.used&&r.fire(new t.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:e}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,r&&this.fire(new t.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var i;this._checkLoaded();let a=this.serialize();if(e=r.transformStyle?r.transformStyle(a,e):e,(null===(i=r.validate)||void 0===i||i)&&eX(this,t.x(e)))return!1;(e=t.aC(e)).layers=t.aA(e.layers);let s=t.aD(a,e),n=this._getOperationsToPerform(s);if(n.unimplemented.length>0)throw Error(`Unimplemented: ${n.unimplemented.join(", ")}.`);if(0===n.operations.length)return!1;for(let e of n.operations)e();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let t=[],r=[];for(let i of e)switch(i.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,i.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,i.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,i.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,i.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,i.args));break;case"addSource":t.push(()=>this.addSource.apply(this,i.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,i.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,i.args));break;case"setLight":t.push(()=>this.setLight.apply(this,i.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,i.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,i.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,i.args));break;case"setSky":t.push(()=>this.setSky.apply(this,i.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,i.args));break;case"setTransition":t.push(()=>{});break;default:r.push(i.command)}return{operations:t,unimplemented:r}}addImage(e,r){if(this.getImage(e))return this.fire(new t.j(Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.j(Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,i={}){if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw Error(`Source "${e}" already exists.`);if(!r.type)throw Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.x.source,`sources.${e}`,r,null,i))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);let a=this.sourceCaches[e]=new eh(e,r,this.dispatcher);a.style=this,a.setEventedParent(this,()=>({isSourceLoaded:a.loaded(),source:a.serialize(),sourceId:e})),a.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw Error("There is no source with this ID");for(let r in this._layers)if(this._layers[r].source===e)return this.fire(new t.j(Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));let r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw Error(`There is no source with this ID=${e}`);let r=this.sourceCaches[e].getSource();if("geojson"!==r.type)throw Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,i={}){let a;this._checkLoaded();let s=e.id;if(this.getLayer(s))return void this.fire(new t.j(Error(`Layer "${s}" already exists on this map.`)));if("custom"===e.type){if(eX(this,t.aE(e)))return;a=t.aB(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(s,e.source),e=t.aC(e),e=t.e(e,{source:s})),this._validate(t.x.layer,`layers.${s}`,e,{arrayIndex:-1},i))return;a=t.aB(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:s}})}let n=r?this._order.indexOf(r):this._order.length;if(r&&-1===n)this.fire(new t.j(Error(`Cannot add layer "${s}" before non-existing layer "${r}".`)));else{if(this._order.splice(n,0,s),this._layerOrderChanged=!0,this._layers[s]=a,this._removedLayers[s]&&a.source&&"custom"!==a.type){let e=this._removedLayers[s];delete this._removedLayers[s],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.j(Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;let i=this._order.indexOf(e);this._order.splice(i,1);let a=r?this._order.indexOf(r):this._order.length;r&&-1===a?this.fire(new t.j(Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(a,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();let r=this._layers[e];if(!r)return void this.fire(new t.j(Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);let i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,i){this._checkLoaded();let a=this.getLayer(e);a?a.minzoom===r&&a.maxzoom===i||(null!=r&&(a.minzoom=r),null!=i&&(a.maxzoom=i),this._updateLayer(a)):this.fire(new t.j(Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,i={}){this._checkLoaded();let a=this.getLayer(e);if(a){if(!t.aF(a.filter,r))return null==r?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(t.x.filter,`layers.${a.id}.filter`,r,null,i)||(a.filter=t.aC(r),this._updateLayer(a)))}else this.fire(new t.j(Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.aC(this.getLayer(e).filter)}setLayoutProperty(e,r,i,a={}){this._checkLoaded();let s=this.getLayer(e);s?t.aF(s.getLayoutProperty(r),i)||(s.setLayoutProperty(r,i,a),this._updateLayer(s)):this.fire(new t.j(Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){let i=this.getLayer(e);if(i)return i.getLayoutProperty(r);this.fire(new t.j(Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,i,a={}){this._checkLoaded();let s=this.getLayer(e);s?t.aF(s.getPaintProperty(r),i)||(s.setPaintProperty(r,i,a)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new t.j(Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,r){this._checkLoaded();let i=e.source,a=e.sourceLayer,s=this.sourceCaches[i];if(void 0===s)return void this.fire(new t.j(Error(`The source '${i}' does not exist in the map's style.`)));let n=s.getSource().type;"geojson"===n&&a?this.fire(new t.j(Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==n||a?(void 0===e.id&&this.fire(new t.j(Error("The feature id parameter must be provided."))),s.setFeatureState(a,e.id,r)):this.fire(new t.j(Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();let i=e.source,a=this.sourceCaches[i];if(void 0===a)return void this.fire(new t.j(Error(`The source '${i}' does not exist in the map's style.`)));let s=a.getSource().type,n="vector"===s?e.sourceLayer:void 0;"vector"!==s||n?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.j(Error("A feature id is required to remove its specific state property."))):a.removeFeatureState(n,e.id,r):this.fire(new t.j(Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();let r=e.source,i=e.sourceLayer,a=this.sourceCaches[r];if(void 0!==a)return"vector"!==a.getSource().type||i?(void 0===e.id&&this.fire(new t.j(Error("The feature id parameter must be provided."))),a.getFeatureState(i,e.id)):void this.fire(new t.j(Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.j(Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=t.aG(this.sourceCaches,e=>e.serialize()),r=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,a=this.stylesheet;return t.aH({version:a.version,name:a.name,metadata:a.metadata,light:a.light,sky:a.sky,center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,sprite:a.sprite,glyphs:a.glyphs,transition:a.transition,sources:e,layers:r,terrain:i},e=>void 0!==e)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let t=e=>"fill-extrusion"===this._layers[e].type,r={},i=[];for(let a=this._order.length-1;a>=0;a--){let s=this._order[a];if(t(s))for(let t of(r[s]=a,e)){let e=t[s];if(e)for(let t of e)i.push(t)}}i.sort((e,t)=>t.intersectionZ-e.intersectionZ);let a=[];for(let s=this._order.length-1;s>=0;s--){let n=this._order[s];if(t(n))for(let e=i.length-1;e>=0;e--){let t=i[e].feature;if(r[t.layer.id]<s)break;a.push(t),i.pop()}else for(let t of e){let e=t[n];if(e)for(let t of e)a.push(t.feature)}}return a}queryRenderedFeatures(e,r,i){r&&r.filter&&this._validate(t.x.filter,"queryRenderedFeatures.filter",r.filter,null,r);let a={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.j(Error("parameters.layers must be an Array."))),[];for(let e of r.layers){let r=this._layers[e];if(!r)return this.fire(new t.j(Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];a[r.source]=!0}}let s=[];r.availableImages=this._availableImages;let n=this._serializedAllLayers();for(let o in this.sourceCaches)r.layers&&!a[o]||s.push(function(e,r,i,a,s,n){let o=function(e,t,r){if(e)for(let i of e){let e=t[i];if(e&&e.source===r&&"fill-extrusion"===e.type)return!0}else for(let e in t){let i=t[e];if(i.source===r&&"fill-extrusion"===i.type)return!0}return!1}(s&&s.layers,r,e.id),l=n.maxPitchScaleFactor(),u=e.tilesIn(a,l,o);u.sort(U);let h=[];for(let a of u)h.push({wrappedTileID:a.tileID.wrapped().key,queryResults:a.tile.queryRenderedFeatures(r,i,e._state,a.queryGeometry,a.cameraQueryGeometry,a.scale,s,n,l,function(e,r){let i=t.H();return t.J(i,i,[1,1,0]),t.K(i,i,[.5*e.width,.5*e.height,1]),t.L(i,i,e.calculatePosMatrix(r.toUnwrapped()))}(e.transform,a.tileID))});let c=function(e){let t={},r={};for(let i of e){let e=i.queryResults,a=i.wrappedTileID,s=r[a]=r[a]||{};for(let r in e){let i=e[r],a=s[r]=s[r]||{},n=t[r]=t[r]||[];for(let e of i)a[e.featureIndex]||(a[e.featureIndex]=!0,n.push(e))}}return t}(h);for(let t in c)c[t].forEach(t=>{let r=t.feature,i=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i});return c}(this.sourceCaches[o],this._layers,n,e,r,i));return this.placement&&s.push(function(e,t,r,i,a,s,n){let o={},l=s.queryRenderedSymbols(i),u=[];for(let e of Object.keys(l).map(Number))u.push(n[e]);for(let r of(u.sort(U),u)){let i=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,a.filter,a.layers,a.availableImages,e);for(let e in i){let t=o[e]=o[e]||[],a=i[e];for(let e of(a.sort((e,t)=>{let i=r.featureSortOrder;if(i){let r=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}),a))t.push(e)}}for(let t in o)o[t].forEach(i=>{let a=i.feature,s=r[e[t].source].getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=s});return o}(this._layers,n,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(e,r){r&&r.filter&&this._validate(t.x.filter,"querySourceFeatures.filter",r.filter,null,r);let i=this.sourceCaches[e];return i?function(e,t){let r=e.getRenderableIds().map(t=>e.getTileByID(t)),i=[],a={};for(let e=0;e<r.length;e++){let s=r[e],n=s.tileID.canonical.key;a[n]||(a[n]=!0,s.querySourceFeatures(i,t))}return i}(i,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();let i=this.light.getLight(),a=!1;for(let r in e)if(!t.aF(e[r],i[r])){a=!0;break}if(!a)return;let s={now:c.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(s)}getSky(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.sky}setSky(e,r={}){let i=this.sky.getSky(),a=!1;for(let r in e||i&&(a=!0),e)if(!t.aF(e[r],i[r])){a=!0;break}if(!a)return;let s={now:c.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(s)}_validate(e,r,i,a,s={}){return(!s||!1!==s.validate)&&eX(this,e.call(t.x,t.e({key:r,style:this.serialize(),value:i,styleSpec:t.v},a)))}_remove(e=!0){for(let e in this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),en().off(ei,this._rtlPluginLoaded),this._layers)this._layers[e].setEventedParent(null);for(let e in this.sourceCaches){let t=this.sourceCaches[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,r,i,a=!1){let s=!1,n=!1,o={};for(let t of this._order){let r=this._layers[t];if("symbol"!==r.type)continue;if(!o[r.source]){let e=this.sourceCaches[r.source];o[r.source]=e.getRenderableIds(!0).map(t=>e.getTileByID(t)).sort((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1))}let i=this.crossTileSymbolIndex.addLayer(r,o[r.source],e.center.lng);s=s||i}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((a=a||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.now(),e.zoom))&&(this.pauseablePlacement=new eH(e,this.map.terrain,this._order,a,t,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,o),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.now()),n=!0),s&&this.pauseablePlacement.placement.setStale()),n||s)for(let e of this._order){let t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,o[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return t._(this,void 0,void 0,function*(){let e=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();let t=this.sourceCaches[r.source];return t&&t.setDependencies(r.tileID.key,r.type,r.icons),e})}getGlyphs(e,r){return t._(this,void 0,void 0,function*(){let e=yield this.glyphManager.getGlyphs(r.stacks),t=this.sourceCaches[r.source];return t&&t.setDependencies(r.tileID.key,r.type,[""]),e})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(t.x.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,i={},a){this._checkLoaded();let s=[{id:e,url:r}],n=[...A(this.stylesheet.sprite),...s];this._validate(t.x.sprite,"sprite",n,null,i)||(this.stylesheet.sprite=n,this._loadSprite(s,!0,a))}removeSprite(e){this._checkLoaded();let r=A(this.stylesheet.sprite);if(r.find(t=>t.id===e)){if(this._spritesImagesIds[e])for(let t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;r.splice(r.findIndex(t=>t.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}else this.fire(new t.j(Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return A(this.stylesheet.sprite)}setSprite(e,r={},i){this._checkLoaded(),e&&this._validate(t.x.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,i):(this._unloadSprite(),i&&i(null)))}}var eQ=t.Y([{name:"a_pos",type:"Int16",components:2}]);let e0={prelude:e1("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:e1("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:e1("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:e1("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:e1("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:e1("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:e1("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:e1("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:e1("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:e1("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:e1("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:e1("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:e1("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:e1("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:e1("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:e1("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:e1("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:e1("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:e1("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:e1("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:e1("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:e1("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:e1("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:e1("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:e1("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:e1("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:e1("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:e1("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:e1("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:e1("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function e1(e,t){let r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=t.match(/attribute ([\w]+) ([\w]+)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),n=s?s.concat(a):a,o={};return{fragmentSource:e=e.replace(r,(e,t,r,i,a)=>(o[a]=!0,"define"===t?`
#ifndef HAS_UNIFORM_u_${a}
varying ${r} ${i} ${a};
#else
uniform ${r} ${i} u_${a};
#endif
`:`
#ifdef HAS_UNIFORM_u_${a}
    ${r} ${i} ${a} = u_${a};
#endif
`)),vertexSource:t=t.replace(r,(e,t,r,i,a)=>{let s="float"===i?"vec2":"vec4",n=a.match(/color/)?"color":s;return o[a]?"define"===t?`
#ifndef HAS_UNIFORM_u_${a}
uniform lowp float u_${a}_t;
attribute ${r} ${s} a_${a};
varying ${r} ${i} ${a};
#else
uniform ${r} ${i} u_${a};
#endif
`:"vec4"===n?`
#ifndef HAS_UNIFORM_u_${a}
    ${a} = a_${a};
#else
    ${r} ${i} ${a} = u_${a};
#endif
`:`
#ifndef HAS_UNIFORM_u_${a}
    ${a} = unpack_mix_${n}(a_${a}, u_${a}_t);
#else
    ${r} ${i} ${a} = u_${a};
#endif
`:"define"===t?`
#ifndef HAS_UNIFORM_u_${a}
uniform lowp float u_${a}_t;
attribute ${r} ${s} a_${a};
#else
uniform ${r} ${i} u_${a};
#endif
`:"vec4"===n?`
#ifndef HAS_UNIFORM_u_${a}
    ${r} ${i} ${a} = a_${a};
#else
    ${r} ${i} ${a} = u_${a};
#endif
`:`
#ifndef HAS_UNIFORM_u_${a}
    ${r} ${i} ${a} = unpack_mix_${n}(a_${a}, u_${a}_t);
#else
    ${r} ${i} ${a} = u_${a};
#endif
`}),staticAttributes:i,staticUniforms:n}}class e2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,i,a,s,n,o,l){this.context=e;let u=this.boundPaintVertexBuffers.length!==i.length;for(let e=0;!u&&e<i.length;e++)this.boundPaintVertexBuffers[e]!==i[e]&&(u=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||u||this.boundIndexBuffer!==a||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==n||this.boundDynamicVertexBuffer2!==o||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,r,i,a,s,n,o,l):(e.bindVertexArray.set(this.vao),n&&n.bind(),a&&a.dynamicDraw&&a.bind(),o&&o.bind(),l&&l.bind())}freshBind(e,t,r,i,a,s,n,o){let l=e.numAttributes,u=this.context,h=u.gl;for(let l of(this.vao&&this.destroy(),this.vao=u.createVertexArray(),u.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=n,this.boundDynamicVertexBuffer3=o,t.enableAttributes(h,e),r))l.enableAttributes(h,e);for(let i of(s&&s.enableAttributes(h,e),n&&n.enableAttributes(h,e),o&&o.enableAttributes(h,e),t.bind(),t.setVertexAttribPointers(h,e,a),r))i.bind(),i.setVertexAttribPointers(h,e,a);s&&(s.bind(),s.setVertexAttribPointers(h,e,a)),i&&i.bind(),n&&(n.bind(),n.setVertexAttribPointers(h,e,a)),o&&(o.bind(),o.setVertexAttribPointers(h,e,a)),u.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let e5=(e,r,i,a,s)=>({u_matrix:e,u_texture:0,u_ele_delta:r,u_fog_matrix:i,u_fog_color:a?a.properties.get("fog-color"):t.aN.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:a?a.calculateFogBlendOpacity(s):0,u_horizon_color:a?a.properties.get("horizon-color"):t.aN.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1});function e3(e){let t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;let i=e[r].split(" ");t.push(i.pop())}return t}class e4{constructor(e,r,i,a,s,n){let o=e.gl;this.program=o.createProgram();let l=e3(r.staticAttributes),u=i?i.getBinderAttributes():[],h=l.concat(u),c=e0.prelude.staticUniforms?e3(e0.prelude.staticUniforms):[],d=r.staticUniforms?e3(r.staticUniforms):[],p=i?i.getBinderUniforms():[],f=c.concat(d).concat(p),m=[];for(let e of f)0>m.indexOf(e)&&m.push(e);let g=i?i.defines():[];s&&g.push("#define OVERDRAW_INSPECTOR;"),n&&g.push("#define TERRAIN3D;");let y=g.concat(e0.prelude.fragmentSource,r.fragmentSource).join("\n"),v=g.concat(e0.prelude.vertexSource,r.vertexSource).join("\n"),_=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(_,y),o.compileShader(_),!o.getShaderParameter(_,o.COMPILE_STATUS))throw Error(`Could not compile fragment shader: ${o.getShaderInfoLog(_)}`);o.attachShader(this.program,_);let x=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(x,v),o.compileShader(x),!o.getShaderParameter(x,o.COMPILE_STATUS))throw Error(`Could not compile vertex shader: ${o.getShaderInfoLog(x)}`);o.attachShader(this.program,x),this.attributes={};let b={};this.numAttributes=h.length;for(let e=0;e<this.numAttributes;e++)h[e]&&(o.bindAttribLocation(this.program,e,h[e]),this.attributes[h[e]]=e);if(o.linkProgram(this.program),!o.getProgramParameter(this.program,o.LINK_STATUS))throw Error(`Program failed to link: ${o.getProgramInfoLog(this.program)}`);o.deleteShader(x),o.deleteShader(_);for(let e=0;e<m.length;e++){let t=m[e];if(t&&!b[t]){let e=o.getUniformLocation(this.program,t);e&&(b[t]=e)}}this.fixedUniforms=a(e,b),this.terrainUniforms={u_depth:new t.aI(e,b.u_depth),u_terrain:new t.aI(e,b.u_terrain),u_terrain_dim:new t.aJ(e,b.u_terrain_dim),u_terrain_matrix:new t.aK(e,b.u_terrain_matrix),u_terrain_unpack:new t.aL(e,b.u_terrain_unpack),u_terrain_exaggeration:new t.aJ(e,b.u_terrain_exaggeration)},this.binderUniforms=i?i.getUniforms(e,b):[]}draw(e,t,r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y){let v=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(i),e.setColorMode(a),e.setCullFace(s),o)for(let t in e.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,o.depthTexture),e.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,o.texture),this.terrainUniforms)this.terrainUniforms[t].set(o[t]);for(let e in this.fixedUniforms)this.fixedUniforms[e].set(n[e]);f&&f.setUniforms(e,this.binderUniforms,d,{zoom:p});let _=0;switch(t){case v.LINES:_=2;break;case v.TRIANGLES:_=3;break;case v.LINE_STRIP:_=1}for(let r of c.get()){let i=r.vaos||(r.vaos={});(i[l]||(i[l]=new e2)).bind(e,this,u,f?f.getPaintVertexBuffers():[],h,r.vertexOffset,m,g,y),v.drawElements(t,r.primitiveLength*_,v.UNSIGNED_SHORT,r.primitiveOffset*_*2)}}}function e6(e,t,r){let i=1/eI(r,1,t.transform.tileZoom),a=Math.pow(2,r.tileID.overscaledZ),s=r.tileSize*Math.pow(2,t.transform.tileZoom)/a,n=s*(r.tileID.canonical.x+r.tileID.wrap*a),o=s*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[n>>16,o>>16],u_pixel_coord_lower:[65535&n,65535&o]}}let e8=(e,r,i,a)=>{var s,n,o,l,u,h,c;let d=r.style.light,p=d.properties.get("position"),f=[p.x,p.y,p.z],m=(s=new t.A(9),t.A!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s);"viewport"===d.properties.get("anchor")&&(o=Math.sin(n=-r.transform.angle),l=Math.cos(n),m[0]=l,m[1]=o,m[2]=0,m[3]=-o,m[4]=l,m[5]=0,m[6]=0,m[7]=0,m[8]=1),u=f[0],h=f[1],c=f[2],f[0]=u*m[0]+h*m[3]+c*m[6],f[1]=u*m[1]+h*m[4]+c*m[7],f[2]=u*m[2]+h*m[5]+c*m[8];let g=d.properties.get("color");return{u_matrix:e,u_lightpos:f,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+i,u_opacity:a}},e7=(e,r,i,a,s,n,o)=>t.e(e8(e,r,i,a),e6(n,r,o),{u_height_factor:-Math.pow(2,s.overscaledZ)/o.tileSize/8}),e9=e=>({u_matrix:e}),te=(e,r,i,a)=>t.e(e9(e),e6(i,r,a)),tt=(e,t)=>({u_matrix:e,u_world:t}),tr=(e,r,i,a,s)=>t.e(te(e,r,i,a),{u_world:s}),ti=(e,t,r,i)=>{let a,s;let n=e.transform;if("map"===i.paint.get("circle-pitch-alignment")){let e=eI(r,1,n.zoom);a=!0,s=[e,e]}else a=!1,s=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:s}},ta=(e,t,r)=>({u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}),ts=(e,t,r=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}),tn=e=>({u_matrix:e}),to=(e,t,r,i)=>({u_matrix:e,u_extrude_scale:eI(t,1,r),u_intensity:i}),tl=(e,t,r,i)=>{let a=e.transform;return{u_matrix:tp(e,t,r,i),u_ratio:1/eI(t,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},tu=(e,r,i,a,s)=>t.e(tl(e,r,i,s),{u_image:0,u_image_height:a}),th=(e,t,r,i,a)=>{let s=e.transform,n=td(t,s);return{u_matrix:tp(e,t,r,a),u_texsize:t.imageAtlasTexture.size,u_ratio:1/eI(t,1,s.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[n,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},tc=(e,r,i,a,s,n)=>{let o=e.lineAtlas,l=td(r,e.transform),u="round"===i.layout.get("line-cap"),h=o.getDash(a.from,u),c=o.getDash(a.to,u),d=h.width*s.fromScale,p=c.width*s.toScale;return t.e(tl(e,r,i,n),{u_patternscale_a:[l/d,-h.height/2],u_patternscale_b:[l/p,-c.height/2],u_sdfgamma:o.width/(256*Math.min(d,p)*e.pixelRatio)/2,u_image:0,u_tex_y_a:h.y,u_tex_y_b:c.y,u_mix:s.t})};function td(e,t){return 1/eI(e,1,t.tileZoom)}function tp(e,t,r,i){return e.translatePosMatrix(i?i.posMatrix:t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}let tf=(e,t,r,i,a)=>{var s,n;return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:(n=a.paint.get("raster-saturation"))>0?1-1/(1.001-n):-n,u_contrast_factor:(s=a.paint.get("raster-contrast"))>0?1/(1-s):1+s,u_spin_weights:function(e){let t=Math.sin(e*=Math.PI/180),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}(a.paint.get("raster-hue-rotate"))}},tm=(e,t,r,i,a,s,n,o,l,u,h,c,d,p)=>{let f=n.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:f.cameraToCenterDistance,u_pitch:f.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:f.width/f.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:l,u_coord_matrix:u,u_is_text:+c,u_pitch_with_map:+i,u_is_along_line:a,u_is_variable_anchor:s,u_texsize:d,u_texture:0,u_translation:h,u_pitched_scale:p}},tg=(e,r,i,a,s,n,o,l,u,h,c,d,p,f,m)=>{let g=o.transform;return t.e(tm(e,r,i,a,s,n,o,l,u,h,c,d,p,m),{u_gamma_scale:a?Math.cos(g._pitch)*g.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:+f})},ty=(e,r,i,a,s,n,o,l,u,h,c,d,p,f)=>t.e(tg(e,r,i,a,s,n,o,l,u,h,c,!0,d,!0,f),{u_texsize_icon:p,u_texture_icon:1}),tv=(e,t,r)=>({u_matrix:e,u_opacity:t,u_color:r}),t_=(e,r,i,a,s,n)=>t.e(function(e,t,r,i){let a=r.imageManager.getPattern(e.from.toString()),s=r.imageManager.getPattern(e.to.toString()),{width:n,height:o}=r.imageManager.getPixelSize(),l=Math.pow(2,i.tileID.overscaledZ),u=i.tileSize*Math.pow(2,r.transform.tileZoom)/l,h=u*(i.tileID.canonical.x+i.tileID.wrap*l),c=u*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:s.tl,u_pattern_br_b:s.br,u_texsize:[n,o],u_mix:t.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:s.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/eI(i,1,r.transform.tileZoom),u_pixel_coord_upper:[h>>16,c>>16],u_pixel_coord_lower:[65535&h,65535&c]}}(a,n,i,s),{u_matrix:e,u_opacity:r}),tx={fillExtrusion:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_lightpos:new t.aO(e,r.u_lightpos),u_lightintensity:new t.aJ(e,r.u_lightintensity),u_lightcolor:new t.aO(e,r.u_lightcolor),u_vertical_gradient:new t.aJ(e,r.u_vertical_gradient),u_opacity:new t.aJ(e,r.u_opacity)}),fillExtrusionPattern:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_lightpos:new t.aO(e,r.u_lightpos),u_lightintensity:new t.aJ(e,r.u_lightintensity),u_lightcolor:new t.aO(e,r.u_lightcolor),u_vertical_gradient:new t.aJ(e,r.u_vertical_gradient),u_height_factor:new t.aJ(e,r.u_height_factor),u_image:new t.aI(e,r.u_image),u_texsize:new t.aP(e,r.u_texsize),u_pixel_coord_upper:new t.aP(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.aP(e,r.u_pixel_coord_lower),u_scale:new t.aO(e,r.u_scale),u_fade:new t.aJ(e,r.u_fade),u_opacity:new t.aJ(e,r.u_opacity)}),fill:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix)}),fillPattern:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_image:new t.aI(e,r.u_image),u_texsize:new t.aP(e,r.u_texsize),u_pixel_coord_upper:new t.aP(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.aP(e,r.u_pixel_coord_lower),u_scale:new t.aO(e,r.u_scale),u_fade:new t.aJ(e,r.u_fade)}),fillOutline:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_world:new t.aP(e,r.u_world)}),fillOutlinePattern:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_world:new t.aP(e,r.u_world),u_image:new t.aI(e,r.u_image),u_texsize:new t.aP(e,r.u_texsize),u_pixel_coord_upper:new t.aP(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.aP(e,r.u_pixel_coord_lower),u_scale:new t.aO(e,r.u_scale),u_fade:new t.aJ(e,r.u_fade)}),circle:(e,r)=>({u_camera_to_center_distance:new t.aJ(e,r.u_camera_to_center_distance),u_scale_with_map:new t.aI(e,r.u_scale_with_map),u_pitch_with_map:new t.aI(e,r.u_pitch_with_map),u_extrude_scale:new t.aP(e,r.u_extrude_scale),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_matrix:new t.aK(e,r.u_matrix)}),collisionBox:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_pixel_extrude_scale:new t.aP(e,r.u_pixel_extrude_scale)}),collisionCircle:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_inv_matrix:new t.aK(e,r.u_inv_matrix),u_camera_to_center_distance:new t.aJ(e,r.u_camera_to_center_distance),u_viewport_size:new t.aP(e,r.u_viewport_size)}),debug:(e,r)=>({u_color:new t.aM(e,r.u_color),u_matrix:new t.aK(e,r.u_matrix),u_overlay:new t.aI(e,r.u_overlay),u_overlay_scale:new t.aJ(e,r.u_overlay_scale)}),clippingMask:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix)}),heatmap:(e,r)=>({u_extrude_scale:new t.aJ(e,r.u_extrude_scale),u_intensity:new t.aJ(e,r.u_intensity),u_matrix:new t.aK(e,r.u_matrix)}),heatmapTexture:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_world:new t.aP(e,r.u_world),u_image:new t.aI(e,r.u_image),u_color_ramp:new t.aI(e,r.u_color_ramp),u_opacity:new t.aJ(e,r.u_opacity)}),hillshade:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_image:new t.aI(e,r.u_image),u_latrange:new t.aP(e,r.u_latrange),u_light:new t.aP(e,r.u_light),u_shadow:new t.aM(e,r.u_shadow),u_highlight:new t.aM(e,r.u_highlight),u_accent:new t.aM(e,r.u_accent)}),hillshadePrepare:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_image:new t.aI(e,r.u_image),u_dimension:new t.aP(e,r.u_dimension),u_zoom:new t.aJ(e,r.u_zoom),u_unpack:new t.aL(e,r.u_unpack)}),line:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_ratio:new t.aJ(e,r.u_ratio),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.aP(e,r.u_units_to_pixels)}),lineGradient:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_ratio:new t.aJ(e,r.u_ratio),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.aP(e,r.u_units_to_pixels),u_image:new t.aI(e,r.u_image),u_image_height:new t.aJ(e,r.u_image_height)}),linePattern:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_texsize:new t.aP(e,r.u_texsize),u_ratio:new t.aJ(e,r.u_ratio),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_image:new t.aI(e,r.u_image),u_units_to_pixels:new t.aP(e,r.u_units_to_pixels),u_scale:new t.aO(e,r.u_scale),u_fade:new t.aJ(e,r.u_fade)}),lineSDF:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_ratio:new t.aJ(e,r.u_ratio),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.aP(e,r.u_units_to_pixels),u_patternscale_a:new t.aP(e,r.u_patternscale_a),u_patternscale_b:new t.aP(e,r.u_patternscale_b),u_sdfgamma:new t.aJ(e,r.u_sdfgamma),u_image:new t.aI(e,r.u_image),u_tex_y_a:new t.aJ(e,r.u_tex_y_a),u_tex_y_b:new t.aJ(e,r.u_tex_y_b),u_mix:new t.aJ(e,r.u_mix)}),raster:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_tl_parent:new t.aP(e,r.u_tl_parent),u_scale_parent:new t.aJ(e,r.u_scale_parent),u_buffer_scale:new t.aJ(e,r.u_buffer_scale),u_fade_t:new t.aJ(e,r.u_fade_t),u_opacity:new t.aJ(e,r.u_opacity),u_image0:new t.aI(e,r.u_image0),u_image1:new t.aI(e,r.u_image1),u_brightness_low:new t.aJ(e,r.u_brightness_low),u_brightness_high:new t.aJ(e,r.u_brightness_high),u_saturation_factor:new t.aJ(e,r.u_saturation_factor),u_contrast_factor:new t.aJ(e,r.u_contrast_factor),u_spin_weights:new t.aO(e,r.u_spin_weights)}),symbolIcon:(e,r)=>({u_is_size_zoom_constant:new t.aI(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aI(e,r.u_is_size_feature_constant),u_size_t:new t.aJ(e,r.u_size_t),u_size:new t.aJ(e,r.u_size),u_camera_to_center_distance:new t.aJ(e,r.u_camera_to_center_distance),u_pitch:new t.aJ(e,r.u_pitch),u_rotate_symbol:new t.aI(e,r.u_rotate_symbol),u_aspect_ratio:new t.aJ(e,r.u_aspect_ratio),u_fade_change:new t.aJ(e,r.u_fade_change),u_matrix:new t.aK(e,r.u_matrix),u_label_plane_matrix:new t.aK(e,r.u_label_plane_matrix),u_coord_matrix:new t.aK(e,r.u_coord_matrix),u_is_text:new t.aI(e,r.u_is_text),u_pitch_with_map:new t.aI(e,r.u_pitch_with_map),u_is_along_line:new t.aI(e,r.u_is_along_line),u_is_variable_anchor:new t.aI(e,r.u_is_variable_anchor),u_texsize:new t.aP(e,r.u_texsize),u_texture:new t.aI(e,r.u_texture),u_translation:new t.aP(e,r.u_translation),u_pitched_scale:new t.aJ(e,r.u_pitched_scale)}),symbolSDF:(e,r)=>({u_is_size_zoom_constant:new t.aI(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aI(e,r.u_is_size_feature_constant),u_size_t:new t.aJ(e,r.u_size_t),u_size:new t.aJ(e,r.u_size),u_camera_to_center_distance:new t.aJ(e,r.u_camera_to_center_distance),u_pitch:new t.aJ(e,r.u_pitch),u_rotate_symbol:new t.aI(e,r.u_rotate_symbol),u_aspect_ratio:new t.aJ(e,r.u_aspect_ratio),u_fade_change:new t.aJ(e,r.u_fade_change),u_matrix:new t.aK(e,r.u_matrix),u_label_plane_matrix:new t.aK(e,r.u_label_plane_matrix),u_coord_matrix:new t.aK(e,r.u_coord_matrix),u_is_text:new t.aI(e,r.u_is_text),u_pitch_with_map:new t.aI(e,r.u_pitch_with_map),u_is_along_line:new t.aI(e,r.u_is_along_line),u_is_variable_anchor:new t.aI(e,r.u_is_variable_anchor),u_texsize:new t.aP(e,r.u_texsize),u_texture:new t.aI(e,r.u_texture),u_gamma_scale:new t.aJ(e,r.u_gamma_scale),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_is_halo:new t.aI(e,r.u_is_halo),u_translation:new t.aP(e,r.u_translation),u_pitched_scale:new t.aJ(e,r.u_pitched_scale)}),symbolTextAndIcon:(e,r)=>({u_is_size_zoom_constant:new t.aI(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aI(e,r.u_is_size_feature_constant),u_size_t:new t.aJ(e,r.u_size_t),u_size:new t.aJ(e,r.u_size),u_camera_to_center_distance:new t.aJ(e,r.u_camera_to_center_distance),u_pitch:new t.aJ(e,r.u_pitch),u_rotate_symbol:new t.aI(e,r.u_rotate_symbol),u_aspect_ratio:new t.aJ(e,r.u_aspect_ratio),u_fade_change:new t.aJ(e,r.u_fade_change),u_matrix:new t.aK(e,r.u_matrix),u_label_plane_matrix:new t.aK(e,r.u_label_plane_matrix),u_coord_matrix:new t.aK(e,r.u_coord_matrix),u_is_text:new t.aI(e,r.u_is_text),u_pitch_with_map:new t.aI(e,r.u_pitch_with_map),u_is_along_line:new t.aI(e,r.u_is_along_line),u_is_variable_anchor:new t.aI(e,r.u_is_variable_anchor),u_texsize:new t.aP(e,r.u_texsize),u_texsize_icon:new t.aP(e,r.u_texsize_icon),u_texture:new t.aI(e,r.u_texture),u_texture_icon:new t.aI(e,r.u_texture_icon),u_gamma_scale:new t.aJ(e,r.u_gamma_scale),u_device_pixel_ratio:new t.aJ(e,r.u_device_pixel_ratio),u_is_halo:new t.aI(e,r.u_is_halo),u_translation:new t.aP(e,r.u_translation),u_pitched_scale:new t.aJ(e,r.u_pitched_scale)}),background:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_opacity:new t.aJ(e,r.u_opacity),u_color:new t.aM(e,r.u_color)}),backgroundPattern:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_opacity:new t.aJ(e,r.u_opacity),u_image:new t.aI(e,r.u_image),u_pattern_tl_a:new t.aP(e,r.u_pattern_tl_a),u_pattern_br_a:new t.aP(e,r.u_pattern_br_a),u_pattern_tl_b:new t.aP(e,r.u_pattern_tl_b),u_pattern_br_b:new t.aP(e,r.u_pattern_br_b),u_texsize:new t.aP(e,r.u_texsize),u_mix:new t.aJ(e,r.u_mix),u_pattern_size_a:new t.aP(e,r.u_pattern_size_a),u_pattern_size_b:new t.aP(e,r.u_pattern_size_b),u_scale_a:new t.aJ(e,r.u_scale_a),u_scale_b:new t.aJ(e,r.u_scale_b),u_pixel_coord_upper:new t.aP(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.aP(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.aJ(e,r.u_tile_units_to_pixels)}),terrain:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_texture:new t.aI(e,r.u_texture),u_ele_delta:new t.aJ(e,r.u_ele_delta),u_fog_matrix:new t.aK(e,r.u_fog_matrix),u_fog_color:new t.aM(e,r.u_fog_color),u_fog_ground_blend:new t.aJ(e,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new t.aJ(e,r.u_fog_ground_blend_opacity),u_horizon_color:new t.aM(e,r.u_horizon_color),u_horizon_fog_blend:new t.aJ(e,r.u_horizon_fog_blend)}),terrainDepth:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_ele_delta:new t.aJ(e,r.u_ele_delta)}),terrainCoords:(e,r)=>({u_matrix:new t.aK(e,r.u_matrix),u_texture:new t.aI(e,r.u_texture),u_terrain_coords_id:new t.aJ(e,r.u_terrain_coords_id),u_ele_delta:new t.aJ(e,r.u_ele_delta)}),sky:(e,r)=>({u_sky_color:new t.aM(e,r.u_sky_color),u_horizon_color:new t.aM(e,r.u_horizon_color),u_horizon:new t.aJ(e,r.u_horizon),u_sky_horizon_blend:new t.aJ(e,r.u_sky_horizon_blend)})};class tb{constructor(e,t,r){this.context=e;let i=e.gl;this.buffer=i.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let t=this.context.gl;if(!this.dynamicDraw)throw Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let tS={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tw{constructor(e,t,r,i){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=i,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){let i=t.attributes[this.attributes[r].name];void 0!==i&&e.enableVertexAttribArray(i)}}setVertexAttribPointers(e,t,r){for(let i=0;i<this.attributes.length;i++){let a=this.attributes[i],s=t.attributes[a.name];void 0!==s&&e.vertexAttribPointer(s,a.components,e[tS[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let tE=new WeakMap;function tA(e){var t;if(tE.has(e))return tE.get(e);{let r=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return tE.set(e,r),r}}class tT{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class tC extends tT{getDefault(){return t.aN.transparent}set(e){let t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tP extends tT{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class tR extends tT{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class tI extends tT{getDefault(){return[!0,!0,!0,!0]}set(e){let t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class tL extends tT{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class tO extends tT{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class tM extends tT{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class tk extends tT{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class tN extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class tD extends tT{getDefault(){return[0,1]}set(e){let t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class tF extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class tG extends tT{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class tz extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class tq extends tT{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class tj extends tT{getDefault(){return t.aN.transparent}set(e){let t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tB extends tT{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class tU extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class tH extends tT{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class tZ extends tT{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class tV extends tT{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class tY extends tT{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class tW extends tT{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class t$ extends tT{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class tX extends tT{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class tK extends tT{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class tJ extends tT{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class tQ extends tT{getDefault(){return null}set(e){let t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class t0 extends tT{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;let r=this.gl;tA(r)?r.bindVertexArray(e):null===(t=r.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class t1 extends tT{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class t2 extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class t5 extends tT{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class t3 extends tT{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class t4 extends t3{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class t6 extends t3{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class t8 extends t3{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class t7{constructor(e,t,r,i,a){this.context=e,this.width=t,this.height=r;let s=e.gl,n=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new t4(e,n),i)this.depthAttachment=a?new t8(e,n):new t6(e,n);else if(a)throw Error("Stencil cannot be set without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){let t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class t9{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}t9.Replace=[1,0],t9.disabled=new t9(t9.Replace,t.aN.transparent,[!1,!1,!1,!1]),t9.unblended=new t9(t9.Replace,t.aN.transparent,[!0,!0,!0,!0]),t9.alphaBlended=new t9([1,771],t.aN.transparent,[!0,!0,!0,!0]);class re{constructor(e){var t,r;if(this.gl=e,this.clearColor=new tC(this),this.clearDepth=new tP(this),this.clearStencil=new tR(this),this.colorMask=new tI(this),this.depthMask=new tL(this),this.stencilMask=new tO(this),this.stencilFunc=new tM(this),this.stencilOp=new tk(this),this.stencilTest=new tN(this),this.depthRange=new tD(this),this.depthTest=new tF(this),this.depthFunc=new tG(this),this.blend=new tz(this),this.blendFunc=new tq(this),this.blendColor=new tj(this),this.blendEquation=new tB(this),this.cullFace=new tU(this),this.cullFaceSide=new tH(this),this.frontFace=new tZ(this),this.program=new tV(this),this.activeTexture=new tY(this),this.viewport=new tW(this),this.bindFramebuffer=new t$(this),this.bindRenderbuffer=new tX(this),this.bindTexture=new tK(this),this.bindVertexBuffer=new tJ(this),this.bindElementBuffer=new tQ(this),this.bindVertexArray=new t0(this),this.pixelStoreUnpack=new t1(this),this.pixelStoreUnpackPremultiplyAlpha=new t2(this),this.pixelStoreUnpackFlipY=new t5(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),tA(e)){this.HALF_FLOAT=e.HALF_FLOAT;let i=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==i?void 0:i.RGBA16F_EXT,this.RGB16F=null!==(r=e.RGB16F)&&void 0!==r?r:null==i?void 0:i.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new tb(this,e,t)}createVertexBuffer(e,t,r){return new tw(this,e,t,r)}createRenderbuffer(e,t,r){let i=this.gl,a=i.createRenderbuffer();return this.bindRenderbuffer.set(a),i.renderbufferStorage(i.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),a}createFramebuffer(e,t,r,i){return new t7(this,e,t,r,i)}clear({color:e,depth:t,stencil:r}){let i=this.gl,a=0;e&&(a|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(a|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==r&&(a|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),i.clear(a)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.aF(e.blendFunction,t9.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return tA(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return tA(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class rt{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}rt.ReadOnly=!1,rt.ReadWrite=!0,rt.disabled=new rt(519,rt.ReadOnly,[0,1]);class rr{constructor(e,t,r,i,a,s){this.test=e,this.ref=t,this.mask=r,this.fail=i,this.depthFail=a,this.pass=s}}rr.disabled=new rr({func:519,mask:0},0,0,7680,7680,7680);class ri{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}function ra(e,r,i,a,s){var n;let l=e.context,u=l.gl,h=e.useProgram("collisionBox"),c=[],d=0,p=0;for(let o=0;o<a.length;o++){let f=a[o],m=r.getTile(f).getBucket(i);if(!m)continue;let g=s?m.textCollisionBox:m.iconCollisionBox,y=m.collisionCircleArray;if(y.length>0){let r=t.H();t.aR(r,m.placementInvProjMatrix,e.transform.glCoordMatrix),t.aR(r,r,m.placementViewportMatrix),c.push({circleArray:y,circleOffset:p,transform:f.posMatrix,invTransform:r,coord:f}),d+=y.length/4,p=d}g&&h.draw(l,u.LINES,rt.disabled,rr.disabled,e.colorModeForRenderPass(),ri.disabled,{u_matrix:f.posMatrix,u_pixel_extrude_scale:[1/(n=e.transform).width,1/n.height]},e.style.map.terrain&&e.style.map.terrain.getTerrainData(f),i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,null,e.transform.zoom,null,null,g.collisionVertexBuffer)}if(!s||!c.length)return;let f=e.useProgram("collisionCircle"),m=new t.aS;m.resize(4*d),m._trim();let g=0;for(let e of c)for(let t=0;t<e.circleArray.length/4;t++){let r=4*t,i=e.circleArray[r+0],a=e.circleArray[r+1],s=e.circleArray[r+2],n=e.circleArray[r+3];m.emplace(g++,i,a,s,n,0),m.emplace(g++,i,a,s,n,1),m.emplace(g++,i,a,s,n,2),m.emplace(g++,i,a,s,n,3)}(!o||o.length<2*d)&&(o=function(e){let r=2*e,i=new t.aU;i.resize(r),i._trim();for(let e=0;e<r;e++){let t=6*e;i.uint16[t+0]=4*e+0,i.uint16[t+1]=4*e+1,i.uint16[t+2]=4*e+2,i.uint16[t+3]=4*e+2,i.uint16[t+4]=4*e+3,i.uint16[t+5]=4*e+0}return i}(d));let y=l.createIndexBuffer(o,!0),v=l.createVertexBuffer(m,t.aT.members,!0);for(let r of c){let a=ta(r.transform,r.invTransform,e.transform);f.draw(l,u.TRIANGLES,rt.disabled,rr.disabled,e.colorModeForRenderPass(),ri.disabled,a,e.style.map.terrain&&e.style.map.terrain.getTerrainData(r.coord),i.id,v,y,t.a0.simpleSegment(0,2*r.circleOffset,r.circleArray.length,r.circleArray.length/2),null,e.transform.zoom,null,null,null)}v.destroy(),y.destroy()}ri.disabled=new ri(!1,1029,2305),ri.backCCW=new ri(!0,1029,2305);let rs=t.ao(new Float32Array(16));function rn(e,r,i,a,s,n,o,l,u,h,c,d){let p=e.context,f=p.gl,m=e.transform,g=eB(),y="map"===l,v="map"===u,_="viewport"!==l&&"point"!==i.layout.get("symbol-placement"),x=y&&!v&&!_,b=!v&&_,S=!i.layout.get("symbol-sort-key").isConstant(),w=!1,E=e.depthModeForSublayer(0,rt.ReadOnly),A=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),T=[],C=g.getCircleRadiusCorrection(m);for(let l of a){let a=r.getTile(l),u=a.getBucket(i);if(!u)continue;let c=s?u.text:u.icon;if(!c||!c.segments.get().length||!c.hasVisibleVertices)continue;let d=c.programConfigurations.get(i.id),p=s||u.sdfIcons,E=s?u.textSizeData:u.iconSizeData,P=v||0!==m.pitch,R=e.useProgram(u.iconsInText&&s?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon",d),I=t.ah(E,m.zoom),L=e.style.map.terrain&&e.style.map.terrain.getTerrainData(l),O,M,k,N,D=[0,0],F=null;if(s)M=a.glyphAtlasTexture,k=f.LINEAR,O=a.glyphAtlasTexture.size,u.iconsInText&&(D=a.imageAtlasTexture.size,F=a.imageAtlasTexture,N=P||e.options.rotating||e.options.zooming||"composite"===E.kind||"camera"===E.kind?f.LINEAR:f.NEAREST);else{let t=1!==i.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;M=a.imageAtlasTexture,k=p||e.options.rotating||e.options.zooming||t||P?f.LINEAR:f.NEAREST,O=a.imageAtlasTexture.size}let G=eI(a,1,e.transform.zoom),z=b?l.posMatrix:rs,q=eg(z,v,y,e.transform,G),j=ey(z,v,y,e.transform,G),B=ey(l.posMatrix,v,y,e.transform,G),U=g.translatePosition(e.transform,a,n,o),H=A&&u.hasTextData(),Z="none"!==i.layout.get("icon-text-fit")&&H&&u.hasIconData();if(_){let r=e.style.map.terrain?(t,r)=>e.style.map.terrain.getElevation(l,t,r):null,a="map"===i.layout.get("text-rotation-alignment");!function(e,r,i,a,s,n,o,l,u,h,c,d,p,f,m){let g=a?e.textSizeData:e.iconSizeData,y=t.ah(g,i.transform.zoom),v=[256/i.width*2+1,256/i.height*2+1],_=a?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;_.clear();let x=e.lineVertexArray,b=a?e.text.placedSymbolArray:e.icon.placedSymbolArray,S=i.transform.width/i.transform.height,w=!1;for(let a=0;a<b.length;a++){var E;let A=b.get(a);if(A.hidden||A.writingMode===t.ai.vertical&&!w){eP(A.numGlyphs,_);continue}w=!1;let T=ev(new t.P(A.anchorX,A.anchorY),r,m);if(!((E=T.point).x>=-v[0]&&E.x<=v[0]&&E.y>=-v[1])||!(E.y<=v[1])){eP(A.numGlyphs,_);continue}let C=.5+i.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5,P=t.aj(g,y,A),R=o?P/C:P*C,I={getElevation:m,labelPlaneMatrix:s,lineVertexArray:x,pitchWithMap:o,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:h,tileAnchorPoint:new t.P(A.anchorX,A.anchorY),unwrappedTileID:c,width:d,height:p,translation:f},L=eb(I,A,R,!1,l,r,n,e.glyphOffsetArray,_,S,u);w=L.useVertical,(L.notEnoughRoom||w||L.needsFlipping&&eb(I,A,R,!0,l,r,n,e.glyphOffsetArray,_,S,u).notEnoughRoom)&&eP(A.numGlyphs,_)}a?e.text.dynamicLayoutVertexBuffer.updateData(_):e.icon.dynamicLayoutVertexBuffer.updateData(_)}(u,l.posMatrix,e,s,q,B,v,h,a,g,l.toUnwrapped(),m.width,m.height,U,r)}let V=l.posMatrix,Y=s&&A||Z,W=_||Y?rs:q,$=p&&0!==i.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1),X={program:R,buffers:c,uniformValues:p?u.iconsInText?ty(E.kind,I,x,v,_,Y,e,V,W,j,U,O,D,C):tg(E.kind,I,x,v,_,Y,e,V,W,j,U,s,O,!0,C):tm(E.kind,I,x,v,_,Y,e,V,W,j,U,s,O,C),atlasTexture:M,atlasTextureIcon:F,atlasInterpolation:k,atlasInterpolationIcon:N,isSDF:p,hasHalo:$};if(S&&u.canOverlap)for(let e of(w=!0,c.segments.get()))T.push({segments:new t.a0([e]),sortKey:e.sortKey,state:X,terrainData:L});else T.push({segments:c.segments,sortKey:0,state:X,terrainData:L})}for(let t of(w&&T.sort((e,t)=>e.sortKey-t.sortKey),T)){let r=t.state;if(p.activeTexture.set(f.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,f.CLAMP_TO_EDGE),r.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),r.isSDF){let a=r.uniformValues;r.hasHalo&&(a.u_is_halo=1,ro(r.buffers,t.segments,i,e,r.program,E,c,d,a,t.terrainData)),a.u_is_halo=0}ro(r.buffers,t.segments,i,e,r.program,E,c,d,r.uniformValues,t.terrainData)}}function ro(e,t,r,i,a,s,n,o,l,u){let h=i.context;a.draw(h,h.gl.TRIANGLES,s,n,o,ri.disabled,l,u,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,i.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function rl(e,t,r,i,a){if(!r||!i||!i.imageAtlas)return;let s=i.imageAtlas.patternPositions,n=s[r.to.toString()],o=s[r.from.toString()];if(!n&&o&&(n=o),!o&&n&&(o=n),!n||!o){let e=a.getPaintProperty(t);n=s[e],o=s[e]}n&&o&&e.setConstantPatternPositions(n,o)}function ru(e,t,r,i,a,s,n){let o,l,u,h,c;let d=e.context.gl,p="fill-pattern",f=r.paint.get(p),m=f&&f.constantOr(1),g=r.getCrossfadeParameters();n?(l=m&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",o=d.LINES):(l=m?"fillPattern":"fill",o=d.TRIANGLES);let y=f.constantOr(null);for(let f of i){let i=t.getTile(f);if(m&&!i.patternsLoaded())continue;let v=i.getBucket(r);if(!v)continue;let _=v.programConfigurations.get(r.id),x=e.useProgram(l,_),b=e.style.map.terrain&&e.style.map.terrain.getTerrainData(f);m&&(e.context.activeTexture.set(d.TEXTURE0),i.imageAtlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),_.updatePaintBuffers(g)),rl(_,p,y,i,r);let S=b?f:null,w=e.translatePosMatrix(S?S.posMatrix:f.posMatrix,i,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(n){h=v.indexBuffer2,c=v.segments2;let t=[d.drawingBufferWidth,d.drawingBufferHeight];u="fillOutlinePattern"===l&&m?tr(w,e,g,i,t):tt(w,t)}else h=v.indexBuffer,c=v.segments,u=m?te(w,e,g,i):e9(w);x.draw(e.context,o,a,e.stencilModeForClipping(f),s,ri.disabled,u,b,r.id,v.layoutVertexBuffer,h,c,r.paint,e.transform.zoom,_)}}function rh(e,t,r,i,a,s,n){let o=e.context,l=o.gl,u="fill-extrusion-pattern",h=r.paint.get(u),c=h.constantOr(1),d=r.getCrossfadeParameters(),p=r.paint.get("fill-extrusion-opacity"),f=h.constantOr(null);for(let h of i){let i=t.getTile(h),m=i.getBucket(r);if(!m)continue;let g=e.style.map.terrain&&e.style.map.terrain.getTerrainData(h),y=m.programConfigurations.get(r.id),v=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",y);c&&(e.context.activeTexture.set(l.TEXTURE0),i.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(d)),rl(y,u,f,i,r);let _=e.translatePosMatrix(h.posMatrix,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),x=r.paint.get("fill-extrusion-vertical-gradient"),b=c?e7(_,e,x,p,h,d,i):e8(_,e,x,p);v.draw(o,o.gl.TRIANGLES,a,s,n,ri.backCCW,b,g,r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,r.paint,e.transform.zoom,y,e.style.map.terrain&&m.centroidVertexBuffer)}}let rc=new t.aN(1,0,0,1),rd=new t.aN(0,1,0,1),rp=new t.aN(0,0,1,1),rf=new t.aN(1,0,1,1),rm=new t.aN(0,1,1,1);function rg(e,t,r,i){rv(e,0,t+r/2,e.transform.width,r,i)}function ry(e,t,r,i){rv(e,t-r/2,0,r,e.transform.height,i)}function rv(e,t,r,i,a,s){let n=e.context,o=n.gl;o.enable(o.SCISSOR_TEST),o.scissor(t*e.pixelRatio,r*e.pixelRatio,i*e.pixelRatio,a*e.pixelRatio),n.clear({color:s}),o.disable(o.SCISSOR_TEST)}function r_(e,t,r){let i=e.context,a=i.gl,s=e.colorModeForRenderPass(),n=new rt(a.LEQUAL,rt.ReadWrite,e.depthRangeFor3D),o=e.useProgram("terrain"),l=t.getTerrainMesh();for(let u of(i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height]),r)){let r=e.renderToTexture.getTexture(u),h=t.getTerrainData(u.tileID);i.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r.texture);let c=e5(e.transform.calculatePosMatrix(u.tileID.toUnwrapped()),t.getMeshFrameDelta(e.transform.zoom),e.transform.calculateFogMatrix(u.tileID.toUnwrapped()),e.style.sky,e.transform.pitch);o.draw(i,a.TRIANGLES,n,rr.disabled,s,ri.backCCW,c,h,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class rx{constructor(e,t,r){this.vertexBuffer=e,this.indexBuffer=t,this.segments=r}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class rb{constructor(e,r){this.context=new re(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.ao(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=eh.maxUnderzooming+eh.maxOverzooming+1,this.depthEpsilon=1/65536,this.crossTileSymbolIndex=new e$}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let e of this.style._order)this.style._layers[e].resize()}setup(){let e=this.context,r=new t.aX;r.emplaceBack(0,0),r.emplaceBack(t.X,0),r.emplaceBack(0,t.X),r.emplaceBack(t.X,t.X),this.tileExtentBuffer=e.createVertexBuffer(r,eQ.members),this.tileExtentSegments=t.a0.simpleSegment(0,0,4,2);let i=new t.aX;i.emplaceBack(0,0),i.emplaceBack(t.X,0),i.emplaceBack(0,t.X),i.emplaceBack(t.X,t.X),this.debugBuffer=e.createVertexBuffer(i,eQ.members),this.debugSegments=t.a0.simpleSegment(0,0,4,5);let a=new t.$;a.emplaceBack(0,0,0,0),a.emplaceBack(t.X,0,t.X,0),a.emplaceBack(0,t.X,0,t.X),a.emplaceBack(t.X,t.X,t.X,t.X),this.rasterBoundsBuffer=e.createVertexBuffer(a,K.members),this.rasterBoundsSegments=t.a0.simpleSegment(0,0,4,2);let s=new t.aX;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(s,eQ.members),this.viewportSegments=t.a0.simpleSegment(0,0,4,2);let n=new t.aZ;n.emplaceBack(0),n.emplaceBack(1),n.emplaceBack(3),n.emplaceBack(2),n.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(n);let o=new t.aY;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(o);let l=this.context.gl;this.stencilClearMode=new rr({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){let e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let i=t.H();t.aQ(i,0,this.width,this.height,0,0,1),t.K(i,i,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,rt.disabled,this.stencilClearMode,t9.disabled,ri.disabled,tn(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;let r=this.context,i=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(t9.disabled),r.setDepthMode(rt.disabled);let a=this.useProgram("clippingMask");for(let e of(this._tileClippingMaskIDs={},t)){let t=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,s=this.style.map.terrain&&this.style.map.terrain.getTerrainData(e);a.draw(r,i.TRIANGLES,rt.disabled,new rr({func:i.ALWAYS,mask:0},t,255,i.KEEP,i.KEEP,i.REPLACE),t9.disabled,ri.disabled,tn(e.posMatrix),s,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,t=this.context.gl;return new rr({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){let t=this.context.gl;return new rr({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){let t=this.context.gl,r=e.sort((e,t)=>t.overscaledZ-e.overscaledZ),i=r[r.length-1].overscaledZ,a=r[0].overscaledZ-i+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let e={};for(let r=0;r<a;r++)e[r+i]=new rr({func:t.GEQUAL,mask:255},r+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=a,[e,r]}return[{[i]:rr.disabled},r]}colorModeForRenderPass(){let e=this.context.gl;if(this._showOverdrawInspector){let r=1/8;return new t9([e.CONSTANT_COLOR,e.ONE],new t.aN(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t9.unblended:t9.alphaBlended}depthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return rt.disabled;let i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new rt(r||this.context.gl.LEQUAL,t,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(c.now()),this.imageManager.beginFrame();let i=this.style._order,a=this.style.sourceCaches,s={},n={},o={};for(let e in a){let t=a[e];t.used&&t.prepare(this.context),s[e]=t.getVisibleCoordinates(),n[e]=s[e].slice().reverse(),o[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<i.length;e++)if(this.style._layers[i[e]].is3D()){this.opaquePassCutoff=e;break}for(let e of(this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen",i)){let t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;let r=n[t.source];("custom"===t.type||r.length)&&this.renderLayer(this,a[t.source],t,r)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.aN.black:t.aN.transparent,depth:1}),this.clearStencil(),this.style.stylesheet.sky&&function(e,r){var i,a;let s=e.context,n=s.gl,o=(i=e.style.map.transform,a=e.pixelRatio,{u_sky_color:r.properties.get("sky-color"),u_horizon_color:r.properties.get("horizon-color"),u_horizon:(i.height/2+i.getHorizon())*a,u_sky_horizon_blend:r.properties.get("sky-horizon-blend")*i.height/2*a}),l=new rt(n.LEQUAL,rt.ReadWrite,[0,1]),u=rr.disabled,h=e.colorModeForRenderPass(),c=e.useProgram("sky");if(!r.mesh){let e=new t.aX;e.emplaceBack(-1,-1),e.emplaceBack(1,-1),e.emplaceBack(1,1),e.emplaceBack(-1,1);let i=new t.aY;i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),r.mesh=new rx(s.createVertexBuffer(e,eQ.members),s.createIndexBuffer(i),t.a0.simpleSegment(0,0,e.length,i.length))}c.draw(s,n.TRIANGLES,l,u,h,ri.disabled,o,void 0,"sky",r.mesh.vertexBuffer,r.mesh.indexBuffer,r.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){let e=this.style._layers[i[this.currentLayer]],t=a[e.source],r=s[e.source];this._renderTileClippingMasks(e,r),this.renderLayer(this,t,e,r)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){let e=this.style._layers[i[this.currentLayer]],t=a[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e))continue;let r=("symbol"===e.type?o:n)[e.source];this._renderTileClippingMasks(e,s[e.source]),this.renderLayer(this,t,e,r)}if(this.options.showTileBoundaries){let e=function(e,t){let r=null,i=Object.values(e._layers).flatMap(r=>r.source&&!r.isHidden(t)?[e.sourceCaches[r.source]]:[]),a=i.filter(e=>"vector"===e.getSource().type),s=i.filter(e=>"vector"!==e.getSource().type),n=e=>{(!r||r.getSource().maxzoom<e.getSource().maxzoom)&&(r=e)};return a.forEach(e=>n(e)),r||s.forEach(e=>n(e)),r}(this.style,this.transform.zoom);e&&function(e,r,i){for(let a=0;a<i.length;a++)!function(e,r,i){let a=e.context,s=a.gl,n=i.posMatrix,o=e.useProgram("debug"),l=rt.disabled,u=rr.disabled,h=e.colorModeForRenderPass(),c="$debug",d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(i);a.activeTexture.set(s.TEXTURE0);let p=r.getTileByID(i.key).latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),m=512/Math.min(r.getTile(i).tileSize,512)*(i.overscaledZ/e.transform.zoom)*.5,g=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(g+=` => ${i.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();let r=e.debugOverlayCanvas,i=e.context.gl,a=e.debugOverlayCanvas.getContext("2d");a.clearRect(0,0,r.width,r.height),a.shadowColor="white",a.shadowBlur=2,a.lineWidth=1.5,a.strokeStyle="white",a.textBaseline="top",a.font="bold 36px Open Sans, sans-serif",a.fillText(t,5,5),a.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,`${g} ${f}kB`),o.draw(a,s.TRIANGLES,l,u,t9.alphaBlended,ri.disabled,ts(n,t.aN.transparent,m),null,c,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),o.draw(a,s.LINE_STRIP,l,u,h,ri.disabled,ts(n,t.aN.red),d,c,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}(e,r,i[a])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){var t,r;let i=e.transform.padding;rg(e,e.transform.height-(i.top||0),3,rc),rg(e,i.bottom||0,3,rd),ry(e,i.left||0,3,rp),ry(e,e.transform.width-(i.right||0),3,rf);let a=e.transform.centerPoint;t=a.x,r=e.transform.height-a.y,rv(e,t-1,r-10,2,20,rm),rv(e,t-10,r-1,20,2,rm)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let r=this.terrainFacilitator.matrix,i=this.transform.modelViewProjectionMatrix,a=this.terrainFacilitator.dirty;a||(a=e?!t.a_(r,i):!t.a$(r,i)),a||(a=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),a&&(t.b0(r,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,r){let i=e.context,a=i.gl,s=t9.unblended,n=new rt(a.LEQUAL,rt.ReadWrite,[0,1]),o=r.getTerrainMesh(),l=r.sourceCache.getRenderableTiles(),u=e.useProgram("terrainDepth");for(let h of(i.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),i.clear({color:t.aN.transparent,depth:1}),l)){let t=r.getTerrainData(h.tileID),l={u_matrix:e.transform.calculatePosMatrix(h.tileID.toUnwrapped()),u_ele_delta:r.getMeshFrameDelta(e.transform.zoom)};u.draw(i,a.TRIANGLES,n,rr.disabled,s,ri.backCCW,l,t,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,r){let i=e.context,a=i.gl,s=t9.unblended,n=new rt(a.LEQUAL,rt.ReadWrite,[0,1]),o=r.getTerrainMesh(),l=r.getCoordsTexture(),u=r.sourceCache.getRenderableTiles(),h=e.useProgram("terrainCoords");for(let c of(i.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),i.clear({color:t.aN.transparent,depth:1}),r.coordsIndex=[],u)){let t=r.getTerrainData(c.tileID);i.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,l.texture);let u={u_matrix:e.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0,u_ele_delta:r.getMeshFrameDelta(e.transform.zoom)};h.draw(i,a.TRIANGLES,n,rr.disabled,s,ri.backCCW,u,t,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),r.coordsIndex.push(c.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,r,i,a){if(!i.isHidden(this.transform.zoom)&&("background"===i.type||"custom"===i.type||(a||[]).length))switch(this.id=i.id,i.type){case"symbol":!function(e,r,i,a,s){if("translucent"!==e.renderPass)return;let n=rr.disabled,o=e.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,r,i,a,s,n,o,l,u){let h=r.transform,c=eB(),d="map"===s,p="map"===n;for(let s of e){let e=a.getTile(s),n=e.getBucket(i);if(!n||!n.text||!n.text.segments.get().length)continue;let f=t.ah(n.textSizeData,h.zoom),m=eI(e,1,r.transform.zoom),g=eg(s.posMatrix,p,d,r.transform,m),y="none"!==i.layout.get("icon-text-fit")&&n.hasIconData();if(f){let i=Math.pow(2,h.zoom-e.tileID.overscaledZ),a=r.style.map.terrain?(e,t)=>r.style.map.terrain.getElevation(s,e,t):null,m=c.translatePosition(h,e,o,l);(function(e,r,i,a,s,n,o,l,u,h,c,d,p,f){let m=e.text.placedSymbolArray,g=e.text.dynamicLayoutVertexArray,y=e.icon.dynamicLayoutVertexArray,v={};g.clear();for(let y=0;y<m.length;y++){let _=m.get(y),x=_.hidden||!_.crossTileID||e.allowVerticalPlacement&&!_.placedOrientation?null:a[_.crossTileID];if(x){let a=new t.P(_.anchorX,_.anchorY),m={getElevation:f,width:s.width,height:s.height,labelPlaneMatrix:n,lineVertexArray:null,pitchWithMap:i,projection:c,projectionCache:null,tileAnchorPoint:a,translation:d,unwrappedTileID:p},y=i?ev(a,o,f):eE(a.x,a.y,m),b=.5+s.cameraToCenterDistance/y.signedDistanceFromCamera*.5,S=t.aj(e.textSizeData,u,_)*b/t.aq;i&&(S*=e.tilePixelRatio/l);let{width:w,height:E,anchor:A,textOffset:T,textBoxScale:C}=x,P=function(e,r,i,a,s,n){let{horizontalAlign:o,verticalAlign:l}=t.av(e);return new t.P((-(o-.5)*r/s+a[0])*n,(-(l-.5)*i/s+a[1])*n)}(A,w,E,T,C,S),R=c.getPitchedTextCorrection(s,a.add(new t.P(d[0],d[1])),p),I=function(e,r,i,a,s,n){let o=r.tileAnchorPoint.add(new t.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let e=a.mult(n);return i||(e=e.rotate(-s)),ev(o.add(e),r.labelPlaneMatrix,r.getElevation).point}if(i){let t=eE(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(e),i=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(a.rotate(i))}return e.add(a)}(y.point,m,r,P,s.angle,R),L=e.allowVerticalPlacement&&_.placedOrientation===t.ai.vertical?Math.PI/2:0;for(let e=0;e<_.numGlyphs;e++)t.ak(g,I,L);h&&_.associatedIconIndex>=0&&(v[_.associatedIconIndex]={shiftedAnchor:I,angle:L})}else eP(_.numGlyphs,g)}if(h){y.clear();let r=e.icon.placedSymbolArray;for(let e=0;e<r.length;e++){let i=r.get(e);if(i.hidden)eP(i.numGlyphs,y);else{let r=v[e];if(r)for(let e=0;e<i.numGlyphs;e++)t.ak(y,r.shiftedAnchor,r.angle);else eP(i.numGlyphs,y)}}e.icon.dynamicLayoutVertexBuffer.updateData(y)}e.text.dynamicLayoutVertexBuffer.updateData(g)})(n,d,p,u,h,g,s.posMatrix,i,f,y,c,m,s.toUnwrapped(),a)}}}(a,e,i,r,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),s),0!==i.paint.get("icon-opacity").constantOr(1)&&rn(e,r,i,a,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),n,o),0!==i.paint.get("text-opacity").constantOr(1)&&rn(e,r,i,a,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),n,o),r.map.showCollisionBoxes&&(ra(e,r,i,a,!0),ra(e,r,i,a,!1))}(e,r,i,a,this.style.placement.variableOffsets);break;case"circle":!function(e,r,i,a){if("translucent"!==e.renderPass)return;let s=i.paint.get("circle-opacity"),n=i.paint.get("circle-stroke-width"),o=i.paint.get("circle-stroke-opacity"),l=!i.layout.get("circle-sort-key").isConstant();if(0===s.constantOr(1)&&(0===n.constantOr(1)||0===o.constantOr(1)))return;let u=e.context,h=u.gl,c=e.depthModeForSublayer(0,rt.ReadOnly),d=rr.disabled,p=e.colorModeForRenderPass(),f=[];for(let s=0;s<a.length;s++){let n=a[s],o=r.getTile(n),u=o.getBucket(i);if(!u)continue;let h=u.programConfigurations.get(i.id),c=e.useProgram("circle",h),d=u.layoutVertexBuffer,p=u.indexBuffer,m=e.style.map.terrain&&e.style.map.terrain.getTerrainData(n),g={programConfiguration:h,program:c,layoutVertexBuffer:d,indexBuffer:p,uniformValues:ti(e,n,o,i),terrainData:m};if(l)for(let e of u.segments.get())f.push({segments:new t.a0([e]),sortKey:e.sortKey,state:g});else f.push({segments:u.segments,sortKey:0,state:g})}for(let t of(l&&f.sort((e,t)=>e.sortKey-t.sortKey),f)){let{programConfiguration:r,program:a,layoutVertexBuffer:s,indexBuffer:n,uniformValues:o,terrainData:l}=t.state;a.draw(u,h.TRIANGLES,c,d,p,ri.disabled,o,l,i.id,s,n,t.segments,i.paint,e.transform.zoom,r)}}(e,r,i,a);break;case"heatmap":!function(e,r,i,a){if(0!==i.paint.get("heatmap-opacity")){if("offscreen"===e.renderPass){let s=e.context,n=s.gl,o=rr.disabled,l=new t9([n.ONE,n.ONE],t.aN.transparent,[!0,!0,!0,!0]);(function(e,t,r){let i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);let a=r.heatmapFbo;if(a)i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer);else{let s=i.createTexture();i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),a=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1,!1),function(e,t,r,i){var a,s;let n=e.gl,o=null!==(a=e.HALF_FLOAT)&&void 0!==a?a:n.UNSIGNED_BYTE,l=null!==(s=e.RGBA16F)&&void 0!==s?s:n.RGBA;n.texImage2D(n.TEXTURE_2D,0,l,t.width/4,t.height/4,0,n.RGBA,o,null),i.colorAttachment.set(r)}(e,t,s,a)}})(s,e,i),s.clear({color:t.aN.transparent});for(let t=0;t<a.length;t++){let u=a[t];if(r.hasRenderableParent(u))continue;let h=r.getTile(u),c=h.getBucket(i);if(!c)continue;let d=c.programConfigurations.get(i.id),p=e.useProgram("heatmap",d),{zoom:f}=e.transform;p.draw(s,n.TRIANGLES,rt.disabled,o,l,ri.disabled,to(u.posMatrix,h,f,i.paint.get("heatmap-intensity")),null,i.id,c.layoutVertexBuffer,c.indexBuffer,c.segments,i.paint,e.transform.zoom,d)}s.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){let i=e.context,a=i.gl,s=r.heatmapFbo;if(!s)return;i.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,s.colorAttachment.get()),i.activeTexture.set(a.TEXTURE1);let n=r.colorRampTexture;n||(n=r.colorRampTexture=new C(i,r.colorRamp,a.RGBA)),n.bind(a.LINEAR,a.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,a.TRIANGLES,rt.disabled,rr.disabled,e.colorModeForRenderPass(),ri.disabled,((e,r,i,a)=>{let s=t.H();t.aQ(s,0,e.width,e.height,0,0,1);let n=e.context.gl;return{u_matrix:s,u_world:[n.drawingBufferWidth,n.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}})(e,r),null,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom)}(e,i))}}(e,r,i,a);break;case"line":!function(e,r,i,a){if("translucent"!==e.renderPass)return;let s=i.paint.get("line-opacity"),n=i.paint.get("line-width");if(0===s.constantOr(1)||0===n.constantOr(1))return;let o=e.depthModeForSublayer(0,rt.ReadOnly),l=e.colorModeForRenderPass(),u=i.paint.get("line-dasharray"),h=i.paint.get("line-pattern"),c=h.constantOr(1),d=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),f=c?"linePattern":u?"lineSDF":d?"lineGradient":"line",m=e.context,g=m.gl,y=!0;for(let s of a){let a=r.getTile(s);if(c&&!a.patternsLoaded())continue;let n=a.getBucket(i);if(!n)continue;let v=n.programConfigurations.get(i.id),_=e.context.program.get(),x=e.useProgram(f,v),b=y||x.program!==_,S=e.style.map.terrain&&e.style.map.terrain.getTerrainData(s),w=h.constantOr(null);if(w&&a.imageAtlas){let e=a.imageAtlas,t=e.patternPositions[w.to.toString()],r=e.patternPositions[w.from.toString()];t&&r&&v.setConstantPatternPositions(t,r)}let E=S?s:null,A=c?th(e,a,i,p,E):u?tc(e,a,i,u,p,E):d?tu(e,a,i,n.lineClipsArray.length,E):tl(e,a,i,E);if(c)m.activeTexture.set(g.TEXTURE0),a.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),v.updatePaintBuffers(p);else if(u&&(b||e.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m);else if(d){let a=n.gradients[i.id],o=a.texture;if(i.gradientVersion!==a.version){let l=256;if(i.stepInterpolant){let i=r.getSource().maxzoom,a=s.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-s.canonical.z):1;l=t.ad(t.aV(n.maxLineLength/t.X*1024*a),256,m.maxTextureSize)}a.gradient=t.aW({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:a.gradient||void 0,clips:n.lineClipsArray}),a.texture?a.texture.update(a.gradient):a.texture=new C(m,a.gradient,g.RGBA),a.version=i.gradientVersion,o=a.texture}m.activeTexture.set(g.TEXTURE0),o.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(m,g.TRIANGLES,o,e.stencilModeForClipping(s),l,ri.disabled,A,S,i.id,n.layoutVertexBuffer,n.indexBuffer,n.segments,i.paint,e.transform.zoom,v,n.layoutVertexBuffer2),y=!1}}(e,r,i,a);break;case"fill":!function(e,r,i,a){let s=i.paint.get("fill-color"),n=i.paint.get("fill-opacity");if(0===n.constantOr(1))return;let o=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===s.constantOr(t.aN.transparent).a&&1===n.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){let t=e.depthModeForSublayer(1,"opaque"===e.renderPass?rt.ReadWrite:rt.ReadOnly);ru(e,r,i,a,t,o,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){let t=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,rt.ReadOnly);ru(e,r,i,a,t,o,!0)}}(e,r,i,a);break;case"fill-extrusion":!function(e,t,r,i){let a=r.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===e.renderPass){let s=new rt(e.context.gl.LEQUAL,rt.ReadWrite,e.depthRangeFor3D);if(1!==a||r.paint.get("fill-extrusion-pattern").constantOr(1))rh(e,t,r,i,s,rr.disabled,t9.disabled),rh(e,t,r,i,s,e.stencilModeFor3D(),e.colorModeForRenderPass());else{let a=e.colorModeForRenderPass();rh(e,t,r,i,s,rr.disabled,a)}}}(e,r,i,a);break;case"hillshade":!function(e,r,i,a){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;let s=e.context,n=e.depthModeForSublayer(0,rt.ReadOnly),o=e.colorModeForRenderPass(),[l,u]="translucent"===e.renderPass?e.stencilConfigForOverlap(a):[{},a];for(let a of u){let s=r.getTile(a);void 0!==s.needsHillshadePrepare&&s.needsHillshadePrepare&&"offscreen"===e.renderPass?function(e,r,i,a,s,n){let o=e.context,l=o.gl,u=r.dem;if(u&&u.data){let h=u.dim,c=u.stride,d=u.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(c),r.demTexture){let e=r.demTexture;e.update(d,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else r.demTexture=new C(o,d,l.RGBA,{premultiply:!1}),r.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let p=r.fbo;if(!p){let e=new C(o,{width:h,height:h,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),(p=r.fbo=o.createFramebuffer(h,h,!0,!1)).colorAttachment.set(e.texture)}o.bindFramebuffer.set(p.framebuffer),o.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,a,s,n,ri.disabled,((e,r)=>{let i=r.stride,a=t.H();return t.aQ(a,0,t.X,-t.X,0,0,1),t.J(a,a,[0,-t.X,0]),{u_matrix:a,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:r.getUnpackVector()}})(r.tileID,u),null,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),r.needsHillshadePrepare=!1}}(e,s,i,n,rr.disabled,o):"translucent"===e.renderPass&&function(e,r,i,a,s,n,o){let l=e.context,u=l.gl,h=i.fbo;if(!h)return;let c=e.useProgram("hillshade"),d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(r);l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,h.colorAttachment.get()),c.draw(l,u.TRIANGLES,s,n,o,ri.disabled,((e,r,i,a)=>{let s=i.paint.get("hillshade-shadow-color"),n=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color"),l=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(l-=e.transform.angle);let u=!e.options.moving;return{u_matrix:a?a.posMatrix:e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),u),u_image:0,u_latrange:function(e,r){let i=Math.pow(2,r.canonical.z),a=r.canonical.y;return[new t.Z(0,a/i).toLngLat().lat,new t.Z(0,(a+1)/i).toLngLat().lat]}(0,r.tileID),u_light:[i.paint.get("hillshade-exaggeration"),l],u_shadow:s,u_highlight:n,u_accent:o}})(e,i,a,d?r:null),d,a.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}(e,a,s,i,n,l[a.overscaledZ],o)}s.viewport.set([0,0,e.width,e.height])}(e,r,i,a);break;case"raster":!function(e,r,i,a){if("translucent"!==e.renderPass||0===i.paint.get("raster-opacity")||!a.length)return;let s=e.context,n=s.gl,o=r.getSource(),l=e.useProgram("raster"),u=e.colorModeForRenderPass(),[h,d]=o instanceof J?[{},a]:e.stencilConfigForOverlap(a),p=d[d.length-1].overscaledZ,f=!e.options.moving;for(let a of d){let d,m;let g=e.depthModeForSublayer(a.overscaledZ-p,1===i.paint.get("raster-opacity")?rt.ReadWrite:rt.ReadOnly,n.LESS),y=r.getTile(a);y.registerFadeDuration(i.paint.get("raster-fade-duration"));let v=r.findLoadedParent(a,0),_=r.findLoadedSibling(a),x=function(e,r,i,a,s,n){let o=a.paint.get("raster-fade-duration");if(!n&&o>0){let a=c.now(),n=(a-e.timeAdded)/o,l=r?(a-r.timeAdded)/o:-1,u=i.getSource(),h=s.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),d=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),p=d&&e.refreshedUponExpiration?1:t.ad(d?n:1-l,0,1);return e.refreshedUponExpiration&&n>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}(y,v||_||null,r,i,e.transform,e.style.map.terrain),b="nearest"===i.paint.get("raster-resampling")?n.NEAREST:n.LINEAR;s.activeTexture.set(n.TEXTURE0),y.texture.bind(b,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),s.activeTexture.set(n.TEXTURE1),v?(v.texture.bind(b,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),d=Math.pow(2,v.tileID.overscaledZ-y.tileID.overscaledZ),m=[y.tileID.canonical.x*d%1,y.tileID.canonical.y*d%1]):y.texture.bind(b,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST);let S=e.style.map.terrain&&e.style.map.terrain.getTerrainData(a),w=S?a:null,E=tf(w?w.posMatrix:e.transform.calculatePosMatrix(a.toUnwrapped(),f),m||[0,0],d||1,x,i);o instanceof J?l.draw(s,n.TRIANGLES,g,rr.disabled,u,ri.disabled,E,S,i.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments):l.draw(s,n.TRIANGLES,g,h[a.overscaledZ],u,ri.disabled,E,S,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}(e,r,i,a);break;case"background":!function(e,t,r,i){let a=r.paint.get("background-color"),s=r.paint.get("background-opacity");if(0===s)return;let n=e.context,o=n.gl,l=e.transform,u=l.tileSize,h=r.paint.get("background-pattern");if(e.isPatternMissing(h))return;let c=!h&&1===a.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==c)return;let d=rr.disabled,p=e.depthModeForSublayer(0,"opaque"===c?rt.ReadWrite:rt.ReadOnly),f=e.colorModeForRenderPass(),m=e.useProgram(h?"backgroundPattern":"background"),g=i||l.coveringTiles({tileSize:u,terrain:e.style.map.terrain});h&&(n.activeTexture.set(o.TEXTURE0),e.imageManager.bind(e.context));let y=r.getCrossfadeParameters();for(let t of g){let l=i?t.posMatrix:e.transform.calculatePosMatrix(t.toUnwrapped()),c=h?t_(l,s,e,h,{tileID:t,tileSize:u},y):tv(l,s,a),g=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t);m.draw(n,o.TRIANGLES,p,d,f,ri.disabled,c,g,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}(e,0,i,a);break;case"custom":!function(e,t,r){let i=e.context,a=r.implementation;if("offscreen"===e.renderPass){let t=a.prerender;t&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),t.call(a,i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(rr.disabled);let t="3d"===a.renderingMode?new rt(e.context.gl.LEQUAL,rt.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,rt.ReadOnly);i.setDepthMode(t),a.render(i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}(e,0,i)}}translatePosMatrix(e,r,i,a,s){if(!i[0]&&!i[1])return e;let n=s?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(n){let e=Math.sin(n),t=Math.cos(n);i=[i[0]*t-i[1]*e,i[0]*e+i[1]*t]}let o=[s?i[0]:eI(r,i[0],this.transform.zoom),s?i[1]:eI(r,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.J(l,e,o),l}saveTileTexture(e){let t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t){this.cache=this.cache||{};let r=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new e4(this.context,e0[e],t,tx[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new C(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}class rS{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,r,i){let a=Math.pow(2,i),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{let s=1/(i=t.ag([],i,e))[3]/r*a;return t.b1(i,i,[s,s,1/i[3],s])}),n=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{var t,r,i,a,n,o,l,u,h,c,d,p,f,m,g;let y=(d=[],(g=(p=(r=[],i=w([],s[e[0]],s[e[1]]),a=w([],s[e[2]],s[e[1]]),n=i[0],o=i[1],l=i[2],u=a[0],h=a[1],c=a[2],r[0]=o*c-l*h,r[1]=l*u-n*c,r[2]=n*h-o*u,r)[0])*p+(f=r[1])*f+(m=r[2])*m)>0&&(g=1/Math.sqrt(g)),d[0]=r[0]*g,d[1]=r[1]*g,d[2]=r[2]*g,d),v=-(y[0]*(t=s[e[1]])[0]+y[1]*t[1]+y[2]*t[2]);return y.concat(v)});return new rS(s,n)}}class rw{constructor(e,t){var r,i,a,s;this.min=e,this.max=t,this.center=(s=[],r=[],i=this.min,a=this.max,r[0]=i[0]+a[0],r[1]=i[1]+a[1],r[2]=i[2]+a[2],s[0]=.5*r[0],s[1]=.5*r[1],s[2]=.5*r[2],s)}quadrant(e){let t=[e%2==0,e<2],r=x(this.min),i=x(this.max);for(let e=0;e<t.length;e++)r[e]=t[e]?this.min[e]:this.center[e],i[e]=t[e]?this.center[e]:this.max[e];return i[2]=this.max[2],new rw(r,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],i=!0;for(let a=0;a<e.planes.length;a++){let s=e.planes[a],n=0;for(let e=0;e<r.length;e++)t.b2(s,r[e])>=0&&n++;if(0===n)return 0;n!==r.length&&(i=!1)}if(i)return 2;for(let t=0;t<3;t++){let r=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let a=0;a<e.points.length;a++){let s=e.points[a][t]-this.min[t];r=Math.min(r,s),i=Math.max(i,s)}if(i<0||r>this.max[t]-this.min[t])return 0}return 1}}class rE{constructor(e=0,t=0,r=0,i=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(i)||i<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=i}interpolate(e,r,i){return null!=r.top&&null!=e.top&&(this.top=t.z.number(e.top,r.top,i)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.z.number(e.bottom,r.bottom,i)),null!=r.left&&null!=e.left&&(this.left=t.z.number(e.left,r.left,i)),null!=r.right&&null!=e.right&&(this.right=t.z.number(e.right,r.right,i)),this}getCenter(e,r){let i=t.ad((this.left+e-this.right)/2,0,e),a=t.ad((this.top+r-this.bottom)/2,0,r);return new t.P(i,a)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new rE(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class rA{constructor(e,r,i,a,s){this.tileSize=512,this._renderWorldCopies=void 0===s||!!s,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=null==i?0:i,this._maxPitch=null==a?60:a,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new rE,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new rA(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){var r,i,a,s,n,o,l,u,h,c;let d=-t.b3(e,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(r=new t.A(4),t.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r),i=this.rotationMatrix,a=this.rotationMatrix,s=this.angle,n=a[0],o=a[1],l=a[2],u=a[3],h=Math.sin(s),c=Math.cos(s),i[0]=n*c+l*h,i[1]=o*c+u*h,i[2]=-(n*h)+l*c,i[3]=-(o*h)+u*c)}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let r=t.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){return Math.max(0,(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize)))}getVisibleUnwrappedCoordinates(e){let r=[new t.b4(0,e)];if(this._renderWorldCopies){let i=this.pointCoordinate(new t.P(0,0)),a=this.pointCoordinate(new t.P(this.width,0)),s=this.pointCoordinate(new t.P(this.width,this.height)),n=this.pointCoordinate(new t.P(0,this.height)),o=Math.floor(Math.min(i.x,a.x,s.x,n.x)),l=Math.floor(Math.max(i.x,a.x,s.x,n.x));for(let i=o-1;i<=l+1;i++)0!==i&&r.push(new t.b4(i,e))}return r}coveringTiles(e){var r,i;let a=this.coveringZoomLevel(e),s=a;if(void 0!==e.minzoom&&a<e.minzoom)return[];void 0!==e.maxzoom&&a>e.maxzoom&&(a=e.maxzoom);let n=this.pointCoordinate(this.getCameraPoint()),o=t.Z.fromLngLat(this.center),l=Math.pow(2,a),u=[l*n.x,l*n.y,0],h=[l*o.x,l*o.y,0],c=rS.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,a),d=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=a);let p=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,f=e=>({aabb:new rw([e*l,0,0],[(e+1)*l,l,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),m=[],g=[],y=a,v=e.reparseOverscaled?s:a;if(this._renderWorldCopies)for(let e=1;e<=3;e++)m.push(f(-e)),m.push(f(e));for(m.push(f(0));m.length>0;){let a=m.pop(),s=a.x,n=a.y,o=a.fullyVisible;if(!o){let e=a.aabb.intersects(c);if(0===e)continue;o=2===e}let l=e.terrain?u:h,f=Math.max(Math.abs(a.aabb.distanceX(l)),Math.abs(a.aabb.distanceY(l)));if(a.zoom===y||f>p+(1<<y-a.zoom)-2&&a.zoom>=d){let e=y-a.zoom,r=u[0]-.5-(s<<e),i=u[1]-.5-(n<<e);g.push({tileID:new t.S(a.zoom===y?v:a.zoom,a.wrap,a.zoom,s,n),distanceSq:E([h[0]-.5-s,h[1]-.5-n]),tileDistanceToCamera:Math.sqrt(r*r+i*i)})}else for(let l=0;l<4;l++){let u=(s<<1)+l%2,h=(n<<1)+(l>>1),c=a.zoom+1,d=a.aabb.quadrant(l);if(e.terrain){let s=new t.S(c,a.wrap,c,u,h),n=e.terrain.getMinMaxElevation(s),o=null!==(r=n.minElevation)&&void 0!==r?r:this.elevation,l=null!==(i=n.maxElevation)&&void 0!==i?i:this.elevation;d=new rw([d.min[0],d.min[1],o],[d.max[0],d.max[1],l])}m.push({aabb:d,zoom:c,x:u,y:h,wrap:a.wrap,fullyVisible:o})}}return g.sort((e,t)=>e.distanceSq-t.distanceSq).map(e=>e.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let r=t.ad(e.lat,-85.051129,85.051129);return new t.P(t.O(e.lng)*this.worldSize,t.Q(r)*this.worldSize)}unproject(e){return new t.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){let r=this.elevation,i=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,a=this.pointLocation(this.centerPoint,e),s=e.getElevationForLngLatZoom(a,this.tileZoom);if(!(this.elevation-s))return;let n=Math.cos(this._pitch)*this.cameraToCenterDistance/(i+r-s)/t.b5(1,a.lat),o=this.scaleZoom(n/this.tileSize);this._elevation=s,this._center=a,this.zoom=o}setLocationAtPoint(e,r){let i=this.pointCoordinate(r),a=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(e),n=new t.Z(s.x-(i.x-a.x),s.y-(i.y-a.y));this.center=this.coordinateLocation(n),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return t.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,r){if(r){let t=r.pointCoordinate(e);if(null!=t)return t}let i=[e.x,e.y,0,1],a=[e.x,e.y,1,1];t.ag(i,i,this.pixelMatrixInverse),t.ag(a,a,this.pixelMatrixInverse);let s=i[3],n=a[3],o=i[1]/s,l=a[1]/n,u=i[2]/s,h=a[2]/n,c=u===h?0:(0-u)/(h-u);return new t.Z(t.z.number(i[0]/s,a[0]/n,c)/this.worldSize,t.z.number(o,l,c)/this.worldSize)}coordinatePoint(e,r=0,i=this.pixelMatrix){let a=[e.x*this.worldSize,e.y*this.worldSize,r,1];return t.ag(a,a,i),new t.P(a[0]/a[3],a[1]/a[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return(new Z).extend(this.pointLocation(new t.P(0,e))).extend(this.pointLocation(new t.P(this.width,e))).extend(this.pointLocation(new t.P(this.width,this.height))).extend(this.pointLocation(new t.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Z([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,85.051129])}calculateTileMatrix(e){let r=e.canonical,i=this.worldSize/this.zoomScale(r.z),a=r.x+Math.pow(2,r.z)*e.wrap,s=t.ao(new Float64Array(16));return t.J(s,s,[a*i,r.y*i,0]),t.K(s,s,[i/t.X,i/t.X,1]),s}calculatePosMatrix(e,r=!1){let i=e.key,a=r?this._alignedPosMatrixCache:this._posMatrixCache;if(a[i])return a[i];let s=this.calculateTileMatrix(e);return t.L(s,r?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,s),a[i]=new Float32Array(s),a[i]}calculateFogMatrix(e){let r=e.key,i=this._fogMatrixCache;if(i[r])return i[r];let a=this.calculateTileMatrix(e);return t.L(a,this.fogMatrix,a),i[r]=new Float32Array(a),i[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,r){let i,a;r=t.ad(+r,this.minZoom,this.maxZoom);let s={center:new t.N(e.lng,e.lat),zoom:r},n=this.lngRange;this._renderWorldCopies||null!==n||(n=[-(180-1e-10),180-1e-10]);let o=this.tileSize*this.zoomScale(s.zoom),l=0,u=o,h=0,c=o,d=0,p=0,{x:f,y:m}=this.size;if(this.latRange){let e=this.latRange;l=t.Q(e[1])*o,(u=t.Q(e[0])*o)-l<m&&(d=m/(u-l))}n&&(h=t.b3(t.O(n[0])*o,0,o),(c=t.b3(t.O(n[1])*o,0,o))<h&&(c+=o),c-h<f&&(p=f/(c-h)));let{x:g,y:y}=this.project.call({worldSize:o},e),v=Math.max(p||0,d||0);if(v){let e=new t.P(p?(c+h)/2:g,d?(u+l)/2:y);return s.center=this.unproject.call({worldSize:o},e).wrap(),s.zoom+=this.scaleZoom(v),s}if(this.latRange){let e=m/2;y-e<l&&(a=l+e),y+e>u&&(a=u-e)}if(n){let e=(h+c)/2,r=g;this._renderWorldCopies&&(r=t.b3(g,e-o/2,e+o/2));let a=f/2;r-a<h&&(i=h+a),r+a>c&&(i=c-a)}if(void 0!==i||void 0!==a){let e=new t.P(null!=i?i:g,null!=a?a:y);s.center=this.unproject.call({worldSize:o},e).wrap()}return s}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:t,zoom:r}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=r,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this.centerOffset,r=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.b5(1,this.center.lat)*this.worldSize;let a=t.ao(new Float64Array(16));t.K(a,a,[this.width/2,-this.height/2,1]),t.J(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=t.ao(new Float64Array(16)),t.K(a,a,[1,-1,1]),t.J(a,a,[-1,-1,0]),t.K(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let s=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),n=Math.min(this.elevation,this.minElevationForCurrentTile),o=s-n*this._pixelPerMeter/Math.cos(this._pitch),l=n<0?o:s,u=Math.PI/2+this._pitch,h=this._fov*(.5+e.y/this.height),c=Math.sin(h)*l/Math.sin(t.ad(Math.PI-u-h,.01,Math.PI-.01)),d=this.getHorizon(),p=2*Math.atan(d/this.cameraToCenterDistance)*(.5+e.y/(2*d)),f=Math.min(c,Math.sin(p)*l/Math.sin(t.ad(Math.PI-u-p,.01,Math.PI-.01))),m=1.01*(Math.cos(Math.PI/2-this._pitch)*f+l),g=this.height/50;a=new Float64Array(16),t.b6(a,this._fov,this.width/this.height,g,m),a[8]=-(2*e.x)/this.width,a[9]=2*e.y/this.height,t.K(a,a,[1,-1,1]),t.J(a,a,[0,0,-this.cameraToCenterDistance]),t.b7(a,a,this._pitch),t.ae(a,a,this.angle),t.J(a,a,[-r,-i,0]),this.mercatorMatrix=t.K([],a,[this.worldSize,this.worldSize,this.worldSize]),t.K(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.L(new Float64Array(16),this.labelPlaneMatrix,a),t.J(a,a,[0,0,-this.elevation]),this.modelViewProjectionMatrix=a,this.invModelViewProjectionMatrix=t.at([],a),this.fogMatrix=new Float64Array(16),t.b6(this.fogMatrix,this._fov,this.width/this.height,s,m),this.fogMatrix[8]=-(2*e.x)/this.width,this.fogMatrix[9]=2*e.y/this.height,t.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),t.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),t.b7(this.fogMatrix,this.fogMatrix,this._pitch),t.ae(this.fogMatrix,this.fogMatrix,this.angle),t.J(this.fogMatrix,this.fogMatrix,[-r,-i,0]),t.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),t.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=t.L(new Float64Array(16),this.labelPlaneMatrix,a);let y=this.width%2/2,v=this.height%2/2,_=Math.cos(this.angle),x=Math.sin(this.angle),b=r-Math.round(r)+_*y+x*v,S=i-Math.round(i)+_*v+x*y,w=new Float64Array(a);if(t.J(w,w,[b>.5?b-1:b,S>.5?S-1:S,0]),this.alignedModelViewProjectionMatrix=w,!(a=t.at(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new t.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.ag(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}getCameraQueryGeometry(e){let r=this.getCameraPoint();if(1===e.length)return[e[0],r];{let i=r.x,a=r.y,s=r.x,n=r.y;for(let t of e)i=Math.min(i,t.x),a=Math.min(a,t.y),s=Math.max(s,t.x),n=Math.max(n,t.y);return[new t.P(i,a),new t.P(s,a),new t.P(s,n),new t.P(i,n),new t.P(i,a)]}}lngLatToCameraDepth(e,r){let i=this.locationCoordinate(e),a=[i.x*this.worldSize,i.y*this.worldSize,r,1];return t.ag(a,a,this.modelViewProjectionMatrix),a[2]/a[3]}}function rT(e,t){let r,i=!1,a=null,s=null,n=()=>{a=null,i&&(e.apply(s,r),a=setTimeout(n,t),i=!1)};return(...e)=>(i=!0,s=this,r=e,a||n(),a)}class rC{constructor(e){this._getCurrentHash=()=>{let e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(e=>e.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{let e=this._getCurrentHash();if(e.length>=3&&!e.some(e=>isNaN(e))){let t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let e=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,e)}catch(e){}},this._updateHash=rT(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.pow(10,Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10)),a=Math.round(t.lng*i)/i,s=Math.round(t.lat*i)/i,n=this._map.getBearing(),o=this._map.getPitch(),l="";if(l+=e?`/${a}/${s}/${r}`:`${r}/${s}/${a}`,(n||o)&&(l+="/"+Math.round(10*n)/10),o&&(l+=`/${Math.round(o)}`),this._hashName){let e=this._hashName,t=!1,r=window.location.hash.slice(1).split("&").map(r=>{let i=r.split("=")[0];return i===e?(t=!0,`${i}=${l}`):r}).filter(e=>e);return t||r.push(`${e}=${l}`),`#${r.join("&")}`}return`#${l}`}}let rP={linearity:.3,easing:t.b8(0,0,.3,1)},rR=t.e({deceleration:2500,maxSpeed:1400},rP),rI=t.e({deceleration:20,maxSpeed:1400},rP),rL=t.e({deceleration:1e3,maxSpeed:360},rP),rO=t.e({deceleration:1e3,maxSpeed:90},rP);class rM{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,t=c.now();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let r={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:e}of this._inertiaBuffer)r.zoom+=e.zoomDelta||0,r.bearing+=e.bearingDelta||0,r.pitch+=e.pitchDelta||0,e.panDelta&&r.pan._add(e.panDelta),e.around&&(r.around=e.around),e.pinchAround&&(r.pinchAround=e.pinchAround);let i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(r.pan.mag()){let s=rN(r.pan.mag(),i,t.e({},rR,e||{}));a.offset=r.pan.mult(s.amount/r.pan.mag()),a.center=this._map.transform.center,rk(a,s)}if(r.zoom){let e=rN(r.zoom,i,rI);a.zoom=this._map.transform.zoom+e.amount,rk(a,e)}if(r.bearing){let e=rN(r.bearing,i,rL);a.bearing=this._map.transform.bearing+t.ad(e.amount,-179,179),rk(a,e)}if(r.pitch){let e=rN(r.pitch,i,rO);a.pitch=this._map.transform.pitch+e.amount,rk(a,e)}if(a.zoom||a.bearing){let e=void 0===r.pinchAround?r.around:r.pinchAround;a.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(a,{noMoveStart:!0})}}function rk(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function rN(e,r,i){let{maxSpeed:a,linearity:s,deceleration:n}=i,o=t.ad(e*s/(r/1e3),-a,a),l=Math.abs(o)/(n*s);return{easing:i.easing,duration:1e3*l,amount:l/2*o}}class rD extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i,a={}){let s=d.mousePos(r.getCanvas(),i);super(e,t.e({point:s,lngLat:r.unproject(s),originalEvent:i},a)),this._defaultPrevented=!1,this.target=r}}class rF extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){let a="touchend"===e?i.changedTouches:i.touches,s=d.touchPos(r.getCanvasContainer(),a),n=s.map(e=>r.unproject(e)),o=s.reduce((e,t,r,i)=>e.add(t.div(i.length)),new t.P(0,0));super(e,{points:s,point:o,lngLats:n,lngLat:r.unproject(o),originalEvent:i}),this._defaultPrevented=!1}}class rG extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class rz{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new rG(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new rD(e.type,this._map,e))}mouseup(e){this._map.fire(new rD(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new rD(e.type,this._map,e))}dblclick(e){return this._firePreventable(new rD(e.type,this._map,e))}mouseover(e){this._map.fire(new rD(e.type,this._map,e))}mouseout(e){this._map.fire(new rD(e.type,this._map,e))}touchstart(e){return this._firePreventable(new rF(e.type,this._map,e))}touchmove(e){this._map.fire(new rF(e.type,this._map,e))}touchend(e){this._map.fire(new rF(e.type,this._map,e))}touchcancel(e){this._map.fire(new rF(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rq{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new rD(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new rD("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new rD(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rj{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(t.P.convert(e),this._map.terrain)}}class rB{constructor(e,t){this._map=e,this._tr=new rj(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(d.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active||this._lastPos.equals(t)||!this._box&&t.dist(this._startPos)<this._clickTolerance)return;let r=this._startPos;this._lastPos=t,this._box||(this._box=d.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let i=Math.min(r.x,t.x),a=Math.max(r.x,t.x),s=Math.min(r.y,t.y),n=Math.max(r.y,t.y);d.setTransform(this._box,`translate(${i}px,${s}px)`),this._box.style.width=a-i+"px",this._box.style.height=n-s+"px"}mouseupWindow(e,r){if(!this._active||0!==e.button)return;let i=this._startPos;if(this.reset(),d.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new t.k("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(i,r,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(d.remove(this._box),this._box=null),d.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.k(e,{originalEvent:r}))}}function rU(e,t){if(e.length!==t.length)throw Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);let r={};for(let i=0;i<e.length;i++)r[e[i].identifier]=t[i];return r}class rH{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){let r=new t.P(0,0);for(let t of e)r._add(t);return r.div(e.length)}(r),this.touches=rU(i,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;let i=rU(r,t);for(let e in this.touches){let t=i[e];(!t||t.dist(this.touches[e])>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){let e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class rZ{constructor(e){this.singleTap=new rH(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){let i=this.singleTap.touchend(e,t,r);if(i){let t=e.timeStamp-this.lastTime<500,r=!this.lastTap||30>this.lastTap.dist(i);if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class rV{constructor(e){this._tr=new rj(e),this._zoomIn=new rZ({numTouches:1,numTaps:2}),this._zoomOut=new rZ({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){let i=this._zoomIn.touchend(e,t,r),a=this._zoomOut.touchend(e,t,r),s=this._tr;return i?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(i)},{originalEvent:e})}):a?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(a)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rY{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;let r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);let i=t.length?t[0]:t;return!this._moved&&i.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=i,this._move(r,i))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&d.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let rW={0:1,2:2};class r${constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let t=d.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){let r=rW[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton)}isValidEndEvent(e){return d.mouseButton(e)===this._eventButton}}class rX{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}let rK=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}},rJ=({enable:e,clickTolerance:t,bearingDegreesPerPixelMoved:r=.8})=>new rY({clickTolerance:t,move:(e,t)=>({bearingDelta:(t.x-e.x)*r}),moveStateManager:new r$({checkCorrectEvent:e=>0===d.mouseButton(e)&&e.ctrlKey||2===d.mouseButton(e)}),enable:e,assignEvents:rK}),rQ=({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5})=>new rY({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:new r$({checkCorrectEvent:e=>0===d.mouseButton(e)&&e.ctrlKey||2===d.mouseButton(e)}),enable:e,assignEvents:rK});class r0{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._active&&!(r.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,r)}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,i){i.length>0&&(this._active=!0);let a=rU(i,r),s=new t.P(0,0),n=new t.P(0,0),o=0;for(let e in a){let t=a[e],r=this._touches[e];r&&(s._add(t),n._add(t.sub(r)),o++,a[e]=t)}if(this._touches=a,o<this.minTouchs()||!n.mag())return;let l=n.div(o);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(o),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class r1{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();let[i,a]=this._firstTwoTouches,s=r2(r,t,i),n=r2(r,t,a);if(!s||!n)return;let o=this._aroundCenter?null:s.add(n).div(2);return this._move([s,n],o,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;let[i,a]=this._firstTwoTouches,s=r2(r,t,i),n=r2(r,t,a);s&&n||(this._active&&d.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function r2(e,t,r){for(let i=0;i<e.length;i++)if(e[i].identifier===r)return t[i]}function r5(e,t){return Math.log(e/t)/Math.LN2}class r3 extends r1{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){let r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(.1>Math.abs(r5(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:r5(this._distance,r),pinchAround:t}}}function r4(e,t){return 180*e.angleWith(t)/Math.PI}class r6 extends r1{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){let i=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:r4(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let t=25/(Math.PI*this._minDiameter)*360;return Math.abs(r4(e,this._startVector))<t}}function r8(e){return Math.abs(e.y)>Math.abs(e.x)}class r7 extends r1{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,r8(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let i=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(i,a,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:-((i.y+a.y)/2*.5)}):void 0}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;let i=e.mag()>=2,a=t.mag()>=2;if(!i&&!a)return;if(!i||!a)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;let s=e.y>0==t.y>0;return r8(e)&&r8(t)&&s}}class r9{constructor(e){this._tr=new rj(e),this._panStep=100,this._bearingStep=15,this._pitchStep=10,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,i=0,a=0,s=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?i=1:(e.preventDefault(),s=-1);break;case 40:e.shiftKey?i=-1:(e.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(r=0,i=0),{cameraAnimation:n=>{let o=this._tr;n.easeTo({duration:300,easeId:"keyboardHandler",easing:ie,zoom:t?Math.round(o.zoom)+t*(e.shiftKey?2:1):o.zoom,bearing:o.bearing+r*this._bearingStep,pitch:o.pitch+i*this._pitchStep,offset:[-a*this._panStep,-s*this._panStep],center:o.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ie(e){return e*(2-e)}class it{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new rj(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=c.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==t&&t%4.000244140625==0?this._type="wheel":0!==t&&4>Math.abs(t)?this._type="trackpad":i>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=200>Math.abs(i*t)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let r=d.mousePos(this._map.getCanvas(),e),i=this._tr;this._around=r.y>i.transform.height/2-i.transform.getHorizon()?t.N.convert(this._aroundCenter?i.center:i.unproject(r)):t.N.convert(i.center),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(0!==this._delta){let t="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,r=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==r&&(r=1/r);let i="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(i*r))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let r="number"==typeof this._targetZoom?this._targetZoom:e.zoom,i=this._startZoom,a=this._easing,s,n=!1;if("wheel"===this._type&&i&&a){let e=Math.min((c.now()-this._lastWheelEventTime)/200,1),o=a(e);s=t.z.number(i,r,o),e<1?this._frameId||(this._frameId=!0):n=!0}else s=r,n=!0;return this._active=!0,n&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!n,zoomDelta:s-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=t.b9;if(this._prevEase){let e=this._prevEase,i=(c.now()-e.start)/e.duration,a=e.easing(i+.01)-e.easing(i),s=.27/Math.sqrt(a*a+1e-4)*.01;r=t.b8(s,Math.sqrt(.0729-s*s),.25,1)}return this._prevEase={start:c.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ir{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ii{constructor(e){this._tr=new rj(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ia{constructor(){this._tap=new rZ({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint){if(this._tapTime){let i=t[0],a=e.timeStamp-this._tapTime<500,s=30>this._tapPoint.dist(i);a&&s?r.length>0&&(this._swipePoint=i,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(e,t,r)}}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;let i=t[0],a=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){if(this._tapTime)this._swipePoint&&0===r.length&&this.reset();else{let i=this._tap.touchend(e,t,r);i&&(this._tapTime=e.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class is{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class io{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class il{constructor(e,t,r,i){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class iu{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=d.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),i=document.createElement("div");i.className="maplibregl-desktop-message",i.textContent=t,this._container.appendChild(i);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=r,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(d.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(1===e.touches.length)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){this._enabled&&e&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let ih=e=>e.zoom||e.drag||e.pitch||e.rotate;class ic extends t.k{}function id(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class ip{constructor(e,t){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,t)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;let r="renderFrame"===e.type?void 0:e,i={needsRenderFrame:!1},a={},s={},n=e.touches,o=n?this._getMapTouches(n):void 0,l=o?d.touchPos(this._map.getCanvas(),o):d.mousePos(this._map.getCanvas(),e);for(let{handlerName:n,handler:u,allowed:h}of this._handlers){let c;u.isEnabled()&&(this._blockedByActive(s,h,n)?u.reset():u[t||e.type]&&(c=u[t||e.type](e,l,o),this.mergeHandlerResult(i,a,c,n,r),c&&c.needsRenderFrame&&this._triggerRenderFrame()),(c||u.isActive())&&(s[n]=u))}let u={};for(let e in this._previousActiveHandlers)s[e]||(u[e]=r);this._previousActiveHandlers=s,(Object.keys(u).length||id(i))&&(this._changes.push([i,a,u]),this._triggerRenderFrame()),(Object.keys(s).length||id(i))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:h}=i;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rM(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);let r=this._el;for(let[e,t,i]of(this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]],this._listeners))d.addEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,i)}destroy(){for(let[e,t,r]of this._listeners)d.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){let t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new rz(t,e));let i=t.boxZoom=new rB(t,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();let a=t.cooperativeGestures=new iu(t,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let s=new rV(t),n=new ii(t);t.doubleClickZoom=new ir(n,s),this._add("tapZoom",s),this._add("clickZoom",n),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();let o=new ia;this._add("tapDragZoom",o);let l=t.touchPitch=new r7(t);this._add("touchPitch",l),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);let u=rJ(e),h=rQ(e);t.dragRotate=new io(e,u,h),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",h,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();let c=(({enable:e,clickTolerance:t})=>new rY({clickTolerance:t,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:new r$({checkCorrectEvent:e=>0===d.mouseButton(e)&&!e.ctrlKey}),enable:e,assignEvents:rK}))(e),p=new r0(e,t);t.dragPan=new is(r,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);let f=new r6,m=new r3;t.touchZoomRotate=new il(r,m,f,o),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);let g=t.scrollZoom=new it(t,()=>this._triggerRenderFrame());this._add("scrollZoom",g,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);let y=t.keyboard=new r9(t);this._add("keyboard",y),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new rq(t))}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(let{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ih(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,t,r){for(let i in e)if(i!==r&&(!t||0>t.indexOf(i)))return!0;return!1}_getMapTouches(e){let t=[];for(let r of e)this._el.contains(r.target)&&t.push(r);return t}mergeHandlerResult(e,r,i,a,s){if(!i)return;t.e(e,i);let n={handlerName:a,originalEvent:i.originalEvent||s};void 0!==i.zoomDelta&&(r.zoom=n),void 0!==i.panDelta&&(r.drag=n),void 0!==i.pitchDelta&&(r.pitch=n),void 0!==i.bearingDelta&&(r.rotate=n)}_applyChanges(){let e={},r={},i={};for(let[a,s,n]of this._changes)a.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(a.panDelta)),a.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+a.zoomDelta),a.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+a.bearingDelta),a.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+a.pitchDelta),void 0!==a.around&&(e.around=a.around),void 0!==a.pinchAround&&(e.pinchAround=a.pinchAround),a.noInertia&&(e.noInertia=a.noInertia),t.e(r,s),t.e(i,n);this._updateMapTransform(e,r,i),this._changes=[]}_updateMapTransform(e,t,r){let i=this._map,a=i._getTransformForUpdate(),s=i.terrain;if(!(id(e)||s&&this._terrainMovement))return this._fireEvents(t,r,!0);let{panDelta:n,zoomDelta:o,bearingDelta:l,pitchDelta:u,around:h,pinchAround:c}=e;void 0!==c&&(h=c),i._stop(!0),h=h||i.transform.centerPoint;let d=a.pointLocation(n?h.sub(n):h);l&&(a.bearing+=l),u&&(a.pitch+=u),o&&(a.zoom+=o),s?!this._terrainMovement&&(t.drag||t.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(d,h)):t.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(n)):a.setLocationAtPoint(d,h):a.setLocationAtPoint(d,h),i._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_fireEvents(e,r,i){let a;let s=ih(this._eventsInProgress),n=ih(e),o={};for(let t in e){let{originalEvent:r}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=r),this._eventsInProgress[t]=e[t]}for(let e in!s&&n&&this._fireEvent("movestart",n.originalEvent),o)this._fireEvent(e,o[e]);for(let t in n&&this._fireEvent("move",n.originalEvent),e){let{originalEvent:r}=e[t];this._fireEvent(t,r)}let l={};for(let e in this._eventsInProgress){let{handlerName:t,originalEvent:i}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],a=r[t]||i,l[`${e}end`]=a)}for(let e in l)this._fireEvent(e,l[e]);let u=ih(this._eventsInProgress),h=(s||n)&&!u;if(h&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),i&&h){var d,p;this._updatingCamera=!0;let e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions);e&&(e.essential||!c.prefersReducedMotion)?(0!==(d=e.bearing||this._map.getBearing())&&-this._bearingSnap<d&&d<this._bearingSnap&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:a})):(this._map.fire(new t.k("moveend",{originalEvent:a})),0!==(p=this._map.getBearing())&&-this._bearingSnap<p&&p<this._bearingSnap&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new t.k(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new ic("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class im extends t.E{constructor(e,t){super(),this._renderFrameCallback=()=>{let e=Math.min((c.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new t.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,r,i){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},r),i)}panTo(e,r,i){return this.easeTo(t.e({center:e},r),i)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,r,i){return this.easeTo(t.e({zoom:e},r),i)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,r,i){return this.easeTo(t.e({bearing:e},r),i)}resetNorth(e,r){return this.rotateTo(0,t.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.e({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=Z.convert(e);let r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,r,i,a){let s={top:0,bottom:0,right:0,left:0};if("number"==typeof(a=t.e({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){let e=a.padding;a.padding={top:e,bottom:e,right:e,left:e}}a.padding=t.e(s,a.padding);let n=this.transform,o=n.padding,l=new Z(e,r),u=n.project(l.getNorthWest()),h=n.project(l.getNorthEast()),c=n.project(l.getSouthEast()),d=n.project(l.getSouthWest()),p=t.ba(-i),f=u.rotate(p),m=h.rotate(p),g=c.rotate(p),y=d.rotate(p),v=new t.P(Math.max(f.x,m.x,y.x,g.x),Math.max(f.y,m.y,y.y,g.y)),_=new t.P(Math.min(f.x,m.x,y.x,g.x),Math.min(f.y,m.y,y.y,g.y)),x=v.sub(_),b=(n.width-(o.left+o.right+a.padding.left+a.padding.right))/x.x,S=(n.height-(o.top+o.bottom+a.padding.top+a.padding.bottom))/x.y;if(S<0||b<0)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let w=Math.min(n.scaleZoom(n.scale*Math.min(b,S)),a.maxZoom),E=t.P.convert(a.offset),A=new t.P((a.padding.left-a.padding.right)/2,(a.padding.top-a.padding.bottom)/2).rotate(t.ba(i)),T=E.add(A).mult(n.scale/n.zoomScale(w));return{center:n.unproject(u.add(c).div(2).sub(T)),zoom:w,bearing:i}}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,r,i,a,s){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.P.convert(e)),this.transform.pointLocation(t.P.convert(r)),i,a),a,s)}_fitInternal(e,r,i){return e?(delete(r=t.e(e,r)).padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this}jumpTo(e,r){this.stop();let i=this._getTransformForUpdate(),a=!1,s=!1,n=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(a=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.N.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(s=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(n=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this._applyUpdatedTransform(i),this.fire(new t.k("movestart",r)).fire(new t.k("move",r)),a&&this.fire(new t.k("zoomstart",r)).fire(new t.k("zoom",r)).fire(new t.k("zoomend",r)),s&&this.fire(new t.k("rotatestart",r)).fire(new t.k("rotate",r)).fire(new t.k("rotateend",r)),n&&this.fire(new t.k("pitchstart",r)).fire(new t.k("pitch",r)).fire(new t.k("pitchend",r)),this.fire(new t.k("moveend",r))}calculateCameraOptionsFromTo(e,r,i,a=0){let s=t.Z.fromLngLat(e,r),n=t.Z.fromLngLat(i,a),o=n.x-s.x,l=n.y-s.y,u=n.z-s.z,h=Math.hypot(o,l,u);if(0===h)throw Error("Can't calculate camera options with same From and To");let c=Math.hypot(o,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/h/this.transform.tileSize),p=180*Math.atan2(o,-l)/Math.PI,f=180*Math.acos(c/h)/Math.PI;return f=u<0?90-f:90+f,{center:n.toLngLat(),zoom:d,pitch:f,bearing:p}}easeTo(e,r){var i;let a,s;this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.b9},e)).animate||!e.essential&&c.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),o=this.getZoom(),l=this.getBearing(),u=this.getPitch(),h=this.getPadding(),d="bearing"in e?this._normalizeBearing(e.bearing,l):l,p="pitch"in e?+e.pitch:u,f="padding"in e?e.padding:n.padding,m=t.P.convert(e.offset),g=n.centerPoint.add(m),y=n.pointLocation(g),{center:v,zoom:_}=n.getConstrained(t.N.convert(e.center||y),null!==(i=e.zoom)&&void 0!==i?i:o);this._normalizeCenter(v);let x=n.project(y),b=n.project(v).sub(x),S=n.zoomScale(_-o);e.around&&(a=t.N.convert(e.around),s=n.locationPoint(a));let w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||_!==o,this._rotating=this._rotating||l!==d,this._pitching=this._pitching||p!==u,this._padding=!n.isPaddingEqual(f),this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,w),this.terrain&&this._prepareElevation(v),this._ease(i=>{if(this._zooming&&(n.zoom=t.z.number(o,_,i)),this._rotating&&(n.bearing=t.z.number(l,d,i)),this._pitching&&(n.pitch=t.z.number(u,p,i)),this._padding&&(n.interpolatePadding(h,f,i),g=n.centerPoint.add(m)),this.terrain&&!e.freezeElevation&&this._updateElevation(i),a)n.setLocationAtPoint(a,s);else{let e=n.zoomScale(n.zoom-o),t=Math.pow(_>o?Math.min(2,S):Math.max(.5,S),1-i),r=n.unproject(x.add(b.mult(i*t)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?r.wrap():r,g)}this._applyUpdatedTransform(n),this._fireMoveEvents(r)},t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,t)},e),this}_prepareEase(e,r,i={}){this._moving=!0,r||i.moving||this.fire(new t.k("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.k("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.k("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){let t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(r-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.elevation=t.z.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let t=e.clone(),{center:r,zoom:i,pitch:a,bearing:s,elevation:n}=this.transformCameraUpdate(t);r&&(t.center=r),void 0!==i&&(t.zoom=i),void 0!==a&&(t.pitch=a),void 0!==s&&(t.bearing=s),void 0!==n&&(t.elevation=n),this.transform.apply(t)}_fireMoveEvents(e){this.fire(new t.k("move",e)),this._zooming&&this.fire(new t.k("zoom",e)),this._rotating&&this.fire(new t.k("rotate",e)),this._pitching&&this.fire(new t.k("pitch",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;let i=this._zooming,a=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.k("zoomend",e)),a&&this.fire(new t.k("rotateend",e)),s&&this.fire(new t.k("pitchend",e)),this.fire(new t.k("moveend",e))}flyTo(e,r){var i;if(!e.essential&&c.prefersReducedMotion){let i=t.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,r)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.b9},e);let a=this._getTransformForUpdate(),s=this.getZoom(),n=this.getBearing(),o=this.getPitch(),l=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,n):n,h="pitch"in e?+e.pitch:o,d="padding"in e?e.padding:a.padding,p=t.P.convert(e.offset),f=a.centerPoint.add(p),m=a.pointLocation(f),{center:g,zoom:y}=a.getConstrained(t.N.convert(e.center||m),null!==(i=e.zoom)&&void 0!==i?i:s);this._normalizeCenter(g);let v=a.zoomScale(y-s),_=a.project(m),x=a.project(g).sub(_),b=e.curve,S=Math.max(a.width,a.height),w=S/v,E=x.mag();if("minZoom"in e){let r=t.ad(Math.min(e.minZoom,s,y),a.minZoom,a.maxZoom);b=Math.sqrt(S/a.zoomScale(r-s)/E*2)}let A=b*b;function T(e){let t=(w*w-S*S+(e?-1:1)*A*A*E*E)/(2*(e?w:S)*A*E);return Math.log(Math.sqrt(t*t+1)-t)}function C(e){return(Math.exp(e)-Math.exp(-e))/2}function P(e){return(Math.exp(e)+Math.exp(-e))/2}let R=T(!1),I=function(e){return P(R)/P(R+b*e)},L=function(e){var t;return(P(R)*(C(t=R+b*e)/P(t))-C(R))/A*S/E},O=(T(!0)-R)/b;if(1e-6>Math.abs(E)||!isFinite(O)){if(1e-6>Math.abs(S-w))return this.easeTo(e,r);let t=w<S?-1:1;O=Math.abs(Math.log(w/S))/b,L=()=>0,I=e=>Math.exp(t*b*e)}return e.duration="duration"in e?+e.duration:1e3*O/("screenSpeed"in e?+e.screenSpeed/b:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=n!==u,this._pitching=h!==o,this._padding=!a.isPaddingEqual(d),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(g),this._ease(i=>{let c=i*O,m=1/I(c);a.zoom=1===i?y:s+a.scaleZoom(m),this._rotating&&(a.bearing=t.z.number(n,u,i)),this._pitching&&(a.pitch=t.z.number(o,h,i)),this._padding&&(a.interpolatePadding(l,d,i),f=a.centerPoint.add(p)),this.terrain&&!e.freezeElevation&&this._updateElevation(i);let v=1===i?g:a.unproject(_.add(x.mult(L(c))).mult(m));a.setLocationAtPoint(a.renderWorldCopies?v.wrap():v,f),this._applyUpdatedTransform(a),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var r;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(r=this.handlers)||void 0===r||r.stop(!1),this}_ease(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=c.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){let i=Math.abs((e=t.b3(e,-180,180))-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e}_normalizeCenter(e){let t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;let r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}let ig={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class iy{constructor(e=ig){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{e&&("metadata"===e.sourceDataType||"visibility"===e.sourceDataType||"style"===e.dataType||"terrain"===e.type)&&this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=d.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=d.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=d.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){d.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){let r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(e=>"string"!=typeof e?"":e)):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}let t=this._map.style.sourceCaches;for(let r in t){let i=t[r];if(i.used||i.usedForTerrain){let t=i.getSource();t.attribution&&0>e.indexOf(t.attribution)&&e.push(t.attribution)}}(e=e.filter(e=>String(e).trim())).sort((e,t)=>e.length-t.length);let r=(e=e.filter((t,r)=>{for(let i=r+1;i<e.length;i++)if(e[i].indexOf(t)>=0)return!1;return!0})).join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class iv{constructor(e={}){this._updateCompact=()=>{let e=this._container.children;if(e.length){let t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=d.create("div","maplibregl-ctrl");let t=d.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){d.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class i_{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){let t=this._currentlyRunning;for(let r of t?this._queue.concat(t):this._queue)if(r.id===e)return void(r.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw Error("Attempting to run(), but is already running.");let t=this._currentlyRunning=this._queue;for(let r of(this._queue=[],t))if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ix=t.Y([{name:"a_pos3d",type:"Int16",components:3}]);class ib extends t.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];let i={};for(let a of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r}))i[a.key]=!0,this._renderableTilesKeys.push(a.key),this._tiles[a.key]||(a.posMatrix=new Float64Array(16),t.aQ(a.posMatrix,0,t.X,0,t.X,0,1),this._tiles[a.key]=new eo(a,this.tileSize));for(let e in this._tiles)i[e]||delete this._tiles[e]}freeRtt(e){for(let t in this._tiles){let r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let r={};for(let i of this._renderableTilesKeys){let a=this._tiles[i].tileID;if(a.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),t.aQ(a.posMatrix,0,t.X,0,t.X,0,1),r[i]=a}else if(a.canonical.isChildOf(e.canonical)){let s=e.clone();s.posMatrix=new Float64Array(16);let n=a.canonical.z-e.canonical.z,o=a.canonical.x-(a.canonical.x>>n<<n),l=a.canonical.y-(a.canonical.y>>n<<n),u=t.X>>n;t.aQ(s.posMatrix,0,u,0,u,0,1),t.J(s.posMatrix,s.posMatrix,[-o*u,-l*u,0]),r[i]=s}else if(e.canonical.isChildOf(a.canonical)){let s=e.clone();s.posMatrix=new Float64Array(16);let n=e.canonical.z-a.canonical.z,o=e.canonical.x-(e.canonical.x>>n<<n),l=e.canonical.y-(e.canonical.y>>n<<n),u=t.X>>n;t.aQ(s.posMatrix,0,t.X,0,t.X,0,1),t.J(s.posMatrix,s.posMatrix,[o*u,l*u,0]),t.K(s.posMatrix,s.posMatrix,[1/2**n,1/2**n,0]),r[i]=s}}return r}getSourceTile(e,t){let r=this.sourceCache._source,i=e.overscaledZ-this.deltaZoom;if(i>r.maxzoom&&(i=r.maxzoom),i<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(i).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!a||!a.dem)&&t)for(;i>=r.minzoom&&(!a||!a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(i--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(t=>t.timeAdded>=e)}}class iS{constructor(e,t,r){this.painter=e,this.sourceCache=new ib(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,i,a=t.X){var s,n,o,l,u,h;if(!(r>=0&&r<a&&i>=0&&i<a))return 0;let c=this.getTerrainData(e),d=null===(s=c.tile)||void 0===s?void 0:s.dem;if(!d)return 0;let p=(n=[],o=[r/a*t.X,i/a*t.X],l=c.u_terrain_matrix,u=o[0],h=o[1],n[0]=l[0]*u+l[4]*h+l[12],n[1]=l[1]*u+l[5]*h+l[13],n),f=[p[0]*d.dim,p[1]*d.dim],m=Math.floor(f[0]),g=Math.floor(f[1]),y=f[0]-m,v=f[1]-g;return d.get(m,g)*(1-y)*(1-v)+d.get(m+1,g)*y*(1-v)+d.get(m,g+1)*(1-y)*v+d.get(m+1,g+1)*y*v}getElevationForLngLatZoom(e,r){let{tileID:i,mercatorX:a,mercatorY:s}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(i,a%t.X,s%t.X,t.X)}getElevation(e,r,i,a=t.X){return this.getDEMElevation(e,r,i,a)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let e=this.painter.context,r=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new C(e,r,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new C(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.ao([])}let r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){let e=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new C(e,r.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),r.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}let i=r&&r+r.tileID.key+e.key;if(i&&!this._demMatrixCache[i]){let i=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=i?a=e.canonical.z-i:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let s=e.canonical.x-(e.canonical.x>>a<<a),n=e.canonical.y-(e.canonical.y>>a<<a),o=t.bb(new Float64Array(16),[1/(t.X<<a),1/(t.X<<a),0]);t.J(o,o,[s*t.X,n*t.X,0]),this._demMatrixCache[e.key]={matrix:o,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){let t=this.painter,r=t.width/devicePixelRatio,i=t.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==r||this._fbo.height!==i)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new C(t.context,{width:r,height:i,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new C(t.context,{width:r,height:i,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,i,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,i))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,t=0;e<this._coordsTextureSize;e++)for(let i=0;i<this._coordsTextureSize;i++,t+=4)r[t+0]=255&i,r[t+1]=255&e,r[t+2]=i>>8<<4|e>>8,r[t+3]=0;let i=new C(e,new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let r=new Uint8Array(4),i=this.painter.context,a=i.gl,s=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),n=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),o=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),a.readPixels(s,o-n-1,1,1,a.RGBA,a.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null);let l=r[0]+(r[2]>>4<<8),u=r[1]+((15&r[2])<<8),h=this.coordsIndex[255-r[3]],c=h&&this.sourceCache.getTileByID(h);if(!c)return null;let d=this._coordsTextureSize,p=(1<<c.tileID.canonical.z)*d;return new t.Z((c.tileID.canonical.x*d+l)/p+c.tileID.wrap,(c.tileID.canonical.y*d+u)/p,this.getElevation(c.tileID,l,u,d))}depthAtPoint(e){let t=new Uint8Array(4),r=this.painter.context,i=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),i.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,i.RGBA,i.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,r=new t.bc,i=new t.aY,a=this.meshSize,s=t.X/a,n=a*a;for(let e=0;e<=a;e++)for(let t=0;t<=a;t++)r.emplaceBack(t*s,e*s,0);for(let e=0;e<n;e+=a+1)for(let t=0;t<a;t++)i.emplaceBack(t+e,a+t+e+1,a+t+e+2),i.emplaceBack(t+e,a+t+e+2,t+e+1);let o=r.length,l=o+2*(a+1);for(let e of[0,1])for(let i=0;i<=a;i++)for(let a of[0,1])r.emplaceBack(i*s,e*t.X,a);for(let e=0;e<2*a;e+=2)i.emplaceBack(l+e,l+e+1,l+e+3),i.emplaceBack(l+e,l+e+3,l+e+2),i.emplaceBack(o+e,o+e+3,o+e+1),i.emplaceBack(o+e,o+e+2,o+e+3);let u=r.length,h=u+2*(a+1);for(let e of[0,1])for(let i=0;i<=a;i++)for(let a of[0,1])r.emplaceBack(e*t.X,i*s,a);for(let e=0;e<2*a;e+=2)i.emplaceBack(u+e,u+e+1,u+e+3),i.emplaceBack(u+e,u+e+3,u+e+2),i.emplaceBack(h+e,h+e+3,h+e+1),i.emplaceBack(h+e,h+e+2,h+e+3);return this._mesh=new rx(e.createVertexBuffer(r,ix.members),e.createIndexBuffer(i),t.a0.simpleSegment(0,0,r.length,i.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*t.bd/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var r;let{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(r=this.getMinMaxElevation(i).minElevation)&&void 0!==r?r:0}getMinMaxElevation(e){let t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,r){let i=t.Z.fromLngLat(e.wrap()),a=(1<<r)*t.X,s=i.x*a,n=i.y*a,o=Math.floor(s/t.X),l=Math.floor(n/t.X);return{tileID:new t.S(r,0,r,o,l),mercatorX:s,mercatorY:n}}}class iw{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new C(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(r.texture),{id:e,fbo:t,texture:r,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let e of this._recentlyUsed)if(!this._objects[e].inUse)return this._objects[e];if(this._objects.length>=this._size)throw Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(e=>!e.inUse)}}let iE={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class iA{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new iw(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){for(let r in this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(r=>!e._layers[r].isHidden(t)),this._coordsDescendingInv={},e.sourceCaches)for(let t of(this._coordsDescendingInv[r]={},e.sourceCaches[r].getVisibleCoordinates())){let e=this.terrain.sourceCache.getTerrainCoords(t);for(let t in e)this._coordsDescendingInv[r][t]||(this._coordsDescendingInv[r][t]=[]),this._coordsDescendingInv[r][t].push(e[t])}for(let t of(this._coordsDescendingInvStr={},e._order)){let r=e._layers[t],i=r.source;if(iE[r.type]&&!this._coordsDescendingInvStr[i])for(let e in this._coordsDescendingInvStr[i]={},this._coordsDescendingInv[i])this._coordsDescendingInvStr[i][e]=this._coordsDescendingInv[i][e].map(e=>e.key).sort().join()}for(let e of this._renderableTiles)for(let t in this._coordsDescendingInvStr){let r=this._coordsDescendingInvStr[t][e.tileID.key];r&&r!==e.rttCoords[t]&&(e.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let r=e.type,i=this.painter,a=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(iE[r]&&(this._prevType&&iE[this._prevType]||this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(e.id),!a))return!0;if(iE[this._prevType]||iE[r]&&a){this._prevType=r;let e=this._stacks.length-1,a=this._stacks[e]||[];for(let r of this._renderableTiles){if(this.pool.isFull()&&(r_(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(r),r.rtt[e]){let t=this.pool.getObjectForId(r.rtt[e].id);if(t.stamp===r.rtt[e].stamp){this.pool.useObject(t);continue}}let s=this.pool.getOrCreateFreeObject();this.pool.useObject(s),this.pool.stampObject(s),r.rtt[e]={id:s.id,stamp:s.stamp},i.context.bindFramebuffer.set(s.fbo.framebuffer),i.context.clear({color:t.aN.transparent,stencil:0}),i.currentStencilSource=void 0;for(let e=0;e<a.length;e++){let t=i.style._layers[a[e]],n=t.source?this._coordsDescendingInv[t.source][r.tileID.key]:[r.tileID];i.context.viewport.set([0,0,s.fbo.width,s.fbo.height]),i._renderTileClippingMasks(t,n),i.renderLayer(i,i.style.sourceCaches[t.source],t,n),t.source&&(r.rttCoords[t.source]=this._coordsDescendingInvStr[t.source][r.tileID.key])}}return r_(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),iE[r]}return!1}}let iT={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},iC={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ig,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},iP=e=>{e.touchstart=e.dragStart,e.touchmoveWindow=e.dragMove,e.touchend=e.dragEnd},iR={showCompass:!0,showZoom:!0,visualizePitch:!1};class iI{constructor(e,r,i=!1){this.mousedown=e=>{this.startMouse(t.e({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),d.mousePos(this.element,e)),d.addEventListener(window,"mousemove",this.mousemove),d.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.moveMouse(e,d.mousePos(this.element,e))},this.mouseup=e=>{this.mouseRotate.dragEnd(e),this.mousePitch&&this.mousePitch.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=d.touchPos(this.element,e.targetTouches)[0],this.startTouch(e,this._startPos),d.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),d.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=d.touchPos(this.element,e.targetTouches)[0],this.moveTouch(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let a=e.dragRotate._mouseRotate.getClickTolerance(),s=e.dragRotate._mousePitch.getClickTolerance();this.element=r,this.mouseRotate=rJ({clickTolerance:a,enable:!0}),this.touchRotate=(({enable:e,clickTolerance:t,bearingDegreesPerPixelMoved:r=.8})=>new rY({clickTolerance:t,move:(e,t)=>({bearingDelta:(t.x-e.x)*r}),moveStateManager:new rX,enable:e,assignEvents:iP}))({clickTolerance:a,enable:!0}),this.map=e,i&&(this.mousePitch=rQ({clickTolerance:s,enable:!0}),this.touchPitch=(({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5})=>new rY({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:new rX,enable:e,assignEvents:iP}))({clickTolerance:s,enable:!0})),d.addEventListener(r,"mousedown",this.mousedown),d.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),d.addEventListener(r,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),d.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),d.disableDrag()}moveMouse(e,t){let r=this.map,{bearingDelta:i}=this.mouseRotate.dragMove(e,t)||{};if(i&&r.setBearing(r.getBearing()+i),this.mousePitch){let{pitchDelta:i}=this.mousePitch.dragMove(e,t)||{};i&&r.setPitch(r.getPitch()+i)}}moveTouch(e,t){let r=this.map,{bearingDelta:i}=this.touchRotate.dragMove(e,t)||{};if(i&&r.setBearing(r.getBearing()+i),this.touchPitch){let{pitchDelta:i}=this.touchPitch.dragMove(e,t)||{};i&&r.setPitch(r.getPitch()+i)}}off(){let e=this.element;d.removeEventListener(e,"mousedown",this.mousedown),d.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),d.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),d.removeEventListener(window,"touchend",this.touchend),d.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){d.enableDrag(),d.removeEventListener(window,"mousemove",this.mousemove),d.removeEventListener(window,"mouseup",this.mouseup),d.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),d.removeEventListener(window,"touchend",this.touchend)}}function iL(e,r,i){let a=new t.N(e.lng,e.lat);if(e=new t.N(e.lng,e.lat),r){let a=new t.N(e.lng-360,e.lat),s=new t.N(e.lng+360,e.lat),n=i.locationPoint(e).distSqr(r);i.locationPoint(a).distSqr(r)<n?e=a:i.locationPoint(s).distSqr(r)<n&&(e=s)}for(;Math.abs(e.lng-i.center.lng)>180;){let t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e.lng!==a.lng&&i.locationPoint(e).y>i.height/2-i.getHorizon()?e:a}let iO={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function iM(e,t,r){let i=e.classList;for(let e in iO)i.remove(`maplibregl-${r}-anchor-${e}`);i.add(`maplibregl-${r}-anchor-${t}`)}class ik extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{let t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},this._onMapClick=e=>{let t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},this._update=e=>{var t;if(!this._map)return;let r=this._map.loaded()&&!this._map.isMoving();"terrain"!==(null==e?void 0:e.type)&&("render"!==(null==e?void 0:e.type)||r)||this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?iL(this._lngLat,this._flatPos,this._map.transform):null===(t=this._lngLat)||void 0===t?void 0:t.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let i="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?i=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(i=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let a="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?a="rotateX(0deg)":"map"===this._pitchAlignment&&(a=`rotateX(${this._map.getPitch()}deg)`),e&&"moveend"!==e.type||(this._pos=this._pos.round()),d.setTransform(this._element,`${iO[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${a} ${i}`),c.frameAsync(new AbortController).then(()=>{this._updateOpacity(e&&"moveend"===e.type)}).catch(()=>{})},this._onMove=e=>{if(!this._isDragging){let t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.k("dragstart"))),this.fire(new t.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.k("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=d.create("div");let r=d.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");let i=d.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");let a=d.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");let s=d.createNS("http://www.w3.org/2000/svg","g");for(let e of(s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000"),[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}])){let t=d.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),s.appendChild(t)}let n=d.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"fill",this._color);let o=d.createNS("http://www.w3.org/2000/svg","path");o.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),n.appendChild(o);let l=d.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"opacity","0.25"),l.setAttributeNS(null,"fill","#000000");let u=d.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),l.appendChild(u);let h=d.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"transform","translate(6.0, 7.0)"),h.setAttributeNS(null,"fill","#FFFFFF");let c=d.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(8.0, 8.0)");let p=d.createNS("http://www.w3.org/2000/svg","circle");p.setAttributeNS(null,"fill","#000000"),p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"cx","5.5"),p.setAttributeNS(null,"cy","5.5"),p.setAttributeNS(null,"r","5.4999962");let f=d.createNS("http://www.w3.org/2000/svg","circle");f.setAttributeNS(null,"fill","#FFFFFF"),f.setAttributeNS(null,"cx","5.5"),f.setAttributeNS(null,"cy","5.5"),f.setAttributeNS(null,"r","5.4999962"),c.appendChild(p),c.appendChild(f),a.appendChild(s),a.appendChild(n),a.appendChild(l),a.appendChild(h),a.appendChild(c),r.appendChild(a),r.setAttributeNS(null,"height",41*this._scale+"px"),r.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(r),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",e=>{e.preventDefault()}),this._element.addEventListener("mousedown",e=>{e.preventDefault()}),iM(this._element,this._anchor,"marker"),e&&e.className)for(let t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),d.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let t=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;return this._element.style.opacity===this._opacityWhenCovered||e&&(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map))),this}_updateOpacity(e=!1){var r,i;if(!(null===(r=this._map)||void 0===r?void 0:r.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let a=this._map,s=a.terrain.depthAtPoint(this._pos),n=a.terrain.getElevationForLngLatZoom(this._lngLat,a.transform.tileZoom);if(a.transform.lngLatToCameraDepth(this._lngLat,n)-s<.006)return void(this._element.style.opacity=this._opacity);let o=-this._offset.y/a.transform._pixelPerMeter,l=Math.sin(a.getPitch()*Math.PI/180)*o,u=a.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),h=a.transform.lngLatToCameraDepth(this._lngLat,n+l)-u>.006;(null===(i=this._popup)||void 0===i?void 0:i.isOpen())&&h&&this._popup.remove(),this._element.style.opacity=h?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return void 0===e&&void 0===t&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}let iN={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},iD=0,iF=!1,iG={maxWidth:100,unit:"metric"};function iz(e,t,r){let i=r&&r.maxWidth||100,a=e._container.clientHeight/2,s=e.unproject([0,a]),n=e.unproject([i,a]),o=s.distanceTo(n);if(r&&"imperial"===r.unit){let r=3.2808*o;r>5280?iq(t,i,r/5280,e._getUIString("ScaleControl.Miles")):iq(t,i,r,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?iq(t,i,o/1852,e._getUIString("ScaleControl.NauticalMiles")):o>=1e3?iq(t,i,o/1e3,e._getUIString("ScaleControl.Kilometers")):iq(t,i,o,e._getUIString("ScaleControl.Meters"))}function iq(e,t,r,i){let a=function(e){let t=Math.pow(10,`${Math.floor(e)}`.length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){let t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r))}(r);e.style.width=a/r*t+"px",e.innerHTML=`${a}&nbsp;${i}`}let ij={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1};e.AJAXError=t.bg,e.Evented=t.E,e.LngLat=t.N,e.MercatorCoordinate=t.Z,e.Point=t.P,e.addProtocol=t.bh,e.config=t.a,e.removeProtocol=t.bi,e.AttributionControl=iy,e.BoxZoomHandler=rB,e.CanvasSource=ee,e.CooperativeGesturesHandler=iu,e.DoubleClickZoomHandler=ir,e.DragPanHandler=is,e.DragRotateHandler=io,e.EdgeInsets=rE,e.FullscreenControl=class extends t.E{constructor(e={}){super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=d.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){d.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=d.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);d.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=X,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{let r=new t.N(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,a=this._map.getBearing(),s=t.e({bearing:a},this.options.fitBoundsOptions),n=Z.fromLngLat(r,i);this._map.fitBounds(n,s,{geolocateSource:!0})},this._updateMarker=e=>{if(e){let r=new t.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation){if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&iF)return;this._setErrorState()}}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=e=>{if(this._map){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=d.create("button","maplibregl-ctrl-geolocate",this._container),d.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");let e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{let e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=d.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ik({element:this._dotElement}),this._circleElement=d.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ik({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.k("trackuserlocationend")),this.fire(new t.k("userlocationlostfocus")))})}},this.options=t.e({},iN,e)}onAdd(e){return this._map=e,this._container=d.create("div","maplibregl-ctrl maplibregl-ctrl-group"),(function(){return t._(this,arguments,void 0,function*(e=!1){if(void 0!==l&&!e)return l;if(void 0===window.navigator.permissions)return l=!!window.navigator.geolocation;try{let e=yield window.navigator.permissions.query({name:"geolocation"});l="denied"!==e.state}catch(e){l=!!window.navigator.geolocation}return l})})().then(e=>this._setupUI(e)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),d.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,iD=0,iF=!1}_isOutOfMapMaxBounds(e){let t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let e=this._map.getBounds(),t=e.getSouthEast(),r=e.getNorthEast(),i=t.distanceTo(r),a=Math.ceil(this._accuracy/(i/this._map._container.clientHeight)*2);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":iD--,iF=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.k("trackuserlocationstart")),this.fire(new t.k("userlocationfocus"));break;default:throw Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++iD>1?(e={maximumAge:6e5,timeout:0},iF=!0):(e=this.options.positionOptions,iF=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.Hash=rC,e.ImageSource=J,e.KeyboardHandler=r9,e.LngLatBounds=Z,e.LogoControl=iv,e.Map=class extends im{constructor(e){t.be.mark(t.bf.create);let r=Object.assign(Object.assign({},iC),e);if(null!=r.minZoom&&null!=r.maxZoom&&r.minZoom>r.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=r.minPitch&&null!=r.maxPitch&&r.minPitch>r.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=r.minPitch&&r.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=r.maxPitch&&r.maxPitch>85)throw Error("maxPitch must be less than or equal to 85");if(super(new rA(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new i_,this._controls=[],this._mapId=t.a4(),this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new t.k("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.k("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===r.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===r.preserveDrawingBuffer,this._antialias=!0===r.antialias,this._trackResize=!0===r.trackResize,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=!0===r.refreshExpiredTiles,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=!0===r.crossSourceCollisions,this._collectResourceTiming=!0===r.collectResourceTiming,this._locale=Object.assign(Object.assign({},iT),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===r.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=b.addThrottleControl(()=>this.isMoving()),this._requestManager=new _(r.transformRequest),"string"==typeof r.container){if(this._container=document.getElementById(r.container),!this._container)throw Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1,t=rT(e=>{this._trackResize&&!this._removed&&this.resize(e)._update()},50);this._resizeObserver=new ResizeObserver(r=>{e?t(r):e=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ip(this,r),this._hash=r.hash&&new rC("string"==typeof r.hash&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,t.e({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new iy("boolean"==typeof r.attributionControl?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new iv,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.k(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new t.k(`${e.dataType}dataloading`,e))}),this.on("dataabort",e=>{this.fire(new t.k("sourcedataabort",e))})}_getMapId(){return this._mapId}addControl(e,r){if(void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.j(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let i=e.onAdd(this);this._controls.push(e);let a=this._controlPositions[r];return -1!==r.indexOf("bottom")?a.insertBefore(i,a.firstChild):a.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.j(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,r,i){return null==i&&this.terrain&&(i=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,i)}resize(e){var r;let i=this._containerDimensions(),a=i[0],s=i[1],n=this._getClampedPixelRatio(a,s);if(this._resizeCanvas(a,s,n),this.painter.resize(a,s,n),this.painter.overLimit()){let e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];let t=this._getClampedPixelRatio(a,s);this._resizeCanvas(a,s,t),this.painter.resize(a,s,t)}this.transform.resize(a,s),null===(r=this._requestedCameraState)||void 0===r||r.resize(a,s);let o=!this._moving;return o&&(this.stop(),this.fire(new t.k("movestart",e)).fire(new t.k("move",e))),this.fire(new t.k("resize",e)),o&&this.fire(new t.k("moveend",e)),this}_getClampedPixelRatio(e,t){let{0:r,1:i}=this._maxCanvasSize,a=this.getPixelRatio(),s=e*a,n=t*a;return Math.min(s>r?r/s:1,n>i?i/n:1)*a}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Z.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>85)throw Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(t.N.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let i=!1;return{layer:t,listener:r,delegates:{mousemove:a=>{let s=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];s.length?i||(i=!0,r.call(this,new rD(e,this,a.originalEvent,{features:s}))):i=!1},mouseout:()=>{i=!1}}}}if("mouseleave"===e||"mouseout"===e){let i=!1;return{layer:t,listener:r,delegates:{mousemove:a=>{(this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[]).length?i=!0:i&&(i=!1,r.call(this,new rD(e,this,a.originalEvent)))},mouseout:t=>{i&&(i=!1,r.call(this,new rD(e,this,t.originalEvent)))}}}}return{layer:t,listener:r,delegates:{[e]:e=>{let i=this.getLayer(t)?this.queryRenderedFeatures(e.point,{layers:[t]}):[];i.length&&(e.features=i,r.call(this,e),delete e.features)}}}}on(e,t,r){if(void 0===r)return super.on(e,t);let i=this._createDelegatedListener(e,t,r);for(let t in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(i),i.delegates)this.on(t,i.delegates[t]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);let i=this._createDelegatedListener(e,t,r);for(let e in i.delegates)this.once(e,i.delegates[e]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&(i=>{let a=this._delegatedListeners[e];for(let e=0;e<a.length;e++){let i=a[e];if(i.layer===t&&i.listener===r){for(let e in i.delegates)this.off(e,i.delegates[e]);return a.splice(e,1),this}}})(),this)}queryRenderedFeatures(e,r){let i;if(!this.style)return[];let a=e instanceof t.P||Array.isArray(e),s=a?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(a?{}:e)||{},s instanceof t.P||"number"==typeof s[0])i=[t.P.convert(s)];else{let e=t.P.convert(s[0]),r=t.P.convert(s[1]);i=[e,new t.P(r.x,e.y),r,new t.P(e.x,r.y),e]}return this.style.queryRenderedFeatures(i,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,r){return!1!==(r=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let t=this._locale[e];if(null==t)throw Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(e,t));let r=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new eJ(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,r):this.style.loadJSON(e,t,r)):delete this.style,this}_lazyInitEmptyStyle(){this.style||(this.style=new eJ(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if("string"==typeof e){let i=this._requestManager.transformRequest(e,"Style");t.h(i,new AbortController).then(e=>{this._updateDiff(e.data,r)}).catch(e=>{e&&this.fire(new t.j(e))})}else"object"==typeof e&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(i){t.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){let r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.j(Error(`There is no source with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){let r=this.style.sourceCaches[e.source];if(!r)throw Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);for(let i in null===this.terrain&&r.reload(),this.style._layers){let r=this.style._layers[i];"hillshade"===r.type&&r.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new iS(this.painter,r,e),this.painter.renderToTexture=new iA(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=t=>{"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new t.k("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let t in e){let r=e[t]._tiles;for(let e in r){let t=r[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,r,i={}){let{pixelRatio:a=1,sdf:s=!1,stretchX:n,stretchY:o,content:l,textFitWidth:u,textFitHeight:h}=i;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||t.b(r))){if(void 0===r.width||void 0===r.height)return this.fire(new t.j(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:i,height:c,data:d}=r;return this.style.addImage(e,{data:new t.R({width:i,height:c},new Uint8Array(d)),pixelRatio:a,stretchX:n,stretchY:o,content:l,textFitWidth:u,textFitHeight:h,sdf:s,version:0,userImage:r}),r.onAdd&&r.onAdd(this,e),this}}{let{width:i,height:d,data:p}=c.getImageData(r);this.style.addImage(e,{data:new t.R({width:i,height:d},p),pixelRatio:a,stretchX:n,stretchY:o,content:l,textFitWidth:u,textFitHeight:h,sdf:s,version:0})}}updateImage(e,r){let i=this.style.getImage(e);if(!i)return this.fire(new t.j(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let{width:a,height:s,data:n}=r instanceof HTMLImageElement||t.b(r)?c.getImageData(r):r;if(void 0===a||void 0===s)return this.fire(new t.j(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==i.data.width||s!==i.data.height)return this.fire(new t.j(Error("The width and height of the updated image must be that same as the previous version of the image")));let o=!(r instanceof HTMLImageElement||t.b(r));return i.data.replace(n,o),this.style.updateImage(e,i),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.j(Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return b.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,i={}){return this.style.setPaintProperty(e,t,r,i),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,i={}){return this.style.setLayoutProperty(e,t,r,i),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,e=>{e||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,e=>{e||this._update(!0)}),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(e){return this._lazyInitEmptyStyle(),this.style.setSky(e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let t=this._canvasContainer=d.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=d.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let r=this._containerDimensions(),i=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],i);let a=this._controlContainer=d.create("div","maplibregl-control-container",e),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(e=>{s[e]=d.create("div",`maplibregl-ctrl-${e} `,a)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},t=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)},{once:!0});let r=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!r){let e="Failed to initialize WebGL";throw t?(t.message=e,Error(JSON.stringify(t))):Error(e)}this.painter=new rb(r,this.transform),p.testSupport(r)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded&&(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint()),this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let e=this.transform.zoom,a=c.now();this.style.zoomHistory.update(e,a);let s=new t.a9(e,{now:a,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),n=s.crossFadingFactor();1===n&&n===this._crossFadingFactor||(i=!0,this._crossFadingFactor=n),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new t.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.be.mark(t.bf.load),this.fire(new t.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let a=this._sourcesDirty||this._styleDirty||this._placementDirty;return a||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.k("idle")),!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,t.be.mark(t.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;for(let e of(this._hash&&this._hash.remove(),this._controls))e.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),b.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();let r=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==r?void 0:r.loseContext)&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),d.remove(this._canvasContainer),d.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),t.be.clearMetrics(),this._removed=!0,this.fire(new t.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,c.frameAsync(this._frameRequest).then(e=>{t.be.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return h}getCameraTargetElevation(){return this.transform.elevation}},e.MapMouseEvent=rD,e.MapTouchEvent=rF,e.MapWheelEvent=rG,e.Marker=ik,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{let e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{let e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,t)=>{let r=this._map._getUIString(`NavigationControl.${t}`);e.title=r,e.setAttribute("aria-label",r)},this.options=t.e({},iR,e),this._container=d.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),d.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),d.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=d.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new iI(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){d.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){let r=d.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}},e.Popup=class extends t.E{constructor(e){super(),this.remove=()=>(this._content&&d.remove(this._content),this._container&&(d.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=d.create("div","maplibregl-popup",this._map.getContainer()),this._tip=d.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?iL(this._lngLat,this._flatPos,this._map.transform):null===(r=this._lngLat)||void 0===r?void 0:r.wrap(),this._trackPointer&&!e)return;let i=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let a=this.options.anchor,s=function e(r){if(r){if("number"==typeof r){let e=Math.round(Math.abs(r)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,r),"top-left":new t.P(e,e),"top-right":new t.P(-e,e),bottom:new t.P(0,-r),"bottom-left":new t.P(e,-e),"bottom-right":new t.P(-e,-e),left:new t.P(r,0),right:new t.P(-r,0)}}if(r instanceof t.P||Array.isArray(r)){let e=t.P.convert(r);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:t.P.convert(r.center||[0,0]),top:t.P.convert(r.top||[0,0]),"top-left":t.P.convert(r["top-left"]||[0,0]),"top-right":t.P.convert(r["top-right"]||[0,0]),bottom:t.P.convert(r.bottom||[0,0]),"bottom-left":t.P.convert(r["bottom-left"]||[0,0]),"bottom-right":t.P.convert(r["bottom-right"]||[0,0]),left:t.P.convert(r.left||[0,0]),right:t.P.convert(r.right||[0,0])}}return e(new t.P(0,0))}(this.options.offset);if(!a){let e;let t=this._container.offsetWidth,r=this._container.offsetHeight;e=i.y+s.bottom.y<r?["top"]:i.y>this._map.transform.height-r?["bottom"]:[],i.x<t/2?e.push("left"):i.x>this._map.transform.width-t/2&&e.push("right"),a=0===e.length?"bottom":e.join("-")}let n=i.add(s[a]);this.options.subpixelPositioning||(n=n.round()),d.setTransform(this._container,`${iO[a]} translate(${n.x}px,${n.y}px)`),iM(this._container,a,"popup")},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(ij),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.N.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let t;let r=document.createDocumentFragment(),i=document.createElement("body");for(i.innerHTML=e;t=i.firstChild;)r.appendChild(t);return this.setDOMContent(r)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=d.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=d.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector("a[href], [tabindex]:not([tabindex='-1']), [contenteditable]:not([contenteditable='false']), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled])");e&&e.focus()}},e.RasterDEMTileSource=$,e.RasterTileSource=W,e.ScaleControl=class{constructor(e){this._onMove=()=>{iz(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,iz(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},iG),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=d.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){d.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=it,e.Style=eJ,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=d.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=d.create("button","maplibregl-ctrl-terrain",this._container),d.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){d.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=r7,e.TwoFingersTouchRotateHandler=r6,e.TwoFingersTouchZoomHandler=r3,e.TwoFingersTouchZoomRotateHandler=il,e.VectorTileSource=Y,e.VideoSource=Q,e.addSourceType=(e,r)=>t._(void 0,void 0,void 0,function*(){if(er(e))throw Error(`A source type called "${e}" already exists.`);et[e]=r}),e.clearPrewarmedResources=function(){let e=s;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(F),s=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.getMaxParallelImageRequests=function(){return t.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return en().getRTLTextPluginStatus()},e.getVersion=function(){return h},e.getWorkerCount=function(){return G.workerCount},e.getWorkerUrl=function(){return t.a.WORKER_URL},e.importScriptInWorkers=function(e){return B().broadcast("IS",e)},e.prewarm=function(){q().acquire(F)},e.setMaxParallelImageRequests=function(e){t.a.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setRTLTextPlugin=function(e,t){return en().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){G.workerCount=e},e.setWorkerUrl=function(e){t.a.WORKER_URL=e}}),e}()}),n("7mWsz",function(e,r){t(e.exports,"default",()=>h);var i=s("a6roo"),a=s("gzr8q"),n=s("lgqLq"),o=s("kPMpK"),l=s("63y7W");let u={"EPSG:3857":new o.default({featureProjection:"EPSG:3857"})};class h extends n.default{getFeaturesAtCoordinate(e,t=5){let r=this.getMapLibrePixels(e,t);if(!r)return[];let i=this.getLayer().get("queryRenderedFeaturesOptions")||{};return this.getLayer().mapLibreMap?.queryRenderedFeatures(r,i).map(e=>this.toOlFeature(e))||[]}prepareFrame(){return!0}renderFrame(e){let t=this.getLayer(),{mapLibreMap:r}=t,s=t.getMapInternal();if(!t||!s||!r)return null;let n=r.getCanvas(),{viewState:o}=e;r.jumpTo({center:(0,a.toLonLat)(o.center),zoom:o.zoom-1,bearing:(0,i.toDegrees)(-o.rotation)});let l=t.getOpacity().toString();return n&&l!==n.style.opacity&&(n.style.opacity=l),n.isConnected?n.width===Math.floor(e.size[0]*e.pixelRatio)&&n.height===Math.floor(e.size[1]*e.pixelRatio)||r.resize():s.render(),r.redraw(),r.getContainer()}getFeatures(e){let t=this.getLayer().getMapInternal()?.getCoordinateFromPixel(e);return Promise.resolve(this.getFeaturesAtCoordinate(t))}forEachFeatureAtCoordinate(e,t,r,i){let a=this.getFeaturesAtCoordinate(e,r);return a.forEach(e=>{let t=e.getGeometry();t instanceof l.default&&i(e,this.layer_,t)}),a?.[0]}getMapLibrePixels(e,t){if(!e)return;let r=this.getLayer().mapLibreMap?.project(a.toLonLat(e));if(r?.x===void 0||r?.y===void 0)return;let i=[r.x,r.y];if(t){let[e,r]=i;i=[[e-t,r-t],[e+t,r+t]]}return i}toOlFeature(e){let t=this.getLayer().getMapInternal(),r=t?.getView()?.getProjection()?.getCode()||"EPSG:3857";u[r]||(u[r]=new o.default({featureProjection:r}));let i=u[r].readFeature(e);return i&&i.set("vectorTileFeature",e,!0),i}}}),n("kol5K",function(e,r){t(e.exports,"default",()=>a);let i=e=>{let t=e.filter(e=>null!=e&&e.trim&&e.trim()),r=t.map(e=>e.toLowerCase());return[...new Set(r)].map(e=>t.find(t=>t.toLowerCase()===e))};var a=e=>{if(!e)return[];let{style:t}=e;if(!t)return[];let{sourceCaches:r}=t,a=[];return Object.values(r).forEach(e=>{if(e.used){let{attribution:t}=e.getSource();t&&(a=a.concat(t.replace(/&copy;/g,"©").split(/(<a.*?<\/a>)/)))}}),i(a)}}),n("ikPfL",function(e,r){t(e.exports,"default",()=>u);var i=s("5TDW7"),a=s("aZxrf"),n=s("5Nyxy"),o=s("9MiJs");class l extends i.default{constructor(){super()}}l.prototype.read=function(e){if("PBF"!==e.type)return null;let t=new a.default({source:new n.default({url:e.url,format:new o.default})});return this.readOptions(t,e),t},l.prototype.write=function(e){if("PBF"!==e.get("type"))return null;let t=e.getSource();return this.writeOptions(e,{url:t.getUrls()[0]})};var u=l}),n("6ClR3",function(e,r){t(e.exports,"default",()=>u);var i=s("5TDW7"),a=s("lDz1h"),n=s("gC3AG"),o=s("2yyih");class l extends i.default{constructor(){super()}}l.prototype.read=function(e){if("ECo"!==e.type)return null;let t=new a.default({source:new n.default(e.table),style:(0,o.default).getFeatureStyleFn(e.table)});return this.readOptions(t,e),t},l.prototype.write=function(e){if("ECo"!==e.get("type"))return null;let t=e.getSource();return this.writeOptions(e,{table:t.table_})};var u=l}),n("lDz1h",function(e,r){t(e.exports,"default",()=>o);var i=s("610XN"),a=s("jPVWI");class n extends i.default{constructor(e){super(e=e||{}),this.set("type","ECo"),this.getSource().on("addfeature",e=>{e.feature._layer=this})}}n.prototype.getPopupContent=a.default.prototype.getPopupContent,n.prototype.setPopupContent=a.default.prototype.setPopupContent,n.prototype.selectable=a.default.prototype.selectable,n.prototype.getIgnStyle=function(){return{}};var o=n}),n("gC3AG",function(e,r){t(e.exports,"default",()=>g);var i=s("cG2f3"),a=s("iGUgk"),n=s("20LS2"),o=s("iGyOD"),l=s("5up1I"),u=s("gmEQj"),h=s("gzr8q"),c=s("5NhYx"),d=s("23ytq"),p=s("fkmMz"),f=s("jSBAJ");i.default.defs["EPSG:2154"]||(0,i.default).defs("EPSG:2154","+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["IGNF:LAMB93"]||(0,i.default).defs("IGNF:LAMB93","+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:27572"]||(0,i.default).defs("EPSG:27572","+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),i.default.defs["EPSG:2975"]||(0,i.default).defs("EPSG:2975","+proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:4467"]||(0,i.default).defs("EPSG:4467","+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:4559"]||(0,i.default).defs("EPSG:4559","+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:5490"]||(0,i.default).defs("EPSG:5490","+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:2972"]||(0,i.default).defs("EPSG:2972","+proj=utm +zone=22 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),i.default.defs["EPSG:EPSG:4471"]||(0,i.default).defs("EPSG:4471","+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),(0,a.register)(i.default);class m extends n.default{constructor(e){let t=(e=e||{}).strategy||u.bbox;if(e.tile_zoom_level){let r=(0,c.createXYZ)({minZoom:e.tile_zoom_level,maxZoom:e.tile_zoom_level,tileSize:e.tileSize||256});t=(0,u.tile)(r)}super({strategy:t,attributions:e.attribution||"Espace Collaboratif",logo:e.logo,useSpatialIndex:!0,wrapX:e.wrapX}),this.tileloading_=0,this.table_=e,this.maxFeatures_=e.maxFeatures||5e3,this._outputformat=e.outputFormat||"JSON";let r=this.table_.columns[this.table_.geometry_name];r=r?r.crs:"IGNF:LAMB93",this.srsName_=r||"IGNF:LAMB93",i.default.defs[this.srsName_]||console.error("PROJECTION INCONNUE",this.srsName_),this.featureFilter_=e.filter||{},this.table_.columns.detruit?this.featureFilter_={detruit:!1}:this.table_.columns.gcms_detruit&&(this.featureFilter_={gcms_detruit:!1}),e.tile_zoom_level&&(this.tiled_=!0,this.maxReload_=e.maxReload),this._formatWKT=new l.default,this.setLoader(this.loaderFn_)}setLoader(e){this._auth=(0,f.getAuth)(),this._auth&&this.table_.tile_zoom_level&&(super.setLoader(e||this.loaderFn_),this.refresh())}}m.prototype.getWFSParam=function(e,t){let r=(0,h.transformExtent)(e,t,this.srsName_);return{service:"WFS",request:"GetFeature",outputFormat:this._outputformat||"JSON",typeName:this.table_.name,bbox:r.join(","),filter:JSON.stringify(this.featureFilter_),maxFeatures:this.maxFeatures_,version:"1.1.0"}},m.prototype._readFeatures=function(e,t){let r;"string"==typeof e&&(e=JSON.parse(e)),t=t||"EPSG:3857";let i=[],a=this.table_.geometry_name;for(var s=new l.default,n=/([-+]?(\d*[.])?\d+) ([-+]?(\d*[.])?\d+) ([-+]?(\d*[.])?\d+)/g,u=0;u<e.length;u++){var h=e[u][a];if(h.type){var c=(0,d.ol_geom_createFromType)(h.type,h.coordinates);c.transform(this.srsName_,t),r=new o.default(c)}else{h=h.replace(n,"$1 $3");try{r=s.readFeature(h,{dataProjection:this.srsName_,featureProjection:t})}catch(t){console.error("[BAD FORMAT] error line: ",u,e[u]);continue}}let l=e[u];delete l[a],r.setProperties(l,!0),i.push(r)}return i},m.prototype.findFeature_=function(e){let t=this.table_.id_name,r=e.get(t);if(this.tiled_){var i=e.getGeometry().getFirstCoordinate();if(function(i){for(let a=0;a<i.length;a++)if(i[a].get(t)===r)return e=i[a],!0;return!1}(this.getFeaturesInExtent([i[0]-.1,i[1]-.1,i[0]+.1,i[1]+.1])))return null}return e},m.prototype.reload=function(){this.refresh(),this.dispatchEvent({type:"reload",maxreload:this.maxReload_})},m.prototype.loaderFn_=function(e,t,r){let a=this;this.projection_=r,i.default.defs[this.srsName_]&&(this.maxReload_&&1===this.tileloading_&&this.getFeatures().length>this.maxReload_&&this.reload(),this.dispatchEvent({type:"loadstart",remains:++this.tileloading_}),(0,p.default).get({url:this.table_.wfs,auth:this._auth,data:this.getWFSParam(e,r),options:{},success:function(e){let t=[];a._readFeatures(e,r).forEach(e=>{let r=a.findFeature_(e);r&&t.push(r)}),a.tiled_||a.clear(),t.length&&a.addFeatures(t),a.dispatchEvent({type:"loadend",remains:--a.tileloading_}),e.length==a.maxFeatures_&&a.dispatchEvent({type:"overload"})},error:e=>{var t;"abort"!=(t="error")?a.dispatchEvent({type:"loadend",error:e.message,status:t,remains:--a.tileloading_}):a.dispatchEvent({type:"loadend",remains:--a.tileloading_})}}))};var g=m}),n("cG2f3",function(e,r){t(e.exports,"default",()=>p);var i=s("fVhdY"),a=s("7J5S7"),n=s("gdtqa"),o=s("gstUr"),l=s("3YN4r"),u=s("dLS86"),h=s("9ItUw"),c=s("cnmDo"),d=s("guiH1");i.default.defaultDatum="WGS84",i.default.Proj=a.default,i.default.WGS84=new i.default.Proj("WGS84"),i.default.Point=n.default,i.default.toPoint=o.default,i.default.defs=l.default,i.default.nadgrid=u.default,i.default.transform=h.default,i.default.mgrs=c.default,i.default.version="__VERSION__",(0,d.default)(i.default);var p=i.default}),n("fVhdY",function(e,r){t(e.exports,"default",()=>u);var i=s("7J5S7"),a=s("9ItUw"),n=(0,i.default)("WGS84");function o(e,t,r,i){var s,n,o;return Array.isArray(r)?(s=(0,a.default)(e,t,r,i)||{x:NaN,y:NaN},r.length>2)?(void 0===e.name||"geocent"!==e.name)&&(void 0===t.name||"geocent"!==t.name)?[s.x,s.y].concat(r.slice(2)):"number"==typeof s.z?[s.x,s.y,s.z].concat(r.slice(3)):[s.x,s.y,r[2]].concat(r.slice(3)):[s.x,s.y]:(n=(0,a.default)(e,t,r,i),2===(o=Object.keys(r)).length||o.forEach(function(i){if(void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name){if("x"===i||"y"===i||"z"===i)return}else if("x"===i||"y"===i)return;n[i]=r[i]}),n)}function l(e){return e instanceof i.default?e:e.oProj?e.oProj:(0,i.default)(e)}var u=function(e,t,r){e=l(e);var i,a=!1;return(void 0===t?(t=e,e=n,a=!0):(void 0!==t.x||Array.isArray(t))&&(r=t,t=e,e=n,a=!0),t=l(t),r)?o(e,t,r):(i={forward:function(r,i){return o(e,t,r,i)},inverse:function(r,i){return o(t,e,r,i)}},a&&(i.oProj=t),i)}}),n("7J5S7",function(e,r){t(e.exports,"default",()=>p);var i=s("7QHWi"),a=s("cGnMA"),n=s("2Ggeo"),o=s("02BW5"),l=s("lG5ev"),u=s("5GO2w"),h=s("et3gj"),c=s("dLS86");function d(e,t){if(!(this instanceof d))return new d(e);t=t||function(e){if(e)throw e};var r=(0,i.default)(e);if("object"!=typeof r){t("Could not parse to valid json: "+e);return}var s=d.projections.get(r.projName);if(!s){t("Could not get projection name from: "+e);return}if(r.datumCode&&"none"!==r.datumCode){var n=(0,h.default)(l.default,r.datumCode);n&&(r.datum_params=r.datum_params||(n.towgs84?n.towgs84.split(","):null),r.ellps=n.ellipse,r.datumName=n.datumName?n.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84",r.lat1=r.lat1||r.lat0;var p=(0,o.sphere)(r.a,r.b,r.rf,r.ellps,r.sphere),f=(0,o.eccentricity)(p.a,p.b,p.rf,r.R_A),m=(0,c.getNadgrids)(r.nadgrids),g=r.datum||(0,u.default)(r.datumCode,r.datum_params,p.a,p.b,f.es,f.ep2,m);(0,a.default)(this,r),(0,a.default)(this,s),this.a=p.a,this.b=p.b,this.rf=p.rf,this.sphere=p.sphere,this.es=f.es,this.e=f.e,this.ep2=f.ep2,this.datum=g,this.init(),t(null,this)}d.projections=n.default,d.projections.start();var p=d}),n("7QHWi",function(e,r){t(e.exports,"default",()=>h);var i=s("3YN4r"),a=s("fffKN"),n=s("6fhwX"),o=s("et3gj"),l=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],u=["3857","900913","3785","102113"],h=function(e){if("string"!=typeof e)return e;if(e in i.default)return i.default[e];if(l.some(function(t){return e.indexOf(t)>-1})){var t=(0,a.default)(e);if(function(e){var t=(0,o.default)(e,"authority");if(t){var r=(0,o.default)(t,"epsg");return r&&u.indexOf(r)>-1}}(t))return i.default["EPSG:3857"];var r=function(e){var t=(0,o.default)(e,"extension");if(t)return(0,o.default)(t,"proj4")}(t);return r?(0,n.default)(r):t}if("+"===e[0])return(0,n.default)(e)}}),n("3YN4r",function(e,r){t(e.exports,"default",()=>l);var i=s("B0lHT"),a=s("6fhwX"),n=s("fffKN");function o(e){var t=this;if(2==arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?o[e]=(0,a.default)(arguments[1]):o[e]=(0,n.default)(arguments[1]):o[e]=r}else if(1==arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?o.apply(t,e):o(e)});if("string"==typeof e){if(e in o)return o[e]}else"EPSG"in e?o["EPSG:"+e.EPSG]=e:"ESRI"in e?o["ESRI:"+e.ESRI]=e:"IAU2000"in e?o["IAU2000:"+e.IAU2000]=e:console.log(e);return}}(0,i.default)(o);var l=o}),n("B0lHT",function(e,r){t(e.exports,"default",()=>i);function i(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}}),n("6fhwX",function(e,r){t(e.exports,"default",()=>l);var i=s("7M1Nv"),a=s("caeKH"),n=s("giYbV"),o=s("et3gj");function l(e){var t,r,s,l={},u=e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){var r=t.split("=");return r.push(!0),e[r[0].toLowerCase()]=r[1],e},{}),h={proj:"projName",datum:"datumCode",rf:function(e){l.rf=parseFloat(e)},lat_0:function(e){l.lat0=e*i.D2R},lat_1:function(e){l.lat1=e*i.D2R},lat_2:function(e){l.lat2=e*i.D2R},lat_ts:function(e){l.lat_ts=e*i.D2R},lon_0:function(e){l.long0=e*i.D2R},lon_1:function(e){l.long1=e*i.D2R},lon_2:function(e){l.long2=e*i.D2R},alpha:function(e){l.alpha=parseFloat(e)*i.D2R},gamma:function(e){l.rectified_grid_angle=parseFloat(e)},lonc:function(e){l.longc=e*i.D2R},x_0:function(e){l.x0=parseFloat(e)},y_0:function(e){l.y0=parseFloat(e)},k_0:function(e){l.k0=parseFloat(e)},k:function(e){l.k0=parseFloat(e)},a:function(e){l.a=parseFloat(e)},b:function(e){l.b=parseFloat(e)},r:function(e){l.a=l.b=parseFloat(e)},r_a:function(){l.R_A=!0},zone:function(e){l.zone=parseInt(e,10)},south:function(){l.utmSouth=!0},towgs84:function(e){l.datum_params=e.split(",").map(function(e){return parseFloat(e)})},to_meter:function(e){l.to_meter=parseFloat(e)},units:function(e){l.units=e;var t=(0,o.default)(n.default,e);t&&(l.to_meter=t.to_meter)},from_greenwich:function(e){l.from_greenwich=e*i.D2R},pm:function(e){var t=(0,o.default)(a.default,e);l.from_greenwich=(t||parseFloat(e))*i.D2R},nadgrids:function(e){"@null"===e?l.datumCode="none":l.nadgrids=e},axis:function(e){var t="ewnsud";3===e.length&&-1!==t.indexOf(e.substr(0,1))&&-1!==t.indexOf(e.substr(1,1))&&-1!==t.indexOf(e.substr(2,1))&&(l.axis=e)},approx:function(){l.approx=!0}};for(t in u)r=u[t],t in h?"function"==typeof(s=h[t])?s(r):l[s]=r:l[t]=r;return"string"==typeof l.datumCode&&"WGS84"!==l.datumCode&&(l.datumCode=l.datumCode.toLowerCase()),l}}),n("7M1Nv",function(e,r){t(e.exports,"PJD_3PARAM",()=>i),t(e.exports,"PJD_7PARAM",()=>a),t(e.exports,"PJD_GRIDSHIFT",()=>s),t(e.exports,"PJD_WGS84",()=>n),t(e.exports,"PJD_NODATUM",()=>o),t(e.exports,"SRS_WGS84_SEMIMAJOR",()=>l),t(e.exports,"SRS_WGS84_SEMIMINOR",()=>u),t(e.exports,"SRS_WGS84_ESQUARED",()=>h),t(e.exports,"SEC_TO_RAD",()=>c),t(e.exports,"HALF_PI",()=>d),t(e.exports,"SIXTH",()=>p),t(e.exports,"RA4",()=>f),t(e.exports,"RA6",()=>m),t(e.exports,"EPSLN",()=>g),t(e.exports,"D2R",()=>y),t(e.exports,"R2D",()=>v),t(e.exports,"FORTPI",()=>_),t(e.exports,"TWO_PI",()=>x),t(e.exports,"SPI",()=>b);var i=1,a=2,s=3,n=4,o=5,l=6378137,u=6356752.314,h=.0066943799901413165,c=484813681109536e-20,d=Math.PI/2,p=.16666666666666666,f=.04722222222222222,m=.022156084656084655,g=1e-10,y=.017453292519943295,v=57.29577951308232,_=Math.PI/4,x=2*Math.PI,b=3.14159265359}),n("caeKH",function(e,r){t(e.exports,"default",()=>i);var i={};i.greenwich=0,i.lisbon=-9.131906111111,i.paris=2.337229166667,i.bogota=-74.080916666667,i.madrid=-3.687938888889,i.rome=12.452333333333,i.bern=7.439583333333,i.jakarta=106.807719444444,i.ferro=-17.666666666667,i.brussels=4.367975,i.stockholm=18.058277777778,i.athens=23.7163375,i.oslo=10.722916666667}),n("giYbV",function(e,r){t(e.exports,"default",()=>i);var i={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}}}),n("et3gj",function(e,r){t(e.exports,"default",()=>a);var i=/[\s_\-\/\(\)]/g;function a(e,t){if(e[t])return e[t];for(var r,a=Object.keys(e),s=t.toLowerCase().replace(i,""),n=-1;++n<a.length;)if((r=a[n]).toLowerCase().replace(i,"")===s)return e[r]}}),n("fffKN",function(e,r){t(e.exports,"default",()=>l);var i=s("877Zt"),a=s("cUVW6"),n=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function o(e){return .017453292519943295*e}function l(e){var t=(0,i.default)(e),r=t[0],s={};return(0,a.sExpr)(t,s),function e(t){for(var r=Object.keys(t),i=0,a=r.length;i<a;++i){var s=r[i];-1!==n.indexOf(s)&&function(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var r="",i=0,a=e.AXIS.length;i<a;++i){var s=[e.AXIS[i][0].toLowerCase(),e.AXIS[i][1].toLowerCase()];-1!==s[0].indexOf("north")||("y"===s[0]||"lat"===s[0])&&"north"===s[1]?r+="n":-1!==s[0].indexOf("south")||("y"===s[0]||"lat"===s[0])&&"south"===s[1]?r+="s":-1!==s[0].indexOf("east")||("x"===s[0]||"lon"===s[0])&&"east"===s[1]?r+="e":(-1!==s[0].indexOf("west")||("x"===s[0]||"lon"===s[0])&&"west"===s[1])&&(r+="w")}2===r.length&&(r+="u"),3===r.length&&(e.axis=r)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var n=e.GEOGCS;function l(t){return t*(e.to_meter||1)}"GEOGCS"===e.type&&(n=e),n&&(n.DATUM?e.datumCode=n.DATUM.name.toLowerCase():e.datumCode=n.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_1949"===e.datumCode&&(e.datumCode="nzgd49"),("wgs_1984"===e.datumCode||"world_geodetic_system_1984"===e.datumCode)&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"belge_1972"===e.datumCode&&(e.datumCode="rnb72"),n.DATUM&&n.DATUM.SPHEROID&&(e.ellps=n.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=n.DATUM.SPHEROID.a,e.rf=parseFloat(n.DATUM.SPHEROID.rf,10)),n.DATUM&&n.DATUM.TOWGS84&&(e.datum_params=n.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",o],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",o],["x0","false_easting",l],["y0","false_northing",l],["long0","central_meridian",o],["lat0","latitude_of_origin",o],["lat0","standard_parallel_1",o],["lat1","standard_parallel_1",o],["lat2","standard_parallel_2",o],["azimuth","Azimuth"],["alpha","azimuth",o],["srsCode","name"]].forEach(function(t){var r,i;return r=t[0],i=t[1],void(!(r in e)&&i in e&&(e[r]=e[i],3===t.length&&(e[r]=t[2](e[r]))))}),!e.long0&&e.longc&&("Albers_Conic_Equal_Area"===e.projName||"Lambert_Azimuthal_Equal_Area"===e.projName)&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&("Stereographic_South_Pole"===e.projName||"Polar Stereographic (variant B)"===e.projName)?(e.lat0=o(e.lat1>0?90:-90),e.lat_ts=e.lat1):!e.lat_ts&&e.lat0&&"Polar_Stereographic"===e.projName&&(e.lat_ts=e.lat0,e.lat0=o(e.lat0>0?90:-90))}(t[s]),"object"==typeof t[s]&&e(t[s])}}(s),s[r]}}),n("877Zt",function(e,r){t(e.exports,"default",()=>i);var i=function(e){return new u(e).output()},a=/\s/,s=/[A-Za-z]/,n=/[A-Za-z84_]/,o=/[,\]]/,l=/[\d\.E\-\+]/;function u(e){if("string"!=typeof e)throw Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}u.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;a.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case 1:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case -1:return}},u.prototype.afterquote=function(e){if('"'===e){this.word+='"',this.state=4;return}if(o.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},u.prototype.afterItem=function(e){if(","===e){null!==this.word&&this.currentObject.push(this.word),this.word=null,this.state=1;return}if("]"===e){this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=-1);return}},u.prototype.number=function(e){if(l.test(e)){this.word+=e;return}if(o.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw Error("havn't handled \""+e+'" in number yet, index '+this.place)},u.prototype.quoted=function(e){if('"'===e){this.state=5;return}this.word+=e},u.prototype.keyword=function(e){if(n.test(e)){this.word+=e;return}if("["===e){var t=[];t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=1;return}if(o.test(e)){this.afterItem(e);return}throw Error("havn't handled \""+e+'" in keyword yet, index '+this.place)},u.prototype.neutral=function(e){if(s.test(e)){this.word=e,this.state=2;return}if('"'===e){this.word="",this.state=4;return}if(l.test(e)){this.word=e,this.state=3;return}if(o.test(e)){this.afterItem(e);return}throw Error("havn't handled \""+e+'" in neutral yet, index '+this.place)},u.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw Error('unable to parse string "'+this.text+'". State is '+this.state)}}),n("cUVW6",function(e,r){function i(e,t,r){Array.isArray(t)&&(r.unshift(t),t=null);var i=t?{}:e,s=r.reduce(function(e,t){return a(t,e),e},i);t&&(e[t]=s)}function a(e,t){if(!Array.isArray(e)){t[e]=!0;return}var r,s=e.shift();if("PARAMETER"===s&&(s=e.shift()),1===e.length){if(Array.isArray(e[0])){t[s]={},a(e[0],t[s]);return}t[s]=e[0];return}if(!e.length){t[s]=!0;return}if("TOWGS84"===s){t[s]=e;return}if("AXIS"===s){s in t||(t[s]=[]),t[s].push(e);return}switch(Array.isArray(s)||(t[s]={}),s){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[s]={name:e[0].toLowerCase(),convert:e[1]},3===e.length&&a(e[2],t[s]);return;case"SPHEROID":case"ELLIPSOID":t[s]={name:e[0],a:e[1],rf:e[2]},4===e.length&&a(e[3],t[s]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],i(t,s,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],i(t,s,e),t[s].type=s;return;default:for(r=-1;++r<e.length;)if(!Array.isArray(e[r]))return a(e,t[s]);return i(t,s,e)}}t(e.exports,"sExpr",()=>a)}),n("cGnMA",function(e,r){t(e.exports,"default",()=>i);function i(e,t){var r,i;if(e=e||{},!t)return e;for(i in t)void 0!==(r=t[i])&&(e[i]=r);return e}}),n("2Ggeo",function(e,r){t(e.exports,"default",()=>h);var i=s("39V3b"),a=s("jDVoF"),n=[i.default,a.default],o={},l=[];function u(e,t){var r=l.length;return e.names?(l[r]=e,e.names.forEach(function(e){o[e.toLowerCase()]=r}),this):(console.log(t),!0)}var h={start:function(){n.forEach(u)},add:u,get:function(e){if(!e)return!1;var t=e.toLowerCase();if(void 0!==o[t]&&l[o[t]])return l[o[t]]}}}),n("39V3b",function(e,r){t(e.exports,"default",()=>u);var i=s("1gqnK"),a=s("kEf05"),n=s("8RM2D"),o=s("7qdiL"),l=s("7M1Nv"),u={init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=(0,i.default)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,r,i=e.x,s=e.y;if(s*l.R2D>90&&s*l.R2D<-90&&i*l.R2D>180&&i*l.R2D<-180||Math.abs(Math.abs(s)-l.HALF_PI)<=l.EPSLN)return null;if(this.sphere)t=this.x0+this.a*this.k0*(0,a.default)(i-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(l.FORTPI+.5*s));else{var o=(0,n.default)(this.e,s,Math.sin(s));t=this.x0+this.a*this.k0*(0,a.default)(i-this.long0),r=this.y0-this.a*this.k0*Math.log(o)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,i=e.x-this.x0,s=e.y-this.y0;if(this.sphere)r=l.HALF_PI-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var n=Math.exp(-s/(this.a*this.k0));if(-9999===(r=(0,o.default)(this.e,n)))return null}return t=(0,a.default)(this.long0+i/(this.a*this.k0)),e.x=t,e.y=r,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]}}),n("1gqnK",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r){var i=e*t;return r/Math.sqrt(1-i*i)}}),n("kEf05",function(e,r){t(e.exports,"default",()=>n);var i=s("7M1Nv"),a=s("SsFAj");function n(e){return Math.abs(e)<=i.SPI?e:e-(0,a.default)(e)*i.TWO_PI}}),n("SsFAj",function(e,r){t(e.exports,"default",()=>i);function i(e){return e<0?-1:1}}),n("8RM2D",function(e,r){t(e.exports,"default",()=>a);var i=s("7M1Nv");function a(e,t,r){var a=e*r;return a=Math.pow((1-a)/(1+a),.5*e),Math.tan(.5*(i.HALF_PI-t))/a}}),n("7qdiL",function(e,r){t(e.exports,"default",()=>a);var i=s("7M1Nv");function a(e,t){for(var r,a,s=.5*e,n=i.HALF_PI-2*Math.atan(t),o=0;o<=15;o++)if(r=e*Math.sin(n),a=i.HALF_PI-2*Math.atan(t*Math.pow((1-r)/(1+r),s))-n,n+=a,1e-10>=Math.abs(a))return n;return -9999}}),n("jDVoF",function(e,r){function i(e){return e}t(e.exports,"default",()=>a);var a={init:function(){},forward:i,inverse:i,names:["longlat","identity"]}}),n("02BW5",function(e,r){t(e.exports,"eccentricity",()=>o),t(e.exports,"sphere",()=>l);var i=s("7M1Nv"),a=s("lXEbW"),n=s("et3gj");function o(e,t,r,a){var s=e*e,n=t*t,o=(s-n)/s,l=0;return a?(e*=1-o*(i.SIXTH+o*(i.RA4+o*i.RA6)),s=e*e,o=0):l=Math.sqrt(o),{es:o,e:l,ep2:(s-n)/n}}function l(e,t,r,s,o){if(!e){var l=(0,n.default)(a.default,s);l||(l=a.WGS84),e=l.a,t=l.b,r=l.rf}return r&&!t&&(t=(1-1/r)*e),(0===r||Math.abs(e-t)<i.EPSLN)&&(o=!0,t=e),{a:e,b:t,rf:r,sphere:o}}}),n("lXEbW",function(e,r){t(e.exports,"default",()=>i),t(e.exports,"WGS84",()=>a);var i={};i.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},i.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},i.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},i.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},i.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},i.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},i.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},i.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},i.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},i.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},i.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},i.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},i.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},i.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},i.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},i.clrk80ign={a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},i.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},i.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},i.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},i.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},i.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},i.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},i.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},i.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},i.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},i.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},i.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},i.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},i.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},i.hough={a:6378270,rf:297,ellipseName:"Hough"},i.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},i.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},i.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},i.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},i.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},i.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},i.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},i.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},i.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},i.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},i.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},i.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var a=i.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};i.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}}),n("lG5ev",function(e,r){t(e.exports,"default",()=>n);var i={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var a in i){var s=i[a];i[s.datumName]=s}var n=i}),n("5GO2w",function(e,r){t(e.exports,"default",()=>a);var i=s("7M1Nv"),a=function(e,t,r,a,s,n,o){var l={};return void 0===e||"none"===e?l.datum_type=i.PJD_NODATUM:l.datum_type=i.PJD_WGS84,t&&(l.datum_params=t.map(parseFloat),(0!==l.datum_params[0]||0!==l.datum_params[1]||0!==l.datum_params[2])&&(l.datum_type=i.PJD_3PARAM),l.datum_params.length>3&&(0!==l.datum_params[3]||0!==l.datum_params[4]||0!==l.datum_params[5]||0!==l.datum_params[6])&&(l.datum_type=i.PJD_7PARAM,l.datum_params[3]*=i.SEC_TO_RAD,l.datum_params[4]*=i.SEC_TO_RAD,l.datum_params[5]*=i.SEC_TO_RAD,l.datum_params[6]=l.datum_params[6]/1e6+1)),o&&(l.datum_type=i.PJD_GRIDSHIFT,l.grids=o),l.a=r,l.b=a,l.es=s,l.ep2=n,l}}),n("dLS86",function(e,r){t(e.exports,"default",()=>a),t(e.exports,"getNadgrids",()=>s);var i={};function a(e,t){var r,a=new DataView(t),s=11!==a.getInt32(8,!1)&&(11!==a.getInt32(8,!0)&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0),n={nFields:a.getInt32(8,s),nSubgridFields:a.getInt32(24,s),nSubgrids:a.getInt32(40,s),shiftType:l(a,56,64).trim(),fromSemiMajorAxis:a.getFloat64(120,s),fromSemiMinorAxis:a.getFloat64(136,s),toSemiMajorAxis:a.getFloat64(152,s),toSemiMinorAxis:a.getFloat64(168,s)},u=function(e,t,r){for(var i=176,a=[],s=0;s<t.nSubgrids;s++){var n,u={name:l(e,(n=i)+8,n+16).trim(),parent:l(e,n+24,n+24+8).trim(),lowerLatitude:e.getFloat64(n+72,r),upperLatitude:e.getFloat64(n+88,r),lowerLongitude:e.getFloat64(n+104,r),upperLongitude:e.getFloat64(n+120,r),latitudeInterval:e.getFloat64(n+136,r),longitudeInterval:e.getFloat64(n+152,r),gridNodeCount:e.getInt32(n+168,r)},h=function(e,t,r,i){for(var a=t+176,s=[],n=0;n<r.gridNodeCount;n++){var o={latitudeShift:e.getFloat32(a+16*n,i),longitudeShift:e.getFloat32(a+16*n+4,i),latitudeAccuracy:e.getFloat32(a+16*n+8,i),longitudeAccuracy:e.getFloat32(a+16*n+12,i)};s.push(o)}return s}(e,i,u,r),c=Math.round(1+(u.upperLongitude-u.lowerLongitude)/u.longitudeInterval),d=Math.round(1+(u.upperLatitude-u.lowerLatitude)/u.latitudeInterval);a.push({ll:[o(u.lowerLongitude),o(u.lowerLatitude)],del:[o(u.longitudeInterval),o(u.latitudeInterval)],lim:[c,d],count:u.gridNodeCount,cvs:h.map(function(e){return[o(e.longitudeShift),o(e.latitudeShift)]})}),i+=176+16*u.gridNodeCount}return a}(a,n,s),h={header:n,subgrids:u};return i[e]=h,h}function s(e){return void 0===e?null:e.split(",").map(n)}function n(e){if(0===e.length)return null;var t="@"===e[0];return(t&&(e=e.slice(1)),"null"===e)?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:i[e]||null,isNull:!1}}function o(e){return e/3600*Math.PI/180}function l(e,t,r){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,r)))}}),n("9ItUw",function(e,r){t(e.exports,"default",()=>function e(t,r,s,h){var c,d,p=void 0!==(s=Array.isArray(s)?(0,l.default)(s):{x:s.x,y:s.y,z:s.z,m:s.m}).z;if((0,u.default)(s),t.datum&&r.datum&&(((c=t).datum.datum_type===i.PJD_3PARAM||c.datum.datum_type===i.PJD_7PARAM||c.datum.datum_type===i.PJD_GRIDSHIFT)&&"WGS84"!==r.datumCode||(r.datum.datum_type===i.PJD_3PARAM||r.datum.datum_type===i.PJD_7PARAM||r.datum.datum_type===i.PJD_GRIDSHIFT)&&"WGS84"!==c.datumCode)&&(s=e(t,d=new o.default("WGS84"),s,h),t=d),h&&"enu"!==t.axis&&(s=(0,n.default)(t,!1,s)),"longlat"===t.projName)s={x:s.x*i.D2R,y:s.y*i.D2R,z:s.z||0};else if(t.to_meter&&(s={x:s.x*t.to_meter,y:s.y*t.to_meter,z:s.z||0}),!(s=t.inverse(s)))return;if(t.from_greenwich&&(s.x+=t.from_greenwich),s=(0,a.default)(t.datum,r.datum,s))return(r.from_greenwich&&(s={x:s.x-r.from_greenwich,y:s.y,z:s.z||0}),"longlat"===r.projName?s={x:s.x*i.R2D,y:s.y*i.R2D,z:s.z||0}:(s=r.forward(s),r.to_meter&&(s={x:s.x/r.to_meter,y:s.y/r.to_meter,z:s.z||0})),h&&"enu"!==r.axis)?(0,n.default)(r,!0,s):(s&&!p&&delete s.z,s)});var i=s("7M1Nv"),a=s("6k5Uh"),n=s("9in7W"),o=s("7J5S7"),l=s("gstUr"),u=s("hyITn")}),n("6k5Uh",function(e,r){t(e.exports,"default",()=>l);var i=s("7M1Nv"),a=s("cbJeb"),n=s("kEf05");function o(e){return e===i.PJD_3PARAM||e===i.PJD_7PARAM}function l(e,t,r){if((0,a.compareDatums)(e,t)||e.datum_type===i.PJD_NODATUM||t.datum_type===i.PJD_NODATUM)return r;var s=e.a,n=e.es;if(e.datum_type===i.PJD_GRIDSHIFT){if(0!==u(e,!1,r))return;s=i.SRS_WGS84_SEMIMAJOR,n=i.SRS_WGS84_ESQUARED}var l=t.a,h=t.b,c=t.es;if(t.datum_type===i.PJD_GRIDSHIFT&&(l=i.SRS_WGS84_SEMIMAJOR,h=i.SRS_WGS84_SEMIMINOR,c=i.SRS_WGS84_ESQUARED),n===c&&s===l&&!o(e.datum_type)&&!o(t.datum_type)||(r=(0,a.geodeticToGeocentric)(r,n,s),o(e.datum_type)&&(r=(0,a.geocentricToWgs84)(r,e.datum_type,e.datum_params)),o(t.datum_type)&&(r=(0,a.geocentricFromWgs84)(r,t.datum_type,t.datum_params)),r=(0,a.geocentricToGeodetic)(r,c,l,h),t.datum_type!==i.PJD_GRIDSHIFT||0===u(t,!0,r)))return r}function u(e,t,r){if(null===e.grids||0===e.grids.length)return console.log("Grid shift grids not found"),-1;var a={x:-r.x,y:r.y},s={x:Number.NaN,y:Number.NaN},o=[];r:for(var l=0;l<e.grids.length;l++){var u=e.grids[l];if(o.push(u.name),u.isNull){s=a;break}if(u.mandatory,null===u.grid){if(u.mandatory)return console.log("Unable to find mandatory grid '"+u.name+"'"),-1;continue}for(var c=u.grid.subgrids,d=0,p=c.length;d<p;d++){var f=c[d],m=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,g=f.ll[0]-m,y=f.ll[1]-m,v=f.ll[0]+(f.lim[0]-1)*f.del[0]+m,_=f.ll[1]+(f.lim[1]-1)*f.del[1]+m;if(!(y>a.y)&&!(g>a.x)&&!(_<a.y)&&!(v<a.x)&&!isNaN((s=function(e,t,r){var i={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return i;var a={x:e.x,y:e.y};a.x-=r.ll[0],a.y-=r.ll[1],a.x=(0,n.default)(a.x-Math.PI)+Math.PI;var s=h(a,r);if(t){if(isNaN(s.x))return i;s.x=a.x-s.x,s.y=a.y-s.y;var o,l,u=9;do{if(isNaN((l=h(s,r)).x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:a.x-(l.x+s.x),y:a.y-(l.y+s.y)},s.x+=o.x,s.y+=o.y}while(u--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12)if(u<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=(0,n.default)(s.x+r.ll[0]),i.y=s.y+r.ll[1]}else isNaN(s.x)||(i.x=e.x+s.x,i.y=e.y+s.y);return i}(a,t,f)).x))break r}}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*i.R2D+" "+a.y*i.R2D+" tried: '"+o+"'"),-1):(r.x=-s.x,r.y=s.y,0)}function h(e,t){var r,i={x:e.x/t.del[0],y:e.y/t.del[1]},a={x:Math.floor(i.x),y:Math.floor(i.y)},s={x:i.x-1*a.x,y:i.y-1*a.y},n={x:Number.NaN,y:Number.NaN};if(a.x<0||a.x>=t.lim[0]||a.y<0||a.y>=t.lim[1])return n;r=a.y*t.lim[0]+a.x;var o={x:t.cvs[r][0],y:t.cvs[r][1]};r++;var l={x:t.cvs[r][0],y:t.cvs[r][1]};r+=t.lim[0];var u={x:t.cvs[r][0],y:t.cvs[r][1]};r--;var h={x:t.cvs[r][0],y:t.cvs[r][1]},c=s.x*s.y,d=s.x*(1-s.y),p=(1-s.x)*(1-s.y),f=(1-s.x)*s.y;return n.x=p*o.x+d*l.x+f*h.x+c*u.x,n.y=p*o.y+d*l.y+f*h.y+c*u.y,n}}),n("cbJeb",function(e,r){t(e.exports,"compareDatums",()=>a),t(e.exports,"geodeticToGeocentric",()=>n),t(e.exports,"geocentricToGeodetic",()=>o),t(e.exports,"geocentricToWgs84",()=>l),t(e.exports,"geocentricFromWgs84",()=>u);var i=s("7M1Nv");function a(e,t){return!(e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(e.datum_type===i.PJD_3PARAM?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type!==i.PJD_7PARAM||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}function n(e,t,r){var a,s,n,o=e.x,l=e.y,u=e.z?e.z:0;if(l<-i.HALF_PI&&l>-1.001*i.HALF_PI)l=-i.HALF_PI;else if(l>i.HALF_PI&&l<1.001*i.HALF_PI)l=i.HALF_PI;else if(l<-i.HALF_PI)return{x:-1/0,y:-1/0,z:e.z};else if(l>i.HALF_PI)return{x:1/0,y:1/0,z:e.z};return o>Math.PI&&(o-=2*Math.PI),s=Math.sin(l),n=Math.cos(l),{x:((a=r/Math.sqrt(1-s*s*t))+u)*n*Math.cos(o),y:(a+u)*n*Math.sin(o),z:(a*(1-t)+u)*s}}function o(e,t,r,a){var s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x=1e-12*1e-12,b=e.x,S=e.y,w=e.z?e.z:0;if(s=Math.sqrt(b*b+S*S),n=Math.sqrt(b*b+S*S+w*w),s/r<1e-12){if(v=0,n/r<1e-12)return i.HALF_PI,_=-a,{x:e.x,y:e.y,z:e.z}}else v=Math.atan2(S,b);o=w/n,u=1/Math.sqrt(1-t*(2-t)*(l=s/n)*l),d=l*(1-t)*u,p=o*u,y=0;do y++,c=r/Math.sqrt(1-t*p*p),_=s*d+w*p-c*(1-t*p*p),u=1/Math.sqrt(1-(h=t*c/(c+_))*(2-h)*l*l),f=l*(1-h)*u,g=(m=o*u)*d-f*p,d=f,p=m;while(g*g>x&&y<30)return{x:v,y:Math.atan(m/Math.abs(f)),z:_}}function l(e,t,r){if(t===i.PJD_3PARAM)return{x:e.x+r[0],y:e.y+r[1],z:e.z+r[2]};if(t===i.PJD_7PARAM){var a=r[0],s=r[1],n=r[2],o=r[3],l=r[4],u=r[5],h=r[6];return{x:h*(e.x-u*e.y+l*e.z)+a,y:h*(u*e.x+e.y-o*e.z)+s,z:h*(-l*e.x+o*e.y+e.z)+n}}}function u(e,t,r){if(t===i.PJD_3PARAM)return{x:e.x-r[0],y:e.y-r[1],z:e.z-r[2]};if(t===i.PJD_7PARAM){var a=r[0],s=r[1],n=r[2],o=r[3],l=r[4],u=r[5],h=r[6],c=(e.x-a)/h,d=(e.y-s)/h,p=(e.z-n)/h;return{x:c+u*d-l*p,y:-u*c+d+o*p,z:l*c-o*d+p}}}}),n("9in7W",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r){var i,a,s,n=r.x,o=r.y,l=r.z||0,u={};for(s=0;s<3;s++)if(!t||2!==s||void 0!==r.z)switch(0===s?(i=n,a=-1!=="ew".indexOf(e.axis[s])?"x":"y"):1===s?(i=o,a=-1!=="ns".indexOf(e.axis[s])?"y":"x"):(i=l,a="z"),e.axis[s]){case"e":case"n":u[a]=i;break;case"w":case"s":u[a]=-i;break;case"u":void 0!==r[a]&&(u.z=i);break;case"d":void 0!==r[a]&&(u.z=-i);break;default:return null}return u}}),n("gstUr",function(e,r){t(e.exports,"default",()=>i);function i(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}}),n("hyITn",function(e,r){function i(e){a(e.x),a(e.y)}function a(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw TypeError("coordinates must be finite numbers")}t(e.exports,"default",()=>i)}),n("gdtqa",function(e,r){t(e.exports,"default",()=>n);var i=s("cnmDo");function a(e,t,r){if(!(this instanceof a))return new a(e,t,r);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===t){var i=e.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=e,this.y=t,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}a.fromMGRS=function(e){return new a((0,i.toPoint)(e))},a.prototype.toMGRS=function(e){return(0,i.forward)([this.x,this.y],e)};var n=a}),n("cnmDo",function(e,r){t(e.exports,"default",()=>s),t(e.exports,"forward",()=>n),t(e.exports,"toPoint",()=>o);var i="AJSAJS",a="AFAFAF",s={forward:n,inverse:function(e){var t=h(d(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},toPoint:o};function n(e,t){var r,s,n,o,u,h,d,p,f,m,g,y,v,_,x;return t=t||5,r=function(e){var t,r,i,a,s,n,o,u=e.lat,h=e.lon,c=l(u),d=l(h);o=Math.floor((h+180)/6)+1,180===h&&(o=60),u>=56&&u<64&&h>=3&&h<12&&(o=32),u>=72&&u<84&&(h>=0&&h<9?o=31:h>=9&&h<21?o=33:h>=21&&h<33?o=35:h>=33&&h<42&&(o=37)),n=l((o-1)*6-180+3),r=6378137/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),i=Math.tan(c)*Math.tan(c),a=.006739496752268451*Math.cos(c)*Math.cos(c),s=Math.cos(c)*(d-n);var p=.9996*(6378137*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3418046101696858e-24*Math.sin(6*c))+r*Math.tan(c)*(s*s/2+(5-i+9*a+4*a*a)*s*s*s*s/24+(61-58*i+i*i+600*a-2.2240339282485886)*s*s*s*s*s*s/720));return u<0&&(p+=1e7),{northing:Math.round(p),easting:Math.round(.9996*r*(s+(1-i+a)*s*s*s/6+(5-18*i+i*i+72*a-.39089081163157013)*s*s*s*s*s/120)+5e5),zoneNumber:o,zoneLetter:(t="Z",84>=u&&u>=72?t="X":72>u&&u>=64?t="W":64>u&&u>=56?t="V":56>u&&u>=48?t="U":48>u&&u>=40?t="T":40>u&&u>=32?t="S":32>u&&u>=24?t="R":24>u&&u>=16?t="Q":16>u&&u>=8?t="P":8>u&&u>=0?t="N":0>u&&u>=-8?t="M":-8>u&&u>=-16?t="L":-16>u&&u>=-24?t="K":-24>u&&u>=-32?t="J":-32>u&&u>=-40?t="H":-40>u&&u>=-48?t="G":-48>u&&u>=-56?t="F":-56>u&&u>=-64?t="E":-64>u&&u>=-72?t="D":-72>u&&u>=-80&&(t="C"),t)}}({lat:e[1],lon:e[0]}),s=t,n="00000"+r.easting,o="00000"+r.northing,r.zoneNumber+r.zoneLetter+(u=r.easting,h=r.northing,d=c(r.zoneNumber),p=Math.floor(u/1e5),f=Math.floor(h/1e5)%20,m=d-1,g=i.charCodeAt(m),y=a.charCodeAt(m),v=g+p-1,_=y+f,x=!1,v>90&&(v=v-90+65-1,x=!0),(73===v||g<73&&v>73||(v>73||g<73)&&x)&&v++,(79===v||g<79&&v>79||(v>79||g<79)&&x)&&73==++v&&v++,v>90&&(v=v-90+65-1),_>86?(_=_-86+65-1,x=!0):x=!1,(73===_||y<73&&_>73||(_>73||y<73)&&x)&&_++,(79===_||y<79&&_>79||(_>79||y<79)&&x)&&73==++_&&_++,_>86&&(_=_-86+65-1),String.fromCharCode(v)+String.fromCharCode(_))+n.substr(n.length-5,s)+o.substr(o.length-5,s)}function o(e){var t=h(d(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function l(e){return Math.PI/180*e}function u(e){return e/Math.PI*180}function h(e){var t,r,i,a,s,n,o,l,c=e.northing,d=e.easting,p=e.zoneLetter,f=e.zoneNumber;if(f<0||f>60)return null;var m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),g=c;p<"N"&&(g-=1e7),t=6378137/Math.sqrt(1-.00669438*Math.sin(o=(n=g/.9996/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*n)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*n)+151*m*m*m/96*Math.sin(6*n))*Math.sin(o)),r=Math.tan(o)*Math.tan(o),i=.006739496752268451*Math.cos(o)*Math.cos(o),a=6335439.32722994/Math.pow(1-.00669438*Math.sin(o)*Math.sin(o),1.5),s=(d-5e5)/(.9996*t);var y=o-t*Math.tan(o)/a*(s*s/2-(5+3*r+10*i-4*i*i-.06065547077041606)*s*s*s*s/24+(61+90*r+298*i+45*r*r-1.6983531815716497-3*i*i)*s*s*s*s*s*s/720);y=u(y);var v=(s-(1+2*r+i)*s*s*s/6+(5-2*i+28*r-3*i*i+.05391597401814761+24*r*r)*s*s*s*s*s/120)/Math.cos(o);if(v=(f-1)*6-180+3+u(v),e.accuracy){var _=h({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});l={top:_.lat,right:_.lon,bottom:y,left:v}}else l={lat:y,lon:v};return l}function c(e){var t=e%6;return 0===t&&(t=6),t}function d(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,r,s=e.length,n=null,o="",l=0;!/[A-Z]/.test(t=e.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+e;o+=t,l++}var u=parseInt(o,10);if(0===l||l+3>s)throw"MGRSPoint bad conversion from: "+e;var h=e.charAt(l++);if(h<="A"||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+e;n=e.substring(l,l+=2);for(var d=c(u),p=function(e,t){for(var r=i.charCodeAt(t-1),a=1e5,s=!1;r!==e.charCodeAt(0);){if(73==++r&&r++,79===r&&r++,r>90){if(s)throw"Bad character: "+e;r=65,s=!0}a+=1e5}return a}(n.charAt(0),d),f=function(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var r=a.charCodeAt(t-1),i=0,s=!1;r!==e.charCodeAt(0);){if(73==++r&&r++,79===r&&r++,r>86){if(s)throw"Bad character: "+e;r=65,s=!0}i+=1e5}return i}(n.charAt(1),d);f<function(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}(h);)f+=2e6;var m=s-l;if(m%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var g=m/2,y=0,v=0;return g>0&&(r=1e5/Math.pow(10,g),y=parseFloat(e.substring(l,l+g))*r,v=parseFloat(e.substring(l+g))*r),{easting:y+p,northing:v+f,zoneLetter:h,zoneNumber:u,accuracy:r}}}),n("guiH1",function(e,r){t(e.exports,"default",()=>N);var i=s("5BH1M"),a=s("es3WD"),n=s("8Yaq4"),o=s("1RG4F"),l=s("37ccA"),u=s("1awqj"),h=s("l0GLf"),c=s("lodNN"),d=s("jkgJa"),p=s("2HFid"),f=s("9v6gR"),m=s("aYCax"),g=s("8zzks"),y=s("5DoFA"),v=s("jobMi"),_=s("fKioj"),x=s("fQxFh"),b=s("gu5X1"),S=s("4yyqR"),w=s("bMtlW"),E=s("bSwxC"),A=s("2BpE3"),T=s("h1KUb"),C=s("1nGnS"),P=s("lAm4d"),R=s("l7o7b"),I=s("hc3Bp"),L=s("1pXHs"),O=s("bZa0m"),M=s("fhacK"),k=s("eIVBm");function N(e){e.Proj.projections.add(i.default),e.Proj.projections.add(a.default),e.Proj.projections.add(n.default),e.Proj.projections.add(o.default),e.Proj.projections.add(l.default),e.Proj.projections.add(u.default),e.Proj.projections.add(h.default),e.Proj.projections.add(c.default),e.Proj.projections.add(d.default),e.Proj.projections.add(p.default),e.Proj.projections.add(f.default),e.Proj.projections.add(m.default),e.Proj.projections.add(g.default),e.Proj.projections.add(y.default),e.Proj.projections.add(v.default),e.Proj.projections.add(_.default),e.Proj.projections.add(x.default),e.Proj.projections.add(b.default),e.Proj.projections.add(S.default),e.Proj.projections.add(w.default),e.Proj.projections.add(E.default),e.Proj.projections.add(A.default),e.Proj.projections.add(T.default),e.Proj.projections.add(C.default),e.Proj.projections.add(P.default),e.Proj.projections.add(R.default),e.Proj.projections.add(I.default),e.Proj.projections.add(L.default),e.Proj.projections.add(O.default),e.Proj.projections.add(M.default),e.Proj.projections.add(k.default)}}),n("5BH1M",function(e,r){t(e.exports,"default",()=>h);var i=s("lz6WA"),a=s("8GYcG"),n=s("6NyiU"),o=s("kEf05"),l=s("7M1Nv"),u=s("SsFAj"),h={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=(0,i.default)(this.es),this.ml0=(0,a.default)(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t,r,i=e.x,s=e.y,n=(0,o.default)(i-this.long0),u=Math.sin(s),h=Math.cos(s);if(this.es){var c=h*n,d=Math.pow(c,2),p=this.ep2*Math.pow(h,2),f=Math.pow(p,2),m=Math.pow(Math.abs(h)>l.EPSLN?Math.tan(s):0,2),g=Math.pow(m,2);c/=Math.sqrt(1-this.es*Math.pow(u,2));var y=(0,a.default)(s,u,h,this.en);t=this.a*(this.k0*c*(1+d/6*(1-m+p+d/20*(5-18*m+g+14*p-58*m*p+d/42*(61+179*g-g*m-479*m)))))+this.x0,r=this.a*(this.k0*(y-this.ml0+u*n*c/2*(1+d/12*(5-m+9*p+4*f+d/30*(61+g-58*m+270*p-330*m*p+d/56*(1385+543*g-g*m-3111*m))))))+this.y0}else{var v=h*Math.sin(n);if(Math.abs(Math.abs(v)-1)<l.EPSLN)return 93;if(t=.5*this.a*this.k0*Math.log((1+v)/(1-v))+this.x0,(v=Math.abs(r=h*Math.cos(n)/Math.sqrt(1-Math.pow(v,2))))>=1){if(v-1>l.EPSLN)return 93;r=0}else r=Math.acos(r);s<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return e.x=t,e.y=r,e},inverse:function(e){var t,r,i,a,s=(e.x-this.x0)*(1/this.a),h=(e.y-this.y0)*(1/this.a);if(this.es){if(t=this.ml0+h/this.k0,Math.abs(r=(0,n.default)(t,this.es,this.en))<l.HALF_PI){var c=Math.sin(r),d=Math.cos(r),p=Math.abs(d)>l.EPSLN?Math.tan(r):0,f=this.ep2*Math.pow(d,2),m=Math.pow(f,2),g=Math.pow(p,2),y=Math.pow(g,2),v=s*Math.sqrt(t=1-this.es*Math.pow(c,2))/this.k0,_=Math.pow(v,2);t*=p,i=r-t*_/(1-this.es)*.5*(1-_/12*(5+3*g-9*f*g+f-4*m-_/30*(61+90*g-252*f*g+45*y+46*f-_/56*(1385+3633*g+4095*y+1574*y*g)))),a=(0,o.default)(this.long0+v*(1-_/6*(1+2*g+f-_/20*(5+28*g+24*y+8*f*g+6*f-_/42*(61+662*g+1320*y+720*y*g))))/d)}else i=l.HALF_PI*(0,u.default)(h),a=0}else{var x=Math.exp(s/this.k0),b=.5*(x-1/x),S=Math.cos(this.lat0+h/this.k0);i=Math.asin(t=Math.sqrt((1-Math.pow(S,2))/(1+Math.pow(b,2)))),h<0&&(i=-i),a=0===b&&0===S?0:(0,o.default)(Math.atan2(b,S)+this.long0)}return e.x=a,e.y=i,e},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]}}),n("lz6WA",function(e,r){t(e.exports,"default",()=>i);function i(e){var t=[];t[0]=1-e*(.25+e*(.046875+e*(.01953125+.01068115234375*e))),t[1]=e*(.75-e*(.046875+e*(.01953125+.01068115234375*e)));var r=e*e;return t[2]=r*(.46875-e*(.013020833333333334+.007120768229166667*e)),r*=e,t[3]=r*(.3645833333333333-.005696614583333333*e),t[4]=r*e*.3076171875,t}}),n("8GYcG",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r,i){return r*=t,t*=t,i[0]*e-r*(i[1]+t*(i[2]+t*(i[3]+t*i[4])))}}),n("6NyiU",function(e,r){t(e.exports,"default",()=>n);var i=s("8GYcG"),a=s("7M1Nv");function n(e,t,r){for(var s=1/(1-t),n=e,o=20;o;--o){var l=Math.sin(n),u=1-t*l*l;if(u=((0,i.default)(n,l,Math.cos(n),r)-e)*(u*Math.sqrt(u))*s,n-=u,Math.abs(u)<a.EPSLN)break}return n}}),n("es3WD",function(e,r){t(e.exports,"init",()=>d),t(e.exports,"forward",()=>p),t(e.exports,"inverse",()=>f),t(e.exports,"names",()=>m),t(e.exports,"default",()=>g);var i=s("5BH1M"),a=s("63eZQ"),n=s("9ijWS"),o=s("lDRbx"),l=s("cMuZ8"),u=s("hcIfS"),h=s("30KR7"),c=s("kEf05");function d(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&((0,i.default).init.apply(this),this.forward=i.default.forward,this.inverse=i.default.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),r=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+-2854/675*t))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+4642/4725*t))))),r*=t,this.cgb[1]=r*(7/3+t*(-1.6+t*(-227/45+t*(2704/315+2323/945*t)))),this.cbg[1]=r*(5/3+t*(-16/15+t*(-13/9+t*(904/315+-1522/945*t)))),r*=t,this.cgb[2]=r*(56/15+t*(-136/35+t*(-1262/105+73814/2835*t))),this.cbg[2]=r*(-26/15+t*(34/21+t*(1.6+-12686/2835*t))),r*=t,this.cgb[3]=r*(4279/630+t*(-332/35+-399572/14175*t)),this.cbg[3]=r*(1237/630+t*(-2.4+-24832/14175*t)),r*=t,this.cgb[4]=r*(4174/315+-144838/6237*t),this.cbg[4]=r*(-734/315+109598/31185*t),r*=t,this.cgb[5]=601676/22275*r,this.cbg[5]=444337/155925*r,r=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+r*(1/4+r*(1/64+r/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+-96199/604800*t))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+7891/37800*t))))),this.utg[1]=r*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+1118711/3870720*t)))),this.gtu[1]=r*(13/48+t*(-.6+t*(557/1440+t*(281/630+-1983433/1935360*t)))),r*=t,this.utg[2]=r*(-17/480+t*(37/840+t*(209/4480+-5569/90720*t))),this.gtu[2]=r*(61/240+t*(-103/140+t*(15061/26880+167603/181440*t))),r*=t,this.utg[3]=r*(-4397/161280+t*(11/504+830251/7257600*t)),this.gtu[3]=r*(49561/161280+t*(-179/168+6601661/7257600*t)),r*=t,this.utg[4]=r*(-4583/161280+108847/3991680*t),this.gtu[4]=r*(34729/80640+-3418889/1995840*t),r*=t,this.utg[5]=-20648693/638668800*r,this.gtu[5]=.6650675310896665*r;var a=(0,l.default)(this.cbg,this.lat0);this.Zb=-this.Qn*(a+(0,u.default)(this.gtu,2*a))}function p(e){var t,r,i=(0,c.default)(e.x-this.long0),a=e.y,s=Math.sin(a=(0,l.default)(this.cbg,a)),u=Math.cos(a),d=Math.sin(i),p=Math.cos(i);a=Math.atan2(s,p*u),i=Math.atan2(d*u,(0,n.default)(s,u*p)),i=(0,o.default)(Math.tan(i));var f=(0,h.default)(this.gtu,2*a,2*i);return a+=f[0],2.623395162778>=Math.abs(i+=f[1])?(t=this.a*(this.Qn*i)+this.x0,r=this.a*(this.Qn*a+this.Zb)+this.y0):(t=1/0,r=1/0),e.x=t,e.y=r,e}function f(e){var t,r,i=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);if(s=(s-this.Zb)/this.Qn,2.623395162778>=Math.abs(i/=this.Qn)){var o=(0,h.default)(this.utg,2*s,2*i);s+=o[0],i+=o[1],i=Math.atan((0,a.default)(i));var u=Math.sin(s),d=Math.cos(s),p=Math.sin(i),f=Math.cos(i);s=Math.atan2(u*f,(0,n.default)(p,f*d)),i=Math.atan2(p,f*d),t=(0,c.default)(i+this.long0),r=(0,l.default)(this.cgb,s)}else t=1/0,r=1/0;return e.x=t,e.y=r,e}var m=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"],g={init:d,forward:p,inverse:f,names:m}}),n("63eZQ",function(e,r){t(e.exports,"default",()=>i);function i(e){var t=Math.exp(e);return(t-1/t)/2}}),n("9ijWS",function(e,r){t(e.exports,"default",()=>i);function i(e,t){var r=Math.max(e=Math.abs(e),t=Math.abs(t)),i=Math.min(e,t)/(r||1);return r*Math.sqrt(1+Math.pow(i,2))}}),n("lDRbx",function(e,r){t(e.exports,"default",()=>n);var i=s("9ijWS"),a=s("jZ7FQ");function n(e){var t=Math.abs(e);return t=(0,a.default)(t*(1+t/((0,i.default)(1,t)+1))),e<0?-t:t}}),n("jZ7FQ",function(e,r){t(e.exports,"default",()=>i);function i(e){var t=1+e,r=t-1;return 0===r?e:e*Math.log(t)/r}}),n("cMuZ8",function(e,r){t(e.exports,"default",()=>i);function i(e,t){for(var r,i=2*Math.cos(2*t),a=e.length-1,s=e[a],n=0;--a>=0;)r=-n+i*s+e[a],n=s,s=r;return t+r*Math.sin(2*t)}}),n("hcIfS",function(e,r){t(e.exports,"default",()=>i);function i(e,t){for(var r,i=2*Math.cos(t),a=e.length-1,s=e[a],n=0;--a>=0;)r=-n+i*s+e[a],n=s,s=r;return Math.sin(t)*r}}),n("30KR7",function(e,r){t(e.exports,"default",()=>n);var i=s("63eZQ"),a=s("em6GO");function n(e,t,r){for(var s,n,o=Math.sin(t),l=Math.cos(t),u=(0,i.default)(r),h=(0,a.default)(r),c=2*l*h,d=-2*o*u,p=e.length-1,f=e[p],m=0,g=0,y=0;--p>=0;)s=g,n=m,f=-s+c*(g=f)-d*(m=y)+e[p],y=-n+d*g+c*m;return[(c=o*h)*f-(d=l*u)*y,c*y+d*f]}}),n("em6GO",function(e,r){t(e.exports,"default",()=>i);function i(e){var t=Math.exp(e);return(t+1/t)/2}}),n("8Yaq4",function(e,r){t(e.exports,"default",()=>o);var i=s("jcKxu"),a=s("es3WD"),n=s("7M1Nv"),o={init:function(){var e=(0,i.default)(this.zone,this.long0);if(void 0===e)throw Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*n.D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,(0,a.default).init.apply(this),this.forward=a.default.forward,this.inverse=a.default.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"}}),n("jcKxu",function(e,r){t(e.exports,"default",()=>a);var i=s("kEf05");function a(e,t){if(void 0===e){if((e=Math.floor(((0,i.default)(t)+Math.PI)*30/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}}),n("1RG4F",function(e,r){t(e.exports,"default",()=>o);var i=s("bUfcr"),a=s("kEf05"),n=s("9ijWS"),o={init:function(){(0,i.default).init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,r,s,n;return e.x=(0,a.default)(e.x-this.long0),(0,i.default).forward.apply(this,[e]),t=Math.sin(e.y),r=Math.cos(e.y),s=Math.cos(e.x),n=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*r*s),e.x=n*r*Math.sin(e.x),e.y=n*(this.cosc0*t-this.sinc0*r*s),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,r,s,o,l;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,l=(0,n.default)(e.x,e.y)){var u=2*Math.atan2(l,this.R2);t=Math.sin(u),o=Math.asin((r=Math.cos(u))*this.sinc0+e.y*t*this.cosc0/l),s=Math.atan2(e.x*t,l*this.cosc0*r-e.y*this.sinc0*t)}else o=this.phic0,s=0;return e.x=s,e.y=o,(0,i.default).inverse.apply(this,[e]),e.x=(0,a.default)(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]}}),n("bUfcr",function(e,r){t(e.exports,"default",()=>n);var i=s("2JMAV"),a=s("7M1Nv"),n={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+a.FORTPI)/(Math.pow(Math.tan(.5*this.lat0+a.FORTPI),this.C)*(0,i.default)(this.e*e,this.ratexp))},forward:function(e){var t=e.x,r=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+a.FORTPI),this.C)*(0,i.default)(this.e*Math.sin(r),this.ratexp))-a.HALF_PI,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,r=e.y,s=Math.pow(Math.tan(.5*r+a.FORTPI)/this.K,1/this.C),n=20;n>0&&!(1e-14>Math.abs((r=2*Math.atan(s*(0,i.default)(this.e*Math.sin(e.y),-.5*this.e))-a.HALF_PI)-e.y));--n)e.y=r;return n?(e.x=t,e.y=r,e):null},names:["gauss"]}}),n("2JMAV",function(e,r){t(e.exports,"default",()=>i);function i(e,t){return Math.pow((1-e)/(1+e),t)}}),n("37ccA",function(e,r){t(e.exports,"ssfn_",()=>h),t(e.exports,"init",()=>c),t(e.exports,"forward",()=>d),t(e.exports,"inverse",()=>p),t(e.exports,"names",()=>f),t(e.exports,"default",()=>m);var i=s("7M1Nv"),a=s("SsFAj"),n=s("1gqnK"),o=s("8RM2D"),l=s("7qdiL"),u=s("kEf05");function h(e,t,r){return t*=r,Math.tan(.5*(i.HALF_PI+e))*Math.pow((1-t)/(1+t),.5*r)}function c(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i.EPSLN&&(this.k0=.5*(1+(0,a.default)(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=i.EPSLN&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i.EPSLN&&Math.abs(Math.cos(this.lat_ts))>i.EPSLN&&(this.k0=.5*this.cons*(0,n.default)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/(0,o.default)(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=(0,n.default)(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-i.HALF_PI,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function d(e){var t,r,a,s,n,l,h=e.x,c=e.y,d=Math.sin(c),p=Math.cos(c),f=(0,u.default)(h-this.long0);if(Math.abs(Math.abs(h-this.long0)-Math.PI)<=i.EPSLN&&Math.abs(c+this.lat0)<=i.EPSLN)return e.x=NaN,e.y=NaN,e;if(this.sphere)t=2*this.k0/(1+this.sinlat0*d+this.coslat0*p*Math.cos(f)),e.x=this.a*t*p*Math.sin(f)+this.x0,e.y=this.a*t*(this.coslat0*d-this.sinlat0*p*Math.cos(f))+this.y0;else{if(s=Math.cos(r=2*Math.atan(this.ssfn_(c,d,this.e))-i.HALF_PI),a=Math.sin(r),Math.abs(this.coslat0)<=i.EPSLN)return n=(0,o.default)(this.e,c*this.con,this.con*d),l=2*this.a*this.k0*n/this.cons,e.x=this.x0+l*Math.sin(h-this.long0),e.y=this.y0-this.con*l*Math.cos(h-this.long0),e;Math.abs(this.sinlat0)<i.EPSLN?(t=2*this.a*this.k0/(1+s*Math.cos(f)),e.y=t*a):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*s*Math.cos(f))),e.y=t*(this.cosX0*a-this.sinX0*s*Math.cos(f))+this.y0),e.x=t*s*Math.sin(f)+this.x0}return e}function p(e){e.x-=this.x0,e.y-=this.y0;var t,r,a,s,n,o=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var h=2*Math.atan(o/(2*this.a*this.k0));return t=this.long0,r=this.lat0,o<=i.EPSLN||(r=Math.asin(Math.cos(h)*this.sinlat0+e.y*Math.sin(h)*this.coslat0/o),t=Math.abs(this.coslat0)<i.EPSLN?this.lat0>0?(0,u.default)(this.long0+Math.atan2(e.x,-1*e.y)):(0,u.default)(this.long0+Math.atan2(e.x,e.y)):(0,u.default)(this.long0+Math.atan2(e.x*Math.sin(h),o*this.coslat0*Math.cos(h)-e.y*this.sinlat0*Math.sin(h)))),e.x=t,e.y=r,e}if(Math.abs(this.coslat0)<=i.EPSLN){if(o<=i.EPSLN)return r=this.lat0,t=this.long0,e.x=t,e.y=r,e;e.x*=this.con,e.y*=this.con,a=o*this.cons/(2*this.a*this.k0),r=this.con*(0,l.default)(this.e,a),t=this.con*(0,u.default)(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else s=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o<=i.EPSLN?n=this.X0:(n=Math.asin(Math.cos(s)*this.sinX0+e.y*Math.sin(s)*this.cosX0/o),t=(0,u.default)(this.long0+Math.atan2(e.x*Math.sin(s),o*this.cosX0*Math.cos(s)-e.y*this.sinX0*Math.sin(s)))),r=-1*(0,l.default)(this.e,Math.tan(.5*(i.HALF_PI+n)));return e.x=t,e.y=r,e}var f=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],m={init:c,forward:d,inverse:p,names:f,ssfn_:h}}),n("1awqj",function(e,r){t(e.exports,"default",()=>i);var i={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),r=this.a,i=1/this.rf,a=2*i-Math.pow(i,2),s=this.e=Math.sqrt(a);this.R=this.k0*r*Math.sqrt(1-a)/(1-a*Math.pow(t,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var n=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+e/2)),l=Math.log((1+s*t)/(1-s*t));this.K=n-this.alpha*o+this.alpha*s/2*l},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),i=2*(Math.atan(Math.exp(-this.alpha*(t+r)+this.K))-Math.PI/4),a=this.alpha*(e.x-this.lambda0),s=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),n=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return e.y=this.R/2*Math.log((1+Math.sin(n))/(1-Math.sin(n)))+this.y0,e.x=this.R*s+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,r=e.y-this.y0,i=t/this.R,a=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(i)),n=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(a))),o=this.lambda0+n/this.alpha,l=0,u=s,h=-1e3,c=0;Math.abs(u-h)>1e-7;){if(++c>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return e.x=o,e.y=u,e},names:["somerc"]}}),n("l0GLf",function(e,r){t(e.exports,"default",()=>l);var i=s("8RM2D"),a=s("kEf05"),n=s("7qdiL"),o=s("7M1Nv"),l={init:function(){var e,t,r,s,n,l,u,h,c,d,p,f=0,m=0,g=0,y=0,v=0,_=0,x=0;this.no_off=(e="object"==typeof this.PROJECTION?Object.keys(this.PROJECTION)[0]:this.PROJECTION,"no_uoff"in this||"no_off"in this||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(e)),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var S=!1;if("rectified_grid_angle"in this&&(S=!0),b&&(x=this.alpha),S&&(f=this.rectified_grid_angle*o.D2R),b||S)m=this.longc;else if(g=this.long1,v=this.lat1,y=this.long2,1e-7>=Math.abs(v-(_=this.lat2))||(t=Math.abs(v))<=1e-7||1e-7>=Math.abs(t-o.HALF_PI)||1e-7>=Math.abs(Math.abs(this.lat0)-o.HALF_PI)||1e-7>=Math.abs(Math.abs(_)-o.HALF_PI))throw Error();var w=1-this.es;(r=Math.sqrt(w),Math.abs(this.lat0)>o.EPSLN?(c=Math.sin(this.lat0),s=Math.cos(this.lat0),t=1-this.es*c*c,this.B=s*s,this.B=Math.sqrt(1+this.es*this.B*this.B/w),this.A=this.B*this.k0*r/t,(l=(n=this.B*r/(s*Math.sqrt(t)))*n-1)<=0?l=0:(l=Math.sqrt(l),this.lat0<0&&(l=-l)),this.E=l+=n,this.E*=Math.pow((0,i.default)(this.e,this.lat0,c),this.B)):(this.B=1/r,this.A=this.k0,this.E=n=l=1),b||S)?(b?(p=Math.asin(Math.sin(x)/n),S||(f=x)):x=Math.asin(n*Math.sin(p=f)),this.lam0=m-Math.asin(.5*(l-1/l)*Math.tan(p))/this.B):(u=Math.pow((0,i.default)(this.e,v,Math.sin(v)),this.B),h=Math.pow((0,i.default)(this.e,_,Math.sin(_)),this.B),l=this.E/u,d=((d=this.E*this.E)-h*u)/(d+h*u),(t=g-y)<-Math.pi?y-=o.TWO_PI:t>Math.pi&&(y+=o.TWO_PI),this.lam0=(0,a.default)(.5*(g+y)-Math.atan(d*Math.tan(.5*this.B*(g-y))/((h-u)/(h+u)))/this.B),f=x=Math.asin(n*Math.sin(p=Math.atan(2*Math.sin(this.B*(0,a.default)(g-this.lam0))/(l-1/l))))),this.singam=Math.sin(p),this.cosgam=Math.cos(p),this.sinrot=Math.sin(f),this.cosrot=Math.cos(f),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(x))),this.lat0<0&&(this.u_0=-this.u_0)),l=.5*p,this.v_pole_n=this.ArB*Math.log(Math.tan(o.FORTPI-l)),this.v_pole_s=this.ArB*Math.log(Math.tan(o.FORTPI+l))},forward:function(e){var t,r,a,s,n,l,u,h,c={};if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-o.HALF_PI)>o.EPSLN){if(l=1/(n=this.E/Math.pow((0,i.default)(this.e,e.y,Math.sin(e.y)),this.B)),t=.5*(n-l),r=.5*(n+l),s=Math.sin(this.B*e.x),Math.abs(Math.abs(a=(t*this.singam-s*this.cosgam)/r)-1)<o.EPSLN)throw Error();h=.5*this.ArB*Math.log((1-a)/(1+a)),u=1e-7>Math.abs(l=Math.cos(this.B*e.x))?this.A*e.x:this.ArB*Math.atan2(t*this.cosgam+s*this.singam,l)}else h=e.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*e.y;return this.no_rot?(c.x=u,c.y=h):(u-=this.u_0,c.x=h*this.cosrot+u*this.sinrot,c.y=u*this.cosrot-h*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(e){var t,r,i,a,s,l,u={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(r=e.y,t=e.x):(r=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),a=.5*((i=Math.exp(-this.BrA*r))-1/i),Math.abs(Math.abs(l=((s=Math.sin(this.BrA*t))*this.cosgam+a*this.singam)/(.5*(i+1/i)))-1)<o.EPSLN)u.x=0,u.y=l<0?-o.HALF_PI:o.HALF_PI;else{if(u.y=this.E/Math.sqrt((1+l)/(1-l)),u.y=(0,n.default)(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw Error();u.x=-this.rB*Math.atan2(a*this.cosgam-s*this.singam,Math.cos(this.BrA*t))}return u.x+=this.lam0,u},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]}}),n("lodNN",function(e,r){t(e.exports,"default",()=>h);var i=s("1gqnK"),a=s("8RM2D"),n=s("SsFAj"),o=s("kEf05"),l=s("7qdiL"),u=s("7M1Nv"),h={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<u.EPSLN)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),r=Math.cos(this.lat1),s=(0,i.default)(this.e,t,r),n=(0,a.default)(this.e,this.lat1,t),o=Math.sin(this.lat2),l=Math.cos(this.lat2),h=(0,i.default)(this.e,o,l),c=(0,a.default)(this.e,this.lat2,o),d=(0,a.default)(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>u.EPSLN?this.ns=Math.log(s/h)/Math.log(n/c):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=s/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(d,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t,r,i=e.x,s=e.y;Math.abs(2*Math.abs(s)-Math.PI)<=u.EPSLN&&(s=(0,n.default)(s)*(u.HALF_PI-2*u.EPSLN));var l=Math.abs(Math.abs(s)-u.HALF_PI);if(l>u.EPSLN)t=(0,a.default)(this.e,s,Math.sin(s)),r=this.a*this.f0*Math.pow(t,this.ns);else{if((l=s*this.ns)<=0)return null;r=0}var h=this.ns*(0,o.default)(i-this.long0);return e.x=this.k0*(r*Math.sin(h))+this.x0,e.y=this.k0*(this.rh-r*Math.cos(h))+this.y0,e},inverse:function(e){var t,r,i,a,s,n=(e.x-this.x0)/this.k0,h=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(n*n+h*h),r=1):(t=-Math.sqrt(n*n+h*h),r=-1);var c=0;if(0!==t&&(c=Math.atan2(r*n,r*h)),0!==t||this.ns>0){if(r=1/this.ns,i=Math.pow(t/(this.a*this.f0),r),-9999===(a=(0,l.default)(this.e,i)))return null}else a=-u.HALF_PI;return s=(0,o.default)(c/this.ns+this.long0),e.x=s,e.y=a,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]}}),n("jkgJa",function(e,r){t(e.exports,"default",()=>a);var i=s("kEf05"),a={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,r,a,s,n,o,l,u=e.x,h=e.y,c=(0,i.default)(u-this.long0);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),a=-c*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(a)),n=Math.asin(Math.cos(r)*Math.sin(a)/Math.cos(s)),o=this.n*n,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),e.y=l*Math.cos(o)/1,e.x=l*Math.sin(o)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,r,i,a,s,n,o,l=e.x;e.x=e.y,e.y=l,this.czech||(e.y*=-1,e.x*=-1),s=Math.sqrt(e.x*e.x+e.y*e.y),a=Math.atan2(e.y,e.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),r=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(t)),e.x=this.long0-r/this.alfa,n=t,o=0;var u=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),1e-10>Math.abs(n-e.y)&&(o=1),n=e.y,u+=1;while(0===o&&u<15)return u>=15?null:e},names:["Krovak","krovak"]}}),n("2HFid",function(e,r){t(e.exports,"default",()=>f);var i=s("ikblq"),a=s("bfjvS"),n=s("2SUEX"),o=s("7DbOS"),l=s("jhsZf"),u=s("4N9k9"),h=s("kEf05"),c=s("r1jKt"),d=s("ilwvp"),p=s("7M1Nv"),f={init:function(){this.sphere||(this.e0=(0,a.default)(this.es),this.e1=(0,n.default)(this.es),this.e2=(0,o.default)(this.es),this.e3=(0,l.default)(this.es),this.ml0=this.a*(0,i.default)(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,r,a=e.x,s=e.y;if(a=(0,h.default)(a-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(s)*Math.sin(a)),r=this.a*(Math.atan2(Math.tan(s),Math.cos(a))-this.lat0);else{var n=Math.sin(s),o=Math.cos(s),l=(0,u.default)(this.a,this.e,n),c=Math.tan(s)*Math.tan(s),d=a*Math.cos(s),p=d*d,f=this.es*o*o/(1-this.es),m=this.a*(0,i.default)(this.e0,this.e1,this.e2,this.e3,s);t=l*d*(1-p*c*(1/6-(8-c+8*f)*p/120)),r=m-this.ml0+l*n/o*p*(.5+(5-c+6*f)*p/24)}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,i=e.x/this.a,a=e.y/this.a;if(this.sphere){var s=a+this.lat0;t=Math.asin(Math.sin(s)*Math.cos(i)),r=Math.atan2(Math.tan(i),Math.cos(s))}else{var n=this.ml0/this.a+a,o=(0,d.default)(n,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-p.HALF_PI)<=p.EPSLN)return e.x=this.long0,e.y=p.HALF_PI,a<0&&(e.y*=-1),e;var l=(0,u.default)(this.a,this.e,Math.sin(o)),f=l*l*l/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(o),2),g=i*this.a/l,y=g*g;t=o-l*Math.tan(o)/f*g*g*(.5-(1+3*m)*g*g/24),r=g*(1-y*(m/3+(1+3*m)*m*y/15))/Math.cos(o)}return e.x=(0,h.default)(r+this.long0),e.y=(0,c.default)(t),e},names:["Cassini","Cassini_Soldner","cass"]}}),n("ikblq",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r,i,a){return e*a-t*Math.sin(2*a)+r*Math.sin(4*a)-i*Math.sin(6*a)}}),n("bfjvS",function(e,r){t(e.exports,"default",()=>i);function i(e){return 1-.25*e*(1+e/16*(3+1.25*e))}}),n("2SUEX",function(e,r){t(e.exports,"default",()=>i);function i(e){return .375*e*(1+.25*e*(1+.46875*e))}}),n("7DbOS",function(e,r){t(e.exports,"default",()=>i);function i(e){return .05859375*e*e*(1+.75*e)}}),n("jhsZf",function(e,r){t(e.exports,"default",()=>i);function i(e){return e*e*e*(35/3072)}}),n("4N9k9",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r){var i=t*r;return e/Math.sqrt(1-i*i)}}),n("r1jKt",function(e,r){t(e.exports,"default",()=>n);var i=s("7M1Nv"),a=s("SsFAj");function n(e){return Math.abs(e)<i.HALF_PI?e:e-(0,a.default)(e)*Math.PI}}),n("ilwvp",function(e,r){t(e.exports,"default",()=>i);function i(e,t,r,i,a){s=e/t;for(var s,n,o=0;o<15;o++)if(n=(e-(t*s-r*Math.sin(2*s)+i*Math.sin(4*s)-a*Math.sin(6*s)))/(t-2*r*Math.cos(2*s)+4*i*Math.cos(4*s)-6*a*Math.cos(6*s)),s+=n,1e-10>=Math.abs(n))return s;return NaN}}),n("9v6gR",function(e,r){t(e.exports,"S_POLE",()=>o),t(e.exports,"N_POLE",()=>l),t(e.exports,"EQUIT",()=>u),t(e.exports,"OBLIQ",()=>h),t(e.exports,"init",()=>c),t(e.exports,"forward",()=>d),t(e.exports,"inverse",()=>p),t(e.exports,"names",()=>f),t(e.exports,"default",()=>m);var i=s("7M1Nv"),a=s("iVfS2"),n=s("kEf05"),o=1,l=2,u=3,h=4;function c(){var e,t,r,s,n=Math.abs(this.lat0);if(Math.abs(n-i.HALF_PI)<i.EPSLN?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<i.EPSLN?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=(0,a.default)(this.e,1),this.mmf=.5/(1-this.es),this.apa=(e=this.es,(r=[])[0]=.3333333333333333*e,t=e*e,r[0]+=.17222222222222222*t,r[1]=.06388888888888888*t,t*=e,r[0]+=.10257936507936508*t,r[1]+=.0664021164021164*t,r[2]=.016415012942191543*t,r),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),s=Math.sin(this.lat0),this.sinb1=(0,a.default)(this.e,s)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*s*s)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function d(e){var t,r,s,o,l,u,h,c,d,p,f=e.x,m=e.y;if(f=(0,n.default)(f-this.long0),this.sphere){if(l=Math.sin(m),p=Math.cos(m),s=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+p*s:1+this.sinph0*l+this.cosph0*p*s)<=i.EPSLN)return null;t=(r=Math.sqrt(2/r))*p*Math.sin(f),r*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*p*s}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),Math.abs(m+this.lat0)<i.EPSLN)return null;r=i.FORTPI-.5*m,t=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(f),r*=s}}else{switch(h=0,c=0,d=0,s=Math.cos(f),o=Math.sin(f),l=Math.sin(m),u=(0,a.default)(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=Math.sqrt(1-(h=u/this.qp)*h)),this.mode){case this.OBLIQ:d=1+this.sinb1*h+this.cosb1*c*s;break;case this.EQUIT:d=1+c*s;break;case this.N_POLE:d=i.HALF_PI+m,u=this.qp-u;break;case this.S_POLE:d=m-i.HALF_PI,u=this.qp+u}if(Math.abs(d)<i.EPSLN)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:d=Math.sqrt(2/d),r=this.mode===this.OBLIQ?this.ymf*d*(this.cosb1*h-this.sinb1*c*s):(d=Math.sqrt(2/(1+c*s)))*h*this.ymf,t=this.xmf*d*c*o;break;case this.N_POLE:case this.S_POLE:u>=0?(t=(d=Math.sqrt(u))*o,r=s*(this.mode===this.S_POLE?d:-d)):t=r=0}}return e.x=this.a*t+this.x0,e.y=this.a*r+this.y0,e}function p(e){e.x-=this.x0,e.y-=this.y0;var t,r,a,s=e.x/this.a,o=e.y/this.a;if(this.sphere){var l,u,h,c,d,p,f,m,g=0,y=0;if((u=.5*(m=Math.sqrt(s*s+o*o)))>1)return null;switch(u=2*Math.asin(u),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(y=Math.sin(u),g=Math.cos(u)),this.mode){case this.EQUIT:u=Math.abs(m)<=i.EPSLN?0:Math.asin(o*y/m),s*=y,o=g*m;break;case this.OBLIQ:u=Math.abs(m)<=i.EPSLN?this.lat0:Math.asin(g*this.sinph0+o*y*this.cosph0/m),s*=y*this.cosph0,o=(g-Math.sin(u)*this.sinph0)*m;break;case this.N_POLE:o=-o,u=i.HALF_PI-u;break;case this.S_POLE:u-=i.HALF_PI}l=0===o&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(s,o)}else{if(f=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(s/=this.dd,o*=this.dd,(p=Math.sqrt(s*s+o*o))<i.EPSLN)return e.x=this.long0,e.y=this.lat0,e;h=Math.cos(c=2*Math.asin(.5*p/this.rq)),s*=c=Math.sin(c),this.mode===this.OBLIQ?(f=h*this.sinb1+o*c*this.cosb1/p,d=this.qp*f,o=p*this.cosb1*h-o*this.sinb1*c):(f=o*c/p,d=this.qp*f,o=p*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(o=-o),!(d=s*s+o*o))return e.x=this.long0,e.y=this.lat0,e;f=1-d/this.qp,this.mode===this.S_POLE&&(f=-f)}l=Math.atan2(s,o),t=Math.asin(f),r=this.apa,a=t+t,u=t+r[0]*Math.sin(a)+r[1]*Math.sin(a+a)+r[2]*Math.sin(a+a+a)}return e.x=(0,n.default)(this.long0+l),e.y=u,e}var f=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],m={init:c,forward:d,inverse:p,names:f,S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4}}),n("iVfS2",function(e,r){t(e.exports,"default",()=>i);function i(e,t){var r;return e>1e-7?(r=e*t,(1-e*e)*(t/(1-r*r)-.5/e*Math.log((1-r)/(1+r)))):2*t}}),n("aYCax",function(e,r){t(e.exports,"init",()=>u),t(e.exports,"forward",()=>h),t(e.exports,"inverse",()=>c),t(e.exports,"phi1z",()=>d),t(e.exports,"names",()=>p),t(e.exports,"default",()=>f);var i=s("1gqnK"),a=s("iVfS2"),n=s("kEf05"),o=s("bp9ph"),l=s("7M1Nv");function u(){Math.abs(this.lat1+this.lat2)<l.EPSLN||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=(0,i.default)(this.e3,this.sin_po,this.cos_po),this.qs1=(0,a.default)(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=(0,i.default)(this.e3,this.sin_po,this.cos_po),this.qs2=(0,a.default)(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=(0,a.default)(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>l.EPSLN?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function h(e){var t=e.x,r=e.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var i=(0,a.default)(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*(0,n.default)(t-this.long0),l=s*Math.sin(o)+this.x0,u=this.rh-s*Math.cos(o)+this.y0;return e.x=l,e.y=u,e}function c(e){var t,r,i,a,s,o;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),i=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),i=-1),a=0,0!==t&&(a=Math.atan2(i*e.x,i*e.y)),i=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(r=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,r)),s=(0,n.default)(a/this.ns0+this.long0),e.x=s,e.y=o,e}function d(e,t){var r,i,a,s,n,u=(0,o.default)(.5*t);if(e<l.EPSLN)return u;for(var h=e*e,c=1;c<=25;c++)if(r=Math.sin(u),i=Math.cos(u),u+=n=.5*(s=1-(a=e*r)*a)*s/i*(t/(1-h)-r/s+.5/e*Math.log((1-a)/(1+a))),1e-7>=Math.abs(n))return u;return null}var p=["Albers_Conic_Equal_Area","Albers","aea"],f={init:u,forward:h,inverse:c,names:p,phi1z:d}}),n("bp9ph",function(e,r){t(e.exports,"default",()=>i);function i(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}}),n("8zzks",function(e,r){t(e.exports,"default",()=>o);var i=s("kEf05"),a=s("bp9ph"),n=s("7M1Nv"),o={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,r,a,s,o,l,u,h=e.x,c=e.y;return a=(0,i.default)(h-this.long0),t=Math.sin(c),r=Math.cos(c),s=Math.cos(a),(o=this.sin_p14*t+this.cos_p14*r*s)>0||Math.abs(o)<=n.EPSLN?(l=this.x0+1*this.a*r*Math.sin(a)/o,u=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*s)/o):(l=this.x0+this.infinity_dist*r*Math.sin(a),u=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*r*s)),e.x=l,e.y=u,e},inverse:function(e){var t,r,s,n,o,l;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(r=Math.sin(n=Math.atan2(t,this.rc)),s=Math.cos(n),l=(0,a.default)(s*this.sin_p14+e.y*r*this.cos_p14/t),o=Math.atan2(e.x*r,t*this.cos_p14*s-e.y*this.sin_p14*r),o=(0,i.default)(this.long0+o)):(l=this.phic0,o=0),e.x=o,e.y=l,e},names:["gnom"]}}),n("5DoFA",function(e,r){t(e.exports,"default",()=>l);var i=s("kEf05"),a=s("iVfS2"),n=s("1gqnK"),o=s("2mAxr"),l={init:function(){this.sphere||(this.k0=(0,n.default)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,r,s=e.x,n=e.y,o=(0,i.default)(s-this.long0);if(this.sphere)t=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var l=(0,a.default)(this.e,Math.sin(n));t=this.x0+this.a*this.k0*o,r=this.y0+this.a*l*.5/this.k0}return e.x=t,e.y=r,e},inverse:function(e){var t,r;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=(0,i.default)(this.long0+e.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(r=(0,o.default)(this.e,2*e.y*this.k0/this.a),t=(0,i.default)(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=r,e},names:["cea"]}}),n("2mAxr",function(e,r){t(e.exports,"default",()=>a);var i=s("7M1Nv");function a(e,t){if(1e-6>Math.abs(Math.abs(t)-(1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e)))))return t<0?-1*i.HALF_PI:i.HALF_PI;for(var r,a,s,n,o=Math.asin(.5*t),l=0;l<30;l++)if(a=Math.sin(o),s=Math.cos(o),o+=r=Math.pow(1-(n=e*a)*n,2)/(2*s)*(t/(1-e*e)-a/(1-n*n)+.5/e*Math.log((1-n)/(1+n))),1e-10>=Math.abs(r))return o;return NaN}}),n("jobMi",function(e,r){t(e.exports,"default",()=>n);var i=s("kEf05"),a=s("r1jKt"),n={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,r=e.y,s=(0,i.default)(t-this.long0),n=(0,a.default)(r-this.lat0);return e.x=this.x0+this.a*s*this.rc,e.y=this.y0+this.a*n,e},inverse:function(e){var t=e.x,r=e.y;return e.x=(0,i.default)(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=(0,a.default)(this.lat0+(r-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]}}),n("fKioj",function(e,r){t(e.exports,"default",()=>p);var i=s("bfjvS"),a=s("2SUEX"),n=s("7DbOS"),o=s("jhsZf"),l=s("kEf05"),u=s("r1jKt"),h=s("ikblq"),c=s("7M1Nv"),d=s("4N9k9"),p={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=(0,i.default)(this.es),this.e1=(0,a.default)(this.es),this.e2=(0,n.default)(this.es),this.e3=(0,o.default)(this.es),this.ml0=this.a*(0,h.default)(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,r,i,a=e.x,s=e.y,n=(0,l.default)(a-this.long0);if(i=n*Math.sin(s),this.sphere)Math.abs(s)<=c.EPSLN?(t=this.a*n,r=-1*this.a*this.lat0):(t=this.a*Math.sin(i)/Math.tan(s),r=this.a*((0,u.default)(s-this.lat0)+(1-Math.cos(i))/Math.tan(s)));else if(Math.abs(s)<=c.EPSLN)t=this.a*n,r=-1*this.ml0;else{var o=(0,d.default)(this.a,this.e,Math.sin(s))/Math.tan(s);t=o*Math.sin(i),r=this.a*(0,h.default)(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+o*(1-Math.cos(i))}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){var t,r,i,a,s,n,o,u,d,p,f,m,g,y,v;if(i=e.x-this.x0,a=e.y-this.y0,this.sphere){if(Math.abs(a+this.a*this.lat0)<=c.EPSLN)t=(0,l.default)(i/this.a+this.long0),r=0;else{for(s=20,n=this.lat0+a/this.a,o=i*i/this.a/this.a+n*n,u=n;s;--s)if(p=Math.tan(u),d=-1*(n*(u*p+1)-u-.5*(u*u+o)*p)/((u-n)/p-1),u+=d,Math.abs(d)<=c.EPSLN){r=u;break}t=(0,l.default)(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(r))}}else if(Math.abs(a+this.ml0)<=c.EPSLN)r=0,t=(0,l.default)(this.long0+i/this.a);else{for(s=20,n=(this.ml0+a)/this.a,o=i*i/this.a/this.a+n*n,u=n;s;--s)if(f=Math.sqrt(1-(v=this.e*Math.sin(u))*v)*Math.tan(u),m=this.a*(0,h.default)(this.e0,this.e1,this.e2,this.e3,u),g=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),d=(n*(f*(y=m/this.a)+1)-y-.5*f*(y*y+o))/(this.es*Math.sin(2*u)*(y*y+o-2*n*y)/(4*f)+(n-y)*(f*g-2/Math.sin(2*u))-g),u-=d,Math.abs(d)<=c.EPSLN){r=u;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),t=(0,l.default)(this.long0+Math.asin(i*f/this.a)/Math.sin(r))}return e.x=t,e.y=r,e},names:["Polyconic","poly"]}}),n("fQxFh",function(e,r){t(e.exports,"iterations",()=>a),t(e.exports,"init",()=>n),t(e.exports,"forward",()=>o),t(e.exports,"inverse",()=>l),t(e.exports,"names",()=>u),t(e.exports,"default",()=>h);var i=s("7M1Nv"),a=1;function n(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-.00034,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function o(e){var t,r,a,s=e.x,n=e.y-this.lat0,o=s-this.long0,l=n/i.SEC_TO_RAD*1e-5,u=1,h=0;for(t=1;t<=10;t++)u*=l,h+=this.A[t]*u;var c=h,d=1,p=0,f=0,m=0;for(t=1;t<=6;t++)r=d*c-p*o,a=p*c+d*o,d=r,p=a,f=f+this.B_re[t]*d-this.B_im[t]*p,m=m+this.B_im[t]*d+this.B_re[t]*p;return e.x=m*this.a+this.x0,e.y=f*this.a+this.y0,e}function l(e){var t=e.x,r=e.y,a=t-this.x0,s=(r-this.y0)/this.a,n=a/this.a,o=1,l=0,u=0,h=0;for(d=1;d<=6;d++)p=o*s-l*n,f=l*s+o*n,o=p,l=f,u=u+this.C_re[d]*o-this.C_im[d]*l,h=h+this.C_im[d]*o+this.C_re[d]*l;for(var c=0;c<this.iterations;c++){var d,p,f,m,g,y=u,v=h,_=s,x=n;for(d=2;d<=6;d++)m=y*u-v*h,g=v*u+y*h,y=m,v=g,_+=(d-1)*(this.B_re[d]*y-this.B_im[d]*v),x+=(d-1)*(this.B_im[d]*y+this.B_re[d]*v);y=1,v=0;var b=this.B_re[1],S=this.B_im[1];for(d=2;d<=6;d++)m=y*u-v*h,g=v*u+y*h,y=m,v=g,b+=d*(this.B_re[d]*y-this.B_im[d]*v),S+=d*(this.B_im[d]*y+this.B_re[d]*v);var w=b*b+S*S;u=(_*b+x*S)/w,h=(x*b-_*S)/w}var E=u,A=h,T=1,C=0;for(d=1;d<=9;d++)T*=E,C+=this.D[d]*T;var P=this.lat0+C*i.SEC_TO_RAD*1e5,R=this.long0+A;return e.x=R,e.y=P,e}var u=["New_Zealand_Map_Grid","nzmg"],h={init:n,forward:o,inverse:l,names:u}}),n("gu5X1",function(e,r){t(e.exports,"default",()=>a);var i=s("kEf05"),a={init:function(){},forward:function(e){var t=e.x,r=e.y,a=(0,i.default)(t-this.long0),s=this.x0+this.a*a,n=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return e.x=s,e.y=n,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=(0,i.default)(this.long0+e.x/this.a),r=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=r,e},names:["Miller_Cylindrical","mill"]}}),n("4yyqR",function(e,r){t(e.exports,"default",()=>c);var i=s("kEf05"),a=s("r1jKt"),n=s("lz6WA"),o=s("8GYcG"),l=s("6NyiU"),u=s("7M1Nv"),h=s("bp9ph"),c={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=(0,n.default)(this.es)},forward:function(e){var t,r,a=e.x,s=e.y;if(a=(0,i.default)(a-this.long0),this.sphere){if(this.m)for(var n=this.n*Math.sin(s),l=20;l;--l){var h=(this.m*s+Math.sin(s)-n)/(this.m+Math.cos(s));if(s-=h,Math.abs(h)<u.EPSLN)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;t=this.a*this.C_x*a*(this.m+Math.cos(s)),r=this.a*this.C_y*s}else{var c=Math.sin(s),d=Math.cos(s);r=this.a*(0,o.default)(s,c,d,this.en),t=this.a*a*d/Math.sqrt(1-this.es*c*c)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,s,n;return e.x-=this.x0,s=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,s/=this.C_x*(this.m+Math.cos(t)),this.m?t=(0,h.default)((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=(0,h.default)(Math.sin(t)/this.n)),s=(0,i.default)(s+this.long0),t=(0,a.default)(t)):(n=Math.abs(t=(0,l.default)(e.y/this.a,this.es,this.en)))<u.HALF_PI?(n=Math.sin(t),r=this.long0+e.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(t)),s=(0,i.default)(r)):n-u.EPSLN<u.HALF_PI&&(s=this.long0),e.x=s,e.y=t,e},names:["Sinusoidal","sinu"]}}),n("bMtlW",function(e,r){t(e.exports,"default",()=>n);var i=s("kEf05"),a=s("7M1Nv"),n={init:function(){},forward:function(e){for(var t=e.x,r=e.y,s=(0,i.default)(t-this.long0),n=r,o=Math.PI*Math.sin(r);;){var l=-(n+Math.sin(n)-o)/(1+Math.cos(n));if(n+=l,Math.abs(l)<a.EPSLN)break}n/=2,Math.PI/2-Math.abs(r)<a.EPSLN&&(s=0);var u=.900316316158*this.a*s*Math.cos(n)+this.x0,h=1.4142135623731*this.a*Math.sin(n)+this.y0;return e.x=u,e.y=h,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0,Math.abs(r=e.y/(1.4142135623731*this.a))>.999999999999&&(r=.999999999999),t=Math.asin(r);var t,r,a=(0,i.default)(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),Math.abs(r=(2*t+Math.sin(2*t))/Math.PI)>1&&(r=1);var s=Math.asin(r);return e.x=a,e.y=s,e},names:["Mollweide","moll"]}}),n("bSwxC",function(e,r){t(e.exports,"default",()=>f);var i=s("bfjvS"),a=s("2SUEX"),n=s("7DbOS"),o=s("jhsZf"),l=s("1gqnK"),u=s("ikblq"),h=s("kEf05"),c=s("r1jKt"),d=s("ilwvp"),p=s("7M1Nv"),f={init:function(){Math.abs(this.lat1+this.lat2)<p.EPSLN||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=(0,i.default)(this.es),this.e1=(0,a.default)(this.es),this.e2=(0,n.default)(this.es),this.e3=(0,o.default)(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=(0,l.default)(this.e,this.sinphi,this.cosphi),this.ml1=(0,u.default)(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<p.EPSLN?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=(0,l.default)(this.e,this.sinphi,this.cosphi),this.ml2=(0,u.default)(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=(0,u.default)(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t,r=e.x,i=e.y;if(this.sphere)t=this.a*(this.g-i);else{var a=(0,u.default)(this.e0,this.e1,this.e2,this.e3,i);t=this.a*(this.g-a)}var s=this.ns*(0,h.default)(r-this.long0),n=this.x0+t*Math.sin(s),o=this.y0+this.rh-t*Math.cos(s);return e.x=n,e.y=o,e},inverse:function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(r=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(r=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var t,r,i,a,s=0;if(0!==r&&(s=Math.atan2(t*e.x,t*e.y)),this.sphere)return a=(0,h.default)(this.long0+s/this.ns),i=(0,c.default)(this.g-r/this.a),e.x=a,e.y=i,e;var n=this.g-r/this.a;return i=(0,d.default)(n,this.e0,this.e1,this.e2,this.e3),a=(0,h.default)(this.long0+s/this.ns),e.x=a,e.y=i,e},names:["Equidistant_Conic","eqdc"]}}),n("2BpE3",function(e,r){t(e.exports,"default",()=>o);var i=s("kEf05"),a=s("7M1Nv"),n=s("bp9ph"),o={init:function(){this.R=this.a},forward:function(e){var t,r,s=e.x,o=e.y,l=(0,i.default)(s-this.long0);Math.abs(o)<=a.EPSLN&&(t=this.x0+this.R*l,r=this.y0);var u=(0,n.default)(2*Math.abs(o/Math.PI));(Math.abs(l)<=a.EPSLN||Math.abs(Math.abs(o)-a.HALF_PI)<=a.EPSLN)&&(t=this.x0,r=o>=0?this.y0+Math.PI*this.R*Math.tan(.5*u):this.y0+-(Math.PI*this.R*Math.tan(.5*u)));var h=.5*Math.abs(Math.PI/l-l/Math.PI),c=h*h,d=Math.sin(u),p=Math.cos(u),f=p/(d+p-1),m=f*(2/d-1),g=m*m,y=Math.PI*this.R*(h*(f-g)+Math.sqrt(c*(f-g)*(f-g)-(g+c)*(f*f-g)))/(g+c);l<0&&(y=-y),t=this.x0+y;var v=c+f;return y=Math.PI*this.R*(m*v-h*Math.sqrt((g+c)*(c+1)-v*v))/(g+c),r=o>=0?this.y0+y:this.y0-y,e.x=t,e.y=r,e},inverse:function(e){var t,r,s,n,o,l,u,h,c,d,p,f;return e.x-=this.x0,e.y-=this.y0,p=Math.PI*this.R,o=(s=e.x/p)*s+(n=e.y/p)*n,u=(l=-Math.abs(n)*(1+o))-2*n*n+s*s,h=-2*l+1+2*n*n+o*o,d=2*Math.sqrt(-(c=(l-u*u/3/h)/h)/3),Math.abs(p=3*(n*n/h+(2*u*u*u/h/h/h-9*l*u/h/h)/27)/c/d)>1&&(p=p>=0?1:-1),f=Math.acos(p)/3,r=e.y>=0?(-d*Math.cos(f+Math.PI/3)-u/3/h)*Math.PI:-(-d*Math.cos(f+Math.PI/3)-u/3/h)*Math.PI,t=Math.abs(s)<a.EPSLN?this.long0:(0,i.default)(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(s*s-n*n)+o*o))/2/s),e.x=t,e.y=r,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]}}),n("h1KUb",function(e,r){t(e.exports,"default",()=>f);var i=s("kEf05"),a=s("7M1Nv"),n=s("ikblq"),o=s("bfjvS"),l=s("2SUEX"),u=s("7DbOS"),h=s("jhsZf"),c=s("4N9k9"),d=s("bp9ph"),p=s("ilwvp"),f={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,r,s,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C,P,R,I,L=e.x,O=e.y,M=Math.sin(e.y),k=Math.cos(e.y),N=(0,i.default)(L-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=a.EPSLN?(e.x=this.x0+this.a*(a.HALF_PI-O)*Math.sin(N),e.y=this.y0-this.a*(a.HALF_PI-O)*Math.cos(N)):Math.abs(this.sin_p12+1)<=a.EPSLN?(e.x=this.x0+this.a*(a.HALF_PI+O)*Math.sin(N),e.y=this.y0+this.a*(a.HALF_PI+O)*Math.cos(N)):(A=(E=Math.acos(this.sin_p12*M+this.cos_p12*k*Math.cos(N)))?E/Math.sin(E):1,e.x=this.x0+this.a*A*k*Math.sin(N),e.y=this.y0+this.a*A*(this.cos_p12*M-this.sin_p12*k*Math.cos(N))):(t=(0,o.default)(this.es),r=(0,l.default)(this.es),s=(0,u.default)(this.es),d=(0,h.default)(this.es),Math.abs(this.sin_p12-1)<=a.EPSLN)?(p=this.a*(0,n.default)(t,r,s,d,a.HALF_PI),f=this.a*(0,n.default)(t,r,s,d,O),e.x=this.x0+(p-f)*Math.sin(N),e.y=this.y0-(p-f)*Math.cos(N)):Math.abs(this.sin_p12+1)<=a.EPSLN?(p=this.a*(0,n.default)(t,r,s,d,a.HALF_PI),f=this.a*(0,n.default)(t,r,s,d,O),e.x=this.x0+(p+f)*Math.sin(N),e.y=this.y0+(p+f)*Math.cos(N)):(m=M/k,g=(0,c.default)(this.a,this.e,this.sin_p12),y=(0,c.default)(this.a,this.e,M),v=Math.atan((1-this.es)*m+this.es*g*this.sin_p12/(y*k)),T=0===(_=Math.atan2(Math.sin(N),this.cos_p12*Math.tan(v)-this.sin_p12*Math.cos(N)))?Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v)):Math.abs(Math.abs(_)-Math.PI)<=a.EPSLN?-Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v)):Math.asin(Math.sin(N)*Math.cos(v)/Math.sin(_)),S=(x=this.e*this.sin_p12/Math.sqrt(1-this.es))*(b=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es)),w=b*b,I=(R=(P=(C=T*T)*T)*T)*T,E=g*T*(1-C*w*(1-w)/6+P/8*S*(1-2*w)+R/120*(w*(4-7*w)-3*x*x*(1-7*w))-I/48*S),e.x=this.x0+E*Math.sin(_),e.y=this.y0+E*Math.cos(_)),e},inverse:function(e){var t,r,s,f,m,g,y,v,_,x,b,S,w,E,A,T,C,P,R,I,L,O;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((t=Math.sqrt(e.x*e.x+e.y*e.y))>2*a.HALF_PI*this.a)return;return s=Math.sin(r=t/this.a),f=Math.cos(r),m=this.long0,Math.abs(t)<=a.EPSLN?g=this.lat0:(g=(0,d.default)(f*this.sin_p12+e.y*s*this.cos_p12/t),m=Math.abs(Math.abs(this.lat0)-a.HALF_PI)<=a.EPSLN?this.lat0>=0?(0,i.default)(this.long0+Math.atan2(e.x,-e.y)):(0,i.default)(this.long0-Math.atan2(-e.x,e.y)):(0,i.default)(this.long0+Math.atan2(e.x*s,t*this.cos_p12*f-e.y*this.sin_p12*s))),e.x=m,e.y=g,e}return(y=(0,o.default)(this.es),v=(0,l.default)(this.es),_=(0,u.default)(this.es),x=(0,h.default)(this.es),Math.abs(this.sin_p12-1)<=a.EPSLN)?(S=(b=this.a*(0,n.default)(y,v,_,x,a.HALF_PI))-(t=Math.sqrt(e.x*e.x+e.y*e.y)),g=(0,p.default)(S/this.a,y,v,_,x),m=(0,i.default)(this.long0+Math.atan2(e.x,-1*e.y))):Math.abs(this.sin_p12+1)<=a.EPSLN?(b=this.a*(0,n.default)(y,v,_,x,a.HALF_PI),S=(t=Math.sqrt(e.x*e.x+e.y*e.y))-b,g=(0,p.default)(S/this.a,y,v,_,x),m=(0,i.default)(this.long0+Math.atan2(e.x,e.y))):(t=Math.sqrt(e.x*e.x+e.y*e.y),A=Math.atan2(e.x,e.y),w=(0,c.default)(this.a,this.e,this.sin_p12),T=Math.cos(A),P=-(C=this.e*this.cos_p12*T)*C/(1-this.es),R=3*this.es*(1-P)*this.sin_p12*this.cos_p12*T/(1-this.es),L=(I=t/w)-P*(1+P)*Math.pow(I,3)/6-R*(1+3*P)*Math.pow(I,4)/24,E=Math.asin(this.sin_p12*Math.cos(L)+this.cos_p12*Math.sin(L)*T),m=(0,i.default)(this.long0+Math.asin(Math.sin(A)*Math.sin(L)/Math.cos(E))),g=Math.atan2(((O=Math.sin(E))-this.es*(1-P*L*L/2-I*L*L*L/6)*this.sin_p12)*Math.tan(E),O*(1-this.es))),e.x=m,e.y=g,e},names:["Azimuthal_Equidistant","aeqd"]}}),n("1nGnS",function(e,r){t(e.exports,"default",()=>o);var i=s("kEf05"),a=s("bp9ph"),n=s("7M1Nv"),o={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,r,a,s,o,l,u,h=e.x,c=e.y;return a=(0,i.default)(h-this.long0),t=Math.sin(c),r=Math.cos(c),s=Math.cos(a),((o=this.sin_p14*t+this.cos_p14*r*s)>0||Math.abs(o)<=n.EPSLN)&&(l=1*this.a*r*Math.sin(a),u=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*s)),e.x=l,e.y=u,e},inverse:function(e){var t,r,s,o,l,u;return(e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),s=Math.sin(r=(0,a.default)(t/this.a)),o=Math.cos(r),l=this.long0,Math.abs(t)<=n.EPSLN)?u=this.lat0:(u=(0,a.default)(o*this.sin_p14+e.y*s*this.cos_p14/t),l=Math.abs(Math.abs(this.lat0)-n.HALF_PI)<=n.EPSLN?this.lat0>=0?(0,i.default)(this.long0+Math.atan2(e.x,-e.y)):(0,i.default)(this.long0-Math.atan2(-e.x,e.y)):(0,i.default)(this.long0+Math.atan2(e.x*s,t*this.cos_p14*o-e.y*this.sin_p14*s))),e.x=l,e.y=u,e},names:["ortho"]}}),n("lAm4d",function(e,r){t(e.exports,"default",()=>u);var i=s("7M1Nv"),a={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},n={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function o(e,t,r,a){var s;return e<i.EPSLN?(a.value=n.AREA_0,s=0):Math.abs(s=Math.atan2(t,r))<=i.FORTPI?a.value=n.AREA_0:s>i.FORTPI&&s<=i.HALF_PI+i.FORTPI?(a.value=n.AREA_1,s-=i.HALF_PI):s>i.HALF_PI+i.FORTPI||s<=-(i.HALF_PI+i.FORTPI)?(a.value=n.AREA_2,s=s>=0?s-i.SPI:s+i.SPI):(a.value=n.AREA_3,s+=i.HALF_PI),s}function l(e,t){var r=e+t;return r<-i.SPI?r+=i.TWO_PI:r>+i.SPI&&(r-=i.TWO_PI),r}var u={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=i.HALF_PI-i.FORTPI/2?this.face=a.TOP:this.lat0<=-(i.HALF_PI-i.FORTPI/2)?this.face=a.BOTTOM:Math.abs(this.long0)<=i.FORTPI?this.face=a.FRONT:Math.abs(this.long0)<=i.HALF_PI+i.FORTPI?this.face=this.long0>0?a.RIGHT:a.LEFT:this.face=a.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,r,s,u,h,c,d,p,f,m,g,y={x:0,y:0},v={value:0};return(e.x-=this.long0,t=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,r=e.x,this.face===a.TOP)?(u=i.HALF_PI-t,r>=i.FORTPI&&r<=i.HALF_PI+i.FORTPI?(v.value=n.AREA_0,s=r-i.HALF_PI):r>i.HALF_PI+i.FORTPI||r<=-(i.HALF_PI+i.FORTPI)?(v.value=n.AREA_1,s=r>0?r-i.SPI:r+i.SPI):r>-(i.HALF_PI+i.FORTPI)&&r<=-i.FORTPI?(v.value=n.AREA_2,s=r+i.HALF_PI):(v.value=n.AREA_3,s=r)):this.face===a.BOTTOM?(u=i.HALF_PI+t,r>=i.FORTPI&&r<=i.HALF_PI+i.FORTPI?(v.value=n.AREA_0,s=-r+i.HALF_PI):r<i.FORTPI&&r>=-i.FORTPI?(v.value=n.AREA_1,s=-r):r<-i.FORTPI&&r>=-(i.HALF_PI+i.FORTPI)?(v.value=n.AREA_2,s=-r-i.HALF_PI):(v.value=n.AREA_3,s=r>0?-r+i.SPI:-r-i.SPI)):(this.face===a.RIGHT?r=l(r,+i.HALF_PI):this.face===a.BACK?r=l(r,+i.SPI):this.face===a.LEFT&&(r=l(r,-i.HALF_PI)),f=Math.sin(t),m=Math.cos(t),g=Math.sin(r),d=m*Math.cos(r),p=m*g,this.face===a.FRONT?s=o(u=Math.acos(d),f,p,v):this.face===a.RIGHT?s=o(u=Math.acos(p),f,-d,v):this.face===a.BACK?s=o(u=Math.acos(-d),f,-p,v):this.face===a.LEFT?s=o(u=Math.acos(-p),f,d,v):(u=s=0,v.value=n.AREA_0)),h=Math.sqrt((1-Math.cos(u))/(Math.cos(c=Math.atan(12/i.SPI*(s+Math.acos(Math.sin(s)*Math.cos(i.FORTPI))-i.HALF_PI)))*Math.cos(c))/(1-Math.cos(Math.atan(1/Math.cos(s))))),v.value===n.AREA_1?c+=i.HALF_PI:v.value===n.AREA_2?c+=i.SPI:v.value===n.AREA_3&&(c+=1.5*i.SPI),y.x=h*Math.cos(c),y.y=h*Math.sin(c),y.x=y.x*this.a+this.x0,y.y=y.y*this.a+this.y0,e.x=y.x,e.y=y.y,e},inverse:function(e){var t,r,s,o,u,h,c,d,p,f,m,g,y,v,_={lam:0,phi:0},x={value:0};return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?x.value=n.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(x.value=n.AREA_1,t-=i.HALF_PI):e.x<0&&-e.x>=Math.abs(e.y)?(x.value=n.AREA_2,t=t<0?t+i.SPI:t-i.SPI):(x.value=n.AREA_3,t+=i.HALF_PI),u=Math.atan(Math.sin(d=i.SPI/12*Math.tan(t))/(Math.cos(d)-1/Math.sqrt(2))),(h=1-(s=Math.cos(t))*s*(o=Math.tan(r))*o*(1-Math.cos(Math.atan(1/Math.cos(u)))))<-1?h=-1:h>1&&(h=1),this.face===a.TOP?(c=Math.acos(h),_.phi=i.HALF_PI-c,x.value===n.AREA_0?_.lam=u+i.HALF_PI:x.value===n.AREA_1?_.lam=u<0?u+i.SPI:u-i.SPI:x.value===n.AREA_2?_.lam=u-i.HALF_PI:_.lam=u):this.face===a.BOTTOM?(c=Math.acos(h),_.phi=c-i.HALF_PI,x.value===n.AREA_0?_.lam=-u+i.HALF_PI:x.value===n.AREA_1?_.lam=-u:x.value===n.AREA_2?_.lam=-u-i.HALF_PI:_.lam=u<0?-u-i.SPI:-u+i.SPI):(m=(d=(p=h)*p)>=1?0:Math.sqrt(1-d)*Math.sin(u),d+=m*m,f=d>=1?0:Math.sqrt(1-d),x.value===n.AREA_1?(d=f,f=-m,m=d):x.value===n.AREA_2?(f=-f,m=-m):x.value===n.AREA_3&&(d=f,f=m,m=-d),this.face===a.RIGHT?(d=p,p=-f,f=d):this.face===a.BACK?(p=-p,f=-f):this.face===a.LEFT&&(d=p,p=f,f=-d),_.phi=Math.acos(-m)-i.HALF_PI,_.lam=Math.atan2(f,p),this.face===a.RIGHT?_.lam=l(_.lam,-i.HALF_PI):this.face===a.BACK?_.lam=l(_.lam,-i.SPI):this.face===a.LEFT&&(_.lam=l(_.lam,+i.HALF_PI))),0!==this.es&&(g=_.phi<0?1:0,y=Math.tan(_.phi),v=this.b/Math.sqrt(y*y+this.one_minus_f_squared),_.phi=Math.atan(Math.sqrt(this.a*this.a-v*v)/(this.one_minus_f*v)),g&&(_.phi=-_.phi)),_.lam+=this.long0,e.x=_.lam,e.y=_.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]}}),n("l7o7b",function(e,r){t(e.exports,"default",()=>c);var i=s("7M1Nv"),a=s("kEf05"),n=[[1,22199e-21,-.0000715515,31103e-10],[.9986,-.000482243,-.000024897,-.0000013309],[.9954,-.00083103,-.0000448605,-.000000986701],[.99,-.00135364,-.000059661,36777e-10],[.9822,-.00167442,-.00000449547,-.00000572411],[.973,-.00214868,-.0000903571,18736e-12],[.96,-.00305085,-.0000900761,164917e-11],[.9427,-.00382792,-.0000653386,-.0000026154],[.9216,-.00467746,-.00010457,481243e-11],[.8962,-.00536223,-.0000323831,-.00000543432],[.8679,-.00609363,-.000113898,332484e-11],[.835,-.00698325,-.0000640253,934959e-12],[.7986,-.00755338,-.0000500009,935324e-12],[.7597,-.00798324,-.000035971,-.00000227626],[.7186,-.00851367,-.0000701149,-.0000086303],[.6732,-.00986209,-.000199569,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],o=[[-.00000000000000000520417,.0124,121431e-23,-.0000000000845284],[.062,.0124,-.00000000126793,422642e-15],[.124,.0124,507171e-14,-.00000000160604],[.186,.0123999,-.0000000190189,600152e-14],[.248,.0124002,710039e-13,-.0000000224],[.31,.0123992,-.000000264997,835986e-13],[.372,.0124029,988983e-12,-.000000311994],[.434,.0123893,-.00000369093,-.000000435621],[.4958,.0123198,-.0000102252,-.000000345523],[.5571,.0121916,-.0000154081,-.000000582288],[.6176,.0119938,-.0000241424,-.000000525327],[.6769,.011713,-.0000320223,-.000000516405],[.7346,.0113541,-.0000397684,-.000000609052],[.7903,.0109107,-.0000489042,-.00000104739],[.8435,.0103431,-.000064615,-.00000000140374],[.8936,.00969686,-.000064636,-.000008547],[.9394,.00840947,-.000192841,-.0000042106],[.9761,.00616527,-.000256,-.0000042106],[1,.00328947,-.000319159,-.0000042106]],l=i.R2D/5,u=1/l,h=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},c={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=(0,a.default)(e.x-this.long0),r=Math.abs(e.y),s=Math.floor(r*l);s<0?s=0:s>=18&&(s=17),r=i.R2D*(r-u*s);var c={x:h(n[s],r)*t,y:h(o[s],r)};return e.y<0&&(c.y=-c.y),c.x=c.x*this.a*.8487+this.x0,c.y=c.y*this.a*1.3523+this.y0,c},inverse:function(e){var t={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(t.y>=1)t.x/=n[18][0],t.y=e.y<0?-i.HALF_PI:i.HALF_PI;else{var r=Math.floor(18*t.y);for(r<0?r=0:r>=18&&(r=17);;)if(o[r][0]>t.y)--r;else if(o[r+1][0]<=t.y)++r;else break;var s=o[r],l=5*(t.y-s[0])/(o[r+1][0]-s[0]);l=function(e,t,r,i){for(var a=t;i;--i){var s=e(a);if(a-=s,Math.abs(s)<r)break}return a}(function(e){return(h(s,e)-t.y)/(s[1]+e*(2*s[2]+3*e*s[3]))},l,i.EPSLN,100),t.x/=h(n[r],l),t.y=(5*r+l)*i.D2R,e.y<0&&(t.y=-t.y)}return t.x=(0,a.default)(t.x+this.long0),t},names:["Robinson","robin"]}}),n("hc3Bp",function(e,r){t(e.exports,"default",()=>a);var i=s("cbJeb"),a={init:function(){this.name="geocent"},forward:function(e){return(0,i.geodeticToGeocentric)(e,this.es,this.a)},inverse:function(e){return(0,i.geocentricToGeodetic)(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]}}),n("1pXHs",function(e,r){t(e.exports,"default",()=>l);var i=s("7M1Nv"),a=s("9ijWS"),n={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},o={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}},l={init:function(){if(Object.keys(o).forEach((function(e){if(void 0===this[e])this[e]=o[e].def;else if(o[e].num&&isNaN(this[e]))throw Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);else o[e].num&&(this[e]=parseFloat(this[e]));o[e].degrees&&(this[e]=this[e]*i.D2R)}).bind(this)),Math.abs(Math.abs(this.lat0)-i.HALF_PI)<i.EPSLN?this.mode=this.lat0<0?n.S_POLE:n.N_POLE:Math.abs(this.lat0)<i.EPSLN?this.mode=n.EQUIT:(this.mode=n.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)},forward:function(e){e.x-=this.long0;var t,r,i,a,s=Math.sin(e.y),o=Math.cos(e.y),l=Math.cos(e.x);switch(this.mode){case n.OBLIQ:r=this.sinph0*s+this.cosph0*o*l;break;case n.EQUIT:r=o*l;break;case n.S_POLE:r=-s;break;case n.N_POLE:r=s}switch(t=(r=this.pn1/(this.p-r))*o*Math.sin(e.x),this.mode){case n.OBLIQ:r*=this.cosph0*s-this.sinph0*o*l;break;case n.EQUIT:r*=s;break;case n.N_POLE:r*=-(o*l);break;case n.S_POLE:r*=o*l}return a=1/((i=r*this.cg+t*this.sg)*this.sw*this.h1+this.cw),t=(t*this.cg-r*this.sg)*this.cw*a,r=i*a,e.x=t*this.a,e.y=r*this.a,e},inverse:function(e){e.x/=this.a,e.y/=this.a;var t,r,s,o,l,u={x:e.x,y:e.y};s=1/(this.pn1-e.y*this.sw),t=this.pn1*e.x*s,r=this.pn1*e.y*this.cw*s,e.x=t*this.cg+r*this.sg,e.y=r*this.cg-t*this.sg;var h=(0,a.default)(e.x,e.y);if(Math.abs(h)<i.EPSLN)u.x=0,u.y=e.y;else{switch(l=1-h*h*this.pfact,o=Math.sqrt(1-(l=(this.p-Math.sqrt(l))/(this.pn1/h+h/this.pn1))*l),this.mode){case n.OBLIQ:u.y=Math.asin(o*this.sinph0+e.y*l*this.cosph0/h),e.y=(o-this.sinph0*Math.sin(u.y))*h,e.x*=l*this.cosph0;break;case n.EQUIT:u.y=Math.asin(e.y*l/h),e.y=o*h,e.x*=l;break;case n.N_POLE:u.y=Math.asin(o),e.y=-e.y;break;case n.S_POLE:u.y=-Math.asin(o)}u.x=Math.atan2(e.x,e.y)}return e.x=u.x+this.long0,e.y=u.y,e},names:["Tilted_Perspective","tpers"]}}),n("bZa0m",function(e,r){t(e.exports,"default",()=>a);var i=s("9ijWS"),a={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw Error();if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var e=1-this.es;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=1/e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(e){var t,r,a,s,n=e.x,o=e.y;if(n-=this.long0,"ellipse"===this.shape){o=Math.atan(this.radius_p2*Math.tan(o));var l=this.radius_p/(0,i.default)(this.radius_p*Math.cos(o),Math.sin(o));if(r=l*Math.cos(n)*Math.cos(o),a=l*Math.sin(n)*Math.cos(o),s=l*Math.sin(o),(this.radius_g-r)*r-a*a-s*s*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;t=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/(0,i.default)(s,t)),e.y=this.radius_g_1*Math.atan(s/t)):(e.x=this.radius_g_1*Math.atan(a/t),e.y=this.radius_g_1*Math.atan(s/(0,i.default)(a,t)))}else"sphere"===this.shape&&(r=Math.cos(n)*(t=Math.cos(o)),a=Math.sin(n)*t,s=Math.sin(o),t=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/(0,i.default)(s,t)),e.y=this.radius_g_1*Math.atan(s/t)):(e.x=this.radius_g_1*Math.atan(a/t),e.y=this.radius_g_1*Math.atan(s/(0,i.default)(a,t))));return e.x=e.x*this.a,e.y=e.y*this.a,e},inverse:function(e){var t,r,a,s,n=-1,o=0,l=0;if(e.x=e.x/this.a,e.y=e.y/this.a,"ellipse"===this.shape){this.flip_axis?(l=Math.tan(e.y/this.radius_g_1),o=Math.tan(e.x/this.radius_g_1)*(0,i.default)(1,l)):(o=Math.tan(e.x/this.radius_g_1),l=Math.tan(e.y/this.radius_g_1)*(0,i.default)(1,o));var u=l/this.radius_p;if(t=o*o+u*u+n*n,(a=(r=2*this.radius_g*n)*r-4*t*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-r-Math.sqrt(a))/(2*t),n=this.radius_g+s*n,o*=s,l*=s,e.x=Math.atan2(o,n),e.y=Math.atan(l*Math.cos(e.x)/n),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if("sphere"===this.shape){if(this.flip_axis?(l=Math.tan(e.y/this.radius_g_1),o=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+l*l)):(o=Math.tan(e.x/this.radius_g_1),l=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+o*o)),t=o*o+l*l+n*n,(a=(r=2*this.radius_g*n)*r-4*t*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-r-Math.sqrt(a))/(2*t),n=this.radius_g+s*n,o*=s,l*=s,e.x=Math.atan2(o,n),e.y=Math.atan(l*Math.cos(e.x)/n)}return e.x=e.x+this.long0,e},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]}}),n("fhacK",function(e,r){t(e.exports,"default",()=>n);var i=s("kEf05"),a=Math.sqrt(3)/2,n={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function(e){var t=(0,i.default)(e.x-this.long0),r=Math.asin(a*Math.sin(e.y)),s=r*r,n=s*s*s;return e.x=t*Math.cos(r)/(a*(1.340264+-.24331799999999998*s+n*(.0062510000000000005+.034164*s))),e.y=r*(1.340264+-.081106*s+n*(893e-6+.003796*s)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t,r,s,n,o,l=e.y;for(o=0;o<12&&(r=(t=l*l)*t*t,s=l*(1.340264+-.081106*t+r*(893e-6+.003796*t))-e.y,l-=n=s/(1.340264+-.24331799999999998*t+r*(.0062510000000000005+.034164*t)),!(1e-9>Math.abs(n)));++o);return r=(t=l*l)*t*t,e.x=a*e.x*(1.340264+-.24331799999999998*t+r*(.0062510000000000005+.034164*t))/Math.cos(l),e.y=Math.asin(Math.sin(l)/a),e.x=(0,i.default)(e.x+this.long0),e},names:["eqearth","Equal Earth","Equal_Earth"]}}),n("eIVBm",function(e,r){t(e.exports,"default",()=>m);var i=s("r1jKt"),a=s("kEf05"),n=s("9ijWS"),o=s("lz6WA"),l=s("6NyiU"),u=s("8GYcG"),h=s("7M1Nv");function c(e){var t,r,i,s=(0,a.default)(e.x-(this.long0||0)),n=e.y;return t=this.am1+this.m1-(0,u.default)(n,r=Math.sin(n),i=Math.cos(n),this.en),r=i*s/(t*Math.sqrt(1-this.es*r*r)),e.x=t*Math.sin(r),e.y=this.am1-t*Math.cos(r),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function d(e){var t,r,s,o;if(e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a,r=(0,n.default)(e.x,e.y=this.am1-e.y),(t=Math.abs(o=(0,l.default)(this.am1+this.m1-r,this.es,this.en)))<h.HALF_PI)t=Math.sin(o),s=r*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(o);else if(1e-10>=Math.abs(t-h.HALF_PI))s=0;else throw Error();return e.x=(0,a.default)(s+(this.long0||0)),e.y=(0,i.default)(o),e}function p(e){var t,r,i=(0,a.default)(e.x-(this.long0||0)),s=e.y;return Math.abs(r=this.cphi1+this.phi1-s)>1e-10?(e.x=r*Math.sin(t=i*Math.cos(s)/r),e.y=this.cphi1-r*Math.cos(t)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function f(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,r,s=(0,n.default)(e.x,e.y=this.cphi1-e.y);if(Math.abs(r=this.cphi1+this.phi1-s)>h.HALF_PI)throw Error();return t=1e-10>=Math.abs(Math.abs(r)-h.HALF_PI)?0:s*Math.atan2(e.x,e.y)/Math.cos(r),e.x=(0,a.default)(t+(this.long0||0)),e.y=(0,i.default)(r),e}var m={init:function(){var e;if(this.phi1=this.lat1,1e-10>Math.abs(this.phi1))throw Error();this.es?(this.en=(0,o.default)(this.es),this.m1=(0,u.default)(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=d,this.forward=c):(Math.abs(this.phi1)+1e-10>=h.HALF_PI?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=f,this.forward=p)},names:["bonne","Bonne (Werner lat_1=90)"]}}),n("iGUgk",function(e,r){t(e.exports,"register",()=>l);var i=s("gzr8q"),a=s("5zIbz"),n=s("eV2fv"),o=s("liPLq");function l(e){let t,r;let s=Object.keys(e.defs),l=s.length;for(t=0;t<l;++t){let r=s[t];if(!(0,n.get)(r)){let t=e.defs(r),s=t.units;s||"longlat"!==t.projName||(s="degrees"),(0,i.addProjection)(new a.default({code:r,axisOrientation:t.axis,metersPerUnit:t.to_meter,units:s}))}}for(t=0;t<l;++t){let a=s[t],u=(0,n.get)(a);for(r=0;r<l;++r){let t=s[r],l=(0,n.get)(t);if(!(0,o.get)(a,t)){if(e.defs[a]===e.defs[t])(0,i.addEquivalentProjections)([u,l]);else{let r=e(a,t);(0,i.addCoordinateTransforms)(u,l,(0,i.createSafeCoordinateTransform)(u,l,r.forward),(0,i.createSafeCoordinateTransform)(l,u,r.inverse))}}}}}}),n("jSBAJ",function(e,r){let i,a;t(e.exports,"getAuth",()=>l),t(e.exports,"default",()=>u);let n=((0,s("bo74g").default).guichetURL+"/").replace(/\/\/$/,"/")+"gcms/api/";function o(e,t,r){t=t||console.log,(r=r||{}).limit&&(e+="?limit="+r.limit),fetch(n+e,{method:"GET",headers:{Authorization:"Basic "+btoa(i+":"+a)}}).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>{t(e)}).catch(e=>{e.status,a=null,e.error=!0,t(e)})}function l(){return!!a&&btoa(i+":"+a)}var u=new class{constructor(){}login(e,t,r){i=e,a=t,o("users/me",r)}getMe(e){o("users/me",e)}logout(){a=null}isConnected(){return!!a}getCommunity(e,t){o("communities/"+e,t)}getLayers(e,t){o("communities/"+e+"/layers",t,{limit:100})}getFullLayers(e,t){this.getLayers(e,e=>{if(!e.length){t(e);return}let r=0;e.forEach(i=>{switch(i.type){case"feature-type":r++,this.getTable(i.database,i.table,a=>{i.table=a,--r||t(e)});break;case"geoservice":r++,this.getGeoservice(i.geoservice.id,a=>{i.geoservice=a,--r||t(e)})}})})}getLayer(e,t,r){o("communities/"+e+"/layers/"+t,r)}getGeoservice(e,t){o("geoservices/"+e,e=>{if(e.style)t(e);else{let r=e.url.split("?")[0]+"?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetCapabilities";try{fetch(r).catch(e=>{console.log("ERROR",e)}).then(e=>e?e.text():"").then(e=>new window.DOMParser().parseFromString(e,"text/xml")).then(r=>{let i=r.querySelectorAll("Contents Layer"),a=Array.prototype.find.call(i,t=>t.querySelector("Identifier").textContent===e.layers);if(a){let t=a.querySelector("Style");t&&(t=t.querySelector("Identifier"),e.style=t?t.textContent:null)}t(e)})}catch(r){console.log("ERROR",e,r),t(null)}}})}getTable(e,t,r){o("databases/"+e+"/tables/"+t,r)}}}),n("2yyih",function(r,i){t(r.exports,"default",()=>b);var a=s("lqNjm"),n=s("4lFOe"),o=s("2zf1Y"),l=s("3yg5q"),u=s("ayeEa"),h=s("h6Aha"),c=s("d5AAH"),d=s("l9IGS"),p=s("kuKBR"),f=s("h1ihb"),m=s("awidM"),g=s("doPrp"),y=s("jSBAJ");let v={};v.formatProperties=function(e,t){if(!e||!e.replace||!t)return e;var r=e.replace(/.*\$\{([^}]*)\}.*/,"$1");return r===e?e:v.formatProperties(e.replace("${"+r+"}",t.get(r)||""),t)},v.formatFeatureStyle=function(e,t){if(!e)return{};var r={};for(var i in e)r[i]=v.formatProperties(e[i],t);return r},v.StrokeLineDash=function(e){var t=Number(e.strokeWidth)||2;switch(e.strokeDashstyle){case"dot":return[1,2*t];case"dash":return[2*t,2*t];case"dashdot":return[2*t,4*t,1,4*t];case"longdash":return[4*t,2*t];case"longdashdot":return[4*t,4*t,1,4*t];default:return}},v.Stroke=function(e){if(0===e.strokeOpacity)return;let t=this.StrokeLineDash(e);var r=new c.default({color:e.strokeColor||"#00f",width:Number(e.strokeWidth)||1,lineDash:t,lineCap:e.strokeLinecap||"round"});if(e.strokeOpacity<1){var i=(0,a.asArray)(r.getColor());i.length&&(i[4]=e.strokeOpacity,r.setColor(i))}return r},v.Fill=function(e){if(0===e.fillOpacity)return;let t=new o.default({color:e.fillColor||"rgba(255,255,255,0.5)"});if(e.fillOpacity<1){let r=(0,a.asArray)(t.getColor());r.length&&(r[3]=Number(e.fillOpacity),t.setColor(r))}return e.fillPattern&&(t=new l.default({fill:t,pattern:e.fillPattern,color:e.patternColor,angle:45})),t};let _={};var x=new n.default({radius:8,stroke:new c.default({color:"#fff",width:1.5}),fill:new o.default({color:"rgba(255,0,0,.5)"})});v.setImage=function(e,t,r){var i,a;if(t.img&&(a=t.img),a){if(_[a])i=_[a];else{let t=new Headers;t.set("Authorization","Basic "+(0,y.getAuth)()),fetch(a,{headers:t}).then(t=>{t.arrayBuffer().then(t=>{let i=btoa(String.fromCharCode(...new Uint8Array(t)));_[a]=new u.default({src:"data:image/png;base64,"+i}),e.setImage(_[a]),r.changed()})}),i=x,_[a]=i}}else{var s=Number(t.pointRadius)||5,o={square:[4,s,void 0,Math.PI/4]};switch(t.graphicName){case"cross":case"star":case"rectangle":case"square":case"triangle":case"x":var l=(o={cross:[4,s,0,0],rectangle:[4,s,void 0,Math.PI/4],square:[4,s,void 0,Math.PI/4],triangle:[3,s,void 0,0],star:[5,s,s/2,0],x:[4,s,0,Math.PI/4]})[t.graphicName]||o.square;if(i=new h.default({points:l[0],radius:l[1],radius2:l[2],rotation:l[3],stroke:v.Stroke(t),fill:v.Fill(t)}),"rectangle"===t.graphicName){var c=i.getImage(),d=document.createElement("canvas");d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0,c.width,c.height,c.width/4,0,c.width/2,c.height),c.getContext("2d").clearRect(0,0,c.width,c.height),c.getContext("2d").drawImage(d,0,0)}break;case"lightning":i=new f.default({glyph:"fa-bolt",radius:s,stroke:v.Stroke(t),fill:v.Fill(t)});break;case"church":i=new f.default({glyph:"fa-venus",rotation:Math.PI,radius:s,stroke:v.Stroke(t),fill:v.Fill(t)});break;default:i=new n.default({radius:s,stroke:v.Stroke(t),fill:v.Fill(t)})}}e.setImage(i)},v.Text=function(e){if(e.label){var t={font:(e.fontWeight||"")+" "+(e.fontSize||"12")+"px "+(e.fontFamily||"Sans-serif"),text:e.label||"",rotation:e.labelRotation||0,textAlign:"left",textBaseline:"middle",offsetX:e.labelXOffset||0,offsetY:-e.labelYOffset||0,stroke:new c.default({color:e.labelOutlineColor||"#fff",width:Number(e.labelOutlineWidth)||2}),fill:new o.default({color:e.fontColor})};return new p.default(t)}},v.getFeatureStyleFn=function(t){t||(t={});var r=new d.default({text:v.Text({label:"›",fontWeight:"bold",fontSize:"25"})});return function(i,a){let s;if(!t.style&&t.name&&v[t.name])return v[t.name](t)(i);let n=t.style;if(t.style&&t.style.children){let r=i.getProperties();delete r.geometry;for(let i=0;i<t.style.children.length;i++){let a=t.style.children[i];if(!a.mongo||!a.mongo.matches){if("string"==typeof a.condition)try{a.condition=JSON.parse(a.condition)}catch(e){}a.mongo=e(g).parse(a.condition)}if(a.mongo.matches(r)){n=a;break}}}let o=v.formatFeatureStyle(n,i);n&&n.name&&(t.symbo_attribute?(o.radius=5,o.img=v.getSymbolURI(t.style,t.style.name+"/"+i.get(t.symbo_attribute.name),t.style.graphicWidth,t.style.graphicHeight,i)):n.externalGraphic&&(o.radius=5,o.img=v.getSymbolURI(t.style,n.externalGraphic,n.graphicWidth,n.graphicHeight,i)));let l=new d.default({});if(l.setText(v.Text(o)),v.setImage(l,o,i),l.setFill(v.Fill(o)),l.setStroke(v.Stroke(o)),t.style&&t.style.directionField)try{s=JSON.parse(t.style.directionField)}catch(e){s=null,console.log("bad json direction field for style "+t.style.name)}if(a<2&&s instanceof Object&&"attribute"in s&&"sensDirect"in s&&"sensInverse"in s){let e=s.sensDirect,t=s.sensInverse,a=i.get(s.attribute);(a===e||a===t)&&(r.getText().setRotation(function(r,i){if(r!=e&&r!=t)return 0;"MultiLineString"===i.getType()&&(i=i.getLineString(0));for(var a,s,n=i.getCoordinates(),o=0,l=i.getLength(),u=0;u<n.length-1&&!((o+=Math.sqrt((a=n[u+1][0]-n[u][0])*a+(s=n[u+1][1]-n[u][1])*s))>=l/2);u++);return r==e?-Math.atan2(s,a):Math.PI-Math.atan2(s,a)}(a,i.getGeometry())),l=[l,r])}return l}},v.getSymbolURI=function(e,t,r,i){return e.uri.replace(/gcms\/.*/,"")+"gcms/style/image/"+t+"?width="+r+"&height="+i},v.Default=v.getFeatureStyleFn()()[0],v.zombie=function(){function e(e,t){return e.get("detruit")?[255,0,0,t]:[0,0,255,t]}return function(t){var r={strokeColor:e(t,1),strokeWidth:2,fillColor:e(t,.5)};return[new d.default({text:v.Text(r),image:v.Image(r),fill:v.Fill(r),stroke:v.Stroke(r)})]}},v.detruit=function(){return function(e){if(!e.get("detruit"))return[];var t={strokeWidth:2,strokeColor:[255,0,0,.5]};return[new d.default({text:v.Text(t),image:v.Image(t),fill:v.Fill(t),stroke:v.Stroke(t)})]}},v.vivant=function(){return function(e){if(e.get("detruit"))return[];var t={strokeWidth:2,strokeColor:[0,0,255,.5]};return[new d.default({text:v.Text(t),image:v.Image(t),fill:v.Fill(t),stroke:v.Stroke(t)})]}},v.combine=function(e){return e instanceof Array||(e=[e]),function(t,r){for(var i=[],a=0;a<e.length;a++)for(var s=e[a](t,r),n=0;n<s.length;n++)i.push(s[n]);return i}},v.troncon_de_route=function(e){return e=e||{},(0,m.default)("BDTOPO_V3:troncon_de_route",{sens:e.sens||2.5})},v.sens=function(e){return e||(e={attribute:"sens_de_circulation",glyph:"›",size:"20px",direct:"Sens direct",inverse:"Sens inverse"}),function(t){var r=t.get(e.attribute),i={label:r==e.direct||r==e.inverse?e.glyph:"",fontWeight:"bold",fontSize:e.size,labelRotation:function(t,r){if(t!=e.direct&&t!=e.inverse)return 0;for(var i,a,s=r.getCoordinates(),n=0,o=r.getLength(),l=0;l<s.length-1&&!((n+=Math.sqrt((i=s[l+1][0]-s[l][0])*i+(a=s[l+1][1]-s[l][1])*a))>=o/2);l++);return t==e.direct?-Math.atan2(a,i):Math.PI-Math.atan2(a,i)}(r,t.getGeometry())};return[new d.default({text:v.Text(i)})]}},v.toponyme=function(e){return e||(e={attribute:"nom",size:"12px"}),e.minResolution||(e.minResolution=0),e.maxResolution||(e.maxResolution=2),function(t,r){if(r>e.maxResolution||r<e.minResolution)return[];var i={label:t.get(e.attribute),fontWeight:e.weight,fontSize:e.size};return[new d.default({text:v.Text(i)})]}},v.batiment=function(e){function t(e,t){switch(e.get("nature")){case"Industriel, agricole ou commercial":return[51,102,153,t];case"Remarquable":return[0,192,0,t];default:switch(e.get("fonction")){case"Indifférenciée":return[128,128,128,t];case"Sportive":return[51,153,102,t];case"Religieuse":return[153,102,51,t];default:return[153,51,51,t]}}}return e||(e={}),function(r){if(r.get("detruit"))return[];var i={strokeColor:t(r,1),fillColor:t(r,.5)};return(/en service/i.test(r.get("etat_de_l_objet"))||(i.dash=!0,i.fillColor=[0,0,0,0]),e.symbol&&(i.label=function(e){switch(e.get("fonction")){case"Commerciale":return"";case"Sportive":return"";case"Mairie":return"";case"Gare":return"";case"Industrielle":return"";default:return null}}(r),i.fontFamily="Fontawesome",i.fontColor=e.color||"magenta"),i.label)?[new d.default({text:v.Text(i),stroke:v.Stroke(i),fill:v.Fill(i)})]:[new d.default({stroke:v.Stroke(i),fill:v.Fill(i)})]}};var b=v}),n("awidM",function(e,r){t(e.exports,"default",()=>p);var i,a,n,o,l=s("l9IGS"),u=s("kuKBR"),h=s("d5AAH"),c=s("2zf1Y"),d=s("lSokP");i={},a=0,n={111:{color:[230,0,77,255],title:"Continuous urban fabric"},112:{color:[255,0,0,255],title:"Discontinuous urban fabric"},121:{color:[204,77,242,255],title:"Industrial or commercial units"},122:{color:[204,0,0,255],title:"Road and rail networks and associated land"},123:{color:[230,204,204,255],title:"Port areas"},124:{color:[230,204,230,255],title:"Airports"},131:{color:[166,0,204,255],title:"Mineral extraction sites"},132:{color:[166,77,0,255],title:"Dump sites"},133:{color:[255,77,255,255],title:"Construction sites"},141:{color:[255,166,255,255],title:"Green urban areas"},142:{color:[255,230,255,255],title:"Sport and leisure facilities"},211:{color:[255,255,168,255],title:"Non-irrigated arable land"},212:{color:[255,255,0,255],title:"Permanently irrigated land"},213:{color:[230,230,0,255],title:"Rice fields"},221:{color:[230,128,0,255],title:"Vineyards"},222:{color:[242,166,77,255],title:"Fruit trees and berry plantations"},223:{color:[230,166,0,255],title:"Olive groves"},231:{color:[230,230,77,255],title:"Pastures"},241:{color:[255,230,166,255],title:"Annual crops associated with permanent crops"},242:{color:[255,230,77,255],title:"Complex cultivation patterns"},243:{color:[230,204,77,255],title:"Land principally occupied by agriculture with significant areas of natural vegetation"},244:{color:[242,204,166,255],title:"Agro-forestry areas"},311:{color:[128,255,0,255],title:"Broad-leaved forest"},312:{color:[0,166,0,255],title:"Coniferous forest"},313:{color:[77,255,0,255],title:"Mixed forest"},321:{color:[204,242,77,255],title:"Natural grasslands"},322:{color:[166,255,128,255],title:"Moors and heathland"},323:{color:[166,230,77,255],title:"Sclerophyllous vegetation"},324:{color:[166,242,0,255],title:"Transitional woodland-shrub"},331:{color:[230,230,230,255],title:"Beaches dunes sands"},332:{color:[204,204,204,255],title:"Bare rocks"},333:{color:[204,255,204,255],title:"Sparsely vegetated areas"},334:{color:[0,0,0,255],title:"Burnt areas"},335:{color:[166,230,204,255],title:"Glaciers and perpetual snow"},411:{color:[166,166,255,255],title:"Inland marshes"},412:{color:[77,77,255,255],title:"Peat bogs"},421:{color:[204,204,255,255],title:"Salt marshes"},422:{color:[230,230,255,255],title:"Salines"},423:{color:[166,166,230,255],title:"Intertidal flats"},511:{color:[0,204,242,255],title:"Water courses"},512:{color:[128,242,230,255],title:"Water bodies"},521:{color:[0,255,166,255],title:"Coastal lagoons"},522:{color:[166,255,230,255],title:"Estuaries"},523:{color:[230,242,255,255],title:"Sea and ocean"}},(o=function(e,t){var r,s,o,p,f,m,g,y,v,_,x,b,S;switch(t=t||{},e){case"BDTOPO_V3:troncon_de_route":return r=t,s=function(e){if(r.vert&&e.get("itineraire_vert"))return 0>e.get("position_par_rapport_au_sol")?[0,128,0,.7]:e.get("position_par_rapport_au_sol")>0?[0,100,0,1]:[0,128,0,1];if(!e.get("importance"))return"magenta";if("Piste cyclable"===e.get("nature"))return[27,177,27,.5];if("0"!=e.get("position_par_rapport_au_sol")){var t;switch(e.get("importance")){case"1":t=[177,27,177,1];break;case"2":t=[177,27,27,1];break;case"3":t=[217,119,0,1];break;case"4":t=[255,225,0,1];break;case"5":t=[204,204,204,1];break;default:t=[211,211,211,1]}return 0>e.get("position_par_rapport_au_sol")&&(t[3]=.7),t}switch(e.get("importance")){case"1":return[255,0,255,1];case"2":return[255,0,0,1];case"3":return[255,165,0,1];case"4":return[255,255,0,1];case"5":return[255,255,255,1];default:return[211,211,211,1]}},o=function(e){if(!e.get("position_par_rapport_au_sol"))return 100;var t=Number(e.get("position_par_rapport_au_sol"));return t>0?10+10*t-(Number(e.get("importance"))||10):t<0?Math.max(4+t,0):10-(Number(e.get("importance"))||10)},p=function(e){for(var t,r,i=e.getCoordinates(),a=0,s=e.getLength(),n=0;n<i.length-1&&!((a+=Math.sqrt((t=i[n+1][0]-i[n][0])*t+(r=i[n+1][1]-i[n][1])*r))>=s/2);n++);return-Math.atan2(r,t)},f=function(e){switch(e.get("nature")){case"Escalier":return[1,4];case"Sentier":return[8,10]}},m="ROUT-"+a+++"-",function(e,t){var a=!0===r.sens||t<r.sens,n=m+e.get("nature")+"-"+e.get("position_par_rapport_au_sol")+"-"+(a?e.get("sens_de_circulation"):"Sans objet")+"-"+e.get("position_par_rapport_au_sol")+"-"+e.get("importance")+"-"+e.get("largeur_de_chaussee")+"-"+e.get("itineraire_vert"),d=i[n];return d||(d=i[n]=[new l.default({text:a&&r.sens&&!/double|sans/i.test(e.get("sens_de_circulation"))?new u.default({text:"Sens direct"==e.get("sens_de_circulation")?"→":"←",font:"bold 12px sans-serif",placement:"point",textAlign:"center",fill:new c.default({color:[0,0,0,.3]}),stroke:new h.default({color:[0,0,0,.3],width:1.5}),rotateWithView:!0}):null,stroke:new h.default({color:s(e),width:Math.max(e.get("largeur_de_chaussee")||2,2),lineDash:f(e)}),zIndex:o(e)-100})]),d[0].getText()&&d[0].getText().setRotation(p(e.getGeometry())),d};case"BDTOPO_V3:batiment":return g=t,y=function(e){switch(e.get("nature")){case"Industriel, agricole ou commercial":return[51,102,153,1];case"Remarquable":return[0,192,0,1];default:switch(e.get("usage_1")){case"Résidentiel":case"Indifférencié":return[128,128,128,1];case"Industriel":case"Commercial et services":return[51,102,153,1];case"Sportif":return[51,153,102,1];case"Religieux":return[153,102,51,1];default:return[153,51,51,1]}}},v=function(e){switch(e.get("usage_1")){case"Commercial et services":return"";case"Sportif":return"";default:return null}},_="BATI-"+a+++"-",function(e){if(e.get("detruit"))return[];var t=i[_+e.get("usage_1")+"-"+e.get("nature")+"-"+e.get("etat_de_l_objet")];if(!t){var r=y(e),a=[r[0],r[1],r[1],.5],s=!/en service/i.test(e.get("etat_de_l_objet"));s&&(a[3]=.1);var n=g.symbol?v(e):null;return[new l.default({text:n?new u.default({text:n,font:"12px FontAwesome",fill:new c.default({color:[0,0,0,.6]})}):null,fill:new c.default({color:a}),stroke:new h.default({color:r,width:1.5,lineDash:s?[5,5]:null})})]}return t};case"CADASTRALPARCELS.PARCELLAIRE_EXPRESS:parcelle":return x=t,b=new l.default({text:new u.default({text:"0000",font:"bold 12px sans-serif",fill:new c.default({color:[100,0,255,1]}),stroke:new h.default({color:[255,255,255,.8],width:3})}),stroke:new h.default({color:[255,165,0,1],width:1.5}),fill:new c.default({color:[100,0,255,.1]})}),function(e,t){return t<.8?b.getText().setFont("bold 12px sans-serif"):b.getText().setFont("bold 10px sans-serif"),x.section?b.getText().setText(e.get("section")+"-"+(e.get("numero")||"").replace(/^0*/,"")):b.getText().setText((e.get("numero")||"").replace(/^0*/,"")),b};default:if(!/LANDCOVER/.test(e))return console.warn("[ol/style/geoportailStyle] no style defined for type: "+e),(0,d.default)();return t.date=e.replace(/[^\d]*(\d*).*/,"$1"),S=t,function(e){var t=e.get("code_"+S.date),r=i["CLC-"+t];if(!r){var a=n[t].color.slice();a[3]=S.opacity||1,r=i["CLC-"+t]=new l.default({fill:new c.default({color:a||[255,255,255,.5]})})}return r}}}).clcColors=JSON.parse(JSON.stringify(n));var p=o}),n("lSokP",function(e,r){t(e.exports,"default",()=>c);var i,a,n,o=s("l9IGS"),l=s("4lFOe"),u=s("d5AAH"),h=s("2zf1Y");i=[255,255,255,1],a=[0,153,255,1],n=[new o.default({stroke:new u.default({color:i,width:5})}),new o.default({image:new l.default({radius:6,fill:new h.default({color:a}),stroke:new u.default({color:i,width:1.5})}),stroke:new u.default({color:a,width:3}),fill:new h.default({color:[255,255,255,.5]})})];var c=function(e){if(!0===e)return n;e=e||{};var t=new h.default({color:e.fillColor||"rgba(255,255,255,0.4)"}),r=new u.default({color:e.color||"#3399CC",width:1.25});return[new o.default({image:new l.default({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}}),n("doPrp",function(e,r){t(e.exports,"DotNotationPointers",()=>i,e=>i=e),t(e.exports,"parse",()=>a,e=>a=e),t(e.exports,"inclusive",()=>n,e=>n=e),t(e.exports,"search",()=>o,e=>o=e),t(e.exports,"compressQuery",()=>l,e=>l=e);var i,a,n,o,l,u=s("fU73w"),h=s("iZyl0"),c=i=s("lUJRH"),d=function(e){this.parts=function e(t){if(t instanceof Function||"string"==typeof t)return t instanceof Function&&(t="("+t+").call(obj)"),[new v(void 0,"$where",Function("return function(){var obj=this; return "+t+"}")())];var r,i=[];for(var a in t)if(a in p){var s=t[a],n=[];s.forEach(function(t){n.push(new v(void 0,"$and",[t],e(t)))}),i.push(new v(void 0,a,t[a],n))}else if(a in f)i.push(new v(void 0,a,t[a]));else if((r=t[a])instanceof Object&&!(r instanceof Array)&&y(t[a]))for(var o in t[a]){var l=t[a][o];i.push(function t(r,i,a){if("$elemMatch"===i)var s=function(r){if(!y(r))return{parts:e(r),implicitField:!1};var i=[];for(var a in r){var s=r[a];i.push(t(void 0,a,s))}return{parts:i,implicitField:!0}}(a),n=s.parts,o=s.implicitField;else if("$not"===i)var n=function(e,r){var i=[];for(var a in r){var s=r[a];i.push(t(e,a,s))}return i}(r,a);else var n=[];return new v(r,i,a,n,o)}(a,o,l))}else i.push(new v(a,"$eq",t[a]));return i}(e)};d.prototype={},d.prototype.map=function(e){return function e(t,r){var i={};return t.forEach(function(t){if("$and"===t.operator)var a=e(t.parts,r);else if(t.operator in p)var a={$or:t.parts.map(function(t){return e(t.parts,r)})};else{var s={};s[t.operator]=t.operand;var n=r(t.field,s),a=function(e,t){if(void 0===t){var r={};if(void 0===e.field)r[e.operator]=e.operand;else{var i={};i[e.operator]=e.operand,r[e.field]=i}return r}return null===t?{}:t}(t,n)}m(i,a)}),g(i),i}(this.parts,e)},d.prototype.mapValues=function(e){return g(u(this.parts,e))},d.prototype.matches=function(e,t){return h(this.parts,e,t)},a=function(e){return new d(e)},n=function(e){return function(e){for(var t in e)if(e[t]){if("$meta"===t||e[t]&&(!(e[t]instanceof Object)||!("$elemMatch"in e[t])&&!("$slice"in e[t])))return!0}else if("_id"!==t)return!1}(e)},o=function(e,t,r,i){var a=new d(t);return e.filter(function(e){return a.matches(e,i)}).sort(function(e,t){for(var i in r){var a=function(e,t,r){var i=c(e,r)[0].val,a=c(t,r)[0].val;return i>a?1:i<a?-1:0}(e,t,i);if(0!==a)return r[i]<0&&(a=-a),a}return 0})};var p={$and:1,$or:1,$nor:1},f={$text:1,$comment:1};function m(e,t){for(var r in t)if(r in e){if("$and"===r)e[r]=e[r].concat(t[r]);else{var i={};i[r]=e[r];var a={};a[r]=t[r];var s={$and:[i,a]};delete e[r],m(e,s)}}else e[r]=t[r]}var g=l=function(e){for(var t in p)t in e&&e[t].forEach(function(e){g(e)});if("$and"in e&&(e.$and.forEach(function(t){for(var r in t)if(r in e){if(!(e[r]instanceof Array)&&"object"==typeof e[r]&&"$"!==r[0])for(var i in t[r])i in e[r]||(e[r][i]=t[r][i],delete t[r][i],0!==Object.keys(t[r]).length||delete t[r])}else e[r]=t[r],delete t[r]}),e.$and=a(e.$and),0===e.$and.length&&delete e.$and),"$or"in e){if(e.$or=a(e.$or),0===e.$or.length)delete e.$or;else if(1===e.$or.length){var r=e.$or[0];delete e.$or,m(e,r)}}for(var i in e)e[i]&&void 0!==e[i].$eq&&1===Object.keys(e[i]).length&&(e[i]=e[i].$eq),e[i]&&void 0!==e[i].$elemMatch&&g(e[i].$elemMatch);return e;function a(e){return e.filter(function(e){return 0!==Object.keys(e).length})}};function y(e){for(var t in e)return"$"===t[0]&&!(t in p)}var v=function(e,t,r,i,a){void 0===i&&(i=[]),this.field=e,this.operator=t,this.operand=r,this.parts=i,this.implicitField=a}}),n("fU73w",function(e,t){var r={$gt:1,$gte:1,$lt:1,$lte:1,$not:1},i={$eq:1,$ne:1},a={$nin:1,$all:1,$in:1},s=e.exports=function(e,t,o){var l={};return e.forEach(function(e){if(void 0!==e.field){if(void 0!==o)var u=o+"."+e.field;else var u=e.field}else var u=o;if(0===e.parts.length){if(e.operator in r)void 0!==e.field?n(l,e.field,e.operator,t(u,e.operand)):l[e.operator]=t(u,e.operand);else if(e.operator in i){if(e.operand instanceof Array)var h=e.operand.map(function(e){return t(u,e)});else var h=t(u,e.operand);n(l,e.field,e.operator,h)}else e.operator in a?n(l,e.field,e.operator,e.operand.map(function(r){return t(e.field,r)})):"$text"===e.operator?(l.$text={$search:t(u,e.operand.$search)},void 0!==e.operand.$language&&(l.$text.$language=e.operand.$language)):void 0!==e.field?n(l,e.field,e.operator,e.operand):l[e.operator]=e.operand}else if("$elemMatch"===e.operator){var c=s(e.parts,t,u);n(l,e.field,e.operator,c)}else if("$not"===e.operator)l[e.operator]=s(e.parts,t,u);else{var d=[];e.parts.forEach(function(e){d.push(s(e.parts,t))}),l[e.operator]=d}}),l};function n(e,t,r,i){void 0===e[t]&&(e[t]={}),e[t][r]=i}}),n("iZyl0",function(e,t){var r=s("lUJRH"),i={$eq:l,$gt:function(e,t){return e>t},$gte:function(e,t){return e>=t},$lt:function(e,t){return e<t},$lte:function(e,t){return e<=t},$ne:function(e,t){return e!==t},$mod:function(e,t){return e%t[0]===t[1]},$regex:function(e,t){return"string"==typeof e&&null!==e.match(RegExp(t))},$exists:function(e,t){return void 0!==e===t},$in:function(e,t){return Array.isArray(e)?e.some(function(e){return -1!==t.indexOf(e)}):-1!==t.indexOf(e)},$nin:function(e,t){return Array.isArray(e)?e.every(function(e){return -1===t.indexOf(e)}):-1===t.indexOf(e)},$all:function(e,t){return e instanceof Array&&e.reduce(function(e,r){return e&&-1!==t.indexOf(r)},!0)}},a={$and:function(e,t){for(var r=0;r<t.length;r++)if(!n(t[r].parts,e))return!1;return!0},$or:function(e,t){for(var r=0;r<t.length;r++)if(n(t[r].parts,e))return!0;return!1},$nor:function(e,t){for(var r=0;r<t.length;r++)if(n(t[r].parts,e))return!1;return!0}},n=e.exports=function(e,t,s){return!1!==s&&function e(t){Object.keys(t).forEach(function(r){if("$"===r[0])throw Error("Field names can't start with $");if(-1!==r.indexOf("."))throw Error("Field names can't contain .");t[r]instanceof Object&&e(t[r])})}(t),e.every(function(e){return function(e,t,s){for(var u=r(t,e.field),h=0;h<u.length;h++){var c=u[h];if(e.operator in i){if(!o(c.val,e.operand,i[e.operator]))continue}else if(e.operator in a){if(!a[e.operator](t,e.parts))continue}else if("$not"===e.operator){if(e.parts.length>0){if(n(e.parts,t,s))continue}else if(!0===o(c.val,e.operand,l))continue}else if("$size"===e.operator)return c.val instanceof Array&&c.val.length===e.operand;else if("$elemMatch"===e.operator){var d=c.val;if(void 0===d)continue;if(e.implicitField)for(var p=0;p<e.parts.length;p++)e.parts[p].field="x";for(var f=!1,p=0;p<d.length;p++){if(e.implicitField)var m={x:d[p]};else var m=d[p];if(n(e.parts,m,s)){f=!0;break}}if(!f)continue}else if("$where"===e.operator){if(void 0!==e.field)var g=c.val;else var g=t;if(!e.operand.call(g))continue}else if("$comment"===e.operator);else throw Error("Unsupported operator: "+e.operator);return!0}return!1}(e,t,s)})};function o(e,t,r){if(!(e instanceof Array))return r(e,t);if(t instanceof Array){if(!r(e,t))return!1}else if(!e.reduce(function(e,i){return e||r(i,t)},!1))return!1;return!0}function l(e,t){if(e instanceof Array)return t instanceof Array&&e.length===t.length&&e.reduce(function(e,r,i){return e&&l(r,t[i])},!0);if(e instanceof Object){if(!(t instanceof Object))return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(var a=0;a<r.length;a++){if(r[a]!==i[a])return!1;var s=r[a];if(!l(e[s],t[s]))return!1}return!0}return null===t?null==e:e===t}}),n("lUJRH",function(e,t){function r(e,t){if(void 0!==e)return e[t]}e.exports=function(e,t){var s,n,o;return void 0===t?t=[]:t instanceof Array||(t=t.split(".")),s=t,o=[{obj:n={dummy:e},last:"dummy",propertyPath:[]}],s.forEach(function(e){var t=[];o.forEach(function(i){var s=r(i.obj,i.last);s instanceof Array&&!a(e)?s.forEach(function(a,n){t.push({obj:r(s,n),propertyPath:i.propertyPath.concat(n,e),last:e})}):t.push({obj:s,propertyPath:i.propertyPath.concat(e),last:e})}),o=t}),o.map(function(t){if(t.obj===n)var r=t.obj.dummy,a=void 0;else var r=t.obj,a=t.last;return new i(e,t.propertyPath,{obj:r,last:a})})};var i=function(e,t,r){this.root=e,void 0===t?this.property=[]:t instanceof Array?this.property=t:this.property=t.split("."),void 0!==r&&(this.propertyInfo=r)};function a(e){return!isNaN(parseInt(e))}i.prototype={},Object.defineProperty(i.prototype,"val",{get:function(){var e=this.propertyInfo;return void 0===e.obj?void 0:void 0!==e.last?e.obj[e.last]:e.obj},set:function(e){void 0===e?void 0!==this.propertyInfo.obj&&delete this.propertyInfo.obj[this.propertyInfo.last]:(void 0===this.propertyInfo.obj&&function(e){for(var t=e.root,r=e.property.length-1,i=0;i<r;i++){var s=t[e.property[i]];if(void 0===s){if(a(e.property[i+1]))var n=[];else var n={};s=t[e.property[i]]=n}t=s}e.propertyInfo={obj:t,last:e.property[r]}}(this),this.propertyInfo.obj[this.propertyInfo.last]=e)}})}),n("fRAGe",function(e,r){t(e.exports,"default",()=>o);var i=s("5TDW7"),a=s("dimsV");class n extends i.default{constructor(){super()}}n.prototype.read=function(e){if("Color"!==e.type)return null;let t=new a.default(e);return this.readOptions(t,e),t},n.prototype.write=function(e){return"Color"!==e.get("type")?null:this.writeOptions(e,{color:e.get("color")})};var o=n}),n("dimsV",function(e,r){t(e.exports,"default",()=>o);var i=s("eEuqc"),a=s("8MDYc");class n extends i.default{constructor(e){(e=Object.assign({},e||{})).maxZoom||delete e.maxZoom,e.minZoom||delete e.minZoom,e.source=new a.default({tileSize:5e3,tileUrlFunction:()=>this._data}),super(e),this.set("type","Color"),this.setBlendMode(e.mode),this.setColor(e.color)}setColor(e){this.set("color",e);let t=document.createElement("canvas");t.width=t.height=10;let r=t.getContext("2d");r.fillStyle=e,r.fillRect(0,0,t.width,t.height),this._data=t.toDataURL("image/png"),this.getSource().refresh()}}var o=n}),n("8qGq9",function(e,r){t(e.exports,"default",()=>l);var i=s("5TDW7"),a=s("8MDYc"),n=s("eEuqc");class o extends i.default{constructor(){super()}}o.prototype.read=function(e){if("Pattern"!==e.type)return null;let t=new n.default({source:new a.default({url:e.url})});return this.readOptions(t,e),t},o.prototype.write=function(e){return"Pattern"!==e.get("type")?null:this.writeOptions(e,{url:e.getSource().getUrls()[0]})};var l=o}),n("dxNAB",function(i,a){t(i.exports,"jsPDF",()=>z);/** @license
 *
 * jsPDF - PDF Document creation from JavaScript
 * Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
 *                      CommitID 00000000
 *
 * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
 *               2015-2021 yWorks GmbH, http://www.yworks.com
 *               2015-2021 Lukas Holländer <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
 *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
 *               2010 Aaron Spike, https://github.com/acspike
 *               2012 Willow Systems Corporation, https://github.com/willowsystems
 *               2012 Pablo Hess, https://github.com/pablohess
 *               2012 Florian Jenett, https://github.com/fjenett
 *               2013 Warren Weckesser, https://github.com/warrenweckesser
 *               2013 Youssef Beddad, https://github.com/lifof
 *               2013 Lee Driscoll, https://github.com/lsdriscoll
 *               2013 Stefan Slonevskiy, https://github.com/stefslon
 *               2013 Jeremy Morel, https://github.com/jmorel
 *               2013 Christoph Hartmann, https://github.com/chris-rock
 *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
 *               2014 James Makes, https://github.com/dollaruw
 *               2014 Diego Casorran, https://github.com/diegocr
 *               2014 Steven Spungin, https://github.com/Flamenco
 *               2014 Kenneth Glassey, https://github.com/Gavvers
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Contributor(s):
 *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
 *    kim3er, mfo, alnorth, Flamenco
 */var n=s("agEcb"),o=s("kvvuk"),l=function(){return"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this}();function u(){l.console&&"function"==typeof l.console.log&&l.console.log.apply(l.console,arguments)}var h={log:u,warn:function(e){l.console&&("function"==typeof l.console.warn?l.console.warn.apply(l.console,arguments):u.call(null,arguments))},error:function(e){l.console&&("function"==typeof l.console.error?l.console.error.apply(l.console,arguments):u(e))}};function c(e,t,r){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){g(i.response,t,r)},i.onerror=function(){h.error("could not download file")},i.send()}function d(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function p(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var f,m,g=l.saveAs||("object"!==("undefined"==typeof window?"undefined":e(n)(window))||window!==l?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var i=l.URL||l.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?d(a.href)?c(e,t,r):p(a,a.target="_blank"):p(a)):(a.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(a.href)},4e4),setTimeout(function(){p(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,i){if(r=r||t.name||"download","string"==typeof t){if(d(t))c(t,r,i);else{var a,s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){p(s)})}}else navigator.msSaveOrOpenBlob((void 0===(a=i)?a={autoBom:!1}:"object"!==e(n)(a)&&(h.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t),r)}:function(t,r,i,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return c(t,r,i);var s="application/octet-stream"===t.type,o=/constructor/i.test(l.HTMLElement)||l.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||s&&o)&&"object"===("undefined"==typeof FileReader?"undefined":e(n)(FileReader))){var h=new FileReader;h.onloadend=function(){var e=h.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},h.readAsDataURL(t)}else{var d=l.URL||l.webkitURL,p=d.createObjectURL(t);a?a.location=p:location.href=p,a=null,setTimeout(function(){d.revokeObjectURL(p)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function y(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=({aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"})[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],i=0;i<r.length;i++){var a=r[i].re,s=r[i].process,n=a.exec(e);n&&(t=s(n),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==r.length&&(r="0"+r),"#"+e+t+r}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function v(e,t){var r=e[0],i=e[1],a=e[2],s=e[3];r=x(r,i,a,s,t[0],7,-680876936),s=x(s,r,i,a,t[1],12,-389564586),a=x(a,s,r,i,t[2],17,606105819),i=x(i,a,s,r,t[3],22,-1044525330),r=x(r,i,a,s,t[4],7,-176418897),s=x(s,r,i,a,t[5],12,1200080426),a=x(a,s,r,i,t[6],17,-1473231341),i=x(i,a,s,r,t[7],22,-45705983),r=x(r,i,a,s,t[8],7,1770035416),s=x(s,r,i,a,t[9],12,-1958414417),a=x(a,s,r,i,t[10],17,-42063),i=x(i,a,s,r,t[11],22,-1990404162),r=x(r,i,a,s,t[12],7,1804603682),s=x(s,r,i,a,t[13],12,-40341101),a=x(a,s,r,i,t[14],17,-1502002290),r=b(r,i=x(i,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=b(s,r,i,a,t[6],9,-1069501632),a=b(a,s,r,i,t[11],14,643717713),i=b(i,a,s,r,t[0],20,-373897302),r=b(r,i,a,s,t[5],5,-701558691),s=b(s,r,i,a,t[10],9,38016083),a=b(a,s,r,i,t[15],14,-660478335),i=b(i,a,s,r,t[4],20,-405537848),r=b(r,i,a,s,t[9],5,568446438),s=b(s,r,i,a,t[14],9,-1019803690),a=b(a,s,r,i,t[3],14,-187363961),i=b(i,a,s,r,t[8],20,1163531501),r=b(r,i,a,s,t[13],5,-1444681467),s=b(s,r,i,a,t[2],9,-51403784),a=b(a,s,r,i,t[7],14,1735328473),r=S(r,i=b(i,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=S(s,r,i,a,t[8],11,-2022574463),a=S(a,s,r,i,t[11],16,1839030562),i=S(i,a,s,r,t[14],23,-35309556),r=S(r,i,a,s,t[1],4,-1530992060),s=S(s,r,i,a,t[4],11,1272893353),a=S(a,s,r,i,t[7],16,-155497632),i=S(i,a,s,r,t[10],23,-1094730640),r=S(r,i,a,s,t[13],4,681279174),s=S(s,r,i,a,t[0],11,-358537222),a=S(a,s,r,i,t[3],16,-722521979),i=S(i,a,s,r,t[6],23,76029189),r=S(r,i,a,s,t[9],4,-640364487),s=S(s,r,i,a,t[12],11,-421815835),a=S(a,s,r,i,t[15],16,530742520),r=w(r,i=S(i,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=w(s,r,i,a,t[7],10,1126891415),a=w(a,s,r,i,t[14],15,-1416354905),i=w(i,a,s,r,t[5],21,-57434055),r=w(r,i,a,s,t[12],6,1700485571),s=w(s,r,i,a,t[3],10,-1894986606),a=w(a,s,r,i,t[10],15,-1051523),i=w(i,a,s,r,t[1],21,-2054922799),r=w(r,i,a,s,t[8],6,1873313359),s=w(s,r,i,a,t[15],10,-30611744),a=w(a,s,r,i,t[6],15,-1560198380),i=w(i,a,s,r,t[13],21,1309151649),r=w(r,i,a,s,t[4],6,-145523070),s=w(s,r,i,a,t[11],10,-1120210379),a=w(a,s,r,i,t[2],15,718787259),i=w(i,a,s,r,t[9],21,-343485551),e[0]=R(r,e[0]),e[1]=R(i,e[1]),e[2]=R(a,e[2]),e[3]=R(s,e[3])}function _(e,t,r,i,a,s){return t=R(R(t,e),R(i,s)),R(t<<a|t>>>32-a,r)}function x(e,t,r,i,a,s,n){return _(t&r|~t&i,e,t,a,s,n)}function b(e,t,r,i,a,s,n){return _(t&i|r&~i,e,t,a,s,n)}function S(e,t,r,i,a,s,n){return _(t^r^i,e,t,a,s,n)}function w(e,t,r,i,a,s,n){return _(r^(t|~i),e,t,a,s,n)}function E(e){var t,r=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)v(i,function(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(v(i,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,v(i,a),i}f=l.atob.bind(l),m=l.btoa.bind(l);var A="0123456789abcdef".split("");function T(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function C(e){return E(e).map(T).join("")}var P="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=function(e){for(var t="",r=0;r<4;r++)t+=A[e>>8*r+4&15]+A[e>>8*r&15];return t}(e[t]);return e.join("")}(E("hello"));function R(e,t){if(P){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function I(e,t){if(e!==r){for(var r,i,a=Array(1+(256/e.length>>0)+1).join(e),s=[],n=0;n<256;n++)s[n]=n;var o=0;for(n=0;n<256;n++){var l=s[n];o=(o+l+a.charCodeAt(n))%256,s[n]=s[o],s[o]=l}r=e,i=s}else s=i;var u=t.length,h=0,c=0,d="";for(n=0;n<u;n++)c=(c+(l=s[h=(h+1)%256]))%256,s[h]=s[c],s[c]=l,a=s[(s[h]+s[c])%256],d+=String.fromCharCode(t.charCodeAt(n)^a);return d}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var L={print:4,modify:8,copy:16,"annot-forms":32};function O(e,t,r,i){this.v=1,this.r=2;var a=192;e.forEach(function(e){if(void 0!==L.perm)throw Error("Invalid permission: "+e);a+=L[e]}),this.padding="(¿N^NuAd\x00NVÿú\x01\b..\x00¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),n=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,n),this.P=-(1+(255^a)),this.encryptionKey=C(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=I(this.encryptionKey,this.padding)}function M(e){if(/[^\u0000-\u00ff]/.test(e))throw Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,i=0;i<r;i++){var a=e.charCodeAt(i);a<33||35===a||37===a||40===a||41===a||47===a||60===a||62===a||91===a||93===a||123===a||125===a||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[i]}return t}function k(t){if("object"!==e(n)(t))throw Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(e,t,i){if(i=i||!1,"string"!=typeof e||"function"!=typeof t||"boolean"!=typeof i)throw Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(e)||(r[e]={});var a=Math.random().toString(35);return r[e][a]=[t,!!i],a},this.unsubscribe=function(e){for(var t in r)if(r[t][e])return delete r[t][e],0===Object.keys(r[t]).length&&delete r[t],!0;return!1},this.publish=function(e){if(r.hasOwnProperty(e)){var i=Array.prototype.slice.call(arguments,1),a=[];for(var s in r[e]){var n=r[e][s];try{n[0].apply(t,i)}catch(e){l.console&&h.error("jsPDF PubSub Error",e.message,e)}n[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function N(e){if(!(this instanceof N))return new N(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function D(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function F(e,t,r,i,a){if(!(this instanceof F))return new F(e,t,r,i,a);this.type="axial"===e?2:3,this.coords=t,this.colors=r,D.call(this,i,a)}function G(e,t,r,i,a){if(!(this instanceof G))return new G(e,t,r,i,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,D.call(this,i,a)}function z(t){var r,i="string"==typeof arguments[0]?arguments[0]:"p",a=arguments[1],s=arguments[2],o=arguments[3],u=[],c=1,d=16,p="S",f=null;"object"===e(n)(t=t||{})&&(i=t.orientation,a=t.unit||a,s=t.format||s,o=t.compress||t.compressPdf||o,null!==(f=t.encryption||null)&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),c="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(r=t.precision),void 0!==t.floatPrecision&&(d=t.floatPrecision),p=t.defaultPathOperation||"S"),u=t.filters||(!0===o?["FlateEncode"]:u),a=a||"mm",i=(""+(i||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,_={},x={internal:{},__private__:{}};x.__private__.PubSub=k;var b="1.3",S=x.__private__.getPdfVersion=function(){return b};x.__private__.setPdfVersion=function(e){b=e};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};x.__private__.getPageFormats=function(){return w};var E=x.__private__.getPageFormat=function(e){return w[e]};s=s||"a4";var A={COMPAT:"compat",ADVANCED:"advanced"},T=A.COMPAT;function C(){this.saveGraphicsState(),ec(new eZ(eT,0,0,-eT,0,ry()*eT).toString()+" cm"),this.setFontSize(this.getFontSize()/eT),p="n",T=A.ADVANCED}function P(){this.restoreGraphicsState(),p="S",T=A.COMPAT}var R=x.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};x.advancedAPI=function(e){var t=T===A.COMPAT;return t&&C.call(this),"function"!=typeof e||(e(this),t&&P.call(this)),this},x.compatAPI=function(e){var t=T===A.ADVANCED;return t&&P.call(this),"function"!=typeof e||(e(this),t&&C.call(this)),this},x.isAdvancedAPI=function(){return T===A.ADVANCED};var I,L=function(e){if(T!==A.ADVANCED)throw Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},D=x.roundToPrecision=x.__private__.roundToPrecision=function(e,t){var i=r||t;if(isNaN(e)||isNaN(i))throw Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(i).replace(/0+$/,"")};I=x.hpf=x.__private__.hpf="number"==typeof d?function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.hpf");return D(e,d)}:"smart"===d?function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.hpf");return D(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.hpf");return D(e,16)};var q=x.f2=x.__private__.f2=function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.f2");return D(e,2)},j=x.__private__.f3=function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.f3");return D(e,3)},B=x.scale=x.__private__.scale=function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.scale");return T===A.COMPAT?e*eT:T===A.ADVANCED?e:void 0},U=function(e){return B(T===A.COMPAT?ry()-e:T===A.ADVANCED?e:void 0)};x.__private__.setPrecision=x.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(r=parseInt(e,10))};var H,Z="00000000000000000000000000000000",V=x.__private__.getFileId=function(){return Z},Y=x.__private__.setFileId=function(e){return Z=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():Z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==f&&(tN=new O(f.userPermissions,f.userPassword,f.ownerPassword,Z)),Z};x.setFileId=function(e){return Y(e),this},x.getFileId=function(){return V()};var W=x.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),r=[t<0?"+":"-",Q(Math.floor(Math.abs(t/60))),"'",Q(Math.abs(t%60)),"'"].join("");return["D:",e.getFullYear(),Q(e.getMonth()+1),Q(e.getDate()),Q(e.getHours()),Q(e.getMinutes()),Q(e.getSeconds()),r].join("")},$=x.__private__.convertPDFDateToDate=function(e){return new Date(parseInt(e.substr(2,4),10),parseInt(e.substr(6,2),10)-1,parseInt(e.substr(8,2),10),parseInt(e.substr(10,2),10),parseInt(e.substr(12,2),10),parseInt(e.substr(14,2),10),0)},X=x.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=W(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return H=t},K=x.__private__.getCreationDate=function(e){var t=H;return"jsDate"===e&&(t=$(H)),t};x.setCreationDate=function(e){return X(e),this},x.getCreationDate=function(e){return K(e)};var J,Q=x.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},ee=x.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},et=0,er=[],ei=[],ea=0,es=[],en=[],eo=!1,el=ei,eu=function(){et=0,ea=0,ei=[],er=[],es=[],eQ=eX(),e0=eX()};x.__private__.setCustomOutputDestination=function(e){eo=!0,el=e};var eh=function(e){eo||(el=e)};x.__private__.resetCustomOutputDestination=function(){eo=!1,el=ei};var ec=x.__private__.out=function(e){return e=e.toString(),ea+=e.length+1,el.push(e),el},ed=x.__private__.write=function(e){return ec(1==arguments.length?e.toString():Array.prototype.join.call(arguments," "))},ep=x.__private__.getArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r);t--;)i[t]=e.charCodeAt(t);return r},ef=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];x.__private__.getStandardFonts=function(){return ef};var em=t.fontSize||16;x.__private__.setFontSize=x.setFontSize=function(e){return em=T===A.ADVANCED?e/eT:e,this};var eg,ey=x.__private__.getFontSize=x.getFontSize=function(){return T===A.COMPAT?em:em*eT},ev=t.R2L||!1;x.__private__.setR2L=x.setR2L=function(e){return ev=e,this},x.__private__.getR2L=x.getR2L=function(){return ev};var e_,ex=x.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))eg=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');eg=e}else eg=parseInt(e,10)};x.__private__.getZoomMode=function(){return eg};var eb,eS=x.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');e_=e};x.__private__.getPageMode=function(){return e_};var ew=x.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');eb=e};x.__private__.getLayoutMode=function(){return eb},x.__private__.setDisplayMode=x.setDisplayMode=function(e,t,r){return ex(e),ew(t),eS(r),this};var eE={title:"",subject:"",author:"",keywords:"",creator:""};x.__private__.getDocumentProperty=function(e){if(-1===Object.keys(eE).indexOf(e))throw Error("Invalid argument passed to jsPDF.getDocumentProperty");return eE[e]},x.__private__.getDocumentProperties=function(){return eE},x.__private__.setDocumentProperties=x.setProperties=x.setDocumentProperties=function(e){for(var t in eE)eE.hasOwnProperty(t)&&e[t]&&(eE[t]=e[t]);return this},x.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(eE).indexOf(e))throw Error("Invalid arguments passed to jsPDF.setDocumentProperty");return eE[e]=t};var eA,eT,eC,eP,eR,eI={},eL={},eO=[],eM={},ek={},eN={},eD={},eF=null,eG=0,ez=[],eq=new k(x),ej=t.hotfixes||[],eB={},eU={},eH=[],eZ=function e(t,r,i,a,s,n){if(!(this instanceof e))return new e(t,r,i,a,s,n);isNaN(t)&&(t=1),isNaN(r)&&(r=0),isNaN(i)&&(i=0),isNaN(a)&&(a=1),isNaN(s)&&(s=0),isNaN(n)&&(n=0),this._matrix=[t,r,i,a,s,n]};Object.defineProperty(eZ.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(eZ.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(eZ.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(eZ.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(eZ.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(eZ.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(eZ.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(eZ.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(eZ.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(eZ.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(eZ.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(eZ.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(eZ.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(eZ.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(eZ.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(eZ.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),eZ.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(e)},eZ.prototype.multiply=function(e){return new eZ(e.sx*this.sx+e.shy*this.shx,e.sx*this.shy+e.shy*this.sy,e.shx*this.sx+e.sy*this.shx,e.shx*this.shy+e.sy*this.sy,e.tx*this.sx+e.ty*this.shx+this.tx,e.tx*this.shy+e.ty*this.sy+this.ty)},eZ.prototype.decompose=function(){var e=this.sx,t=this.shy,r=this.shx,i=this.sy,a=this.tx,s=this.ty,n=Math.sqrt(e*e+t*t),o=(e/=n)*r+(t/=n)*i,l=Math.sqrt((r-=e*o)*r+(i-=t*o)*i);return o/=l,e*(i/=l)<t*(r/=l)&&(e=-e,t=-t,o=-o,n=-n),{scale:new eZ(n,0,0,l,0,0),translate:new eZ(1,0,0,1,a,s),rotate:new eZ(e,t,-t,e,0,0),skew:new eZ(1,0,o,1,0,0)}},eZ.prototype.toString=function(e){return this.join(" ")},eZ.prototype.inversed=function(){var e=this.sx,t=this.shy,r=this.shx,i=this.sy,a=this.tx,s=this.ty,n=1/(e*i-t*r),o=i*n,l=-t*n,u=-r*n,h=e*n;return new eZ(o,l,u,h,-o*a-u*s,-l*a-h*s)},eZ.prototype.applyToPoint=function(e){return new ru(e.x*this.sx+e.y*this.shx+this.tx,e.x*this.shy+e.y*this.sy+this.ty)},eZ.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),r=this.applyToPoint(new ru(e.x+e.w,e.y+e.h));return new rh(t.x,t.y,r.x-t.x,r.y-t.y)},eZ.prototype.clone=function(){return new eZ(this.sx,this.shy,this.shx,this.sy,this.tx,this.ty)},x.Matrix=eZ;var eV=x.matrixMult=function(e,t){return t.multiply(e)},eY=new eZ(1,0,0,1,0,0);x.unitMatrix=x.identityMatrix=eY;var eW=function(e,t){if(!ek[e]){var r=(t instanceof F?"Sh":"P")+(Object.keys(eM).length+1).toString(10);t.id=r,ek[e]=r,eM[r]=t,eq.publish("addPattern",t)}};x.ShadingPattern=F,x.TilingPattern=G,x.addShadingPattern=function(e,t){return L("addShadingPattern()"),eW(e,t),this},x.beginTilingPattern=function(e){L("beginTilingPattern()"),rd(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},x.endTilingPattern=function(e,t){L("endTilingPattern()"),t.stream=en[J].join("\n"),eW(e,t),eq.publish("endTilingPattern",t),eH.pop().restore()};var e$=x.__private__.newObject=function(){var e=eX();return eK(e,!0),e},eX=x.__private__.newObjectDeferred=function(){return er[++et]=function(){return ea},et},eK=function(e,t){return t="boolean"==typeof t&&t,er[e]=ea,t&&ec(e+" 0 obj"),e},eJ=x.__private__.newAdditionalObject=function(){var e={objId:eX(),content:""};return es.push(e),e},eQ=eX(),e0=eX(),e1=x.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5===t.length&&("k"===t[4]||"K"===t[4])&&(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var r=parseFloat(t[0]);t=[r,r,r,"r"]}for(var i="#",a=0;a<3;a++)i+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return i},e2=x.__private__.encodeColorString=function(t){"string"==typeof t&&(t={ch1:t});var r,i=t.ch1,a=t.ch2,s=t.ch3,o=t.ch4,l="draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof i&&"#"!==i.charAt(0)){var u=new y(i);if(u.ok)i=u.toHex();else if(!/^\d*\.?\d*$/.test(i))throw Error('Invalid color "'+i+'" passed to jsPDF.encodeColorString.')}if("string"==typeof i&&/^#[0-9A-Fa-f]{3}$/.test(i)&&(i="#"+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]),"string"==typeof i&&/^#[0-9A-Fa-f]{6}$/.test(i)){var h=parseInt(i.substr(1),16);i=h>>16&255,a=h>>8&255,s=255&h}if(void 0===a||void 0===o&&i===a&&a===s)r="string"==typeof i?i+" "+l[0]:2===t.precision?q(i/255)+" "+l[0]:j(i/255)+" "+l[0];else if(void 0===o||"object"===e(n)(o)){if(o&&!isNaN(o.a)&&0===o.a)return["1.","1.","1.",l[1]].join(" ");r="string"==typeof i?[i,a,s,l[1]].join(" "):2===t.precision?[q(i/255),q(a/255),q(s/255),l[1]].join(" "):[j(i/255),j(a/255),j(s/255),l[1]].join(" ")}else r="string"==typeof i?[i,a,s,o,l[2]].join(" "):2===t.precision?[q(i),q(a),q(s),q(o),l[2]].join(" "):[j(i),j(a),j(s),j(o),l[2]].join(" ");return r},e5=x.__private__.getFilters=function(){return u},e3=x.__private__.putStream=function(e){var t=(e=e||{}).data||"",r=e.filters||e5(),i=e.alreadyAppliedFilters||[],a=e.addLength1||!1,s=t.length,n=e.objectId,o=function(e){return e};if(null!==f&&void 0===n)throw Error("ObjectId must be passed to putStream for file encryption");null!==f&&(o=tN.encryptor(n,0));var l={};!0===r&&(r=["FlateEncode"]);var u=e.additionalKeyValues||[],h=(l=void 0!==z.API.processDataByFilters?z.API.processDataByFilters(t,r):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(i)?i.join(" "):i.toString());if(0!==l.data.length&&(u.push({key:"Length",value:l.data.length}),!0===a&&u.push({key:"Length1",value:s})),0!=h.length){if(h.split("/").length-1==1)u.push({key:"Filter",value:h});else{u.push({key:"Filter",value:"["+h+"]"});for(var c=0;c<u.length;c+=1)if("DecodeParms"===u[c].key){for(var d=[],p=0;p<l.reverseChain.split("/").length-1;p+=1)d.push("null");d.push(u[c].value),u[c].value="["+d.join(" ")+"]"}}}ec("<<");for(var m=0;m<u.length;m++)ec("/"+u[m].key+" "+u[m].value);ec(">>"),0!==l.data.length&&(ec("stream"),ec(o(l.data)),ec("endstream"))},e4=x.__private__.putPage=function(e){var t=e.number,r=e.data,i=e.objId,a=e.contentsObjId;eK(i,!0),ec("<</Type /Page"),ec("/Parent "+e.rootDictionaryObjId+" 0 R"),ec("/Resources "+e.resourceDictionaryObjId+" 0 R"),ec("/MediaBox ["+parseFloat(I(e.mediaBox.bottomLeftX))+" "+parseFloat(I(e.mediaBox.bottomLeftY))+" "+I(e.mediaBox.topRightX)+" "+I(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&ec("/CropBox ["+I(e.cropBox.bottomLeftX)+" "+I(e.cropBox.bottomLeftY)+" "+I(e.cropBox.topRightX)+" "+I(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&ec("/BleedBox ["+I(e.bleedBox.bottomLeftX)+" "+I(e.bleedBox.bottomLeftY)+" "+I(e.bleedBox.topRightX)+" "+I(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&ec("/TrimBox ["+I(e.trimBox.bottomLeftX)+" "+I(e.trimBox.bottomLeftY)+" "+I(e.trimBox.topRightX)+" "+I(e.trimBox.topRightY)+"]"),null!==e.artBox&&ec("/ArtBox ["+I(e.artBox.bottomLeftX)+" "+I(e.artBox.bottomLeftY)+" "+I(e.artBox.topRightX)+" "+I(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&ec("/UserUnit "+e.userUnit),eq.publish("putPage",{objId:i,pageContext:ez[t],pageNumber:t,page:r}),ec("/Contents "+a+" 0 R"),ec(">>"),ec("endobj");var s=r.join("\n");return T===A.ADVANCED&&(s+="\nQ"),eK(a,!0),e3({data:s,filters:e5(),objectId:a}),ec("endobj"),i},e6=x.__private__.putPages=function(){var e,t,r=[];for(e=1;e<=eG;e++)ez[e].objId=eX(),ez[e].contentsObjId=eX();for(e=1;e<=eG;e++)r.push(e4({number:e,data:en[e],objId:ez[e].objId,contentsObjId:ez[e].contentsObjId,mediaBox:ez[e].mediaBox,cropBox:ez[e].cropBox,bleedBox:ez[e].bleedBox,trimBox:ez[e].trimBox,artBox:ez[e].artBox,userUnit:ez[e].userUnit,rootDictionaryObjId:eQ,resourceDictionaryObjId:e0}));eK(eQ,!0),ec("<</Type /Pages");var i="/Kids [";for(t=0;t<eG;t++)i+=r[t]+" 0 R ";ec(i+"]"),ec("/Count "+eG),ec(">>"),ec("endobj"),eq.publish("postPutPages")},e8=function(e){eq.publish("putFont",{font:e,out:ec,newObject:e$,putStream:e3}),!0!==e.isAlreadyPutted&&(e.objectNumber=e$(),ec("<<"),ec("/Type /Font"),ec("/BaseFont /"+M(e.postScriptName)),ec("/Subtype /Type1"),"string"==typeof e.encoding&&ec("/Encoding /"+e.encoding),ec("/FirstChar 32"),ec("/LastChar 255"),ec(">>"),ec("endobj"))},e7=function(){for(var e in eI)eI.hasOwnProperty(e)&&(!1===v||!0===v&&_.hasOwnProperty(e))&&e8(eI[e])},e9=function(e){e.objectNumber=e$();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[I(e.x),I(e.y),I(e.x+e.width),I(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),e3({data:e.pages[1].join("\n"),additionalKeyValues:t,objectId:e.objectNumber}),ec("endobj")},te=function(){for(var e in eB)eB.hasOwnProperty(e)&&e9(eB[e])},tt=function(e,t){var r,i=[],a=1/(t-1);for(r=0;r<1;r+=a)i.push(r);if(i.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var n={offset:1,color:e[e.length-1].color};e.push(n)}for(var o="",l=0,u=0;u<i.length;u++){for(r=i[u];r>e[l+1].offset;)l++;var h=e[l].offset,c=(r-h)/(e[l+1].offset-h),d=e[l].color,p=e[l+1].color;o+=ee(Math.round((1-c)*d[0]+c*p[0]).toString(16))+ee(Math.round((1-c)*d[1]+c*p[1]).toString(16))+ee(Math.round((1-c)*d[2]+c*p[2]).toString(16))}return o.trim()},tr=function(e,t){t||(t=21);var r=e$(),i=tt(e.colors,t),a=[];a.push({key:"FunctionType",value:"0"}),a.push({key:"Domain",value:"[0.0 1.0]"}),a.push({key:"Size",value:"["+t+"]"}),a.push({key:"BitsPerSample",value:"8"}),a.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),a.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),e3({data:i,additionalKeyValues:a,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:r}),ec("endobj"),e.objectNumber=e$(),ec("<< /ShadingType "+e.type),ec("/ColorSpace /DeviceRGB");var s="/Coords ["+I(parseFloat(e.coords[0]))+" "+I(parseFloat(e.coords[1]))+" ";2===e.type?s+=I(parseFloat(e.coords[2]))+" "+I(parseFloat(e.coords[3])):s+=I(parseFloat(e.coords[2]))+" "+I(parseFloat(e.coords[3]))+" "+I(parseFloat(e.coords[4]))+" "+I(parseFloat(e.coords[5])),ec(s+="]"),e.matrix&&ec("/Matrix ["+e.matrix.toString()+"]"),ec("/Function "+r+" 0 R"),ec("/Extend [true true]"),ec(">>"),ec("endobj")},ti=function(e,t){var r=eX(),i=e$();t.push({resourcesOid:r,objectOid:i}),e.objectNumber=i;var a=[];a.push({key:"Type",value:"/Pattern"}),a.push({key:"PatternType",value:"1"}),a.push({key:"PaintType",value:"1"}),a.push({key:"TilingType",value:"1"}),a.push({key:"BBox",value:"["+e.boundingBox.map(I).join(" ")+"]"}),a.push({key:"XStep",value:I(e.xStep)}),a.push({key:"YStep",value:I(e.yStep)}),a.push({key:"Resources",value:r+" 0 R"}),e.matrix&&a.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),e3({data:e.stream,additionalKeyValues:a,objectId:e.objectNumber}),ec("endobj")},ta=function(e){var t;for(t in eM)eM.hasOwnProperty(t)&&(eM[t]instanceof F?tr(eM[t]):eM[t]instanceof G&&ti(eM[t],e))},ts=function(e){for(var t in e.objectNumber=e$(),ec("<<"),e)switch(t){case"opacity":ec("/ca "+q(e[t]));break;case"stroke-opacity":ec("/CA "+q(e[t]))}ec(">>"),ec("endobj")},tn=function(){var e;for(e in eN)eN.hasOwnProperty(e)&&ts(eN[e])},to=function(){for(var e in ec("/XObject <<"),eB)eB.hasOwnProperty(e)&&eB[e].objectNumber>=0&&ec("/"+e+" "+eB[e].objectNumber+" 0 R");eq.publish("putXobjectDict"),ec(">>")},tl=function(){tN.oid=e$(),ec("<<"),ec("/Filter /Standard"),ec("/V "+tN.v),ec("/R "+tN.r),ec("/U <"+tN.toHexString(tN.U)+">"),ec("/O <"+tN.toHexString(tN.O)+">"),ec("/P "+tN.P),ec(">>"),ec("endobj")},tu=function(){for(var e in ec("/Font <<"),eI)eI.hasOwnProperty(e)&&(!1===v||!0===v&&_.hasOwnProperty(e))&&ec("/"+e+" "+eI[e].objectNumber+" 0 R");ec(">>")},th=function(){if(Object.keys(eM).length>0){for(var e in ec("/Shading <<"),eM)eM.hasOwnProperty(e)&&eM[e]instanceof F&&eM[e].objectNumber>=0&&ec("/"+e+" "+eM[e].objectNumber+" 0 R");eq.publish("putShadingPatternDict"),ec(">>")}},tc=function(e){if(Object.keys(eM).length>0){for(var t in ec("/Pattern <<"),eM)eM.hasOwnProperty(t)&&eM[t]instanceof x.TilingPattern&&eM[t].objectNumber>=0&&eM[t].objectNumber<e&&ec("/"+t+" "+eM[t].objectNumber+" 0 R");eq.publish("putTilingPatternDict"),ec(">>")}},td=function(){if(Object.keys(eN).length>0){var e;for(e in ec("/ExtGState <<"),eN)eN.hasOwnProperty(e)&&eN[e].objectNumber>=0&&ec("/"+e+" "+eN[e].objectNumber+" 0 R");eq.publish("putGStateDict"),ec(">>")}},tp=function(e){eK(e.resourcesOid,!0),ec("<<"),ec("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),tu(),th(),tc(e.objectOid),td(),to(),ec(">>"),ec("endobj")},tf=function(){var e=[];e7(),tn(),te(),ta(e),eq.publish("putResources"),e.forEach(tp),tp({resourcesOid:e0,objectOid:Number.MAX_SAFE_INTEGER}),eq.publish("postPutResources")},tm=function(){eq.publish("putAdditionalObjects");for(var e=0;e<es.length;e++){var t=es[e];eK(t.objId,!0),ec(t.content),ec("endobj")}eq.publish("postPutAdditionalObjects")},tg=function(e){eL[e.fontName]=eL[e.fontName]||{},eL[e.fontName][e.fontStyle]=e.id},ty=function(e,t,r,i,a){var s={id:"F"+(Object.keys(eI).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:r,encoding:i,isStandardFont:a||!1,metadata:{}};return eq.publish("addFont",{font:s,instance:this}),eI[s.id]=s,tg(s),s.id},tv=function(e,t){var r,i,a,s,n,o,l,u,h;if(a=(t=t||{}).sourceEncoding||"Unicode",n=t.outputEncoding,(t.autoencode||n)&&eI[eA].metadata&&eI[eA].metadata[a]&&eI[eA].metadata[a].encoding&&(s=eI[eA].metadata[a].encoding,!n&&eI[eA].encoding&&(n=eI[eA].encoding),!n&&s.codePages&&(n=s.codePages[0]),"string"==typeof n&&(n=s[n]),n)){for(l=!1,o=[],r=0,i=e.length;r<i;r++)(u=n[e.charCodeAt(r)])?o.push(String.fromCharCode(u)):o.push(e[r]),o[r].charCodeAt(0)>>8&&(l=!0);e=o.join("")}for(r=e.length;void 0===l&&0!==r;)e.charCodeAt(r-1)>>8&&(l=!0),r--;if(!l)return e;for(o=t.noBOM?[]:[254,255],r=0,i=e.length;r<i;r++){if((h=(u=e.charCodeAt(r))>>8)>>8)throw Error("Character at position "+r+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(h),o.push(u-(h<<8))}return String.fromCharCode.apply(void 0,o)},t_=x.__private__.pdfEscape=x.pdfEscape=function(e,t){return tv(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},tx=x.__private__.beginPage=function(e){en[++eG]=[],ez[eG]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},tw(eG),eh(en[J])},tb=function(e,t){var r,a,n;switch(i=t||i,"string"==typeof e&&Array.isArray(r=E(e.toLowerCase()))&&(a=r[0],n=r[1]),Array.isArray(e)&&(a=e[0]*eT,n=e[1]*eT),isNaN(a)&&(a=s[0],n=s[1]),(a>14400||n>14400)&&(h.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),a=Math.min(14400,a),n=Math.min(14400,n)),s=[a,n],i.substr(0,1)){case"l":n>a&&(s=[n,a]);break;case"p":a>n&&(s=[n,a])}tx(s),t2(t0),ec(re),0!==rn&&ec(rn+" J"),0!==ro&&ec(ro+" j"),eq.publish("addPage",{pageNumber:eG})},tS=function(e){e>0&&e<=eG&&(en.splice(e,1),ez.splice(e,1),eG--,J>eG&&(J=eG),this.setPage(J))},tw=function(e){e>0&&e<=eG&&(J=e)},tE=x.__private__.getNumberOfPages=x.getNumberOfPages=function(){return en.length-1},tA=function(e,t,r){var i,a=void 0;return r=r||{},e=void 0!==e?e:eI[eA].fontName,t=void 0!==t?t:eI[eA].fontStyle,void 0!==eL[i=e.toLowerCase()]&&void 0!==eL[i][t]?a=eL[i][t]:void 0!==eL[e]&&void 0!==eL[e][t]?a=eL[e][t]:!1===r.disableWarning&&h.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||r.noFallback||null==(a=eL.times[t])&&(a=eL.times.normal),a},tT=x.__private__.putInfo=function(){var e=e$(),t=function(e){return e};for(var r in null!==f&&(t=tN.encryptor(e,0)),ec("<<"),ec("/Producer ("+t_(t("jsPDF "+z.version))+")"),eE)eE.hasOwnProperty(r)&&eE[r]&&ec("/"+r.substr(0,1).toUpperCase()+r.substr(1)+" ("+t_(t(eE[r]))+")");ec("/CreationDate ("+t_(t(H))+")"),ec(">>"),ec("endobj")},tC=x.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||eQ;switch(e$(),ec("<<"),ec("/Type /Catalog"),ec("/Pages "+t+" 0 R"),eg||(eg="fullwidth"),eg){case"fullwidth":ec("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ec("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ec("/OpenAction [3 0 R /Fit]");break;case"original":ec("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+eg;"%"===r.substr(r.length-1)&&(eg=parseInt(eg)/100),"number"==typeof eg&&ec("/OpenAction [3 0 R /XYZ null null "+q(eg)+"]")}switch(eb||(eb="continuous"),eb){case"continuous":ec("/PageLayout /OneColumn");break;case"single":ec("/PageLayout /SinglePage");break;case"two":case"twoleft":ec("/PageLayout /TwoColumnLeft");break;case"tworight":ec("/PageLayout /TwoColumnRight")}e_&&ec("/PageMode /"+e_),eq.publish("putCatalog"),ec(">>"),ec("endobj")},tP=x.__private__.putTrailer=function(){ec("trailer"),ec("<<"),ec("/Size "+(et+1)),ec("/Root "+et+" 0 R"),ec("/Info "+(et-1)+" 0 R"),null!==f&&ec("/Encrypt "+tN.oid+" 0 R"),ec("/ID [ <"+Z+"> <"+Z+"> ]"),ec(">>")},tR=x.__private__.putHeader=function(){ec("%PDF-"+b),ec("%ºß¬à")},tI=x.__private__.putXRef=function(){var e="0000000000";ec("xref"),ec("0 "+(et+1)),ec("0000000000 65535 f ");for(var t=1;t<=et;t++)"function"==typeof er[t]?ec((e+er[t]()).slice(-10)+" 00000 n "):void 0!==er[t]?ec((e+er[t]).slice(-10)+" 00000 n "):ec("0000000000 00000 n ")},tL=x.__private__.buildDocument=function(){eu(),eh(ei),eq.publish("buildDocument"),tR(),e6(),tm(),tf(),null!==f&&tl(),tT(),tC();var e=ea;return tI(),tP(),ec("startxref"),ec(""+e),ec("%%EOF"),eh(en[J]),ei.join("\n")},tO=x.__private__.getBlob=function(e){return new Blob([ep(e)],{type:"application/pdf"})},tM=x.output=x.__private__.output=((tJ=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return tL();case"save":x.save(t.filename);break;case"arraybuffer":return ep(tL());case"blob":return tO(tL());case"bloburi":case"bloburl":if(void 0!==l.URL&&"function"==typeof l.URL.createObjectURL)return l.URL&&l.URL.createObjectURL(tO(tL()))||void 0;h.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var r="",i=tL();try{r=m(i)}catch(e){r=m(unescape(encodeURIComponent(i)))}return"data:application/pdf;filename="+t.filename+";base64,"+r;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(l)){var a="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(a=t.pdfObjectUrl,s="");var n='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a+'"'+s+'></script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");</script></body></html>",o=l.open();return null!==o&&o.document.write(n),o}throw Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(l)){var u='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=l.open();if(null!==c){c.document.write(u);var d=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(d.output("bloburl"))}}return c}throw Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(l))throw Error("The option dataurlnewwindow just works in a browser-environment.");var p='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',f=l.open();if(null!==f&&(f.document.write(p),f.document.title=t.filename),f||"undefined"==typeof safari)return f;break;case"datauri":case"dataurl":return l.document.location.href=this.output("datauristring",t);default:return null}}).foo=function(){try{return tJ.apply(this,arguments)}catch(r){var e=r.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var t="Error in function "+e.split("\n")[0].split("<")[0]+": "+r.message;if(!l.console)throw Error(t);l.console.error(t,r),l.alert&&alert(t)}},tJ.foo.bar=tJ,tJ.foo),tk=function(e){return!0===Array.isArray(ej)&&ej.indexOf(e)>-1};switch(a){case"pt":eT=1;break;case"mm":eT=72/25.4;break;case"cm":eT=72/2.54;break;case"in":eT=72;break;case"px":eT=1==tk("px_scaling")?.75:96/72;break;case"pc":case"em":eT=12;break;case"ex":eT=6;break;default:if("number"!=typeof a)throw Error("Invalid unit: "+a);eT=a}var tN=null;X(),Y();var tD=x.__private__.getPageInfo=x.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ez[e].objId,pageNumber:e,pageContext:ez[e]}},tF=x.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in ez)if(ez[t].objId===e)break;return tD(t)},tG=x.__private__.getCurrentPageInfo=x.getCurrentPageInfo=function(){return{objId:ez[J].objId,pageNumber:J,pageContext:ez[J]}};x.addPage=function(){return tb.apply(this,arguments),this},x.setPage=function(){return tw.apply(this,arguments),eh.call(this,en[J]),this},x.insertPage=function(e){return this.addPage(),this.movePage(J,e),this},x.movePage=function(e,t){var r,i;if(e>t){r=en[e],i=ez[e];for(var a=e;a>t;a--)en[a]=en[a-1],ez[a]=ez[a-1];en[t]=r,ez[t]=i,this.setPage(t)}else if(e<t){r=en[e],i=ez[e];for(var s=e;s<t;s++)en[s]=en[s+1],ez[s]=ez[s+1];en[t]=r,ez[t]=i,this.setPage(t)}return this},x.deletePage=function(){return tS.apply(this,arguments),this},x.__private__.text=x.text=function(t,r,i,a,s){var o,l,u,h,c,d,p,f,m,g=(a=a||{}).scope||this;if("number"==typeof t&&"number"==typeof r&&("string"==typeof i||Array.isArray(i))){var y=i;i=r,r=t,t=y}if(arguments[3]instanceof eZ==!1?(u=arguments[4],h=arguments[5],"object"===e(n)(p=arguments[3])&&null!==p||("string"==typeof u&&(h=u,u=null),"string"==typeof p&&(h=p,p=null),"number"==typeof p&&(u=p,p=null),a={flags:p,angle:u,align:h})):(L("The transform parameter of text() with a Matrix value"),m=s),isNaN(r)||isNaN(i)||null==t)throw Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return g;var v="",x=!1,b="number"==typeof a.lineHeightFactor?a.lineHeightFactor:tQ,S=g.internal.scaleFactor;function w(e){for(var t,r=e.concat(),i=[],a=r.length;a--;)"string"==typeof(t=r.shift())?i.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?i.push(t[0]):i.push([t[0],t[1],t[2]]);return i}function E(e,t){var r;if("string"==typeof e)r=t(e)[0];else if(Array.isArray(e)){for(var i,a,s=e.concat(),n=[],o=s.length;o--;)"string"==typeof(i=s.shift())?n.push(t(i)[0]):Array.isArray(i)&&"string"==typeof i[0]&&n.push([(a=t(i[0],i[1],i[2]))[0],a[1],a[2]]);r=n}return r}var C=!1,P=!0;if("string"==typeof t)C=!0;else if(Array.isArray(t)){var R=t.concat();l=[];for(var O,M=R.length;M--;)("string"!=typeof(O=R.shift())||Array.isArray(O)&&"string"!=typeof O[0])&&(P=!1);C=P}if(!1===C)throw Error('Type of text must be string or Array. "'+t+'" is not recognized.');"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var k=em/g.internal.scaleFactor,N=k*(b-1);switch(a.baseline){case"bottom":i-=N;break;case"top":i+=k-N;break;case"hanging":i+=k-2*N;break;case"middle":i+=k/2-N}if((d=a.maxWidth||0)>0&&("string"==typeof t?t=g.splitTextToSize(t,d):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce(function(e,t){return e.concat(g.splitTextToSize(t,d))},[]))),o={text:t,x:r,y:i,options:a,mutex:{pdfEscape:t_,activeFontKey:eA,fonts:eI,activeFontSize:em}},eq.publish("preProcessText",o),t=o.text,u=(a=o.options).angle,m instanceof eZ==!1&&u&&"number"==typeof u){u*=Math.PI/180,0===a.rotationDirection&&(u=-u),T===A.ADVANCED&&(u=-u);var D=Math.cos(u),F=Math.sin(u);m=new eZ(D,F,-F,D,0,0)}else u&&u instanceof eZ&&(m=u);T!==A.ADVANCED||m||(m=eY),void 0!==(c=a.charSpace||ra)&&(v+=I(B(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=a.horizontalScale)&&(v+=I(100*f)+" Tz\n"),a.lang;var G=-1,z=void 0!==a.renderingMode?a.renderingMode:a.stroke,q=g.internal.getCurrentPageInfo().pageContext;switch(z){case 0:case!1:case"fill":G=0;break;case 1:case!0:case"stroke":G=1;break;case 2:case"fillThenStroke":G=2;break;case 3:case"invisible":G=3;break;case 4:case"fillAndAddForClipping":G=4;break;case 5:case"strokeAndAddPathForClipping":G=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":G=6;break;case 7:case"addToPathForClipping":G=7}var j=void 0!==q.usedRenderingMode?q.usedRenderingMode:-1;-1!==G?v+=G+" Tr\n":-1!==j&&(v+="0 Tr\n"),-1!==G&&(q.usedRenderingMode=G),h=a.align||"left";var U,H=em*b,Z=g.internal.pageSize.getWidth(),V=eI[eA];c=a.charSpace||ra,d=a.maxWidth||0,p=Object.assign({autoencode:!0,noBOM:!0},a.flags);var Y=[];if("[object Array]"===Object.prototype.toString.call(t)){l=w(t),"left"!==h&&(U=l.map(function(e){return g.getStringUnitWidth(e,{font:V,charSpace:c,fontSize:em,doKerning:!1})*em/S}));var W,$,X=0;if("right"===h){r-=U[0],t=[],M=l.length;for(var K=0;K<M;K++)0===K?($=t6(r),W=t8(i)):($=B(X-U[K]),W=-H),t.push([l[K],$,W]),X=U[K]}else if("center"===h){r-=U[0]/2,t=[],M=l.length;for(var J=0;J<M;J++)0===J?($=t6(r),W=t8(i)):($=B((X-U[J])/2),W=-H),t.push([l[J],$,W]),X=U[J]}else if("left"===h){t=[],M=l.length;for(var Q=0;Q<M;Q++)t.push(l[Q])}else{if("justify"!==h)throw Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');t=[],M=l.length,d=0!==d?d:Z;for(var ee=0;ee<M;ee++)W=0===ee?t8(i):-H,$=0===ee?t6(r):0,ee<M-1?Y.push(I(B((d-U[ee])/(l[ee].split(" ").length-1)))):Y.push(0),t.push([l[ee],$,W])}}!0===("boolean"==typeof a.R2L?a.R2L:ev)&&(t=E(t,function(e,t,r){return[e.split("").reverse().join(""),t,r]})),o={text:t,x:r,y:i,options:a,mutex:{pdfEscape:t_,activeFontKey:eA,fonts:eI,activeFontSize:em}},eq.publish("postProcessText",o),t=o.text,x=o.mutex.isHex||!1;var et=eI[eA].encoding;"WinAnsiEncoding"!==et&&"StandardEncoding"!==et||(t=E(t,function(e,t,r){return[t_(e.split("	").join(Array(a.TabLen||9).join(" ")),p),t,r]})),l=w(t),t=[];for(var er,ei,ea,es=Array.isArray(l[0])?1:0,en="",eo=function(e,t,r){var i="";return r instanceof eZ?(r="number"==typeof a.angle?eV(r,new eZ(1,0,0,1,e,t)):eV(new eZ(1,0,0,1,e,t),r),T===A.ADVANCED&&(r=eV(new eZ(1,0,0,-1,0,0),r)),i=r.join(" ")+" Tm\n"):i=I(e)+" "+I(t)+" Td\n",i},el=0;el<l.length;el++){switch(en="",es){case 1:ea=(x?"<":"(")+l[el][0]+(x?">":")"),er=parseFloat(l[el][1]),ei=parseFloat(l[el][2]);break;case 0:ea=(x?"<":"(")+l[el]+(x?">":")"),er=t6(r),ei=t8(i)}void 0!==Y&&void 0!==Y[el]&&(en=Y[el]+" Tw\n"),0===el?t.push(en+eo(er,ei,m)+ea):0===es?t.push(en+ea):1===es&&t.push(en+eo(er,ei,m)+ea)}t=(0===es?t.join(" Tj\nT* "):t.join(" Tj\n"))+" Tj\n";var eu="BT\n/";return ec(eu+=eA+" "+em+" Tf\n"+I(em*b)+" TL\n"+rr+"\n"+v+t+"ET"),_[eA]=!0,g};var tz=x.__private__.clip=x.clip=function(e){return ec("evenodd"===e?"W*":"W"),this};x.clipEvenOdd=function(){return tz("evenodd")},x.__private__.discardPath=x.discardPath=function(){return ec("n"),this};var tq=x.__private__.isValidStyle=function(e){var t=!1;return -1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};x.__private__.setDefaultPathOperation=x.setDefaultPathOperation=function(e){return tq(e)&&(p=e),this};var tj=x.__private__.getStyle=x.getStyle=function(e){var t=p;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},tB=x.close=function(){return ec("h"),this};x.stroke=function(){return ec("S"),this},x.fill=function(e){return tU("f",e),this},x.fillEvenOdd=function(e){return tU("f*",e),this},x.fillStroke=function(e){return tU("B",e),this},x.fillStrokeEvenOdd=function(e){return tU("B*",e),this};var tU=function(t,r){"object"===e(n)(r)?tV(r,t):ec(t)},tH=function(e){null===e||T===A.ADVANCED&&void 0===e||ec(e=tj(e))};function tZ(e,t,r,i,a){var s=new G(t||this.boundingBox,r||this.xStep,i||this.yStep,this.gState,a||this.matrix);return s.stream=this.stream,eW(e+"$$"+this.cloneIndex+++"$$",s),s}var tV=function(e,t){var r=ek[e.key],i=eM[r];if(i instanceof F)ec("q"),ec(tY(t)),i.gState&&x.setGState(i.gState),ec(e.matrix.toString()+" cm"),ec("/"+r+" sh"),ec("Q");else if(i instanceof G){var a=new eZ(1,0,0,-1,0,ry());e.matrix&&(a=a.multiply(e.matrix||eY),r=tZ.call(i,e.key,e.boundingBox,e.xStep,e.yStep,a).id),ec("q"),ec("/Pattern cs"),ec("/"+r+" scn"),i.gState&&x.setGState(i.gState),ec(t),ec("Q")}},tY=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},tW=x.moveTo=function(e,t){return ec(I(B(e))+" "+I(U(t))+" m"),this},t$=x.lineTo=function(e,t){return ec(I(B(e))+" "+I(U(t))+" l"),this},tX=x.curveTo=function(e,t,r,i,a,s){return ec([I(B(e)),I(U(t)),I(B(r)),I(U(i)),I(B(a)),I(U(s)),"c"].join(" ")),this};x.__private__.line=x.line=function(e,t,r,i,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||!tq(a))throw Error("Invalid arguments passed to jsPDF.line");return T===A.COMPAT?this.lines([[r-e,i-t]],e,t,[1,1],a||"S"):this.lines([[r-e,i-t]],e,t,[1,1]).stroke()},x.__private__.lines=x.lines=function(e,t,r,i,a,s){var n,o,l,u,h,c,d,p,f,m,g;if("number"==typeof e&&(g=r,r=t,t=e,e=g),i=i||[1,1],s=s||!1,isNaN(t)||isNaN(r)||!Array.isArray(e)||!Array.isArray(i)||!tq(a)||"boolean"!=typeof s)throw Error("Invalid arguments passed to jsPDF.lines");for(tW(t,r),n=i[0],o=i[1],u=e.length,f=t,m=r,l=0;l<u;l++)2===(h=e[l]).length?t$(f=h[0]*n+f,m=h[1]*o+m):(c=h[0]*n+f,d=h[1]*o+m,p=h[2]*n+f,tX(c,d,p,h[3]*o+m,f=h[4]*n+f,m=h[5]*o+m));return s&&tB(),tH(a),this},x.path=function(e){for(var t=0;t<e.length;t++){var r=e[t],i=r.c;switch(r.op){case"m":tW(i[0],i[1]);break;case"l":t$(i[0],i[1]);break;case"c":tX.apply(this,i);break;case"h":tB()}}return this},x.__private__.rect=x.rect=function(e,t,r,i,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||!tq(a))throw Error("Invalid arguments passed to jsPDF.rect");return T===A.COMPAT&&(i=-i),ec([I(B(e)),I(U(t)),I(B(r)),I(B(i)),"re"].join(" ")),tH(a),this},x.__private__.triangle=x.triangle=function(e,t,r,i,a,s,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s)||!tq(n))throw Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-e,i-t],[a-r,s-i],[e-a,t-s]],e,t,[1,1],n,!0),this},x.__private__.roundedRect=x.roundedRect=function(e,t,r,i,a,s,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s)||!tq(n))throw Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return a=Math.min(a,.5*r),s=Math.min(s,.5*i),this.lines([[r-2*a,0],[a*o,0,a,s-s*o,a,s],[0,i-2*s],[0,s*o,-a*o,s,-a,s],[2*a-r,0],[-a*o,0,-a,-s*o,-a,-s],[0,2*s-i],[0,-s*o,a*o,-s,a,-s]],e+a,t,[1,1],n,!0),this},x.__private__.ellipse=x.ellipse=function(e,t,r,i,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||!tq(a))throw Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*r,n=4/3*(Math.SQRT2-1)*i;return tW(e+r,t),tX(e+r,t-n,e+s,t-i,e,t-i),tX(e-s,t-i,e-r,t-n,e-r,t),tX(e-r,t+n,e-s,t+i,e,t+i),tX(e+s,t+i,e+r,t+n,e+r,t),tH(a),this},x.__private__.circle=x.circle=function(e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r)||!tq(i))throw Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,r,r,i)},x.setFont=function(e,t,r){return r&&(t=R(t,r)),eA=tA(e,t,{disableWarning:!1}),this};var tK=x.__private__.getFont=x.getFont=function(){return eI[tA.apply(x,arguments)]};x.__private__.getFontList=x.getFontList=function(){var e,t,r={};for(e in eL)if(eL.hasOwnProperty(e))for(t in r[e]=[],eL[e])eL[e].hasOwnProperty(t)&&r[e].push(t);return r},x.addFont=function(e,t,r,i,a){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?a=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(r=R(r,i)),a=a||"Identity-H",ty.call(this,e,t,r,a)};var tJ,tQ,t0=t.lineWidth||.200025,t1=x.__private__.getLineWidth=x.getLineWidth=function(){return t0},t2=x.__private__.setLineWidth=x.setLineWidth=function(e){return t0=e,ec(I(B(e))+" w"),this};x.__private__.setLineDash=z.API.setLineDash=z.API.setLineDashPattern=function(e,t){if(e=e||[],isNaN(t=t||0)||!Array.isArray(e))throw Error("Invalid arguments passed to jsPDF.setLineDash");return ec("["+(e=e.map(function(e){return I(B(e))}).join(" "))+"] "+(t=I(B(t)))+" d"),this};var t5=x.__private__.getLineHeight=x.getLineHeight=function(){return em*tQ};x.__private__.getLineHeight=x.getLineHeight=function(){return em*tQ};var t3=x.__private__.setLineHeightFactor=x.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(tQ=e),this},t4=x.__private__.getLineHeightFactor=x.getLineHeightFactor=function(){return tQ};t3(t.lineHeight);var t6=x.__private__.getHorizontalCoordinate=function(e){return B(e)},t8=x.__private__.getVerticalCoordinate=function(e){return T===A.ADVANCED?e:ez[J].mediaBox.topRightY-ez[J].mediaBox.bottomLeftY-B(e)},t7=x.__private__.getHorizontalCoordinateString=x.getHorizontalCoordinateString=function(e){return I(t6(e))},t9=x.__private__.getVerticalCoordinateString=x.getVerticalCoordinateString=function(e){return I(t8(e))},re=t.strokeColor||"0 G";x.__private__.getStrokeColor=x.getDrawColor=function(){return e1(re)},x.__private__.setStrokeColor=x.setDrawColor=function(e,t,r,i){return ec(re=e2({ch1:e,ch2:t,ch3:r,ch4:i,pdfColorType:"draw",precision:2})),this};var rt=t.fillColor||"0 g";x.__private__.getFillColor=x.getFillColor=function(){return e1(rt)},x.__private__.setFillColor=x.setFillColor=function(e,t,r,i){return ec(rt=e2({ch1:e,ch2:t,ch3:r,ch4:i,pdfColorType:"fill",precision:2})),this};var rr=t.textColor||"0 g",ri=x.__private__.getTextColor=x.getTextColor=function(){return e1(rr)};x.__private__.setTextColor=x.setTextColor=function(e,t,r,i){return rr=e2({ch1:e,ch2:t,ch3:r,ch4:i,pdfColorType:"text",precision:3}),this};var ra=t.charSpace,rs=x.__private__.getCharSpace=x.getCharSpace=function(){return parseFloat(ra||0)};x.__private__.setCharSpace=x.setCharSpace=function(e){if(isNaN(e))throw Error("Invalid argument passed to jsPDF.setCharSpace");return ra=e,this};var rn=0;x.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},x.__private__.setLineCap=x.setLineCap=function(e){var t=x.CapJoinStyles[e];if(void 0===t)throw Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return rn=t,ec(t+" J"),this};var ro=0;x.__private__.setLineJoin=x.setLineJoin=function(e){var t=x.CapJoinStyles[e];if(void 0===t)throw Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ro=t,ec(t+" j"),this},x.__private__.setLineMiterLimit=x.__private__.setMiterLimit=x.setLineMiterLimit=x.setMiterLimit=function(e){if(isNaN(e=e||0))throw Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ec(I(B(e))+" M"),this},x.GState=N,x.setGState=function(e){(e="string"==typeof e?eN[eD[e]]:rl(null,e)).equals(eF)||(ec("/"+e.id+" gs"),eF=e)};var rl=function(e,t){if(!e||!eD[e]){var r=!1;for(var i in eN)if(eN.hasOwnProperty(i)&&eN[i].equals(t)){r=!0;break}if(r)t=eN[i];else{var a="GS"+(Object.keys(eN).length+1).toString(10);eN[a]=t,t.id=a}return e&&(eD[e]=t.id),eq.publish("addGState",t),t}};x.addGState=function(e,t){return rl(e,t),this},x.saveGraphicsState=function(){return ec("q"),eO.push({key:eA,size:em,color:rr}),this},x.restoreGraphicsState=function(){ec("Q");var e=eO.pop();return eA=e.key,em=e.size,rr=e.color,eF=null,this},x.setCurrentTransformationMatrix=function(e){return ec(e.toString()+" cm"),this},x.comment=function(e){return ec("#"+e),this};var ru=function(e,t){var r=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var i=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},rh=function(e,t,r,i){ru.call(this,e,t),this.type="rect";var a=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var s=i||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},rc=function(){this.page=eG,this.currentPage=J,this.pages=en.slice(0),this.pagesContext=ez.slice(0),this.x=eC,this.y=eP,this.matrix=eR,this.width=rm(J),this.height=ry(J),this.outputDestination=el,this.id="",this.objectNumber=-1};rc.prototype.restore=function(){eG=this.page,J=this.currentPage,ez=this.pagesContext,en=this.pages,eC=this.x,eP=this.y,eR=this.matrix,rg(J,this.width),rv(J,this.height),el=this.outputDestination};var rd=function(e,t,r,i,a){eH.push(new rc),eG=J=0,en=[],eC=e,eP=t,eR=a,tx([r,i])},rp=function(e){if(eU[e])eH.pop().restore();else{var t=new rc,r="Xo"+(Object.keys(eB).length+1).toString(10);t.id=r,eU[e]=r,eB[r]=t,eq.publish("addFormObject",t),eH.pop().restore()}};for(var rf in x.beginFormObject=function(e,t,r,i,a){return rd(e,t,r,i,a),this},x.endFormObject=function(e){return rp(e),this},x.doFormObject=function(e,t){var r=eB[eU[e]];return ec("q"),ec(t.toString()+" cm"),ec("/"+r.id+" Do"),ec("Q"),this},x.getFormObject=function(e){var t=eB[eU[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},x.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(g(tO(tL()),e),"function"==typeof g.unload&&l.setTimeout&&setTimeout(g.unload,911),this):new Promise(function(t,r){try{var i=g(tO(tL()),e);"function"==typeof g.unload&&l.setTimeout&&setTimeout(g.unload,911),t(i)}catch(e){r(e.message)}})},z.API)z.API.hasOwnProperty(rf)&&("events"===rf&&z.API.events.length?function(e,t){var r,i,a;for(a=t.length-1;-1!==a;a--)r=t[a][0],i=t[a][1],e.subscribe.apply(e,[r].concat("function"==typeof i?[i]:i))}(eq,z.API.events):x[rf]=z.API[rf]);var rm=x.getPageWidth=function(e){return(ez[e=e||J].mediaBox.topRightX-ez[e].mediaBox.bottomLeftX)/eT},rg=x.setPageWidth=function(e,t){ez[e].mediaBox.topRightX=t*eT+ez[e].mediaBox.bottomLeftX},ry=x.getPageHeight=function(e){return(ez[e=e||J].mediaBox.topRightY-ez[e].mediaBox.bottomLeftY)/eT},rv=x.setPageHeight=function(e,t){ez[e].mediaBox.topRightY=t*eT+ez[e].mediaBox.bottomLeftY};return x.internal={pdfEscape:t_,getStyle:tj,getFont:tK,getFontSize:ey,getCharSpace:rs,getTextColor:ri,getLineHeight:t5,getLineHeightFactor:t4,getLineWidth:t1,write:ed,getHorizontalCoordinate:t6,getVerticalCoordinate:t8,getCoordinateString:t7,getVerticalCoordinateString:t9,collections:{},newObject:e$,newAdditionalObject:eJ,newObjectDeferred:eX,newObjectDeferredBegin:eK,getFilters:e5,putStream:e3,events:eq,scaleFactor:eT,pageSize:{getWidth:function(){return rm(J)},setWidth:function(e){rg(J,e)},getHeight:function(){return ry(J)},setHeight:function(e){rv(J,e)}},encryptionOptions:f,encryption:tN,getEncryptor:function(e){return null!==f?tN.encryptor(e,0):function(e){return e}},output:tM,getNumberOfPages:tE,pages:en,out:ec,f2:q,f3:j,getPageInfo:tD,getPageInfoByObjId:tF,getCurrentPageInfo:tG,getPDFVersion:S,Point:ru,Rectangle:rh,Matrix:eZ,hasHotfix:tk},Object.defineProperty(x.internal.pageSize,"width",{get:function(){return rm(J)},set:function(e){rg(J,e)},enumerable:!0,configurable:!0}),Object.defineProperty(x.internal.pageSize,"height",{get:function(){return ry(J)},set:function(e){rv(J,e)},enumerable:!0,configurable:!0}),(function(e){for(var t=0,r=ef.length;t<r;t++){var i=ty.call(this,e[t][0],e[t][1],e[t][2],ef[t][3],!0);!1===v&&(_[i]=!0);var a=e[t][0].split("-");tg({id:i,fontName:a[0],fontStyle:a[1]||""})}eq.publish("addFonts",{fonts:eI,dictionary:eL})}).call(x,ef),eA="F1",tb(s,i),eq.publish("initialized"),x}O.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},O.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},O.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},O.prototype.processOwnerPassword=function(e,t){return I(C(t).substr(0,5),e)},O.prototype.encryptor=function(e,t){var r=C(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return I(r,e)}},N.prototype.equals=function(t){var r,i="id,objectNumber,equals";if(!t||e(n)(t)!==e(n)(this))return!1;var a=0;for(r in this)if(!(i.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!t.hasOwnProperty(r)||this[r]!==t[r])return!1;a++}for(r in t)t.hasOwnProperty(r)&&0>i.indexOf(r)&&a--;return 0===a},z.API={events:[]},z.version="2.5.1";var q=z.API,j=1,B=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},U=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},H=function(e){return e.toFixed(2)},Z=function(e){return e.toFixed(5)};q.__acroform__={};var V=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Y=function(e){return e*j},W=function(e){var t=new ed,r=eT.internal.getHeight(e)||0,i=eT.internal.getWidth(e)||0;return t.BBox=[0,0,Number(H(i)),Number(H(r))],t},$=q.__acroform__.setBit=function(e,t){if(t=t||0,isNaN(e=e||0)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},X=q.__acroform__.clearBit=function(e,t){if(t=t||0,isNaN(e=e||0)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},K=q.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(e&1<<t)?0:1},J=q.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return K(e,t-1)},Q=q.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return $(e,t-1)},ee=q.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return X(e,t-1)},et=q.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,a=e[0],s=e[1],n=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=i(s+o)||0,l.upperRight_X=r(a+n)||0,l.upperRight_Y=i(s)||0,[Number(H(l.lowerLeft_X)),Number(H(l.lowerLeft_Y)),Number(H(l.upperRight_X)),Number(H(l.upperRight_Y))]},er=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,i=ei(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+H(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=W(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},ei=function(e,t){var r=0===e.fontSize?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},a=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(e){return e.split("\n")}):a.map(function(e){return[e]});var s=r,n=eT.internal.getHeight(e)||0;n=n<0?-n:n;var o=eT.internal.getWidth(e)||0;o=o<0?-o:o,s++;i:for(;s>0;){t="";var l,u,h=ea("3",e,--s).height,c=e.multiline?n-s:(n-h)/2,d=c+=2,p=0,f=0,m=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+ea(t,e,s=12).width+", FieldWidth:"+o+"\n";break}for(var g="",y=0,v=0;v<a.length;v++)if(a.hasOwnProperty(v)){var _=!1;if(1!==a[v].length&&m!==a[v].length-1){if((h+2)*(y+2)+2>n)continue i;g+=a[v][m],_=!0,f=v,v--}else{g=" "==(g+=a[v][m]+" ").substr(g.length-1)?g.substr(0,g.length-1):g;var x,b,S=parseInt(v),w=(x=g,b=s,S+1<a.length&&ea(x+" "+a[S+1][0],e,b).width<=o-4),E=v>=a.length-1;if(w&&!E){g+=" ",m=0;continue}if(w||E){if(E)f=S;else if(e.multiline&&(h+2)*(y+2)+2>n)continue i}else{if(!e.multiline||(h+2)*(y+2)+2>n)continue i;f=S}}for(var A="",T=p;T<=f;T++){var C=a[T];if(e.multiline){if(T===f){A+=C[m]+" ",m=(m+1)%C.length;continue}if(T===p){A+=C[C.length-1]+" ";continue}}A+=C[0]+" "}switch(u=ea(A=" "==A.substr(A.length-1)?A.substr(0,A.length-1):A,e,s).width,e.textAlign){case"right":l=o-u-2;break;case"center":l=(o-u)/2;break;default:l=2}t+=H(l)+" "+H(d)+" Td\n("+B(A)+") Tj\n"+-H(l)+" 0 Td\n",d=-(s+2),u=0,p=_?f:f+1,y++,g=""}break}return i.text=t,i.fontSize=s,i},ea=function(e,t,r){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},es={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},en=function(e,t){var r={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===r.type&&e.object===r.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},eo=function(t,r){for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];r.internal.newObjectDeferredBegin(a.objId,!0),"object"===e(n)(a)&&"function"==typeof a.putStream&&a.putStream(),delete t[i]}},el=function(t,r){if(r.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(ef.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(es)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw Error("Exception while creating AcroformDictionary");j=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new ep,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),t.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];i.objId=void 0,i.hasAnnotation&&en(i,e)}}(t)}),t.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)}),t.internal.events.subscribe("postPutPages",function(r){!function(t,r){var i=!t;for(var a in t||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),t=t||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(t.hasOwnProperty(a)){var s=t[a],o=[],l=s.Rect;if(s.Rect&&(s.Rect=et(s.Rect,r)),r.internal.newObjectDeferredBegin(s.objId,!0),s.DA=eT.createDefaultAppearanceStream(s),"object"===e(n)(s)&&"function"==typeof s.getKeyValueListForStream&&(o=s.getKeyValueListForStream()),s.Rect=l,s.hasAppearanceStream&&!s.appearanceStreamContent){var u=er(s);o.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(s.appearanceStreamContent){var h="";for(var c in s.appearanceStreamContent)if(s.appearanceStreamContent.hasOwnProperty(c)){var d=s.appearanceStreamContent[c];if(h+="/"+c+" <<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var p=d[a];"function"==typeof p&&(p=p.call(r,s)),h+="/"+a+" "+p+" ",r.internal.acroformPlugin.xForms.indexOf(p)>=0||r.internal.acroformPlugin.xForms.push(p)}}else"function"==typeof(p=d)&&(p=p.call(r,s)),h+="/"+a+" "+p,r.internal.acroformPlugin.xForms.indexOf(p)>=0||r.internal.acroformPlugin.xForms.push(p);h+=">>"}o.push({key:"AP",value:"<<\n"+h+">>"})}r.internal.putStream({additionalKeyValues:o,objectId:s.objId}),r.internal.out("endobj")}i&&eo(r.internal.acroformPlugin.xForms,r)}(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},eu=q.__acroform__.arrayToPdfArray=function(t,r,i){var a=function(e){return e};if(Array.isArray(t)){for(var s="[",o=0;o<t.length;o++)switch(0!==o&&(s+=" "),e(n)(t[o])){case"boolean":case"number":case"object":s+=t[o].toString();break;case"string":"/"!==t[o].substr(0,1)?(void 0!==r&&i&&(a=i.internal.getEncryptor(r)),s+="("+B(a(t[o].toString()))+")"):s+=t[o].toString()}return s+"]"}throw Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},eh=function(e,t,r){var i=function(e){return e};return void 0!==t&&r&&(i=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+B(i(e))+")"},ec=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ec.prototype.toString=function(){return this.objId+" 0 R"},ec.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ec.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var r in t)if(!1===Object.getOwnPropertyDescriptor(this,t[r]).configurable){var i=t[r],a=this[i];a&&(Array.isArray(a)?e.push({key:i,value:eu(a,this.objId,this.scope)}):a instanceof ec?(a.scope=this.scope,e.push({key:i,value:a.objId+" 0 R"})):"function"!=typeof a&&e.push({key:i,value:a}))}return e};var ed=function(){ec.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};V(ed,ec);var ep=function(){ec.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+B(t(e))+")"}},set:function(t){e=t}})};V(ep,ec);var ef=function e(){ec.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!J(t,3)},set:function(e){!0==!!e?this.F=Q(t,3):this.F=ee(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){if(isNaN(e))throw Error('Invalid value "'+e+'" for attribute Ff supplied.');r=e}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==i.length)return i},set:function(e){i=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(e){i[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(e){i[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(e){i[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(e){i[3]=e}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof eS)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+B(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var n="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){n=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===u?50/j:u},set:function(e){u=e}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(e){h=e}});var c="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!c||this instanceof eS||this instanceof eE))return eh(c,this.objId,this.scope)},set:function(e){c=e=e.toString()}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof e_==!1?eh(d,this.objId,this.scope):d},set:function(e){e=e.toString(),d=this instanceof e_==!1?"("===e.substr(0,1)?U(e.substr(1,e.length-2)):U(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof e_==!0?U(d.substr(1,d.length-1)):d},set:function(e){e=e.toString(),d=this instanceof e_==!0?"/"+e:e}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof e_==!1?eh(p,this.objId,this.scope):p},set:function(e){e=e.toString(),p=this instanceof e_==!1?"("===e.substr(0,1)?U(e.substr(1,e.length-2)):U(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof e_==!0?U(p.substr(1,p.length-1)):p},set:function(e){e=e.toString(),p=this instanceof e_==!0?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var f,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(e){m=e=!!e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(f)return f},set:function(e){f=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,1)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,1):this.Ff=ee(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,2)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,2):this.Ff=ee(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,3)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,3):this.Ff=ee(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(e){if(-1===[0,1,2].indexOf(e))throw Error('Invalid value "'+e+'" for attribute Q supplied.');g=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(g){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};V(ef,ec);var em=function(){ef.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return eu(t,this.objId,this.scope)},set:function(e){var r;r=[],"string"==typeof e&&(r=function(e,t,r){r||(r=1);for(var i,a=[];i=t.exec(e);)a.push(i[r]);return a}(e,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,18)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,18):this.Ff=ee(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,19)},set:function(e){!0===this.combo&&(!0==!!e?this.Ff=Q(this.Ff,19):this.Ff=ee(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,20)},set:function(e){!0==!!e?(this.Ff=Q(this.Ff,20),t.sort()):this.Ff=ee(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,22)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,22):this.Ff=ee(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,23)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,23):this.Ff=ee(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,27)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,27):this.Ff=ee(this.Ff,27)}}),this.hasAppearanceStream=!1};V(em,ef);var eg=function(){em.call(this),this.fontName="helvetica",this.combo=!1};V(eg,em);var ey=function(){eg.call(this),this.combo=!0};V(ey,eg);var ev=function(){ey.call(this),this.edit=!0};V(ev,ey);var e_=function(){ef.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,15)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,15):this.Ff=ee(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,16)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,16):this.Ff=ee(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,17)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,17):this.Ff=ee(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,26)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,26):this.Ff=ee(this.Ff,26)}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(r).length){var t,i=[];for(t in i.push("<<"),r)i.push("/"+t+" ("+B(e(r[t]))+")");return i.push(">>"),i.join("\n")}},set:function(t){"object"===e(n)(t)&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};V(e_,ef);var ex=function(){e_.call(this),this.pushButton=!0};V(ex,e_);var eb=function(){e_.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};V(eb,e_);var eS=function(){ef.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(e){r=e}});var t,r,i,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,r=[];for(t in r.push("<<"),a)r.push("/"+t+" ("+B(e(a[t]))+")");return r.push(">>"),r.join("\n")},set:function(t){"object"===e(n)(t)&&(a=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(e){"string"==typeof e&&(a.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(e){i="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=eT.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};V(eS,ef),eb.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},eb.prototype.createOption=function(e){var t=new eS;return t.Parent=this,t.optionName=e,this.Kids.push(t),eC.call(this.scope,t),t};var ew=function(){e_.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=eT.CheckBox.createAppearanceStream()};V(ew,e_);var eE=function(){ef.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,13)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,13):this.Ff=ee(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,21)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,21):this.Ff=ee(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,23)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,23):this.Ff=ee(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,24)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,24):this.Ff=ee(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,25)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,25):this.Ff=ee(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,26)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,26):this.Ff=ee(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};V(eE,ef);var eA=function(){eE.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!J(this.Ff,14)},set:function(e){!0==!!e?this.Ff=Q(this.Ff,14):this.Ff=ee(this.Ff,14)}}),this.password=!0};V(eA,eE);var eT={CheckBox:{createAppearanceStream:function(){return{N:{On:eT.CheckBox.YesNormal},D:{On:eT.CheckBox.YesPushDown,Off:eT.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=W(e);t.scope=e.scope;var r=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=ei(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+H(eT.internal.getWidth(e))+" "+H(eT.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+i+" "+H(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join("\n"),t},YesNormal:function(e){var t=W(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),a=[],s=eT.internal.getHeight(e),n=eT.internal.getWidth(e),o=ei(e,e.caption);return a.push("1 g"),a.push("0 0 "+H(n)+" "+H(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+H(n-1)+" "+H(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+H(o.fontSize)+" Tf "+i),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=W(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+H(eT.internal.getWidth(e))+" "+H(eT.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:eT.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=eT.RadioButton.Circle.YesNormal,t.D[e]=eT.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=W(e);t.scope=e.scope;var r=[],i=eT.internal.getWidth(e)<=eT.internal.getHeight(e)?eT.internal.getWidth(e)/4:eT.internal.getHeight(e)/4,a=Number(((i=Number((.9*i).toFixed(5)))*eT.internal.Bezier_C).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Z(eT.internal.getWidth(e)/2)+" "+Z(eT.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=W(e);t.scope=e.scope;var r=[],i=eT.internal.getWidth(e)<=eT.internal.getHeight(e)?eT.internal.getWidth(e)/4:eT.internal.getHeight(e)/4,a=Number((2*(i=Number((.9*i).toFixed(5)))).toFixed(5)),s=Number((a*eT.internal.Bezier_C).toFixed(5)),n=Number((i*eT.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Z(eT.internal.getWidth(e)/2)+" "+Z(eT.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Z(eT.internal.getWidth(e)/2)+" "+Z(eT.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+n+" "+n+" "+i+" 0 "+i+" c"),r.push("-"+n+" "+i+" -"+i+" "+n+" -"+i+" 0 c"),r.push("-"+i+" -"+n+" -"+n+" -"+i+" 0 -"+i+" c"),r.push(n+" -"+i+" "+i+" -"+n+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=W(e);t.scope=e.scope;var r=[],i=eT.internal.getWidth(e)<=eT.internal.getHeight(e)?eT.internal.getWidth(e)/4:eT.internal.getHeight(e)/4,a=Number((2*(i=Number((.9*i).toFixed(5)))).toFixed(5)),s=Number((a*eT.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Z(eT.internal.getWidth(e)/2)+" "+Z(eT.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:eT.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=eT.RadioButton.Cross.YesNormal,t.D[e]=eT.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=W(e);t.scope=e.scope;var r=[],i=eT.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+H(eT.internal.getWidth(e)-2)+" "+H(eT.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(H(i.x1.x)+" "+H(i.x1.y)+" m"),r.push(H(i.x2.x)+" "+H(i.x2.y)+" l"),r.push(H(i.x4.x)+" "+H(i.x4.y)+" m"),r.push(H(i.x3.x)+" "+H(i.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=W(e);t.scope=e.scope;var r=eT.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+H(eT.internal.getWidth(e))+" "+H(eT.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+H(eT.internal.getWidth(e)-2)+" "+H(eT.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(H(r.x1.x)+" "+H(r.x1.y)+" m"),i.push(H(r.x2.x)+" "+H(r.x2.y)+" l"),i.push(H(r.x4.x)+" "+H(r.x4.y)+" m"),i.push(H(r.x3.x)+" "+H(r.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join("\n"),t},OffPushDown:function(e){var t=W(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+H(eT.internal.getWidth(e))+" "+H(eT.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};eT.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=eT.internal.getWidth(e),r=eT.internal.getHeight(e),i=Math.min(t,r);return{x1:{x:(t-i)/2,y:(r-i)/2+i},x2:{x:(t-i)/2+i,y:(r-i)/2},x3:{x:(t-i)/2,y:(r-i)/2},x4:{x:(t-i)/2+i,y:(r-i)/2+i}}}},eT.internal.getWidth=function(t){var r=0;return"object"===e(n)(t)&&(r=Y(t.Rect[2])),r},eT.internal.getHeight=function(t){var r=0;return"object"===e(n)(t)&&(r=Y(t.Rect[3])),r};var eC=q.addField=function(e){if(el(this,e),!(e instanceof ef))throw Error("Invalid argument passed to jsPDF.addField.");return e.scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};function eP(e){return e.reduce(function(e,t,r){return e[t]=r,e},{})}q.AcroFormChoiceField=em,q.AcroFormListBox=eg,q.AcroFormComboBox=ey,q.AcroFormEditBox=ev,q.AcroFormButton=e_,q.AcroFormPushButton=ex,q.AcroFormRadioButton=eb,q.AcroFormCheckBox=ew,q.AcroFormTextField=eE,q.AcroFormPasswordField=eA,q.AcroFormAppearance=eT,q.AcroForm={ChoiceField:em,ListBox:eg,ComboBox:ey,EditBox:ev,Button:e_,PushButton:ex,RadioButton:eb,CheckBox:ew,TextField:eE,PasswordField:eA,Appearance:eT},z.AcroForm={ChoiceField:em,ListBox:eg,ComboBox:ey,EditBox:ev,Button:e_,PushButton:ex,RadioButton:eb,CheckBox:ew,TextField:eE,PasswordField:eA,Appearance:eT},z.AcroForm,(eq=z.API).__addimage__={},ej="UNKNOWN",eB={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},eU=eq.__addimage__.getImageFileTypeByImageData=function(e,t){var r,i,a,s,n,o=ej;if("RGBA"===(t=t||ej)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(e7(e))for(n in eB)for(a=eB[n],r=0;r<a.length;r+=1){for(s=!0,i=0;i<a[r].length;i+=1)if(void 0!==a[r][i]&&a[r][i]!==e[i]){s=!1;break}if(!0===s){o=n;break}}else for(n in eB)for(a=eB[n],r=0;r<a.length;r+=1){for(s=!0,i=0;i<a[r].length;i+=1)if(void 0!==a[r][i]&&a[r][i]!==e.charCodeAt(i)){s=!1;break}if(!0===s){o=n;break}}return o===ej&&t!==ej&&(o=t),o},eH=function e(t){for(var r=this.internal.write,i=this.internal.putStream,a=(0,this.internal.getFilters)();-1!==a.indexOf("FlateEncode");)a.splice(a.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===e2.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===e2.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var n="",o=0,l=t.transparency.length;o<l;o++)n+=t.transparency[o]+" "+t.transparency[o]+" ";s.push({key:"Mask",value:"["+n+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var u=void 0!==t.filter?["/"+t.filter]:void 0;if(i({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:u,objectId:t.objectId}),r("endobj"),"sMask"in t&&void 0!==t.sMask){var h="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,c={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:h,data:t.sMask};"filter"in t&&(c.filter=t.filter),e.call(this,c)}if(t.colorSpace===e2.INDEXED){var d=this.internal.newObject();i({data:te(new Uint8Array(t.palette)),objectId:d}),r("endobj")}},eZ=function(){var e=this.internal.collections.addImage_images;for(var t in e)eH.call(this,e[t])},eV=function(){var e,t=this.internal.collections.addImage_images,r=this.internal.write;for(var i in t)r("/I"+(e=t[i]).index,e.objectId,"0","R")},eY=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",eZ),this.internal.events.subscribe("putXobjectDict",eV))},eW=function(){var e=this.internal.collections.addImage_images;return eY.call(this),e},e$=function(){return Object.keys(this.internal.collections.addImage_images).length},eX=function(e){return"function"==typeof eq["process"+e.toUpperCase()]},eK=function(t){return"object"===e(n)(t)&&1===t.nodeType},eJ=function(e,t){if("IMG"===e.nodeName&&e.hasAttribute("src")){var r,i=""+e.getAttribute("src");if(0===i.indexOf("data:image/"))return f(unescape(i).split("base64,").pop());var a=eq.loadFile(i,!0);if(void 0!==a)return a}if("CANVAS"===e.nodeName){if(0===e.width||0===e.height)throw Error("Given canvas must have data. Canvas width: "+e.width+", height: "+e.height);switch(t){case"PNG":r="image/png";break;case"WEBP":r="image/webp";break;default:r="image/jpeg"}return f(e.toDataURL(r,1).split("base64,").pop())}},eQ=function(e){var t=this.internal.collections.addImage_images;if(t){for(var r in t)if(e===t[r].alias)return t[r]}},e0=function(e,t,r){return e||t||(e=-96,t=-96),e<0&&(e=-1*r.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*r.height*72/t/this.internal.scaleFactor),0===e&&(e=t*r.width/r.height),0===t&&(t=e*r.height/r.width),[e,t]},e1=function(e,t,r,i,a,s){var n=e0.call(this,r,i,a),o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,u=eW.call(this);if(r=n[0],i=n[1],u[a.index]=a,s)var h=Math.cos(s*=Math.PI/180),c=Math.sin(s),d=function(e){return e.toFixed(4)},p=[d(h),d(c),d(-1*c),d(h),0,0,"cm"];this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(e),l(t+i),"cm"].join(" ")),this.internal.write(p.join(" ")),this.internal.write([o(r),"0","0",o(i),"0","0","cm"].join(" "))):this.internal.write([o(r),"0","0",o(i),o(e),l(t+i),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write("1 0 0 -1 0 0 cm"),this.internal.write("/I"+a.index+" Do"),this.internal.write("Q")},e2=eq.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"},eq.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},e5=eq.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},e3=eq.__addimage__.sHashCode=function(e){var t,r,i=0;if("string"==typeof e)for(r=e.length,t=0;t<r;t++)i=(i<<5)-i+e.charCodeAt(t)|0;else if(e7(e))for(r=e.byteLength/2,t=0;t<r;t++)i=(i<<5)-i+e[t]|0;return i},e4=eq.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},e6=eq.__addimage__.extractImageFromDataUrl=function(e){var t=(e=e||"").split("base64,"),r=null;if(2===t.length){var i=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(t[0]);Array.isArray(i)&&(r={mimeType:i[1],charset:i[2],data:t[1]})}return r},e8=eq.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array},eq.__addimage__.isArrayBuffer=function(e){return e8()&&e instanceof ArrayBuffer},e7=eq.__addimage__.isArrayBufferView=function(e){return e8()&&"undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)},e9=eq.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),i=0;i<t;i++)r[i]=e.charCodeAt(i);return r},te=eq.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",r=e7(e)?e:new Uint8Array(e),i=0;i<r.length;i+=8192)t+=String.fromCharCode.apply(null,r.subarray(i,i+8192));return t},eq.addImage=function(){if("number"==typeof arguments[1]?(r=ej,i=arguments[1],a=arguments[2],s=arguments[3],o=arguments[4],l=arguments[5],u=arguments[6],h=arguments[7]):(r=arguments[1],i=arguments[2],a=arguments[3],s=arguments[4],o=arguments[5],l=arguments[6],u=arguments[7],h=arguments[8]),"object"===e(n)(t=arguments[0])&&!eK(t)&&"imageData"in t){var t,r,i,a,s,o,l,u,h,c=t;t=c.imageData,r=c.format||r||ej,i=c.x||i||0,a=c.y||a||0,s=c.w||c.width||s,o=c.h||c.height||o,l=c.alias||l,u=c.compression||u,h=c.rotation||c.angle||h}var d=this.internal.getFilters();if(void 0===u&&-1!==d.indexOf("FlateEncode")&&(u="SLOW"),isNaN(i)||isNaN(a))throw Error("Invalid coordinates passed to jsPDF.addImage");eY.call(this);var p=tt.call(this,t,r,l,u);return e1.call(this,i,a,s,o,p,h),this},tt=function(e,t,r,i){if("string"==typeof e&&eU(e)===ej){var a,s,n,o,l,u=tr(e=unescape(e),!1);(""!==u||void 0!==(u=eq.loadFile(e,!0)))&&(e=u)}if(eK(e)&&(e=eJ(e,t)),!eX(t=eU(e,t)))throw Error("addImage does not support files of type '"+t+"', please ensure that a plugin for '"+t+"' support is added.");if((null==(n=r)||0===n.length)&&(r="string"==typeof(o=e)||e7(o)?e3(o):e7(o.data)?e3(o.data):null),(a=eQ.call(this,r))||(e8()&&(e instanceof Uint8Array||"RGBA"===t||(s=e,e=e9(e))),a=this["process"+t.toUpperCase()](e,e$.call(this),r,((l=i)&&"string"==typeof l&&(l=l.toUpperCase()),l in eq.image_compression?l:e5.NONE),s)),!a)throw Error("An unknown error occurred whilst processing the image.");return a},tr=eq.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var r,i,a="";if("string"==typeof e){i=null!==(r=e6(e))?r.data:e;try{a=f(i)}catch(e){if(t)throw e4(i)?Error("atob-Error in jsPDF.convertBase64ToBinaryString "+e.message):Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return a},eq.getImageProperties=function(e){var t,r,i="";if(eK(e)&&(e=eJ(e)),"string"==typeof e&&eU(e)===ej&&(""===(i=tr(e,!1))&&(i=eq.loadFile(e)||""),e=i),!eX(r=eU(e)))throw Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if(!e8()||e instanceof Uint8Array||(e=e9(e)),!(t=this["process"+r.toUpperCase()](e)))throw Error("An unknown error occurred whilst processing the image");return t.fileType=r,t},ti=z.API,ta=function(e){if(void 0!==e&&""!=e)return!0},z.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),ti.events.push(["putPage",function(e){for(var t,r,i,a=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,n=this.internal.getPageInfoByObjId(e.objId),o=e.pageContext.annotations,l=!1,u=0;u<o.length&&!l;u++)switch((t=o[u]).type){case"link":(ta(t.options.url)||ta(t.options.pageNumber))&&(l=!0);break;case"reference":case"text":case"freetext":l=!0}if(0!=l){this.internal.write("/Annots [");for(var h=0;h<o.length;h++){t=o[h];var c=this.internal.pdfEscape,d=this.internal.getEncryptor(e.objId);switch(t.type){case"reference":this.internal.write(" "+t.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),f=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(p.objId),g=t.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a(t.bounds.x)+" "+s(t.bounds.y+t.bounds.h)+" "+a(t.bounds.x+t.bounds.w)+" "+s(t.bounds.y)+"] ")+"/Contents ("+c(m(t.contents))+") /Popup "+f.objId+" 0 R /P "+n.objId+" 0 R /T ("+c(m(g))+") >>",p.content=i;var y=p.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a(t.bounds.x+30)+" "+s(t.bounds.y+t.bounds.h)+" "+a(t.bounds.x+t.bounds.w+30)+" "+s(t.bounds.y)+"] ")+" /Parent "+y,t.open&&(i+=" /Open true"),i+=" >>",f.content=i,this.internal.write(p.objId,"0 R",f.objId,"0 R");break;case"freetext":r="/Rect ["+a(t.bounds.x)+" "+s(t.bounds.y)+" "+a(t.bounds.x+t.bounds.w)+" "+s(t.bounds.y+t.bounds.h)+"] ";var v=t.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+c(d(t.contents))+") /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+") /Border [0 0 0] >>",this.internal.write(i);break;case"link":if(t.options.name){var _=this.annotations._nameMap[t.options.name];t.options.pageNumber=_.page,t.options.top=_.y}else t.options.top||(t.options.top=0);if(r="/Rect ["+t.finalBounds.x+" "+t.finalBounds.y+" "+t.finalBounds.w+" "+t.finalBounds.h+"] ",i="",t.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+c(d(t.options.url))+") >>";else if(t.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(t.options.pageNumber).objId+" 0 R",t.options.magFactor=t.options.magFactor||"XYZ",t.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+t.options.top+"]";break;case"FitV":t.options.left=t.options.left||0,i+=" /FitV "+t.options.left+"]";break;default:var x=s(t.options.top);t.options.left=t.options.left||0,void 0===t.options.zoom&&(t.options.zoom=0),i+=" /XYZ "+t.options.left+" "+x+" "+t.options.zoom+"]"}""!=i&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),ti.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},ti.link=function(e,t,r,i,a){var s=this.internal.getCurrentPageInfo(),n=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:n(e),y:o(t),w:n(e+r),h:o(t+i)},options:a,type:"link"})},ti.textWithLink=function(e,t,r,i){var a,s,n=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;return void 0!==i.maxWidth?(s=i.maxWidth,a=Math.ceil(o*this.splitTextToSize(e,s).length)):(s=n,a=o),this.text(e,t,r,i),r+=.2*o,"center"===i.align&&(t-=n/2),"right"===i.align&&(t-=n),this.link(t,r-o,s,a,i),n},ti.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor},/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},n=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return n(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return n(e)&&a.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return n(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return n(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return n(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return n(e)&&s(e)&&4==t[e.charCodeAt(0)].length},c=e.__arabicParser__.resolveLigatures=function(e){var t=0,i=r,a="",s=0;for(t=0;t<e.length;t+=1)void 0!==i[e.charCodeAt(t)]?(s++,"number"==typeof(i=i[e.charCodeAt(t)])&&(a+=String.fromCharCode(i),i=r,s=0),t===e.length-1&&(i=r,a+=e.charAt(t-(s-1)),t-=s-1,s=0)):(i=r,a+=e.charAt(t-s),t-=s,s=0);return a};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==i[e.charCodeAt(0)]};var d=e.__arabicParser__.getCorrectForm=function(e,t,r){return n(e)?!1===s(e)?-1:!u(e)||!n(t)&&!n(r)||!n(r)&&o(t)||o(e)&&!n(t)||o(e)&&l(t)||o(e)&&o(t)?0:h(e)&&n(t)&&!o(t)&&n(r)&&u(r)?3:o(e)||!n(r)?1:2:-1},p=function(e){var r=0,i=0,a=0,s="",o="",l="",u=(e=e||"").split("\\s+"),h=[];for(r=0;r<u.length;r+=1){for(h.push(""),i=0;i<u[r].length;i+=1)s=u[r][i],o=u[r][i-1],l=u[r][i+1],n(s)?(a=d(s,o,l),h[r]+=-1!==a?String.fromCharCode(t[s.charCodeAt(0)][a]):s):h[r]+=s;h[r]=c(h[r])}return h.join(" ")},f=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,r=[];if(Array.isArray(t)){var i=0;for(r=[],i=0;i<t.length;i+=1)Array.isArray(t[i])?r.push([p(t[i][0]),t[i][1],t[i][2]]):r.push([p(t[i])]);e=r}else e=p(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",f])}(z.API),z.API.autoPrint=function(e){var t;return((e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant)?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},ts=z.API,(tn=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(e){r=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(e){i=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{})}).prototype.getContext=function(e,t){var r;if("2d"!==(e=e||"2d"))return null;for(r in t)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=t[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},tn.prototype.toDataURL=function(){throw Error("toDataURL is not implemented.")},ts.events.push(["initialized",function(){this.canvas=new tn,this.canvas.pdf=this}]),to=z.API,tl={left:0,top:0,bottom:0,right:0},tu=!1,th=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},tl),this.internal.__cell__.margins.width=this.getPageWidth(),tc.call(this))},tc=function(){this.internal.__cell__.lastCell=new td,this.internal.__cell__.pages=1},(td=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var r=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var i=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return i},set:function(e){i=e}});var a=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var n=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return n},set:function(e){n=e}}),this}).prototype.clone=function(){return new td(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},td.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},to.setHeaderFunction=function(e){return th.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},to.getTextDimensions=function(e,t){th.call(this);var r=(t=t||{}).fontSize||this.getFontSize(),i=t.font||this.getFont(),a=t.scaleFactor||this.internal.scaleFactor,s=0,n=0,o=0,l=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var u=t.maxWidth;u>0?"string"==typeof e?e=this.splitTextToSize(e,u):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(l.splitTextToSize(t,u))},[])):e=Array.isArray(e)?e:[e];for(var h=0;h<e.length;h++)s<(o=this.getStringUnitWidth(e[h],{font:i})*r)&&(s=o);return 0!==s&&(n=e.length),{w:s/=a,h:Math.max((n*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/a,0)}},to.cellAddPage=function(){th.call(this),this.addPage();var e=this.internal.__cell__.margins||tl;return this.internal.__cell__.lastCell=new td(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this},tp=to.cell=function(){e=arguments[0]instanceof td?arguments[0]:new td(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),th.call(this);var e,t=this.internal.__cell__.lastCell,r=this.internal.__cell__.padding,i=this.internal.__cell__.margins||tl,a=this.internal.__cell__.tableHeaderRow,s=this.internal.__cell__.printHeaders;return void 0!==t.lineNumber&&(t.lineNumber===e.lineNumber?(e.x=(t.x||0)+(t.width||0),e.y=t.y||0):t.y+t.height+e.height+i.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=i.top,s&&a&&(this.printHeaderRow(e.lineNumber,!0),e.y+=a[0].height)):e.y=t.y+t.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===tu?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-r,e.y+r,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+r,{align:"center",baseline:"top",maxWidth:e.width-r-r}):this.text(e.text,e.x+r,e.y+r,{align:"left",baseline:"top",maxWidth:e.width-r-r})),this.internal.__cell__.lastCell=e,this},to.table=function(t,r,i,a,s){if(th.call(this),!i)throw Error("No data for PDF table.");var o,l,u,h,c=[],d=[],p=[],f={},m={},g=[],y=[],v=(s=s||{}).autoSize||!1,_=!1!==s.printHeaders,x=s.css&&void 0!==s.css["font-size"]?16*s.css["font-size"]:s.fontSize||12,b=s.margins||Object.assign({width:this.getPageWidth()},tl),S="number"==typeof s.padding?s.padding:3,w=s.headerBackgroundColor||"#c8c8c8",E=s.headerTextColor||"#000";if(tc.call(this),this.internal.__cell__.printHeaders=_,this.internal.__cell__.margins=b,this.internal.__cell__.table_font_size=x,this.internal.__cell__.padding=S,this.internal.__cell__.headerBackgroundColor=w,this.internal.__cell__.headerTextColor=E,this.setFontSize(x),null==a)d=c=Object.keys(i[0]),p=c.map(function(){return"left"});else if(Array.isArray(a)&&"object"===e(n)(a[0]))for(c=a.map(function(e){return e.name}),d=a.map(function(e){return e.prompt||e.name||""}),p=a.map(function(e){return e.align||"left"}),o=0;o<a.length;o+=1)m[a[o].name]=a[o].width*(19.049976/25.4);else Array.isArray(a)&&"string"==typeof a[0]&&(d=c=a,p=c.map(function(){return"left"}));if(v||Array.isArray(a)&&"string"==typeof a[0])for(o=0;o<c.length;o+=1){for(f[h=c[o]]=i.map(function(e){return e[h]}),this.setFont(void 0,"bold"),g.push(this.getTextDimensions(d[o],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),l=f[h],this.setFont(void 0,"normal"),u=0;u<l.length;u+=1)g.push(this.getTextDimensions(l[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);m[h]=Math.max.apply(null,g)+S+S,g=[]}if(_){var A={};for(o=0;o<c.length;o+=1)A[c[o]]={},A[c[o]].text=d[o],A[c[o]].align=p[o];var T=tf.call(this,A,m);y=c.map(function(e){return new td(t,r,m[e],T,A[e].text,void 0,A[e].align)}),this.setTableHeaderRow(y),this.printHeaderRow(1,!1)}var C=a.reduce(function(e,t){return e[t.name]=t.align,e},{});for(o=0;o<i.length;o+=1){"rowStart"in s&&s.rowStart instanceof Function&&s.rowStart({row:o,data:i[o]},this);var P=tf.call(this,i[o],m);for(u=0;u<c.length;u+=1){var R=i[o][c[u]];"cellStart"in s&&s.cellStart instanceof Function&&s.cellStart({row:o,col:u,data:R},this),tp.call(this,new td(t,r,m[c[u]],P,R,o+2,C[c[u]]))}}return this.internal.__cell__.table_x=t,this.internal.__cell__.table_y=r,this},tf=function(e,t){var r=this.internal.__cell__.padding,i=this.internal.__cell__.table_font_size,a=this.internal.scaleFactor;return Object.keys(e).map(function(i){var a=e[i];return this.splitTextToSize(a.hasOwnProperty("text")?a.text:a,t[i]-r-r)},this).map(function(e){return this.getLineHeightFactor()*e.length*i/a+r+r},this).reduce(function(e,t){return Math.max(e,t)},0)},to.setTableHeaderRow=function(e){th.call(this),this.internal.__cell__.tableHeaderRow=e},to.printHeaderRow=function(e,t){if(th.call(this),!this.internal.__cell__.tableHeaderRow)throw Error("Property tableHeaderRow does not exist.");if(tu=!0,"function"==typeof this.internal.__cell__.headerFunction){var r,i=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new td(i[0],i[1],i[2],i[3],void 0,-1)}this.setFont(void 0,"bold");for(var a=[],s=0;s<this.internal.__cell__.tableHeaderRow.length;s+=1){r=this.internal.__cell__.tableHeaderRow[s].clone(),t&&(r.y=this.internal.__cell__.margins.top||0,a.push(r)),r.lineNumber=e;var n=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),tp.call(this,r),this.setTextColor(n)}a.length>0&&this.setTableHeaderRow(a),this.setFont(void 0,"normal"),tu=!1};var eR={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},eI=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],eL=eP(eI),eO=[100,200,300,400,500,600,700,800,900],eM=eP(eO);function ek(e){var t,r,i,a=e.family.replace(/"|'/g,"").toLowerCase(),s=eR[r=(r=e.style)||"normal"]?r:"normal",n=(t=e.weight)?"number"==typeof t?t>=100&&t<=900&&t%100==0?t:400:/^\d00$/.test(t)?parseInt(t):"bold"===t?700:400:400,o="number"==typeof eL[i=(i=e.stretch)||"normal"]?i:"normal";return{family:a,style:s,weight:n,stretch:o,src:e.src||[],ref:e.ref||{name:a,style:[o,s,n].join(" ")}}}function eN(e,t,r,i){var a;for(a=r;a>=0&&a<t.length;a+=i)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=i)if(e[t[a]])return e[t[a]]}var eD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},eF={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function eG(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function ez(e){return e.trimLeft()}var eq,ej,eB,eU,eH,eZ,eV,eY,eW,e$,eX,eK,eJ,eQ,e0,e1,e2,e5,e3,e4,e6,e8,e7,e9,te,tt,tr,ti,ta,ts,tn,to,tl,tu,th,tc,td,tp,tf,tm,tg,ty,tv=["times"];(function(t){var r,i,a,s,o,l,u,c,d,p=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new c,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new l,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new l,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),r=this.internal.f2,i=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,u=this.internal.Rectangle,c=this.internal.Matrix,d=new p}]);var f=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}}),Object.defineProperty(this,"pdf",{get:function(){return e}});var t=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return t},set:function(e){t=!!e}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=!!e}});var i=0;Object.defineProperty(this,"posX",{get:function(){return i},set:function(e){isNaN(e)||(i=e)}});var a=0;Object.defineProperty(this,"posY",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=[,,,,])[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),d.margin=t}});var s=!1;Object.defineProperty(this,"autoPaging",{get:function(){return s},set:function(e){s=e}});var n=0;Object.defineProperty(this,"lastBreak",{get:function(){return n},set:function(e){n=e}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(e){e instanceof p&&(d=e)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(e){d.path=e}});var l=[];Object.defineProperty(this,"ctxStack",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=m(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=m(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var u=null,h=null;Object.defineProperty(this,"fontFaces",{get:function(){return h},set:function(e){u=null,h=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var r=t[1],i=(t[2],t[3]),a=t[4],s=(t[5],t[6]),n=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(a)[2];a="px"===n?Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor):"em"===n?Math.floor(parseFloat(a)*this.pdf.getFontSize()):Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(a);var o=function(e){var t,r,i=[],a=e.trim();if(""===a)return tv;if(a in eF)return[eF[a]];for(;""!==a;){switch(r=null,t=(a=ez(a)).charAt(0)){case'"':case"'":r=function(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}(a.substring(1),t);break;default:r=function(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}(a)}if(null===r||(i.push(r[0]),""!==(a=ez(r[1]))&&","!==a.charAt(0)))return tv;a=a.replace(/^,/,"")}return i}(s);if(this.fontFaces){var l=function(e,t,r){for(var i=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},eD,r.genericFontFamilies||{}),s=null,n=null,o=0;o<t.length;++o)if(a[(s=ek(t[o])).family]&&(s.family=a[s.family]),e.hasOwnProperty(s.family)){n=e[s.family];break}if(!(n=n||e[i]))throw Error("Could not find a font-family for the rule '"+eG(s)+"' and default family '"+i+"'.");if(n=function(e,t){if(t[e])return t[e];var r=eL[e],i=r<=eL.normal?-1:1,a=eN(t,eI,r,i);if(!a)throw Error("Could not find a matching font-stretch value for "+e);return a}(s.stretch,n),n=function(e,t){if(t[e])return t[e];for(var r=eR[e],i=0;i<r.length;++i)if(t[r[i]])return t[r[i]];throw Error("Could not find a matching font-style for "+e)}(s.style,n),!(n=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var r=eN(t,eO,eM[e],e<400?-1:1);if(!r)throw Error("Could not find a matching font-weight for value "+e);return r}(s.weight,n)))throw Error("Failed to resolve a font for the rule '"+eG(s)+"'.");return n}(function(e,t){if(null===u){var r,i;u=function(e){for(var t={},r=0;r<e.length;++r){var i=ek(e[r]),a=i.family,s=i.stretch,n=i.style,o=i.weight;t[a]=t[a]||{},t[a][s]=t[a][s]||{},t[a][s][n]=t[a][s][n]||{},t[a][s][n][o]=i}return t}((r=e.getFontList(),i=[],Object.keys(r).forEach(function(e){r[e].forEach(function(t){var r=null;switch(t){case"bold":r={family:e,weight:"bold"};break;case"italic":r={family:e,style:"italic"};break;case"bolditalic":r={family:e,weight:"bold",style:"italic"};break;case"":case"normal":r={family:e}}null!==r&&(r.ref={name:e,style:t},i.push(r))})}),i).concat(t))}return u}(this.pdf,this.fontFaces),o.map(function(e){return{family:e,stretch:"normal",weight:i,style:r}}));this.pdf.setFont(l.ref.name,l.ref.style)}else{var h="";("bold"===i||parseInt(i,10)>=700||"bold"===r)&&(h="bold"),"italic"===r&&(h+="italic"),0===h.length&&(h="normal");for(var c="",d={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},p=0;p<o.length;p++){if(void 0!==this.pdf.internal.getFont(o[p],h,{noFallback:!0,disableWarning:!0})){c=o[p];break}if("bolditalic"===h&&void 0!==this.pdf.internal.getFont(o[p],"bold",{noFallback:!0,disableWarning:!0}))c=o[p],h="bold";else if(void 0!==this.pdf.internal.getFont(o[p],"normal",{noFallback:!0,disableWarning:!0})){c=o[p],h="normal";break}}if(""===c){for(var f=0;f<o.length;f++)if(d[o[f]]){c=d[o[f]];break}}c=""===c?"Times":c,this.pdf.setFont(c,h)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,j.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,j.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=!!e}})};f.prototype.setLineDash=function(e){this.lineDash=e},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){E.call(this,"fill",!1)},f.prototype.stroke=function(){E.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw h.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new l(e,t)},f.prototype.closePath=function(){var t=new l(0,0),r=0;for(r=this.path.length-1;-1!==r;r--)if("begin"===this.path[r].type&&"object"===e(n)(this.path[r+1])&&"number"==typeof this.path[r+1].x){t=new l(this.path[r+1].x,this.path[r+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(t.x,t.y)},f.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw h.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new l(r.x,r.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},f.prototype.quadraticCurveTo=function(e,t,r,i){if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(t))throw h.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new l(r,i)),s=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:a.x,y:a.y}),this.ctx.lastPoint=new l(a.x,a.y)},f.prototype.bezierCurveTo=function(e,t,r,i,a,s){if(isNaN(a)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i))throw h.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var n=this.ctx.transform.applyToPoint(new l(a,s)),o=this.ctx.transform.applyToPoint(new l(e,t)),u=this.ctx.transform.applyToPoint(new l(r,i));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:u.x,y2:u.y,x:n.x,y:n.y}),this.ctx.lastPoint=new l(n.x,n.y)},f.prototype.arc=function(e,t,r,i,a,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||isNaN(a))throw h.error("jsPDF.context2d.arc: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=!!s,!this.ctx.transform.isIdentity){var n=this.ctx.transform.applyToPoint(new l(e,t));e=n.x,t=n.y;var o=this.ctx.transform.applyToPoint(new l(0,r)),u=this.ctx.transform.applyToPoint(new l(0,0));r=Math.sqrt(Math.pow(o.x-u.x,2)+Math.pow(o.y-u.y,2))}Math.abs(a-i)>=2*Math.PI&&(i=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:r,startAngle:i,endAngle:a,counterclockwise:s})},f.prototype.arcTo=function(e,t,r,i,a){throw Error("arcTo not implemented.")},f.prototype.rect=function(e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i))throw h.error("jsPDF.context2d.rect: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+i),this.lineTo(e,t+i),this.lineTo(e,t),this.lineTo(e+r,t),this.lineTo(e,t)},f.prototype.fillRect=function(e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i))throw h.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,r,i),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},f.prototype.strokeRect=function(e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i))throw h.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(e,t,r,i),this.stroke())},f.prototype.clearRect=function(e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i))throw h.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,r,i))},f.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var i=new p(this.ctx);this.ctxStack.push(this.ctx),this.ctx=i}},f.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw Error("toDataUrl not implemented.")};var m=function(e){var t,r,i,a;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,r=0,i=0,a=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),r=parseInt(s[2]),i=parseInt(s[3]),a=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),r=parseInt(s[2]),i=parseInt(s[3]),a=parseFloat(s[4]);else{if(a=1,"string"==typeof e&&"#"!==e.charAt(0)){var n=new y(e);e=n.ok?n.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,r=e.substring(2,3),r+=r,i=e.substring(3,4),i+=i):(t=e.substring(1,3),r=e.substring(3,5),i=e.substring(5,7)),t=parseInt(t,16),r=parseInt(r,16),i=parseInt(i,16)}}return{r:t,g:r,b:i,a:a,style:e}},g=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},v=function(){return!!(this.ctx.isStrokeTransparent||0==this.globalAlpha)};f.prototype.fillText=function(e,t,r,i){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw h.error("jsPDF.context2d.fillText: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.fillText");if(i=isNaN(i)?void 0:i,!g.call(this)){var a=G(this.ctx.transform.rotation);O.call(this,{text:e,x:t,y:r,scale:this.ctx.transform.scaleX,angle:a,align:this.textAlign,maxWidth:i})}},f.prototype.strokeText=function(e,t,r,i){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw h.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){i=isNaN(i)?void 0:i;var a=G(this.ctx.transform.rotation);O.call(this,{text:e,x:t,y:r,scale:this.ctx.transform.scaleX,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:i})}},f.prototype.measureText=function(e){if("string"!=typeof e)throw h.error("jsPDF.context2d.measureText: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,r=this.pdf.internal.scaleFactor,i=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*i/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a*=Math.round(96*r/72*1e4)/1e4})},f.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw h.error("jsPDF.context2d.scale: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new c(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},f.prototype.rotate=function(e){if(isNaN(e))throw h.error("jsPDF.context2d.rotate: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new c(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},f.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw h.error("jsPDF.context2d.translate: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new c(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(r)},f.prototype.transform=function(e,t,r,i,a,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s))throw h.error("jsPDF.context2d.transform: Invalid arguments",arguments),Error("Invalid arguments passed to jsPDF.context2d.transform");var n=new c(e,t,r,i,a,s);this.ctx.transform=this.ctx.transform.multiply(n)},f.prototype.setTransform=function(e,t,r,i,a,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,r=isNaN(r)?0:r,i=isNaN(i)?1:i,a=isNaN(a)?0:a,s=isNaN(s)?0:s,this.ctx.transform=new c(e,t,r,i,a,s)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(e,t,r,i,a,s,n,o,l){var h=this.pdf.getImageProperties(e),d=1,p=1,f=1,m=1;void 0!==i&&void 0!==o&&(f=o/i,m=l/a,d=h.width/i*o/i,p=h.height/a*l/a),void 0===s&&(s=t,n=r,t=0,r=0),void 0!==i&&void 0===o&&(o=i,l=a),void 0===i&&void 0===o&&(o=h.width,l=h.height);for(var g,y=this.ctx.transform.decompose(),v=G(y.rotate.shx),b=new c,E=(b=(b=(b=b.multiply(y.translate)).multiply(y.skew)).multiply(y.scale)).applyToRectangle(new u(s-t*f,n-r*m,i*d,a*p)),T=x.call(this,E),C=[],P=0;P<T.length;P+=1)-1===C.indexOf(T[P])&&C.push(T[P]);if(w(C),this.autoPaging)for(var R=C[0],I=C[C.length-1],L=R;L<I+1;L++){this.pdf.setPage(L);var O=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],M=1===L?this.posY+this.margin[0]:this.margin[0],k=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],N=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],D=1===L?0:k+(L-2)*N;if(0!==this.ctx.clip_path.length){var F=this.path;g=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(g,this.posX+this.margin[3],-D+M+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=F}var z=JSON.parse(JSON.stringify(E));z=S([z],this.posX+this.margin[3],-D+M+this.ctx.prevPageLastElemOffset)[0];var q=(L>R||L<I)&&_.call(this);q&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],O,N,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",z.x,z.y,z.w,z.h,null,null,v),q&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",E.x,E.y,E.w,E.h,null,null,v)};var x=function(e,t,r){var i=[];t=t||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var a=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":i.push(Math.floor((e.y+a)/r)+1);break;case"arc":i.push(Math.floor((e.y+a-e.radius)/r)+1),i.push(Math.floor((e.y+a+e.radius)/r)+1);break;case"qct":var s=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);i.push(Math.floor((s.y+a)/r)+1),i.push(Math.floor((s.y+s.h+a)/r)+1);break;case"bct":var n=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);i.push(Math.floor((n.y+a)/r)+1),i.push(Math.floor((n.y+n.h+a)/r)+1);break;case"rect":i.push(Math.floor((e.y+a)/r)+1),i.push(Math.floor((e.y+e.h+a)/r)+1)}for(var o=0;o<i.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<i[o];)b.call(this);return i},b=function(){var e=this.fillStyle,t=this.strokeStyle,r=this.font,i=this.lineCap,a=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=r,this.lineCap=i,this.lineWidth=a,this.lineJoin=s},S=function(e,t,r){for(var i=0;i<e.length;i++)switch(e[i].type){case"bct":e[i].x2+=t,e[i].y2+=r;case"qct":e[i].x1+=t,e[i].y1+=r;default:e[i].x+=t,e[i].y+=r}return e},w=function(e){return e.sort(function(e,t){return e-t})},E=function(e,t){for(var r,i,a=this.fillStyle,s=this.strokeStyle,n=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),u=this.lineJoin,h=JSON.parse(JSON.stringify(this.path)),c=JSON.parse(JSON.stringify(this.path)),d=[],p=0;p<c.length;p++)if(void 0!==c[p].x)for(var f=x.call(this,c[p]),m=0;m<f.length;m+=1)-1===d.indexOf(f[m])&&d.push(f[m]);for(var g=0;g<d.length;g++)for(;this.pdf.internal.getNumberOfPages()<d[g];)b.call(this);if(w(d),this.autoPaging)for(var y=d[0],v=d[d.length-1],E=y;E<v+1;E++){this.pdf.setPage(E),this.fillStyle=a,this.strokeStyle=s,this.lineCap=n,this.lineWidth=l,this.lineJoin=u;var T=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],C=1===E?this.posY+this.margin[0]:this.margin[0],P=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],R=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],I=1===E?0:P+(E-2)*R;if(0!==this.ctx.clip_path.length){var L=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(r,this.posX+this.margin[3],-I+C+this.ctx.prevPageLastElemOffset),A.call(this,e,!0),this.path=L}if(i=JSON.parse(JSON.stringify(h)),this.path=S(i,this.posX+this.margin[3],-I+C+this.ctx.prevPageLastElemOffset),!1===t||0===E){var O=(E>y||E<v)&&_.call(this);O&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],T,R,null).clip().discardPath()),A.call(this,e,t),O&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,A.call(this,e,t),this.lineWidth=o;this.path=h},A=function(e,t){if(("stroke"!==e||t||!v.call(this))&&("stroke"===e||t||!g.call(this))){for(var r,i,a=[],s=this.path,n=0;n<s.length;n++){var o=s[n];switch(o.type){case"begin":a.push({begin:!0});break;case"close":a.push({close:!0});break;case"mt":a.push({start:o,deltas:[],abs:[]});break;case"lt":var l=a.length;if(s[n-1]&&!isNaN(s[n-1].x)&&(r=[o.x-s[n-1].x,o.y-s[n-1].y],l>0)){for(;l>=0;l--)if(!0!==a[l-1].close&&!0!==a[l-1].begin){a[l-1].deltas.push(r),a[l-1].abs.push(o);break}}break;case"bct":r=[o.x1-s[n-1].x,o.y1-s[n-1].y,o.x2-s[n-1].x,o.y2-s[n-1].y,o.x-s[n-1].x,o.y-s[n-1].y],a[a.length-1].deltas.push(r);break;case"qct":var u=s[n-1].x+2/3*(o.x1-s[n-1].x),h=s[n-1].y+2/3*(o.y1-s[n-1].y),c=o.x+2/3*(o.x1-o.x),d=o.y+2/3*(o.y1-o.y),p=o.x,f=o.y;r=[u-s[n-1].x,h-s[n-1].y,c-s[n-1].x,d-s[n-1].y,p-s[n-1].x,f-s[n-1].y],a[a.length-1].deltas.push(r);break;case"arc":a.push({deltas:[],abs:[],arc:!0}),Array.isArray(a[a.length-1].abs)&&a[a.length-1].abs.push(o)}}i=t?null:"stroke"===e?"stroke":"fill";for(var m=!1,y=0;y<a.length;y++)if(a[y].arc)for(var _=a[y].abs,x=0;x<_.length;x++){var b=_[x];"arc"===b.type?P.call(this,b.x,b.y,b.radius,b.startAngle,b.endAngle,b.counterclockwise,void 0,t,!m):M.call(this,b.x,b.y),m=!0}else if(!0===a[y].close)this.pdf.internal.out("h"),m=!1;else if(!0!==a[y].begin){var S=a[y].start.x,w=a[y].start.y;k.call(this,a[y].deltas,S,w),m=!0}i&&R.call(this,i),t&&I.call(this)}},T=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-r;case"top":return e+t-r;case"hanging":return e+t-2*r;case"middle":return e+t/2-r;default:return e}},C=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(e,t,r,i,a,s,n,o,l){for(var u=D.call(this,r,i,a,s),h=0;h<u.length;h++){var c=u[h];0===h&&(l?L.call(this,c.x1+e,c.y1+t):M.call(this,c.x1+e,c.y1+t)),N.call(this,e,t,c.x2,c.y2,c.x3,c.y3,c.x4,c.y4)}o?I.call(this):R.call(this,n)},R=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(e,t){this.pdf.internal.out(i(e)+" "+a(t)+" m")},O=function(e){switch(e.align){case"right":case"end":o="right";break;case"center":o="center";break;default:o="left"}var t=this.pdf.getTextDimensions(e.text),r=T.call(this,e.y),i=C.call(this,r)-t.h,a=this.ctx.transform.applyToPoint(new l(e.x,r)),s=this.ctx.transform.decompose(),n=new c;n=(n=(n=n.multiply(s.translate)).multiply(s.skew)).multiply(s.scale);for(var o,h,d,p,f=this.ctx.transform.applyToRectangle(new u(e.x,r,t.w,t.h)),m=n.applyToRectangle(new u(e.x,i,t.w,t.h)),g=x.call(this,m),y=[],v=0;v<g.length;v+=1)-1===y.indexOf(g[v])&&y.push(g[v]);if(w(y),this.autoPaging)for(var b=y[0],E=y[y.length-1],P=b;P<E+1;P++){this.pdf.setPage(P);var R=1===P?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[2],O=L-this.margin[0],M=this.pdf.internal.pageSize.width-this.margin[1],k=M-this.margin[3],N=1===P?0:I+(P-2)*O;if(0!==this.ctx.clip_path.length){var D=this.path;h=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(h,this.posX+this.margin[3],-1*N+R),A.call(this,"fill",!0),this.path=D}var F=S([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-N+R+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale);var G="text"!==this.autoPaging;if(G||F.y+F.h<=L){if(G||F.y>=R&&F.x<=M){var z=G?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||M-F.x)[0],q=S([JSON.parse(JSON.stringify(f))],this.posX+this.margin[3],-N+R+this.ctx.prevPageLastElemOffset)[0],j=G&&(P>b||P<E)&&_.call(this);j&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],k,O,null).clip().discardPath()),this.pdf.text(z,q.x,q.y,{angle:e.angle,align:o,renderingMode:e.renderingMode}),j&&this.pdf.restoreGraphicsState()}}else F.y<L&&(this.ctx.prevPageLastElemOffset+=L-F.y);e.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=p)}else e.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale),this.pdf.text(e.text,a.x+this.posX,a.y+this.posY,{angle:e.angle,align:o,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=p)},M=function(e,t,r,s){r=r||0,s=s||0,this.pdf.internal.out(i(e+r)+" "+a(t+s)+" l")},k=function(e,t,r){return this.pdf.lines(e,t,r,null,null)},N=function(e,t,i,a,n,l,u,h){this.pdf.internal.out([r(s(i+e)),r(o(a+t)),r(s(n+e)),r(o(l+t)),r(s(u+e)),r(o(h+t)),"c"].join(" "))},D=function(e,t,r,i){for(var a=2*Math.PI,s=Math.PI/2;t>r;)t-=a;var n=Math.abs(r-t);n<a&&i&&(n=a-n);for(var o=[],l=i?-1:1,u=t;n>1e-5;){var h=u+l*Math.min(n,s);o.push(F.call(this,e,u,h)),n-=Math.abs(h-u),u=h}return o},F=function(e,t,r){var i=(r-t)/2,a=e*Math.cos(i),s=e*Math.sin(i),n=-s,o=a*a+n*n,l=o+a*a+n*s,u=4/3*(Math.sqrt(2*o*l)-l)/(a*s-n*a),h=a-u*n,c=n+u*a,d=-c,p=i+t,f=Math.cos(p),m=Math.sin(p);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:h*f-c*m,y2:h*m+c*f,x3:h*f-d*m,y3:h*m+d*f,x4:e*Math.cos(r),y4:e*Math.sin(r)}},G=function(e){return 180*e/Math.PI},z=function(e,t,r,i,a,s){var n=e+.5*(r-e),o=t+.5*(i-t),l=a+.5*(r-a),h=s+.5*(i-s),c=Math.min(e,a,n,l),d=Math.min(t,s,o,h);return new u(c,d,Math.max(e,a,n,l)-c,Math.max(t,s,o,h)-d)},q=function(e,t,r,i,a,s,n,o){var l,h,c,d,p,f,m,g,y,v,_,x,b,S,w=r-e,E=i-t,A=a-r,T=s-i,C=n-a,P=o-s;for(h=0;h<41;h++)y=(m=(c=e+(l=h/40)*w)+l*((p=r+l*A)-c))+l*(p+l*(a+l*C-p)-m),v=(g=(d=t+l*E)+l*((f=i+l*T)-d))+l*(f+l*(s+l*P-f)-g),0==h?(_=y,x=v,b=y,S=v):(_=Math.min(_,y),x=Math.min(x,v),b=Math.max(b,y),S=Math.max(S,v));return new u(Math.round(_),Math.round(x),Math.round(b-_),Math.round(S-x))},j=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e=JSON.stringify({lineDash:this.ctx.lineDash,lineDashOffset:this.ctx.lineDashOffset});this.prevLineDash!==e&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=e)}}})(z.API),t_=z.API,tx=function(e){var t,r,i,a,s,n,o,l,u,h;for(/[^\x00-\xFF]/.test(e),r=[],i=0,a=(e+=t="\x00\x00\x00\x00".slice(e.length%4||4)).length;a>i;i+=4)0!==(s=(e.charCodeAt(i)<<24)+(e.charCodeAt(i+1)<<16)+(e.charCodeAt(i+2)<<8)+e.charCodeAt(i+3))?(n=(s=((s=((s=((s=(s-(h=s%85))/85)-(u=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,r.push(n+33,o+33,l+33,u+33,h+33)):r.push(122);return function(e,t){for(var r=t;r>0;r--)e.pop()}(r,t.length),String.fromCharCode.apply(String,r)+"~>"},tb=function(e){var t,r,i,a,s,n=String,o="length",l="charCodeAt",u="slice",h="replace";for(e[u](-2),e=e[u](0,-2)[h](/\s/g,"")[h]("z","!!!!!"),i=[],a=0,s=(e+=t="uuuuu"[u](e[o]%5||5))[o];s>a;a+=5)r=52200625*(e[l](a)-33)+614125*(e[l](a+1)-33)+7225*(e[l](a+2)-33)+85*(e[l](a+3)-33)+(e[l](a+4)-33),i.push(255&r>>24,255&r>>16,255&r>>8,255&r);return function(e,t){for(var r=t;r>0;r--)e.pop()}(i,t[o]),n.fromCharCode.apply(n,i)},tS=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var r="",i=0;i<e.length;i+=2)r+=String.fromCharCode("0x"+(e[i]+e[i+1]));return r},tw=function(e){for(var t=new Uint8Array(e.length),r=e.length;r--;)t[r]=e.charCodeAt(r);return e=(t=(0,o.zlibSync)(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")},t_.processDataByFilters=function(e,t){var r=0,i=e||"",a=[];for("string"==typeof(t=t||[])&&(t=[t]),r=0;r<t.length;r+=1)switch(t[r]){case"ASCII85Decode":case"/ASCII85Decode":i=tb(i),a.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":i=tx(i),a.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":i=tS(i),a.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":i=i.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">",a.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":i=tw(i),a.push("/FlateDecode");break;default:throw Error('The filter: "'+t[r]+'" is not implemented')}return{data:i,reverseChain:a.reverse().join(" ")}},(tE=z.API).loadFile=function(e,t,r){return function(e,t,r){t=!1!==t,r="function"==typeof r?r:function(){};var i=void 0;try{i=function(e,t,r){var i=new XMLHttpRequest,a=0,s=function(e){var t=e.length,r=[],i=String.fromCharCode;for(a=0;a<t;a+=1)r.push(i(255&e.charCodeAt(a)));return r.join("")};if(i.open("GET",e,!t),i.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(i.onload=function(){200===i.status?r(s(this.responseText)):r(void 0)}),i.send(null),t&&200===i.status)return s(i.responseText)}(e,t,r)}catch(e){}return i}(e,t,r)},tE.loadImageFile=tE.loadFile,function(t){function r(){return(l.html2canvas?Promise.resolve(l.html2canvas):s("dNJ6r")).catch(function(e){return Promise.reject(Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function i(){return(l.DOMPurify?Promise.resolve(l.DOMPurify):s("cusDh")).catch(function(e){return Promise.reject(Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var a=function(t){var r=e(n)(t);return"undefined"===r?"undefined":"string"===r||t instanceof String?"string":"number"===r||t instanceof Number?"number":"function"===r||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===r?"object":"unknown"},o=function(e,t){var r=document.createElement(e);for(var i in t.className&&(r.className=t.className),t.innerHTML&&t.dompurify&&(r.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)r.style[i]=t.style[i];return r},u=function e(t){var r=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),i=e.convert(Promise.resolve(),r);return(i=i.setProgress(1,e,1,[e])).set(t)};(u.prototype=Object.create(Promise.prototype)).constructor=u,u.convert=function(e,t){return e.__proto__=t||u.prototype,e},u.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},u.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(a(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(i).then(function(t){return this.set({src:o("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},u.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},u.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=function e(t,r){for(var i=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==r&&1===a.nodeType&&"SCRIPT"===a.nodeName||i.appendChild(e(a,r));return 1===t.nodeType&&("CANVAS"===t.nodeName?(i.width=t.width,i.height=t.height,i.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(i.value=t.value),i.addEventListener("load",function(){i.scrollTop=t.scrollTop,i.scrollLeft=t.scrollLeft},!0)),i}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},u.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(r).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},u.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(r).then(function(e){var t=this.opt.jsPDF,r=this.opt.fontFaces,i=Object.assign({async:!0,allowTaint:!0,scale:"number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete i.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=r,r)for(var a=0;a<r.length;++a){var s=r[a],n=s.src.find(function(e){return"truetype"===e.format});n&&t.addFont(n.url,s.ref.name,s.ref.style)}return i.windowHeight=i.windowHeight||0,i.windowHeight=0==i.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):i.windowHeight,t.context2d.save(!0),e(this.prop.container,i)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},u.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},u.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},u.prototype.output=function(e,t,r){return"img"===(r=r||"pdf").toLowerCase()||"image"===r.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},u.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},u.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},u.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},u.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},u.prototype.set=function(e){if("object"!==a(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in u.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},u.prototype.get=function(e,t){return this.then(function(){var r=e in u.template.prop?this.prop[e]:this.opt[e];return t?t(r):r})},u.prototype.setMargin=function(e){return this.then(function(){switch(a(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},u.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||z.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},u.prototype.setProgress=function(e,t,r,i){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=r&&(this.progress.n=r),null!=i&&(this.progress.stack=i),this.progress.ratio=this.progress.val/this.progress.state,this},u.prototype.updateProgress=function(e,t,r,i){return this.setProgress(e?this.progress.val+e:null,t||null,r?this.progress.n+r:null,i?this.progress.stack.concat(i):null)},u.prototype.then=function(e,t){var r=this;return this.thenCore(e,t,function(e,t){return r.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return r.updateProgress(null,e),t}).then(e,t).then(function(e){return r.updateProgress(1),e})})},u.prototype.thenCore=function(e,t,r){r=r||Promise.prototype.then,e&&(e=e.bind(this)),t&&(t=t.bind(this));var i=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:u.convert(Object.assign({},this),Promise.prototype),a=r.call(i,e,t);return u.convert(a,this.__proto__)},u.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},u.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},u.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return u.convert(t,this)},u.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},u.prototype.error=function(e){return this.then(function(){throw Error(e)})},u.prototype.using=u.prototype.set,u.prototype.saveAs=u.prototype.save,u.prototype.export=u.prototype.output,u.prototype.run=u.prototype.then,z.getPageSize=function(t,r,i){if("object"===e(n)(t)){var a=t;t=a.orientation,r=a.unit||r,i=a.format||i}r=r||"mm",i=i||"a4",t=(""+(t||"P")).toLowerCase();var s,o=(""+i).toLowerCase(),l={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(r){case"pt":s=1;break;case"mm":s=72/25.4;break;case"cm":s=72/2.54;break;case"in":s=72;break;case"px":s=.75;break;case"pc":case"em":s=12;break;case"ex":s=6;break;default:throw"Invalid unit: "+r}var u,h=0,c=0;if(l.hasOwnProperty(o))h=l[o][1]/s,c=l[o][0]/s;else try{h=i[1],c=i[0]}catch(e){throw Error("Invalid format: "+i)}if("p"===t||"portrait"===t)t="p",c>h&&(u=c,c=h,h=u);else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;t="l",h>c&&(u=c,c=h,h=u)}return{width:c,height:h,unit:r,k:s,orientation:t}},t.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(ek):null;var r=new u(t);return t.worker?r:r.from(e).doCallback()}}(z.API),z.API.addJS=function(e){return ty=e,this.internal.events.subscribe("postPutResources",function(){tm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(tm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),tg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+ty+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==tm&&void 0!==tg&&this.internal.out("/Names <</JavaScript "+tm+" 0 R>>")}),this},(tA=z.API).events.push(["postPutResources",function(){var e=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var t=this.outline.render().split(/\r\n/),r=0;r<t.length;r++){var i=t[r],a=e.exec(i);if(null!=a){var s=a[1];this.internal.newObjectDeferredBegin(s,!1)}this.internal.write(i)}if(this.outline.createNamedDestinations){var n=this.internal.pages.length,o=[];for(r=0;r<n;r++){var l=this.internal.newObject();o.push(l);var u=this.internal.getPageInfo(r+1);this.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=this.internal.newObject();for(this.internal.write("<< /Names [ "),r=0;r<o.length;r++)this.internal.write("(page_"+(r+1)+")"+o[r]+" 0 R");this.internal.write(" ] >>","endobj"),tT=this.internal.newObject(),this.internal.write("<< /Dests "+h+" 0 R"),this.internal.write(">>","endobj")}}]),tA.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+tT+" 0 R"))}]),tA.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,r){var i={title:t,options:r,children:[]};return null==e&&(e=this.root),e.children.push(i),i},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var r=0;r<t.children.length;r++)this.genIds_r(t.children[r])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<t.children.length;i++){var a=t.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),i>0&&this.line("/Prev "+this.makeRef(t.children[i-1])),i<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var s=this.count=this.count_r({count:0},a);if(s>0&&this.line("/Count "+s),a.options&&a.options.pageNumber){var n=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+n.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var r=0;r<t.children.length;r++)e.count++,this.count_r(e,t.children[r]);return e.count}}]),tC=z.API,tP=[192,193,194,195,196,197,198,199],tC.processJPEG=function(e,t,r,i,a,s){var n,o=this.decode.DCT_DECODE,l=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(n=function(e){for(var t,r=256*e.charCodeAt(4)+e.charCodeAt(5),i=e.length,a={width:0,height:0,numcomponents:1},s=4;s<i;s+=2){if(s+=r,-1!==tP.indexOf(e.charCodeAt(s+1))){t=256*e.charCodeAt(s+5)+e.charCodeAt(s+6),a={width:256*e.charCodeAt(s+7)+e.charCodeAt(s+8),height:t,numcomponents:e.charCodeAt(s+9)};break}r=256*e.charCodeAt(s+2)+e.charCodeAt(s+3)}return a}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:s=this.color_spaces.DEVICE_GRAY;break;case 4:s=this.color_spaces.DEVICE_CMYK;break;case 3:s=this.color_spaces.DEVICE_RGB}l={data:e,width:n.width,height:n.height,colorSpace:s,bitsPerComponent:8,filter:o,index:t,alias:r}}return l};var t_,tx,tb,tS,tw,tE,tA,tT,tC,tP,tR,tI,tL,tO,tM,tk=function(){function e(e){var t,r,i,a,s,n,o,l,u,h,c,d,p,f;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},n=null;;){switch(t=this.readUInt32(),u=(function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":n&&this.animation.frames.push(n),this.pos+=4,n={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),a=this.readUInt16()||100,n.delay=1e3*s/a,n.disposeOp=this.data[this.pos++],n.blendOp=this.data[this.pos++],n.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,t-=4),e=(null!=n?n.data:void 0)||this.imgData,d=0;0<=t?d<t:d>t;0<=t?++d:--d)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(i=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>i)throw Error("More transparent colors than palette size");if((h=i-this.transparency.indexed.length)>0)for(p=0;0<=h?p<h:p>h;0<=h?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(c=this.read(t)).indexOf(0),l=String.fromCharCode.apply(String,c.slice(0,o)),this.text[l]=String.fromCharCode.apply(String,c.slice(o+1));break;case"IEND":return n&&this.animation.frames.push(n),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file")}}e.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},e.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},e.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},e.prototype.decodePixels=function(e){var t=this.pixelBitlength/8,r=new Uint8Array(this.width*this.height*t),i=0,a=this;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);function s(s,n,o,l){var u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C,P,R,I=Math.ceil((a.width-s)/o),L=Math.ceil((a.height-n)/l),O=a.width==I&&a.height==L;for(S=t*I,x=O?r:new Uint8Array(S*L),f=e.length,b=0,h=0;b<L&&i<f;){switch(e[i++]){case 0:for(d=A=0;A<S;d=A+=1)x[h++]=e[i++];break;case 1:for(d=T=0;T<S;d=T+=1)u=e[i++],p=d<t?0:x[h-t],x[h++]=(u+p)%256;break;case 2:for(d=C=0;C<S;d=C+=1)u=e[i++],c=(d-d%t)/t,w=b&&x[(b-1)*S+c*t+d%t],x[h++]=(w+u)%256;break;case 3:for(d=P=0;P<S;d=P+=1)u=e[i++],c=(d-d%t)/t,p=d<t?0:x[h-t],w=b&&x[(b-1)*S+c*t+d%t],x[h++]=(u+Math.floor((p+w)/2))%256;break;case 4:for(d=R=0;R<S;d=R+=1)u=e[i++],c=(d-d%t)/t,p=d<t?0:x[h-t],0===b?w=E=0:(w=x[(b-1)*S+c*t+d%t],E=c&&x[(b-1)*S+(c-1)*t+d%t]),g=Math.abs((m=p+w-E)-p),v=Math.abs(m-w),_=Math.abs(m-E),y=g<=v&&g<=_?p:v<=_?w:E,x[h++]=(u+y)%256;break;default:throw Error("Invalid filter algorithm: "+e[i-1])}if(!O){var M=((n+b*l)*a.width+s)*t,k=b*S;for(d=0;d<I;d+=1){for(var N=0;N<t;N+=1)r[M++]=x[k++];M+=(o-1)*t}}b++}}return e=(0,o.unzlibSync)(e),1==a.interlaceMethod?(s(0,0,8,8),s(4,0,8,8),s(0,4,4,8),s(2,0,4,4),s(0,2,2,4),s(1,0,2,2),s(0,1,1,2)):s(0,0,1,1),r},e.prototype.decodePalette=function(){var e,t,r,i,a,s,n,o,l;for(r=this.palette,s=this.transparency.indexed||[],a=new Uint8Array((s.length||0)+r.length),i=0,e=0,t=n=0,o=r.length;n<o;t=n+=3)a[i++]=r[t],a[i++]=r[t+1],a[i++]=r[t+2],a[i++]=null!=(l=s[e++])?l:255;return a},e.prototype.copyToImageData=function(e,t){var r,i,a,s,n,o,l,u,h,c,d;if(i=this.colors,h=null,r=this.hasAlphaChannel,this.palette.length&&(h=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),i=4,r=!0),u=(a=e.data||e).length,n=h||t,s=o=0,1===i)for(;s<u;)l=h?4*t[s/4]:o,c=n[l++],a[s++]=c,a[s++]=c,a[s++]=c,a[s++]=r?n[l++]:255,o=l;else for(;s<u;)l=h?4*t[s/4]:o,a[s++]=n[l++],a[s++]=n[l++],a[s++]=n[l++],a[s++]=r?n[l++]:255,o=l},e.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};var t,r,i,a=function(){if("[object Window]"===Object.prototype.toString.call(l)){try{i=(r=l.document.createElement("canvas")).getContext("2d")}catch(e){return!1}return!0}return!1};return a(),t=function(e){var t;if(!0===a())return i.width=e.width,i.height=e.height,i.clearRect(0,0,e.width,e.height),i.putImageData(e,0,0),(t=new Image).src=r.toDataURL(),t;throw Error("This method requires a Browser with Canvas-capability.")},e.prototype.decodeFrames=function(e){var r,i,a,s,n,o,l,u;if(this.animation){for(u=[],i=n=0,o=(l=this.animation.frames).length;n<o;i=++n)r=l[i],a=e.createImageData(r.width,r.height),s=this.decodePixels(new Uint8Array(r.data)),this.copyToImageData(a,s),r.imageData=a,u.push(r.image=t(a));return u}},e.prototype.renderFrame=function(e,t){var r,i,a;return r=(i=this.animation.frames)[t],a=i[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=a?a.disposeOp:void 0)?e.clearRect(a.xOffset,a.yOffset,a.width,a.height):2===(null!=a?a.disposeOp:void 0)&&e.putImageData(a.imageData,a.xOffset,a.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},e.prototype.animate=function(e){var t,r,i,a,s,n,o=this;return r=0,a=(n=this.animation).numFrames,i=n.frames,s=n.numPlays,(t=function(){var n,l;if(l=i[n=r++%a],o.renderFrame(e,n),a>1&&r/a<s)return o.animation._timeout=setTimeout(t,l.delay)})()},e.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},e.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},e}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function tN(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,a=e[t++],s=1<<(7&a)+1;e[t++],e[t++];var n=null,o=null;a>>7&&(n=t,o=s,t+=3*s);var l=!0,u=[],h=0,c=null,d=0,p=null;for(this.width=r,this.height=i;l&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((m=e[t++])>=0))throw Error("Invalid block size");if(0===m)break;t+=m}break;case 249:if(4!==e[t++]||0!==e[t+4])throw Error("Invalid graphics extension block.");var f=e[t++];h=e[t++]|e[t++]<<8,c=e[t++],0==(1&f)&&(c=null),d=f>>2&7,t++;break;case 254:for(;;){if(!((m=e[t++])>=0))throw Error("Invalid block size");if(0===m)break;t+=m}break;default:throw Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var m,g=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,x=e[t++],b=x>>6&1,S=1<<(7&x)+1,w=n,E=o,A=!1;x>>7&&(A=!0,w=t,E=S,t+=3*S);var T=t;for(t++;;){if(!((m=e[t++])>=0))throw Error("Invalid block size");if(0===m)break;t+=m}u.push({x:g,y:y,width:v,height:_,has_local_palette:A,palette_offset:w,palette_size:E,data_offset:T,data_length:t-T,transparent_index:c,interlaced:!!b,delay:h,disposal:d});break;case 59:l=!1;break;default:throw Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(e){if(e<0||e>=u.length)throw Error("Frame index out of range.");return u[e]},this.decodeAndBlitFrameBGRA=function(t,i){var a=this.frameInfo(t),s=a.width*a.height,n=new Uint8Array(s);tD(e,a.data_offset,n,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var u=a.width,h=r-u,c=u,d=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),f=d,m=4*h;!0===a.interlaced&&(m+=4*r*7);for(var g=8,y=0,v=n.length;y<v;++y){var _=n[y];if(0===c&&(c=u,(f+=m)>=p&&(m=4*h+4*r*(g-1),f=d+(u+h)*(g<<1),g>>=1)),_===l)f+=4;else{var x=e[o+3*_],b=e[o+3*_+1],S=e[o+3*_+2];i[f++]=S,i[f++]=b,i[f++]=x,i[f++]=255}--c}},this.decodeAndBlitFrameRGBA=function(t,i){var a=this.frameInfo(t),s=a.width*a.height,n=new Uint8Array(s);tD(e,a.data_offset,n,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var u=a.width,h=r-u,c=u,d=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),f=d,m=4*h;!0===a.interlaced&&(m+=4*r*7);for(var g=8,y=0,v=n.length;y<v;++y){var _=n[y];if(0===c&&(c=u,(f+=m)>=p&&(m=4*h+4*r*(g-1),f=d+(u+h)*(g<<1),g>>=1)),_===l)f+=4;else{var x=e[o+3*_],b=e[o+3*_+1],S=e[o+3*_+2];i[f++]=x,i[f++]=b,i[f++]=S,i[f++]=255}--c}}}function tD(e,t,r,i){for(var a=e[t++],s=1<<a,n=s+1,o=n+1,l=a+1,u=(1<<l)-1,c=0,d=0,p=0,f=e[t++],m=new Int32Array(4096),g=null;;){for(;c<16&&0!==f;)d|=e[t++]<<c,c+=8,1===f?f=e[t++]:--f;if(c<l)break;var y=d&u;if(d>>=l,c-=l,y!==s){if(y===n)break;for(var v=y<o?y:g,_=0,x=v;x>s;)x=m[x]>>8,++_;var b=x;if(p+_+(v!==y?1:0)>i)return void h.log("Warning, gif stream longer than expected.");r[p++]=b;var S=p+=_;for(v!==y&&(r[p++]=b),x=v;_--;)x=m[x],r[--S]=255&x,x>>=8;null!==g&&o<4096&&(m[o++]=g<<8|b,o>=u+1&&l<12&&(++l,u=u<<1|1)),g=y}else o=n+1,u=(1<<(l=a+1))-1,g=null}return p!==i&&h.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function tF(e){var t,r,i,a,s,n=Math.floor,o=Array(64),l=Array(64),u=Array(64),h=Array(64),c=Array(65535),d=Array(65535),p=Array(64),f=Array(64),m=[],g=0,y=7,v=Array(64),_=Array(64),x=Array(64),b=Array(256),S=Array(2048),w=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],L=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O(e,t){for(var r=0,i=0,a=[],s=1;s<=16;s++){for(var n=1;n<=e[s];n++)a[t[i]]=[],a[t[i]][0]=r,a[t[i]][1]=s,i++,r++;r*=2}return a}function M(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(g|=1<<y),r--,--y<0&&(255==g?(k(255),k(0)):k(g),y=7,g=0)}function k(e){m.push(e)}function N(e){k(e>>8&255),k(255&e)}function D(e,t,r,i,a){for(var s,n=a[0],o=a[240],l=function(e,t){var r,i,a,s,n,o,l,u,h,c,d=0;for(h=0;h<8;++h){r=e[d],i=e[d+1],a=e[d+2],s=e[d+3],n=e[d+4],o=e[d+5],l=e[d+6];var f=r+(u=e[d+7]),m=r-u,g=i+l,y=i-l,v=a+o,_=a-o,x=s+n,b=s-n,S=f+x,w=f-x,E=g+v,A=g-v;e[d]=S+E,e[d+4]=S-E;var T=.707106781*(A+w);e[d+2]=w+T,e[d+6]=w-T;var C=.382683433*((S=b+_)-(A=y+m)),P=.5411961*S+C,R=1.306562965*A+C,I=.707106781*(E=_+y),L=m+I,O=m-I;e[d+5]=O+P,e[d+3]=O-P,e[d+1]=L+R,e[d+7]=L-R,d+=8}for(d=0,h=0;h<8;++h){r=e[d],i=e[d+8],a=e[d+16],s=e[d+24],n=e[d+32],o=e[d+40],l=e[d+48];var M=r+(u=e[d+56]),k=r-u,N=i+l,D=i-l,F=a+o,G=a-o,z=s+n,q=s-n,j=M+z,B=M-z,U=N+F,H=N-F;e[d]=j+U,e[d+32]=j-U;var Z=.707106781*(H+B);e[d+16]=B+Z,e[d+48]=B-Z;var V=.382683433*((j=q+G)-(H=D+k)),Y=.5411961*j+V,W=1.306562965*H+V,$=.707106781*(U=G+D),X=k+$,K=k-$;e[d+40]=K+Y,e[d+24]=K-Y,e[d+8]=X+W,e[d+56]=X-W,d++}for(h=0;h<64;++h)c=e[h]*t[h],p[h]=c>0?c+.5|0:c-.5|0;return p}(e,t),u=0;u<64;++u)f[w[u]]=l[u];var h=f[0]-r;r=f[0],0==h?M(i[0]):(M(i[d[s=32767+h]]),M(c[s]));for(var m=63;m>0&&0==f[m];)m--;if(0==m)return M(n),r;for(var g,y=1;y<=m;){for(var v=y;0==f[y]&&y<=m;)++y;var _=y-v;if(_>=16){g=_>>4;for(var x=1;x<=g;++x)M(o);_&=15}M(a[(_<<4)+d[s=32767+f[y]]]),M(c[s]),y++}return 63!=m&&M(n),r}function F(e){s!=(e=Math.min(Math.max(e,1),100))&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var i=n((t[r]*e+50)/100);i=Math.min(Math.max(i,1),255),o[w[r]]=i}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var c=n((a[s]*e+50)/100);c=Math.min(Math.max(c,1),255),l[w[s]]=c}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,f=0;f<8;f++)for(var m=0;m<8;m++)u[p]=1/(o[w[p]]*d[f]*d[m]*8),h[p]=1/(l[w[p]]*d[f]*d[m]*8),p++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&F(s),m=[],g=0,y=7,N(65496),N(65504),N(16),k(74),k(70),k(73),k(70),k(0),k(1),k(1),k(0),N(1),N(1),k(0),k(0),function(){N(65499),N(132),k(0);for(var e=0;e<64;e++)k(o[e]);k(1);for(var t=0;t<64;t++)k(l[t])}(),p=e.width,f=e.height,N(65472),N(17),k(8),N(f),N(p),k(3),k(1),k(17),k(0),k(2),k(17),k(1),k(3),k(17),k(1),function(){N(65476),N(418),k(0);for(var e=0;e<16;e++)k(E[e+1]);for(var t=0;t<=11;t++)k(A[t]);k(16);for(var r=0;r<16;r++)k(T[r+1]);for(var i=0;i<=161;i++)k(C[i]);k(1);for(var a=0;a<16;a++)k(P[a+1]);for(var s=0;s<=11;s++)k(R[s]);k(17);for(var n=0;n<16;n++)k(I[n+1]);for(var o=0;o<=161;o++)k(L[o])}(),N(65498),N(12),k(3),k(1),k(0),k(2),k(17),k(3),k(17),k(0),k(63),k(0);var n=0,c=0,d=0;g=0,y=7,this.encode.displayName="_encode_";for(var p,f,b,w,O,G,z,q,j,B,U,H=e.data,Z=e.width,V=e.height,Y=4*Z,W=0;W<V;){for(b=0;b<Y;){for(z=Y*W+b,j=-1,B=0,U=0;U<64;U++)q=z+(B=U>>3)*Y+(j=4*(7&U)),W+B>=V&&(q-=Y*(W+1+B-V)),b+j>=Y&&(q-=b+j-Y+4),w=H[q++],O=H[q++],G=H[q++],v[U]=(S[w]+S[O+256>>0]+S[G+512>>0]>>16)-128,_[U]=(S[w+768>>0]+S[O+1024>>0]+S[G+1280>>0]>>16)-128,x[U]=(S[w+1280>>0]+S[O+1536>>0]+S[G+1792>>0]>>16)-128;n=D(v,u,n,t,i),c=D(_,h,c,r,a),d=D(x,h,d,r,a),b+=32}W+=8}if(y>=0){var $=[];$[1]=y+1,$[0]=(1<<y+1)-1,M($)}return N(65497),new Uint8Array(m)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)b[t]=e(t)}(),t=O(E,A),r=O(P,R),i=O(T,C),a=O(I,L),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var i=e;i<t;i++)d[32767+i]=r,c[32767+i]=[],c[32767+i][1]=r,c[32767+i][0]=i;for(var a=-(t-1);a<=-e;a++)d[32767+a]=r,c[32767+a]=[],c[32767+a][1]=r,c[32767+a][0]=t-1+a;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)S[e]=19595*e,S[e+256>>0]=38470*e,S[e+512>>0]=7471*e+32768,S[e+768>>0]=-11059*e,S[e+1024>>0]=-21709*e,S[e+1280>>0]=32768*e+8421375,S[e+1536>>0]=-27439*e,S[e+1792>>0]=-5329*e}(),F(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function tG(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function tz(e){function t(e){if(!e)throw Error("assert :P")}function r(e,t,r){for(var i=0;4>i;i++)if(e[t+i]!=r.charCodeAt(i))return!0;return!1}function i(e,t,r,i,a){for(var s=0;s<a;s++)e[t+s]=r[i+s]}function a(e,t,r,i){for(var a=0;a<i;a++)e[t+a]=r}function s(e){return new Int32Array(e)}function n(e,t){for(var r=[],i=0;i<e;i++)r.push(new t);return r}function o(e,t){var r=[];return function e(r,i,a){for(var s=a[i],n=0;n<s&&(r.push(a.length>i+1?[]:new t),!(a.length<i+1));n++)e(r[n],i+1,a)}(r,0,e),r}var l=function(){var e=this;function l(e,t){for(var r=1<<t-1>>>0;e&r;)r>>>=1;return r?(e&r-1)+r:e}function u(e,r,i,a,s){t(!(a%i));do e[r+(a-=i)]=s;while(0<a)}function h(e,r,i,a,n){if(t(2328>=n),512>=n)var o=s(512);else if(null==(o=s(n)))return 0;return function(e,r,i,a,n,o){var h,d,p=r,f=1<<i,m=s(16),g=s(16);for(t(0!=n),t(null!=a),t(null!=e),t(0<i),d=0;d<n;++d){if(15<a[d])return 0;++m[a[d]]}if(m[0]==n)return 0;for(g[1]=0,h=1;15>h;++h){if(m[h]>1<<h)return 0;g[h+1]=g[h]+m[h]}for(d=0;d<n;++d)h=a[d],0<a[d]&&(o[g[h]++]=d);if(1==g[15])return(a=new c).g=0,a.value=o[0],u(e,p,1,f,a),f;var y,v=-1,_=f-1,x=0,b=1,S=1,w=1<<i;for(d=0,h=1,n=2;h<=i;++h,n<<=1){if(b+=S<<=1,0>(S-=m[h]))return 0;for(;0<m[h];--m[h])(a=new c).g=h,a.value=o[d++],u(e,p+x,n,w,a),x=l(x,h)}for(h=i+1,n=2;15>=h;++h,n<<=1){if(b+=S<<=1,0>(S-=m[h]))return 0;for(;0<m[h];--m[h]){if(a=new c,(x&_)!=v){for(p+=w,y=1<<(v=h)-i;15>v&&!(0>=(y-=m[v]));)++v,y<<=1;f+=w=1<<(y=v-i),e[r+(v=x&_)].g=y+i,e[r+v].value=p-r-v}a.g=h-i,a.value=o[d++],u(e,p+(x>>i),n,w,a),x=l(x,h)}}return b!=2*g[15]-1?0:f}(e,r,i,a,n,o)}function c(){this.value=this.g=0}function d(){this.value=this.g=0}function p(){this.G=n(5,c),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=n(rg,d)}function f(e,r,i,a){t(null!=e),t(null!=r),t(2147483648>a),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=r,e.pa=i,e.Jd=r,e.Yc=i+a,e.Zc=4<=a?i+a-4+1:i,T(e)}function m(e,t){for(var r=0;0<t--;)r|=P(e,128)<<t;return r}function g(e,t){var r=m(e,t);return C(e)?-r:r}function y(e,r,i,a){var s,n=0;for(t(null!=e),t(null!=r),t(4294967288>a),e.Sb=a,e.Ra=0,e.u=0,e.h=0,4<a&&(a=4),s=0;s<a;++s)n+=r[i+s]<<8*s;e.Ra=n,e.bb=a,e.oa=r,e.pa=i}function v(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<r_-8>>>0,++e.bb,e.u-=8;w(e)&&(e.h=1,e.u=0)}function _(e,r){if(t(0<=r),!e.h&&r<=rv){var i=S(e)&ry[r];return e.u+=r,v(e),i}return e.h=1,e.u=0}function x(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function b(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function S(e){return e.Ra>>>(e.u&r_-1)>>>0}function w(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>r_}function E(e,t){e.u=t,e.h=w(e)}function A(e){e.u>=rx&&(t(e.u>=rx),v(e))}function T(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function C(e){return m(e,1)}function P(e,t){var r=e.Ca;0>e.b&&T(e);var i=e.b,a=r*t>>>8,s=(e.I>>>i>a)+0;for(s?(r-=a,e.I-=a+1<<i>>>0):r=a+1,i=r,a=0;256<=i;)a+=8,i>>=8;return i=7^a+rb[i],e.b-=i,e.Ca=(r<<i)-1,s}function R(e,t,r){e[t+0]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255}function I(e,t){return e[t+0]<<0|e[t+1]<<8}function L(e,t){return I(e,t)|e[t+2]<<16}function O(e,t){return I(e,t)|I(e,t+2)<<16}function M(e,r){return t(null!=e),t(0<r),e.X=s(1<<r),null==e.X?0:(e.Mb=32-r,e.Xa=r,1)}function k(e,r){t(null!=e),t(null!=r),t(e.Xa==r.Xa),i(r.X,0,e.X,0,1<<r.Xa)}function N(){this.X=[],this.Xa=this.Mb=0}function D(e,r,i,a){t(null!=i),t(null!=a);var s=i[0],n=a[0];return 0==s&&(s=(e*n+r/2)/r),0==n&&(n=(r*s+e/2)/e),0>=s||0>=n?0:(i[0]=s,a[0]=n,1)}function F(e,t){return e+(1<<t)-1>>>t}function G(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function z(t,r){e[r]=function(r,i,a,s,n,o,l){var u;for(u=0;u<n;++u){var h=e[t](o[l+u-1],a,s+u);o[l+u]=G(r[i+u],h)}}}function q(){this.ud=this.hd=this.jd=0}function j(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function B(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function U(e,t){return B(e+(e-t+.5>>1))}function H(e,t,r){return Math.abs(t-r)-Math.abs(e-r)}function Z(e,t,r,i,a,s,n){for(i=s[n-1],r=0;r<a;++r)s[n+r]=i=G(e[t+r],i)}function V(e,t,r,i,a){var s;for(s=0;s<r;++s){var n=e[t+s],o=n>>8&255,l=16711935&(l=(l=16711935&n)+((o<<16)+o));i[a+s]=(4278255360&n)+l>>>0}}function Y(e,t){t.jd=e>>0&255,t.hd=e>>8&255,t.ud=e>>16&255}function W(e,t,r,i,a,s){var n;for(n=0;n<i;++n){var o=t[r+n],l=o>>>8,u=o,h=255&(h=(h=o>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));u=255&(u=(u+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(h<<24>>24)>>>5)),a[s+n]=(4278255360&o)+(h<<16)+u}}function $(t,r,i,a,s){e[r]=function(e,t,r,i,n,o,l,u,h){for(i=l;i<u;++i)for(l=0;l<h;++l)n[o++]=s(r[a(e[t++])])},e[t]=function(t,r,n,o,l,u,h){var c=8>>t.b,d=t.Ea,p=t.K[0],f=t.w;if(8>c)for(t=(1<<t.b)-1,f=(1<<c)-1;r<n;++r){var m,g=0;for(m=0;m<d;++m)m&t||(g=a(o[l++])),u[h++]=s(p[g&f]),g>>=c}else e["VP8LMapColor"+i](o,l,p,f,u,h,r,n,d)}}function X(e,t,r,i,a){for(r=t+r;t<r;){var s=e[t++];i[a++]=s>>16&255,i[a++]=s>>8&255,i[a++]=s>>0&255}}function K(e,t,r,i,a){for(r=t+r;t<r;){var s=e[t++];i[a++]=s>>16&255,i[a++]=s>>8&255,i[a++]=s>>0&255,i[a++]=s>>24&255}}function J(e,t,r,i,a){for(r=t+r;t<r;){var s=(n=e[t++])>>16&240|n>>12&15,n=n>>0&240|n>>28&15;i[a++]=s,i[a++]=n}}function Q(e,t,r,i,a){for(r=t+r;t<r;){var s=(n=e[t++])>>16&248|n>>13&7,n=n>>5&224|n>>3&31;i[a++]=s,i[a++]=n}}function ee(e,t,r,i,a){for(r=t+r;t<r;){var s=e[t++];i[a++]=s>>0&255,i[a++]=s>>8&255,i[a++]=s>>16&255}}function et(e,t,r,a,s,n){if(0==n)for(r=t+r;t<r;)R(a,((n=e[t++])[0]>>24|n[1]>>8&65280|n[2]<<8&16711680|n[3]<<24)>>>0),s+=32;else i(a,s,e,t,r)}function er(t,r){e[r][0]=e[t+"0"],e[r][1]=e[t+"1"],e[r][2]=e[t+"2"],e[r][3]=e[t+"3"],e[r][4]=e[t+"4"],e[r][5]=e[t+"5"],e[r][6]=e[t+"6"],e[r][7]=e[t+"7"],e[r][8]=e[t+"8"],e[r][9]=e[t+"9"],e[r][10]=e[t+"10"],e[r][11]=e[t+"11"],e[r][12]=e[t+"12"],e[r][13]=e[t+"13"],e[r][14]=e[t+"0"],e[r][15]=e[t+"0"]}function ei(e){return e==ic||e==id||e==ip||e==im}function ea(){this.eb=[],this.size=this.A=this.fb=0}function es(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function en(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ea,this.f.kb=new es,this.sd=null}function eo(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function el(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function eu(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function eh(e,t){var r=e.T,a=t.ba.f.RGBA,s=a.eb,n=a.fb+e.ka*a.A,o=iq[t.ba.S],l=e.y,u=e.O,h=e.f,c=e.N,d=e.ea,p=e.W,f=t.cc,m=t.dc,g=t.Mc,y=t.Nc,v=e.ka,_=e.ka+e.T,x=e.U,b=x+1>>1;for(0==v?o(l,u,null,null,h,c,d,p,h,c,d,p,s,n,null,null,x):(o(t.ec,t.fc,l,u,f,m,g,y,h,c,d,p,s,n-a.A,s,n,x),++r);v+2<_;v+=2)f=h,m=c,g=d,y=p,c+=e.Rc,p+=e.Rc,n+=2*a.A,o(l,(u+=2*e.fa)-e.fa,l,u,f,m,g,y,h,c,d,p,s,n-a.A,s,n,x);return u+=e.fa,e.j+_<e.o?(i(t.ec,t.fc,l,u,x),i(t.cc,t.dc,h,c,b),i(t.Mc,t.Nc,d,p,b),r--):1&_||o(l,u,null,null,h,c,d,p,h,c,d,p,s,n+a.A,null,null,x),r}function ec(e,r,i){var a=e.F,s=[e.J];if(null!=a){var n=e.U,o=r.ba.S,l=o==il||o==ip;r=r.ba.f.RGBA;var u=[0],h=e.ka;u[0]=e.T,e.Kb&&(0==h?--u[0]:(--h,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(u[0]=e.o-e.j-h));var c=r.eb;h=r.fb+h*r.A,e=r2(a,s[0],e.width,n,u,c,h+(l?0:3),r.A),t(i==u),e&&ei(o)&&r0(c,h,l,n,u,r.A)}return 0}function ed(e){var t=e.ma,r=t.ba.S,i=11>r,a=r==ia||r==io||r==il||r==iu||12==r||ei(r);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!rp(t.Oa,e,a?11:12))return 0;if(a&&ei(r)&&t6(),e.da)alert("todo:use_scaling");else{if(i){if(t.Ib=eu,e.Kb){if(r=e.U+1>>1,t.memory=s(e.U+2*r),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+r,t.Ib=eh,t6()}}else alert("todo:EmitYUV");a&&(t.Jb=ec,i&&t3())}if(i&&!i0){for(e=0;256>e;++e)i1[e]=89858*(e-128)+i$>>iW,i3[e]=-22014*(e-128)+i$,i5[e]=-45773*(e-128),i2[e]=113618*(e-128)+i$>>iW;for(e=iX;e<iK;++e)t=76283*(e-16)+i$>>iW,i4[e-iX]=eZ(t,255),i6[e-iX]=eZ(t+8>>4,15);i0=1}return 1}function ep(e){var r=e.ma,i=e.U,a=e.T;return t(!(1&e.ka)),0>=i||0>=a?0:(i=r.Ib(e,r),null!=r.Jb&&r.Jb(e,r,i),r.Dc+=i,1)}function ef(e){e.ma.memory=null}function em(e,t,r,i){return 47!=_(e,8)?0:(t[0]=_(e,14)+1,r[0]=_(e,14)+1,i[0]=_(e,1),0!=_(e,3)?0:!e.h)}function eg(e,t){if(4>e)return e+1;var r=e-2>>1;return(2+(1&e)<<r)+_(t,r)+1}function ey(e,t){var r;return 120<t?t-120:1<=(r=((r=ib[t-1])>>4)*e+(8-(15&r)))?r:1}function ev(e,t,r){var i=S(r),a=e[t+=255&i].g-8;return 0<a&&(E(r,r.u+8),i=S(r),t+=e[t].value,t+=i&(1<<a)-1),E(r,r.u+e[t].g),e[t].value}function e_(e,r,i){return i.g+=e.g,i.value+=e.value<<r>>>0,t(8>=i.g),e.g}function ex(e,r,i){var a=e.xc;return t((r=0==a?0:e.vc[e.md*(i>>a)+(r>>a)])<e.Wb),e.Ya[r]}function eb(e,r,a,s){var n=e.ab,o=e.c*r,l=e.C;r=l+r;var u=a,h=s;for(s=e.Ta,a=e.Ua;0<n--;){var c=e.gc[n],d=l,p=r,f=u,m=h,g=(h=s,u=a,c.Ea);switch(t(d<p),t(p<=c.nc),c.hc){case 2:rE(f,m,(p-d)*g,h,u);break;case 0:var y=d,v=p,_=h,x=u,b=(T=c).Ea;0==y&&(rS(f,m,null,null,1,_,x),Z(f,m+1,0,0,b-1,_,x+1),m+=b,x+=b,++y);for(var S=1<<T.b,w=S-1,E=F(b,T.b),A=T.K,T=T.w+(y>>T.b)*E;y<v;){var C=A,P=T,R=1;for(rw(f,m,_,x-b,1,_,x);R<b;){var I=(R&~w)+S;I>b&&(I=b),(0,rR[C[P++]>>8&15])(f,m+ +R,_,x+R-b,I-R,_,x+R),R=I}m+=b,x+=b,++y&w||(T+=E)}p!=c.nc&&i(h,u-g,h,u+(p-d-1)*g,g);break;case 1:for(g=f,v=m,b=(f=c.Ea)-(x=f&~(_=(m=1<<c.b)-1)),y=F(f,c.b),S=c.K,c=c.w+(d>>c.b)*y;d<p;){for(w=S,E=c,A=new q,T=v+x,C=v+f;v<T;)Y(w[E++],A),rI(A,g,v,m,h,u),v+=m,u+=m;v<C&&(Y(w[E++],A),rI(A,g,v,b,h,u),v+=b,u+=b),++d&_||(c+=y)}break;case 3:if(f==h&&m==u&&0<c.b){for(v=h,f=g=u+(p-d)*g-(x=(p-d)*F(c.Ea,c.b)),m=h,_=u,y=[],x=(b=x)-1;0<=x;--x)y[x]=m[_+x];for(x=b-1;0<=x;--x)v[f+x]=y[x];rA(c,d,p,h,g,h,u)}else rA(c,d,p,f,m,h,u)}u=s,h=a}h!=a&&i(s,a,u,h,o)}function eS(e,r){var i=e.V,a=e.Ba+e.c*e.C,s=r-e.C;if(t(r<=e.l.o),t(16>=s),0<s){var n=e.l,o=e.Ta,l=e.Ua,u=n.width;if(eb(e,s,i,a),s=l=[l],t((i=e.C)<(a=r)),t(n.v<n.va),a>n.o&&(a=n.o),i<n.j){var h=n.j-i;i=n.j,s[0]+=h*u}if(i>=a?i=0:(s[0]+=4*n.v,n.ka=i-n.j,n.U=n.va-n.v,n.T=a-i,i=1),i){if(l=l[0],11>(i=e.ca).S){var c=i.f.RGBA,d=(a=i.S,s=n.U,n=n.T,h=c.eb,c.A),p=n;for(c=c.fb+e.Ma*c.A;0<p--;){var f=l,m=s,g=h,y=c;switch(a){case ii:rL(o,f,m,g,y);break;case ia:rO(o,f,m,g,y);break;case ic:rO(o,f,m,g,y),r0(g,y,0,m,1,0);break;case is:rN(o,f,m,g,y);break;case io:et(o,f,m,g,y,1);break;case id:et(o,f,m,g,y,1),r0(g,y,0,m,1,0);break;case il:et(o,f,m,g,y,0);break;case ip:et(o,f,m,g,y,0),r0(g,y,1,m,1,0);break;case iu:rM(o,f,m,g,y);break;case im:rM(o,f,m,g,y),r1(g,y,m,1,0);break;case ih:rk(o,f,m,g,y);break;default:t(0)}l+=u,c+=d}e.Ma+=n}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=i.height)}}e.C=r,t(e.C<=e.i)}function ew(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var r=e.Ya[t].G,i=e.Ya[t].H;if(0<r[1][i[1]+0].g||0<r[2][i[2]+0].g||0<r[3][i[3]+0].g)return 0}return 1}function eE(e,r,i,a,s,n){if(0!=e.Z){var o=e.qd,l=e.rd;for(t(null!=iz[e.Z]);r<i;++r)iz[e.Z](o,l,a,s,a,s,n),o=a,l=s,s+=n;e.qd=o,e.rd=l}}function eA(e,r){var i=e.l.ma,a=0==i.Z||1==i.Z?e.l.j:e.C;if(a=e.C<a?a:e.C,t(r<=e.l.o),r>a){var s=e.l.width,n=i.ca,o=i.tb+s*a,l=e.V,u=e.Ba+e.c*a,h=e.gc;t(1==e.ab),t(3==h[0].hc),rC(h[0],a,r,l,u,n,o),eE(i,a,r,n,o,s)}e.C=e.Ma=r}function eT(e,r,i,a,s,n,o){var l=e.$/a,u=e.$%a,h=e.m,c=e.s,d=i+e.$,p=d;s=i+a*s;var f=i+a*n,m=280+c.ua,g=e.Pb?l:16777216,y=0<c.ua?c.Wa:null,v=c.wc,_=d<f?ex(c,u,l):null;t(e.C<n),t(f<=s);var x=!1;i:for(;;){for(;x||d<f;){var b=0;if(l>=g){var T=d-i;t((g=e).Pb),g.wd=g.m,g.xd=T,0<g.s.ua&&k(g.s.Wa,g.s.vb),g=l+iw}if(u&v||(_=ex(c,u,l)),t(null!=_),_.Qb&&(r[d]=_.qb,x=!0),!x){if(A(h),_.jc){b=h,T=r;var C=d,P=_.pd[S(b)&rg-1];t(_.jc),256>P.g?(E(b,b.u+P.g),T[C]=P.value,b=0):(E(b,b.u+P.g-256),t(256<=P.value),b=P.value),0==b&&(x=!0)}else b=ev(_.G[0],_.H[0],h)}if(h.h)break;if(x||256>b){if(!x){if(_.nd)r[d]=(_.qb|b<<8)>>>0;else{if(A(h),x=ev(_.G[1],_.H[1],h),A(h),T=ev(_.G[2],_.H[2],h),C=ev(_.G[3],_.H[3],h),h.h)break;r[d]=(C<<24|x<<16|b<<8|T)>>>0}}if(x=!1,++d,++u>=a&&(u=0,++l,null!=o&&l<=n&&!(l%16)&&o(e,l),null!=y))for(;p<d;)b=r[p++],y.X[(506832829*b&4294967295)>>>y.Mb]=b}else if(280>b){if(b=eg(b-256,h),T=ev(_.G[4],_.H[4],h),A(h),T=ey(a,T=eg(T,h)),h.h)break;if(d-i<T||s-d<b)break i;for(C=0;C<b;++C)r[d+C]=r[d+C-T];for(d+=b,u+=b;u>=a;)u-=a,++l,null!=o&&l<=n&&!(l%16)&&o(e,l);if(t(d<=s),u&v&&(_=ex(c,u,l)),null!=y)for(;p<d;)b=r[p++],y.X[(506832829*b&4294967295)>>>y.Mb]=b}else{if(!(b<m))break i;for(x=b-280,t(null!=y);p<d;)b=r[p++],y.X[(506832829*b&4294967295)>>>y.Mb]=b;b=d,t(!(x>>>(T=y).Xa)),r[b]=T.X[x],x=!0}x||t(h.h==w(h))}if(e.Pb&&h.h&&d<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&k(e.s.vb,e.s.Wa);else{if(h.h)break;null!=o&&o(e,l>n?n:l),e.a=0,e.$=d-i}return 1}return e.a=3,0}function eC(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var r=e.Wa;null!=r&&(r.X=null),e.vb=null,t(null!=e)}function eP(){var t=new t$;return null==t?null:(t.a=0,t.xb=iG,er("Predictor","VP8LPredictors"),er("Predictor","VP8LPredictors_C"),er("PredictorAdd","VP8LPredictorsAdd"),er("PredictorAdd","VP8LPredictorsAdd_C"),rE=V,rI=W,rL=X,rO=K,rM=J,rk=Q,rN=ee,e.VP8LMapColor32b=rT,e.VP8LMapColor8b=rP,t)}function eR(e,r,i,o,l){for(var u=1,d=[e],f=[r],m=o.m,g=o.s,y=null,v=0;;){if(i)for(;u&&_(m,1);){var x=d,b=f,w=1,T=o.m,C=o.gc[o.ab],P=_(T,2);if(o.Oc&1<<P)u=0;else{switch(o.Oc|=1<<P,C.hc=P,C.Ea=x[0],C.nc=b[0],C.K=[null],++o.ab,t(4>=o.ab),P){case 0:case 1:C.b=_(T,3)+2,w=eR(F(C.Ea,C.b),F(C.nc,C.b),0,o,C.K),C.K=C.K[0];break;case 3:var R,I=_(T,8)+1,L=16<I?0:4<I?1:2<I?2:3;if(x[0]=F(C.Ea,L),C.b=L,R=w=eR(I,1,0,o,C.K)){var O,k=1<<(8>>C.b),N=s(k);if(null==N)R=0;else{var D=C.K[0],z=C.w;for(N[0]=C.K[0][0],O=1;O<1*I;++O)N[O]=G(D[z+O],N[O-1]);for(;O<4*k;++O)N[O]=0;C.K[0]=null,C.K[0]=N,R=1}}w=R;break;case 2:break;default:t(0)}u=w}}if(d=d[0],f=f[0],u&&_(m,1)&&!(u=1<=(v=_(m,4))&&11>=v)){o.a=3;break}if(q=u)a:{var q,j,B,U,H=d,Z=f,V=v,Y=o.m,W=o.s,$=[null],X=1,K=0,J=iS[V];s:for(;;){if(i&&_(Y,1)){var Q=_(Y,3)+2,ee=F(H,Q),et=F(Z,Q),er=ee*et;if(!eR(ee,et,0,o,$))break;for($=$[0],W.xc=Q,j=0;j<er;++j){var ei=$[j]>>8&65535;$[j]=ei,ei>=X&&(X=ei+1)}}if(Y.h)break;for(B=0;5>B;++B){var ea=iv[B];!B&&0<V&&(ea+=1<<V),K<ea&&(K=ea)}var es=n(X*J,c),en=X,eo=n(en,p);if(null==eo)var el=null;else t(65536>=en),el=eo;var eu=s(K);if(null==el||null==eu||null==es){o.a=1;break}for(j=U=0;j<X;++j){var eh,ec=el[j],ed=ec.G,ep=ec.H,ef=0,em=1,eg=0;for(B=0;5>B;++B){ea=iv[B],ed[B]=es,ep[B]=U,!B&&0<V&&(ea+=1<<V);n:{var ey,ev=ea,ex=U,eb=0,eS=o.m,ew=_(eS,1);if(a(eu,0,0,ev),ew){var eE=_(eS,1)+1,eA=_(eS,1),eP=_(eS,0==eA?1:8);eu[eP]=1,2==eE&&(eu[eP=_(eS,8)]=1);var eI=1}else{var eL=s(19),eO=_(eS,4)+4;if(19<eO){o.a=3;var eM=0;break n}for(ey=0;ey<eO;++ey)eL[ix[ey]]=_(eS,3);var ek=void 0,eN=void 0,eD=0,eF=o.m,eG=8,ez=n(128,c);o:for(;h(ez,0,7,eL,19);){if(_(eF,1)){var eq=2+2*_(eF,3);if((ek=2+_(eF,eq))>ev)break}else ek=ev;for(eN=0;eN<ev&&ek--;){A(eF);var ej=ez[0+(127&S(eF))];E(eF,eF.u+ej.g);var eB=ej.value;if(16>eB)eu[eN++]=eB,0!=eB&&(eG=eB);else{var eU=16==eB,eH=eB-16,eZ=iy[eH],eV=_(eF,ig[eH])+eZ;if(eN+eV>ev)break o;for(var eY=eU?eG:0;0<eV--;)eu[eN++]=eY}}eD=1;break}eD||(o.a=3),eI=eD}(eI=eI&&!eS.h)&&(eb=h(es,ex,8,eu,ev)),eI&&0!=eb?eM=eb:(o.a=3,eM=0)}if(0==eM)break s;if(em&&1==i_[B]&&(em=0==es[U].g),ef+=es[U].g,U+=eM,3>=B){var eW,e$=eu[0];for(eW=1;eW<ea;++eW)eu[eW]>e$&&(e$=eu[eW]);eg+=e$}}if(ec.nd=em,ec.Qb=0,em&&(ec.qb=(ed[3][ep[3]+0].value<<24|ed[1][ep[1]+0].value<<16|ed[2][ep[2]+0].value)>>>0,0==ef&&256>ed[0][ep[0]+0].value&&(ec.Qb=1,ec.qb+=ed[0][ep[0]+0].value<<8)),ec.jc=!ec.Qb&&6>eg,ec.jc)for(eh=0;eh<rg;++eh){var eX=eh,eK=ec.pd[eX],eJ=ec.G[0][ec.H[0]+eX];256<=eJ.value?(eK.g=eJ.g+256,eK.value=eJ.value):(eK.g=0,eK.value=0,eX>>=e_(eJ,8,eK),eX>>=e_(ec.G[1][ec.H[1]+eX],16,eK),eX>>=e_(ec.G[2][ec.H[2]+eX],0,eK),e_(ec.G[3][ec.H[3]+eX],24,eK))}}W.vc=$,W.Wb=X,W.Ya=el,W.yc=es,q=1;break a}q=0}if(!(u=q)){o.a=3;break}if(0<v){if(g.ua=1<<v,!M(g.Wa,v)){o.a=1,u=0;break}}else g.ua=0;var eQ=d,e0=f,e1=o.s,e2=e1.xc;if(o.c=eQ,o.i=e0,e1.md=F(eQ,e2),e1.wc=0==e2?-1:(1<<e2)-1,i){o.xb=iF;break}if(null==(y=s(d*f))){o.a=1,u=0;break}u=(u=eT(o,y,0,d,f,f,null))&&!m.h;break}return u?(null!=l?l[0]=y:(t(null==y),t(i)),o.$=0,i||eC(g)):eC(g),u}function eI(e,r){var i=e.c*e.i;return t(e.c<=r),e.V=s(i+r+16*r),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+i+r,1)}function eL(e,r){var i=e.C,a=r-i,s=e.V,n=e.Ba+e.c*i;for(t(r<=e.l.o);0<a;){var o=16<a?16:a,l=e.l.ma,u=e.l.width,h=u*o,c=l.ca,d=l.tb+u*i,p=e.Ta,f=e.Ua;eb(e,o,s,n),r5(p,f,c,d,h),eE(l,i,i+o,c,d,u),a-=o,s+=o*e.c,i+=o}t(i==r),e.C=e.Ma=r}function eO(){this.ub=this.yd=this.td=this.Rb=0}function eM(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ek(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function eN(){var e;this.Yb=(function e(t,r,i){for(var a=i[r],s=0;s<a&&(t.push(i.length>r+1?[]:0),!(i.length<r+1));s++)e(t[s],r+1,i)}(e=[],0,[3,11]),e)}function eD(){this.jb=s(3),this.Wc=o([4,8],eN),this.Xc=o([4,17],eN)}function eF(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function eG(){this.ld=this.La=this.dd=this.tc=0}function ez(){this.Na=this.la=0}function eq(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ej(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function eB(){this.uc=this.M=this.Nb=0,this.wa=Array(new eG),this.Y=0,this.ya=Array(new ej),this.aa=0,this.l=new eV}function eU(){this.y=s(16),this.f=s(8),this.ea=s(8)}function eH(){this.cb=this.a=0,this.sc="",this.m=new x,this.Od=new eO,this.Kc=new eM,this.ed=new eF,this.Qa=new ek,this.Ic=this.$c=this.Aa=0,this.D=new eB,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=n(8,x),this.ia=0,this.pb=n(4,eq),this.Pa=new eD,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new eU),this.Hd=0,this.rb=Array(new ez),this.sb=0,this.wa=Array(new eG),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ej),this.L=this.aa=0,this.gd=o([4,2],eG),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function eZ(e,t){return 0>e?0:e>t?t:e}function eV(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function eY(){var e=new eH;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,iT||(iT=eK)),e}function eW(e,t,r){return 0==e.a&&(e.a=t,e.sc=r,e.cb=0),0}function e$(e,t,r){return 3<=r&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function eX(e,r){if(null==e)return 0;if(e.a=0,e.sc="OK",null==r)return eW(e,2,"null VP8Io passed to VP8GetHeaders()");var i=r.data,s=r.w,n=r.ha;if(4>n)return eW(e,7,"Truncated header.");var o=i[s+0]|i[s+1]<<8|i[s+2]<<16,l=e.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return eW(e,3,"Incorrect keyframe parameters.");if(!l.yd)return eW(e,4,"Frame not displayable.");s+=3,n-=3;var u=e.Kc;if(l.Rb){if(7>n)return eW(e,7,"cannot parse picture header");if(!e$(i,s,n))return eW(e,3,"Bad code word");u.c=16383&(i[s+4]<<8|i[s+3]),u.Td=i[s+4]>>6,u.i=16383&(i[s+6]<<8|i[s+5]),u.Ud=i[s+6]>>6,s+=7,n-=7,e.za=u.c+15>>4,e.Ub=u.i+15>>4,r.width=u.c,r.height=u.i,r.Da=0,r.j=0,r.v=0,r.va=r.width,r.o=r.height,r.da=0,r.ib=r.width,r.hb=r.height,r.U=r.width,r.T=r.height,a((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,a(o.Zb,0,0,o.Zb.length),a(o.Lb,0,0,o.Lb)}if(l.ub>n)return eW(e,7,"bad partition length");f(o=e.m,i,s,l.ub),s+=l.ub,n-=l.ub,l.Rb&&(u.Ld=C(o),u.Kd=C(o)),u=e.Qa;var h,c=e.Pa;if(t(null!=o),t(null!=u),u.Cb=C(o),u.Cb){if(u.Bb=C(o),C(o)){for(u.Fb=C(o),h=0;4>h;++h)u.Zb[h]=C(o)?g(o,7):0;for(h=0;4>h;++h)u.Lb[h]=C(o)?g(o,6):0}if(u.Bb)for(h=0;3>h;++h)c.jb[h]=C(o)?m(o,8):255}else u.Bb=0;if(o.Ka)return eW(e,3,"cannot parse segment header");if((u=e.ed).zd=C(o),u.Tb=m(o,6),u.wb=m(o,3),u.Pc=C(o),u.Pc&&C(o)){for(c=0;4>c;++c)C(o)&&(u.vd[c]=g(o,6));for(c=0;4>c;++c)C(o)&&(u.od[c]=g(o,6))}if(e.L=0==u.Tb?0:u.zd?1:2,o.Ka)return eW(e,3,"cannot parse filter header");var d=n;if(n=h=s,s=h+d,u=d,e.Xb=(1<<m(e.m,2))-1,d<3*(c=e.Xb))i=7;else{for(h+=3*c,u-=3*c,d=0;d<c;++d){var p=i[n+0]|i[n+1]<<8|i[n+2]<<16;p>u&&(p=u),f(e.Jc[+d],i,h,p),h+=p,u-=p,n+=3}f(e.Jc[+c],i,h,u),i=h<s?0:5}if(0!=i)return eW(e,i,"cannot parse partitions");for(i=m(h=e.m,7),n=C(h)?g(h,4):0,s=C(h)?g(h,4):0,u=C(h)?g(h,4):0,c=C(h)?g(h,4):0,h=C(h)?g(h,4):0,d=e.Qa,p=0;4>p;++p){if(d.Cb){var y=d.Zb[p];d.Fb||(y+=i)}else{if(0<p){e.pb[p]=e.pb[0];continue}y=i}var v=e.pb[p];v.Sc[0]=iE[eZ(y+n,127)],v.Sc[1]=iA[eZ(y+0,127)],v.Eb[0]=2*iE[eZ(y+s,127)],v.Eb[1]=101581*iA[eZ(y+u,127)]>>16,8>v.Eb[1]&&(v.Eb[1]=8),v.Qc[0]=iE[eZ(y+c,117)],v.Qc[1]=iA[eZ(y+h,127)],v.lc=y+h}if(!l.Rb)return eW(e,4,"Not a key frame.");for(C(o),l=e.Pa,i=0;4>i;++i){for(n=0;8>n;++n)for(s=0;3>s;++s)for(u=0;11>u;++u)c=P(o,iO[i][n][s][u])?m(o,8):iI[i][n][s][u],l.Wc[i][n].Yb[s][u]=c;for(n=0;17>n;++n)l.Xc[i][n]=l.Wc[i][iM[n]]}return e.kc=C(o),e.kc&&(e.Bd=m(o,8)),e.cb=1}function eK(e,t,r,i,a,s,n){var o=t[a].Yb[r];for(r=0;16>a;++a){if(!P(e,o[r+0]))return a;for(;!P(e,o[r+1]);)if(o=t[++a].Yb[0],r=0,16==a)return 16;var l=t[a+1].Yb;if(P(e,o[r+2])){var u=e,h=0;if(P(u,(d=o)[(c=r)+3])){if(P(u,d[c+6])){for(o=0,c=2*(h=P(u,d[c+8]))+(d=P(u,d[c+9+h])),h=0,d=iC[c];d[o];++o)h+=h+P(u,d[o]);h+=3+(8<<c)}else h=P(u,d[c+7])?7+2*P(u,165)+P(u,145):5+P(u,159)}else h=P(u,d[c+4])?3+P(u,d[c+5]):2;o=l[2]}else h=1,o=l[1];l=n+iP[a],0>(u=e).b&&T(u);var c,d=u.b,p=(c=u.Ca>>1)-(u.I>>d)>>31;--u.b,u.Ca+=p,u.Ca|=1,u.I-=(c+1&p)<<d,s[l]=((h^p)-p)*i[(0<a)+0]}return 16}function eJ(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,a(e.zc,0,0,e.zc.length),e.ja=0}function eQ(e,t,r,i,a){a=e[t+r+32*i]+(a>>3),e[t+r+32*i]=-256&a?0>a?0:255:a}function e0(e,t,r,i,a,s){eQ(e,t,0,r,i+a),eQ(e,t,1,r,i+s),eQ(e,t,2,r,i-s),eQ(e,t,3,r,i-a)}function e1(e){return(20091*e>>16)+e}function e2(e,t,r,i){var a,n=0,o=s(16);for(a=0;4>a;++a){var l=e[t+0]+e[t+8],u=e[t+0]-e[t+8],h=(35468*e[t+4]>>16)-e1(e[t+12]),c=e1(e[t+4])+(35468*e[t+12]>>16);o[n+0]=l+c,o[n+1]=u+h,o[n+2]=u-h,o[n+3]=l-c,n+=4,t++}for(a=n=0;4>a;++a)l=(e=o[n+0]+4)+o[n+8],u=e-o[n+8],h=(35468*o[n+4]>>16)-e1(o[n+12]),eQ(r,i,0,0,l+(c=e1(o[n+4])+(35468*o[n+12]>>16))),eQ(r,i,1,0,u+h),eQ(r,i,2,0,u-h),eQ(r,i,3,0,l-c),n++,i+=32}function e5(e,t,r,i){var a=e[t+0]+4,s=35468*e[t+4]>>16,n=e1(e[t+4]),o=35468*e[t+1]>>16;e0(r,i,0,a+n,e=e1(e[t+1]),o),e0(r,i,1,a+s,e,o),e0(r,i,2,a-s,e,o),e0(r,i,3,a-n,e,o)}function e3(e,t,r,i,a){e2(e,t,r,i),a&&e2(e,t+16,r,i+4)}function e4(e,t,r,i){rF(e,t+0,r,i,1),rF(e,t+32,r,i+128,1)}function e6(e,t,r,i){var a;for(e=e[t+0]+4,a=0;4>a;++a)for(t=0;4>t;++t)eQ(r,i,t,a,e)}function e8(e,t,r,i){e[t+0]&&rq(e,t+0,r,i),e[t+16]&&rq(e,t+16,r,i+4),e[t+32]&&rq(e,t+32,r,i+128),e[t+48]&&rq(e,t+48,r,i+128+4)}function e7(e,t,r,i){var a,n=s(16);for(a=0;4>a;++a){var o=e[t+0+a]+e[t+12+a],l=e[t+4+a]+e[t+8+a],u=e[t+4+a]-e[t+8+a],h=e[t+0+a]-e[t+12+a];n[0+a]=o+l,n[8+a]=o-l,n[4+a]=h+u,n[12+a]=h-u}for(a=0;4>a;++a)o=(e=n[0+4*a]+3)+n[3+4*a],l=n[1+4*a]+n[2+4*a],u=n[1+4*a]-n[2+4*a],h=e-n[3+4*a],r[i+0]=o+l>>3,r[i+16]=h+u>>3,r[i+32]=o-l>>3,r[i+48]=h-u>>3,i+=64}function e9(e,t,r){var i,a=t-32,s=255-e[a-1];for(i=0;i<r;++i){var n,o=s+e[t-1];for(n=0;n<r;++n)e[t+n]=it[o+e[a+n]];t+=32}}function te(e,t){e9(e,t,4)}function tt(e,t){e9(e,t,8)}function tr(e,t){e9(e,t,16)}function ti(e,t){var r;for(r=0;16>r;++r)i(e,t+32*r,e,t-32,16)}function ta(e,t){var r;for(r=16;0<r;--r)a(e,t,e[t-1],16),t+=32}function ts(e,t,r){var i;for(i=0;16>i;++i)a(t,r+32*i,e,16)}function tn(e,t){var r,i=16;for(r=0;16>r;++r)i+=e[t-1+32*r]+e[t+r-32];ts(i>>5,e,t)}function to(e,t){var r,i=8;for(r=0;16>r;++r)i+=e[t-1+32*r];ts(i>>4,e,t)}function tl(e,t){var r,i=8;for(r=0;16>r;++r)i+=e[t+r-32];ts(i>>4,e,t)}function tu(e,t){ts(128,e,t)}function th(e,t,r){return e+2*t+r+2>>2}function tc(e,t){var r,a=t-32;for(r=0,a=new Uint8Array([th(e[a-1],e[a+0],e[a+1]),th(e[a+0],e[a+1],e[a+2]),th(e[a+1],e[a+2],e[a+3]),th(e[a+2],e[a+3],e[a+4])]);4>r;++r)i(e,t+32*r,a,0,a.length)}function td(e,t){var r=e[t-1],i=e[t-1+32],a=e[t-1+64],s=e[t-1+96];R(e,t+0,16843009*th(e[t-1-32],r,i)),R(e,t+32,16843009*th(r,i,a)),R(e,t+64,16843009*th(i,a,s)),R(e,t+96,16843009*th(a,s,s))}function tp(e,t){var r,i=4;for(r=0;4>r;++r)i+=e[t+r-32]+e[t-1+32*r];for(i>>=3,r=0;4>r;++r)a(e,t+32*r,i,4)}function tf(e,t){var r=e[t-1+0],i=e[t-1+32],a=e[t-1+64],s=e[t-1-32],n=e[t+0-32],o=e[t+1-32],l=e[t+2-32],u=e[t+3-32];e[t+0+96]=th(i,a,e[t-1+96]),e[t+1+96]=e[t+0+64]=th(r,i,a),e[t+2+96]=e[t+1+64]=e[t+0+32]=th(s,r,i),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=th(n,s,r),e[t+3+64]=e[t+2+32]=e[t+1+0]=th(o,n,s),e[t+3+32]=e[t+2+0]=th(l,o,n),e[t+3+0]=th(u,l,o)}function tm(e,t){var r=e[t+1-32],i=e[t+2-32],a=e[t+3-32],s=e[t+4-32],n=e[t+5-32],o=e[t+6-32],l=e[t+7-32];e[t+0+0]=th(e[t+0-32],r,i),e[t+1+0]=e[t+0+32]=th(r,i,a),e[t+2+0]=e[t+1+32]=e[t+0+64]=th(i,a,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=th(a,s,n),e[t+3+32]=e[t+2+64]=e[t+1+96]=th(s,n,o),e[t+3+64]=e[t+2+96]=th(n,o,l),e[t+3+96]=th(o,l,l)}function tg(e,t){var r=e[t-1+0],i=e[t-1+32],a=e[t-1+64],s=e[t-1-32],n=e[t+0-32],o=e[t+1-32],l=e[t+2-32],u=e[t+3-32];e[t+0+0]=e[t+1+64]=s+n+1>>1,e[t+1+0]=e[t+2+64]=n+o+1>>1,e[t+2+0]=e[t+3+64]=o+l+1>>1,e[t+3+0]=l+u+1>>1,e[t+0+96]=th(a,i,r),e[t+0+64]=th(i,r,s),e[t+0+32]=e[t+1+96]=th(r,s,n),e[t+1+32]=e[t+2+96]=th(s,n,o),e[t+2+32]=e[t+3+96]=th(n,o,l),e[t+3+32]=th(o,l,u)}function ty(e,t){var r=e[t+0-32],i=e[t+1-32],a=e[t+2-32],s=e[t+3-32],n=e[t+4-32],o=e[t+5-32],l=e[t+6-32],u=e[t+7-32];e[t+0+0]=r+i+1>>1,e[t+1+0]=e[t+0+64]=i+a+1>>1,e[t+2+0]=e[t+1+64]=a+s+1>>1,e[t+3+0]=e[t+2+64]=s+n+1>>1,e[t+0+32]=th(r,i,a),e[t+1+32]=e[t+0+96]=th(i,a,s),e[t+2+32]=e[t+1+96]=th(a,s,n),e[t+3+32]=e[t+2+96]=th(s,n,o),e[t+3+64]=th(n,o,l),e[t+3+96]=th(o,l,u)}function tv(e,t){var r=e[t-1+0],i=e[t-1+32],a=e[t-1+64],s=e[t-1+96];e[t+0+0]=r+i+1>>1,e[t+2+0]=e[t+0+32]=i+a+1>>1,e[t+2+32]=e[t+0+64]=a+s+1>>1,e[t+1+0]=th(r,i,a),e[t+3+0]=e[t+1+32]=th(i,a,s),e[t+3+32]=e[t+1+64]=th(a,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function t_(e,t){var r=e[t-1+0],i=e[t-1+32],a=e[t-1+64],s=e[t-1+96],n=e[t-1-32],o=e[t+0-32],l=e[t+1-32],u=e[t+2-32];e[t+0+0]=e[t+2+32]=r+n+1>>1,e[t+0+32]=e[t+2+64]=i+r+1>>1,e[t+0+64]=e[t+2+96]=a+i+1>>1,e[t+0+96]=s+a+1>>1,e[t+3+0]=th(o,l,u),e[t+2+0]=th(n,o,l),e[t+1+0]=e[t+3+32]=th(r,n,o),e[t+1+32]=e[t+3+64]=th(i,r,n),e[t+1+64]=e[t+3+96]=th(a,i,r),e[t+1+96]=th(s,a,i)}function tx(e,t){var r;for(r=0;8>r;++r)i(e,t+32*r,e,t-32,8)}function tb(e,t){var r;for(r=0;8>r;++r)a(e,t,e[t-1],8),t+=32}function tS(e,t,r){var i;for(i=0;8>i;++i)a(t,r+32*i,e,8)}function tw(e,t){var r,i=8;for(r=0;8>r;++r)i+=e[t+r-32]+e[t-1+32*r];tS(i>>4,e,t)}function tE(e,t){var r,i=4;for(r=0;8>r;++r)i+=e[t+r-32];tS(i>>3,e,t)}function tA(e,t){var r,i=4;for(r=0;8>r;++r)i+=e[t-1+32*r];tS(i>>3,e,t)}function tT(e,t){tS(128,e,t)}function tC(e,t,r){var i=e[t-r],a=e[t+0],s=3*(a-i)+r9[1020+e[t-2*r]-e[t+r]],n=ie[112+(s+4>>3)];e[t-r]=it[255+i+ie[112+(s+3>>3)]],e[t+0]=it[255+a-n]}function tP(e,t,r,i){var a=e[t+0],s=e[t+r];return ir[255+e[t-2*r]-e[t-r]]>i||ir[255+s-a]>i}function tR(e,t,r,i){return 4*ir[255+e[t-r]-e[t+0]]+ir[255+e[t-2*r]-e[t+r]]<=i}function tI(e,t,r,i,a){var s=e[t-3*r],n=e[t-2*r],o=e[t-r],l=e[t+0],u=e[t+r],h=e[t+2*r],c=e[t+3*r];return 4*ir[255+o-l]+ir[255+n-u]>i?0:ir[255+e[t-4*r]-s]<=a&&ir[255+s-n]<=a&&ir[255+n-o]<=a&&ir[255+c-h]<=a&&ir[255+h-u]<=a&&ir[255+u-l]<=a}function tL(e,t,r,i){var a=2*i+1;for(i=0;16>i;++i)tR(e,t+i,r,a)&&tC(e,t+i,r)}function tO(e,t,r,i){var a=2*i+1;for(i=0;16>i;++i)tR(e,t+i*r,1,a)&&tC(e,t+i*r,1)}function tM(e,t,r,i){var a;for(a=3;0<a;--a)tL(e,t+=4*r,r,i)}function tk(e,t,r,i){var a;for(a=3;0<a;--a)tO(e,t+=4,r,i)}function tN(e,t,r,i,a,s,n,o){for(s=2*s+1;0<a--;){if(tI(e,t,r,s,n)){if(tP(e,t,r,o))tC(e,t,r);else{var l=t,u=e[l-2*r],h=e[l-r],c=e[l+0],d=e[l+r],p=e[l+2*r],f=27*(g=r9[1020+3*(c-h)+r9[1020+u-d]])+63>>7,m=18*g+63>>7,g=9*g+63>>7;e[l-3*r]=it[255+e[l-3*r]+g],e[l-2*r]=it[255+u+m],e[l-r]=it[255+h+f],e[l+0]=it[255+c-f],e[l+r]=it[255+d-m],e[l+2*r]=it[255+p-g]}}t+=i}}function tD(e,t,r,i,a,s,n,o){for(s=2*s+1;0<a--;){if(tI(e,t,r,s,n)){if(tP(e,t,r,o))tC(e,t,r);else{var l=t,u=e[l-r],h=e[l+0],c=e[l+r],d=ie[112+((p=3*(h-u))+4>>3)],p=ie[112+(p+3>>3)],f=d+1>>1;e[l-2*r]=it[255+e[l-2*r]+f],e[l-r]=it[255+u+p],e[l+0]=it[255+h-d],e[l+r]=it[255+c-f]}}t+=i}}function tF(e,t,r,i,a,s){tN(e,t,r,1,16,i,a,s)}function tG(e,t,r,i,a,s){tN(e,t,1,r,16,i,a,s)}function tz(e,t,r,i,a,s){var n;for(n=3;0<n;--n)tD(e,t+=4*r,r,1,16,i,a,s)}function tq(e,t,r,i,a,s){var n;for(n=3;0<n;--n)tD(e,t+=4,1,r,16,i,a,s)}function tj(e,t,r,i,a,s,n,o){tN(e,t,a,1,8,s,n,o),tN(r,i,a,1,8,s,n,o)}function tB(e,t,r,i,a,s,n,o){tN(e,t,1,a,8,s,n,o),tN(r,i,1,a,8,s,n,o)}function tU(e,t,r,i,a,s,n,o){tD(e,t+4*a,a,1,8,s,n,o),tD(r,i+4*a,a,1,8,s,n,o)}function tH(e,t,r,i,a,s,n,o){tD(e,t+4,1,a,8,s,n,o),tD(r,i+4,1,a,8,s,n,o)}function tZ(){this.ba=new en,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new el,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function tV(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tY(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function tW(){this.ua=0,this.Wa=new N,this.vb=new N,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new c}function t$(){this.xb=this.a=0,this.l=new eV,this.ca=new en,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new b,this.Pb=0,this.wd=new b,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new tW,this.ab=0,this.gc=n(4,tY),this.Oc=0}function tX(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new eV,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function tK(e,t,r,i,a,s,n){for(e=null==e?0:e[t+0],t=0;t<n;++t)a[s+t]=e+r[i+t]&255,e=a[s+t]}function tJ(e,t,r,i,a,s,n){var o;if(null==e)tK(null,null,r,i,a,s,n);else for(o=0;o<n;++o)a[s+o]=e[t+o]+r[i+o]&255}function tQ(e,t,r,i,a,s,n){if(null==e)tK(null,null,r,i,a,s,n);else{var o,l=e[t+0],u=l,h=l;for(o=0;o<n;++o)u=h+(l=e[t+o])-u,h=r[i+o]+(-256&u?0>u?0:255:u)&255,u=l,a[s+o]=h}}function t0(e,t,r,i,a,s){for(;0<a--;){var n,o=t+(r?1:0),l=t+(r?0:3);for(n=0;n<i;++n){var u=e[l+4*n];255!=u&&(u*=32897,e[o+4*n+0]=e[o+4*n+0]*u>>23,e[o+4*n+1]=e[o+4*n+1]*u>>23,e[o+4*n+2]=e[o+4*n+2]*u>>23)}t+=s}}function t1(e,t,r,i,a){for(;0<i--;){var s;for(s=0;s<r;++s){var n=e[t+2*s+0],o=15&(u=e[t+2*s+1]),l=4369*o,u=(240&u|u>>4)*l>>16;e[t+2*s+0]=(240&n|n>>4)*l>>16&240|(15&n|n<<4)*l>>16>>4&15,e[t+2*s+1]=240&u|o}t+=a}}function t2(e,t,r,i,a,s,n,o){var l,u,h=255;for(u=0;u<a;++u){for(l=0;l<i;++l){var c=e[t+l];s[n+4*l]=c,h&=c}t+=r,n+=o}return 255!=h}function t5(e,t,r,i,a){var s;for(s=0;s<a;++s)r[i+s]=e[t+s]>>8}function t3(){r0=t0,r1=t1,r2=t2,r5=t5}function t4(r,i,a){e[r]=function(e,r,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_){var x,b=_-1>>1,S=o[l+0]|u[h+0]<<16,w=c[d+0]|p[f+0]<<16;t(null!=e);var E=3*S+w+131074>>2;for(i(e[r+0],255&E,E>>16,m,g),null!=s&&(E=3*w+S+131074>>2,i(s[n+0],255&E,E>>16,y,v)),x=1;x<=b;++x){var A=o[l+x]|u[h+x]<<16,T=c[d+x]|p[f+x]<<16,C=S+A+w+T+524296,P=C+2*(A+w)>>3;E=P+S>>1,S=(C=C+2*(S+T)>>3)+A>>1,i(e[r+2*x-1],255&E,E>>16,m,g+(2*x-1)*a),i(e[r+2*x-0],255&S,S>>16,m,g+(2*x-0)*a),null!=s&&(E=C+w>>1,S=P+T>>1,i(s[n+2*x-1],255&E,E>>16,y,v+(2*x-1)*a),i(s[n+2*x+0],255&S,S>>16,y,v+(2*x+0)*a)),S=A,w=T}1&_||(E=3*S+w+131074>>2,i(e[r+_-1],255&E,E>>16,m,g+(_-1)*a),null!=s&&(E=3*w+S+131074>>2,i(s[n+_-1],255&E,E>>16,y,v+(_-1)*a)))}}function t6(){iq[ii]=ij,iq[ia]=iU,iq[is]=iB,iq[io]=iH,iq[il]=iZ,iq[iu]=iV,iq[ih]=iY,iq[ic]=iU,iq[id]=iH,iq[ip]=iZ,iq[im]=iV}function t8(e){return e&~iQ?0>e?0:255:e>>iJ}function t7(e,t){return t8((19077*e>>8)+(26149*t>>8)-14234)}function t9(e,t,r){return t8((19077*e>>8)-(6419*t>>8)-(13320*r>>8)+8708)}function re(e,t){return t8((19077*e>>8)+(33050*t>>8)-17685)}function rt(e,t,r,i,a){i[a+0]=t7(e,r),i[a+1]=t9(e,t,r),i[a+2]=re(e,t)}function rr(e,t,r,i,a){i[a+0]=re(e,t),i[a+1]=t9(e,t,r),i[a+2]=t7(e,r)}function ri(e,t,r,i,a){var s=t9(e,t,r);t=s<<3&224|re(e,t)>>3,i[a+0]=248&t7(e,r)|s>>5,i[a+1]=t}function ra(e,t,r,i,a){var s=240&re(e,t)|15;i[a+0]=240&t7(e,r)|t9(e,t,r)>>4,i[a+1]=s}function rs(e,t,r,i,a){i[a+0]=255,rt(e,t,r,i,a+1)}function rn(e,t,r,i,a){rr(e,t,r,i,a),i[a+3]=255}function ro(e,t,r,i,a){rt(e,t,r,i,a),i[a+3]=255}function eZ(e,t){return 0>e?0:e>t?t:e}function rl(t,r,i){e[t]=function(e,t,a,s,n,o,l,u,h){for(var c=u+(-2&h)*i;u!=c;)r(e[t+0],a[s+0],n[o+0],l,u),r(e[t+1],a[s+0],n[o+0],l,u+i),t+=2,++s,++o,u+=2*i;1&h&&r(e[t+0],a[s+0],n[o+0],l,u)}}function ru(e,t,r){return 0==r?0==e?0==t?6:5:0==t?4:0:r}function rh(e,t,r,i,a){switch(e>>>30){case 3:rF(t,r,i,a,0);break;case 2:rG(t,r,i,a);break;case 1:rq(t,r,i,a)}}function rc(e,t){var r,s,n=t.M,o=t.Nb,l=e.oc,u=e.pc+40,h=e.oc,c=e.pc+584,d=e.oc,p=e.pc+600;for(r=0;16>r;++r)l[u+32*r-1]=129;for(r=0;8>r;++r)h[c+32*r-1]=129,d[p+32*r-1]=129;for(0<n?l[u-1-32]=h[c-1-32]=d[p-1-32]=129:(a(l,u-32-1,127,21),a(h,c-32-1,127,9),a(d,p-32-1,127,9)),s=0;s<e.za;++s){var f=t.ya[t.aa+s];if(0<s){for(r=-1;16>r;++r)i(l,u+32*r-4,l,u+32*r+12,4);for(r=-1;8>r;++r)i(h,c+32*r-4,h,c+32*r+4,4),i(d,p+32*r-4,d,p+32*r+4,4)}var m=e.Gd,g=e.Hd+s,y=f.ad,v=f.Hc;if(0<n&&(i(l,u-32,m[g].y,0,16),i(h,c-32,m[g].f,0,8),i(d,p-32,m[g].ea,0,8)),f.Za){var _=l,x=u-32+16;for(0<n&&(s>=e.za-1?a(_,x,m[g].y[15],4):i(_,x,m[g+1].y,0,4)),r=0;4>r;r++)_[x+128+r]=_[x+256+r]=_[x+384+r]=_[x+0+r];for(r=0;16>r;++r,v<<=2)_=l,x=u+i8[r],iN[f.Ob[r]](_,x),rh(v,y,16*+r,_,x)}else if(ik[_=ru(s,n,f.Ob[0])](l,u),0!=v)for(r=0;16>r;++r,v<<=2)rh(v,y,16*+r,l,u+i8[r]);for(r=f.Gc,iD[_=ru(s,n,f.Dd)](h,c),iD[_](d,p),v=y,_=h,x=c,255&(f=r>>0)&&(170&f?rz(v,256,_,x):rj(v,256,_,x)),f=d,v=p,255&(r>>=8)&&(170&r?rz(y,320,f,v):rj(y,320,f,v)),n<e.Ub-1&&(i(m[g].y,0,l,u+480,16),i(m[g].f,0,h,c+224,8),i(m[g].ea,0,d,p+224,8)),r=8*o*e.B,m=e.sa,g=e.ta+16*s+16*o*e.R,y=e.qa,f=e.ra+8*s+r,v=e.Ha,_=e.Ia+8*s+r,r=0;16>r;++r)i(m,g+r*e.R,l,u+32*r,16);for(r=0;8>r;++r)i(y,f+r*e.B,h,c+32*r,8),i(v,_+r*e.B,d,p+32*r,8)}}function rd(e,i,a,s,n,o,l,u,h){var c=[0],d=[0],p=0,f=null!=h?h.kd:0,m=null!=h?h:new tV;if(null==e||12>a)return 7;m.data=e,m.w=i,m.ha=a,i=[i],a=[a],m.gb=[m.gb];i:{var g=i,v=a,_=m.gb;if(t(null!=e),t(null!=v),t(null!=_),_[0]=0,12<=v[0]&&!r(e,g[0],"RIFF")){if(r(e,g[0]+8,"WEBP")){_=3;break i}var x=O(e,g[0]+4);if(12>x||4294967286<x){_=3;break i}if(f&&x>v[0]-8){_=7;break i}_[0]=x,g[0]+=12,v[0]-=12}_=0}if(0!=_)return _;for(x=0<m.gb[0],a=a[0];;){i:{var S=e;v=i,_=a;var w=c,E=d,A=g=[0];if((P=p=[p])[0]=0,8>_[0])_=7;else{if(!r(S,v[0],"VP8X")){if(10!=O(S,v[0]+4)){_=3;break i}if(18>_[0]){_=7;break i}var T=O(S,v[0]+8),C=1+L(S,v[0]+12);if(2147483648<=C*(S=1+L(S,v[0]+15))){_=3;break i}null!=A&&(A[0]=T),null!=w&&(w[0]=C),null!=E&&(E[0]=S),v[0]+=18,_[0]-=18,P[0]=1}_=0}}if(p=p[0],g=g[0],0!=_)return _;if(v=!!(2&g),!x&&p)return 3;if(null!=o&&(o[0]=!!(16&g)),null!=l&&(l[0]=v),null!=u&&(u[0]=0),l=0,g=0,p&&v&&null==h){_=0;break}if(4>a){_=7;break}if(x&&p||!x&&!p&&!r(e,i[0],"ALPH")){a=[a],m.na=[m.na],m.P=[m.P],m.Sa=[m.Sa];i:{T=e,_=i,x=a;var P=m.gb;w=m.na,E=m.P,A=m.Sa,C=22,t(null!=T),t(null!=x),S=_[0];var R=x[0];for(t(null!=w),t(null!=A),w[0]=null,E[0]=null,A[0]=0;;){if(_[0]=S,x[0]=R,8>R){_=7;break i}var I=O(T,S+4);if(4294967286<I){_=3;break i}var M=8+I+1&-2;if(C+=M,0<P&&C>P){_=3;break i}if(!r(T,S,"VP8 ")||!r(T,S,"VP8L")){_=0;break i}if(R[0]<M){_=7;break i}r(T,S,"ALPH")||(w[0]=T,E[0]=S+8,A[0]=I),S+=M,R-=M}}if(a=a[0],m.na=m.na[0],m.P=m.P[0],m.Sa=m.Sa[0],0!=_)break}a=[a],m.Ja=[m.Ja],m.xa=[m.xa];i:if(P=e,_=i,x=a,w=m.gb[0],E=m.Ja,A=m.xa,S=!r(P,T=_[0],"VP8 "),C=!r(P,T,"VP8L"),t(null!=P),t(null!=x),t(null!=E),t(null!=A),8>x[0])_=7;else{if(S||C){if(P=O(P,T+4),12<=w&&P>w-12){_=3;break i}if(f&&P>x[0]-8){_=7;break i}E[0]=P,_[0]+=8,x[0]-=8,A[0]=C}else A[0]=5<=x[0]&&47==P[T+0]&&!(P[T+4]>>5),E[0]=x[0];_=0}if(a=a[0],m.Ja=m.Ja[0],m.xa=m.xa[0],i=i[0],0!=_)break;if(4294967286<m.Ja)return 3;if(null==u||v||(u[0]=m.xa?2:1),l=[l],g=[g],m.xa){if(5>a){_=7;break}u=l,f=g,v=o,null==e||5>a?e=0:5<=a&&47==e[i+0]&&!(e[i+4]>>5)?(x=[0],P=[0],w=[0],y(E=new b,e,i,a),em(E,x,P,w)?(null!=u&&(u[0]=x[0]),null!=f&&(f[0]=P[0]),null!=v&&(v[0]=w[0]),e=1):e=0):e=0}else{if(10>a){_=7;break}u=g,null==e||10>a||!e$(e,i+3,a-3)?e=0:(f=e[i+0]|e[i+1]<<8|e[i+2]<<16,v=16383&(e[i+7]<<8|e[i+6]),e=16383&(e[i+9]<<8|e[i+8]),1&f||3<(f>>1&7)||!(f>>4&1)||f>>5>=m.Ja||!v||!e?e=0:(l&&(l[0]=v),u&&(u[0]=e),e=1))}if(!e||(l=l[0],g=g[0],p&&(0!=l||0!=g)))return 3;null!=h&&(h[0]=m,h.offset=i-h.w,t(4294967286>i-h.w),t(h.offset==h.ha-a));break}return 0==_||7==_&&p&&null==h?(null!=o&&(o[0]|=null!=m.na&&0<m.na.length),null!=s&&(s[0]=l),null!=n&&(n[0]=g),0):_}function rp(e,t,r){var i=t.width,a=t.height,s=0,n=0,o=i,l=a;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,l=e.bd,s=e.v,n=e.j,11>r||(s&=-2,n&=-2),0>s||0>n||0>=o||0>=l||s+o>i||n+l>a))return 0;if(t.v=s,t.j=n,t.va=s+o,t.o=n+l,t.U=o,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!D(o,l,r=[e.ib],s=[e.hb]))return 0;t.ib=r[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*i/4&&t.hb<3*a/4,t.Kb=0),1}function rf(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function rm(e,t,r,i){if(null==i||0>=e||0>=t)return 2;if(null!=r){if(r.Da){var a=r.cd,n=r.bd,o=-2&r.v,l=-2&r.j;if(0>o||0>l||0>=a||0>=n||o+a>e||l+n>t)return 2;e=a,t=n}if(r.da){if(!D(e,t,a=[r.ib],n=[r.hb]))return 2;e=a[0],t=n[0]}}i.width=e,i.height=t;i:{var u=i.width,h=i.height;if(e=i.S,0>=u||0>=h||!(e>=ii&&13>e))e=2;else{if(0>=i.Rd&&null==i.sd){o=n=a=t=0;var c=(l=u*ae[e])*h;if(11>e||(n=(h+1)/2*(t=(u+1)/2),12==e&&(o=(a=u)*h)),null==(h=s(c+2*n+o))){e=1;break i}i.sd=h,11>e?((u=i.f.RGBA).eb=h,u.fb=0,u.A=l,u.size=c):((u=i.f.kb).y=h,u.O=0,u.fa=l,u.Fd=c,u.f=h,u.N=0+c,u.Ab=t,u.Cd=n,u.ea=h,u.W=0+c+n,u.Db=t,u.Ed=n,12==e&&(u.F=h,u.J=0+c+2*n),u.Tc=o,u.lb=a)}if(t=1,a=i.S,n=i.width,o=i.height,a>=ii&&13>a){if(11>a)t&=(l=Math.abs((e=i.f.RGBA).A))*(o-1)+n<=e.size,t&=l>=n*ae[a],t&=null!=e.eb;else{e=i.f.kb,l=(n+1)/2,c=(o+1)/2,u=Math.abs(e.fa),h=Math.abs(e.Ab);var d=Math.abs(e.Db),p=Math.abs(e.lb),f=p*(o-1)+n;t&=u*(o-1)+n<=e.Fd,t&=h*(c-1)+l<=e.Cd,t=(t&=d*(c-1)+l<=e.Ed)&u>=n&h>=l&d>=l&null!=e.y&null!=e.f&null!=e.ea,12==a&&(t&=p>=n,t&=f<=e.Tc,t&=null!=e.F)}}else t=0;e=t?0:2}}return 0!=e||null!=r&&r.fd&&(e=rf(i)),e}var rg=64,ry=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],rv=24,r_=32,rx=8,rb=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];z("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,r){return t[r+0]},e.Predictor3=function(e,t,r){return t[r+1]},e.Predictor4=function(e,t,r){return t[r-1]},e.Predictor5=function(e,t,r){return j(j(e,t[r+1]),t[r+0])},e.Predictor6=function(e,t,r){return j(e,t[r-1])},e.Predictor7=function(e,t,r){return j(e,t[r+0])},e.Predictor8=function(e,t,r){return j(t[r-1],t[r+0])},e.Predictor9=function(e,t,r){return j(t[r+0],t[r+1])},e.Predictor10=function(e,t,r){return j(j(e,t[r-1]),j(t[r+0],t[r+1]))},e.Predictor11=function(e,t,r){var i=t[r+0];return 0>=H(i>>24&255,e>>24&255,(t=t[r-1])>>24&255)+H(i>>16&255,e>>16&255,t>>16&255)+H(i>>8&255,e>>8&255,t>>8&255)+H(255&i,255&e,255&t)?i:e},e.Predictor12=function(e,t,r){var i=t[r+0];return(B((e>>24&255)+(i>>24&255)-((t=t[r-1])>>24&255))<<24|B((e>>16&255)+(i>>16&255)-(t>>16&255))<<16|B((e>>8&255)+(i>>8&255)-(t>>8&255))<<8|B((255&e)+(255&i)-(255&t)))>>>0},e.Predictor13=function(e,t,r){var i=t[r-1];return(U((e=j(e,t[r+0]))>>24&255,i>>24&255)<<24|U(e>>16&255,i>>16&255)<<16|U(e>>8&255,i>>8&255)<<8|U(e>>0&255,i>>0&255))>>>0};var rS=e.PredictorAdd0;e.PredictorAdd1=Z,z("Predictor2","PredictorAdd2"),z("Predictor3","PredictorAdd3"),z("Predictor4","PredictorAdd4"),z("Predictor5","PredictorAdd5"),z("Predictor6","PredictorAdd6"),z("Predictor7","PredictorAdd7"),z("Predictor8","PredictorAdd8"),z("Predictor9","PredictorAdd9"),z("Predictor10","PredictorAdd10"),z("Predictor11","PredictorAdd11"),z("Predictor12","PredictorAdd12"),z("Predictor13","PredictorAdd13");var rw=e.PredictorAdd2;$("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),$("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var rE,rA=e.ColorIndexInverseTransform,rT=e.MapARGB,rC=e.VP8LColorIndexInverseTransformAlpha,rP=e.MapAlpha,rR=e.VP8LPredictorsAdd=[];rR.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var rI,rL,rO,rM,rk,rN,rD,rF,rG,rz,rq,rj,rB,rU,rH,rZ,rV,rY,rW,r$,rX,rK,rJ,rQ,r0,r1,r2,r5,r3=s(511),r4=s(2041),r6=s(225),r8=s(767),r7=0,r9=r4,ie=r6,it=r8,ir=r3,ii=0,ia=1,is=2,io=3,il=4,iu=5,ih=6,ic=7,id=8,ip=9,im=10,ig=[2,3,7],iy=[3,3,11],iv=[280,256,256,256,40],i_=[0,1,1,1,0],ix=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ib=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],iS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],iw=8,iE=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],iA=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],iT=null,iC=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],iP=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],iR=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],iI=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],iL=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],iO=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],iM=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ik=[],iN=[],iD=[],iF=1,iG=2,iz=[],iq=[];t4("UpsampleRgbLinePair",rt,3),t4("UpsampleBgrLinePair",rr,3),t4("UpsampleRgbaLinePair",ro,4),t4("UpsampleBgraLinePair",rn,4),t4("UpsampleArgbLinePair",rs,4),t4("UpsampleRgba4444LinePair",ra,2),t4("UpsampleRgb565LinePair",ri,2);var ij=e.UpsampleRgbLinePair,iB=e.UpsampleBgrLinePair,iU=e.UpsampleRgbaLinePair,iH=e.UpsampleBgraLinePair,iZ=e.UpsampleArgbLinePair,iV=e.UpsampleRgba4444LinePair,iY=e.UpsampleRgb565LinePair,iW=16,i$=32768,iX=-227,iK=482,iJ=6,iQ=16383,i0=0,i1=s(256),i2=s(256),i5=s(256),i3=s(256),i4=s(iK-iX),i6=s(iK-iX);rl("YuvToRgbRow",rt,3),rl("YuvToBgrRow",rr,3),rl("YuvToRgbaRow",ro,4),rl("YuvToBgraRow",rn,4),rl("YuvToArgbRow",rs,4),rl("YuvToRgba4444Row",ra,2),rl("YuvToRgb565Row",ri,2);var i8=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],i7=[0,2,8],i9=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,r,o,l,u){var h=ia,c=new tZ,d=new en;c.ba=d,d.S=h,d.width=[d.width],d.height=[d.height];var p=d.width,f=d.height,m=new eo;if(null==m||null==e)var g=2;else t(null!=m),g=rd(e,r,o,m.width,m.height,m.Pd,m.Qd,m.format,null);if(0!=g?p=0:(null!=p&&(p[0]=m.width[0]),null!=f&&(f[0]=m.height[0]),p=1),p){d.width=d.width[0],d.height=d.height[0],null!=l&&(l[0]=d.width),null!=u&&(u[0]=d.height);i:{if(l=new eV,(u=new tV).data=e,u.w=r,u.ha=o,u.kd=1,r=[0],t(null!=u),(0==(e=rd(u.data,u.w,u.ha,null,null,null,r,null,u))||7==e)&&r[0]&&(e=4),0==(r=e)){if(t(null!=c),l.data=u.data,l.w=u.w+u.offset,l.ha=u.ha-u.offset,l.put=ep,l.ac=ed,l.bc=ef,l.ma=c,u.xa){if(null==(e=eP())){c=1;break i}if(function(e,r){for(var i=[0],a=[0],s=[0];;){if(null==e)return 0;if(null==r)return e.a=2,0;if(e.l=r,e.a=0,y(e.m,r.data,r.w,r.ha),!em(e.m,i,a,s)){e.a=3;break}if(e.xb=iG,r.width=i[0],r.height=a[0],!eR(i[0],a[0],1,e,null))break;return 1}return t(0!=e.a),0}(e,l)){if(l=0==(r=rm(l.width,l.height,c.Oa,c.ba))){a:{for(l=e;;){if(null==l){l=0;break a}if(t(null!=l.s.yc),t(null!=l.s.Ya),t(0<l.s.Wb),t(null!=(o=l.l)),t(null!=(u=o.ma)),0!=l.xb){if(l.ca=u.ba,l.tb=u.tb,t(null!=l.ca),!rp(u.Oa,o,io)){l.a=2;break}if(!eI(l,o.width)||o.da)break;if((o.da||ei(l.ca.S))&&t3(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=l.ca.f.kb.F&&t3()),l.Pb&&0<l.s.ua&&null==l.s.vb.X&&!M(l.s.vb,l.s.Wa.Xa)){l.a=1;break}l.xb=0}if(!eT(l,l.V,l.Ba,l.c,l.i,o.o,eS))break;u.Dc=l.Ma,l=1;break a}t(0!=l.a),l=0}l=!l}l&&(r=e.a)}else r=e.a}else if((e=new eY).Fa=u.na,e.P=u.P,e.qc=u.Sa,eX(e,l)){if(0==(r=rm(l.width,l.height,c.Oa,c.ba))){if(e.Aa=0,o=c.Oa,t(null!=(u=e)),null!=o){if(0<(p=0>(p=o.Md)?0:100<p?255:255*p/100)){for(f=m=0;4>f;++f)12>(g=u.pb[f]).lc&&(g.ia=p*i9[0>g.lc?0:g.lc]>>3),m|=g.ia;m&&(alert("todo:VP8InitRandom"),u.ia=1)}u.Ga=o.Id,100<u.Ga?u.Ga=100:0>u.Ga&&(u.Ga=0)}(function(e,r){if(null==e)return 0;if(null==r)return eW(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!eX(e,r))return 0;if(t(e.cb),null==r.ac||r.ac(r)){r.ob&&(e.L=0);var o=i7[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=r.v-o>>4,e.zb=r.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=r.o+15+o>>4,e.Hb=r.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l,u=e.ed;for(o=0;4>o;++o){if(e.Qa.Cb){var h=e.Qa.Lb[o];e.Qa.Fb||(h+=u.Tb)}else h=u.Tb;for(l=0;1>=l;++l){var c=e.gd[o][l],d=h;if(u.Pc&&(d+=u.vd[0],l&&(d+=u.od[0])),0<(d=0>d?0:63<d?63:d)){var p=d;0<u.wb&&(p=4<u.wb?p>>2:p>>1)>9-u.wb&&(p=9-u.wb),1>p&&(p=1),c.dd=p,c.tc=2*d+p,c.ld=40<=d?2:15<=d?1:0}else c.tc=0;c.La=l}}}o=0}else eW(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=1);i:{o=e.Ic,u=4*(p=e.za);var f=32*p,m=p+1,g=0<e.L?p*(0<e.Aa?2:1):0,v=(2==e.Aa?2:1)*p;if((c=u+832+(l=3*(16*o+i7[e.L])/2*f)+(h=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=c)o=0;else{if(c>e.Vb){if(e.Vb=0,e.Ec=s(c),e.Fc=0,null==e.Ec){o=eW(e,1,"no memory during frame initialization.");break i}e.Vb=c}c=e.Ec,d=e.Fc,e.Ac=c,e.Bc=d,d+=u,e.Gd=n(f,eU),e.Hd=0,e.rb=n(m+1,ez),e.sb=1,e.wa=g?n(g,eG):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=p),t(!0),e.oc=c,e.pc=d,d+=832,e.ya=n(v,ej),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=p),e.R=16*p,e.B=8*p,p=(f=i7[e.L])*e.R,f=f/2*e.B,e.sa=c,e.ta=d+p,e.qa=e.sa,e.ra=e.ta+16*o*e.R+f,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+f,e.$c=0,d+=l,e.mb=h?c:null,e.nb=h?d:null,t(d+h<=e.Fc+e.Vb),eJ(e),a(e.Ac,e.Bc,0,u),o=1}}if(o){if(r.ka=0,r.y=e.sa,r.O=e.ta,r.f=e.qa,r.N=e.ra,r.ea=e.Ha,r.Vd=e.Ia,r.fa=e.R,r.Rc=e.B,r.F=null,r.J=0,!r7){for(o=-255;255>=o;++o)r3[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)r4[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)r6[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)r8[255+o]=0>o?0:255<o?255:o;r7=1}rD=e7,rF=e3,rz=e4,rq=e6,rj=e8,rG=e5,rB=tF,rU=tG,rH=tj,rZ=tB,rV=tz,rY=tq,rW=tU,r$=tH,rX=tL,rK=tO,rJ=tM,rQ=tk,iN[0]=tp,iN[1]=te,iN[2]=tc,iN[3]=td,iN[4]=tf,iN[5]=tg,iN[6]=tm,iN[7]=ty,iN[8]=t_,iN[9]=tv,ik[0]=tn,ik[1]=tr,ik[2]=ti,ik[3]=ta,ik[4]=to,ik[5]=tl,ik[6]=tu,iD[0]=tw,iD[1]=tt,iD[2]=tx,iD[3]=tb,iD[4]=tA,iD[5]=tE,iD[6]=tT,o=1}else o=0}o&&(o=function(e,r){for(e.M=0;e.M<e.Va;++e.M){var n,o=e.Jc[e.M&e.Xb],l=e.m,u=e;for(n=0;n<u.za;++n){var h=l,c=u,d=c.Ac,p=c.Bc+4*n,f=c.zc,m=c.ya[c.aa+n];if(c.Qa.Bb?m.$b=P(h,c.Pa.jb[0])?2+P(h,c.Pa.jb[2]):P(h,c.Pa.jb[1]):m.$b=0,c.kc&&(m.Ad=P(h,c.Bd)),m.Za=!P(h,145)+0,m.Za){var g=m.Ob,v=0;for(c=0;4>c;++c){var _,x=f[0+c];for(_=0;4>_;++_){x=iL[d[p+_]][x];for(var b=iR[P(h,x[0])];0<b;)b=iR[2*b+P(h,x[b])];x=-b,d[p+_]=x}i(g,v,d,p,4),v+=4,f[0+c]=x}}else x=P(h,156)?P(h,128)?1:3:P(h,163)?2:0,m.Ob[0]=x,a(d,p,x,4),a(f,0,x,4);m.Dd=P(h,142)?P(h,114)?P(h,183)?1:3:2:0}if(u.m.Ka)return eW(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(u=o,h=(l=e).rb[l.sb-1],d=l.rb[l.sb+l.ja],n=l.ya[l.aa+l.ja],p=l.kc?n.Ad:0)h.la=d.la=0,n.Za||(h.Na=d.Na=0),n.Hc=0,n.Gc=0,n.ia=0;else{if(h=d,d=u,p=l.Pa.Xc,f=l.ya[l.aa+l.ja],m=l.pb[f.$b],c=f.ad,g=0,v=l.rb[l.sb-1],x=_=0,a(c,g,0,384),f.Za)var S,E,T=0,C=p[3];else{b=s(16);var R=h.Na+v.Na;if(R=iT(d,p[1],R,m.Eb,0,b,0),h.Na=v.Na=(0<R)+0,1<R)rD(b,0,c,g);else{var I=b[0]+3>>3;for(b=0;256>b;b+=16)c[g+b]=I}T=1,C=p[0]}var L=15&h.la,O=15&v.la;for(b=0;4>b;++b){var M=1&O;for(I=E=0;4>I;++I)L=L>>1|(M=(R=iT(d,C,R=M+(1&L),m.Sc,T,c,g))>T)<<7,E=E<<2|(3<R?3:1<R?2:0!=c[g+0]),g+=16;L>>=4,O=O>>1|M<<7,_=(_<<8|E)>>>0}for(C=L,T=O>>4,S=0;4>S;S+=2){for(E=0,L=h.la>>4+S,O=v.la>>4+S,b=0;2>b;++b){for(M=1&O,I=0;2>I;++I)R=M+(1&L),L=L>>1|(M=0<(R=iT(d,p[2],R,m.Qc,0,c,g)))<<3,E=E<<2|(3<R?3:1<R?2:0!=c[g+0]),g+=16;L>>=2,O=O>>1|M<<5}x|=E<<4*S,C|=L<<4<<S,T|=(240&O)<<S}h.la=C,v.la=T,f.Hc=_,f.Gc=x,f.ia=43690&x?0:m.ia,p=!(_|x)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[n.$b][n.Za],l.wa[l.Y+l.ja].La|=!p),u.Ka)return eW(e,7,"Premature end-of-file encountered.")}if(eJ(e),l=r,u=1,n=(o=e).D,h=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)i:{if(n.M=o.M,n.uc=h,rc(o,n),u=1,n=(E=o.D).Nb,h=(x=i7[o.L])*o.R,d=x/2*o.B,b=16*n*o.R,I=8*n*o.B,p=o.sa,f=o.ta-h+b,m=o.qa,c=o.ra-d+I,g=o.Ha,v=o.Ia-d+I,O=0==(L=E.M),_=L>=o.Va-1,2==o.Aa&&rc(o,E),E.uc)for(M=(R=o).D.M,t(R.D.uc),E=R.yb;E<R.Hb;++E){T=E,C=M;var k=(N=(H=R).D).Nb;S=H.R;var N=N.wa[N.Y+T],D=H.sa,F=H.ta+16*k*S+16*T,G=N.dd,z=N.tc;if(0!=z){if(t(3<=z),1==H.L)0<T&&rK(D,F,S,z+4),N.La&&rQ(D,F,S,z),0<C&&rX(D,F,S,z+4),N.La&&rJ(D,F,S,z);else{var q=H.B,j=H.qa,B=H.ra+8*k*q+8*T,U=H.Ha,H=H.Ia+8*k*q+8*T;k=N.ld,0<T&&(rU(D,F,S,z+4,G,k),rZ(j,B,U,H,q,z+4,G,k)),N.La&&(rY(D,F,S,z,G,k),r$(j,B,U,H,q,z,G,k)),0<C&&(rB(D,F,S,z+4,G,k),rH(j,B,U,H,q,z+4,G,k)),N.La&&(rV(D,F,S,z,G,k),rW(j,B,U,H,q,z,G,k))}}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(E=16*L,L=16*(L+1),O?(l.y=o.sa,l.O=o.ta+b,l.f=o.qa,l.N=o.ra+I,l.ea=o.Ha,l.W=o.Ia+I):(E-=x,l.y=p,l.O=f,l.f=m,l.N=c,l.ea=g,l.W=v),_||(L-=x),L>l.o&&(L=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&E<L&&(l.J=function(e,r,a,n){var o=r.width,l=r.o;if(t(null!=e&&null!=r),0>a||0>=n||a+n>l)return null;if(!e.Cc){if(null==e.ga){if(e.ga=new tX,(T=null==e.ga)||(T=r.width*r.o,t(0==e.Gb.length),e.Gb=s(T),e.Uc=0,null==e.Gb?T=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,T=1),T=!T),!T){T=e.ga;var u=e.Fa,h=e.P,c=e.qc,d=e.mb,p=e.nb,f=h+1,m=c-1,g=T.l;if(t(null!=u&&null!=d&&null!=r),iz[0]=null,iz[1]=tK,iz[2]=tJ,iz[3]=tQ,T.ca=d,T.tb=p,T.c=r.width,T.i=r.height,t(0<T.c&&0<T.i),1>=c)r=0;else if(T.$a=u[h+0]>>0&3,T.Z=u[h+0]>>2&3,T.Lc=u[h+0]>>4&3,h=u[h+0]>>6&3,0>T.$a||1<T.$a||4<=T.Z||1<T.Lc||h)r=0;else if(g.put=ep,g.ac=ed,g.bc=ef,g.ma=T,g.width=r.width,g.height=r.height,g.Da=r.Da,g.v=r.v,g.va=r.va,g.j=r.j,g.o=r.o,T.$a)i:{for(t(1==T.$a),r=eP();;){if(null==r){r=0;break i}if(t(null!=T),T.mc=r,r.c=T.c,r.i=T.i,r.l=T.l,r.l.ma=T,r.l.width=T.c,r.l.height=T.i,r.a=0,y(r.m,u,f,m),!eR(T.c,T.i,1,r,null)||(1==r.ab&&3==r.gc[0].hc&&ew(r.s)?(T.ic=1,u=r.c*r.i,r.Ta=null,r.Ua=0,r.V=s(u),r.Ba=0,null==r.V?(r.a=1,r=0):r=1):(T.ic=0,r=eI(r,T.c)),!r))break;r=1;break i}T.mc=null,r=0}else r=m>=T.c*T.i;T=!r}if(T)return null;1!=e.ga.Lc?e.Ga=0:n=l-a}t(null!=e.ga),t(a+n<=l);i:{if(r=(u=e.ga).c,l=u.l.o,0==u.$a){if(f=e.rc,m=e.Vc,g=e.Fa,h=e.P+1+a*r,c=e.mb,d=e.nb+a*r,t(h<=e.P+e.qc),0!=u.Z)for(t(null!=iz[u.Z]),T=0;T<n;++T)iz[u.Z](f,m,g,h,c,d,r),f=c,m=d,d+=r,h+=r;else for(T=0;T<n;++T)i(c,d,g,h,r),f=c,m=d,d+=r,h+=r;e.rc=f,e.Vc=m}else{if(t(null!=u.mc),r=a+n,t(null!=(T=u.mc)),t(r<=T.i),T.C>=r)r=1;else if(u.ic||t3(),u.ic){u=T.V,f=T.Ba,m=T.c;var v=T.i,_=(g=1,h=T.$/m,c=T.$%m,d=T.m,p=T.s,T.$),x=m*v,b=m*r,S=p.wc,E=_<b?ex(p,c,h):null;t(_<=x),t(r<=v),t(ew(p));a:for(;;){for(;!d.h&&_<b;){if(c&S||(E=ex(p,c,h)),t(null!=E),A(d),256>(v=ev(E.G[0],E.H[0],d)))u[f+_]=v,++_,++c>=m&&(c=0,++h<=r&&!(h%16)&&eA(T,h));else{if(!(280>v)){g=0;break a}v=eg(v-256,d);var T,C,P=ev(E.G[4],E.H[4],d);if(A(d),!(_>=(P=ey(m,P=eg(P,d)))&&x-_>=v)){g=0;break a}for(C=0;C<v;++C)u[f+_+C]=u[f+_+C-P];for(_+=v,c+=v;c>=m;)c-=m,++h<=r&&!(h%16)&&eA(T,h);_<b&&c&S&&(E=ex(p,c,h))}t(d.h==w(d))}eA(T,h>r?r:h);break}!g||d.h&&_<x?(g=0,T.a=d.h?5:3):T.$=_,r=g}else r=eT(T,T.V,T.Ba,T.c,T.i,r,eL);if(!r){n=0;break i}}a+n>=l&&(e.Cc=1),n=1}if(!n)return null;if(e.Cc&&(null!=(n=e.ga)&&(n.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+a*o}(o,l,E,L-E),l.F=o.mb,null==l.F&&0==l.F.length)){u=eW(o,3,"Could not decode alpha data.");break i}E<l.j&&(x=l.j-E,E=l.j,t(!(1&x)),l.O+=o.R*x,l.N+=o.B*(x>>1),l.W+=o.B*(x>>1),null!=l.F&&(l.J+=l.width*x)),E<L&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=E-l.j,l.U=l.va-l.v,l.T=L-E,u=l.put(l))}n+1!=o.Ic||_||(i(o.sa,o.ta-h,p,f+16*o.R,h),i(o.qa,o.ra-d,m,c+8*o.B,d),i(o.Ha,o.Ia-d,g,v+8*o.B,d))}if(!u)return eW(e,6,"Output aborted.")}return 1}(e,r)),null!=r.bc&&r.bc(r),o&=1}return o?(e.cb=0,o):0})(e,l)||(r=e.a)}}else r=e.a;0==r&&null!=c.Oa&&c.Oa.fd&&(r=rf(c.ba))}c=r}h=0!=c?null:11>h?d.f.RGBA.eb:d.f.kb.y}else h=null;return h};var ae=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(e,t){return(e[t+0]<<0|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]<<0|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var c=[0],d=[0],p=[],f=new l,m=function(e,t){var r={},i=0,a=!1,s=0,n=0;if(r.frames=[],!/** @license
   * Copyright (c) 2017 Dominik Homberger
  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  https://webpjs.appspot.com
  WebPRiffParser dominikhlbg@gmail.com
  */function(e,t,r,i){for(var a=0;a<4;a++)if(e[t+a]!=r.charCodeAt(a))return!0;return!1}(e,t,"RIFF",0)){for(h(e,t+=4),t+=8;t<e.length;){var o,l,c,d=function(e,t){for(var r="",i=0;i<4;i++)r+=String.fromCharCode(e[t++]);return r}(e,t),p=h(e,t+=4);t+=4;var f=p+(1&p);switch(d){case"VP8 ":case"VP8L":void 0===r.frames[i]&&(r.frames[i]={}),(c=r.frames[i]).src_off=a?n:t-8,c.src_size=s+p+8,i++,a&&(a=!1,s=0,n=0);break;case"VP8X":(c=r.header={}).feature_flags=e[t];var m=t+4;c.canvas_width=1+u(e,m),m+=3,c.canvas_height=1+u(e,m),m+=3;break;case"ALPH":a=!0,s=f+8,n=t-8;break;case"ANIM":(c=r.header).bgcolor=h(e,t),m=t+4,c.loop_count=e[(o=m)+0]<<0|e[o+1]<<8,m+=2;break;case"ANMF":(c=r.frames[i]={}).offset_x=2*u(e,t),t+=3,c.offset_y=2*u(e,t),t+=3,c.width=1+u(e,t),t+=3,c.height=1+u(e,t),t+=3,c.duration=u(e,t),t+=3,l=e[t++],c.dispose=1&l,c.blend=l>>1&1}"ANMF"!=d&&(t+=f)}return r}}(e,0);m.response=e,m.rgbaoutput=!0,m.dataurl=!1;var g=m.header?m.header:null,y=m.frames?m.frames:null;if(g){g.loop_counter=g.loop_count,c=[g.canvas_height],d=[g.canvas_width];for(var v=0;v<y.length&&0!=y[v].blend;v++);}var _=y[0],x=f.WebPDecodeRGBA(e,_.src_off,_.src_size,d,c);_.rgba=x,_.imgwidth=d[0],_.imgheight=c[0];for(var b=0;b<d[0]*c[0]*4;b++)p[b]=x[b];return this.width=d,this.height=c,this.data=p,this}tq=z.API,tj=function(e,t,r,i){var a=4,s=tZ;switch(i){case tq.image_compression.FAST:a=1,s=tH;break;case tq.image_compression.MEDIUM:a=6,s=tV;break;case tq.image_compression.SLOW:a=9,s=tY}e=tB(e,t,r,s);var n=(0,o.zlibSync)(e,{level:a});return tq.__addimage__.arrayBufferToBinaryString(n)},tB=function(e,t,r,i){for(var a,s,n,o=e.length/t,l=new Uint8Array(e.length+o),u=t$(),h=0;h<o;h+=1){if(n=h*t,a=e.subarray(n,n+t),i)l.set(i(a,r,s),n+h);else{for(var c,d=u.length,p=[];c<d;c+=1)p[c]=u[c](a,r,s);var f=tX(p.concat());l.set(p[f],n+h)}s=a}return l},tU=function(e){var t=Array.apply([],e);return t.unshift(0),t},tH=function(e,t){var r,i=[],a=e.length;i[0]=1;for(var s=0;s<a;s+=1)r=e[s-t]||0,i[s+1]=e[s]-r+256&255;return i},tZ=function(e,t,r){var i,a=[],s=e.length;a[0]=2;for(var n=0;n<s;n+=1)i=r&&r[n]||0,a[n+1]=e[n]-i+256&255;return a},tV=function(e,t,r){var i,a,s=[],n=e.length;s[0]=3;for(var o=0;o<n;o+=1)i=e[o-t]||0,a=r&&r[o]||0,s[o+1]=e[o]+256-(i+a>>>1)&255;return s},tY=function(e,t,r){var i,a,s,n=[],o=e.length;n[0]=4;for(var l=0;l<o;l+=1)i=e[l-t]||0,a=r&&r[l]||0,s=tW(i,a,r&&r[l-t]||0),n[l+1]=e[l]-s+256&255;return n},tW=function(e,t,r){if(e===t&&t===r)return e;var i=Math.abs(t-r),a=Math.abs(e-r),s=Math.abs(e+t-r-r);return i<=a&&i<=s?e:a<=s?t:r},t$=function(){return[tU,tH,tZ,tV,tY]},tX=function(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))},tq.processPNG=function(e,t,r,i){var a,s,n,l,u,h,c,d,p,f,m,g,y,v,_,x=this.decode.FLATE_DECODE,b="";if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){if(e=(n=new tk(e)).imgData,s=n.bits,a=n.colorSpace,u=n.colors,-1!==[4,6].indexOf(n.colorType)){if(8===n.bits){p=(d=32==n.pixelBitlength?new Uint32Array(n.decodePixels().buffer):16==n.pixelBitlength?new Uint16Array(n.decodePixels().buffer):new Uint8Array(n.decodePixels().buffer)).length,m=new Uint8Array(p*n.colors),f=new Uint8Array(p);var S,w=n.pixelBitlength-n.bits;for(v=0,_=0;v<p;v++){for(y=d[v],S=0;S<w;)m[_++]=y>>>S&255,S+=n.bits;f[v]=y>>>S&255}}if(16===n.bits){p=(d=new Uint32Array(n.decodePixels().buffer)).length,m=new Uint8Array(32/n.pixelBitlength*p*n.colors),f=new Uint8Array(32/n.pixelBitlength*p),g=n.colors>1,v=0,_=0;for(var E=0;v<p;)y=d[v++],m[_++]=y>>>0&255,g&&(m[_++]=y>>>16&255,y=d[v++],m[_++]=y>>>0&255),f[E++]=y>>>16&255;s=8}i!==tq.image_compression.NONE&&"function"==typeof o.zlibSync?(e=tj(m,n.width*n.colors,n.colors,i),c=tj(f,n.width,1,i)):(e=m,c=f,x=void 0)}if(3===n.colorType&&(a=this.color_spaces.INDEXED,h=n.palette,n.transparency.indexed)){var A=n.transparency.indexed,T=0;for(v=0,p=A.length;v<p;++v)T+=A[v];if((T/=255)==p-1&&-1!==A.indexOf(0))l=[A.indexOf(0)];else if(T!==p){for(d=n.decodePixels(),f=new Uint8Array(d.length),v=0,p=d.length;v<p;v++)f[v]=A[d[v]];c=tj(f,n.width,1)}}var C=function(e){var t;switch(e){case tq.image_compression.FAST:t=11;break;case tq.image_compression.MEDIUM:t=13;break;case tq.image_compression.SLOW:t=14;break;default:t=12}return t}(i);return x===this.decode.FLATE_DECODE&&(b="/Predictor "+C+" "),b+="/Colors "+u+" /BitsPerComponent "+s+" /Columns "+n.width,(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(c&&this.__addimage__.isArrayBuffer(c)||this.__addimage__.isArrayBufferView(c))&&(c=this.__addimage__.arrayBufferToBinaryString(c)),{alias:r,data:e,index:t,filter:x,decodeParameters:b,transparency:l,palette:h,sMask:c,predictor:C,width:n.width,height:n.height,bitsPerComponent:s,colorSpace:a}}},(tK=z.API).processGIF89A=function(e,t,r,i){var a=new tN(e),s=a.width,n=a.height,o=[];a.decodeAndBlitFrameRGBA(0,o);var l=new tF(100).encode({data:o,width:s,height:n},100);return tK.processJPEG.call(this,l,t,r,i)},tK.processGIF87A=tK.processGIF89A,tG.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:i,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},tG.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(e){h.log("bit decode error:"+e)}},tG.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),n=i*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[n+4*o]=l.blue,this.data[n+4*o+1]=l.green,this.data[n+4*o+2]=l.red,this.data[n+4*o+3]=255}0!==r&&(this.pos+=4-r)}},tG.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),n=i*this.width*4+2*a*4,o=s>>4,l=15&s,u=this.palette[o];if(this.data[n]=u.blue,this.data[n+1]=u.green,this.data[n+2]=u.red,this.data[n+3]=255,2*a+1>=this.width)break;u=this.palette[l],this.data[n+4]=u.blue,this.data[n+4+1]=u.green,this.data[n+4+2]=u.red,this.data[n+4+3]=255}0!==t&&(this.pos+=4-t)}},tG.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*i;if(a<this.palette.length){var n=this.palette[a];this.data[s]=n.red,this.data[s+1]=n.green,this.data[s+2]=n.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},tG.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var n=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,u=s>>15?255:0,h=i*this.width*4+4*a;this.data[h]=l,this.data[h+1]=o,this.data[h+2]=n,this.data[h+3]=u}this.pos+=e}},tG.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var a=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var n=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(n&t)/t*255|0,l=(n>>5&r)/r*255|0,u=(n>>11)/t*255|0,h=a*this.width*4+4*s;this.data[h]=u,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=255}this.pos+=e}},tG.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=t*this.width*4+4*r;this.data[n]=s,this.data[n+1]=a,this.data[n+2]=i,this.data[n+3]=255}this.pos+=this.width%4}},tG.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=i,this.data[o+3]=n}},tG.prototype.getData=function(){return this.data},(tJ=z.API).processBMP=function(e,t,r,i){var a=new tG(e,!1),s=a.width,n=a.height,o={data:a.getData(),width:s,height:n},l=new tF(100).encode(o,100);return tJ.processJPEG.call(this,l,t,r,i)},tz.prototype.getData=function(){return this.data},(tQ=z.API).processWEBP=function(e,t,r,i){var a=new tz(e,!1),s=a.width,n=a.height,o={data:a.getData(),width:s,height:n},l=new tF(100).encode(o,100);return tQ.processJPEG.call(this,l,t,r,i)},z.API.processRGBA=function(e,t,r){for(var i=e.data,a=i.length,s=new Uint8Array(a/4*3),n=new Uint8Array(a/4),o=0,l=0,u=0;u<a;u+=4){var h=i[u],c=i[u+1],d=i[u+2],p=i[u+3];s[o++]=h,s[o++]=c,s[o++]=d,n[l++]=p}var f=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(n),data:f,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},z.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!==({af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"})[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},tI=(tR=z.API).getCharWidthsArray=function(t,r){var i,a,s=(r=r||{}).font||this.internal.getFont(),o=r.fontSize||this.internal.getFontSize(),l=r.charSpace||this.internal.getCharSpace(),u=r.widths?r.widths:s.metadata.Unicode.widths,h=u.fof?u.fof:1,c=r.kerning?r.kerning:s.metadata.Unicode.kerning,d=c.fof?c.fof:1,p=!1!==r.doKerning,f=0,m=t.length,g=0,y=u[0]||h,v=[];for(i=0;i<m;i++)a=t.charCodeAt(i),"function"==typeof s.metadata.widthOfString?v.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+1e3/o*l||0)/1e3):(f=p&&"object"===e(n)(c[a])&&!isNaN(parseInt(c[a][g],10))?c[a][g]/d:0,v.push((u[a]||y)/h+f)),g=a;return v},tL=tR.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return tR.processArabic&&(e=tR.processArabic(e)),"function"==typeof i.metadata.widthOfString?i.metadata.widthOfString(e,r,a)/r:tI.apply(this,arguments).reduce(function(e,t){return e+t},0)},tO=function(e,t,r,i){for(var a=[],s=0,n=e.length,o=0;s!==n&&o+t[s]<r;)o+=t[s],s++;a.push(e.slice(0,s));var l=s;for(o=0;s!==n;)o+t[s]>i&&(a.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&a.push(e.slice(l,s)),a},tM=function(e,t,r){r||(r={});var i,a,s,n,o,l,u,h=[],c=[h],d=r.textIndent||0,p=0,f=0,m=e.split(" "),g=tI.apply(this,[" ",r])[0];if(l=-1===r.lineIndent?m[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),v=[];m.map(function(e){(e=e.split(/\s*\n/)).length>1?v=v.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):v.push(e[0])}),m=v,l=tL.apply(this,[y,r])}for(s=0,n=m.length;s<n;s++){var _=0;if(i=m[s],l&&"\n"==i[0]&&(i=i.substr(1),_=1),d+p+(f=(a=tI.apply(this,[i,r])).reduce(function(e,t){return e+t},0))>t||_){if(f>t){for(o=tO.apply(this,[i,a,t-(d+p),t]),h.push(o.shift()),h=[o.pop()];o.length;)c.push([o.shift()]);f=a.slice(i.length-(h[0]?h[0].length:0)).reduce(function(e,t){return e+t},0)}else h=[i];c.push(h),d=f+l,p=g}else h.push(i),d+=p+f,p=g}return u=l?function(e,t){return(t?y:"")+e.join(" ")}:function(e){return e.join(" ")},c.map(u)},tR.splitTextToSize=function(e,t,r){var i,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var n=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=i.length;o<l;o++)u=u.concat(tM.apply(this,[i[o],n,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",i={},a={},s=0;s<r.length;s++)i[r[s]]="0123456789abcdef"[s],a["0123456789abcdef"[s]]=r[s];var o=function(e){return"0x"+parseInt(e,10).toString(16)},l=t.__fontmetrics__.compress=function(t){var r,i,s,u,h=["{"];for(var c in t){if(r=t[c],i=isNaN(parseInt(c,10))?"'"+c+"'":(i=o(c=parseInt(c,10)).slice(2)).slice(0,-1)+a[i.slice(-1)],"number"==typeof r)r<0?(s=o(r).slice(3),u="-"):(s=o(r).slice(2),u=""),s=u+s.slice(0,-1)+a[s.slice(-1)];else{if("object"!==e(n)(r))throw Error("Don't know what to do with value type "+e(n)(r)+".");s=l(r)}h.push(i+s)}return h.push("}"),h.join("")},u=t.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw Error("Invalid argument passed to uncompress.");for(var t,r,a,s,n={},o=1,l=n,u=[],h="",c="",d=e.length-1,p=1;p<d;p+=1)"'"==(s=e[p])?t?(a=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(u.push([l,a]),l={},a=void 0):"}"==s?((r=u.pop())[0][r[1]]=l,a=void 0,l=r[0]):"-"==s?o=-1:void 0===a?i.hasOwnProperty(s)?(h+=i[s],a=parseInt(h,16)*o,o=1,h=""):h+=s:i.hasOwnProperty(s)?(c+=i[s],l[a]=parseInt(c,16)*o,o=1,a=void 0,c=""):c+=s;return n},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},d={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(e){var t=e.font,r=d.Unicode[t.postScriptName];r&&(t.metadata.Unicode={},t.metadata.Unicode.widths=r.widths,t.metadata.Unicode.kerning=r.kerning);var i=c.Unicode[t.postScriptName];i&&(t.metadata.Unicode.encoding=i,t.encoding=i.codePages[0])}])}(z.API),/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function(e){var t=function(e){for(var t=e.length,r=new Uint8Array(t),i=0;i<t;i++)r[i]=e.charCodeAt(i);return r};e.API.events.push(["addFont",function(r){var i,a=void 0,s=r.font,n=r.instance;if(!s.isStandardFont){if(void 0===n)throw Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if("string"!=typeof(a=!1===n.existsFileInVFS(s.postScriptName)?n.loadFile(s.postScriptName):n.getFileFromVFS(s.postScriptName)))throw Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");i=a,i=/^\x00\x01\x00\x00/.test(i)?t(i):t(f(i)),s.metadata=e.API.TTFFont.open(i),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]}}])}(z),z.API.addSvgAsImage=function(e,t,r,i,a,n,o,u){if(isNaN(t)||isNaN(r))throw h.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw h.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(l.canvg?Promise.resolve(l.canvg):s("4s1Fc")).catch(function(e){return Promise.reject(Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,p)},function(){return Promise.reject(Error("Could not load canvg."))}).then(function(e){return e.render(p)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,i,a,o,u)})},z.API.putTotalPages=function(e){var t,r=0;15>parseInt(this.internal.getFont().id.substr(1),10)?(t=RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var a=0;a<this.internal.pages[i].length;a++)this.internal.pages[i][a]=this.internal.pages[i][a].replace(t,r);return this},z.API.viewerPreferences=function(t,r){t=t||{},r=r||!1;var i,a,s,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(l),h=[],c=0,d=0,p=0;function f(e,t){var r,i=!1;for(r=0;r<e.length;r+=1)e[r]===t&&(i=!0);return i}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,"reset"===t||!0===r){var m=u.length;for(p=0;p<m;p+=1)i[u[p]].value=i[u[p]].defaultValue,i[u[p]].explicitSet=!1}if("object"===e(n)(t)){for(s in t)if(o=t[s],f(u,s)&&void 0!==o){if("boolean"===i[s].type&&"boolean"==typeof o)i[s].value=o;else if("name"===i[s].type&&f(i[s].valueSet,o))i[s].value=o;else if("integer"===i[s].type&&Number.isInteger(o))i[s].value=o;else if("array"===i[s].type){for(c=0;c<o.length;c+=1)if(a=!0,1===o[c].length&&"number"==typeof o[c][0])h.push(String(o[c]-1));else if(o[c].length>1){for(d=0;d<o[c].length;d+=1)"number"!=typeof o[c][d]&&(a=!1);!0===a&&h.push([o[c][0]-1,o[c][1]-1].join(" "))}i[s].value="["+h.join(" ")+"]"}else i[s].value=i[s].defaultValue;i[s].explicitSet=!0}}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in i)!0===i[e].explicitSet&&("name"===i[e].type?t.push("/"+e+" /"+i[e].value):t.push("/"+e+" "+i[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},t0=z.API,t1=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(e)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),n=r.length+i.length+a.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+n+" >>"),this.internal.write("stream"),this.internal.write(t+r+i+a+s),this.internal.write("endstream"),this.internal.write("endobj")},t2=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")},t0.addMetadata=function(e,t){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:t||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t2),this.internal.events.subscribe("postPutResources",t1)),this},t3=(t5=z.API).pdfEscape16=function(e,t){for(var r,i=t.metadata.Unicode.widths,a=["","0","00","000","0000"],s=[""],n=0,o=e.length;n<o&&(r=t.metadata.characterToGlyph(e.charCodeAt(n)),t.metadata.glyIdsUsed.push(r),t.metadata.toUnicode[r]=e.charCodeAt(n),-1==i.indexOf(r)&&(i.push(r),i.push([parseInt(t.metadata.widthOfGlyph(r),10)])),"0"!=r);++n)s.push(a[4-(r=r.toString(16)).length],r);return s.join("")},t4=function(e){var t,r,i,a,s,n,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",i=[],n=0,o=(r=Object.keys(e).sort(function(e,t){return e-t})).length;n<o;n++)t=r[n],i.length>=100&&(s+="\n"+i.length+" beginbfchar\n"+i.join("\n")+"\nendbfchar",i=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),i.push("<"+t+"><"+a+">"));return i.length&&(s+="\n"+i.length+" beginbfchar\n"+i.join("\n")+"\nendbfchar\n"),s+="endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"},t5.events.push(["putFont",function(e){!function(e){var t=e.font,r=e.out,i=e.newObject,a=e.putStream;if(t.metadata instanceof z.API.TTFFont&&"Identity-H"===t.encoding){for(var s=t.metadata.Unicode.widths,n=t.metadata.subset.encode(t.metadata.glyIdsUsed,1),o="",l=0;l<n.length;l++)o+=String.fromCharCode(n[l]);var u=i();a({data:o,addLength1:!0,objectId:u}),r("endobj");var h=i();a({data:t4(t.metadata.toUnicode),addLength1:!0,objectId:h}),r("endobj");var c=i();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+M(t.fontName)),r("/FontFile2 "+u+" 0 R"),r("/FontBBox "+z.API.PDFObject.convert(t.metadata.bbox)),r("/Flags "+t.metadata.flags),r("/StemV "+t.metadata.stemV),r("/ItalicAngle "+t.metadata.italicAngle),r("/Ascent "+t.metadata.ascender),r("/Descent "+t.metadata.decender),r("/CapHeight "+t.metadata.capHeight),r(">>"),r("endobj");var d=i();r("<<"),r("/Type /Font"),r("/BaseFont /"+M(t.fontName)),r("/FontDescriptor "+c+" 0 R"),r("/W "+z.API.PDFObject.convert(s)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+t.encoding+")"),r(">>"),r(">>"),r("endobj"),t.objectNumber=i(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+h+" 0 R"),r("/BaseFont /"+M(t.fontName)),r("/Encoding /"+t.encoding),r("/DescendantFonts ["+d+" 0 R]"),r(">>"),r("endobj"),t.isAlreadyPutted=!0}}(e)}]),t5.events.push(["putFont",function(e){!function(e){var t=e.font,r=e.out,i=e.newObject,a=e.putStream;if(t.metadata instanceof z.API.TTFFont&&"WinAnsiEncoding"===t.encoding){for(var s=t.metadata.rawData,n="",o=0;o<s.length;o++)n+=String.fromCharCode(s[o]);var l=i();a({data:n,addLength1:!0,objectId:l}),r("endobj");var u=i();a({data:t4(t.metadata.toUnicode),addLength1:!0,objectId:u}),r("endobj");var h=i();r("<<"),r("/Descent "+t.metadata.decender),r("/CapHeight "+t.metadata.capHeight),r("/StemV "+t.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+l+" 0 R"),r("/Flags 96"),r("/FontBBox "+z.API.PDFObject.convert(t.metadata.bbox)),r("/FontName /"+M(t.fontName)),r("/ItalicAngle "+t.metadata.italicAngle),r("/Ascent "+t.metadata.ascender),r(">>"),r("endobj"),t.objectNumber=i();for(var c=0;c<t.metadata.hmtx.widths.length;c++)t.metadata.hmtx.widths[c]=parseInt(t.metadata.hmtx.widths[c]*(1e3/t.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+M(t.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+t.encoding+" /FirstChar 29 /LastChar 255 /Widths "+z.API.PDFObject.convert(t.metadata.hmtx.widths)+">>"),r("endobj"),t.isAlreadyPutted=!0}}(e)}]),t6=function(e){var t,r=e.text||"",i=e.x,a=e.y,s=e.options||{},n=e.mutex||{},o=n.pdfEscape,l=n.activeFontKey,u=n.fonts,h=l,c="",d=0,p="",f=u[h].encoding;if("Identity-H"!==u[h].encoding)return{text:r,x:i,y:a,options:s,mutex:n};for(p=r,h=l,Array.isArray(r)&&(p=r[0]),d=0;d<p.length;d+=1)u[h].metadata.hasOwnProperty("cmap")&&(t=u[h].metadata.cmap.unicode.codeMap[p[d].charCodeAt(0)]),t||256>p[d].charCodeAt(0)&&u[h].metadata.hasOwnProperty("Unicode")?c+=p[d]:c+="";var m="";return 14>parseInt(h.slice(1))||"WinAnsiEncoding"===f?m=o(c,h).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===f&&(m=t3(c,u[h])),n.isHex=!0,{text:m,x:i,y:a,options:s,mutex:n}},t5.events.push(["postProcessText",function(e){var t=e.text||"",r=[],i={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var a=0;for(a=0;a<t.length;a+=1)Array.isArray(t[a])&&3===t[a].length?r.push([t6(Object.assign({},i,{text:t[a][0]})).text,t[a][1],t[a][2]]):r.push(t6(Object.assign({},i,{text:t[a]})).text);e.text=r}else e.text=t6(Object.assign({},i,{text:t})).text}]),t8=z.API,t7=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0},t8.existsFileInVFS=function(e){return t7.call(this),void 0!==this.internal.vFS[e]},t8.addFileToVFS=function(e,t){return t7.call(this),this.internal.vFS[e]=t,this},t8.getFileFromVFS=function(e){return t7.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null},/**
 * @license
 * Unicode Bidi Engine based on the work of Alex Shensis (@asthensis)
 * MIT License
 */function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var r,i,a,s,n,o,l,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],c={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},d={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],f=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,g=0;this.__bidiEngine__={};var y=function(e){var r=e.charCodeAt(),i=r>>8,a=d[i];return void 0!==a?t[256*a+(255&r)]:252===i||253===i?"AL":f.test(i)?"L":8===i?"R":"N"},v=function(e){for(var t,r=0;r<e.length&&"L"!==(t=y(e.charAt(r)));r++)if("R"===t)return!0;return!1},_=function(e,t,n,o){var l,u,h,c,d=t[o];switch(d){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(d="AN");break;case"AL":m=!0,d="R";break;case"WS":case"BN":d="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(l=n[o-1])&&"AN"!==l||"EN"!==(u=t[o+1])&&"AN"!==u?d="N":m&&(u="AN"),d=u===l?u:"N";break;case"ES":d="EN"===(l=o>0?n[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===n[o-1]){d="EN";break}if(m){d="N";break}for(h=o+1,c=t.length;h<c&&"ET"===t[h];)h++;d=h<c&&"EN"===t[h]?"EN":"N";break;case"NSM":if(a&&!s){for(c=t.length,h=o+1;h<c&&"NSM"===t[h];)h++;if(h<c){var p=e[o];if(l=t[h],(p>=1425&&p<=2303||64286===p)&&("R"===l||"AL"===l)){d="R";break}}}d=o<1||"B"===(l=t[o-1])?"N":n[o-1];break;case"B":m=!1,r=!0,d=g;break;case"S":i=!0,d="N"}return d},x=function(e,t,r){var i=e.split("");return r&&b(i,r,{hiLevel:g}),i.reverse(),t&&t.reverse(),i.join("")},b=function(e,t,a){var s,n,o,l,d,p=-1,f=e.length,v=0,x=[],b=g?h:u,S=[];for(m=!1,r=!1,i=!1,n=0;n<f;n++)S[n]=y(e[n]);for(o=0;o<f;o++){if(d=v,x[o]=_(e,S,x,o),s=240&(v=b[d][c[x[o]]]),v&=15,t[o]=l=b[v][5],s>0){if(16===s){for(n=p;n<o;n++)t[n]=1;p=-1}else p=-1}if(b[v][6])-1===p&&(p=o);else if(p>-1){for(n=p;n<o;n++)t[n]=l;p=-1}"B"===S[o]&&(t[o]=0),a.hiLevel|=l}i&&function(e,t,r){for(var i=0;i<r;i++)if("S"===e[i]){t[i]=g;for(var a=i-1;a>=0&&"WS"===e[a];a--)t[a]=g}}(S,t,f)},S=function(e,t,i,a,s){if(!(s.hiLevel<e)){if(1===e&&1===g&&!r)return t.reverse(),void(i&&i.reverse());for(var n,o,l,u,h=t.length,c=0;c<h;){if(a[c]>=e){for(l=c+1;l<h&&a[l]>=e;)l++;for(u=c,o=l-1;u<o;u++,o--)n=t[u],t[u]=t[o],t[o]=n,i&&(n=i[u],i[u]=i[o],i[o]=n);c=l}c++}}},w=function(e,t,r){var i=e.split(""),a={hiLevel:g};return r||(r=[]),b(i,r,a),function(e,t,r){if(0!==r.hiLevel&&l)for(var i,a=0;a<e.length;a++)1===t[a]&&(i=p.indexOf(e[a]))>=0&&(e[a]=p[i+1])}(i,r,a),S(2,i,t,r,a),S(1,i,t,r,a),i.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,r){if(function(e,t){if(t)for(var r=0;r<e.length;r++)t[r]=r;void 0===s&&(s=v(e)),void 0===o&&(o=v(e))}(e,t),a||!n||o){if(a&&n&&s^o)g=s?1:0,e=x(e,t,r);else if(!a&&n&&o)g=s?1:0,e=x(e=w(e,t,r),t);else if(!a||s||n||o){if(a&&!n&&s^o)e=x(e,t),s?(g=0,e=w(e,t,r)):(g=1,e=x(e=w(e,t,r),t));else if(a&&s&&!n&&o)g=1,e=x(e=w(e,t,r),t);else if(!a&&!n&&s^o){var i=l;s?(g=1,e=w(e,t,r),g=0,l=!1,e=w(e,t,r),l=i):(g=0,e=x(e=w(e,t,r),t),g=1,l=!1,e=w(e,t,r),l=i,e=x(e,t))}}else g=0,e=w(e,t,r)}else g=s?1:0,e=w(e,t,r);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,n=e.isOutputVisual,s=e.isInputRtl,o=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text,i=(e.x,e.y,e.options||{}),a=(e.mutex,i.lang,[]);if(i.isInputVisual="boolean"!=typeof i.isInputVisual||i.isInputVisual,r.setOptions(i),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(a=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?a.push([r.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):a.push([r.doBidiReorder(t[s])]);e.text=a}else e.text=r.doBidiReorder(t);r.setOptions({isInputVisual:!0})}])}(z),z.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new re(e),this.contents.pos=4,"ttcf"===t.readString(4))throw Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new r_(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new rt(this.contents),this.head=new ra(this),this.name=new rc(this),this.cmap=new rn(this),this.toUnicode={},this.hhea=new ro(this),this.maxp=new rd(this),this.hmtx=new rp(this),this.post=new ru(this),this.os2=new rl(this),this.loca=new rv(this),this.glyf=new rm(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,r,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var t,r,i,a;for(a=[],t=0,r=(i=this.bbox).length;t<r;t++)e=i[t],a.push(Math.round(e*this.scaleFactor));return a}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),0!=(32768&(t=i>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,r){var i,a,s,n;for(s=0,a=0,n=(e=""+e).length;0<=n?a<n:a>n;a=0<=n?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+1e3/t*r||0;return t/1e3*s},e.prototype.lineHeight=function(e,t){var r;return null==t&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},e}();var tq,tj,tB,tU,tH,tZ,tV,tY,tW,t$,tX,tK,tJ,tQ,t0,t1,t2,t5,t3,t4,t6,t8,t7,t9,re=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(e){var t,r,i;for(i=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,r,i,a,s,n,o;return e=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),n=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^n)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*i+16777216*a+65536*s+256*n+o},e.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(e){var t,r,i,a;for(a=[],r=0,i=e.length;r<i;r++)t=e[r],a.push(this.writeByte(t));return a},e}(),rt=function(){var e;function t(e){var t,r,i;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,i=this.tableCount;0<=i?r<i:r>i;r=0<=i?++r:--r)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var r,i,a,s,n,o,l,u,h,c,d,p,f;for(f in s=Math.floor((h=16*Math.floor(Math.log(d=Object.keys(t).length)/(o=Math.log(2))))/o),u=16*d-h,(i=new re).writeInt(this.scalarType),i.writeShort(d),i.writeShort(h),i.writeShort(s),i.writeShort(u),a=16*d,l=i.pos+a,n=null,p=[],t)for(c=t[f],i.writeString(f),i.writeInt(e(c)),i.writeInt(l),i.writeInt(c.length),p=p.concat(c),"head"===f&&(n=l),l+=c.length;l%4;)p.push(0),l++;return i.write(p),r=2981146554-e(i.data),i.pos=n+8,i.writeUInt32(r),i.data},e=function(e){var t,r,i,a;for(e=rf.call(e);e.length%4;)e.push(0);for(i=new re(e),r=0,t=0,a=e.length;t<a;t=t+=4)r+=i.readUInt32();return 4294967295&r},t}(),rr={}.hasOwnProperty,ri=function(e,t){for(var r in t)rr.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t9=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var ra=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var t;return(t=new re).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},t}(),rs=function(){function e(e,t){var r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(c=e.readUInt16()/2,e.pos+=6,a=function(){var t,r;for(r=[],o=t=0;0<=c?t<c:t>c;o=0<=c?++t:--t)r.push(e.readUInt16());return r}(),e.pos+=2,p=function(){var t,r;for(r=[],o=t=0;0<=c?t<c:t>c;o=0<=c?++t:--t)r.push(e.readUInt16());return r}(),l=function(){var t,r;for(r=[],o=t=0;0<=c?t<c:t>c;o=0<=c?++t:--t)r.push(e.readUInt16());return r}(),u=function(){var t,r;for(r=[],o=t=0;0<=c?t<c:t>c;o=0<=c?++t:--t)r.push(e.readUInt16());return r}(),i=(this.length-e.pos+this.offset)/2,n=function(){var t,r;for(r=[],o=t=0;0<=i?t<i:t>i;o=0<=i?++t:--t)r.push(e.readUInt16());return r}(),o=m=0,y=a.length;m<y;o=++m)for(f=a[o],r=g=d=p[o];d<=f?g<=f:g>=f;r=d<=f?++g:--g)0===u[o]?s=r+l[o]:0!==(s=n[u[o]/2+(r-d)-(c-o)]||0)&&(s+=l[o]),this.codeMap[r]=65535&s}e.pos=h}return e.encode=function(e,t){var r,i,a,s,n,o,l,u,h,c,d,p,f,m,g,y,v,_,x,b,S,w,E,A,T,C,P,R,I,L,O,M,k,N,D,F,G,z,q,j,B,U,H,Z,V;switch(P=new re,s=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(p=0,f=function(){var e=[];for(d=0;d<256;++d)e.push(0);return e}(),g={0:0},a={},R=0,M=s.length;R<M;R++)null==g[U=e[i=s[R]]]&&(g[U]=++p),a[i]={old:e[i],new:g[e[i]]},f[i]=g[e[i]];return P.writeUInt16(1),P.writeUInt16(0),P.writeUInt32(12),P.writeUInt16(0),P.writeUInt16(262),P.writeUInt16(0),P.write(f),{charMap:a,subtable:P.data,maxGlyphID:p+1};case"unicode":for(T=[],h=[],y=0,g={},r={},m=l=null,I=0,k=s.length;I<k;I++)null==g[_=e[i=s[I]]]&&(g[_]=++y),r[i]={old:_,new:g[_]},n=g[_]-i,null!=m&&n===l||(m&&h.push(m),T.push(i),l=n),m=i;for(m&&h.push(m),h.push(65535),T.push(65535),E=2*(w=T.length),S=2*Math.pow(Math.log(w)/Math.LN2,2),b=2*w-S,o=[],x=[],c=[],d=L=0,N=T.length;L<N;d=++L){if(A=T[d],u=h[d],65535===A){o.push(0),x.push(0);break}if(A-(C=r[A].new)>=32768)for(o.push(0),x.push(2*(c.length+w-d)),i=O=A;A<=u?O<=u:O>=u;i=A<=u?++O:--O)c.push(r[i].new);else o.push(C-A),x.push(0)}for(P.writeUInt16(3),P.writeUInt16(1),P.writeUInt32(12),P.writeUInt16(4),P.writeUInt16(16+8*w+2*c.length),P.writeUInt16(0),P.writeUInt16(E),P.writeUInt16(S),P.writeUInt16(Math.log(S/2)/Math.LN2),P.writeUInt16(b),j=0,D=h.length;j<D;j++)i=h[j],P.writeUInt16(i);for(P.writeUInt16(0),B=0,F=T.length;B<F;B++)i=T[B],P.writeUInt16(i);for(H=0,G=o.length;H<G;H++)n=o[H],P.writeUInt16(n);for(Z=0,z=x.length;Z<z;Z++)v=x[Z],P.writeUInt16(v);for(V=0,q=c.length;V<q;V++)p=c[V],P.writeUInt16(p);return{charMap:r,subtable:P.data,maxGlyphID:y+1}}},e}(),rn=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="cmap",t.prototype.parse=function(e){var t,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)t=new rs(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},t.encode=function(e,t){var r,i;return null==t&&(t="macroman"),r=rs.encode(e,t),(i=new re).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),ro=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),rl=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r}(),this.charRange=function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),ru=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="post",t.prototype.parse=function(e){var t,r,i,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:for(r=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)t=e.readByte(),i.push(this.names.push(e.readString(t)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var t,r,i;for(i=[],a=t=0,r=this.file.maxp.numGlyphs;0<=r?t<r:t>r;a=0<=r?++t:--t)i.push(e.readUInt32());return i}).call(this)}},t}(),rh=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},rc=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="name",t.prototype.parse=function(e){var t,r,i,a,s,n,o,l,u,h;for(e.pos=this.offset,e.readShort(),t=e.readShort(),n=e.readShort(),r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+n+e.readShort()});for(o={},a=l=0,u=r.length;l<u;a=++l)i=r[a],e.pos=i.offset,s=new rh(e.readString(i.length),i),null==o[h=i.nameID]&&(o[h]=[]),o[i.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(e){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},t}(),rd=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),rp=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="hmtx",t.prototype.parse=function(e){var t,r,i,a,s,n,o;for(e.pos=this.offset,this.metrics=[],t=0,n=this.file.hhea.numberOfMetrics;0<=n?t<n:t>n;t=0<=n?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,a;for(a=[],t=r=0;0<=i?r<i:r>i;t=0<=i?++r:--r)a.push(e.readInt16());return a}(),this.widths=(function(){var e,t,r,i;for(i=[],e=0,t=(r=this.metrics).length;e<t;e++)a=r[e],i.push(a.advance);return i}).call(this),r=this.widths[this.widths.length-1],o=[],t=s=0;0<=i?s<i:s>i;t=0<=i?++s:--s)o.push(this.widths.push(r));return o},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),rf=[].slice,rm=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var t,r,i,a,s,n,o,l,u,h;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,r=a.indexOf(e),0===(i=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+r,s=(n=new re(t.read(i))).readShort(),l=n.readShort(),h=n.readShort(),o=n.readShort(),u=n.readShort(),this.cache[e]=-1===s?new ry(n,l,h,o,u):new rg(n,s,l,h,o,u),this.cache[e]))},t.prototype.encode=function(e,t,r){var i,a,s,n,o;for(s=[],a=[],n=0,o=t.length;n<o;n++)i=e[t[n]],a.push(s.length),i&&(s=s.concat(i.encode(r)));return a.push(s.length),{table:s,offsets:a}},t}(),rg=function(){function e(e,t,r,i,a,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),ry=function(){function e(e,t,r,i,a){var s,n;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;n=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&n;)s.pos+=1&n?4:2,128&n?s.pos+=8:64&n?s.pos+=4:8&n&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,r;for(t=new re(rf.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),rv=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ri(t,t9),t.prototype.tag="loca",t.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?(function(){var t,i;for(i=[],r=0,t=this.length;r<t;r+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var t,i;for(i=[],r=0,t=this.length;r<t;r+=4)i.push(e.readUInt32());return i}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<r.length;++s)if(r[s]=i,a<t.length&&t[a]==s){++a,r[s]=i;var n=this.offsets[s],o=this.offsets[s+1]-n;o>0&&(i+=o)}for(var l=Array(4*r.length),u=0;u<r.length;++u)l[4*u+3]=255&r[u],l[4*u+2]=(65280&r[u])>>8,l[4*u+1]=(16711680&r[u])>>16,l[4*u]=(4278190080&r[u])>>24;return l},t}(),r_=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,r,i,a;for(t in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)r=a[t],e[t]=i[r];return e},e.prototype.glyphsFor=function(e){var t,r,i,a,s,n,o;for(i={},s=0,n=e.length;s<n;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in t=[],i)(null!=(r=i[a])?r.compound:void 0)&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(a in o=this.glyphsFor(t))r=o[a],i[a]=r;return i},e.prototype.encode=function(e,t){var r,i,a,s,n,o,l,u,h,c,d,p,f,m,g;for(i in r=rn.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),d={0:0},g=r.charMap)d[(o=g[i]).old]=o.new;for(p in c=r.maxGlyphID,s)p in d||(d[p]=c++);return h=Object.keys(u=function(e){var t,r;for(t in r={},e)r[e[t]]=t;return r}(d)).sort(function(e,t){return e-t}),f=function(){var e,t,r;for(r=[],e=0,t=h.length;e<t;e++)n=h[e],r.push(u[n]);return r}(),a=this.font.glyf.encode(s,f,d),l=this.font.loca.encode(a.offsets,f),m={cmap:this.font.cmap.raw(),glyf:a.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},e}();z.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(r){var i,a,s,n;if(Array.isArray(r))return"["+(function(){var e,a,s;for(s=[],e=0,a=r.length;e<a;e++)i=r[e],s.push(t.convert(i));return s})().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if("[object Object]"===({}).toString.call(r)){for(a in s=["<<"],r)n=r[a],s.push("/"+a+" "+t.convert(n));return s.push(">>"),s.join("\n")}return""+r},t}()}),n("kvvuk",function(e,r){t(e.exports,"zlibSync",()=>Q),t(e.exports,"unzlibSync",()=>ee);var i={},a=function(e,t,r,a,s){var n=i[t]||(i[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))),o=new Worker(n);return o.onerror=function(e){return s(e.error,null)},o.onmessage=function(e){return s(null,e.data)},o.postMessage(r,a),o},s=Uint8Array,n=Uint16Array,o=Uint32Array,l=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),u=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(e,t){for(var r=new n(31),i=0;i<31;++i)r[i]=t+=1<<e[i-1];for(var a=new o(r[30]),i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)a[s]=s-r[i]<<5|i;return[r,a]},d=c(l,2),p=d[0],f=d[1];p[28]=258,f[258]=28;for(var m=c(u,0),g=m[0],y=m[1],v=new n(32768),_=0;_<32768;++_){var x=(43690&_)>>>1|(21845&_)<<1;x=(61680&(x=(52428&x)>>>2|(13107&x)<<2))>>>4|(3855&x)<<4,v[_]=((65280&x)>>>8|(255&x)<<8)>>>1}for(var b=function(e,t,r){for(var i,a=e.length,s=0,o=new n(t);s<a;++s)++o[e[s]-1];var l=new n(t);for(s=0;s<t;++s)l[s]=l[s-1]+o[s-1]<<1;if(r){i=new n(1<<t);var u=15-t;for(s=0;s<a;++s)if(e[s])for(var h=s<<4|e[s],c=t-e[s],d=l[e[s]-1]++<<c,p=d|(1<<c)-1;d<=p;++d)i[v[d]>>>u]=h}else for(s=0,i=new n(a);s<a;++s)i[s]=v[l[e[s]-1]++]>>>15-e[s];return i},S=new s(288),_=0;_<144;++_)S[_]=8;for(var _=144;_<256;++_)S[_]=9;for(var _=256;_<280;++_)S[_]=7;for(var _=280;_<288;++_)S[_]=8;for(var w=new s(32),_=0;_<32;++_)w[_]=5;var E=b(S,9,0),A=b(S,9,1),T=b(w,5,0),C=b(w,5,1),P=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},R=function(e,t,r){var i=t/8>>0;return(e[i]|e[i+1]<<8)>>>(7&t)&r},I=function(e,t){var r=t/8>>0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>>(7&t)},L=function(e){return(e/8>>0)+(7&e&&1)},O=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var i=new(e instanceof n?n:e instanceof o?o:s)(r-t);return i.set(e.subarray(t,r)),i},M=function(e,t,r){var i=e.length,a=!t||r,n=!r||r.i;r||(r={}),t||(t=new s(3*i));var o=function(e){var r=t.length;if(e>r){var i=new s(Math.max(2*r,e));i.set(t),t=i}},c=r.f||0,d=r.p||0,f=r.b||0,m=r.l,y=r.d,v=r.m,_=r.n,x=8*i;do{if(!m){r.f=c=R(e,d,1);var S=R(e,d+1,3);if(d+=3,S){if(1==S)m=A,y=C,v=9,_=5;else if(2==S){var w=R(e,d,31)+257,E=R(e,d+10,15)+4,T=w+R(e,d+5,31)+1;d+=14;for(var M=new s(T),k=new s(19),N=0;N<E;++N)k[h[N]]=R(e,d+3*N,7);d+=3*E;var D=P(k),F=(1<<D)-1;if(!n&&d+T*(D+7)>x)break;for(var G=b(k,D,1),N=0;N<T;){var z=G[R(e,d,F)];d+=15&z;var q=z>>>4;if(q<16)M[N++]=q;else{var j=0,B=0;for(16==q?(B=3+R(e,d,3),d+=2,j=M[N-1]):17==q?(B=3+R(e,d,7),d+=3):18==q&&(B=11+R(e,d,127),d+=7);B--;)M[N++]=j}}var U=M.subarray(0,w),H=M.subarray(w);v=P(U),_=P(H),m=b(U,v,1),y=b(H,_,1)}else throw"invalid block type"}else{var q=L(d)+4,Z=e[q-4]|e[q-3]<<8,V=q+Z;if(V>i){if(n)throw"unexpected EOF";break}a&&o(f+Z),t.set(e.subarray(q,V),f),r.b=f+=Z,r.p=d=8*V;continue}if(d>x)throw"unexpected EOF"}a&&o(f+131072);for(var Y=(1<<v)-1,W=(1<<_)-1,$=v+_+18;n||d+$<x;){var j=m[I(e,d)&Y],X=j>>>4;if((d+=15&j)>x)throw"unexpected EOF";if(!j)throw"invalid length/literal";if(X<256)t[f++]=X;else if(256==X){m=null;break}else{var K=X-254;if(X>264){var N=X-257,J=l[N];K=R(e,d,(1<<J)-1)+p[N],d+=J}var Q=y[I(e,d)&W],ee=Q>>>4;if(!Q)throw"invalid distance";d+=15&Q;var H=g[ee];if(ee>3){var J=u[ee];H+=I(e,d)&(1<<J)-1,d+=J}if(d>x)throw"unexpected EOF";a&&o(f+131072);for(var et=f+K;f<et;f+=4)t[f]=t[f-H],t[f+1]=t[f+1-H],t[f+2]=t[f+2-H],t[f+3]=t[f+3-H];f=et}}r.l=m,r.p=d,r.b=f,m&&(c=1,r.m=v,r.d=y,r.n=_)}while(!c)return f==t.length?t:O(t,0,f)},k=function(e,t,r){r<<=7&t;var i=t/8>>0;e[i]|=r,e[i+1]|=r>>>8},N=function(e,t,r){r<<=7&t;var i=t/8>>0;e[i]|=r,e[i+1]|=r>>>8,e[i+2]|=r>>>16},D=function(e,t){for(var r=[],i=0;i<e.length;++i)e[i]&&r.push({s:i,f:e[i]});var a=r.length,o=r.slice();if(!a)return[new s(0),0];if(1==a){var l=new s(r[0].s+1);return l[r[0].s]=1,[l,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var u=r[0],h=r[1],c=0,d=1,p=2;for(r[0]={s:-1,f:u.f+h.f,l:u,r:h};d!=a-1;)u=r[r[c].f<r[p].f?c++:p++],h=r[c!=d&&r[c].f<r[p].f?c++:p++],r[d++]={s:-1,f:u.f+h.f,l:u,r:h};for(var f=o[0].s,i=1;i<a;++i)o[i].s>f&&(f=o[i].s);var m=new n(f+1),g=F(r[d-1],m,0);if(g>t){var i=0,y=0,v=g-t,_=1<<v;for(o.sort(function(e,t){return m[t.s]-m[e.s]||e.f-t.f});i<a;++i){var x=o[i].s;if(m[x]>t)y+=_-(1<<g-m[x]),m[x]=t;else break}for(y>>>=v;y>0;){var b=o[i].s;m[b]<t?y-=1<<t-m[b]++-1:++i}for(;i>=0&&y;--i){var S=o[i].s;m[S]==t&&(--m[S],++y)}g=t}return[new s(m),g]},F=function(e,t,r){return -1==e.s?Math.max(F(e.l,t,r+1),F(e.r,t,r+1)):t[e.s]=r},G=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new n(++t),i=0,a=e[0],s=1,o=function(e){r[i++]=e},l=1;l<=t;++l)if(e[l]==a&&l!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=e[l]}return[r.subarray(0,i),t]},z=function(e,t){for(var r=0,i=0;i<t.length;++i)r+=e[i]*t[i];return r},q=function(e,t,r){var i=r.length,a=L(t+2);e[a]=255&i,e[a+1]=i>>>8,e[a+2]=255^e[a],e[a+3]=255^e[a+1];for(var s=0;s<i;++s)e[a+s+4]=r[s];return(a+4+i)*8},j=function(e,t,r,i,a,s,o,c,d,p,f){k(t,f++,r),++a[256];for(var m,g,y,v,_=D(a,15),x=_[0],A=_[1],C=D(s,15),P=C[0],R=C[1],I=G(x),L=I[0],O=I[1],M=G(P),F=M[0],j=M[1],B=new n(19),U=0;U<L.length;++U)B[31&L[U]]++;for(var U=0;U<F.length;++U)B[31&F[U]]++;for(var H=D(B,7),Z=H[0],V=H[1],Y=19;Y>4&&!Z[h[Y-1]];--Y);var W=p+5<<3,$=z(a,S)+z(s,w)+o,X=z(a,x)+z(s,P)+o+14+3*Y+z(B,Z)+(2*B[16]+3*B[17]+7*B[18]);if(W<=$&&W<=X)return q(t,f,e.subarray(d,d+p));if(k(t,f,1+(X<$)),f+=2,X<$){m=b(x,A,0),g=x,y=b(P,R,0),v=P;var K=b(Z,V,0);k(t,f,O-257),k(t,f+5,j-1),k(t,f+10,Y-4),f+=14;for(var U=0;U<Y;++U)k(t,f+3*U,Z[h[U]]);f+=3*Y;for(var J=[L,F],Q=0;Q<2;++Q)for(var ee=J[Q],U=0;U<ee.length;++U){var et=31&ee[U];k(t,f,K[et]),f+=Z[et],et>15&&(k(t,f,ee[U]>>>5&127),f+=ee[U]>>>12)}}else m=E,g=S,y=T,v=w;for(var U=0;U<c;++U)if(i[U]>255){var et=i[U]>>>18&31;N(t,f,m[et+257]),f+=g[et+257],et>7&&(k(t,f,i[U]>>>23&31),f+=l[et]);var er=31&i[U];N(t,f,y[er]),f+=v[er],er>3&&(N(t,f,i[U]>>>5&8191),f+=u[er])}else N(t,f,m[i[U]]),f+=g[i[U]];return N(t,f,m[256]),f+g[256]},B=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),U=new s(0),H=function(e,t,r,i,a,h){var c=e.length,d=new s(i+c+5*(1+Math.floor(c/7e3))+a),p=d.subarray(i,d.length-a),m=0;if(!t||c<8)for(var g=0;g<=c;g+=65535){var v=g+65535;v<c?m=q(p,m,e.subarray(g,v)):(p[g]=h,m=q(p,m,e.subarray(g,c)))}else{for(var _=B[t-1],x=_>>>13,b=8191&_,S=(1<<r)-1,w=new n(32768),E=new n(S+1),A=Math.ceil(r/3),T=2*A,C=function(t){return(e[t]^e[t+1]<<A^e[t+2]<<T)&S},P=new o(25e3),R=new n(288),I=new n(32),M=0,k=0,g=0,N=0,D=0,F=0;g<c;++g){var G=C(g),z=32767&g,H=E[G];if(w[z]=H,E[G]=z,D<=g){var Z=c-g;if((M>7e3||N>24576)&&Z>423){m=j(e,p,0,P,R,I,k,N,F,g-F,m),N=M=k=0,F=g;for(var V=0;V<286;++V)R[V]=0;for(var V=0;V<30;++V)I[V]=0}var Y=2,W=0,$=b,X=z-H&32767;if(Z>2&&G==C(g-X))for(var K=Math.min(x,Z)-1,J=Math.min(32767,g),Q=Math.min(258,Z);X<=J&&--$&&z!=H;){if(e[g+Y]==e[g+Y-X]){for(var ee=0;ee<Q&&e[g+ee]==e[g+ee-X];++ee);if(ee>Y){if(Y=ee,W=X,ee>K)break;for(var et=Math.min(X,ee-2),er=0,V=0;V<et;++V){var ei=g-X+V+32768&32767,ea=w[ei],es=ei-ea+32768&32767;es>er&&(er=es,H=ei)}}}H=w[z=H],X+=z-H+32768&32767}if(W){P[N++]=268435456|f[Y]<<18|y[W];var en=31&f[Y],eo=31&y[W];k+=l[en]+u[eo],++R[257+en],++I[eo],D=g+Y,++M}else P[N++]=e[g],++R[e[g]]}}m=j(e,p,h,P,R,I,k,N,F,g-F,m),h||(m=q(p,m,U))}return O(d,0,i+L(m)+a)},Z=function(){var e=1,t=0;return{p:function(r){for(var i=e,a=t,s=r.length,n=0;n!=s;){for(var o=Math.min(n+5552,s);n<o;++n)i+=r[n],a+=i;i%=65521,a%=65521}e=i,t=a},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+((255&e)<<23)*2}}},V=function(e,t){var r={};for(var i in e)r[i]=e[i];for(var i in t)r[i]=t[i];return r},Y=function(e,t,r){for(var i=e(),a=e.toString(),s=a.slice(a.indexOf("[")+1,a.lastIndexOf("]")).replace(/ /g,"").split(","),n=0;n<i.length;++n){var o=i[n],l=s[n];if("function"==typeof o){t+=";"+l+"=";var u=o.toString();if(o.prototype){if(-1!=u.indexOf("[native code]")){var h=u.indexOf(" ",8)+1;t+=u.slice(h,u.indexOf("(",h))}else for(var c in t+=u,o.prototype)t+=";"+l+".prototype."+c+"="+o.prototype[c].toString()}else t+=u}else r[l]=o}return[t,r]},W=[],$=function(e){var t=[];for(var r in e)(e[r]instanceof s||e[r]instanceof n||e[r]instanceof o)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},X=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},K=function(e,t){var r=t.level,i=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=i<<6|(i?32-2*i:1)},J=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Q(e,t){void 0===t&&(t={});var r,i,a,s,n,o=Z();o.p(e);var l=(a=2,s=4,H(r=e,null==(i=t).level?6:i.level,null==i.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+i.mem,2,4,true));return K(l,t),X(l,l.length-4,o.d()),l}function ee(e,t){return M((J(e),e.subarray(2,-4)),t)}}),n("dNJ6r",function(e,t){var r=s("2ozqO");e.exports=r("cibnX").then(()=>s("9d6XQ"))}),n("2ozqO",function(e,t){e.exports=function(e){return import(s("dRo73").resolve(e))}}),n("dRo73",function(e,r){t(e.exports,"register",()=>i,e=>i=e),t(e.exports,"resolve",()=>a,e=>a=e);var i,a,s=new Map;i=function(e,t){for(var r=0;r<t.length-1;r+=2)s.set(t[r],{baseUrl:e,path:t[r+1]})},a=function(e){var t=s.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),n("cusDh",function(e,t){var r=s("2ozqO");e.exports=r("dB2vH").then(()=>s("fgoI4"))}),n("4s1Fc",function(e,t){var r=s("2ozqO");e.exports=r("jyybT").then(()=>s("hTqfs"))}),n("9BdHO",function(e,t){var r=s("4QhZh");r.default.prototype.flyTo&&console.warn("[OL-EXT] ol/View~View.flyTo redefinition"),r.default.prototype.flyTo=function(e,t){e=e||{},this.cancelAnimations();var r=e.duration||2e3,i=e.zoomAt||Math.min(e.zoom||100,this.getZoom())-2,a=e.zoom||this.getZoom(),s=e.center||this.getCenter();this.animate({center:s,duration:r,easing:e.easing,anchor:e.anchor,rotation:e.rotation}),this.animate({zoom:i,duration:r/2,easing:e.easing,anchor:e.anchor},{zoom:a,duration:r/2,easing:e.easing,anchor:e.anchor},"function"==typeof t?t:function(){})},r.default.prototype.takeTour=function(e,t){t=t||{};var r=-1,i=(function(a){if(a){var s=e[++r];if("function"==typeof t.step&&t.step(r,e),s){s instanceof Array&&(s={center:[s[0],s[1]],zoom:s[2],type:s[3]});var n=0===r?0:t.delay||750;s.easing||(s.easing=t.easing),s.type||(s.type=t.type),setTimeout((function(){"moveTo"===s.type?this.animate(s,i):this.flyTo(s,i)}).bind(this),n)}else"function"==typeof t.done&&t.done(!0)}else"function"==typeof t.done&&t.done(!1)}).bind(this);i(!0)},r.default}),n("76Eer",function(e,r){t(e.exports,"default",()=>v);var i=s("8rtB0"),a=s("jilwQ"),n=s("iQyfo"),o=s("4kBVU"),l=s("l9IGS"),u=s("h6Aha"),h=s("d5AAH"),c=s("2zf1Y"),d=s("610XN"),p=s("20LS2"),f=s("iGyOD"),m=s("j2K3b"),g=s("hvEnP");a.default.prototype.info={zmin:"Zmin ",zmax:"Zmax ",ytitle:"Altitude (m) ",xtitle:"Distance (km) ",time:"Temps ",altitude:"Altitude ",distance:"Distance ",altitudeUnits:"m",distanceUnitsM:"m",distanceUnitsKM:"km"};class y extends i.default{constructor(e){super({html:'<i class="fg-profile"></i>',className:"profilBt",onToggle:e=>{e&&this.showSelect()}}),this.select=e.select,this.select.on("select",()=>{this.showSelect()}),this.content=(0,n.default).create("DIV",{className:"profil",parent:this.element}),(0,n.default).create("DIV",{className:"profil-info",html:"Sélectionnez une ligne sur la carte...",parent:this.content}),(0,n.default).create("DIV",{className:"profil-error",html:"Impossible de calculer l'altitude...",parent:this.content}),this.profil=new a.default({target:this.content,style:new l.default({fill:new c.default({color:"#ccc"})}),width:400,height:200}),e.map.addControl(this.profil);let t=new d.default({source:new p.default,visible:!1,map:e.map,style:new l.default({image:new u.default({radius:10,radius2:5,points:5,stroke:new h.default({color:[255,255,255,.8],width:1.5}),fill:new c.default({color:[255,0,0,.5]})})})}),r=new f.default(new m.default([0,0]));t.getSource().addFeature(r),this.profil.on("over",e=>{r.getGeometry().setCoordinates(e.coord),t.setVisible(!0)}),this.profil.on(["out","change:active"],()=>{t.setVisible(!1)})}}y.prototype.showSelect=function(){let e;if(!this.getActive())return;let t=this.select.getFeatures().item(0);if(t&&this.feature===t){this.content.className="profil";return}if(t&&(e=t.getGeometry()).getLineString&&(e=e.getLineString()),e&&"LineString"===e.getType()){if(/Z/.test(e.getLayout()))this.content.className="profil",this.profil.setGeometry(e,{amplitude:500,zmin:0});else{let t=e.getCoordinates();if(t.length>600){let e=600/t.length,r=0,i=t;t=[],i.forEach((i,a)=>{r+1<a*e&&(t.push(i),r++)})}let r=[];if(t.length<=200)r.push(e);else for(let e=0;e<t.length/200;e++){let i=t.slice(200*e,(e+1)*200+1);i.length>1&&r.push(new g.default(i))}this.content.className="profil loading",this._alticode(r,[])}this.feature=t}else this.content.className="profil hidden"},y.prototype._alticode=function(e,t){let r=e.shift();(0,o.ol_geom_GPAltiCode)(r,{sampling:100,samplingDist:500,success:r=>{t.push(r.getCoordinates()),e.length?this._alticode(e,t):(t.length>1&&(r=new g.default(Array.prototype.concat.apply([],t))),this.content.className="profil",this.profil.setGeometry(r,{amplitude:500,zmin:0}))},error:()=>{this.content.className="profil error"}})};var v=y}),n("jilwQ",function(e,r){t(e.exports,"default",()=>g);var i=s("7qu5m"),a=s("gzr8q"),n=s("4DafG"),o=s("iGyOD"),l=s("2zf1Y"),u=s("l9IGS"),h=s("d5AAH"),c=s("kuKBR"),d=s("hvEnP"),p=s("23ytq"),f=s("iQyfo"),m=class extends n.default{constructor(e){e=e||{};var t,r,i=document.createElement("div");super({element:i,target:e.target});var a=this;if(this.info=e.info||m.prototype.info,e.target)i.classList.add(e.className||"ol-profile");else{i.className=((e.className||"ol-profile")+" ol-unselectable ol-control ol-collapsed").trim(),this.button=document.createElement("button"),this.button.title=e.title||"Profile",this.button.setAttribute("type","button");var s=function(e){a.toggle(),e.preventDefault()};this.button.addEventListener("click",s),this.button.addEventListener("touchstart",s),i.appendChild(this.button),(0,f.default).create("I",{parent:this.button})}e.style instanceof u.default?this._style=e.style:this._style=new u.default({text:new c.default,stroke:new h.default({width:1.5,color:"#369"})}),this._style.getText()||this._style.setText(new c.default),e.selectStyle instanceof u.default?this._selectStyle=e.selectStyle:this._selectStyle=new u.default({fill:new l.default({color:"#369"})});var n=document.createElement("div");n.classList.add("ol-inner"),i.appendChild(n);var o=document.createElement("div");o.style.position="relative",n.appendChild(o);var p=this.ratio=2;this.canvas_=document.createElement("canvas"),this.canvas_.width=(e.width||300)*p,this.canvas_.height=(e.height||150)*p;var g={msTransform:"scale(0.5,0.5)",msTransformOrigin:"0 0",webkitTransform:"scale(0.5,0.5)",webkitTransformOrigin:"0 0",mozTransform:"scale(0.5,0.5)",mozTransformOrigin:"0 0",transform:"scale(0.5,0.5)",transformOrigin:"0 0"};Object.keys(g).forEach(function(e){e in a.canvas_.style&&(a.canvas_.style[e]=g[e])});var y=document.createElement("div");o.appendChild(y),y.style.width=this.canvas_.width/p+"px",y.style.height=this.canvas_.height/p+"px",y.appendChild(this.canvas_),y.addEventListener("pointerdown",this.onMove.bind(this)),document.addEventListener("pointerup",this.onMove.bind(this)),y.addEventListener("mousemove",this.onMove.bind(this)),y.addEventListener("touchmove",this.onMove.bind(this)),this.set("selectable",e.selectable),this.margin_={top:10*p,left:45*p,bottom:30*p,right:10*p},this.info.ytitle||(this.margin_.left-=20*p),this.info.xtitle||(this.margin_.bottom-=20*p),this.bar_=document.createElement("div"),this.bar_.classList.add("ol-profilebar"),this.bar_.style.top=this.margin_.top/p+"px",this.bar_.style.height=(this.canvas_.height-this.margin_.top-this.margin_.bottom)/p+"px",o.appendChild(this.bar_),this.cursor_=document.createElement("div"),this.cursor_.classList.add("ol-profilecursor"),o.appendChild(this.cursor_),this.popup_=document.createElement("div"),this.popup_.classList.add("ol-profilepopup"),this.cursor_.appendChild(this.popup_);var v=document.createElement("table");v.cellPadding="0",v.cellSpacing="0",v.style.clientWidth=this.canvas_.width/p+"px",o.appendChild(v);var _=document.createElement("tr");_.classList.add("track-info"),v.appendChild(_);var x=document.createElement("td");x.innerHTML=(this.info.zmin||"Zmin")+': <span class="zmin">',_.appendChild(x);var b=document.createElement("td");b.innerHTML=(this.info.zmax||"Zmax")+': <span class="zmax">',_.appendChild(b);var S=document.createElement("td");S.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',_.appendChild(S);var w=document.createElement("td");w.innerHTML=(this.info.time||"Time")+': <span class="time">',_.appendChild(w);var E=document.createElement("tr");E.classList.add("point-info"),v.appendChild(E);var A=document.createElement("td");A.innerHTML=(this.info.altitude||"Altitude")+': <span class="z">',E.appendChild(A);var T=document.createElement("td");T.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',E.appendChild(T);var C=document.createElement("td");C.innerHTML=(this.info.time||"Time")+': <span class="time">',E.appendChild(C),this.tab_=[],e.feature&&this.setGeometry(e.feature),e.zoomable&&(this.set("selectable",!0),this.on("change:geometry",function(){r=null}),this.on("dragstart",function(e){t=e.index}),this.on("dragend",(function(e){if(Math.abs(t-e.index)>10){if(!r)var a=(0,f.default).create("BUTTON",{parent:i,className:"ol-zoom-out",click:(function(e){e.stopPropagation(),e.preventDefault(),r&&(this.dispatchEvent({type:"zoom"}),this.setGeometry(r,this._geometry[1])),i.removeChild(a)}).bind(this)});var s=r||this._geometry[0],n=new d.default(this.getSelection(t,e.index));this.setGeometry(n,this._geometry[1]),r=s,this.dispatchEvent({type:"zoom",geometry:n,start:t,end:e.index})}}).bind(this)))}popup(e){this.popup_.innerHTML=e}_drawAt(e,t){e?(this.cursor_.style.left=t+"px",this.cursor_.style.top=(this.canvas_.height-this.margin_.bottom+e[1]*this.scale_[1]+this.dy_)/this.ratio+"px",this.cursor_.style.display="block",this.bar_.parentElement.classList.add("over"),this.bar_.style.left=t+"px",this.bar_.style.display="block",this.element.querySelector(".point-info .z").textContent=e[1]+this.info.altitudeUnits,this.element.querySelector(".point-info .dist").textContent=(e[0]/1e3).toFixed(1)+this.info.distanceUnitsKM,this.element.querySelector(".point-info .time").textContent=e[2],t>this.canvas_.width/this.ratio/2?this.popup_.classList.add("ol-left"):this.popup_.classList.remove("ol-left")):(this.cursor_.style.display="none",this.bar_.style.display="none",this.cursor_.style.display="none",this.bar_.parentElement.classList.remove("over"))}showAt(e){var t,r,i,a=1/0;if(void 0===e)this.bar_.parentElement.classList.contains("over")&&this._drawAt();else if(e.length)for(t=1;r=this.tab_[t];t++){var s=(0,p.ol_coordinate_dist2d)(r[3],e);s<a&&(i=r,a=s)}else for(t=0;(r=this.tab_[t])&&(i=r,!(r[0]>=e));t++);if(i){var n=(i[0]*this.scale_[0]+this.margin_.left)/this.ratio;return this._drawAt(i,n),i[3]}return null}showAtTime(e,t){var r,i,a;if(e instanceof Date?e=e.getTime()/1e3:t&&(e+=this.tab_[0][3][3]),void 0===e)this.bar_.parentElement.classList.contains("over")&&this._drawAt();else for(r=0;(i=this.tab_[r])&&(a=i,!(i[3][3]>=e));r++);if(a){var s=(a[0]*this.scale_[0]+this.margin_.left)/this.ratio;return this._drawAt(a,s),a[3]}return null}pointAtTime(e){var t,r;for(t=1;r=this.tab_[t];t++){var i=r[3][3];if(i>=e){var a=this.tab_[t-1][3];if((a[3]+i)/2<e)return a;return r}}return this.tab_[this.tab_.length-1][3]}onMove(e){if(this.tab_.length){var t=this.canvas_.getBoundingClientRect(),r={top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft},i=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX,a=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY,s=i-r.left,n=a-r.top,o=this.ratio;if(s>this.margin_.left/o-20&&s<(this.canvas_.width-this.margin_.right)/o+8&&n>this.margin_.top/o&&n<(this.canvas_.height-this.margin_.bottom)/o){var l,u,h=(s*o-this.margin_.left)/this.scale_[0],c=this.tab_[0];for(l=1;u=this.tab_[l];l++)if(u[0]>=h){h<(u[0]+c[0])/2&&(l=0,u=c);break}switch(u||(u=this.tab_[this.tab_.length-1]),s=Math.max(this.margin_.left/o,Math.min(s,(this.canvas_.width-this.margin_.right)/o)),this._drawAt(u,s),this.dispatchEvent({type:"over",click:"click"===e.type,index:l,coord:u[3],time:u[2],distance:u[0]}),e.type){case"pointerdown":this._dragging={event:{type:"dragstart",index:l,coord:u[3],time:u[2],distance:u[0]},pageX:i,pageY:a};break;case"pointerup":this._dragging&&this._dragging.pageX?3>Math.abs(this._dragging.pageX-i)&&3>Math.abs(this._dragging.pageY-a)&&(this.dispatchEvent({type:"click",index:l,coord:u[3],time:u[2],distance:u[0]}),this.refresh()):this.dispatchEvent({type:"dragend",index:l,coord:u[3],time:u[2],distance:u[0]}),this._dragging=!1;break;default:if(this._dragging){if(this._dragging.pageX)(Math.abs(this._dragging.pageX-i)>3||Math.abs(this._dragging.pageY-a)>3)&&(this._dragging.pageX=this._dragging.pageY=!1,this.dispatchEvent(this._dragging.event));else{this.dispatchEvent({type:"dragging",index:l,coord:u[3],time:u[2],distance:u[0]});var d=Math.min(this._dragging.event.index,l),p=Math.max(this._dragging.event.index,l);this.refresh(),this.get("selectable")&&this._drawGraph(this.tab_.slice(d,p),this._selectStyle)}}}}else this.bar_.parentElement.classList.contains("over")&&(this._drawAt(),this.dispatchEvent({type:"out"})),"pointerup"===e.type&&this._dragging&&(this.dispatchEvent({type:"dragcancel"}),this._dragging=!1)}}show(){this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"show",show:!0})}hide(){this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"show",show:!1})}toggle(){this.element.classList.toggle("ol-collapsed");var e=this.element.classList.contains("ol-collapsed");this.dispatchEvent({type:"show",show:!e})}isShown(){return!this.element.classList.contains("ol-collapsed")}getSelection(e,t){for(var r=[],i=Math.max(Math.min(e,t),0),a=Math.min(Math.max(e,t),this.tab_.length-1),s=i;s<=a;s++)r.push(this.tab_[s][3]);return r}_drawGraph(e,t){if(e.length){var r,i,a=this.canvas_.getContext("2d"),s=this.scale_[0],n=this.scale_[1],o=this.dy_,l=this.ratio;for(a.beginPath(),r=0;i=e[r];r++)0==r?a.moveTo(i[0]*s,i[1]*n+o):a.lineTo(i[0]*s,i[1]*n+o);t.getStroke()&&(a.strokeStyle=t.getStroke().getColor()||"#000",a.lineWidth=t.getStroke().getWidth()*l,a.setLineDash([]),a.stroke()),t.getFill()&&(a.fillStyle=t.getFill().getColor()||"#000",a.Style=t.getFill().getColor()||"#000",a.lineTo(e[e.length-1][0]*s,0),a.lineTo(e[0][0]*s,0),a.fill())}}setGeometry(e,t){if(t||(t={}),e instanceof o.default&&(e=e.getGeometry()),this._geometry=[e,t],/Z/.test(e.getLayout())){/M/.test(e.getLayout())?this.element.querySelector(".time").parentElement.style.display="block":this.element.querySelector(".time").parentElement.style.display="none";var r,s,n=e.getCoordinates();switch(e.getType()){case"LineString":break;case"MultiLineString":n=n[0];break;default:return}var l,u,h,c,d,p=t.projection||this.getMap().getView().getProjection(),f=1/0,m=-1/0,g=this.tab_=[];for(l=0;u=n[l];l++)(c=u[2])<f&&(f=c),c>m&&(m=c),0==l?h=0:h+=(r=n[l-1],s=u,(0,i.getDistance)((0,a.transform)(r,p,"EPSG:4326"),(0,a.transform)(s,p,"EPSG:4326"))),d=function(e,t){if(!e||!t)return"-";var r=(t-e)/60,i=Math.trunc(r/60),a=Math.trunc(r-60*i);return i+"h"+(a<10?"0":"")+a+"mn"}(n[0][3],u[3]),g.push([h,c,d,u]);this._z=[f,m],this.set("graduation",t.graduation||100),this.set("zmin",t.zmin),this.set("zmax",t.zmax),this.set("amplitude",t.amplitude),this.set("unit",t.unit),this.set("zunit",t.zunit),this.set("zDigits",t.zDigits),this.set("zMaxChars",t.zMaxChars),this.dispatchEvent({type:"change:geometry",geometry:e}),this.refresh()}}refresh(){var e,t,r,i=this.canvas_,a=i.getContext("2d"),s=i.width,n=i.height;a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,s,n);var o=this._z[0],l=this._z[1],u=this.tab_,h=u[u.length-1][0],c=u[u.length-1][2];if(!h){console.error("[ol/control/Profile] no data...",u);return}a.setTransform(1,0,0,1,this.margin_.left,n-this.margin_.bottom);var d=this.ratio;s-=this.margin_.right+this.margin_.left,n-=this.margin_.top+this.margin_.bottom,a.strokeStyle=this._style.getText().getFill().getColor()||"#000",a.lineWidth=.5*d,a.beginPath(),a.moveTo(0,0),a.lineTo(0,-n),a.moveTo(0,0),a.lineTo(s,0),a.stroke(),this.element.querySelector(".track-info .zmin").textContent=o.toFixed(2)+this.info.altitudeUnits,this.element.querySelector(".track-info .zmax").textContent=l.toFixed(2)+this.info.altitudeUnits,h>1e3?this.element.querySelector(".track-info .dist").textContent=(h/1e3).toFixed(1)+this.info.distanceUnitsKM:this.element.querySelector(".track-info .dist").textContent=h.toFixed(1)+this.info.distanceUnitsM,this.element.querySelector(".track-info .time").textContent=c;for(var p=this.get("graduation");;)if(n/(((l=Math.ceil(l/p)*p)-(o=Math.floor(o/p)*p))/p)<15*d)p*=2;else break;"number"==typeof this.get("zmin")&&o>this.get("zmin")&&(o=this.get("zmin")),"number"==typeof this.get("zmax")&&l<this.get("zmax")&&(l=this.get("zmax"));var f=this.get("amplitude");f&&(l=Math.max(o+f,l));var m=s/h,g=-n/(l-o),y=this.dy_=-o*g;this.scale_=[m,g],this._drawGraph(u,this._style),a.textAlign="right",a.textBaseline="top",a.fillStyle=this._style.getText().getFill().getColor()||"#000",a.beginPath();var v=this.get("zDigits")||0,_=null;if("number"==typeof this.get("zMaxChars")&&(t="km"!=this.get("zunit")?Math.max(o.toFixed(v).length,l.toFixed(v).length):Math.max((o/1e3).toFixed(1).length,(l/1e3).toFixed(1).length),this.get("zMaxChars")<t)){_=Math.floor(Math.log10(Math.max(Math.abs(o),Math.abs(l),Number.MIN_VALUE))),a.font="bold "+9*d+"px arial",a.fillText(_.toString(),-8*d,8*d);var x=a.measureText(_.toString()),b=x.width,S=x.actualBoundingBoxAscent+x.actualBoundingBoxDescent;a.font="bold "+12*d+"px arial",a.fillText("10",-8*d-b,8*d+.5*S)}for(a.font=10*d+"px arial",a.textBaseline="middle",e=o;e<=l;e+=p){if(null!==_){var w=e/Math.pow(10,_);"km"==this.get("zunit")&&(w/=1e3);var E=this.get("zMaxChars")-Math.floor(Math.log10(Math.max(Math.abs(w),1))+1)-1;w<0&&(E-=1),this.get("zunit"),a.fillText(w.toFixed(Math.max(E,0)),-4*d,e*g+y)}else"km"!=this.get("zunit")?a.fillText(e.toFixed(v),-4*d,e*g+y):a.fillText((e/1e3).toFixed(1),-4*d,e*g+y);a.moveTo(-2*d,e*g+y),0!=e?a.lineTo(h*m,e*g+y):a.lineTo(0,e*g+y)}a.textAlign="center",a.textBaseline="top",a.setLineDash([d,3*d]);var A=this.get("unit")||"km";for(h>1e3?(r=100*Math.round(h/1e3))>1e3&&(r=1e3*Math.ceil(r/1e3)):(A="m",r=h>100?10*Math.round(h/100):h>10?Math.round(h/10):h>1?Math.round(h)/10:h),e=0;e<=h;e+=r){var T="m"==A?e:e/1e3;a.fillText(Math.round(10*T)/10,e*m,4*d),a.moveTo(e*m,2*d),a.lineTo(e*m,0)}a.font=12*d+"px arial",a.fillText(this.info.xtitle.replace("(km)","("+A+")"),s/2,18*d),a.save(),a.rotate(-Math.PI/2),a.fillText(this.info.ytitle,n/2,-this.margin_.left),a.restore(),a.stroke()}getImage(e,t){return"canvas"===e?this.canvas_:this.canvas_.toDataURL(e,t)}};m.prototype.info={zmin:"Zmin",zmax:"Zmax",ytitle:"Altitude (m)",xtitle:"Distance (km)",time:"Time",altitude:"Altitude",distance:"Distance",altitudeUnits:"m",distanceUnitsM:"m",distanceUnitsKM:"km"};var g=m}),n("4kBVU",function(e,r){t(e.exports,"ol_geom_GPAltiCode",()=>n);var i=s("fkmMz"),a=s("23ytq");s("j2K3b"),s("hvEnP");var n=function(e,t){t=t||{};var r=e.getType();if("Point"!==r&&"LineString"!==r){console.warn("[GPAltiCode] "+r+" not supported...");return}var s=t.projection||"EPSG:3857",n=void 0===t.minZ?-99:t.minZ,o=t.sampling||0;if(t.samplingDist){var l=e.getLength();o=Math.max(o,Math.round(l/t.samplingDist))}o>5e3&&(o=5e3),o<2&&(o=0),e=e.clone().transform(s,"EPSG:4326");var u,h=[],c=[];switch(r){case"Point":u=[e.getCoordinates()];break;case"LineString":u=e.getCoordinates();break;default:return}o<=u.length&&(o=0),u.forEach(function(e){h.push(Math.round(1e6*e[0])/1e6),c.push(Math.round(1e6*e[1])/1e6)});var d="lon="+h.join("|")+"&lat="+c.join("|");d+="&resource=ign_rge_alti_wld",o&&(d+="&sampling="+o),(0,i.default).get({url:"https://data.geopf.fr/altimetrie/1.0/calcul/alti/rest/"+(h.length>1?"elevationLine":"elevation")+".json?"+d,success:function(e){var i=[];e.elevations.forEach(function(e,t){o?i.push([e.lon,e.lat,Math.max(n,e.z)]):i.push([u[t][0],u[t][1],Math.max(n,e.z)])}),"Point"===r&&(i=i[0]);var l=(0,a.ol_geom_createFromType)(r,i);l.transform("EPSG:4326",s),"function"==typeof t.success&&t.success(l)},error:function(e){"function"==typeof t.error&&t.error(e)}})}}),n("66krt",function(e,t){var r,i;r=e.exports,i=function(){for(var e=[null,[[10,7,17,13],[1,1,1,1],[]],[[16,10,28,22],[1,1,1,1],[4,16]],[[26,15,22,18],[1,1,2,2],[4,20]],[[18,20,16,26],[2,1,4,2],[4,24]],[[24,26,22,18],[2,1,4,4],[4,28]],[[16,18,28,24],[4,2,4,4],[4,32]],[[18,20,26,18],[4,2,5,6],[4,20,36]],[[22,24,26,22],[4,2,6,6],[4,22,40]],[[22,30,24,20],[5,2,8,8],[4,24,44]],[[26,18,28,24],[5,4,8,8],[4,26,48]],[[30,20,24,28],[5,4,11,8],[4,28,52]],[[22,24,28,26],[8,4,11,10],[4,30,56]],[[22,26,22,24],[9,4,16,12],[4,32,60]],[[24,30,24,20],[9,4,16,16],[4,24,44,64]],[[24,22,24,30],[10,6,18,12],[4,24,46,68]],[[28,24,30,24],[10,6,16,17],[4,24,48,72]],[[28,28,28,28],[11,6,19,16],[4,28,52,76]],[[26,30,28,28],[13,6,21,18],[4,28,54,80]],[[26,28,26,26],[14,7,25,21],[4,28,56,84]],[[26,28,28,30],[16,8,25,20],[4,32,60,88]],[[26,28,30,28],[17,8,25,23],[4,26,48,70,92]],[[28,28,24,30],[17,9,34,23],[4,24,48,72,96]],[[28,30,30,30],[18,9,30,25],[4,28,52,76,100]],[[28,30,30,30],[20,10,32,27],[4,26,52,78,104]],[[28,26,30,30],[21,12,35,29],[4,30,56,82,108]],[[28,28,30,28],[23,12,37,34],[4,28,56,84,112]],[[28,30,30,30],[25,12,40,34],[4,32,60,88,116]],[[28,30,30,30],[26,13,42,35],[4,24,48,72,96,120]],[[28,30,30,30],[28,14,45,38],[4,28,52,76,100,124]],[[28,30,30,30],[29,15,48,40],[4,24,50,76,102,128]],[[28,30,30,30],[31,16,51,43],[4,28,54,80,106,132]],[[28,30,30,30],[33,17,54,45],[4,32,58,84,110,136]],[[28,30,30,30],[35,18,57,48],[4,28,56,84,112,140]],[[28,30,30,30],[37,19,60,51],[4,32,60,88,116,144]],[[28,30,30,30],[38,19,63,53],[4,28,52,76,100,124,148]],[[28,30,30,30],[40,20,66,56],[4,22,48,74,100,126,152]],[[28,30,30,30],[43,21,70,59],[4,26,52,78,104,130,156]],[[28,30,30,30],[45,22,74,62],[4,30,56,82,108,134,160]],[[28,30,30,30],[47,24,77,65],[4,24,52,80,108,136,164]],[[28,30,30,30],[49,25,81,68],[4,28,56,84,112,140,168]]],t=/^\d*$/,r=/^[A-Za-z0-9 $%*+\-./:]*$/,i=/^[A-Z0-9 $%*+\-./:]*$/,a=[],s=[-1],n=0,o=1;n<255;++n)a.push(o),s[o]=n,o=2*o^(o>=128?285:0);for(var l=[[]],n=0;n<30;++n){for(var u=l[n],h=[],c=0;c<=n;++c){var d=c<n?a[u[c]]:0,p=a[(n+(u[c-1]||0))%255];h.push(s[d^p])}l.push(h)}for(var f={},n=0;n<45;++n)f["0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".charAt(n)]=n;var m=[function(e,t){return(e+t)%2==0},function(e,t){return e%2==0},function(e,t){return t%3==0},function(e,t){return(e+t)%3==0},function(e,t){return((e/2|0)+(t/3|0))%2==0},function(e,t){return e*t%2+e*t%3==0},function(e,t){return(e*t%2+e*t%3)%2==0},function(e,t){return((e+t)%2+e*t%3)%2==0}],g=function(e){return e>6},y=function(t){var r=e[t],i=16*t*t+128*t+64;return g(t)&&(i-=36),r[2].length&&(i-=25*r[2].length*r[2].length-10*r[2].length-55),i},v=function(t,r){var i=-8&y(t),a=e[t];return i-8*a[0][r]*a[1][r]},_=function(e,t){switch(t){case 1:return e<10?10:e<27?12:14;case 2:return e<10?9:e<27?11:13;case 4:return e<10?8:16;case 8:return e<10?8:e<27?10:12}},x=function(e,t,r){var i=v(e,r)-4-_(e,t);switch(t){case 1:return(i/10|0)*3+(i%10<4?0:i%10<7?1:2);case 2:return(i/11|0)*2+(i%11<6?0:1);case 4:return i/8|0;case 8:return i/13|0}},b=function(e,i){switch(e){case 1:if(!i.match(t))return null;return i;case 2:if(!i.match(r))return null;return i.toUpperCase();case 4:if("string"!=typeof i)return i;for(var a=[],s=0;s<i.length;++s){var n=i.charCodeAt(s);n<128?a.push(n):n<2048?a.push(192|n>>6,128|63&n):n<65536?a.push(224|n>>12,128|n>>6&63,128|63&n):a.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n)}return a}},S=function(e,t,r,i){var a=[],s=0,n=8,o=r.length,l=function(e,t){if(t>=n){for(a.push(s|e>>(t-=n));t>=8;)a.push(e>>(t-=8)&255);s=0,n=8}t>0&&(s|=(e&(1<<t)-1)<<(n-=t))},u=_(e,t);switch(l(t,4),l(o,u),t){case 1:for(var h=2;h<o;h+=3)l(parseInt(r.substring(h-2,h+1),10),10);l(parseInt(r.substring(h-2),10),[0,4,7][o%3]);break;case 2:for(var h=1;h<o;h+=2)l(45*f[r.charAt(h-1)]+f[r.charAt(h)],11);o%2==1&&l(f[r.charAt(h-1)],6);break;case 4:for(var h=0;h<o;++h)l(r[h],8)}for(l(0,4),n<8&&a.push(s);a.length+1<i;)a.push(236,17);return a.length<i&&a.push(236),a},w=function(e,t){for(var r=e.slice(0),i=e.length,n=t.length,o=0;o<n;++o)r.push(0);for(var o=0;o<i;){var l=s[r[o++]];if(l>=0)for(var u=0;u<n;++u)r[o+u]^=a[(l+t[u])%255]}return r.slice(i)},E=function(e,t,r){for(var i=[],a=e.length/t|0,s=0,n=t-e.length%t,o=0;o<n;++o)i.push(s),s+=a;for(var o=n;o<t;++o)i.push(s),s+=a+1;i.push(s);for(var l=[],o=0;o<t;++o)l.push(w(e.slice(i[o],i[o+1]),r));for(var u=[],h=e.length/t|0,o=0;o<h;++o)for(var c=0;c<t;++c)u.push(e[i[c]+o]);for(var c=n;c<t;++c)u.push(e[i[c+1]-1]);for(var o=0;o<r.length;++o)for(var c=0;c<t;++c)u.push(l[c][o]);return u},A=function(e,t,r,i){for(var a=e<<i,s=t-1;s>=0;--s)a>>i+s&1&&(a^=r<<s);return e<<i|a},T=function(t){for(var r=e[t],i=4*t+17,a=[],s=[],n=0;n<i;++n)a.push([]),s.push([]);var o=function(e,t,r,i,n){for(var o=0;o<r;++o)for(var l=0;l<i;++l)a[e+o][t+l]=n[o]>>l&1,s[e+o][t+l]=1};o(0,0,9,9,[127,65,93,93,93,65,383,0,64]),o(i-8,0,8,9,[256,127,65,93,93,93,65,127]),o(0,i-8,9,8,[254,130,186,186,186,130,254,0,0]);for(var n=9;n<i-8;++n)a[6][n]=a[n][6]=1&~n,s[6][n]=s[n][6]=1;for(var l=r[2],u=l.length,n=0;n<u;++n)for(var h=0==n||n==u-1?1:0,c=0==n?u-1:u,d=h;d<c;++d)o(l[n],l[d],5,5,[31,17,21,17,31]);if(g(t))for(var p=A(t,6,7973,12),f=0,n=0;n<6;++n)for(var d=0;d<3;++d)a[n][i-11+d]=a[i-11+d][n]=p>>f++&1,s[n][i-11+d]=s[i-11+d][n]=1;return{matrix:a,reserved:s}},C=function(e,t,r){for(var i=e.length,a=0,s=-1,n=i-1;n>=0;n-=2){6==n&&--n;for(var o=s<0?i-1:0,l=0;l<i;++l){for(var u=n;u>n-2;--u)!t[o][u]&&(e[o][u]=r[a>>3]>>(7&~a)&1,++a);o+=s}s=-s}return e},P=function(e,t,r){for(var i=m[r],a=e.length,s=0;s<a;++s)for(var n=0;n<a;++n)t[s][n]||(e[s][n]^=i(s,n));return e},R=function(e,t,r,i){for(var a=e.length,s=21522^A(r<<3|i,5,1335,10),n=0;n<15;++n){var o=[0,1,2,3,4,5,7,8,a-7,a-6,a-5,a-4,a-3,a-2,a-1][n],l=[a-1,a-2,a-3,a-4,a-5,a-6,a-7,a-8,7,5,4,3,2,1,0][n];e[o][8]=e[8][l]=s>>n&1}return e},I=function(e){for(var t=function(e){for(var t=0,r=0;r<e.length;++r)e[r]>=5&&(t+=3+(e[r]-5));for(var r=5;r<e.length;r+=2){var i=e[r];e[r-1]==i&&e[r-2]==3*i&&e[r-3]==i&&e[r-4]==i&&(e[r-5]>=4*i||e[r+1]>=4*i)&&(t+=40)}return t},r=e.length,i=0,a=0,s=0;s<r;++s){var n,o,l=e[s];n=[0];for(var u=0;u<r;){for(o=0;u<r&&l[u];++o)++u;for(n.push(o),o=0;u<r&&!l[u];++o)++u;n.push(o)}i+=t(n),n=[0];for(var u=0;u<r;){for(o=0;u<r&&e[u][s];++o)++u;for(n.push(o),o=0;u<r&&!e[u][s];++o)++u;n.push(o)}i+=t(n);var h=e[s+1]||[];a+=l[0];for(var u=1;u<r;++u){var c=l[u];a+=c,l[u-1]==c&&h[u]===c&&h[u-1]===c&&(i+=3)}}return i+10*(Math.abs(a/r/r-.5)/.05|0)},L=function(t,r,i,a,s){var n=e[r],o=S(r,i,t,v(r,a)>>3);o=E(o,n[1][a],l[n[0][a]]);var u=T(r),h=u.matrix,c=u.reserved;if(C(h,c,o),s<0){P(h,c,0),R(h,c,a,0);var d=0,p=I(h);for(P(h,c,0),s=1;s<8;++s){P(h,c,s),R(h,c,a,s);var f=I(h);p>f&&(p=f,d=s),P(h,c,s)}s=d}return P(h,c,s),R(h,c,a,s),h},O={generate:function(e,r){var a=(r=r||{}).version||-1,s={L:1,M:0,Q:3,H:2}[(r.ecclevel||"L").toUpperCase()],n=r.mode?({numeric:1,alphanumeric:2,octet:4})[r.mode.toLowerCase()]:-1,o="mask"in r?r.mask:-1;if(n<0)n="string"==typeof e?e.match(t)?1:e.match(i)?2:4:4;else if(!(1==n||2==n||4==n))throw"invalid or unsupported mode";if(null===(e=b(n,e)))throw"invalid data format";if(s<0||s>3)throw"invalid ECC level";if(a<0){for(a=1;a<=40&&!(e.length<=x(a,n,s));++a);if(a>40)throw"too large data"}else if(a<1||a>40)throw"invalid version";if(-1!=o&&(o<0||o>8))throw"invalid mask";return L(e,a,n,s,o)},generateHTML:function(e,t){t=t||{};for(var r=O.generate(e,t),i=Math.max(t.modulesize||5,.5),a=Math.max(null!==t.margin?t.margin:4,0),s=document.createElement("div"),n=r.length,o=['<table border="0" cellspacing="0" cellpadding="0" style="border:'+i*a+'px solid #fff;background:#fff">'],l=0;l<n;++l){o.push("<tr>");for(var u=0;u<n;++u)o.push('<td style="width:'+i+"px;height:"+i+"px"+(r[l][u]?";background:#000":"")+'" part="'+(r[l][u]?"module-fg":"module-bg")+'" ></td>');o.push("</tr>")}return s.className="qrcode",s.innerHTML=o.join("")+"</table>",s},generateSVG:function(e,t){t=t||{};var r=O.generate(e,t),i=r.length,a=Math.max(t.modulesize||5,.5),s=Math.max(null!==t.margin?t.margin:4,0),n=a*(i+2*s),o=' class= "fg" width="'+a+'" height="'+a+'"/>',l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("viewBox","0 0 "+n+" "+n),l.setAttribute("style","shape-rendering:crispEdges"),t.modulesize&&(l.setAttribute("width",n),l.setAttribute("height",n));for(var u=["<style scoped>.bg{fill:#FFF}.fg{fill:#000}</style>",'<rect class="bg" x="0" y="0"','width="'+n+'" height="'+n+'"/>'],h=s*a,c=0;c<i;++c){for(var d=s*a,p=0;p<i;++p)r[c][p]&&u.push('<rect x="'+d+'" y="'+h+'"',o),d+=a;h+=a}return l.innerHTML=u.join(""),l},generatePNG:function(e,t){t=t||{};var r,i=O.generate(e,t),a=Math.max(t.modulesize||5,.5),s=Math.max(null!==t.margin?t.margin:4,0),n=i.length,o=a*(n+2*s),l=document.createElement("canvas");if(l.width=l.height=o,!(r=l.getContext("2d")))throw"canvas support is needed for PNG output";r.fillStyle="#fff",r.fillRect(0,0,o,o),r.fillStyle="#000";for(var u=0;u<n;++u)for(var h=0;h<n;++h)i[u][h]&&r.fillRect(a*(s+h),a*(s+u),a,a);return l.toDataURL()}};return O},"function"==typeof define&&define.amd?define([],i):e.exports?e.exports=i():r.QRCode=i()}),n("ofMCX",function(e,t){var r=s("k7cyy"),i=s("gAUZM"),a=s("3SMVV"),n=s("fkmMz");i.default.prototype.getFeatureInfoUrl=r.default.prototype.getFeatureInfoUrl,i.default.prototype.getFeatureInfo=r.default.prototype.getFeatureInfo,a.default.prototype.getFeatureInfo=function(e,t,r){let i=this.getFeatureInfoUrl(e,t,"EPSG:3857",{INFO_FORMAT:r.INFO_FORMAT});(0,n.default).get({url:i,dataType:r.format||"text/plain",options:{encode:!1},success:function(e){r.callback&&r.callback(e)},error:r.error||function(){}})}});